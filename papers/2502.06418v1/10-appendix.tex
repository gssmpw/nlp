\appendix
\onecolumn
% \section{You \emph{can} have an appendix here.}
\section{Additional Experimental Results}\label{sec:Appendix_Additional Experimental Results}
\subsection{Evasion Attack against Related Works}
\label{sec:appendix:Evasion Attack against Related Works}
We provide detailed evasion attack results as shown in ~\cref{fig:evasion-related-pimog-psnr} - ~\cref{fig:evasion-related-hidden-ssim} on COCO dataset and shown in ~\cref{fig:evasion-related-pimog-div2k-psnr}-~\cref{fig:evasion-related-cin-div2k-ssim} on DIV2K dataset, including the attack success rates and visual metrics corresponding to all watermark detection thresholds. Additionally, we provide examples of attack results against other algorithms, as shown in ~\cref{fig:evasion-hidden,fig:evasion-pimog}.

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-pimog-evasion-div2k-cmp-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding PSNR visual metric on DIV2K dataset.}
    \label{fig:evasion-related-pimog-div2k-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-pimog-evasion-div2k-cmp-SSIM.png}
    \vspace{-3mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding SSIM visual metric on DIV2K dataset.}
    \label{fig:evasion-related-pimog-div2k-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-cin-evasion-div2k-cmp-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding PSNR visual metric on DIV2K dataset.}
    \label{fig:evasion-related-cin-div2k-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-cin-evasion-div2k-cmp-SSIM.png}
    \vspace{-3mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding SSIM visual metric on DIV2K dataset.}
    \label{fig:evasion-related-cin-div2k-ssim}
\end{minipage}
\end{figure}



\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-pimog-evasion-coco-cmp-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-related-pimog-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-pimog-evasion-coco-cmp-SSIM.png} 
   
    \vspace{-3mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-related-pimog-ssim}
\end{minipage}
\end{figure}


\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-cin-evasion-coco-cmp-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-related-cin-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-cin-evasion-coco-cmp-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-related-cin-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-stegastamp-evasion-coco-cmp-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of StegaStamp evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-related-stegastamp-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-stegastamp-evasion-coco-cmp-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of StegaStamp evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-related-stegastamp-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-rivagan-evasion-coco-cmp-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of RivaGan evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-related-rivagan-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-rivagan-evasion-coco-cmp-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of RivaGan evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-related-rivagan-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-hidden-evasion-coco-cmp-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of HiDDeN evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-related-hidden-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-related/pic-hidden-evasion-coco-cmp-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of HiDDeN evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-related-hidden-ssim}
\end{minipage}
\end{figure}

\subsection{Spoof Attack against Related Works}\label{sec:Appendix_Additional Experimental Results_Spoof Attack}
We provide detailed spoof attack results as shown in ~\cref{fig:spoof-related-pimog-psnr}-~\cref{fig:spoof-related-hidden-ssim}, including the attack success rates and visual metrics corresponding to all watermark detection thresholds. Additionally, we provide examples of attack results against other algorithms, as shown in ~\cref{fig:spoof-pimog,fig:spoof-hidden}.

\subsection{Ablation Study for Evasion Attack}
\label{sec:appendix:Ablation_Study_for_Evasion_Attack}
We provide detailed ablation study for evasion attack results as shown in ~\cref{fig:evasion-ab-pimog-psnr}-~\cref{fig:evasion-ab-cin-ssim}, including the attack success rates and visual metrics corresponding to all watermark detection thresholds.

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-ab/pic-pimog-evasion-coco-cmp-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-ab-pimog-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-ab/pic-pimog-evasion-coco-cmp-SSIM.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-ab-pimog-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/evasion-ab/pic-cin-evasion-coco-cmp-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding PSNR visual metric.}
    \label{fig:evasion-ab-cin-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/evasion-ab/pic-cin-evasion-coco-cmp-SSIM.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of CIN evasion attacks and the corresponding SSIM visual metric.}
    \label{fig:evasion-ab-cin-ssim}
\end{minipage}
\end{figure}


\subsection{Ablation Study for Spoof Attack}
\label{sec:appendix:Ablation_Study_for_Spoof_Attack}
We provide detailed ablation study for spoofing attack results as shown in ~\cref{fig:spoof-ab-pimog-psnr}-~\cref{fig:spoof-ab-cin-ssim}, including the attack success rates and visual metrics corresponding to all watermark detection thresholds.

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-ab/pic-pimog-evasion-coco-cmp-spoof-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-ab-pimog-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-ab/pic-pimog-evasion-coco-cmp-spoof-SSIM.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of PIMoG forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-ab-pimog-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-ab/pic-cin-evasion-coco-cmp-spoof-PSNR.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of CIN forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-ab-cin-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-ab/pic-cin-evasion-coco-cmp-spoof-SSIM.png} 
    \vspace{-6mm}
    \caption{The detailed success rate of CIN forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-ab-cin-ssim}
\end{minipage}
\end{figure}


%--------------

\begin{figure}[!t]
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/evasion-example-hidden.png} 
   
    \vspace{-3mm}
    \caption{Examples of the evasion attack against HiDDeN.}
    \label{fig:evasion-hidden}
\end{figure}

\begin{figure}[!t]
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/spoof-example-hidden.png} 
    
    \vspace{-3mm}
    \caption{Examples of the spoof attack against HiDDeN.}
    \label{fig:spoof-hidden}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-pimog-evasion-coco-cmp-spoof-PSNR.png} 
   
    \vspace{-3mm}
    \caption{The detailed success rate of PIMoG forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-related-pimog-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-pimog-evasion-coco-cmp-spoof-SSIM.png} 
    
    \vspace{-3mm}
    \caption{The detailed success rate of PIMoG forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-related-pimog-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-cin-evasion-coco-cmp-spoof-PSNR.png} 
   
    \vspace{-6mm}
    \caption{The detailed success rate of CIN forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-related-cin-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-cin-evasion-coco-cmp-spoof-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of CIN forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-related-cin-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-stegastamp-evasion-coco-cmp-spoof-PSNR.png} 
    \label{fig:spoof-related-stegastamp-psnr}
    \vspace{-6mm}
    \caption{The detailed success rate of StegaStamp forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-related-stegastamp-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-stegastamp-evasion-coco-cmp-spoof-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of StegaStamp forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-related-stegastamp-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-rivagan-evasion-coco-cmp-spoof-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of RivaGan forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-related-rivagan-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-rivagan-evasion-coco-cmp-spoof-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of RivaGan forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-related-rivagan-ssim}
\end{minipage}
\end{figure}

\begin{figure}[!t]
\begin{minipage}{0.48\linewidth}
    \centering
    % Custom font size
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-hidden-evasion-coco-cmp-spoof-PSNR.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of HiDDeN forgery attacks and the corresponding PSNR visual metric.}
    \label{fig:spoof-related-hidden-psnr}
\end{minipage}\hfill
\begin{minipage}{0.48\linewidth}
    \centering
    \includegraphics[width=\linewidth]{pics/appendix/spoof-related/pic-hidden-evasion-coco-cmp-spoof-SSIM.png} 
    
    \vspace{-6mm}
    \caption{The detailed success rate of HiDDeN forgery attacks and the corresponding SSIM visual metric.}
    \label{fig:spoof-related-hidden-ssim}
\end{minipage}
\end{figure}


% \section{Parameters for Watermarking Method}
% \subsection{Evasion Attack}
% \subsection{Spoof Attack}

\section{Implementation Details}\label{sec:Appendix_Implementation Details}

\begin{algorithm}[tb]
   \caption{Evasion Attack}
   \label{alg:evasion algo}
\begin{algorithmic}
   \STATE {\bfseries Input:} watermarked image $I_{wm}$, step $m$, feature extracter $\mathcal{F}$, clustering algorithm $\mathcal{C}$, optimizer $\mathcal{O}$, objective function $\mathcal{L}$, perturbation budget $\epsilon$
   \STATE {\bfseries Output:} attacked watermarked image $I_a$
   \STATE // find the k clusters with the fewest samples within the cluster, and transform the channel feature indices within the clusters into weights for locating information leakage.
   \STATE $\mathcal{W} \xleftarrow{\mathcal{C}} \mathcal{F}(I_{wm})$ 
   \STATE $\delta \xleftarrow{} noise$
   
   \FOR{$i=1$ {\bfseries to} $m-1$}
   \STATE $\delta \xleftarrow{} \mathcal{O}(\delta,-\nabla_\delta\mathcal{L}(\mathcal{W} \cdot \mathcal{F}(I_{wm}), \mathcal{W}\cdot \mathcal{F}(I_{wm} + \delta))))$
   \IF{$||\delta||_\infty > \epsilon$}
   \STATE  $\delta \xleftarrow{} \delta \cdot \frac{\epsilon}{||\delta||_\infty}$
   \ENDIF
   \ENDFOR
   \STATE {\bfseries return} $I_a = I_{wm} + \delta$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[tb]
   \caption{Spoof Attack}
   \label{alg:spoof algo}
\begin{algorithmic}
   \STATE {\bfseries Input:} watermarked image $I_{wm}$,  clean image $I'$, step $m$, feature extracter $\mathcal{F}$, clustering algorithm $\mathcal{C}$, optimizer $\mathcal{O}$, objective function $\mathcal{L}$, perturbation budget $\epsilon$
   \STATE {\bfseries Output:} attacked watermarked image $I_a$
   \STATE // find the k clusters with the fewest samples within the cluster, and transform the channel feature indices within the clusters into weights for locating information leakage.
   \STATE $\mathcal{W} \xleftarrow{\mathcal{C}} \mathcal{F}(I_{wm})$ 
  
   
   \STATE $\delta \xleftarrow{} noise$
   \STATE // Stage-\uppercase\expandafter{\romannumeral1}
   \FOR{$i=1$ {\bfseries to} $m-1$}
   \STATE $\delta \xleftarrow{} \mathcal{O}(\delta,\nabla_\delta-\mathcal{L}(\mathcal{W} \cdot \mathcal{F}(I_{wm}), \mathcal{W}\cdot \mathcal{F}(I_{wm} + \delta))))$
   \IF{$||\delta||_\infty > \epsilon$}
   \STATE  $\delta \xleftarrow{} \delta \cdot \frac{\epsilon}{||\delta||_\infty}$
   \ENDIF
   \ENDFOR
    
   \STATE // Stage-\uppercase\expandafter{\romannumeral2}
   \STATE $\delta_s \xleftarrow{} noise$
   \FOR{$i=1$ {\bfseries to} $m-1$}
   \STATE $\delta_s \xleftarrow{} \mathcal{O}(\delta_s,\nabla_{\delta_s}\mathcal{L}((1-\mathcal{W}) \cdot \mathcal{F}(I_{wm}+\delta), (1-\mathcal{W})\cdot \mathcal{F}(I' + \delta_s)))$
   \STATE $\hat{\delta}=-\delta + \delta_s$
   \IF{$||\hat{\delta}||_\infty > \epsilon$}
   \STATE  $\hat{\delta} \xleftarrow{} \hat{\delta} \cdot \frac{\epsilon}{||\hat{\delta}||_\infty}$
   \STATE $\delta_s \xleftarrow{} \hat{\delta} + \delta$
   \ENDIF
   \ENDFOR
   \STATE {\bfseries return} $I_a \in \{I' - \delta, I'-\delta+\delta_s\}$
\end{algorithmic}
\end{algorithm}

\section{Proofs}\label{sec:Appendix_Proofs}

\begin{definition}
A intuitive definition of embeddable threshold:
\begin{gather*}
C(I) = \sup_{W \in \mathcal{P}_1}{\frac{||W||_2}{||I||_2}} \\\\
s.t. PNSR(I, I+W) \ge TV
\end{gather*}
$TV$ represents the lower bound of the visual quality.
\end{definition}

\begin{proposition}
When the robustness requirement exceeds $C(I)$, a decline in visual quality is inevitable.
% As the robustness requirement increases, the system is forced to exceed the embedment capacity $C(I)$, sacrificing visual quality.
\end{proposition}

\begin{proof}
Let the distortion layer $\mathcal{T}$ introduce noise $\eta \sim \mathcal{T}$, with the requirement that
$$||wm-\mathcal{D}(I_{wm} + \eta)|| \le \mathcal{B}$$
$\mathcal{B}$ is bit error rate.Then computing channel capacity:
$$R=\frac{1}{2}\log(1+\frac{\epsilon^2||W||^2}{\delta_{\eta}^2})$$

To correctly transmit $K$ bits of information, the following conditions must be met:
\begin{align*}
    R \ge H(wm) = k \Rightarrow \frac{1}{2}\log(1+\frac{\epsilon^2||W||^2}{\delta_{\eta}^2}) \ge H(wm) = k\\
    \Rightarrow \epsilon^2||W||^2_2 \ge (2^{2H(wm)}-1)\delta_{\eta^2}
\end{align*}

% According to the definition of PSNR:

% $$
% PSNR(I,I_{wm})=10\log_{10}(\frac{MAX_I^2}{MSE(I,I_{wm})}) \ge TV
% $$

% where $MSE(I,I_{wm})=\frac{1}{HW}||\epsilon W||^2_2$, substituting this into the equation gives:

% $$
% ||W||^2_2 \le \frac{MAX_2^I \cdot HW}{10^{TV/10}\epsilon^2}
% $$

according to $C(I) = \sup_{W \in \mathcal{P}_r}{\frac{||W||_2}{||I||_2}} $, 
we get:
$$
% \epsilon||W|_2 \le \sqrt{\frac{MAX_2^I \cdot HW}{10^{TV/10}\epsilon^2}}
\epsilon||W||_2 \le C(I)||I||_2
$$

Let the robustness requirement be $$\epsilon^2||W||^2_2 \ge (2^{2H(wm)}-1)\delta_{\eta^2}$$ 
and the visual quality constraint be $$\epsilon||W||_2 \le C(I)||I||_2$$
When $\sqrt{(2^{2H(wm)}-1)\delta_{\eta^2}} > C(I)||I||_2$, the system cannot simultaneously satisfy both, and it is necessary to increase $C(I)$
\end{proof}