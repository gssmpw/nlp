\def\figgap{0.3cm}
\def\yfiggap{1.3cm}
\def\heightgg{1.6cm}
\def\widthgg{4.2cm}
\begin{figure*}[ht]
    \centering
    \begin{subfigure}{0.98\textwidth}
        \begin{tikzpicture}
            \node(border)[inner sep=0pt, minimum height=1.6cm, minimum width=17.5cm, draw=white, dashed] at (0,0){};
            \node[inner sep=0pt,anchor=west, draw=white](fig1) at (border.west){\includegraphics[width=\widthgg]{figure/exps/0.099dpcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig1.north) {\footnotesize DP (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=west, draw=white](fig2) at ($(fig1.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.099dpprojcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig2.north) {\footnotesize DP + Projection (\textcolor{blue}{success})};
            \node[inner sep=0pt,anchor=west, draw=white](fig3) at ($(fig2.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.099dp3cube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig3.north) {\footnotesize DP 3D (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=east, draw=white](fig4) at ($(border.east)+(0,0)$){\includegraphics[width=\widthgg]{figure/exps/0.099dp3projcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig4.north) {\footnotesize DP 3D + Projection (\textcolor{blue}{success})};
            \node[color=black, rotate=90] at ($(fig1.west)+(0.,0.1)$) {\footnotesize TCP height [cm]};
            \node[color=graspw, rotate=90] at ($(fig1.east)+(0.1,0.2)$) {\footnotesize grasp width [cm]};

            \node[red, anchor=south](text1)at($(fig1.south)+(0.15,0.33)$) {\scriptsize collide}; 
            \draw[red,line width=0.6pt,-stealth] (text1.east) -- ++ (0.2,0.15);

            \node[red, anchor=south](text2)at($(fig3.south)+(-0.7,0.33)$) {\scriptsize collide}; 
            \draw[red,line width=0.6pt,-stealth] (text2.east) -- ++ (0.2,0.15);
            \node[anchor=south,font=\scriptsize,inner sep=0](grasptext) at ($(fig2.south)+(0.5,0.44)$) {grasping};
            \draw[-stealth,line width=0.6pt,inner sep=0] (grasptext.west) -- ++(-0.45,0);
            \draw[-stealth,line width=0.6pt,inner sep=0] (grasptext.east) -- ++(0.42,0);
            
        \end{tikzpicture}
        \caption{The reference gripper: $\mathbb{G}_0$, Object: block. Introducing Safety Projection into the online inference of DP and DP3.}
        \label{fig:safe-a}
    \end{subfigure}

    \begin{subfigure}{0.98\textwidth}
        \begin{tikzpicture}
            \node(border)[minimum height=1.6cm, minimum width=17.5cm, draw=white, dashed] at (0,0){};
            \node[inner sep=0pt,anchor=west, draw=white](fig1) at (border.west){\includegraphics[width=\widthgg]{figure/exps/0.14dpcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig1.north) {\footnotesize DP (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=west, draw=white](fig2) at ($(fig1.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.14dp3cube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig2.north) {\footnotesize DP 3D (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=west, draw=white](fig3) at ($(fig2.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.14oursnoprojcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig3.north) {\footnotesize Ours w/o projection (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=east, draw=white](fig4) at ($(border.east)+(0,0)$){\includegraphics[width=\widthgg]{figure/exps/0.14ourscube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig4.north) {\footnotesize Ours (\textcolor{blue}{success})};
            
            \node[color=black, rotate=90] at ($(fig1.west)+(0.,0.1)$) {\footnotesize TCP height [cm]};
            \node[color=graspw, rotate=90] at ($(fig1.east)+(0.1,0.2)$) {\footnotesize grasp width [cm]};


            \node[red, anchor=south](text1)at($(fig1.south)+(0.7,0.33)$) {\scriptsize collide}; 
            \draw[red,line width=0.6pt,-stealth] (text1.east) -- ++ (0.2,0.15);

            \node[red, anchor=south](text2)at($(fig2.south)+(0.8,0.33)$) {\scriptsize collide}; 
            \draw[red,line width=0.6pt,-stealth] (text2.east) -- ++ (0.2,0.15);

            \node[red, anchor=south](text3)at($(fig3.south)+(0.8,0.33)$) {\scriptsize collide}; 
            \draw[red,line width=0.6pt,-stealth] (text3.east) -- ++ (0.2,0.15);
            
        \end{tikzpicture}
        \caption{A longer gripper: $\mathbb{G}_1$, Object: block.}
        \label{fig:safe-b}
    \end{subfigure}
    
    \begin{subfigure}{0.98\textwidth}
        \begin{tikzpicture}
            \node(border)[minimum height=1.6cm, minimum width=17.5cm, draw=white, dashed] at (0,0){};
            \node[inner sep=0pt,anchor=west, draw=white](fig1) at (border.west){\includegraphics[width=\widthgg]{figure/exps/0.0625oursnoprojcube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig1.north) {\footnotesize Ours w/o projection (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=west, draw=white](fig2) at ($(fig1.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.0625ourscube.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig2.north) {\footnotesize Ours (\textcolor{blue}{success})};
            \node[inner sep=0pt,anchor=west, draw=white](fig3) at ($(fig2.east)+(\figgap,0)$){\includegraphics[width=\widthgg]{figure/exps/0.0625oursnoprojbanana.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig3.north) {\footnotesize Ours w/o projection (\textcolor{red}{fail})};
            \node[inner sep=0pt,anchor=east, draw=white](fig4) at ($(border.east)+(0,0)$){\includegraphics[width=\widthgg]{figure/exps/0.0625oursbanana.pdf}};
            \node[inner sep=0pt,anchor=south] at (fig4.north) {\footnotesize Ours (\textcolor{blue}{success})};
            \node[anchor=north west,black] at ($(fig1.north west)+(0.5,-0.05)$){\footnotesize block};
            \node[anchor=north west,black] at ($(fig2.north west)+(0.5,-0.05)$){\footnotesize block};
            \node[anchor=north west,black] at ($(fig3.north west)+(0.5,-0.05)$){\footnotesize banana};
            \node[anchor=north west,black] at ($(fig4.north west)+(0.5,-0.05)$){\footnotesize banana};
            \node[color=black, rotate=90] at ($(fig1.west)+(0.,0.1)$) {\footnotesize TCP height [cm]};
            \node[color=graspw, rotate=90] at ($(fig1.east)+(0.1,0.2)$) {\footnotesize grasp width [cm]};


            \node[red, anchor=center](text1)at($(fig1.center)+(0.7,-0.1)$) {\scriptsize ungrasped}; 
            \draw[red,line width=0.6pt,-stealth] ($(text1.west)+(0.1,0)$) -- ++ (-0.3,-0.1);
            
            \node[red, anchor=center](text2)at($(fig3.center)+(0.8,-0.13)$) {\scriptsize ungrasped}; 
            \draw[red,line width=0.6pt,-stealth] ($(text2.west)+(0.1,0)$) -- ++ (-0.2,-0.1);
        \end{tikzpicture}
        \caption{A shorter gripper: $\mathbb{G}_4$, Object: block and banana. The policy without Projection fails to grasp the objects.}
    \end{subfigure}

    \begin{subfigure}{0.98\textwidth}
        \begin{tikzpicture}
            \node(border)[inner sep=0pt, minimum height=1cm, minimum width=17.5cm, draw=white, dashed] at (0,0){};
            \draw[inner sep=0pt,line width=1pt, dashed, color=graspw] ($(border.north west)+(1.3,-0.3)$) -- ++ (0.55,0) node[inner sep=0pt,right,graspw](label1) {\footnotesize grasp width};

            \draw[line width=1pt, dash dot,color=blockcolor]  ($(label1.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,blockcolor](label2) {\footnotesize block height};

            \draw[line width=1pt, dash dot,color=safeline]  ($(label2.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,safeline](label3) {\footnotesize safety line};

             \draw[line width=1pt, dash dot,color=bananacolor]  ($(label3.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,bananacolor](label4) {\footnotesize banana height};

            \draw[line width=1pt,color=dp]  ($(label4.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,color=dp](label5) {\footnotesize Diffusion Policy (DP)};
            
            \draw[inner sep=0pt,line width=1pt, color=white] ($(border.north west)+(4.5,-0.8)$) -- ++ (0.55,0) node[inner sep=0pt,right,red](label6) {\footnotesize with Projection};
            \node[color=red] at ($(border.north west)+(4.8,-0.8)$) {\textbf{$\star$}};

            \draw[line width=1pt,color=dp3]  ($(label6.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,color=dp3](label7) {\footnotesize Diffusion Policy 3D (DP 3D)};

            \draw[line width=1pt,color=ours]  ($(label7.east)+(1,0)$)-- ++ (0.55,0) node[inner sep=0pt,right,color=ours](label8) {\footnotesize Ours};
            \node[color=red] at ($(label8.west)+(-0.23,0)$) {\textbf{$\star$}};
            
        \end{tikzpicture}

    \end{subfigure}

\caption{Safety analysis of different methods under various conditions. Tool-center-point (TCP) height less than the \textcolor{safeline}{safety line} indicates that the gripper collided with the table, causing the task to fail. If the TCP height is greater than the height of the object, it indicates a failure to grasp the object (\textcolor{red}{ungrasped}).}
\label{fig:safety}
% \vspace{-1em}
\end{figure*} 