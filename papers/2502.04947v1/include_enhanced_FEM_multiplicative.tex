\section{Enriching the finite element method with multiplicative priors}
\label{sec:multiplicative_prior}

This section employs the same assumptions as in \cref{sec:additive_prior}, namely that we have a sufficiently smooth prior $u_\theta$ on the solution~$u$ of the PDE \eqref{eq:ob_pde}.
However, this prior will now be multiplied to elements of $V_h$ rather than added to them.
We construct the underlying modified problem in \cref{sec:modified_problem_mul}.
Then, similarly to the additive approach of \cref{sec:additive_prior}, error estimates are obtained in \cref{sec:error_estimates_mul}.
\subsection{Construction of the modified problem}
\label{sec:modified_problem_mul}

To construct the modified problem in this case, we must ensure that the prior $u_\theta$ never vanishes.
Therefore, we propose to modify the initial problem~\eqref{eq:ob_pde} and consider in this section the problem defined by
\begin{equation}
	\label{eq:ob_pde_M}
	\begin{dcases}
		\mathcal{L}(u_M)=f, &
		\text{\quad in } \Omega,          \\
		u_M = %g +
		M,                  &
		\text{\quad on } \partial \Omega. \\
	\end{dcases}
\end{equation}
Note that \eqref{eq:ob_pde_M} is nothing but the initial problem~\eqref{eq:ob_pde} lifted by a constant $M \in \R_+$, chosen large enough to ensure that $u_M=u+M>0$.
We then introduce the associated variational problem, defined by
\begin{equation}
	\label{eq:weakform2}
	\text{Find } u_M = u + M,~\text{with }u \in V^0 \text{ such that, }
	\forall v\in V^0,~ a(u_M,v)=l(v).
\end{equation}
Therefore, solving~\eqref{eq:weakform2}, we recover the solution $u$ of the initial problem \eqref{eq:ob_pde} by setting \[u = u_M - M.\]
The prior \[u_{\theta,M}=u_\theta+M>0\] is associated with problem \eqref{eq:weakform2}.

%We are now ready to introduce a new finite element space $V_h^\times$ associated to $\mathbb{P}_k$ polynomials.
%This multiplicatively
Let us introduce the following modified finite element space defined by
\begin{equation}
	\label{eq:Vh_mul}
	V_h^\times = \left\{
	u_{h,M}^\times = u_{\theta,M} \; p_h^\times,
	\quad p_h^\times \in 1+V_h^0
	\right\},
\end{equation}
with, for all $\bm{x}\in \Omega$, $u_{\theta,M}(\bm{x})\neq 0$.
From \eqref{eq:weakform2}, this leads to the following approximate formulation:
\begin{equation}\label{eq:approachform_mul}
	\text{Find } p_h^\times \in 1+ V_h^0 \text{ such that, }
	\quad
	\forall v_h \in V_h^0,
	\quad
	\; a \big(u_{\theta,M} \; p_h^\times,u_{\theta,M}  v_h \big) = l(u_{\theta,M} v_h).
\end{equation}
Therefore, solving \eqref{eq:approachform_mul}, we recover the solution $u_h^\times\in V_h^\times-M$ of the original problem \eqref{eq:ob_pde} by setting $u_h^\times = u_{h,M}^\times - M$.

Based on the $N_{\text{dofs}}$ dofs $\big(\bm{x}^{(i)}\big)_{i \in \{1,\ldots,N_{\text{\rm dofs}}\}}$ of the mesh, we consider the interpolation operator on $V_h^\times$ given by
\begin{equation*}
	\label{eq:Ih_tilde}
	\tilde{\mathcal{I}}_h:
	C^0(\Omega) \ni v \mapsto
	\sum_{i=1}^{N_\text{dofs}}\frac{v\big(\bm{x}^{(i)}\big)}{u_{\theta,M}\big(\bm{x}^{(i)}\big)} \tilde{\psi_i} \in V_h^\times,
\end{equation*}
where the shape functions $\tilde{\psi_i}$ associated to $V_h^\times$ are defined by
\[
	\tilde{\psi_i}={u_{\theta,M}} \; {\psi}_i,
\]
with ${\psi}_i$ the classical shape functions presented in \cref{sec:FEM}.
Note that the new interpolation operator $\tilde{\mathcal{I}}_h$ is related to the classical Lagrange interpolation operator defined in \eqref{eq:Ih} as follows
\begin{equation}
	\label{eq:relation_Ih_Ih_tilde}
	\forall v \in C^0(\Omega), \qquad
	\tilde{\mathcal{I}}_h(v)
	=
	u_{\theta,M} \;
	\mathcal{I}_h \left( \frac v {u_{\theta,M}} \right).
\end{equation}



% \subsection{Tools for the convergence analysis}
% \label{sec:tools_for_error_estimates_mul}

% To make the convergence analysis work,
% we need to prove that $V_h^\times$ is a subspace of $M+V^0$,
% and that, for all \smash{$u_{h,M}^\times \in V_h^\times$}, \smash{$\tilde{\mathcal{I}}_h(u_{h,M}^\times) = u_{h,M}^\times$}.
% Indeed, these two properties are necessary to apply CÃ©a's lemma,
% which is essential to prove convergence.

% \begin{lemma}
% 	Suppose that $u_{\theta,M}\in M+W^{1,\infty}(\Omega)\cap H^1_0(\Omega)$. The space $V_h^\times$ is a vector subspace of $M+V^0=M+H_0^1(\Omega)$.
% \end{lemma}
% \begin{proof}
% 	Since $V_h$ is a vector space, it is clear that $V_h^\times$ is also a vector space.
% 	Therefore, we need to show that $V_h^\times \subset M+V^0$, which is itself a vector space.
% 	To that end, take $u_{h,M}^\times \in V_h^\times$;
% 	then, there exists $p_h^\times \in 1+V_h^0$ such that \smash{$u_{h,M}^\times = u_{\theta,M} p_h^\times$},
% 	and we get
% 	\begin{equation*}
% 		\| u_{h,M}^\times \|_{H_0^1}^2
% 		=
% 		\| p_h^\times \ u_{\theta,M}\|_{H_0^1}^2
% 		\leqslant
% 		\| p_h^\times \ u_{\theta,M}\|_{L^2}^2 +
% 		\| u_{\theta,M}\nabla p_h^\times\|_{L^2}^2 +
% 		\| p_h^\times\nabla u_{\theta,M}\|_{L^2}^2.
% 	\end{equation*}
% 	Since $u_{\theta,M}\in M+W^1_{\infty}(\Omega)$,
% 	we know that there exist $C_1, C_2 > 0$ such that
% 	$\| u_{\theta,M}\|_{\infty} \le C_1$
% 	and  $ \| \nabla u_{\theta,M}\|_{\infty} \le C_2$.
% 	Therefore,
% 	\begin{align*}
% 		\| p_h^\times u_{\theta,M}\|_{H_0^1}^2
% 		 & \le C_1\| p_h^\times \|_{L^2}^2+ C_1\|\nabla p_h^\times\|_{L^2}^2  +C_2\| p_h^\times\|_{L^2}^2 \\
% 		 & \le (C_1+C_2)(\| p_h^\times\|_{L^2}^2 +\|\nabla p_h^\times\|_{L^2}^2)                          \\
% 		 & \lesssim \| p_h^\times\|_{H_0^1}^2.
% 	\end{align*}
% 	Since $p_h^\times \in 1+ V_h^0 \subset 1+ V^0 = 1+ H_0^1(\Omega)$,
% 	its $H^1$ norm is finite,
% 	and hence so is the $H^1$ norm of $u_{h,M}^\times$.
% 	We deduce that $u_{h,M}^\times \in M +V^0$, which leads to the conclusion.
% \end{proof}

% \begin{lemma}
% 	For all $u_{h,M}^\times \in V_h^\times$, $\tilde{\mathcal{I}}_h(u_{h,M}^\times) = u_{h,M}^\times$.
% \end{lemma}


% \begin{proof}
% 	Let us consider $u_{h,M}^\times \in V_h^\times$.
% 	By definition
% 	\eqref{eq:Ih_tilde} of the global interpolant,
% 	we know that
% 	\begin{equation*}
% 		\tilde{\mathcal{I}}_h(u_{h,M}^\times)
% 		=
% 		\sum_{i=1}^{N_\text{dofs}} \frac{u_{h,M}^\times\big(\bm{x}^{(i)}\big)}{u_{\theta,M}\big(\bm{x}^{(i)}\big)} \psi_i u_{\theta,M}.
% 	\end{equation*}
% 	Now, using \eqref{eq:Vh_mul}, there exists $p_h^\times \in 1+ V_h^0$ such that $u_{h,M}^\times = u_{\theta,M} p_h^\times$.
% 	Since $p_h^\times \in 1 + V_h^0$, it satisfies
% 	\begin{equation*}
% 		p_h^\times = \sum_{i=1}^{N_\text{dofs}} p_h^\times\big(\bm{x}^{(i)}\big) \psi_i,
% 	\end{equation*}
% 	and therefore
% 	\begin{equation*}
% 		\tilde{\mathcal{I}}_h(u_{h,M}^\times)
% 		=
% 		u_{\theta,M} \sum_{i=1}^{N_\text{dofs}} p_h^\times\big(\bm{x}^{(i)}\big) \psi_i
% 		=
% 		u_{\theta,M} p_h^\times
% 		=
% 		u_{h,M}^\times,
% 	\end{equation*}
% 	which concludes the proof.
% \end{proof}

\subsection{Convergence analysis}
\label{sec:error_estimates_mul}

In this section, we finally prove that the modified FEM \eqref{eq:approachform_mul} converges to the solution to \eqref{eq:ob_pde_M},
and that it satisfies the same type of estimate as the classical one.
% We focus on the homogeneous boundary Dirichlet problem for the sake of simplicity.
Equipped with the lifting trick in \cref{sec:modified_problem_mul},
we can state the following convergence theorem.

\begin{theorem}
	\label{lem:error_estimate_multiplicative}
	Let $u_M\in H^{q+1}(\Omega)$ be the solution of the enhanced problem \eqref{eq:weakform2}
    and $u_{\theta,M}\in M+H^{q+1}(\Omega)\cap H^1_0(\Omega)$ be a prior on $u_M$.
    We consider $u_{h,M}^\times\in V_h^\times$ the solution to the finite element problem \eqref{eq:approachform_mul} with
    \smash{$V_h^\times$} the modified trial space defined in \eqref{eq:Vh_mul},
    considering $\mathbb{P}_k$ polynomials.
    We define $u=u_M-M$ and $u_h^\times=u_{h,M}^\times-M$.
    Then, for all $1\leqslant q\leqslant k$
	\begin{equation*}
		\label{eq:error_mul}
		| u-u_h^\times|_{H^1} \leq C_q\dfrac{\gamma}{\alpha} C_{\text{\rm gain},H^1}^{\times,M} h^{q}| u |_{H^{q+1}}
	\end{equation*}
	and
	\begin{equation*}
        \label{eq:error_mulL2}
        \| u-u_h^\times\|_{L^2} \leqslant C_e C_1 C_q\dfrac{\gamma^2}{\alpha} C_{\text{\rm gain},L^2}^{\times,M} \, h^{q+1} |u|_{H^{q+1}},
    \end{equation*}
    with $C_e$, $C_1$, $C_q$, $\gamma$, $\alpha$ defined in \cref{sec:FEM}, and where
    \begin{equation}
		\label{eq:gain_mul}
		C_{\text{\rm gain},H^1}^{\times,M} = \left| \frac{u_M}{u_{\theta,M}} \right|_{H^{q+1}} \frac{\| u_{\theta,M}\|_{W^{1,\infty}}}{| u |_{H^{q+1}}},
	\end{equation}
	and
    \begin{equation}
		\label{eq:gain_mulL2}
		C_{\text{\rm gain},L^2}^{\times,M} =
		C_{\theta,M}\left| \frac{u_M}{u_{\theta,M}} \right|_{H^{q+1}} \frac{\| u_{\theta,M}\|_{W^{1,\infty}}^2}{| u |_{H^{q+1}}},
	\end{equation}
	with
    \begin{equation}
		\label{eq:CthetaM}C_{\theta,M}=\|u_{\theta,M}^{-1}\|_{L^{\infty}}
		+2|u_{\theta,M}^{-1}|_{W^{1,\infty}}
		+|u_{\theta,M}^{-1}|_{W^{2,\infty}}.
	\end{equation}
\end{theorem}

\begin{remark}\label{rmk:gain_mul}
The constants $C_{\text{\rm gain},H^1}^{\times,M}$ and $C_{\text{\rm gain},L^2}^{\times,M}$
represents the potential gains in both $H^1$ semi-norm and $L^2$ norm
when using the multiplicative approach, compared
to the error of the classical FEM presented in \cref{thm:classical_error_estimate} with $\mathbb{P}_k$ polynomials.
\end{remark}

\begin{proof}[Proof of \cref{lem:error_estimate_multiplicative}]
	\textbf{$H^1$-error:}
	Considering the trial space defined in \eqref{eq:Vh_mul}, the numerical solution $u_{h,M}^\times$ is given by
	\[
		u_{h,M}^\times=u_{\theta,M} \; p_h^\times,
	\]
	with $p_h^\times\in 1+ V_h^0\subset 1 + V^0$  solution to \eqref{eq:approachform_mul}.
By coercivity of $a$,
		\[
		\alpha| u_M-u_{h,M}^\times|_{H^1}^2
		\leq a(u_M-u_{h,M}^\times,u_M-u_{h,M}^\times) .
	\]
	Thanks to \eqref{eq:weakform} and \eqref{eq:approachform_mul}, we have the following Galerkin orthogonality: for all $v_h\in V_h^0$,
\begin{equation}\label{eq:orthGalmult}
a(	u_M-u_{h,M}^\times, u_{\theta,M}v_h)=0.
\end{equation}
	For $v_h=p_h^{\times} -\mathcal{I}_h\left(\frac{u_M}{u_{\theta,M}}\right)$, we deduce by definition \eqref{eq:relation_Ih_Ih_tilde} of $\tilde{\mathcal{I}}_h$ that
			$$%\begin{multline*}
	a(u_M-u_{h,M}^\times,u_M-u_{h,M}^\times)
		=a\left(u_M-u_{\theta,M}\mathcal{I}_h\left(\frac{u_M}{u_{\theta,M}}\right),u_M-u_{h,M}^\times\right)
				=a(u_M-\tilde{\mathcal{I}}_h(u_M),u_M-u_{h,M}^\times) .
$$
By continuity of $a$,
\begin{equation}\label{eq:tructruc}
		| u_M-u_{h,M}^\times|_{H^1} \leq \frac{\gamma}{\alpha}| u_M-\tilde{\mathcal{I}}_h(u_M)|_{H^1} .
	\end{equation}
	Again, using the definition \eqref{eq:relation_Ih_Ih_tilde} of $\tilde{\mathcal{I}}_h$,
	\[
		|u_M-\tilde{\mathcal{I}}_h(u_M)|_{H^{1}} \leq
		%\frac{m!}{\lfloor \frac{m}{2} \rfloor!^2}
		\|u_{\theta,M}\|_{W^{1,\infty}} \left\|\frac{u_M}{u_{\theta,M}}-\mathcal{I}_h\left(\frac{u_M}{u_{\theta,M}}\right)\right\|_{H^{1}}.
	\]


	Finally, applying interpolation estimate given in \cref{th:interpol}, it holds
	\begin{equation}\label{eq:interpol tilde Ih}
		|u_M-\tilde{\mathcal{I}}_h(u_M)|_{H^1} \leq C_q
		\|u_{\theta,M}\|_{W^{1,\infty}} h^q \left|\frac{u_M}{u_{\theta,M}}\right|_{H^{q+1}} \,,
	\end{equation}
	with $C_q$ defined in \cref{sec:FEM}.
	%Introducing the error \eqref{eq:classical_error_estimate} associated with the classical finite element without prior, we obtain,
	Combining the last inequality with \eqref{eq:tructruc}, we obtain
	\begin{equation}\label{eq:H1 mult}
		| u-u_h^\times|_{H^1} = | u_M-u_{h,M}^\times|_{H^1} \leq C_q \dfrac{\gamma}{\alpha} C_{\text{\rm gain},H^1}^{\times,M} h^{q}| u |_{H^{q+1}},
	\end{equation}
	with $C_{\text{\rm gain},H^1}^{\times,M}$ given in \eqref{eq:gain_mul}, which conclude the first part of the proof.

	\textbf{$L^2$-error:}
	Again, we follow the Aubin-Nitsche strategy here. Consider the problem
	$$\mathcal{L}^*w=u-u_h^{\times}=u_M-p_h^{\times}u_{\theta,M},$$
	with $w=M$ on $\partial\Omega$. Then,  using the Galerkin orthogonality \eqref{eq:orthGalmult} for $v_h=\mathcal{I}_h\left(\frac{u_M}{u_{\theta,M}}\right)$,
	$$\|u-u_h^{\times}\|_{L^2}^2
		=\|u_M-p_h^{\times}u_{\theta,M}\|_{L^2}^2
		=a(u_M-p_h^{\times}u_{\theta,M},w)
		=a(u_M-p_h^{\times}u_{\theta,M},w-\tilde I_h(w)).$$
    Hence, by continuity of $a$,
	$$\|u-u_h^{\times}\|_{L^2}^2 \leqslant \gamma |u_M-p_h^{\times}u_{\theta,M}|_{H^1}|w-\tilde I_h(w)|_{H^1}.$$
	% Using \eqref{eq:interpol tilde Ih} and \eqref{eq:H1 mult} for $q=1$,
Using \eqref{eq:H1 mult} and \eqref{eq:interpol tilde Ih} for $q=1$ to the term in the right hand side,
	\begin{equation*}
		\|u-u_h^{\times}\|_{L^2}^2
		\leqslant C_1 C_q \dfrac{\gamma^2}{\alpha} \|u_{\theta,M}\|_{W^{1,\infty}} \left|\frac{w}{u_{\theta,M}}\right|_{H^{2}} C_{\text{\rm gain},H^1}^{\times,M} h^{q+1}| u |_{H^{q+1}}.
	\end{equation*}
   Moreover
    $$\left|\frac{w}{u_{\theta,M}}\right|_{H^{2}}\leqslant C_{\theta,M}\|w\|_{H^{2}},$$
    with $C_{\theta,M}$ given in \eqref{eq:CthetaM}.
 Thanks to the elliptic regularity, we obtain
    \begin{equation*}
        \| u-u_h^\times\|_{L^2} \leqslant C_e C_1 C_q\dfrac{\gamma^2}{\alpha} C_{\text{\rm gain},L^2}^{\times,M} \, h^{q+1} |u|_{H^{q+1}},
    \end{equation*}
with $C_{\text{\rm gain},L^2}^{\times,M}$ defined in \eqref{eq:gain_mulL2}.
\end{proof}

\begin{remark}
	\label{rmk:C_gain_multiplicatif}
	We note that the gain constants $C_{\text{\rm gain},H^1}^{\times,M}$ and $C_{\text{\rm gain},L^2}^{\times,M}$
	are similar to the constant $C_\text{\rm gain}^+$
	introduced in \cref{sec:additive_prior},
	in that, it depends on high-order derivatives of the prior.
	Hence, a high-quality prior will necessarily involve
	a good approximation of the derivatives of the exact solution,
	and \cref{rmk:C_gain_additif} also applies in the present context.
	The major difference with the additive approach lies
	in the choice of the lifting constant $M$.
	To better understand this dependency in $M$,
	the following section provides a
	study of the behaviour of our two gain constants
	when $M$ goes to infinity.
	Moreover, the actual choice of $M$ will be
	numerically investigated in \cref{sec:numerical_results}.
\end{remark}

