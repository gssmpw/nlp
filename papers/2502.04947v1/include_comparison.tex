\section{Comparison of the two enriched methods}
\label{sec:comparison_add_mul}

This section aims to compare the two approaches proposed to improve the classical finite element method, the additive approach presented in \cref{sec:additive_prior} and the multiplicative approach proposed in this \cref{sec:multiplicative_prior}. Recall that the constant $M$ is chosen in the multiplicative approach so that $u_M>0$.
Let $u$ be the solution of problem~\eqref{eq:weakform} and $u_{\theta}\in H^{q+1}(\Omega)\cap H^1_0(\Omega)$ be a prior on $u$, with $1\le q\le k$ ($k$ the polynomial degree of the finite element method). Let us first recall the two approaches considered in the present paper:

\paragraph*{Additive approach.} We consider $u_h^+\in V_h^+$ as the solution to the finite element method associated to problem~\eqref{eq:approachform_add} with $V_h^+$ the modified trial space defined in \eqref{eq:Vh_add}, considering $\mathbb{P}_k$ polynomials. Using \cref{lem:error_estimation_add}, we have for $1\le q\le k$,
\begin{equation}
	\label{eq:error_add_comp}
	| u-u_h^+|_{H^1} \leq C_q\dfrac{\gamma}{\alpha} C_\text{\rm gain}^+ \, h^{q} |u|_{H^{q+1}}
\end{equation}
and
\begin{equation}
    \label{eq:error_addL2_comp}
    \| u-u_h^+\|_{L^2} \leqslant C_e C_1 C_q\dfrac{\gamma^2}{\alpha} C_\text{\rm gain}^+ \, h^{q+1} |u|_{H^{q+1}},
\end{equation}
with $C_e$, $C_1$, $C_q$, $\gamma$, $\alpha$ defined in \cref{sec:FEM} and
\begin{equation}
	\label{eq:C_gain_add_in_comparison}
	C_\text{\rm gain}^+= \frac{| u-u_{\theta} |_{H^{q+1}}}{| u |_{H^{q+1}}}.
\end{equation}

\paragraph*{Multiplicative approach.} Let $u_M=u+M$ be the solution of the enhanced problem \eqref{eq:weakform2} and $u_{\theta,M}=u_\theta+M$ be a prior on $u_M$. We consider $u_{h,M}^\times\in V_h^\times$ the solution to the finite element  problem~\eqref{eq:approachform_mul} with $\smash{V_h^\times}$ the modified trial space defined in \eqref{eq:Vh_mul}, considering $\mathbb{P}_k$ polynomials. We then recover the solution of the initial problem by taking $u_h^\times=u_{h,M}^\times-M$.
Using \cref{lem:error_estimate_multiplicative}, we have for $1\le q\le k$,
\begin{equation}
	\label{eq:error_mul_comp}
	| u-u_h^\times|_{H^1} \leq C_q\dfrac{\gamma}{\alpha} C_{\text{\rm gain},H^1}^{\times,M} h^{q}| u |_{H^{q+1}}
\end{equation}
and
\begin{equation}
    \label{eq:error_mulL2_comp}
    \| u-u_h^\times\|_{L^2} \leqslant C_e C_1 C_q\dfrac{\gamma^2}{\alpha} C_{\text{\rm gain},L^2}^{\times,M} \, h^{q+1} |u|_{H^{q+1}},
\end{equation}
with $C_e$, $C_1$, $C_q$, $\gamma$, $\alpha$ defined in \cref{sec:FEM}, and
\begin{equation}
    \label{eq:C_gain_mul_in_comparison}
    C_{\text{\rm gain},H^1}^{\times,M} = \left| \frac{u_M}{u_{\theta,M}} \right|_{H^{q+1}} \frac{\| u_{\theta,M}\|_{W^{1,\infty}}}{| u |_{H^{q+1}}},
\end{equation}
and
\begin{equation}
    \label{eq:gain_mulL2_in_comparison}
    C_{\text{\rm gain},L^2}^{\times,M} =
    C_{\theta,M}\left| \frac{u_M}{u_{\theta,M}} \right|_{H^{q+1}} \frac{\| u_{\theta,M}\|_{W^{1,\infty}}^2}{| u |_{H^{q+1}}},
\end{equation}
with $C_{\theta,M}$ given in \eqref{eq:CthetaM}.

\paragraph*{Comparison of the two approaches.} The following result proves that the upper bound in \eqref{eq:error_mul_comp} and in \eqref{eq:error_mulL2_comp} converges to the one in \eqref{eq:error_add_comp} when $M$ goes to infinity. In other words, the multiplicative gain constants defined in \eqref{eq:C_gain_mul_in_comparison} and \eqref{eq:gain_mulL2_in_comparison} converge to the additive gain constant defined in \eqref{eq:C_gain_add_in_comparison}.

\begin{theorem}\label{thm:comparison_add_mul}
	We have
	\begin{equation}\label{eq:convCH1}
        C_{\text{\rm gain},H^1}^{\times,M}
		\underset{M\rightarrow\infty}{\longrightarrow}
		C^{+}_{\text{\rm gain}}
	\end{equation}
	and
	\begin{equation*}\label{eq:convCL2}
		C_{\text{\rm gain},L^2}^{\times,M}
		\underset{M\rightarrow\infty}{\longrightarrow}
		C^{+}_{\text{\rm gain}}.
	\end{equation*}
\end{theorem}


\begin{proof}
\textbf{Convergence in $H^1$ theoretical gain:}
	According to the expressions \eqref{eq:C_gain_add_in_comparison} and \eqref{eq:C_gain_mul_in_comparison}
	of the gain constants, the objective of the proof is to show that
	\begin{equation*}
		\|u_{\theta,M}\|_{W^{1,\infty}} \left|\frac{u_M}{u_{\theta,M}}\right|_{H^{q+1}} \underset{M\rightarrow\infty}{\longrightarrow} |u-u_\theta|_{H^{q+1}}.
	\end{equation*}
	Denoting by
	\begin{equation*}
		\label{eq:prior_error_approximation}
		E_\theta=u - u_{\theta},
	\end{equation*}
	the error made by the prior $u_{\theta}$
	when approximaing the solution $u$, we have
	\begin{equation*}
		|u-u_\theta|_{H^{q+1}} = |E_\theta|_{H^{q+1}}.
	\end{equation*}
	On the one hand, we have that,
	\begin{equation*}
		\left\|u_{\theta,M}\right\|_{W^{1,\infty}}
		=
		\left\|u_\theta + M \right\|_{W^{1,\infty}}
		=
		M
		\left\|1 + \frac {u_\theta} M \right\|_{W^{1,\infty}}.
	\end{equation*}
	On the other hand, we have,
	\begin{equation*}
		\left|\frac{u_M}{u_{\theta,M}}\right|_{H^{q+1}}
		=
		\left|\frac{u + M}{u_\theta + M}\right|_{H^{q+1}}
		=
		\left|\frac{u - u_\theta + u_\theta + M}{u_\theta + M}\right|_{H^{q+1}}
		=
		\left|1 + \frac{u - u_\theta}{u_\theta + M}\right|_{H^{q+1}}
		=
		\dfrac{1}{M}\left| \frac{E_\theta}{1 + \frac {u_\theta} M}\right|_{H^{q+1}}.
	\end{equation*}
	Multiplying these expressions, we obtain
	\begin{equation}
		\label{eq:error_mul_q2}
		\|u_{\theta,M}\|_{W^{1,\infty}} \left|\frac{u_M}{u_{\theta,M}}\right|_{H^{q+1}}= \underbrace{\left\|1+\frac{u_\theta}{M}\right\|_{W^{1,\infty}}}_{\MakeUppercase{\romannumeral 1}} \;
		\underbrace{\left|\frac{E_\theta}{1+\frac{u_\theta}{M}}\right|_{H^{q+1}}}_{\MakeUppercase{\romannumeral 2}}.
	\end{equation}

	We now estimate term by term the right-hand side of the
	above equality \eqref{eq:error_mul_q2}, looking at their
	limits when $M$ goes to infinity.

	\textbf{Term \MakeUppercase{\romannumeral 1}:} By decomposing the first term, we obtain
	\[
		(\MakeUppercase{\romannumeral 1})=\left\|1+\frac{u_\theta}{M}\right\|_{W^{1,\infty}}=\left\|1+\frac{u_\theta}{M}\right\|_{L^\infty} + \frac{1}{M}\|\nabla u_\theta\|_{L^\infty}\underset{M\to\infty}{\longrightarrow} 1,
	\]
	since
	\begin{equation}\label{eq:plus_d_idee_de_label}
		1-\frac{\|u_\theta\|_{\infty}}{M}
		\le
		\left\|1+\frac{u_\theta}{M}\right\|_{L^\infty}
		\le
		1+\frac{\|u_\theta\|_{\infty}}{M}.
	\end{equation}


	\textbf{Term \MakeUppercase{\romannumeral 2}:}
	Let us prove that
	\begin{equation*}
		%\left|M + \frac{E_\theta}{1+\frac{u_\theta}{M}}\right|_{H^{q+1}}
		%=
	(\MakeUppercase{\romannumeral 2})=	\left|\frac{E_\theta}{1+\frac{u_\theta}{M}}\right|_{H^{q+1}}\underset{M\rightarrow\infty}{\longrightarrow} |E_\theta|_{H^{q+1}}.
	\end{equation*}
	We have
	\begin{align*}
		\left|\left|\frac{E_\theta}{1+\frac{u_\theta}{M}}\right|_{H^{q+1}}^2-|E_\theta|_{H^{q+1}}^2\right| & \le \left|\frac{E_\theta}{1+\frac{u_\theta}{M}}-E_\theta\right|_{H^{q+1}}^2                                    \\
		& = \left\|\nabla^{q+1}\left(\frac{E_\theta}{1+\frac{u_\theta}{M}}-E_\theta\right)\right\|_{L^2}^2
		\leqslant |\Omega| \left\|\nabla^{q+1}\left(\frac{E_\theta}{1+\frac{u_\theta}{M}}-E_\theta\right)\right\|_{L^\infty}^2.
	\end{align*}
	Then, using the general Leibniz rule, we have,


    \begin{align*}
		\left\|\nabla^{q+1}\left(\frac{E_\theta}{1+\frac{u_\theta}{M}}-E_\theta\right)\right\|_{L^\infty} & \leqslant
		\left\|\frac{\nabla^{q+1}E_\theta}{1+\frac{u_\theta}{M}}-\nabla^{q+1}E_\theta\right\|_{L^\infty}
		+\sum_{s=1}^{q+1} \begin{pmatrix} q+1 \\ s \end{pmatrix}
		\left\|\nabla^{q+1-s}E_\theta\right\|_{L^{\infty}}\left\|\nabla^{s}\left(\frac{1}{1+\frac{u_\theta}{M}}\right)\right\|_{L^\infty} \\
		& \leqslant
		\underbrace{ \left\|\frac{\nabla^{q+1}E_\theta}{1+\frac{u_\theta}{M}}-\nabla^{q+1}E_\theta\right\|_{L^\infty} }_{(1)}
		+\|E_\theta\|_{W^{q+1,{\infty}}} \sum_{s=1}^{q+1} \begin{pmatrix} q+1 \\ s \end{pmatrix}
		\underbrace{ \left\|\nabla^{s}\left(\frac{1}{1+\frac{u_\theta}{M}}\right)\right\|_{L^\infty} }_{(2)} .
	\end{align*}

	We now estimate terms (1) and (2) in the right-hand side of the above inequality.


	\textbf{Term (1):}
	Taking $M> \|u_{\theta}\|_{L^\infty}$, we obtain
	\begin{align*}
		%\left\|\frac{\nabla^{q+1}E_\theta}{1+\frac{u_\theta}{M}}-\nabla^{q+1}E_\theta\right\|_{L^\infty}
		(1)\le	\left\|\frac{1}{1+\frac{u_\theta}{M}}-1\right\|_{L^\infty}\|\nabla^{q+1}E_\theta\|_{L^\infty}
		& \le \frac{1}{M} \frac{\|u_\theta\|_{L^\infty}}{1-\frac{\|u_\theta\|_{L^\infty}}{M}} \|\nabla^{q+1}E_\theta\|_{L^\infty} \underset{M\to\infty}{\longrightarrow}0.
	\end{align*}

	\textbf{Term (2):} Using the Fa\`{a} di Bruno formula and \eqref{eq:plus_d_idee_de_label}, there exists a constant $C>0$ such that, for any $M> \|u_{\theta}\|_{L^\infty}$ and $1\le s\le q+1$,
	the following estimate holds
	\begin{equation*}
	%	\left\|\nabla^{s}\left(\frac{1}{1+\frac{u_\theta}{M}}\right)\right\|_{L^\infty}
	(2)	\leqslant C\frac{\prod_{m=0}^s\|\nabla^m\left(1+\frac{u_\theta}{M}\right)\|_{L^{\infty}}}{\left\|1+\frac{u_\theta}{M}\right\|_{\infty}^{s+1}}
\leqslant C\dfrac{1}{M^{s}}\frac{\left(1+\frac{\|u_\theta\|_{\infty}}{M}\right)\prod_{m=1}^s\|\nabla^m u_\theta\|_{L^{\infty}}^{s}}{\left(1-\frac{\|u_\theta\|_{\infty}}{M}\right)^{s+1}}
		\underset{M\to\infty}{\longrightarrow}0,
	\end{equation*}
	which leads to \eqref{eq:convCH1}.

\textbf{Convergence in $L^2$ theoretical gain:} Using the convergence of the gain for the $H^1$ semi-norm, we only lead to prove that
$$C_{\theta,M}\|u_{\theta,M}\|_{W^{1,\infty}}
\underset{M\rightarrow\infty}{\longrightarrow}1,$$
with $C_{\theta,M}$ given by
$$C_{\theta,M}=\|u_{\theta,M}^{-1}\|_{L^{\infty}}
		+2|u_{\theta,M}^{-1}|_{W^{1,\infty}}
		+|u_{\theta,M}^{-1}|_{W^{2,\infty}}.$$
Since
	$$\dfrac{1}{M}\|u_{\theta,M}\|_{W^{1,\infty}}\underset{M\rightarrow\infty}{\longrightarrow}1,$$
	let us only prove that
$$MC_{\theta,M}
\underset{M\rightarrow\infty}{\longrightarrow}1.$$
% 	We have
% $$M\|u_{\theta,M}^{-1}\|_{L^{\infty}}
% =\left\|\dfrac{M}{u_{\theta}+M}\right\|_{L^{\infty}}
% \leqslant 1+\left\|\dfrac{u_{\theta}}{u_{\theta}+M}\right\|_{L^{\infty}}
% \underset{M\rightarrow\infty}{\longrightarrow}1.$$
Considering $M> \|u_{\theta}\|_{L^\infty}$, we have
$$M\|u_{\theta,M}^{-1}\|_{L^{\infty}}
=\left\|\dfrac{1}{1+\dfrac{u_\theta}{M}}\right\|_{L^{\infty}}
\leqslant \dfrac{1}{1-\dfrac{\|u_\theta\|_{L^\infty}}{M}}
\underset{M\rightarrow\infty}{\longrightarrow}1.$$
Moreover
$$2M|u_{\theta,M}^{-1}|_{W^{1,\infty}}
=2M\left\|\dfrac{\nabla u_{\theta}}{(u_{\theta}+M)^2}\right\|_{L^{\infty}}
\underset{M\rightarrow\infty}{\longrightarrow}0.$$
Similarly
$$M|u_{\theta,M}^{-1}|_{W^{2,\infty}}
%=\left\|\dfrac{\nabla u_{\theta}}{(u_{\theta}+M)}\right\|_{L^{\infty}}
\underset{M\rightarrow\infty}{\longrightarrow}0,$$
which leads to the conclusion.

\end{proof}
