
\section{Hyperparameters Search}
\label{app:hp}
To find the best hyperparameters, we employ a grid search exploring different values as shown in Table \ref{tab:hp2}. Regarding the hyperparameters of DeepLOB and BiNCTABL, we used the one used in \cite{prata2024lob} after a large hyperparameters search. We remark that with higher sequence sizes than 128, the performances reach a plateau. For TLOB we searched also for the optimal number of heads, and we noted that there was not difference in between performance between 1, 2, 4 and so we fixed the number of heads to 1.
\begin{table}[!h]
\caption{The hyperparameter search spaces and best choices for each model.}
\label{tab:hp2}
\centering
\begin{tabular}{@{}llll@{}}
\toprule
Hyperparameter         & Search Space          & TLOB  & MLPLOB 
\\ \midrule
Optimizer              & \{Adam \cite{diederik2014adam}, Lion \cite{chen2024symbolic}\}  & Adam   & Adam      \\
Sequence size              & \{64, 128, 256, 384, 512\}  & 128 & 128         \\
Learning rate          & \{0.001, 0.0003, 0.0001\}  & 0.0001  & 0.003 \\
Number of layers             & \{2, 3, 4, 6\}  & 4 & 3        \\
\bottomrule
\end{tabular}
\end{table}
\newpage
\section{Additional Results}
We report the precision and recall curves for FI-2010 (Fig. \ref{fig:pr_fi}), INTC (Fig. \ref{fig:pr_intc}) and TSLA (Fig. \ref{fig:pr_tsla}), for horizon 100. As shown, across the different datasets, TLOB and MLPLOB consistently achieve higher precision at all recall levels compared to the other models. TLOB and MLPLOB, for INTC, exhibit excellent precision at low recall values, indicating their ability to accurately identify the most confident positive instances. Specifically for FI-2010, they exhibit very high precision, also at high recall values.
\label{app:results}


\begin{figure*}
    \includegraphics[width=\linewidth]{images/precision_recall_curve_INTC.pdf}
    \caption{Precision and Recall curve for INTC for horizon = 100.}
    \label{fig:pr_intc}
\end{figure*}

\begin{figure*}[!h]
    \centering
    \includegraphics[width=\linewidth]{images/precision_recall_curve_TSLA.pdf}
    \caption{Precision and Recall curve for TSLA for horizon = 100.}
    \label{fig:pr_tsla}
\end{figure*}
