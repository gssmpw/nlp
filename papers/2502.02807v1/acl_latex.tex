% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
% \usepackage[review]{acl}
\usepackage[final]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}
\usepackage{comment}
% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}
\usepackage{array}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{colortbl}
\usepackage{soul}
\usepackage{pifont}


\newcommand{\todo}[1]{\textcolor{purple}{#1}}
\newcommand{\jjcomment}[1]{\textcolor{blue}{[~Jing: #1~]}}

% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\title{CAMI: A Counselor Agent Supporting Motivational Interviewing through State Inference and Topic Exploration}
% Aek's suggestions:
% Improving Motivational Interviewing Outcomes in LLM-Based Counselor Agents through State Estimation and Topic Exploration
% Improving LLM-Based Motivational Interviewing Agents Beyond Turn-Level Strategies with State Estimation and Topic Exploration
% An LLM-Based Motivational Interviewing Agent with Personalized State Estimation and Change Talk Exploration
% A Novel Framework for LLM-Based Motivational Interviewing Agents Using Topic Trees for Change Talk Exploration
% Enhancing Change Talk Exploration and Evocation in LLM-Based Counselor Agents with Topic Trees

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

% \author{First Author \\
%   Affiliation / Address line 1 \\
%   Affiliation / Address line 2 \\
%   Affiliation / Address line 3 \\
%   \texttt{email@domain} \\\And
%   Second Author \\
%   Affiliation / Address line 1 \\
%   Affiliation / Address line 2 \\
%   Affiliation / Address line 3 \\
%   \texttt{email@domain} \\}

\author{
 \textbf{Yizhe Yang\textsuperscript{1}~\thanks{Work was done during a visit at SMU.}},
 \textbf{Palakorn Achananuparp\textsuperscript{2}},
 \textbf{Heyan Huang\textsuperscript{1}~\thanks{Corresponding Author}},
 \textbf{Jing Jiang\textsuperscript{3}},
\\
 \textbf{Kit Phey Leng \textsuperscript{4}},
 \textbf{Nicholas Gabriel Lim \textsuperscript{5}},
 \textbf{Cameron Tan Shi Ern \textsuperscript{6}},
 \textbf{Ee-peng Lim\textsuperscript{2}}
\\
\\
 \textsuperscript{1}Beijing Institute of Technology,
 \textsuperscript{2}Singapore Management University,
 \textsuperscript{3}Australian National University, 
 \\
 \textsuperscript{4}National Institute of Education,
 \textsuperscript{5}Singapore University of Social Sciences,
 \textsuperscript{6}National University of Singapore
\\
 \small{
   % \textbf{Correspondence:} \href{mailto:email@domain}{email@domain}
   \{yizheyang,hhy63\}@bit.edu.cn, \{palakorna,eplim\}@smu.edu.sg, jing.jiang@anu.edu.au
 }
}

\begin{document}
\maketitle
\begin{abstract}
Conversational counselor agents have become essential tools for addressing the rising demand for scalable and accessible mental health support. This paper introduces 
CAMI, a novel automated counselor agent grounded in Motivational Interviewing (MI) -- a client-centered counseling approach designed to address ambivalence and facilitate behavior change.  
CAMI employs a novel STAR framework, consisting of client's state inference, motivation topic exploration, and response generation modules, leveraging large language models (LLMs). These components work together to evoke change talk, aligning with MI principles and improving counseling outcomes for clients from diverse backgrounds.
We evaluate CAMIâ€™s performance through both automated and manual evaluations, utilizing simulated clients to assess MI skill competency, client's state inference accuracy, topic exploration proficiency, and overall counseling success. 
Results show that CAMI not only outperforms several state-of-the-art methods but also shows more realistic counselor-like behavior. Additionally, our ablation study underscores the critical roles of state inference and topic exploration in achieving this performance.

\end{abstract}

\input{sections/introduction}

\input{sections/related_work}

\input{sections/approach}

\input{sections/experiment}

\section{Conclusion}
In this paper, we address the challenges of using LLMs to create counselor agents that practice motivational interviewing style counseling using our proposed STAR framework.  This framework includes client's state inference, topic exploration for change talk, and MI-adherent strategy selection.  Based on the framework, we develop CAMI a counselor agent that engages clients in change talks making positive changes to their behaviors. By extracting motivation topics and their superclass relationships from AnnoMI dataset and Wikipedia knowledge base, we construct a novel topic tree covering hierarchical motivation topics that can be navigated by CAMI as it explores the topics of change talk for clients having diverse profiles. Furthermore, CAMI selects strategies from MI skills to generate strategy-aligned responses. Extensive experiments and analyses, including automated and expert user evaluations, show that the STAR framework underlying CAMI effectively guides LLMs to adhere to MI techniques. CAMI also outperforms state-of-the-art counseling agents in our comprehensive evaluation, reducing the gap between human and AI-based counseling. 

\section*{Limitations}
Although CAMI shows promising results in MI-based counseling, we could identify three main limitations which can be addressed in the future work.

Firstly, our work has not studied how sensitive is CAMI to the multiple steps of prompting due to the accumulation of generation errors. Even though some aspects of the performance, such as topic exploration, are not optimal, we believe that other methods could be implemented to improve module performance while maintaining the novelty and effectiveness of the overall framework. Designing effective prompts and evaluating their performance are therefore important areas for further research. 

Secondly, our framework currently relies on LLM prompting to perform state inference, topic exploration and strategy selection. Our human experts have raised concerns about issues related to strategy use, such as counselor responses being too lengthy and using too many questions. In our future work, we would therefore plan to enhance the strategy selection module further such as incorporating the idea of action rules introduced in DIIR. 

Finally, our study focuses on MI-based counseling and the AnnoMI dataset.  However, the proposed STAR framework can be adapted to other counseling techniques, such as Cognitive Behavioral Therapy (CBT), and relevant counseling datasets.  Future research could explore the integration of MI and CBT techniques within a single counselor agent, potentially enhancing the counseling effectiveness. 

\section*{Ethical Considerations}
This work does not advocate for the direct use of LLMs in therapy. Although our proposed CAMI system outperforms previous methods and demonstrates proficiency in MI techniques, it still falls short of the expertise provided by high-quality human counselors. Therefore, we do not suggest that LLMs should replace the role of human counselors. While the outputs of LLMs are certainly not as specialized or accurate as those of professionals, they can serve as supplementary tools to support and inspire human-led exploration. Our goal is to provide an alternative approach for applying LLMs in psychological support, offering ideas that may spark further discussions and development in the field of NLP and psychology. We believe this can help advance future research in AI applications for psychology and sociology. Moreover, while MI techniques aim to facilitate positive change, system deployers should carefully assess the topics covered to mitigate potential risks. Additionally, users interacting with systems incorporating MI abilities should be informed of the system's identity, ensuring they are aware of the nature of their interaction and can make an informed choice.


% Bibliography entries for the entire Anthology, followed by custom entries
%\bibliography{anthology,custom}
% Custom bibliography entries only
\bibliography{custom}

\appendix

\input{sections/implement}

\input{sections/human_evaluation}

\input{sections/example}

\end{document}
