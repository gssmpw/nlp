\begin{table}[h]
	\caption{Forward \flops per for token for embedding projector, a single transformer layer, final normalization and output layer. \emph{Ours} indicates the expressions we use in the paper for the total (note that the quantity $C_\text{Forward}$ that appears in compute constraints is the number of \emph{non-embedding floating operations}. \emph{Approx.} indicates taking the within-section total and dropping all terms that are not at least quadratic in one of $\dmodel,\nvocab$, and will be used for estimating the FLOPs per token from a given model size (\Cref{ssec:alternative-approximation-for-flops-per-token-as-a-function-of-n}).}
	\label{tab:flops-count}
	\centering
	\resizebox{1.0\textwidth}{!}{
		\begin{tabular}{lcccc}
			\toprule
			\flops                           & \cite{DBLP:journals/corr/abs-2001-08361}                                    & \cite{DBLP:journals/corr/abs-2203-15556}       & \cite{DBLP:conf/sc/NarayananSCLPKV21} & Ours   (Total)                          \\
			\midrule
			Embedding                        & $4\dmodel$                                                                  & $2\nvocab \dmodel$                             & ---                                   & $2\dmodel$                              \\ \midrule
			\multicolumn{5}{l}{\emph{Attention (one transformer layer)}}                                                                                                                                                                                      \\ \midrule
			PreNorm                          & ---                                                                         & ---                                            & ---                                   & ---                                     \\
			QKNorm                           & ---                                                                         & ---                                            & ---                                   & ---                                     \\
			QKV                              & $3 \nheads 2\dmodel \dhead$                                                 & $3 \nheads2 \dmodel \dhead$                    & $3 \nheads 2 \dmodel \dhead$          & $ (\nheads+ 2\nkvheads)2\dmodel \dhead$ \\
			Logits                           & $2 \nheads \nctx \dhead$                                                    & $2 \nheads \nctx \dhead$                       & $2 \nheads \nctx \dhead$              & $ \nheads \nctx \dhead$                 \\
			Softmax                          & ---                                                                         & $3 \nheads \nctx$                              & ---                                   & $2.5 \nheads \nctx$                     \\
			Values                           & ---                                                                         & $2 \nheads \nctx \dhead$                       & $2 \nheads \nctx \dhead$              & $ \nheads \nctx \dhead$                 \\
			Project                          & $\nheads 2\dhead \dmodel$                                                   & $\nheads 2\dhead \dmodel$                      & $\nheads 2\dhead \dmodel$             & $\nheads 2\dhead \dmodel$               \\
			Total                            & $2\nheads\dhead(4\dmodel+\nctx )$                                           & $4\nheads\dhead(2\dmodel+\nctx)+3\nheads\nctx$ &
			$4\nheads\dhead(2\dmodel+\nctx)$ & $4\nheads\dhead(\dmodel+\nctx / 2)+4\nkvheads\dmodel\dhead+2.5\nheads\nctx$                                                                                                                                    \\
			Approx.                          & $2\nheads\dhead(4\dmodel+\nctx)$                                            & $4\nheads\dhead(2\dmodel+\nctx)+3\nheads\nctx$ &
			$4\nheads\dhead(2\dmodel+\nctx)$ & $4\nheads\dhead(\dmodel+\nctx/ 2)+4\nkvheads\dmodel\dhead$
			\\
			\midrule
			\multicolumn{5}{l}{\emph{Feed-forward (one transformer layer)}}                                                                                                                                                                                   \\ \midrule
			PreNorm                          & ---                                                                         & ---                                            & ---                                   & ---                                     \\
			MLP                              & $4 \dmodel \dffn$                                                           & $4 \dmodel \dffn$                              & $4\dmodel \dffn$                      & $2\nffn\dmodel \dffn$                   \\ \midrule
			OutputNorm                       & ---                                                                         & ---                                            & ---                                   & ---                                     \\
			Final logits                     & $2 \nvocab \dmodel$                                                         & $2 \nvocab \dmodel$                            & $2 \nvocab \dmodel$                   & $2 \nvocab \dmodel$                     \\
			\bottomrule
		\end{tabular}
	}
\end{table}

\begin{table}[h]
	\caption{Forward \flops counts per token from \Cref{tab:flops-count} simplified using $\nheads\dhead=\dmodel$, $\dffn=\rho \dmodel$, and $\nheads=\gsize \nkvheads$.}
	\label{tab:flops-count-simple}
	\centering
	\resizebox{1.0\textwidth}{!}{
		\begin{tabular}{lcccc}
			\toprule
			\flops                     & \cite{DBLP:journals/corr/abs-2001-08361}                  & \cite{DBLP:journals/corr/abs-2203-15556} & \cite{DBLP:conf/sc/NarayananSCLPKV21} & Ours (Total)               \\
			\midrule
			Embedding                  & $4\dmodel$                                                & $2\nvocab \dmodel$                       & ---                                   & $2\dmodel$                 \\ \midrule
			\multicolumn{5}{l}{\emph{Attention (one transformer layer)}}                                                                                                                                           \\ \midrule
			PreNorm                    & ---                                                       & ---                                      & ---                                   & ---                        \\
			QKNorm                     & ---                                                       & ---                                      & ---                                   & ---                        \\
			QKV                        & $6 \dmodel^2$                                             & $6\dmodel^2$                             & $6\dmodel^2$                          & $ 2(1+ 2/\gsize)\dmodel^2$ \\
			Logits                     & $2 \dmodel \nctx$                                         & $2 \dmodel \nctx$                        & $2 \dmodel \nctx$                     & $\dmodel \nctx$            \\
			Softmax                    & ---                                                       & $3 \nheads \nctx$                        & ---                                   & $2.5\nheads \nctx$         \\
			Values                     & ---                                                       & $2 \dmodel \nctx$                        & $2 \dmodel \nctx$                     & $\dmodel \nctx$            \\
			Project                    & $2 \dmodel^2$                                             & $2\dmodel^2$                             & $ 2 \dmodel^2$                        & $ 2 \dmodel^2$             \\
			Total                      & $8\dmodel^2+2\nctx\dmodel$                                & $8\dmodel^2+4\nctx\dmodel+3\nheads\nctx$ &
			$8\dmodel^2+4\nctx\dmodel$ & $(4 + 4/\gsize)\dmodel^2 + 2\nctx\dmodel+2.5\nheads\nctx$                                                                                                                 \\
			Approx.                    & $8\dmodel^2+2\nctx\dmodel$                                & $8\dmodel^2+4\nctx\dmodel+3\nheads\nctx$ &
			$8\dmodel^2+4\nctx\dmodel$ & $(4 + 4/\gsize)\dmodel^2 + 2\nctx\dmodel$
			\\
			\midrule
			\multicolumn{5}{l}{\emph{Feed-forward (one transformer layer)}}                                                                                                                                        \\ \midrule
			PreNorm                    & ---                                                       & ---                                      & ---                                   & ---                        \\
			MLP                        & $4 \rffn\dmodel^2$                                        & $4 \rffn\dmodel^2$                       & $4 \rffn\dmodel^2$                    & $2\nffn \rffn\dmodel^2$    \\ \midrule
			OutputNorm                 & ---                                                       & ---                                      & ---                                   & ---                        \\
			Final logits               & $2 \nvocab \dmodel$                                       & $2 \nvocab \dmodel$                      & $2 \nvocab \dmodel$                   & $2 \nvocab \dmodel$        \\
			\bottomrule
		\end{tabular}
	}
\end{table}
