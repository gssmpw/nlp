\definecolor{codeblue}{rgb}{0.25,0.5,0.5}
\lstset{
	backgroundcolor=\color{white},
	basicstyle=\fontsize{7.2pt}{7.2pt}\ttfamily\selectfont,
	breaklines=true,
	keepspaces=true,
	captionpos=b,
	stringstyle=\fontsize{7.2pt}{7.2pt}\color{ApplePrimaryChartRed},
	commentstyle=\fontsize{7.2pt}{7.2pt}\color{ApplePrimaryChartBlue},
	keywordstyle=\fontsize{7.2pt}{7.2pt},
	showstringspaces=false,
}
\begin{lstlisting}[language=Python]
    def find(vector, value):
        """Find locations of value in vector."""
        return np.where(vector == value)[0]

    def remove(vector, value):
        """Find value from vector."""
        return np.delete(vector, find(vector, value))

    def label(vector: np.ndarray, num_classes: int) -> np.ndarray:
        """Return the label in [0, num_classes) for vector."""
        assert len(vector) == 2 * num_classes
        one_hot = vector[num_classes:]
        context = vector[:num_classes]
        i = find(one_hot, 1)
        if context[i] == 0:
            return i
        else:    # remapping
            c = context[i]
            return remove(find(context, c), i)
\end{lstlisting}
