\section{Related work}
%室内指纹定位近年来成为研究热点，然而，由于室内环境复杂多变，无线信号易受多径效应、环境变化和人员走动等因素影响，导致定位精度下降。为了提高室内指纹定位的鲁棒性和精度，研究人员提出了许多改进方法来应对动态定位时的挑战，主要集中在以下两个方面：
%1)基于自适应指纹库的室内定位（众包、传感器辅助、数据增强、半监督、无监督）
%众包是一种利用群体智慧解决问题的方法，近年来被广泛应用于室内定位领域 [____]。[____]提出了一种高效的指纹众包方法，通过参与者手持智能手机沿路径行走时收集RSS数据，并采用高斯过程进行定位。
%传感器辅助的室内定位技术利用移动设备上的各种传感器 (例如低功耗蓝牙（BLE）、快速响应（QR）码和微机电系统传感器等) 收集数据，并利用这些数据进行定位 [____]。[____]通过结合惯性数据、局部磁场和Wi-Fi信号，应用多模式方法构建高度准确的指纹。
%
%数据增强技术和弱监督学习技术近年来被广泛应用于室内定位领域，可以有效解决传统方法面临的一些挑战，例如数据稀疏性、环境变化等____。在保持较低在线复杂度的同时，如何通过监督学习提高室内定位技术的精度。[____]特别关注了未标记数据和缺失数据的问题，提出了基于加权半监督DNN和生成对抗性网络（GANs）的室内定位方法，以提高定位精度并降低数据收集成本。[____]通过使用自动编码器提取高级特征，并结合众包的标记和未标记数据，提出了一种新的基于指纹的室内定位算法，以提高定位性能。[____]通过极限学习机（ELM）和迭代自组织数据分析算法（ISODATA），提出了一种新的室内定位技术，该技术对RSSI测量值进行分类学习和特征提取，并利用半监督回归学习得到位置回归函数。考虑到现有方法在安全性方面存在缺陷，易受恶意攻击影响，[____]提出了一种名为SE-LOC的技术，该技术基于半监督学习，旨在增强基于指纹的定位系统的安全性和弹性。另外，无监督学习方法无需人工标注数据，也在定位当中得到应用。[____]探讨了在复杂环境中，如何通过无监督视角选择深度学习（UVSDL）方法提高室内定位系统的准确性，尤其是在非视距（NLOS）配置中。[____]提出了一种用于室内定位系统的对抗性深度学习（ADVLOC）方法，以增强系统对对抗性攻击的弹性。
%
%上述方法要么以特征同质为前提，要么需要提前给出所有校准数据，因此无法同时解决不同时间尺度的挑战。
%
%2)基于知识转移的室内定位(迁移学习、异构迁移学习、元学习)
%这些方法，无论是基于纯粹的统计信号处理还是数据驱动的方法，往往难以推广到新的环境，这导致浪费了大量的时间和精力____。
%为了应对室内定位中传播环境变化导致的性能下降问题，[____]基于多核迁移学习技术提出了一种低复杂度的自校准室内众包定位系统。[____]通过迁移学习（TL）支持的分类系统，将一维信号转换为图像，并使用光谱图、尺度图或Gramian角度场等技术。[____]提出了一种基于领域自适应和聚类假设的WiFi定位系统FIDORA，旨在解决现有WiFi指纹系统在面对不同体型用户和环境变化时的局限性。[____]尤其关注了环境变化、设备异构性和接入点（AP）的变化导致的离线和在线RSS指纹之间的域转换,提出了一种新的领域对抗性回归神经网络（DANN-R）,使用自动编码器作为降维技术，并采用梯度反转层（GRL）进行对抗性学习，以缓解动态物联网环境中的挑战。为了提高对历史任务数据的利用效率以及模型在新环境的适应速度， [____]通过与模型无关的元学习（MAML）和深度神经网络，提出了MetalOC框架，利用校准良好的环境历史数据进行训练，采用双循环优化机制获得元参数。
%
%基于以上观察，他们大多仅考虑单个源域目标域对的知识迁移，不同保证连续动态环境的鲁棒性；以及在在现阶段需要在线样本的标签，这在实时定位应用程序中并不容易获得。我们提出端到端的DF-Loc来同时解决多个时间尺度上的特征分布差异和标注样本成本。

Indoor fingerprint localization has become a research hotspot in recent years. However, due to the complex and dynamic nature of indoor environments, wireless signals are susceptible to multipath effects, environmental changes, and pedestrian movement, which can degrade localization accuracy. To enhance the robustness and accuracy of indoor fingerprint localization, researchers have proposed various methods to address the challenges posed by dynamic localization, primarily focusing on the following two aspects:

\subsection{Adaptive Fingerprint-based Indoor Localization}
Crowdsourcing, a method leveraging collective intelligence for problem-solving, has been widely adopted in indoor localization ____. For instance, Wei et al. ____ proposed an efficient crowdsourcing approach for fingerprint collection. In this approach, participants collect RSS data using smartphones while traversing a path, and Gaussian processes are employed for localization.

Sensor-aided indoor localization techniques leverage data collected by various sensors on mobile devices, such as Bluetooth Low Energy (BLE), Quick Response (QR) codes, and Micro-Electro-Mechanical System (MEMS) sensors ____. Santos et al. ____ employed a multimodal approach to construct highly accurate fingerprints by integrating inertial data, local magnetic fields, and Wi-Fi signals.

Data augmentation and weakly supervised learning techniques have been increasingly applied to address challenges in indoor localization, such as data sparsity and environmental dynamics ____. These techniques aim to enhance localization accuracy through supervised learning while maintaining low online complexity.  Njima et al. ____ addressed the issue of unlabeled and missing data by proposing a weighted semi-supervised DNN and Generative Adversarial Network (GAN)-based indoor localization method. This method improves localization accuracy and reduces data collection costs. Khatab et al. ____ introduced a novel fingerprint-based indoor localization algorithm that utilizes an autoencoder for high-level feature extraction and combines crowdsourced labeled and unlabeled data to enhance localization performance. Yan et al. ____ proposed a new indoor localization technique based on Extreme Learning Machine (ELM) and Iterative Self-Organizing Data Analysis Algorithm (ISODATA). This technique performs classification learning and feature extraction on RSSI measurements and employs semi-supervised regression learning to obtain a location regression function. Considering the security vulnerabilities of existing methods and their susceptibility to malicious attacks, Ye et al. ____ proposed SE-LOC, a technique based on semi-supervised learning designed to enhance the security and resilience of fingerprint-based localization systems.  Furthermore, unsupervised learning methods, which eliminate the need for manual data labeling, have also found applications in localization. Kim et al. ____ explored the use of Unsupervised View Selection Deep Learning (UVSDL) to improve the accuracy of indoor localization systems in complex environments, particularly in NLOS scenarios. Wang et al. ____ proposed an Adversarial Deep Learning (ADVLOC) method for indoor localization systems to enhance their resilience against adversarial attacks.

However, the aforementioned methods either assume feature homogeneity or require all calibration data to be provided in advance, thus failing to address the challenges associated with varying time scales.

\begin{table}[!t]
	\centering
	\caption{List of Notations.} %(posture=$ f_4 $)
	\label{List of Notations}
	\renewcommand{\arraystretch}{1.2} % 设置行高为原来的1.5倍
	\begin{tabular}{p{1.5cm} p{6.5cm}} % 使用p{宽度}来自动换行
		\toprule
		\textbf{Notation}   & \textbf{Definition} \\
		\midrule
		
		$\mathcal{D}_S^{\left( i \right)}$ & the source domain in time period $ t_i $  \\ 
		$\mathbf{X}_{S}$ & the source-domain data \\
		$\boldsymbol{L}_{S}$ & source labels \\
		$\mathcal{N}_S$ & The number of source samples \\
		$d_S$ & source dimensions \\
		\midrule
		
		$\mathcal{D}_{T}^{\left( j \right)}$ & the labeled target domain in time period $ t_j $ \\
		$\mathbf{X}_{T}^{\left( j \right)}$ & the target-domain data collected in time period $ t_j $\\
		$\boldsymbol{L}_{T}^{\left( j \right)}$ & target labels collected in $ t_j $\\
		$\mathcal{N}_{T}^{\left( j \right)}$ & The number of target samples in $ t_j $\\
		$d_{T}^{\left( j \right)}$ & source dimensions \\
		$\boldsymbol{A}$ & mapping function \\
		
		\midrule
		
		$\mathcal{N}$ & $\mathcal{N}=\mathcal{N}_S+\mathcal{N}_T$, the total number of samples in source and target domains \\
		$g_{r}$ & The number of training reference points \\
		$g_t$ & The number of test reference points \\
		$G$ & $ G=g_r+g_t $, the total number of reference points \\
		\bottomrule
	\end{tabular}
\end{table}

\subsection{Knowledge Transfer for Indoor Localization}
Existing indoor localization methods, whether based on purely statistical signal processing or data-driven approaches, often struggle to generalize to new environments. This limitation leads to significant time and effort wasted in recalibration and retraining ____.

To address the performance degradation caused by changes in the propagation environment, Xiang et al. ____ proposed a low-complexity self-calibrating indoor crowdsourcing localization system based on multi-kernel TL.  Kerdjidj et al. ____ presented a TL-supported classification system that transforms one-dimensional signals into images and utilizes techniques such as spectrograms, scalograms, or Gramian Angular Fields. Chen et al. ____ introduced FIDORA, a WiFi localization system based on domain adaptation and clustering assumptions, to address the limitations of existing WiFi fingerprinting systems when faced with varying user body types and environmental changes. Prasad et al. ____ focused on the domain shift between offline and online RSS fingerprints caused by environmental changes, device heterogeneity, and AP variations. They proposed a novel Domain Adversarial Regression Neural Network (DANN-R) that uses an autoencoder for dimensionality reduction and employs a Gradient Reversal Layer (GRL) for adversarial learning to mitigate challenges in dynamic IoT environments.To improve the utilization of historical task data and the adaptation speed of the model to new environments, Gao et al. ____ proposed the MetalOC framework, which combines Model-Agnostic Meta-Learning (MAML) with DNNs. This framework utilizes historical data from well-calibrated environments for training and employs a bi-level optimization mechanism to obtain meta-parameters.

However, most of these approaches only consider knowledge transfer between a single source and target domain pair, which cannot guarantee robustness in continuously dynamic environments. Moreover, they require labels for online samples in the current stage, which are not readily available in real-time localization applications.  To address these limitations, we propose DF-Loc, an end-to-end framework that tackles both feature distribution discrepancies across multiple time scales and the cost of labeled samples.

\begin{figure*}[!t]
	\centering
	\includegraphics[width=6.5in]{DF-Loc_Dynamic_fingerprint_localization_1}
	\caption{Architecture of DF-Loc.}
	\label{fig_1}
\end{figure*}

\begin{figure*}[!t]
	\centering
	\subfigure[ ]{\includegraphics[width=1.7in]{After_Hample3}%
		\label{fig1_first_case}}
	\hfil
	\subfigure[ ]{\includegraphics[width=1.5in]{compare_WD2}%
		\label{fig1_second_case}}
	\hfil
	\subfigure[ ]{\includegraphics[width=1.6in]{STD}%
		\label{fig1_third_case}}
	\caption{QC-based preprocessing for amplitude. (a) Hampel identifier for coarse outliers removing. (b) Wavelet filter for smoothing sequence. (c) Butterworth low-pass filter implied outliers removing.}
	\label{fig_4}
\end{figure*}