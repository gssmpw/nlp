\begin{algorithm}[t]
    \caption{Provenance Tester for $g$ Given a Candidate Parent Set}
    \label{alg:unknown_parent_tester}
    \begin{algorithmic}
      \Require{Model $g$, candidate set $F=\{f_1,\ldots,f_s\}$, set of control models $C=\{c_1,\ldots,c_m\}$, prompt space $\Omega$, number of prompts $T$, significance  parameter $\alpha$, statistical test ZTest.
      }
      \State $x_1,\ldots,x_T \stackrel{\text{iid}}{\sim} \Omega$ \Comment{Sample T prompts}
  
      \For{$i \gets 1$ to $s$}
          \State $\mu_i \gets \frac{1}{T}\sum_{j=1}^T \mathds{1}(f_i(x_j)=g(x_j))$ \Comment{Calc sim of candidates}
      \EndFor
      
      \For{$i \gets 1$ to $m$}
          \State $\mu'_i \gets \frac{1}{T}\sum_{j=1}^T \mathds{1}(c_i(x_j)=g(x_j))$ \Comment{Calc sim of controls}
      \EndFor
        \State $\mathcal{M} \gets \{\mu_1,\ldots,\mu_s\} \cup \{\mu'_1,\ldots,\mu'_m\}$ \Comment{Set of all sims}
      \State $\mu_{max} \gets \max(\mathcal{M})$ \Comment{Find highest sim}
      
      \If{$\mu_{max} \notin \{\mu_1,\ldots,\mu_s\}$}
          \Return \textsc{False} \Comment{Highest not from $F$, but from $C$, so cannot be parent}
      \EndIf      
      \For{$\mu' \in \mathcal{M} \setminus \{\mu_{max}\}$}
          \State $p_i \gets \text{ZTest}(\mu_{max}, \mu', T)$ \Comment{Compare against  other sims}
      \EndFor
      
      \State $(p_{(1)},\ldots,p_{(s+m-1)}) \gets \text{Sort}(p_1,\ldots,p_{s+m-1})$
      
      \For{$k \gets 1$ to $s+m-1$}
          \State $\alpha_k \gets \alpha/(s+m-k)$ \Comment{Holm-Bonferroni adjustment}
          \If{$p_{(k)} > \alpha_k$}
              \Return \textsc{False}
          \EndIf
      \EndFor
      
      \Return $(\textsc{True}, \argmax_{i \in [s]} \mu_i)$ \Comment{Return parent }
    \end{algorithmic}
  \end{algorithm}
