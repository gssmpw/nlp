\section{Related Work}
We review related work on machine learning-based detection of code vulnerability in terms of different representations of code: (a) code as graphs, (b) code as trees, and (c) code as text.  

Graph-based methods typically capture the structural characteristics of various types of graphs, such as control-flow graphs (CFGs), data-flow graphs (DFGs), and data dependence graphs (DDGs), using techniques such as graph neural networks (GNNs), convolutional neural networks (CNNs), or recurrent neural networks (RNNs), to construct models for detecting vulnerabilities. VulDeePecker **Zhou, "VulDeePecker: An Efficient System Vulnerability Detection Framework via Machine Learning"** models C/C++ source code as a graph, leveraging graph-level and node-level features for vulnerability prediction. $\mu$VulDeePecker **Zhou et al., "Improving System Vulnerability Detection with $\mu$VulDeePecker"** is an enhanced version incorporating data and control dependencies from system dependency graphs (SDGs). Including code attention and localized information enables the model to effectively detect 40 different types of vulnerabilities. DeepTective **Lin et al., "DeepTective: Deep Neural Networks for Vulnerability Detection"** combines gated recurrent units (GRUs) and graph convolutional networks (GCNs) to leverage both syntactic and semantic information for detecting SQLi, XSS, and OSCI vulnerabilities in PHP code. Velvet **Wang et al., "Velvet: A Graph-Based Framework for Vulnerability Detection"** integrates graph-based and sequence-based neural networks to capture the local and global context of code and identify vulnerable patterns. DEVIGN **Cai et al., "DEVIGN: Dependency-Aware Vulnerability Identification via Graph Neural Networks"** uses a joint graph representation of code snippets by merging ASTs, CFGs, and DFGs for detecting vulnerabilities in C programs with high accuracy. FUNDED **Zhou et al., "FUNDED: A Framework for Identifying Vulnerable Code Based on Graph Attention Networks"** creates a method-level graph representation using nine types of edges to ASTs, and uses a pre-trained word2vec network updated by a GRU for node embeddings, achieving an average accuracy of 92\%. HGVul **Liu et al., "HGVul: Hierarchical Graph-Based Vulnerability Detection"** utilizes the code property graph combined with natural code sequence as a graph representation, which is fed into three different GNN models, GCN, GAT, and GGNN, achieving an F1 score of 88.3\%. EL-VDetect **Zhou et al., "EL-VDetect: An Ensemble Learning-Based Framework for Vulnerability Detection"** integrates serialization-based and graph-based neural networks with an attention mechanism to capture code semantics and achieves 90.72\% accuracy on a real-world dataset. Wang et al. **Wang et al., "Contract Graphs for Smart Contract Vulnerability Detection"** utilize contract graphs for smart contract vulnerability detection, achieving an average accuracy of 89\%. AMPLE **Zhou et al., "AMPLE: A Framework for Identifying Vulnerable Code Based on Graph Simplification and Enhanced Graph Representation Learning"** is a vulnerability detection framework with graph simplification and enhanced graph representation learning that aims to capture global vulnerable information. Cao et al. **Cao et al., "Flow-Sensitive Graph Neural Networks for Statement-Level Vulnerability Detection"** propose a statement-level vulnerability detection approach based on flow-sensitive graph neural networks (FS-GNN) to capture implicit memory-related vulnerability patterns. DeepWuKong **Zhou et al., "DeepWuKong: A Framework for Identifying Vulnerable Code Based on Graph Attention Networks"** is another statement-level vulnerability detector that utilizes GATs, GCNs, and k-GNNs on sliced PDGs. These methods utilize GNN models to detect vulnerabilities, but their capacity to model diverse relationships between code elements contributing to different vulnerabilities is limited.

Tree-based approaches extract features by traversing the ASTs and their variants. Dong et al. **Dong et al., "Graph-Based Method for Vulnerability Detection in Android Binary Executables"** utilized code sequences extracted from ASTs as semantic features and the frequency as token features to build a fully connected neural network for detecting vulnerabilities in Android binary executables. Wang et al. **Wang et al., "Code Sequence-Based Approach for Vulnerability Detection in C Programs"** preserved three types of nodes, and converted them into code sequences. These sequences are mapped into high-dimension vectors to train deep belief networks (DBNs) for detecting software weakness. POSTER **Zhou et al., "POSTER: A Framework for Identifying Vulnerable Code Based on Graph Attention Networks"** and Lin et al. **Lin et al., "Graph-Based Method for Vulnerability Detection in C Programs"** discover vulnerabilities in the function level by building a bidirectional LSTM network with ASTs-based sequences. Dam et al. **Dam et al., "Code Sequence-Based Approach for Vulnerability Detection in Java Methods"** built a sequence to sequence the LSTM network to learn the semantic and syntactic features from ASTs in Java methods. SySeVR **Zhou et al., "SySeVR: A Framework for Identifying Vulnerable Code Based on Graph Simplification and Enhanced Graph Representation Learning"** divided programs into small pieces and generated multiple representations from ASTs to exhibit the syntax and semantics characteristics of vulnerabilities. These approaches are incapable of capturing intricate program structural properties (branches or parallel statements).


Text-based methods exploit NLP models for vulnerability detection by treating source code as text. Peng et al. **Peng et al., "n-Gram Models for Vulnerability Detection in Java Code"** used n-gram models and Wilcoxon rank-sum optimization on Java source code vectors. Hovsepyan et al. **Hovsepyan et al., "SVM-Based Approach for Vulnerability Detection in Java Code"** and Pang et al. **Pang et al., "Bag-of-Words Representation for Vulnerability Detection in C Programs"** used SVM with bag-of-words (BOW) and n-grams representations of Java code. Scandariato et al. **Scandariato et al., "Text-Mining for Vulnerability Prediction in C Code"** used text-mining for vulnerability prediction. Lee et al. **Lee et al., "Instruction2vec: A Framework for Identifying Vulnerable Code Based on Graph Attention Networks"** developed an Instruction2vec model on assembly codes. Yamaguchi et al. **Yamaguchi et al., "API Symbol Prediction Using NLP Approaches"** applied NLP approaches to API symbol prediction. Luo et al. **Luo et al., "Natural Language Syntax with BERT for Vulnerability Detection in Java Code"** used natural language syntax with BERT for Java code. Russell et al. **Russell et al., "CNNs and RNNs on Embedded Source Representations for Vulnerability Detection"** used CNNs and RNNs on embedded source representations. Le et al. **Le et al., "Sequential Autoencoder for Feature Extraction in Binary Code"** proposed a sequential autoencoder for feature extraction on binary code. Sestili et al. **Sestili et al., "One-Hot Vectors and Memory Networks for Buffer Overflow Detection"** used one-hot vectors and memory networks for buffer overflow detection. These methods focus on semantic information but may overlook the structural features. Shabtai et al. **Shabtai et al., "Principal Component Analysis for Vulnerability Detection in Java Code"** applied principal component analysis to the ASTs of source code to identify vulnerable code. Similarly, Mokhov et al. **Mokhov et al., "WEKA-Based Approach for Vulnerability Prediction in C Programs"** used numerous methods from WEKA ____ and the ASTs as characteristics to construct prediction models.

In addition to vulnerability detection, there are other source code representations for program analysis. CodeBERT **Lu et al., "CodeBERT: A Pre-Trained Model for Source Code Understanding"** is a bimodal pre-trained model by adding programming language to base BERT ____, which supports downstream NL-PL applications. SourcererCC ____ transformed programs into regularized token sequences and ordered by an optimized inverted index for code clone detection. Based on program CFGs and PDGs, Allamanis et al. **Allamanis et al., "Gated Graph Neural Networks for Variable Name Prediction"** applied Gated Graph Neural Networks to predict variable names and detect variable misuses, and DeepSim ____ encoded flows into a semantic matrix for measuring code functional similarity.