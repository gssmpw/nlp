\section{Related Work}
\label{sec:related_work}
\noindent Testing AVs in various driving scenarios is critical in ensuring their safety and functionality. However, due to the complexity of the AV operating environments, there is theoretically an infinite number of possible driving scenarios. Therefore, we need to identify critical scenarios that could violate safety or functional requirements.
Search-based methods are widely adopted to generate critical scenarios under the guidance of fitness functions~\cite{ben2016testing,abdessalem2018testing,zhong2022neural,10645815,10234383,zhou2023specification}. For example, 
Abdessalem et al.~\cite{abdessalem2018testing} proposed NSGAII-DT to test vision-based control systems by combining NSGA-II~\cite{deb2002fast} and decision tree models.
Li et al.~\cite{li2020av} proposed AV-Fuzzer, an approach integrating fuzz testing with evolutionary search, to identify critical scenarios that cause safety violations. Haq et al.~\cite{haq2022efficient} proposed SAMOTA, an efficient AV testing approach that combines multi-objective search with surrogate models. SAMOTA employs multi-objective search to generate critical scenarios and improves testing efficiency by simulating the simulator with surrogate models. To test AV against traffic laws, Sun et al.~\cite{sun2022lawbreaker} proposed LawBreaker, which adopts a fuzzing algorithm to search for scenarios that can effectively violate traffic laws.
Though search-based approaches have shown promising performance, they have limited effectiveness in handling tasks requiring runtime sequential interactions with the environment, which are essential when manipulating dynamic objects and ensuring precise control over them. Another challenge is that the AV operating environment is dynamically changing and uncertain, while search-based approaches cannot effectively adapt to environmental changes.

RL-based approaches generate critical scenarios through intelligent agents that interact with and configure the AV operating environment~\cite{chen2021adversarial,lu2022learning,10172658,feng2023dense}. For example, 
Koren et al.~\cite{8500400} extended adaptive stress testing using RL to find critical scenarios that cause AV to collide.
Lu et al.~\cite{lu2022learning} proposed DeepCollision, an RL-based environment configuration framework that generates scenarios to uncover collisions of AV. To test lane-changing models, Chen et al.~\cite{chen2021adversarial} proposed an RL-based adaptive testing framework to generate time-sequential adversarial scenarios. Similarly, Doreste et al~\cite{doreste2024adversarial} proposed an adversarial method that models NPCs with independent RL-based agents to challenge the ADS under test. Feng et al.~\cite{feng2023dense} proposed a dense RL-based approach to learn critical scenarios from naturalistic driving data by editing the Markov decision process to eliminate non-safety-critical states. 
To test multiple requirements, Haq et al.~\cite{10172658} proposed MORLOT that adapts single-objective RL and multi-objective search to generate test suites to violate as many requirements as possible. Notice that MORLOT is designed to violate multiple \textit{independent} requirements by developing a set of scenarios, each violating one independent requirement. However, in reality, AV requirements are often interdependent and must be evaluated simultaneously.
For example, failing to meet a functional requirement (e.g., not completing a route) may violate a safety requirement (e.g., causing a crash), highlighting the need for approaches simultaneously evaluating multiple requirements. 

Different from the above works, we propose \method by applying MORL to generate critical scenarios that violate multiple requirements simultaneously. \method relies on EQL to automatically learn and adaptively generate critical scenarios by interacting with AV operating environments through a multi-objective approach.