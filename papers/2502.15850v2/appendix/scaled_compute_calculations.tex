\section{Scaled Compute Calculations}
\label{app:scaled_compute}

Recall that Hoffman loss is:
\begin{equation}
    \hat{L}(N, D) = E + \frac{A}{N^\alpha} + \frac{B}{D^\beta}
\end{equation}
The normalized scaled FLOP count $C_{opt}$ is:
\begin{align*}
    L_{\text{model}}        & = \hat{L}(N_{\text{model}}, D_{\text{model}})              \\
    N_{\text{opt}}, D_{\text{opt}} & = \text{hoffman\_optimal\_params}(L_{\text{model}}) \\
    C_{\text{opt}}          & = 6 N_{\text{opt}} D_{\text{opt}}                          \\
\end{align*}


% def opt_params(L_budget: float, p: ChinchillaParams) -> tuple[float, float]:
%     l = L_budget - p.E
%     N_opt = (p.A * (p.alpha + p.beta) / (l * p.beta)) ** (1 / p.alpha)
%     D_opt = (p.B * (p.alpha + p.beta) / (l * p.alpha)) ** (1 / p.beta)
%     return N_opt, D_opt


Using the method of Lagrange multipliers, it can be shown that:
\begin{align*}
    N_{opt} &= \frac{A(\alpha + \beta)}{(l\beta)^\frac{1}{\alpha}} \\
    D_{opt} &= \frac{B(\alpha + \beta)}{(l\alpha)^\frac{1}{\beta}} \\ 
    \text{where} & \\
    l &= L_{budget} - E \\
\end{align*}