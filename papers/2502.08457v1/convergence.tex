\subsection{{Local boundedness and Lipschitz  properties of $\ell_{in}$, $\ell_{out}$, and their derivatives }}

\begin{proposition}[{Local} boundedness]\label{prop:uniform_boundedness}
Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, the functions $(\omega,x,y)\mapsto \ell_{out}(\omega,h_{\omega}^{\star}(x),y)$, $(\omega,x,y)\mapsto \partial_{\omega}\ell_{out}(\omega,h_{\omega}^{\star}(x),y)$, and $(\omega,x,y)\mapsto\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)$ are bounded over $\textnormal{hull}(\Omega)\times\mathcal{X}\times\mathcal{Y}$ by some positive constant $M_{out}$. Similarly, the functions $(\omega,x,y)\mapsto\partial_v \ell_{in}(\omega, h^\star_\omega(x), y)$, $(\omega,x,y)\mapsto\partial_v^2 \ell_{in}(\omega, h^\star_\omega(x), y)$, and $(\omega,x,y)\mapsto\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)$  are bounded over $\textnormal{hull}(\Omega)\times\mathcal{X}\times\mathcal{Y}$ by some positive constant $M_{in}$. 
The constants $M_{out}$ and $M_{in}$ are defined as:
\begin{align*}
M_{out}&\coloneqq\sup_{\omega\in\textnormal{hull}(\Omega),v\in\mathcal{V},y\in\mathcal{Y}}\max\left(\verts{\ell_{out}(\omega,v,y)},\Verts{\partial_{\omega}\ell_{out}(\omega,v,y)},\verts{\partial_v\ell_{out}(\omega, v, y)}\right)>0,\\
M_{in}&\coloneqq\sup_{\omega\in\textnormal{hull}(\Omega),v\in\mathcal{V},y\in\mathcal{Y}}\max\left(\verts{\partial_v\ell_{in}(\omega, v, y)}, \verts{\partial_v^2\ell_{in}(\omega, v, y)},\Verts{\partial_{\omega, v}^2\ell_{in}(\omega, v, y)}\right)>0,
\end{align*}
where $\mathcal{V}\subset\mathbb{R}$ is the compact interval defined in \cref{prop:bound_hstaromega}.
\end{proposition}

\begin{proof}
By \cref{prop:bound_hstaromega}, we have that $h^\star_\omega(x)\in\mathcal{V}\coloneqq\left[-\frac{B\kappa}{\lambda},\frac{B\kappa}{\lambda}\right]\subset\mathbb{R}$, for any $x\in\mathcal{X}$. From \cref{assump:reg_lin_lout}, we know that $\ell_{in}$, $\ell_{out}$, and their partial derivatives are all continuous on $\text{hull}(\Omega)\times\mathcal{V}\times\mathcal{Y}$. Also, $\mathcal{Y}$ is compact by \cref{assump:compact}. Thus, $\text{hull}(\Omega)\times\mathcal{V}\times\mathcal{Y}$ is compact. As every continuous function defined over a compact space is bounded, we obtain that:
\begin{align*}
    \sup_{\omega\in\text{hull}(\Omega),x\in\mathcal{X},y\in\mathcal{Y}}\verts{\ell_{out}(\omega,h_{\omega}^{\star}(x),y)}&\leq\sup_{\omega\in\text{hull}(\Omega),v\in\mathcal{V},y\in\mathcal{Y}}\verts{\ell_{out}(\omega,v,y)}<+\infty,\\
    \sup_{\omega\in\text{hull}(\Omega),x\in\mathcal{X},y\in\mathcal{Y}}\Verts{\partial_{\bullet} \ell_{\circ}(\omega,h_{\omega}^{\star}(x),y)}&\leq\sup_{\omega\in\text{hull}(\Omega),v\in\mathcal{V},y\in\mathcal{Y}}\Verts{\partial_{\bullet} \ell_{\circ}(\omega,v,y)}<+\infty,
\end{align*}
where $\bullet \in \{\{v\}, \{w\}, \{w,v\}\}$ and $\circ \in \{in,out\}$. This implies the desired result.
\end{proof}

\begin{proposition}[Local Lipschitz continuity]\label{prop:uniform_Lipschitzness}
	Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, there exists a positive constant $\lipout$ so that for any $(x,y)$ in $\mathcal{X}\times \mathcal{Y}$, 
	the functions $\omega\mapsto \ell_{out}(\omega,h_{\omega}^{\star}(x),y)$, $\omega\mapsto \partial_{\omega}\ell_{out}(\omega,h_{\omega}^{\star}(x),y)$, and $\omega\mapsto\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)$ are locally $\frac{\lipout}{\lambda}$-Lipschitz continuous over $\textnormal{hull}(\Omega)$. Similarly, there exists a positive constant $\lipin$ so that for any $(x,y)$ in $\mathcal{X}\times \mathcal{Y}$, the functions $\omega\mapsto\partial_v \ell_{in}(\omega, h^\star_\omega(x), y)$, $\omega\mapsto\partial_v^2 \ell_{in}(\omega, h^\star_\omega(x), y)$, and $\omega\mapsto\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)$ are locally $\frac{\lipin}{\lambda}$-Lipschitz continuous $\textnormal{hull}(\Omega)$.  The constants $\lipout$ and $\lipin$ are defined, for any $0<\lambda\leq \Lambda$, as:
	\begin{align*}
	    \lipout&\coloneqq\left(\Lambda+M_{in}\kappa\right)\max\left(M_{out},\bar{M}_{out}\right)>0\\
	    \lipin&\coloneqq\left(\Lambda+M_{in}\kappa\right)\max\left(M_{in},\bar{M}_{in}\right)>0,
    \end{align*}
    where:
    \begin{align*}
      \bar{M}_{out}&\coloneqq\sup_{\omega\in\textnormal{hull}(\Omega), v\in\mathcal{V}, y\in\mathcal{Y}}\max\left(\Verts{\partial_\omega^2\ell_{out}(\omega, v, y)}_{\op},\Verts{\partial_{\omega, v}^2\ell_{out}(\omega, v, y)},\verts{\partial_v^2\ell_{out}(\omega, v, y)}\right)>0,\\
      \bar{M}_{in}&\coloneqq\sup_{\omega\in\textnormal{hull}(\Omega), v\in\mathcal{V}, y\in\mathcal{Y}}\max\left(\Verts{\partial_\omega\partial_v^2\ell_{in}(\omega, v, y)},\verts{\partial_v^3\ell_{in}(\omega, v, y)},\Verts{\partial_\omega\partial_{\omega, v}^2\ell_{in}(\omega, v, y)}\right)>0,
    \end{align*}
    with $M_{in}$ and $M_{out}$ being the positive constants defined in \cref{prop:uniform_boundedness}, and $\mathcal{V}\subset\mathbb{R}$ is the compact interval defined in \cref{prop:bound_hstaromega}.
\end{proposition}


\begin{proof}
For any $(\omega,x,y)\in\text{hull}(\Omega)\times \mathcal{X}\times \mathcal{Y}$, we have:
\begin{align*}
    \Verts{\nabla_\omega\ell_{out}(\omega, h^\star_\omega(x), y)}&=\Verts{\partial_\omega\ell_{out}(\omega, h^\star_\omega(x), y)+\partial_v\ell_{out}(\omega, h^\star_\omega(x), y)\partial_\omega h^\star_\omega(x)}\\
    &\leq\Verts{\partial_\omega\ell_{out}(\omega, h^\star_\omega(x), y)}+\verts{\partial_v\ell_{out}(\omega, h^\star_\omega(x), y)}\Verts{\partial_\omega h^\star_\omega}_{\op}\Verts{K(x,\cdot)}_\mathcal{H}\\
    &\leq M_{out}\left(1+\frac{M_{in}\kappa}{\lambda}\right)\\
    &\leq\frac{M_{out}\left(\Lambda+M_{in}\kappa\right)}{\lambda},
\end{align*}
where the first line uses the chain rule, the second line applies the triangle inequality and the reproducing property of the RKHS $\mathcal{H}$, the third line follows from \cref{prop:uniform_boundedness} to bound the derivatives of $\ell_{out}$, from \cref{prop:lip_hstaromega}, which states that the function $\omega\mapsto h^\star_\omega$ is $\frac{L\sqrt{\kappa}}{\lambda}$-Lipschitz continuous with $L\coloneqq\sup_{\omega\in\text{hull}(\Omega),v\in\mathcal{V},y\in\mathcal{Y}}\left\|\partial_{\omega, v}^2 \ell_{in}(\omega, v, y)\right\|<M_{in}$, to bound $\Verts{\partial_\omega h^\star_\omega}_{\op}$, and from \cref{assump:K_bounded} to bound $\Verts{K(x,\cdot)}_\mathcal{H}$, and the last line is a direct consequence of $0<\lambda\leq \Lambda$. In a similar way, we obtain:
\begin{gather*}
    \Verts{\nabla_\omega\partial_\omega\ell_{out}(\omega, h^\star_\omega(x), y)}_{\op}\leq\frac{\bar{M}_{out}\left(\Lambda+M_{in}\kappa\right)}{\lambda},\quad\Verts{\nabla_\omega\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)}\leq\frac{\bar{M}_{out}\left(\Lambda+M_{in}\kappa\right)}{\lambda},\\
    \Verts{\nabla_\omega\partial_v \ell_{in}(\omega, h^\star_\omega(x), y)}\leq\frac{M_{in}\left(\Lambda+M_{in}\kappa\right)}{\lambda},\quad\Verts{\nabla_\omega\partial_v^2 \ell_{in}(\omega, h^\star_\omega(x), y)}\leq\frac{\bar{M}_{in}\left(\Lambda+M_{in}\kappa\right)}{\lambda},\\
    \Verts{\nabla_\omega\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)}_{\op}\leq\frac{\bar{M}_{in}\left(\Lambda+M_{in}\kappa\right)}{\lambda}.
\end{gather*}
Combining all these bounds concludes the proof.
\end{proof}

\section{Generalization Properties}\label{app:sec_conv}

{As before, let $\Omega$ be an arbitrary compact subset of $\mathbb{R}^d$.}

\subsection{Point-wise estimates}\label{app:subsec_point_est}
We present a point-wise upper-bound on the value error $\verts{\mathcal{F}(\omega)-\widehat{\mathcal{F}}(\omega) }$ and gradient error $\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega) }$. To this end, we introduce the following notation for the error between the inner and outer objectives and their empirical approximations evaluated at the optimal inner solution $h_{\omega}^{\star}$: 
\begin{align*}
    \Dout\coloneqq \verts{L_{out}(\omega, h^\star_\omega)-\widehat{L}_{out}(\omega, h^\star_\omega)}, 
    \qquad 
    \Din \coloneqq \verts{L_{in}(\omega, h^\star_\omega)-\widehat{L}_{in}(\omega, h^\star_\omega)}.
\end{align*}
By abuse of notation, we introduce the following error between  partial derivatives of $L_{in}$ and $\widehat{L}_{in}$ (resp. $L_{out}$ and $\widehat{L}_{out}$), evaluated at $(\omega, h_{\omega}^{\star})$, \textit{i.e.},
\begin{align*}
  \Douth &\coloneqq \Verts{\partial_h L_{out}(\omega, h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega, h^\star_\omega)}_{\mathcal{H}},\quad 
  &\Doutw &\coloneqq \Verts{\partial_\omega L_{out}(\omega, h^\star_\omega)-\partial_\omega\widehat{L}_{out}(\omega, h^\star_\omega)},\\
  \Dinh &\coloneqq \Verts{\partial_h L_{in}(\omega, h^\star_\omega)-\partial_h\widehat{L}_{in}(\omega, h^\star_\omega)}_{\mathcal{H}},\quad 
  &\Dinw &\coloneqq \Verts{\partial_\omega L_{in}(\omega, h^\star_\omega)-\partial_\omega\widehat{L}_{in}(\omega, h^\star_\omega)},\\
  \Dinhh &\coloneqq \Verts{\partial_{h}^2 L_{in}(\omega, h^\star_\omega)-\partial_h^2\widehat{L}_{in}(\omega, h^\star_\omega)}_{\op},\quad 
  &\Dinwh &\coloneqq \Verts{\partial_{\omega,h}^2 L_{in}(\omega, h^\star_\omega)-\partial_{\omega,h}^2\widehat{L}_{in}(\omega, h^\star_\omega)}_{\op}.
\end{align*}

\begin{proposition}\label{prop:diff_hstar_hhat}
    Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, the following holds for any $\omega\in\Omega$:
    \begin{equation*}
        \left\|h^\star_\omega-\hat{h}_\omega\right\|_\mathcal{H}\leq\frac{1}{\lambda}\left\| \partial_h\widehat{L}_{in}(\omega, h^\star_\omega)\right\|_\mathcal{H} = \frac{1}{\lambda}\Dinh.
    \end{equation*}
\end{proposition}
\begin{proof}
Let $\omega\in\Omega$. 
The function $h\mapsto\widehat{L}_{in}(\omega, h)$ is $\lambda$-strongly convex and Fr\'echet differentiable by  \cref{prop:strong_convexity_Lin,prop:fre_diff_L}. Moreover,  $\hat{h}_{\omega}$ is the minimizer of $h\mapsto\widehat{L}_{in}(\omega, h)$ by definition. 
Therefore, using \cref{lem:h_min_hstar}, we obtain a control on the distance in $\mathcal{H}$ to the optimum $\hat{h}_{\omega}$ of $h\mapsto\widehat{L}_{in}(\omega,h)$ in terms of the gradient $\partial_{h}\widehat{L}_{in}(\omega,h)$:
\begin{align*}
	\left\|h-\hat{h}_\omega\right\|_\mathcal{H}\leq\frac{1}{\lambda}\Verts{\partial_h\widehat{L}_{in}(\omega, h)}_\mathcal{H}, \qquad \forall h\in \mathcal{H}.
\end{align*}
In particular, choosing $h= h^\star_\omega$ yields the first inequality. The fact that $\Verts{\partial_h\widehat{L}_{in}(\omega, h_{\omega}^{\star})}_\mathcal{H}=\Dinh$ follows from the optimality of $h_{\omega}^{\star}$ which implies that  $\partial_h L_{in}(\omega, h_{\omega}^{\star})=0$. 
\end{proof}

\begin{proposition}\label{prop:lip_continuity_out}
Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, the following inequalities hold for any $\omega\in\Omega$:
\begin{align*}
	\Eout &\coloneqq\verts{\widehat{L}_{out}(\omega, h^\star_\omega)-\widehat{L}_{out}(\omega, \hat{h}_\omega)}\leq C_{out}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\\
	\Eouth&\coloneqq\Verts{\partial_h\widehat{L}_{out}(\omega, h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega, \hat{h}_\omega)}_\mathcal{H} \leq C_{out}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\\
	\Eoutw&\coloneqq\Verts{\partial_\omega\widehat{L}_{out}(\omega, h^\star_\omega)-\partial_\omega\widehat{L}_{out}(\omega, \hat{h}_\omega)} \leq C_{out}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\\
	\Einhh&\coloneqq\Verts{\partial_h^2\widehat{L}_{in}(\omega, h^\star_\omega)-\partial_h^2\widehat{L}_{in}(\omega, \hat{h}_\omega)}_{\op}\leq C_{in}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\\
	\Einwh&\coloneqq\Verts{\partial_{\omega, h}^2\widehat{L}_{in}(\omega, h^\star_\omega)-\partial_{\omega, h}^2\widehat{L}_{in}(\omega, \hat{h}_\omega)}_{\op} \leq C_{in}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H}.
\end{align*}
The positive constants $C_{out}$ and $C_{in}$ are defined as:
\begin{align*}
    C_{out}&\coloneqq\max\left(M_{out}\sqrt{\kappa},\bar{M}_{out}\kappa,\bar{M}_{out}\sqrt{\kappa}\right)>0,\\
    C_{in}&\coloneqq\max\left(\bar{M}_{in}\kappa\sqrt{\kappa},\bar{M}_{in}\kappa,M_{in}\sqrt{d\kappa}\right)>0,
\end{align*}
where $M_{out}$, $\bar{M}_{out}$, and $\bar{M}_{in}$ are the positive constants defined in \cref{prop:uniform_boundedness,prop:uniform_Lipschitzness}.
\end{proposition}

\begin{proof}
\textbf{Lipschitz continuity of some functions of interest. }Let $\omega\in\Omega$. According to \cref{prop:bound_hstaromega}, both $h^\star_\omega(x)$ and $\hat{h}_\omega(x)$ lie in the compact interval $\mathcal{V}\coloneqq\left[-\frac{B\kappa}{\lambda},\frac{B\kappa}{\lambda}\right]\subset\mathbb{R}$, for any $x\in\mathcal{X}$, where $B\coloneqq\sup_{\omega\in\text{hull}(\Omega),y\in\mathcal{Y}}\left|\partial_v \ell_{in}(\omega, 0, y)\right|>0$. By \cref{assump:compact}, $\mathcal{Y}$ is a compact set. Hence $\Omega\times\mathcal{V}\times\mathcal{Y}$ is a compact set as well. Furthermore, by \cref{assump:reg_lin_lout}, $(\omega, v, y)\mapsto\ell_{in}(\omega, v, y)$, $(\omega, v, y)\mapsto\ell_{out}(\omega, v, y)$, and their derivatives are all continuous over the compact domain $\Omega\times\mathcal{V}\times\mathcal{Y}$. Therefore, these functions and their derivatives are bounded on this domain. In particular, this also holds when $v$ takes the specific values $h^\star_\omega(x)$ or $\hat{h}_\omega(x)$. Let $\bar{v}$ be either $h^\star_\omega(x)$ or $\hat{h}_\omega(x)$, for any $x\in\mathcal{X}$. For any $\omega\in\Omega$, and $y\in\mathcal{Y}$, we have:
\begin{align*}
    \verts{\partial_v\ell_{out}(\omega, \bar{v}, y)}&\leq\sup_{\omega\in\Omega,v\in\mathcal{V},y\in\mathcal{Y}}\verts{\partial_v\ell_{out}(\omega, v, y)}\leq M_{out}<+\infty,\\
   \verts{\partial_v^2\ell_{out}(\omega, \bar{v}, y)}&\leq\sup_{\omega\in\Omega,v\in\mathcal{V},y\in\mathcal{Y}}\verts{\partial_v^2\ell_{out}(\omega, v, y)}\leq\bar{M}_{out}<+\infty,\\
   \Verts{\partial_{\omega, v}^2\ell_{out}(\omega, \bar{v}, y)}&\leq\sup_{\omega\in\Omega,v\in\mathcal{V},y\in\mathcal{Y}}\Verts{\partial_{\omega, v}^2\ell_{out}(\omega, v, y)}\leq\bar{M}_{out}<+\infty,\\
   \verts{\partial_v^3\ell_{in}(\omega, \bar{v}, y)}&\leq\sup_{\omega\in\Omega,v\in\mathcal{V},y\in\mathcal{Y}}\verts{\partial_v^3\ell_{in}(\omega, v, y)}\leq\bar{M}_{in}<+\infty,\\
   \Verts{\partial_v\partial_{\omega, v}^2\ell_{in}(\omega, \bar{v}, y)}_{\op}&\leq\sup_{\omega\in\Omega,v\in\mathcal{V},y\in\mathcal{Y}}\Verts{\partial_\omega\partial_v^2\ell_{in}(\omega, v, y)}\leq\bar{M}_{in}<+\infty
\end{align*}
This means that $v\in\mathcal{V}\mapsto\ell_{out}(\omega, v, y)$, $v\in\mathcal{V}\mapsto\partial_v\ell_{out}(\omega, v, y)$, $v\in\mathcal{V}\mapsto\partial_\omega\ell_{out}(\omega, v, y)$, $v\in\mathcal{V}\mapsto\partial_v^2\ell_{in}(\omega, v, y)$, and $v\in\mathcal{V}\mapsto\partial_{\omega, v}^2\ell_{in}(\omega, v, y)$ are Lipschitz continuous, with Lipschitz constants $M_{out}$, $\bar{M}_{out}$, $\bar{M}_{out}$, $\bar{M}_{in}$, and $\bar{M}_{in}$, respectively, for any $\omega\in\Omega$ and $y\in\mathcal{Y}$.

\textbf{Upper-bounds. }We have:
\begin{align*}
    \Eout\coloneqq\verts{\widehat{L}_{out}(\omega, h^\star_\omega)-\widehat{L}_{out}(\omega, \hat{h}_\omega)}&=\verts{\frac{1}{m}\sum_{j=1}^m\ell_{out}(\omega, h^\star_\omega(\tilde{x}_j), \tilde{y}_j) - \frac{1}{m}\sum_{j=1}^m\ell_{out}(\omega, \hat{h}_\omega(\tilde{x}_j), \tilde{y}_j)}\\
    &\leq\frac{1}{m}\sum_{j=1}^m\verts{\ell_{out}(\omega, h^\star_\omega(\tilde{x}_j), \tilde{y}_j)-\ell_{out}(\omega, \hat{h}_\omega(\tilde{x}_j), \tilde{y}_j)}\\
    &\leq\frac{M_{out}}{m}\sum_{j=1}^m\verts{h^\star_\omega(\tilde{x}_j)-\hat{h}_\omega(\tilde{x}_j)}\\
    &\leq M_{out}\sqrt{\kappa}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},
\end{align*}
where the first line uses the definition of $(\omega, h)\mapsto\widehat{L}_{out}(\omega, h)$, the second line applies the triangle inequality, the third line leverages the fact that $v\mapsto\ell_{out}(\omega, v, y)$ is $M_{out}$-Lipschitz continuous, for any $\omega\in\Omega$ and $y\in\mathcal{Y}$, and the last line follows from the reproducing property of the RKHS $\mathcal{H}$, Cauchy-Schwarz's inequality, and \cref{assump:K_bounded} to bound $\Verts{K(x,\cdot)}_\mathcal{H}$ by $\sqrt{\kappa}$. Similarly, we obtain:
\begin{gather*}
    \partial_h\Eout\leq\bar{M}_{out}\kappa\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\quad\partial_\omega\Eout\leq\bar{M}_{out} \sqrt{\kappa}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\quad\partial_h^2\Ein\leq\bar{M}_{in} \kappa\sqrt{\kappa}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H},\\
    \partial_{\omega, h}^2\Ein\leq\bar{M}_{in} \kappa\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H}.
\end{gather*}
Combining all the bounds finishes the proof.
\end{proof}

\begin{proposition}\label{prop:bounded_derivatives}
Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, the following inequalities hold for any $\omega\in\Omega$:
\begin{align*}
	\Verts{\partial_{h}L_{out}(\omega,h_{\omega}^{\star})}_{\mathcal{H}}\leq C_{out}, \quad \Verts{\partial^2_{\omega,h}L_{in}(\omega,h_{\omega}^{\star}) }_{\op}\leq C_{in},\quad 
	\Verts{\partial^2_{\omega,h}\widehat{L}_{in}(\omega,\hat{h}_{\omega}) }_{\op}\leq C_{in},
\end{align*}
where $C_{out}$ and $C_{in}$ are the positive constants defined in \cref{prop:lip_continuity_out}.
\end{proposition}

\begin{proof}Let $\omega\in\Omega$.

\textbf{Upper-bound on $\Verts{\partial_{h}L_{out}(\omega,h_{\omega}^{\star})}_{\mathcal{H}}$. }We have:
\begin{align*}
    \left\|\partial_h L_{out}(\omega, h^\star_\omega)\right\|_\mathcal{H}&=\Big\|\mathbb{E}_\mathbb{Q}\left[\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)K(x,\cdot)\right]\Big\|_\mathcal{H}\\
    &\leq\mathbb{E}_\mathbb{Q}\Big[\left|\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)\right|\left\|K(x,\cdot)\right\|_\mathcal{H}\Big]\\
    &\leq\sqrt{\kappa}\mathbb{E}_\mathbb{Q}\Big[\left|\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)\right|\Big],
\end{align*}
where the first line follows from \cref{prop:fre_diff_L}, the second line results from the triangle inequality, and the last line uses \cref{assump:K_bounded} to bound $\Verts{K(x,\cdot)}_\mathcal{H}$ by $\sqrt{\kappa}$.  Furthermore, we know by \cref{prop:bound_hstaromega} that $(\omega,h_{\omega}^{\star}(x),y)$ belongs to the compact subset $\Omega\times \mathcal{V}\times \mathcal{Y}$ and by \cref{prop:uniform_boundedness} that $\partial_v \ell_{out}(\omega, h^\star_\omega(x), y)$ is bounded by a  constant $M_{out}$ on $\text{hull}(\Omega)\times \mathcal{V}\times \mathcal{Y}$. Hence, it follows that:
\begin{align*}
    \left\|\partial_h L_{out}(\omega, h^\star_\omega)\right\|_\mathcal{H}
    \leq \sqrt{\kappa} M_{out} \le C_{out},
\end{align*}
where $C_{out}$ is defined in \cref{prop:lip_continuity_out}. 

\textbf{Upper-boud on $\quad \Verts{\partial^2_{\omega,h}L_{in}(\omega,h_{\omega}^{\star}) }_{\op}$. }According to \cref{prop:fre_diff_L_v}, $\partial_{\omega, h}^2 L_{in}(\omega, h^\star_\omega)$ is a Hilbert-Schmidt operator, which points to:
\begin{equation}\label{eq:norm_op_partial_omega_h_Lin}
    \left\|\partial_{\omega, h}^2L_{in}(\omega, h^\star_\omega)\right\|_{\op}\leq\left\|\partial_{\omega, h}^2L_{in}(\omega, h^\star_\omega)\right\|_{\hs}=\sqrt{\sum_{l=1}^d\left\|\partial_{\omega_k, h}^2L_{in}(\omega, h^\star_\omega)\right\|_\mathcal{H}^2}.
\end{equation}
This means that to find an upper-bound on $\left\|\partial_{\omega, h}^2L_{in}(\omega, h^\star_\omega)\right\|_{\op}$, it suffices to establish an upper-bound on $\left\|\partial_{\omega_l, h}^2L_{in}(\omega, h^\star_\omega)\right\|_\mathcal{H}^2$ for any $l\in\{1,\ldots,d\}$. For a fixed $l\in\{1,\ldots,d\}$, we have:
\begin{align*}
    \left\|\partial_{\omega_l, h}^2L_{in}(\omega, h^\star_\omega)\right\|_\mathcal{H}^2&=\Big\|\mathbb{E}_\mathbb{P}\left[\partial_{\omega_l,v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)K(x,\cdot)\right]\Big\|_\mathcal{H}^2\\
    &\leq\mathbb{E}_\mathbb{P}\left[\left|\partial_{\omega_l, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)\right|^2\left\|K(x,\cdot)\right\|_\mathcal{H}^2\right]\\
    &\leq\mathbb{E}_\mathbb{P}\left[\left\|\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)\right\|^2\right]\kappa,
\end{align*}
where the first line follows from \cref{prop:fre_diff_L_v}, the second line is a consequence of Jensen's inequality applied on the convex function $\|\cdot\|^2$, and the last line applies \cref{assump:K_bounded} to bound $\Verts{K(x,\cdot)}_\mathcal{H}^2$ by $\kappa$. Incorporating this upper-bound into \cref{eq:norm_op_partial_omega_h_Lin} yields:
\begin{equation*}
    \left\|\partial_{\omega, h}^2L_{in}(\omega, h^\star_\omega)\right\|_{\op}\leq\sqrt{\mathbb{E}_\mathbb{P}\left[\left\|\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)\right\|^2\right] d\kappa}\leq M_{in}\sqrt{d\kappa}\leq C_{out}, 
\end{equation*}
where we used \cref{prop:uniform_boundedness} to bound $\partial_{\omega, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y)$ by the constant $M_{in}$.

\textbf{Upper-bound on $\Verts{\partial^2_{\omega,h}\widehat{L}_{in}(\omega,\hat{h}_{\omega}) }_{\op}$. }The derivation of this upper bound follows the same steps as the previous one, with the only differences being the use of $\widehat{L}_{in}$ instead of $L_{in}$, and $\hat{h}_\omega$ instead of $h^\star_\omega$.

Note that in the last step of each of the three upper-bounds, we used the fact that the functions we are dealing with are continuous (by \cref{assump:reg_lin_lout}) on $\Omega\times\mathcal{V}\times\mathcal{Y}$, which is compact because $\Omega$ and $\mathcal{Y}$ are compact by \cref{assump:compact} and $\mathcal{V}$ is a compact interval of $\mathbb{R}$ defined in \cref{prop:bound_hstaromega}. Hence, those functions are bounded.
\end{proof}


\begin{proposition}[{Approximation bounds}]\label{prop:grad_app_bound}
    Under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}, the following holds for any $\omega\in\Omega$:
    \begin{gather*}
    \verts{\mathcal{F}(\omega)-\widehat{\mathcal{F}}(\omega)}\leq 
    \Dout
    +\frac{C_{out}}{\lambda}\Dinh,\\
 	\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}
 	\leq  
 	\Doutw  + \frac{C_{in}}{\lambda}\Douth + \frac{C_{out}C_{in}}{\lambda^2}\Dinhh + \frac{C_{out}}{\lambda}\Dinwh + \frac{C_{out}}{\lambda}\parens{1 + 2\frac{C_{in}}{\lambda}  + \frac{C_{in}^2}{\lambda^2} }\Dinh,
    \end{gather*}
 where the constants $C_{in}$ and $C_{out}$ are given in {\cref{prop:lip_continuity_out}}.
\end{proposition}
\begin{proof}
In all what follows, we fix a value for $\omega$ in $\Omega$. We start by controlling the value function, then its gradient.

{\bf Control on the value function.}
By the triangle inequality, we have:
\begin{equation}\label{eq:diff_f_int}
    \verts{\mathcal{F}(\omega)-\hat{\mathcal{F}}(\omega)}\leq\underbrace{\verts{L_{out}(\omega, h^\star_\omega)-\widehat{L}_{out}(\omega, h^\star_\omega)}}_{\delta_{\omega}^{out}} +\underbrace{\verts{\widehat{L}_{out}(\omega, h^\star_\omega)-\widehat{L}_{out}(\omega, \hat{h}_\omega)}}_{\Eout},
\end{equation}
According to \cref{prop:lip_continuity_out}, the error term $\Eout$ is controlled by the norm of the difference $h^\star_\omega-\hat{h}_\omega$, \textit{i.e.}, $\Eout\leq C_{out}\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H}$. 
Moreover, by \cref{prop:diff_hstar_hhat}, we know that $\Verts{h^\star_\omega-\hat{h}_\omega}_\mathcal{H}\leq \frac{1}{\lambda}\Dinh$. Therefore, combining both bounds yields: 
	$\Eout\leq \frac{C_{out}}{\lambda}\Dinh$. 
The upper-bound on value function follows by substituting the previous inequality into \cref{eq:diff_f_int}. 

{\bf Control on the gradient.}
By \cref{prop:tot_grad_int}, we have the following expression for the total gradient $\nabla\mathcal{F}$:
\begin{align*}
    \nabla\mathcal{F}(\omega)=\partial_\omega L_{out}(\omega, h^\star_\omega)-\partial_{\omega, h}^2 L_{in}(\omega, h^\star_\omega)\left(\partial_h^2 L_{in}(\omega, h^\star_\omega)\right)^{-1}\partial_h L_{out}(\omega, h^\star_\omega).
\end{align*}
{Similarly, the gradient estimator $\widehat{\nabla\mathcal{F}}$ is defined by replacing $L_{out}$ and $L_{in}$ by their empirical versions $\widehat{L}_{out}$ and $\widehat{L}_{in}$, and $h_{\omega}^{\star}$ by $\hat{h}_{\omega}\coloneqq\arg\min_{h\in \mathcal{H}} \widehat{L}_{in}(\omega,h)$ in the above expression, \textit{i.e.},}
\begin{align*}
    \widehat{\nabla\mathcal{F}}(\omega)=\partial_\omega\widehat{L}_{out}(\omega, \hat{h}_\omega)-\partial_{\omega, h}^2 \widehat{L}_{in}(\omega, \hat{h}_\omega)\left(\partial_h^2 \widehat{L}_{in}(\omega, \hat{h}_\omega)\right)^{-1}\partial_h \widehat{L}_{out}(\omega, \hat{h}_\omega).
\end{align*}
To simplify notations, for any $h\in\mathcal{H}$, we introduce the following operators $R(h), \hat{R}(h):\mathcal{H}\to\Omega$:    \begin{align*}
        R(h)=\partial_{\omega, h}^2L_{in}(\omega, h)\left(\partial_h^2 L_{in}(\omega, h)\right)^{-1}\quad\text{and}\quad 
        \hat{R}(h)=\partial_{\omega, h}^2\widehat{L}_{in}(\omega, h)\left(\partial_h^2 \widehat{L}_{in}(\omega, h)\right)^{-1}.
    \end{align*}
    The difference $\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)$ can be decomposed as:
    \begin{align*}
        \nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)=&\left(\partial_\omega L_{out}(\omega,h^\star_\omega)-\partial_\omega \widehat{L}_{out}(\omega,h^\star_\omega)\right)+\left(\partial_\omega \widehat{L}_{out}(\omega,h^\star_\omega)-\partial_\omega \widehat{L}_{out}(\omega,\hat{h}_\omega)\right)\\
        &-\hat{R}(\hat{h}_\omega)\parens{\left(\partial_h L_{out}(\omega,h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega,h^\star_\omega)\right)+ \left(\partial_h\widehat{L}_{out}(\omega,h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega,\hat{h}_\omega)\right)}\\
                &-\left(R(h^\star_\omega)-\hat{R}(\hat{h}_\omega)\right)\partial_h L_{out}(\omega,h^\star_\omega).
    \end{align*}
By taking the norm of the above equality and using triangle inequality, we obtain the following upper-bound: 
    \begin{align}
    \begin{split}
        \Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}
        & \leq
        \underbrace{\Verts{\partial_\omega L_{out}(\omega,h^\star_\omega)-\partial_\omega \widehat{L}_{out}(\omega,h^\star_\omega)}}_{\Doutw}+\underbrace{\Verts{\partial_\omega \widehat{L}_{out}(\omega,h^\star_\omega)-\partial_\omega \widehat{L}_{out}(\omega,\hat{h}_\omega)}}_{\Eoutw}\\
        +&\Verts{\hat{R}(\hat{h}_{\omega})}_{\op}\parens{\underbrace{\Verts{\partial_h L_{out}(\omega,h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega,h^\star_\omega)}_{\mathcal{H}}}_{\Douth} + \underbrace{\Verts{\partial_h\widehat{L}_{out}(\omega,h^\star_\omega)-\partial_h\widehat{L}_{out}(\omega,\hat{h}_\omega)}_{\mathcal{H}}}_{\Eouth}}\\
                +& \Verts{R(h^\star_\omega)-\hat{R}(\hat{h}_\omega)}_{\op}\Verts{\partial_h L_{out}(\omega,h^\star_\omega)}_{\mathcal{H}}.
                \end{split}\label{eq:diff_grad_inter}
    \end{align}
    Next, we provide upper-bounds on $\Verts{R(h_{\omega}^{\star})- \hat{R}(\hat{h}_{\omega})}_{\op}$ and $\Verts{\hat{R}(\hat{h}_{\omega})}_{\op}$ in terms of derivatives of $L_{in}$ and $\widehat{L}_{in}$. 

    \textbf{Upper-bounds on $\Verts{R(h_{\omega}^{\star})- \hat{R}(\hat{h}_{\omega})}_{\op}$ and $\Verts{\hat{R}(\hat{h}_{\omega})}_{\op}$. } 
    %
    By application of {\cref{prop:fre_diff_L_v,prop:strong_convexity_Lin}}, we deduce that $\partial_{\omega,h}^2 L_{in}(\omega,h_{\omega}^{\star})$, $\partial_{h}^2 L_{in}(\omega,h_{\omega}^{\star})$, $\partial_{\omega,h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})$ and $\partial_{h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})$ are all bounded operators. Moreover, since $L_{in}$ and $\widehat{L}_{in}$ are $\lambda$-strongly  convex in their second argument by {\cref{prop:strong_convexity_Lin}}, it follows that $\partial_{h}^2 L_{in}(\omega,h_{\omega}^{\star})\geq \lambda\Id_{\mathcal{H}}$ and $\partial_{h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})\geq \lambda \Id_{\mathcal{H}}$. We can therefore apply \cref{lem:tech_res_1} which yields the following inequalities:  
    \begin{align*}
        \Verts{R(h_{\omega}^{\star})- \hat{R}(\hat{h}_{\omega})}_{\op}
        \leq & \frac{1}{\lambda^2}\Verts{\partial_{\omega,h}^2 L_{in}(\omega,h_{\omega}^{\star})}_{\op}\Verts{\partial_{h}^2 L_{in}(\omega,h_{\omega}^{\star}) - \partial_{h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op}\\ 
        &+ \frac{1}{\lambda}\Verts{\partial_{\omega,h}^2 L_{in}(\omega,h_{\omega}^{\star}) - \partial_{\omega,h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op},\\
        \Verts{\hat{R}(\hat{h}_{\omega})}_{\op}\leq&\frac{1}{\lambda} \Verts{\partial_{\omega,h}^2\widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op}. 
    \end{align*}
By applying the triangle inequality to both terms of the first inequality above, we obtain:
\begin{align*}
        \Verts{R(h_{\omega}^{\star})- \hat{R}(\hat{h}_{\omega})}_{\op}
        \leq & \frac{1}{\lambda^2}\Verts{\partial_{\omega,h}^2 L_{in}(\omega,h_{\omega}^{\star})}_{\op}\parens{\underbrace{\Verts{\partial_{h}^2 L_{in}(\omega,h_{\omega}^{\star}) - \partial_{h}^2 \widehat{L}_{in}(\omega,h^\star_{\omega})}_{\op}}_{\Dinhh} + \underbrace{\Verts{\partial_{h}^2 \widehat{L}_{in}(\omega,h_{\omega}^{\star}) - \partial_{h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op}}_{\Einhh}}\\ 
        &+ \frac{1}{\lambda}\parens{\underbrace{\Verts{\partial_{\omega,h}^2 L_{in}(\omega,h_{\omega}^{\star}) - \partial_{\omega,h}^2 \widehat{L}_{in}(\omega,h_{\omega}^{\star})}_{\op}}_{\Dinwh} + \underbrace{\Verts{\partial_{\omega,h}^2 \widehat{L}_{in}(\omega,h_{\omega}^{\star}) - \partial_{\omega,h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op}}_{\Einwh}}.
    \end{align*}
{\bf Final bound.} We can now substitute the above bounds on $\Verts{R(h_{\omega}^{\star})- \hat{R}(\hat{h}_{\omega})}_{\op}$ and $\Verts{\hat{R}(\hat{h}_{\omega})}_{\op}$ into \cref{eq:diff_grad_inter} to obtain the following upper-bound on the gradient error:
 \begin{equation} \label{eq:diff_grad_inter_2}
\begin{aligned}
 	\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}
 	&\leq  
 	\Doutw + \Eoutw + \frac{1}{\lambda}\Verts{\partial_{\omega,h}^2 \widehat{L}_{in}(\omega,\hat{h}_{\omega})}_{\op}\parens{\Douth + \Eouth}\\
 	+& \Verts{\partial_{h}L_{out}(\omega,h_{\omega}^{\star})}_{\mathcal{H}}\parens{ \frac{1}{\lambda^2}\Verts{\partial^2_{\omega,h}L_{in}(\omega,h_{\omega}^{\star}) }_{\op} \parens{\Dinhh + \Einhh} + \frac{1}{\lambda}\parens{\Dinwh + \Einwh} }.
 \end{aligned}
 \end{equation}
Furthermore, by \cref{prop:bounded_derivatives}, we have the following upper-bounds on the derivatives of $L_{in}$ and $L_{out}$:
\begin{align*}
	\Verts{\partial_{h}L_{out}(\omega,h_{\omega}^{\star})}_{\mathcal{H}}\leq C_{out}, \quad \Verts{\partial^2_{\omega,h}L_{in}(\omega,h_{\omega}^{\star}) }_{\op}\leq C_{in},\quad 
	\Verts{\partial^2_{\omega,h}\widehat{L}_{in}(\omega,\hat{h}_{\omega}) }_{\op}\leq C_{in}. 
\end{align*}
Incorporating the above bounds into \cref{eq:diff_grad_inter_2}, we further get:
 \begin{align*}
 	\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}
 	\leq & 
 	\Doutw + \Eoutw + \frac{C_{in}}{\lambda}\parens{\Douth + \Eouth}\\
 	&+ C_{out}\parens{ \frac{C_{in}}{\lambda^2}\parens{\Dinhh + \Einhh} + \frac{1}{\lambda}\parens{\Dinwh + \Einwh} }.
 \end{align*}
By \cref{prop:lip_continuity_out}, we can upper-bound the error terms $\Eoutw, \Eouth$ by $C_{out}\Verts{h_{\omega}^{\star}-\hat{h}_{\omega}}_{\mathcal{H}}$ and $ \Einhh,\Einwh$ by the difference $C_{in}\Verts{h_{\omega}^{\star}-\hat{h}_{\omega}}_{\mathcal{H}}$. Furthermore, since  $\Verts{h_{\omega}^{\star}-\hat{h}_{\omega}}_{\mathcal{H}}\leq \frac{1}{\lambda}\Dinh$ by \cref{prop:diff_hstar_hhat}, we can further show that gradient error satisfies the desired bound:
\begin{align*}
 	\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}
 	\leq 
 	\Doutw  + \frac{C_{in}}{\lambda}\Douth + C_{out}\parens{ \frac{C_{in}}{\lambda^2}\Dinhh + \frac{1}{\lambda}\Dinwh}+ \frac{C_{out}}{\lambda}\parens{1 + 2\frac{C_{in}}{\lambda}  + \frac{C_{in}^2}{\lambda^2} }\Dinh.
\end{align*}
\end{proof}

\subsection{Maximal inequalities}\label{app_subsec:max_in}
\begin{proposition}[Maximal inequalities for  empirical processes]\label{prop:exp_uni_bound}
Let $\Lambda$ be a positive constant. 
Under \cref{assump:compact,assump:K_bounded,assump:reg_lin_lout,assump:convexity_lin}, the following maximal inequalities hold for any $0<\lambda \leq \Lambda$:
\begin{align*}
	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Dout }
	 &\leq {\sqrt{\frac{1}{\lambda^2 m}}c(\Omega)\max(M_{out}{\lipout}\diam(\Omega),\Lambda {M_{out}^2})}\\
	 \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Doutw }
	&\leq {\sqrt{\frac{d}{\lambda^2m}}c(\Omega)\max(M_{out}\lipout\diam(\Omega),\Lambda M_{out}^2)}, 
\end{align*}
    where $c(\Omega)$ is a positive constant {greater than 1} that depends only on $\Omega$ and $d$, while {$\lipout$ and $M_{out}$ are positive constants defined in \cref{prop:uniform_boundedness,prop:uniform_Lipschitzness}}. 
\end{proposition}
\begin{proof}
We will apply the result of \cref{prop:empirical_process} which provides maximal inequalities for real-valued empirical processes that are uniformly bounded {and} Lipschitz in their parameter. To this end, consider the parametric families:
\begin{align*}
	\mathcal{T}_{l}^{out} &\coloneqq\braces{\mathcal{X}\times \mathcal{Y}\ni (x,y)\mapsto \partial_{w_l} \ell_{out}(\omega,h_{\omega}^{\star}(x),y)\mid\omega\in \Omega}, \qquad 1\leq l \leq d\\
	\mathcal{T}_{0}^{out} &\coloneqq\braces{\mathcal{X}\times \mathcal{Y}\ni (x,y)\mapsto  \ell_{out}(\omega,h_{\omega}^{\star}(x),y)\mid\omega\in \Omega}.
\end{align*} 
For any $0\leq l\leq d$, these real-valued functions are uniformly bounded by a positive constant $M_{out}$, thanks to {\cref{prop:uniform_boundedness}}. 
Moreover, by {\cref{prop:uniform_Lipschitzness}}, the functions $\omega\mapsto \partial_{\omega_l}\ell_{out}(\omega,h_{\omega}^{\star}(x),y)$, and $\omega\mapsto \ell_{out}(\omega,h_{\omega}^{\star}(x),y)$ are all $\lambda^{-1}\lipout$-Lipschitz for any $(x,y)\in \mathcal{X}\times \mathcal{Y}$. Hence, \cref{prop:empirical_process} is applicable to each of these families, with $\PP$ set to $\mathbb{Q}$ and $\mathcal{Z}$ set to $\mathcal{X}\times \mathcal{Y}$.  We treat both $\Dout$ and $\Doutw$ separately.

{\bf A maximal inequality for $\Dout$.}
For $l=0$, we readily apply \cref{prop:empirical_process} with $p=1$ to get the following maximal inequality for $\Dout$:

\begin{align*}
	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Dout } \coloneqq &
	\mathbb{E}_{\mathbb{Q}}\brackets{ \sup_{\omega\in \Omega} \verts{ \mathbb{E}_{(x,y)\sim \mathbb{Q}}\brackets{\ell_{out}(\omega,h_{\omega}^{\star}(x),y) } - \frac{1}{m}\sum_{j=1}^m \ell_{out}(\omega,h_{\omega}^{\star}(\tilde{x}_j),\tilde{y}_j) } }\\
	 \leq& \sqrt{\frac{1}{\lambda^2 m}}c(\Omega)\max({\lipout}\diam(\Omega),\Lambda {M_{out}^2}). 
\end{align*}

{\bf A maximal inequality for $\Doutw$.}
{We now turn to  $\Doutw$, which involves vector-valued processes (as an error between the gradient and its estimate).} While the maximal inequalities in \cref{prop:empirical_process} hold for real-valued processes, we will first obtain maximal inequalities for each component appearing in $\Doutw$ and then sum these to control $\Doutw$.
To this end, we first use the Cauchy-Schwarz inequality which implies that $\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} (\Doutw) }\leq \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} (\Doutw)^2 }^{\frac{1}{2}}$. Thus we only need to control $\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} (\Doutw)^2 }$. Simple calculations show that:
\begin{align*}
	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Doutw }^2&\leq \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} (\Doutw)^2 }\\
	&\leq  \sum_{l=1}^d \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega}\verts{\mathbb{E}_{(x,y)\sim\mathbb{Q}}\brackets{\partial_{w_l}\ell_{out}(\omega,h_{\omega}^{\star}(x),y)} - \frac{1}{m}\sum_{j=1}^m \partial_{\omega_l}\ell_{out}\parens{\omega,h_{\omega}^{\star}(\tilde{x}_j),\tilde{y}_j}  }^2}\\
	&\leq \parens{\sqrt{\frac{d}{\lambda^2m}}c(\Omega)\max(\lipout\diam(\Omega),\Lambda M_{out}^{{2}})}^2,
\end{align*}
where the last inequality follows by application of \cref{prop:empirical_process} with $p=2$ to each term in the right-hand side of the first inequality for $1\leq l\leq d$. We get the desired bound on  $\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Doutw }$ by taking the square root of the above inequality.
\end{proof}

\begin{proposition}[Maximal inequalities for RKHS-valued empirical processes]\label{prop:exp_uni_bound_2}
Let $\Lambda$ be a positive constant. 
Under \cref{assump:compact,assump:K_bounded,assump:reg_lin_lout,assump:convexity_lin}, the following maximal inequalities hold for any $0<\lambda\leq \Lambda$:
 \begin{align*}
 	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Douth }&\leq 
 	{\lambda^{-\frac{1}{4}}m^{-\frac{1}{2}}  \parens{c(\Omega)\max\parens{\widetilde{M}_{out,1}\widetilde{L}_{out,1}\diam(\Omega),\Lambda\widetilde{M}_{out,1}^2}}^{\frac{1}{4}}},\\
 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinh }&\leq 
 	{\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}_{in,1}\widetilde{L}_{in,1}\diam(\Omega),\Lambda\widetilde{M}_{in,1}^2}}^{\frac{1}{4}}},\\
 	 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinwh }&\leq 
 	{\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}}d^{\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}_{in,1}\widetilde{L}_{in,1}\diam(\Omega),\Lambda\widetilde{M}_{in,1}^2}}^{\frac{1}{4}}},\\
 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinhh }&\leq 
 	{\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}^2_{in,2}\widetilde{L}_{in,2}\diam(\Omega),\Lambda\widetilde{M}^2_{in,2}}}^{\frac{1}{4}}},
 \end{align*}
 where $c(\Omega)$ is a positive constant {greater than $1$} that depends only on $\Omega$ and $d$, {$\widetilde{L}_{out,1},\widetilde{L}_{in,1},\widetilde{L}_{in,2},\widetilde{M}_{out,1},\widetilde{M}_{in,1},\widetilde{M}_{in,2}$ are positive constants defined as:
 \begin{gather*}
     \widetilde{L}_{out,1}\coloneqq 2\lipout M_{out}\kappa,\quad\widetilde{L}_{in,1}\coloneqq 2\lipin M_{in}\kappa,\quad\widetilde{L}_{in,2}\coloneqq 2\lipin M_{in}\kappa^2,\\
     \widetilde{M}_{out,1}\coloneqq M_{out}^2\kappa,\quad\widetilde{M}_{in,1}\coloneqq M_{in}^2\kappa,\quad\widetilde{M}_{in,2}\coloneqq M_{in}^2\kappa^2,
 \end{gather*}
 and $\lipout,\lipin,M_{out},M_{in}$ are positive constants given in \cref{prop:uniform_boundedness,prop:uniform_Lipschitzness}.}
 
\end{proposition}

\begin{proof}
Consider parametric families of real-valued functions indexed by $\Omega$ of the form:
\begin{align*}
	\mathcal{T}_{s,a}\coloneqq\braces{ t_{\omega}: ((x,y),(x',y'))\mapsto  f_s(\omega,x,y)f_s(\omega,x',y')K^{a}(x,x')\mid\omega\in \Omega },
\end{align*}
where $a\in \{1,2\}$,  $s$ is an integer satisfying {$0\leq s\leq d+2$}, and $f_s(\omega,x,y)$ are real-valued functions given by:
\begin{gather*}
	f_0: (\omega,x,y)\mapsto\partial_v \ell_{out}(\omega, h^\star_\omega(x), y),\qquad 
	f_1:(\omega,x,y)\mapsto\partial_v \ell_{in}(\omega, h^\star_\omega(x), y),\qquad
	f_2:(\omega,x,y)\mapsto\partial_v^2 \ell_{in}(\omega, h^\star_\omega(x), y),\\
	f_{2+l}: (\omega,x,y)\mapsto\partial_{\omega_l, v}^2 \ell_{in}(\omega, h^\star_\omega(x), y), \quad 1\leq l\leq d.
\end{gather*}
For any $1\leq s\leq d+2$, the real-valued functions $f_s$ are uniformly bounded by a positive constant $M_{in}$ thanks to {\cref{prop:uniform_boundedness}}. Moreover, since the kernel $K$ is bounded by {$\kappa$ due to \cref{assump:K_bounded}}, it follows that all elements $t_{\omega}$ of $\mathcal{T}_{s,a}$ are uniformly bounded by {$\widetilde{M}_{in,a}\coloneqq M_{in}^2\kappa^a$}. Moreover, for $1\leq s\leq d+2$, the functions $\omega\mapsto f_{s}(\omega,x,y)$, are $\lambda^{-1}\lipin$-Lipschitz for any $(x,y)\in\mathcal{X}\times\mathcal{Y}$, by {\cref{prop:uniform_Lipschitzness}}. Hence, it follows that the maps $\omega\mapsto t_{\omega}((x,y),(x',y'))$ are $\lambda^{-1}\widetilde{L}_{in,a}$-Lipschitz with {$\widetilde{L}_{in,a}\coloneqq 2\lipin M_{in}\kappa^a$} for any $(x,y)$ and $(x',y')$ in $\mathcal{X}\times \mathcal{Y}$. Similarly, for $s=0$, we get the same properties, albeit, with different constants, \textit{i.e.}, the family {$\mathcal{T}_{0,a}$} is uniformly bounded by a constant {$\widetilde{M}_{out,a}\coloneqq M_{out}^2\kappa^a$} with {$M_{out}$ introduced in \cref{prop:uniform_boundedness}}, and is $\lambda^{-1}\widetilde{L}_{out,a}$-Lipschitz in its parameter with {$\widetilde{L}_{out,a}\coloneqq 2\lipout M_{out}\kappa^a$} where $\lipout$ is given in {\cref{prop:uniform_Lipschitzness}}.
Hence, the maximal inequality in \cref{lem:u_stat_sup_p_omega} is applicable to each of these families with $\mathcal{Z}$ set to $\mathcal{X}\times \mathcal{Y}$, and {$\PP$ set either to $\mathbb{P}$ for $1\leq s\leq d+2$, or to $\mathbb{Q}$ for $s=0$}.
For conciseness, in all what follows, we will write $z = (x,y)$ and $z_i = (x_i,y_i)$ and $\tilde{z}_j = (\tilde{x}_j,\tilde{y}_j)$ for $1\leq i\leq n$ and $1\leq j\leq m$. 

{\bf Maximal inequalities for $\Douth$ and $\Dinh$.}
We control $\Douth$ first as $\Dinh$ will be dealt with similarly. Using Cauchy-Schwarz inequality and standard calculus, we have that:
\begin{align*}
	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Douth }^2
	&\leq \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} (\Douth)^2 }\\
	&\coloneqq \mathbb{E}_{\mathbb{Q}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{Q}}\brackets{\partial_v\ell_{out}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)} - \frac{1}{m}\sum_{j=1}^m \partial_v\ell_{out}(\omega,h_{\omega}^{\star}(\tilde{x}_j),\tilde{y}_j)K(\tilde{x}_j,\cdot) }_{\mathcal{H}}^2 }\\
	&= \mathbb{E}_{\mathbb{Q}}\brackets{ \sup_{\omega\in \Omega} \mathbb{E}_{z,z'\sim\mathbb{Q}\otimes\mathbb{Q}}\left[t_\omega(z,z')\right]+\frac{1}{m^2}\sum_{i,j=1}^m t_\omega(z_i,z_j)-\frac{2}{m}\sum_{j=1}^m\mathbb{E}_{z\sim\mathbb{Q}}\left[t_\omega(z,\tilde{z}_j)\right]},
\end{align*}
 where $t_\omega(z,z') \coloneqq \partial_v\ell_{out}(\omega,h_{\omega}^{\star}(x),y)\partial_v\ell_{out}(\omega,h_{\omega}^{\star}(x'),y')K(x,x')\in \mathcal{T}_{0,1}$. The last term is precisely what \cref{lem:u_stat_sup_p_omega} controls when applying it to the family $\mathcal{T}_{0,1}$ and choosing $\PP$ to be $\mathbb{Q}$. Therefore, the following maximal inequality holds by application of \cref{lem:u_stat_sup_p_omega}:
 \begin{align*}
 	\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in \Omega} \Douth }\leq 
 	\lambda^{-\frac{1}{4}}m^{-\frac{1}{2}}  \parens{c(\Omega)\max\parens{\widetilde{M}_{out,1}\widetilde{L}_{out,1}\diam(\Omega),\Lambda\widetilde{M}_{out,1}^2}}^{\frac{1}{4}},
 \end{align*}
 where $c(\Omega)$ is a positive constant {greater than $1$} the depends only on $\Omega$ and $d$. We obtain a similar inequality for $\Dinh$ by carrying out similar calculations, then applying \cref{lem:u_stat_sup_p_omega} to the family $\mathcal{T}_{1,1}$ and choosing $\mathbb{P}$ for the probability distribution $\PP$. The resulting bound is then of the form:
\begin{align*}
 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinh }\leq 
 	\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}_{in,1}\widetilde{L}_{in,1}\diam(\Omega),\Lambda\widetilde{M}_{in,1}^2}}^{\frac{1}{4}}.
 \end{align*}

{\bf A maximal inequality for $\Dinwh$.} We have:
\begin{align*}
	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinwh }^2
	&\stackrel{(a)}{\leq} \mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} (\Dinwh)^2 }\\
	&\stackrel{(b)}{\coloneqq} \mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{P}}\brackets{\partial_{\omega,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)} - \frac{1}{n}\sum_{i=1}^n \partial_{\omega,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x_i),y_i)K(x_i,\cdot) }_{\op}^2 }\\
	&\stackrel{(c)}{\leq}\mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{P}}\brackets{\partial_{\omega,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)} - \frac{1}{n}\sum_{i=1}^n \partial_{\omega,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x_i),y_i)K(x_i,\cdot) }_{\hs}^2 }\\
	&\stackrel{(d)}{=}\sum_{l=1}^d \mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{P}}\brackets{\partial_{\omega_l,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)} - \frac{1}{n}\sum_{i=1}^n \partial_{\omega_l,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x_i),y_i)K(x_i,\cdot) }_{\mathcal{H}}^2 }\\
	&\stackrel{(e)}{=} \sum_{l=1}^d \mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \mathbb{E}_{z,z'\sim\mathbb{P}\otimes\mathbb{P}}\left[t_{\omega,l}(z,z')\right]+\frac{1}{n^2}\sum_{i,j=1}^n t_{\omega,l}(z_i,z_j)-\frac{2}{n}\sum_{i=1}^n\mathbb{E}_{z\sim\mathbb{P}}\left[t_{\omega,l}(z,z_i)\right]},
\end{align*}
where we introduced $t_{\omega,l}(z,z') \coloneqq \partial_{\omega_l,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)\partial_{\omega_l,v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x'),y')K(x,x')\in \mathcal{T}_{2+l,1}$. Here, (a) follows by Cauchy-Schwarz inequality, (b) is obtained by definition of $\Dinwh$, while (c) uses the general fact that the operator norm of an operator is upper-bounded by its Hilbert-Schmidt norm which is finite in our case by application of \cref{prop:fre_diff_L_v}. Moreover, (d) further uses the Hilbert-Schmidt norm of an operator  in terms of the norm of its rows, while (e) simply expands the squared RKHS norm and uses the reproducing property in the RKHS $\mathcal{H}$. Each term in the last item (e) is precisely what \cref{lem:u_stat_sup_p_omega} controls when applying it to the families $\mathcal{T}_{2+l,1}$ for $1\leq l\leq d$ and choosing $\PP$ to be $\mathbb{P}$.  Therefore, the following maximal inequality holds by a direct application of \cref{lem:u_stat_sup_p_omega}:
 \begin{align*}
 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinwh }\leq 
 	\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}}d^{\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}_{in,1}\widetilde{L}_{in,1}\diam(\Omega),\Lambda\widetilde{M}_{in,1}^2}}^{\frac{1}{4}},
 \end{align*}
 where $c(\Omega)$ is a positive constant greater than $1$ that depends only on $\Omega$ and $d$.

{\bf A maximal inequality for $\Dinhh$.} We will use a similar approach as for $\Dinwh$. We have:
\begin{align*}
	&\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinhh }^2\\
	&\stackrel{(a)}{\leq} \mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} (\Dinhh)^2 }\\
	&\stackrel{(b)}{\coloneqq} \mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{P}}\brackets{\partial_{v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)\otimes K(x,\cdot)} - \frac{1}{n}\sum_{i=1}^n \partial_{v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x_i),y_i)K(x_i,\cdot)\otimes K(x_i,\cdot) }_{\op}^2 }\\
	&\stackrel{(c)}{\leq}\mathbb{E}_{\mathbb{P}}\brackets{ \sup_{\omega\in \Omega} \Verts{ \mathbb{E}_{(x,y)\sim \mathbb{P}}\brackets{\partial_{v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x),y)K(x,\cdot)\otimes K(x,\cdot)} - \frac{1}{n}\sum_{i=1}^n \partial_{v}^2\ell_{in}(\omega,h_{\omega}^{\star}(x_i),y_i)K(x_i,\cdot)\otimes K(x_i,\cdot) }_{\hs}^2 }\\
	&\stackrel{(d)}{=} \mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \mathbb{E}_{z,z'\sim\mathbb{P}\otimes\mathbb{P}}\left[t_\omega(z,z')\right]+\frac{1}{n^2}\sum_{i,j=1}^n t_\omega(z_i,z_j)-\frac{2}{n}\sum_{i=1}^n\mathbb{E}_{z\sim\mathbb{P}}\left[t_\omega(z,z_i)\right]},
\end{align*}
where we introduced $t_{\omega}(z,z')\coloneqq\partial_{v}^2\ell_{in}(\omega,x,y)\partial_{v}^2\ell_{in}(\omega,x',y')K^2(x,x')\in \mathcal{T}_{2,2}$. Here, (a) follows by Cauchy-Schwarz inequality, (b) is obtained by definition of $\Dinhh$, while (c) uses the general fact that the operator norm of an operator is upper-bounded by its Hilbert-Schmidt norm which is finite in our case by application of \cref{prop:fre_diff_L_v}. Moreover, (d) further uses the identity in \cref{lem:hs_identity} for computing the Hilbert-Schmidt norm of sum/expectation of tensor-product operators. 
The last item (d) is precisely what \cref{lem:u_stat_sup_p_omega} controls when applying it to the family $\mathcal{T}_{2,2}$  and choosing $\PP$ to be $\mathbb{P}$.  Therefore, the following maximal inequality holds by direct application of \cref{lem:u_stat_sup_p_omega}:
 \begin{align*}
 	\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in \Omega} \Dinhh }\leq 
 	\lambda^{-\frac{1}{4}}n^{-\frac{1}{2}} \parens{c(\Omega)\max\parens{\widetilde{M}_{in,2}\widetilde{L}_{in,2}\diam(\Omega),\Lambda\widetilde{M}^2_{in,2}}}^{\frac{1}{4}},
 \end{align*}
 where $c(\Omega)$ is a positive constant greater than $1$ that depends only on $\Omega$ and $d$.
\end{proof}
\subsection{Proof of \cref{th:generalizationBounds}}\label{app_sub:main_proof}
\begin{theorem}[Generalization bounds]\label{th:gen_bound}
The following holds under \cref{assump:compact,assump:convexity_lin,assump:K_bounded,assump:reg_lin_lout}:
\begin{align*}
    \mathbb{E}\brackets{\sup_{\omega\in\Omega}\verts{\mathcal{F}(\omega)-\hat{\mathcal{F}}(\omega)}}
    &\lesssim
    \frac{1}{\lambda m^{\frac{1}{2}}}+\frac{C_{out}}{\lambda^{\frac{5}{4}} n^{\frac{1}{2}}}\\
    \mathbb{E}\left[\sup_{\omega\in\Omega}\left\|\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)\right\|\right]
    &\lesssim
    \frac{1}{\lambda}\left(d^{\frac{1}{2}} + \frac{C_{in}}{\lambda^{\frac{1}{4}}}\right)\frac{1}{m^{\frac{1}{2}}} + \frac{C_{out}}{\lambda^{\frac{5}{4}}}\parens{2 + 3\frac{C_{in}}{\lambda}+\frac{C_{in}^2}{\lambda^2}}\frac{1}{n^{\frac{1}{2}}},
\end{align*}
where the constants $C_{in}$ and $C_{out}$ are given in \cref{prop:lip_continuity_out}.
\end{theorem}

\begin{proof}
Using the point-wise estimates in \cref{prop:grad_app_bound} and taking their supremum over $\Omega$ followed by the expectations over data, the following error bounds hold:
\begin{align*}
   \mathbb{E}\brackets{\sup_{\omega\in\Omega} \verts{\mathcal{F}(\omega)-\hat{\mathcal{F}}(\omega)}}
   \leq & 
    \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in\Omega}\Dout}
    +\frac{C_{out}}{\lambda}\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in\Omega}\Dinh},\\
    \mathbb{E}\brackets{\sup_{\omega\in\Omega}\Verts{\nabla\mathcal{F}(\omega)-\widehat{\nabla\mathcal{F}}(\omega)}}
 	\leq &  
    \mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in\Omega}\Doutw}  + \frac{C_{in}}{\lambda}\mathbb{E}_{\mathbb{Q}}\brackets{\sup_{\omega\in\Omega}\Douth}\\ 
    &+\frac{C_{out}}{\lambda}\parens{1 + 2\frac{C_{in}}{\lambda}+\frac{C_{in}^2}{\lambda^2}} \mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in\Omega}\Dinh}\\
    &+ \frac{C_{out}C_{in}}{\lambda^2}\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in\Omega}\Dinhh} + \frac{C_{out}}{\lambda}\mathbb{E}_{\mathbb{P}}\brackets{\sup_{\omega\in\Omega}\Dinwh}.
\end{align*}
Furthermore, we can use the maximal inequalities in  \cref{prop:exp_uni_bound,prop:exp_uni_bound_2} to control each term appearing in the right-hand side of the above inequalities:
\begin{align*}
    \mathbb{E}\brackets{\sup_{\omega\in\Omega} \verts{\mathcal{F}(\omega)-\hat{\mathcal{F}}(\omega)}}
   \leq & 
   R\parens{ m^{-\frac{1}{2}}\lambda^{-1}  + C_{out}n^{-\frac{1}{2}}\lambda^{-(1+\frac{1}{4})}}\\
    \mathbb{E}\brackets{\sup_{\omega\in\Omega}\Verts{\nabla\mathcal{F}(\omega)-\widehat{\mathcal{F}}(\omega)}}
 	\leq &  R\Big( m^{-\frac{1}{2}}\lambda^{-1}d^{\frac{1}{2}} + C_{in}m^{-\frac{1}{2}}\lambda^{-(1+\frac{1}{4})} + C_{out}n^{-\frac{1}{2}}\lambda^{-(1+\frac{1}{4})}\parens{1 + 2\frac{C_{in}}{\lambda}+\frac{C_{in}^2}{\lambda^2}}\\
 	&\qquad+ C_{out}C_{in}n^{-\frac{1}{2}}\lambda^{-(2+\frac{1}{4})}  +  C_{out}n^{-\frac{1}{2}}\lambda^{-(1+\frac{1}{4})}\Big),
\end{align*}
where the constant $R$ depends only on the Lipschitz constants $\lipin$, $\lipout$, the upper-bounds $M_{in}$, $M_{out}$, the bound $\kappa$ on the kernel, the set $\Omega$ and the dimension $d$. Rearranging the obtained upper-bounds concludes the proof.
\end{proof}