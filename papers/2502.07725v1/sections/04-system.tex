\section{Pluto}

Incorporating these design goals, we implemented \pluto~as a prototype system for authoring semantically-aligned text and charts.

\subsection{Example Usage Scenarios}
\label{sec:scenarios}

\begin{figure}[t!]
    \centering
    \includegraphics[width=.5\textwidth]{figures/pdf/scenario-1.pdf}
    \caption{Upon processing a description, \pluto~flags statements that require manual verification (A) and automatically \annotation{annotates} the chart based on data references in the description (B).}
    \Description[Two examples shows Pluto's suggestions for statement verification and chart annotation.]{In the first case, the system highlights a potentially incorrect statement in the user's description of the chart, allowing the user to inspect and verify whether the statement is correct. The second example illustrates how the system annotates (here, by adding a gold stroke) a portion of the chart by inspecting the data value references in the description.}
    \label{fig:scenario-1}
\end{figure}

Figure~\ref{fig:interface} shows \pluto's interface.
Users can drag and drop data fields onto visual encoding channels to create charts.
To underscore a unified experience for authoring charts and text, the system also presents an explicit title and description region just above and below the chart.
Users can also annotate the chart by creating text callouts via a context menu invoked on the chart, or by adding visual embellishments using the chart editor (e.g., borders to highlight marks).
System recommendations are either directly applied to the title, chart, or description or displayed to the right of the chart and description (Figure~\ref{fig:interface}F, G) for authors to review (\textbf{DG4}, \textbf{DG5}).

To illustrate how \pluto's interface and features collectively enable unified authoring of text and charts for data-driven communication, we now describe three vignettes\footnote{These usage scenarios are modeled on examples of how participants used \pluto~during the study described in Section~\ref{sec:study}.}.
These examples are also illustrated in the supplementary video.
% Pluto's friends from Disney cartoons: Dinah, Ronnie, Fifi

\vspace{.5em}\noindent\textbf{Augmenting generated text with built-in safeguards and chart annotations.}
Consider Dinah, an analyst at a movie production company.
Dinah is tasked with summarizing a chart showing movie earnings across genres (Figure~\ref{fig:teaser}A) to share as part of a report her company plans to publish.

Dinah is unsure about how to start her description, so she uses the {\small\faIcon{feather-alt}} \textbf{Generate} feature to bootstrap her authoring process (\textbf{DG3}).
In response, \pluto~inspects the chart and returns a description for Dinah to review (Figure~\ref{fig:teaser}A-bottom).
Dinah peruses the generated text and manually edits it for conciseness.
She then clicks {\small{\faIcon[regular]{lightbulb}}} \textbf{Suggest} to get ideas for using a combination of the description and the chart for better communication.

Analyzing the description, \pluto~makes three changes.
The system flags
% \reco{description statements with ambiguous takeaways}
description statements with ambiguous takeaways
for review using a dashed border, suggesting that Dinah manually verifies the text with the chart before sharing it with others (Figure~\ref{fig:scenario-1}A) (\textbf{DG3}).
Using \pluto's interactive highlighting feature, Dinah hovers over the statement in the description to see portions of the chart it refers to.
Reflecting on the flagged text, Dinah updates it to remove the modifier ``\textit{significant}'' and make her description more objective for the readers' interpretation.

\pluto~also suggests a title, ``\textit{Action and Animation Dominate: Gross Earnings by Genre (2010-2019)}'' based on both the narrative in the description and the underlying trends in the chart (Figure~\ref{fig:teaser}A-top).

Finally, besides suggestions for the text, \pluto~also adds an annotation to the chart highlighting the key regions the text describes (\textbf{DG1}).
In this case, detecting the emphasis on the \textit{Action} and \textit{Animation} genres and their trends between 2013 and 2017, the system adds a \annotation{gold stroke} around the corresponding lines in the chart (Figure~\ref{fig:scenario-1}B).

Satisfied with her changes based on the system suggestions, Dinah shares the title, chart, and description with her colleagues for review.

\begin{figure}[t!]
    \centering
    \includegraphics[width=\linewidth]{figures/pdf/scenario-2.pdf}
    \caption{Examples of \pluto's recommendations including an in-place sentence completion (A), \annotation{annotations} based on a chart's description (B), and a text callout generated based on marks selected on a chart (C).}
    \Description[Three examples of Pluto's recommendations.]{In the first case, the system completes the user's sentence when the user presses the tab key on a partially typed statement. In the second example, the system adds a gold stroke to marks on the chart to highlight that they are referenced in the text. In the third example, the user clicks two marks on the chart and asks Pluto to generate a text callout - this results in the system adding a text bubble with content focusing on the selected marks.}
    \label{fig:scenario-2}
\end{figure}

\vspace{.5em}
\noindent\textbf{Steering text competition through data-driven narratives and multimodal input.}
Imagine Ronnie, a financial analyst, writing a report on the monetary impact of bird strikes across the US based on the chart shown in Figure~\ref{fig:scenario-2}A.

Ronnie notices that most states, with the exception of Texas and New Jersey, have tall orange bars corresponding to costs incurred by bird strikes during the day.
Noting this observation, Ronnie types, ``\textit{Across all states, most bird strikes happen during the day.}''
Wanting to emphasize the exception of Texas and New Jersey, Ronnie types ``\textit{However, }'' and presses the \key{Tab} key to ask the system to finish the sentence.
Parsing the preceding sentence and the data trends from the chart, \pluto~generates the completion ``\textit{Texas breaks this trend by incurring the highest costs from birdstrikes at dawn.}'' (Figure~\ref{fig:scenario-2}A)
Ronnie accepts this completion but edits it to include New Jersey.

Next, to emphasize the high cost incurred by incidents in New York at night, Ronnie types ``\textit{It is also interesting that}," clicks on the teal bar showing the total cost for \textit{New York} at \textit{Night}, and again invokes a sentence completion.
Using the multimodal input from the chart selection and the existing description text (\textbf{DG2}), \pluto~suggests the text ``\textit{New York experiences its highest costs from birdstrikes at night, again deviating from the predominant trend of daytime incidents.}'' (Figure~\ref{fig:teaser}B)

Content with his description, Ronnie uses {\small{\faIcon[regular]{lightbulb}}} \textbf{Suggest} to see how he can further improve his text and the chart.
\pluto~processes the description and adds a \annotation{stroke} to visually highlight the states \textit{Texas}, \textit{New York}, and \textit{New Jersey} and the times \textit{Dawn} and \textit{Night} based on their high data values and the emphasis in the description (Figure~\ref{fig:scenario-2}B) (\textbf{DG1}).
Seeing this annotation gives Ronnie an idea to explicitly call out the striking differences in values between Texas and New York.
He selects the two tall bars within Texas and New York and uses {\small{\faIcon[regular]{feather-alt}}} \textbf{Generate Callout} to create a textual annotation directly overlaid onto the chart (Figure~\ref{fig:scenario-2}C) (\textbf{DG2}).
Manually refining the generated callout and visual embellishments (\textbf{DG5}), Ronnie saves the annotated chart and description for his report.

\vspace{.5em}
\noindent\textbf{Guiding manual authoring via system recommendations.}
Imagine Fifi, a realtor who is using the grouped bar chart shown in Figure~\ref{fig:interface}D to author an email blast on house pricing trends for her clients.
Analyzing the chart, Fifi manually writes a description with three sentences, shown in Figure~\ref{fig:interface}E.
With this initial text, she invokes the {\small{\faIcon[regular]{lightbulb}}} \textbf{Suggest} feature to see how she can improve her text and chart for communication.

Parsing the description, \pluto~detects that it lacks a summary of the chart's encodings and also detects that there is no higher-level statement encompassing a trend across multiple home types.
Translating these into recommendations, \pluto~suggests adding a brief statement about the chart's layout and a statement talking about the general impact of garage types across house types, respectively (Figure~\ref{fig:interface}G) (\textbf{DG3}).
Acknowledging these might be useful as overview statements for her readers, Fifi previews what her description would read like with the suggested text by hovering on the recommendations and subsequently accepting them.
As with the other examples, \pluto~also suggests a title (\textit{Home Type and Garage Influence on Property Prices}), but Fifi finds this too formal and manually adjusts it to make it more catchy: ``\textit{Can I afford both a car and a home?: The Influence of Garage Type on Property Prices}.''

\begin{figure}[t!]
    \centering
    \input{listings-and-algos/definitions}
    \caption{Conceptual schema representing the key text and chart elements in \pluto's interface.}
    \Description[Conceptual schema representing the key text and chart elements in Pluto.]{Conceptual schema representing the key text and chart elements in Pluto}
    \label{fig:schema}
\end{figure}

Besides the text suggestions, \pluto~also detects that the description emphasizes the home types with highest and lowest values, whereas the home types in the chart are sorted alphabetically.
To resolve this disparity, the system provides a chart design recommendation to sort the home types by price ranging from the highest to lowest (Figure~\ref{fig:interface}F) (\textbf{DG1}).
Fifi accepts this recommendation as it can give her clients a glanceable summary of some key takeaways in her text (Figure~\ref{fig:teaser}C).

\subsection{Conceptual Model}

To enable the aforementioned workflows and recommendations, we model the various components across the text and the chart in \pluto~as a \emph{conceptual schema} summarized in Figure~\ref{fig:schema}.
We use this schema in the subsequent sections to detail how the system tracks user input and generates recommendations.

Specifically, a \schemaPrimary{Chart} is represented by mapping \schemaPrimary{Data} onto specific visual encodings (in this case, a Vega-Lite \schemaPrimary{Specification}~\cite{satyanarayan2016vega}).
The \schemaPrimary{ActiveSelection} enumerates the data items that have been selected through direct manipulation interaction (e.g., in Figures~\ref{fig:teaser}B,~\ref{fig:scenario-2}C).
Additionally, the chart can also have one or more \schemaPrimary{Annotations}.
These can be textual comments on the chart, visual embellishments applied to individual marks (e.g., Figures~\ref{fig:interface}D,~\ref{fig:scenario-1}B), or overlays like a regression line on a scatterplot or a line marking the average value across all bars in a bar chart.

The chart's \schemaPrimary{Title} is \schemaPrimary{Text} that may include references to \schemaPrimary{DataItems} (e.g., \textit{Genre}: [\textit{Action}, \textit{Animation}] in Figure~\ref{fig:teaser}A).

\begin{figure}[t!]
    \centering    
    \includegraphics[width=\linewidth]{figures/architecture.png}
    \caption{\pluto's system architecture overview}
    \Description[Pluto's system architecture.]{Given the active chart and text from the interface, Pluto uses a heuristic parser process the information and to generate recommendations. When providing recommendations involving text suggestions, the system also uses an LLM in parallel to generate the recommended text.}
    \label{fig:architecture}
\end{figure}

The \schemaPrimary{Description} is represented as a collection of \schemaPrimary{Statements}.
Each statement maps to one of the four semantic statement types proposed by Lundgard and Satyanarayan~\cite{lundgard2021accessible}---namely, \schemaSecondary{encoding}, \schemaSecondary{perceptual-trend}, \schemaSecondary{data-fact}, \schemaSecondary{domain-specific}, or  \schemaSecondary{other} (e.g., a statement about the data source for a chart).
Additionally, similar to the title, statements in the description may also contain references to specific \schemaPrimary{DataItems}.

Note that this schema is not exhaustive (e.g., there may be additional types of annotations, statement types, or chart selections) and was primarily designed to operationalize the recommendations in \pluto.

However, we hope that the idea of formalizing not only the chart but also its associated text can inspire future work on grammars and systems for data-driven communication through a \emph{combination} of text and charts.

\subsection{System Overview}

\pluto~is implemented as a web-based application and is developed using Python, HTML/CSS, and JavaScript.
Visualizations in the tool are created using Vega-Lite~\cite{satyanarayan2016vega}.
The system currently supports three encoding channels (\texttt{x}, \texttt{y}, \texttt{color}) and three mark types (\texttt{bar}, \texttt{line}, \texttt{point}).
Collectively, this combination of encoding and mark types enables specifying several visualizations, including single- and multi-series bar charts, line charts, histograms, and scatterplots, covering a breadth of visualizations explored in prior systems~\cite{kim2023emphasischecker,latif2021kori,sultanum2023datatales,kim2024datadive,choi2022intentable,obeid2020chart,liu2020autocaption,hsu2021scicap,alam2023seechart}.

Figure~\ref{fig:architecture} depicts a high-level overview of the system architecture.
Specifically, \pluto~uses a combination of an LLM (GPT-4~\cite{achiam2023gpt}) and a heuristics-based approach for generating suggestions.
Specifically, requests like generating an entire description or a title from a chart are directly fulfilled using the LLM.
In other cases, a custom parser extracts information from the text and chart and also classifies statements in the description based on their semantic levels~\cite{lundgard2021accessible}.
This extracted information is leveraged by a heuristics-based recommendation engine to generate recommendations, including adding/editing text, adding mark annotations, and suggesting chart design changes such as sorting, among others.
In cases where the recommendations involve generated text suggestions, the recommendation engine either uses its built-in templates or interacts with the LLM to pass it the required context for the text generation.
In the subsequent sections, we detail these components and \pluto's recommendation generation process.

\subsection{Text and Chart Parsing}
\label{sec:parser}

The parser extracts a number of features from the text and the chart that are used to determine system recommendations.

\textbf{Text.}
The parser analyzes text in the description, title, and annotations to identify \schemaPrimary{DataItems}.
The system uses a combination of a lexicon- and grammar-based approach adapted from prior natural language interfaces for visualization (e.g.,~\cite{gao2015datatone,setlur2016eviza,narechania2020nl4dv}) to detect data item references.
Specifically, given an input text, the parser extracts a list of N-grams and compares the N-grams to available data fields and values, looking for both syntactic (e.g., misspellings) and semantic similarities (e.g., synonyms) employing Levenshtein distance~\cite{yujian2007normalized} and the Wu-Palmer similarity score~\cite{wu1994verb}, respectively.
The extracted items are subsequently used to support features like adding mark annotations (Figures~\ref{fig:scenario-1}B,~\ref{fig:scenario-2}B) and highlighting relevant portions of the chart while hovering over statements in the description (Figure~\ref{fig:scenario-1}A).

In addition to detecting data item references, the parser also classifies description statements into one of the five statement types.
We use a random forest classifier with BERT~\cite{sanh2019distilbert} to match a statement to one of the four semantic levels of text---\schemaSecondary{encoding}, \schemaSecondary{perceptual-trend}, \schemaSecondary{data-fact}, or \schemaSecondary{domain-specific}~\cite{lundgard2021accessible}.
If the classification probability for all four types is below 60\% \new{(an empirically set threshold)}, a statement is labeled as \schemaSecondary{other}.
The classifier is trained on a dataset of $2147$ chart description statements curated by Lundgard and Satyanarayan~\cite{lundgard2021accessible}.
Our choice for the classifier was based on comparing the results of 10-fold cross-validation between different techniques, including support vector machines~\cite{Cortes1995SupportVectorN}, random forests~\cite{breiman2001}, logistic regression~\cite{strother1967}, and na\"{i}ve Bayes~\cite{Duda1974PatternCA}.

\textbf{Chart.}
The parser also detects salient \schemaPrimary{DataItems} in the chart.
For instance, for bar charts, the parser shortlists up to three categories with the highest and lowest values.
For line charts, the system records time periods or specific timestamps with the most significant peaks and drops based on computing the smoothed z-scores, and so on.
These chart-specific heuristics to determine salient targets are derived from prior ``auto-insight'' generating visualization systems (e.g.,~\cite{cui2019datasite,wang2019datashot,srinivasan2018augmenting,demiralp2017foresight}) and research on mappings between analytic tasks and visualizations (e.g.,~\cite{amar2005low,schulz2013design,saket2018task}).
The salient items detected from the chart are subsequently used to suggest potential annotations and to generate text suggestions for verifying the description statements (e.g., Figure~\ref{fig:scenario-1}A).

\subsection{Recommendation Generation}
\label{sec:reco-generation}
\pluto~uses a combination of heuristics, text templates, and an LLM to suggest changes to the text and the chart.
The vignettes in \S\ref{sec:scenarios} illustrate the breadth of \pluto's recommendations, which can broadly be categorized into three groups: 1) \textit{full-text recommendations} to populate descriptions, titles, or text annotations, 2) \textit{description statement recommendations} to fine-tune or update an existing description, and 3) \textit{chart design recommendations} to ensure the chart is structurally aligned to its corresponding text.

\begin{figure*}[t!]
    \centering
    \includegraphics[width=.96\textwidth]{figures/pdf/recommendations-full-text.pdf}
    \caption{Overview of full-text recommendation generation. Given the context of the chart, data, and any existing text, \pluto~generates new text for the description, title, or annotations. \schemaPrimary{Input parameters} with a \schemaPrimary{?} are optional only used if available.}
    \Description[Overview of full-text recommendation generation.]{Given the context of the chart, data, and any existing text, Pluto uses an LLM to suggest the title, description, and text annotations.}
    \label{fig:full-text-recommendation}
\end{figure*}

\vspace{.5em}
\noindent{\large{\textbf{Full-text Recommendations}}
\vspace{.5em}

\noindent{}These recommendations are invoked using the {\small\faIcon{feather-alt}} \textbf{Generate} button and suggest text for the title, description, or text annotations (e.g., Figure~\ref{fig:teaser}A and Figure~\ref{fig:scenario-2}C).
All recommendations in this category are generated using the LLM, and Figure~\ref{fig:full-text-recommendation} presents an overview of the input/output for the recommendations.
The LLM prompts are provided as part of the supplementary material.

\textbf{Description.}
We use \schemaPrimary{StatementTypes} to systematically generate descriptions in \pluto.
Specifically, we provide the LLM with examples of the four statement types from Lundgard and Satyanarayan's dataset~\cite{lundgard2021accessible}.
Following the findings from Tang et al.'s qualitative analysis of the VisText chart caption dataset~\cite{tang2023vistext}, we prompt the LLM to generate a description with a constraint that the text should start with an \schemaSecondary{encoding} statement and is followed by at least one \schemaSecondary{preceptual-trend}.
This pattern follows the classic \textit{``Overview first''} mantra for visualization design~\cite{shneiderman2003eyes} and ensures the description talks about the chart and high-level takeaways before listing details of individual items and values.
An example of this constraint in play can be noticed in the generated description in Figure~\ref{fig:full-text-recommendation} where the first statement, ``\textit{This line chart...}'' describes the chart's encodings and the second highlights how ``\textit{...certain genres like Animation and Action consistently outperform others...}'' before talking about other lower-level observations from the chart.

By default, the LLM only uses the chart type and \schemaPrimary{Data} to generate a description.
However, if the chart contains an \schemaPrimary{ActiveSelection}, has \schemaPrimary{TextAnnotations}, or the user has entered a \schemaPrimary{Title}, these are also used as context for generating the description.

\textbf{Title.}
By default, the system uses a chart's \schemaPrimary{Specification} and \schemaPrimary{Data} to generate a title.
However, similar to generating descriptions, if there is additional context in the form of an \schemaPrimary{ActiveSelection}, \schemaPrimary{TextAnnotations}, or a \schemaPrimary{Description},\\ \pluto~leverages that information to generate a title that highlights the key message across the chart and previously added text.
For instance, the suggested title in Figure~\ref{fig:full-text-recommendation} contains \textit{Action} and \textit{Animation} since these are called out as focal entities in the \schemaPrimary{Description}.

\textbf{Text annotations.}
\pluto~also allows users to directly select items of interest on the chart and generate annotations based on the \schemaPrimary{ActiveSelection} (\textbf{DG2}).
An example of this type of text generation is shown in Figure~\ref{fig:full-text-recommendation}-bottom where the \schemaPrimary{TextAnnotation} is created based on the two selected bars for the states of \textit{New York} and \textit{Texas}, respectively.
The example also illustrates the effect of including previously entered text as context for the generation.
Specifically, notice that because the \schemaPrimary{Description} talks about Texas and New York deviating from the general trend, the generated annotation text also adopts that framing and phrasing (e.g., ``\textit{...contrary to the norm...}'') for consistency.
\newline

\noindent{}Since all the above recommendations leverage the chart type (inferred via the \schemaPrimary{Specification}) and \schemaPrimary{Data}, from an implementation standpoint, we pass the chart type and the data to the LLM only once in an initial context setting prompt when a chart is created.
Our choice to include the chart type as part of the context was motivated by our initial testing, during which we found that including the chart type improved the LLM's performance in terms of detecting the most relevant data patterns (e.g., trends for line charts, extremes for bar charts, correlation for scatterplots).

\vspace{.5em}
\noindent{\large\textbf{Description Statement Recommendations}}
\vspace{.5em}

\noindent{}Besides suggesting text from scratch, \pluto~also recommends adding or editing \schemaPrimary{Statements} within an existing \schemaPrimary{Description} (\textbf{DG3}).
Statement recommendations take different forms, including in-place suggestions to verify statement correctness (Figure~\ref{fig:scenario-1}A), statement addition/reordering recommendations presented to the side of an existing description (Figure~\ref{fig:interface}G), and in-place text completions (Figure~\ref{fig:teaser}B and Figure~\ref{fig:scenario-2}A).

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\textwidth]{figures/pdf/recommendations-sentence-level.pdf}
    \caption{Overview of the description statement recommendations in \pluto. The system uses a combination of the chart's specification, data, the active description, and selections on the chart to recommend changes to the description.}
    \Description[Overview of description statement recommendations in Pluto.]{To generate statement addition/reordering suggestions, the system uses a combination of a text parser and a heuristic recommendation engine that inspects the statement types (e.g., encoding, perceptual-trend) to suggest content. A LLM is used when perceptual trend statements are suggested as part of the recommendations. For statement verification recommendations, the system uses a parser to identify statement items, extract data references, and subsequently checks these against the underlying data to flag a statement as needs verification or not. Lastly, for statement completion recommendations, the system passes the context of the current chart, description, and any active selections to the LLM to have it generate the statement text.}
    \label{fig:statement-recommendations}
\end{figure*}

\textbf{Statement addition and reordering.}
These recommendations are designed to ensure the description is semantically rich and has a good narrative structure.
Figure~\ref{fig:statement-recommendations} summarizes the logic used to generate statement recommendations.
Note that because the rules used to generate these recommendations are already baked into the description generation prompt described above, the statement addition/reordering recommendations typically appear only for manually entered descriptions.

To generate the recommendations, we follow the same guidelines applied to generate a description from scratch. \pluto~first checks for the presence of an \schemaSecondary{encoding} statement and at least one \schemaSecondary{perceptual-trend}.
If these are absent or placed after other statements, the system recommends adding or reordering these statements.
For instance, consider the example in Figure~\ref{fig:statement-recommendations}A.
Detecting that the input description lacks both \schemaSecondary{encoding} and \schemaSecondary{precentual-trend} statements, \pluto~suggests adding one statement of each type.
We initially also explored suggesting adding \schemaSecondary{data-facts}.
However, the formative studies and our testing revealed that these recommendations quickly became mundane and merely listed data values from the chart, leading to us subsequently disabling them.
Drawing on prior work~\cite{tang2023vistext}, we use a template-based approach to suggest \schemaSecondary{encoding} statements and invoke the LLM to suggest \schemaSecondary{perceptual-trends}.

To avoid overwriting the existing description, the recommendations are presented next to the description area instead of being directly applied to the text (Figure~\ref{fig:interface}G) (\textbf{DG5}).
Authors can preview the updated description with the suggested changes by hovering on the recommendations.
Furthermore, because these recommendations are heuristically generated, \pluto~also provides an explanation for why a recommendation was shown.
The output in Figure~\ref{fig:statement-recommendations}A shows examples of these explanations accompanying an \schemaSecondary{encoding} statement suggestion and a \schemaSecondary{preceptual-trend} statement suggestion generated when the input description only contains \schemaSecondary{data-facts}.

\textbf{Statement verification.}
Prior research has shown that both manually-written and LLM-generated descriptions can contain erroneous mentions of data trends or values~\cite{kim2023emphasischecker,tang2023vistext}. For instance, a category stated to have the highest value in the text may not actually be the category with the highest value in the chart.
Motivated by this prior work and the experts' feedback on earlier prototypes, we check for potentially incorrect data references in the text and flag them for authors to manually verify (\textbf{DG3}).

Figure~\ref{fig:statement-recommendations}B gives an overview of how \pluto~flags statements for verification.
Specifically, the system first checks if the statement contains one or more \schemaPrimary{DataItems} (typically found in \schemaSecondary{data-fact} and \schemaSecondary{perceptual-trend} statements) and the type of takeaway the statement calls out (e.g., min/max, trend, correlation).
\pluto~then uses this extracted information to validate the mentioned items and values against the underlying \schemaPrimary{Data}, flagging the statement for review if it fails to detect a match.
An example of this is shown in Figure~\ref{fig:statement-recommendations}B, where the sentence is flagged because the system is unable to confirm if the fluctuation in values is ``significant''.
Authors can click on a flagged statement to {\small\faIcon{check}} \textit{Confirm} its correctness.

\textbf{Statement text completion.}
In addition to retrospective recommendations on the description text, \pluto~also allows users to request text completion suggestions while writing their descriptions by pressing the \key{Tab} key.
To generate these completions, the system sends the current \schemaPrimary{Description} along with any \schemaPrimary{ActiveSelections} on the chart to the LLM and prompts it to complete or suggest the last sentence.
Examples of these suggestions can be seen in Figure~\ref{fig:scenario-2}A, where the system generates a text completion based on the \schemaPrimary{Description} alone and Figures~\ref{fig:teaser}B and~\ref{fig:statement-recommendations}C, where the completion is generated based on multimodal input, including the \schemaPrimary{description} text and the \schemaPrimary{ActiveSelection} of \textit{New York} on the chart.
If the text completion recommendation is invoked with an empty description, the system follows the same rules as it does when generating descriptions from scratch and starts by suggesting an \schemaSecondary{encoding} statement followed by a \schemaSecondary{perceptual-trend} before other statements.

\vspace{.5em}
\noindent{\large\textbf{Chart Design Recommendations}}
\vspace{.5em}

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\textwidth]{figures/pdf/recommendations-chart-design.pdf}
    \caption{Summary of \pluto's process for recommending chart design changes based on the authored text. Given a chart and accompanying text, the system extracts data references from both the chart and the text, and compares the references to suggest potential design changes to make the chart more structurally aligned to the text.}
    \Description[Overview of the recommendation logic for suggesting chart design changes.]{To suggest design changes based on a given description, the system first inspects the chart to identify key data items (e.g., categories with highest values in bar charts). Comparing the data references in the input text to chart, the system suggests annotating the references in the chart, prioritizing items that have a higher salience in the chart. Additionally, the system also compares the order of the items in the text and the chart and if there is a difference, suggests sorting the chart to match the order of data references in the text.}
    \label{fig:chart-recommendations}
\end{figure*}

\noindent{}Following \textbf{DG1}, \pluto's recommendations are geared not only to improve the text but also to align the chart with the text, resulting in a better-combined reading experience.
Specifically, once a description is entered, the system generates two types of recommendations for updating the chart.

\textbf{Annotations.}
\pluto~recommends visual embellishments based on the description to help emphasize the key takeaways from the text in the chart following the approach summarized in Figure~\ref{fig:chart-recommendations}.
The recommended annotations are applied by default since they do not impact the chart's structure/layout, but authors are provided with controls to refine or remove the applied annotations (e.g., Figures~\ref{fig:interface}B and \ref{fig:scenario-1}B).

The system first extracts a list of potential \schemaPrimary{DataItems} from both the text and the chart and assigns a saliency score to these items based on saliency or ``interestingness'' metrics~\cite{demiralp2017foresight,wang2019datashot,srinivasan2018augmenting,lundgard2021accessible} (e.g., categories with extreme values in bar charts have higher saliency scores, time ranges in line charts with more variability have higher saliency than those with lower variability, targets mentioned in \schemaSecondary{perceptual-trend} statements are considered more salient than those referenced in \schemaSecondary{data-facts}).

Next, \pluto~checks for overlaps in \schemaPrimary{DataItems} extracted from the chart and the text to shortlist candidates for annotation based on a combined saliency score.
Checking for the combined saliency scores across the text and chart ensures that the emphasized items are important in both the underlying data and the author's interpretation of the chart conveyed via the text.
In cases where there are no overlaps between \schemaPrimary{DataItems} in the chart and the text, \pluto~defaults to adjusting the chart to match the author's description and adds an annotation for the most salient \schemaPrimary{DataItems} in the text.
An example of this is shown in Figure~\ref{fig:chart-recommendations} where the system highlights \textit{Home Type}$=$\textit{Single Family} since it has the highest average value (i.e., it is a salient data item in the chart) and is also explicitly called out in the description.

Besides annotating specific marks or regions on the chart, the system also adds overlay annotations based on references to aggregate values (e.g., adding a line to highlight the average value across categories in a bar chart or a regression line to emphasize the correlation between fields on a scatterplot).

\textbf{Sorting.}
During our initial testing and formative interviews, we noted that there was often a disparity in the order in which data items or marks appear on a chart and the order in which they are discussed in the text.
For example, consider the bar chart in Figure~\ref{fig:interface}C.
Although the bars are sorted alphabetically by home type, the description highlights takeaways starting with the home type having the highest value (i.e., \textit{Single Family} homes).
To enable a more aligned chart and text reading experience, \pluto~checks for such disparities and recommends sorting order changes for alignment.

Specifically, as summarized in Figure~\ref{fig:chart-recommendations}, the system extracts an ordered list of \schemaPrimary{DataItems} in the description and compares it to the items in the chart.
If the description starts by focusing on the highest or lowest category and the chart is not ordered to match that narrative, \pluto~suggests sorting the chart in a descending or ascending order, respectively.
An example of the sorting recommendation in action can be seen in Figure~\ref{fig:chart-recommendations} where applying the sort aligns the chart and text with both emphasizing \textit{Single Family} homes having the highest values and \textit{Condos} having the lowest values.

Unlike the annotation recommendations, however, sorting recommendations are presented next to a chart (Figure~\ref{fig:interface}F) and not applied by default to prevent an abrupt visual layout change by the system.
As shown in Figure~\ref{fig:chart-recommendations}, authors can preview the suggested order by hovering on the recommendation and clicking to apply that recommendation.