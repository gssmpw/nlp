\begin{algorithm}[tb]
    \caption{Algorithm to compute $g(\bbeta)$}
    \label{alg:compute_g_value_algorithm}
    \begin{flushleft}
    \textbf{Input:} vectors $\bbeta \in \R^p$ \\ %from Step 2 Line 8 in Algorithm~\ref{alg:main_algorithm}. 
    %\textbf{Output:} The value of $g(\bbeta)$
    \end{flushleft}
    \begin{algorithmic}[1]
        \STATE Initialize: $\bpsi = \boldsymbol{0} \in \mathbb{R}^k$
        \STATE Sort $\bbeta$ partially such that \\ \vspace{0.3em}\hspace*{2em}
        $\vert{\beta_1} \geq \vert{\beta_2} \geq ... \geq \vert{\beta_k} \geq \max\limits_{k+1, ..., p} \{ \vert{\beta_j} \}$
        % Let $\bs$ be the cumulative sum of the absolute values of sorted $\bbeta$.
        \STATE $s = \sum_{j=1}^p \vert{\beta_j}$
        \FOR{$j=1, 2, \dots, k$}
            \STATE $\overline{s} = s / (k - j + 1)$
            \STATE \textbf{if} $\overline{s} \geq \vert{\beta_j}$ \textbf{then} $\psi_{j:k} = \overline{s}$; break \textbf{else} $\psi_j = \vert{\beta_j}$
            \STATE $s = s - \vert{\beta_j}$
        \ENDFOR
        \STATE \textbf{return} $\sum_{j=1}^k \psi_j^2$
    \end{algorithmic}
\end{algorithm}
