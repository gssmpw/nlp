\section{Up and Down Block Algorithm for Merging in PAVA}
\label{appendix_sec:up_and_down_block_algorithm_for_merging_in_PAVA}

In this Appendix section, we provide the up and down block algorithm for merging blocks. 
Please see Algorithm~\ref{alg:up_and_down_block_algorithm_for_merging_in_PAVA} for details.
This algorithm is used by PAVA in Algorithm~\ref{alg:PAVA_algorithm} in Step 3 Line 11-14 to merge blocks until there is no isotonic violation.
This implementation makes it efficient to check and resolve isotonic violations in the PAVA algorithm.
Assuming that the input vector $\bmu$ has already been sorted so that the elements are in nonincreasing order in terms of their absolute values, the algorithm runs in linear time complexity, $O(n)$, where $n$ is the number of elements in the input vector $\bmu$.
For the proof of this linear time complexity statement, please see Appendix~\ref{appendix_lemma:PAVA_merging_linear_time_complexity}.

\input{sections/Algorithmic_Charts/up_and_down_block_algorithm_for_merging_in_PAVA.tex}
