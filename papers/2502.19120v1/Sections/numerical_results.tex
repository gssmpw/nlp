\section{Numerical examples} \label{sec:Examples}
In this section we present three numerical examples to test the method.
The first one consists of a heat equation used to illustrate the general behaviour of the reduced basis. In the second example we use the wave equation to assess the numerical properties of the method. And in the third example, we apply the method to a convection-dominated problem.

\subsection{Wave equation: Model parameters} \label{ssec:Wave}

As a first numerical example we solve the non-homogeneous wave equation
\begin{alignat}{2} \label{eq:wave}
    u_{tt} - c^2 \nabla^2 u &= b &\qquad \text{on} \; \Omega \times \setI_h \\
    u(\bm{x},t) &= u_D(\bm{x},t) = 0 &\qquad \text{on} \; \partial \Omega \times \setI_h \\
    u(\bm{x},0) &= u_0(\bm{x}) = 0 &\qquad \text{on} \; \Omega.
\end{alignat}
The domain $\Omega$ consists in a polygonal shape described by the vertices $[(0.0,0.0),(1.0,0.0),(1.0,0.3),(0.0,1.0)]$, over the time interval $\setI_h = (0,25]$. We discretize the problem using a mesh of $61204$ triangular elements and a time step $\delta t = 0.005$. As in the previous example, we define the load with its components $b_x$ and $b_t$, and the load in the frequeency domain $\widehat{b}$ as
\begin{align}
    b_x(\bm{x}) &= \exp \left(-\gamma^2 \left[(x_0-0.8)^2 + (x_1-0.15)^2 \right] \right), \\
    b_t(t) &= A \sin(\omega t) \e^{-\tau t}, \quad \widehat{b}(s) = \frac{\omega}{\omega^2 +(s+\tau)^2},
\end{align}
with $\bm{x}=[x_0,x_1]$, $\gamma=500$, $\omega=10$, $\tau=0.1$, $c=0.75$ and $A=1e4$.

The aim of this numerical example is to evaluate the behaviour of the solution for different values of $\beta$, and different sizes of the sampling set $n_s$ and the reduced basis $n_r$. As we already explore the best alternative to construct the basis in the previous example, here we choose to follow the symplectic method $\phi_{[\Re,\Im]}^{n_s}$, fixing $\alpha=1$.
In \cref{fig:wave-basisS} we show the singular value decay for $\beta = [10, 15, 25, 50]$ and sample sizes $n_s = [50, 100, 200, 500, 1000]$.

In \cref{fig:wave-contour} we show a contour plot of the solution at different time steps, here we can see the complexity of the solution and how unpredictable is its behaviour caused by the interference of the waves in the enclosed domain.

\begin{figure}[H]
	\centering
    \begin{tblr}
    {cell{1}{3} = {r=2}{},}
	\begin{subfigure}[htb!]{0.38\textwidth}
	    \centering
	    \includegraphics[width=0.9\textwidth]{figures/wave/wave-contour1.png}
        \caption{$t=23.5$} 
    \end{subfigure} &
    \begin{subfigure}[htb!]{0.38\textwidth}
	    \centering
	    \includegraphics[width=0.9\textwidth]{figures/wave/wave-contour2.png}
        \caption{$t=24.0$}
    \end{subfigure} & \includegraphics[scale=0.15]{figures/wave/wave-contour.png} \\
    \begin{subfigure}[htb!]{0.38\textwidth}
	    \centering
	    \includegraphics[width=0.9\textwidth]{figures/wave/wave-contour3.png}
        \caption{$t=24.5$} 
    \end{subfigure} &
    \begin{subfigure}[htb!]{0.38\textwidth}
	    \centering
	    \includegraphics[width=0.9\textwidth]{figures/wave/wave-contour4.png}
        \caption{$t=25.0$}
    \end{subfigure} &
    \end{tblr}
	\caption{Contour plots of the wave problem.} 
	\label{fig:wave-contour}
\end{figure}

In \cref{fig:wave-basisS}, we show the decay of the singular values $\Sigma$ for the different values of $\beta$ and $n_s$. As expected, the decay of $\Sigma$ varies with the size of the sampling set $n_s$, as we are adding more information when we increase it. It also varies significantly when we change the parameter $\beta$. This is likely caused by the fact that when we increase $\beta$ we are sampling further and further from $0$ in the line $\imath \IR$, which means that we are including higher frequencies in the sampling set that need more basis vectors to be represented adequately.
\begin{figure}[H]
	\centering
	\begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \input{figures/wave/wave-basis.pgf}
        \caption{$\beta=10$.} 
        \label{fig:wave-basis-b1} 
    \end{subfigure}
    \begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \input{figures/wave/wave-basis2.pgf}
        \caption{$\beta=15$.} 
        \label{fig:wave-basis-b2} 
    \end{subfigure} \\
    \vspace{-0.55cm}
    \begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \input{figures/wave/wave-basis3.pgf}
        \caption{$\beta=25$.} 
        \label{fig:wave-basis-b3} 
    \end{subfigure}
    \begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \input{figures/wave/wave-basis4.pgf}
        \caption{$\beta=50$.} 
        \label{fig:wave-basis-b4} 
    \end{subfigure}
    \caption{Singular values of the wave problem for multiple sample sizes $n_s$.} 
	\label{fig:wave-basisS} 
\end{figure}

To numerically evaluate the solution we define the relative $H^1(\setI,\IV)$-error as
\begin{equation} \label{eq:H1-error}
    \norm*{u_h - u_h^{\textrm{R}}}_{H^1({\setI_h,\IV_h})} = \frac{1}{n_t} \sum_{j=1}^{n_t} \left( \norm*{u_h(t_j) - u_h^{\textrm{R}}(t_j)}_{H^1({\IV_h})} \right).
\end{equation}
In \cref{fig:wave-error} we show the relative $H^1(\setI,\IV)$-error for for the time interval $\setI_h=(0,25]$, $n_t=5000$ time steps, and different values of $\beta$. \Cref{fig:wave-error-ns} displays the error convergence for sample size $n_s$, while keeping the basis size $n_r=\frac{n_s}{2}$. \Cref{fig:wave-error-nr} shows the error convergence for the reduced basis size $n_r$, fixing the sample size to $n_s=1000$.
\begin{figure}[H]
	\centering
    \begin{subfigure}[htb!]{0.49\textwidth}
     	\centering
        \input{figures/wave/wave-error-ns.pgf}
        \caption{Error convergence for $n_s$ with $n_r=\frac{n_s}{2}$ .} 
	    \label{fig:wave-error-ns}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.49\textwidth}
     	\centering
        \input{figures/wave/wave-error-nr.pgf}
        \caption{Error convergence for $n_r$ with $n_s=1000$ samples.} 
	    \label{fig:wave-error-nr}
    \end{subfigure}
    \caption{$H^1$-error of the advection-dominated problem.}
	\label{fig:wave-error}
\end{figure}

Although error decreases in all the cases we find different behavior. As we increase the value of $\beta$ we are sampling higher frequencies and consequently we need a bigger amount of samples to appropriately capture the behavior of the problem. This can be seen by comparing \cref{fig:wave-basisS,fig:wave-error}, where the the point where the singular values begins to decay matches the decrease of the error. In the other hand, when we have enough samples as in \cref{fig:wave-error-ns}, the error decay slope is similar for all the cases, still requiring a bigger basis size for a bigger $\beta$.

We compare the computational cost of the solution for $\beta=10$ and sample size $n_s=1000$. In \cref{fig:wave-time} we show the computational time of the construction of the basis, the reduced solution, and the post-process for different sizes of the basis. The finite element problem is solved in $1248$ seconds, the sampling is perform in $212$ and the construction of the basis in $144$. In this case we solve frequency problem in a parallel way using 24 cores.
\begin{figure}[H]
	\centering
    \input{figures/wave/wave-time.pgf}
    \caption{Computational cost for the wave problem.}
	\label{fig:wave-time}
\end{figure}

\subsection{Heat equation: Topology} \label{ssec:Heat}

As the second numerical example we solve a heat equation in a 2D circular domain over a time interval of $\setI=(0,200]$. The domain $\Omega$ consist in three successive rings, with seven circular inclusions in the inner and outer rings. The inclusions are distributed evenly in each ring shifted by $\pi$ with respect to each other. \Cref{fig:dif-problem} shows a schematic representation of the geometry and the physical properties of the problem. \Cref{tab:dif-data} shows the geometrical and physical parameters of the problem. We discretize the problem using a mesh of $1$ triangular elements and a time step $\delta t = 0.1$.

\begin{figure}[H]
    \centering
	\begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \input{figures/dif/dif-diagram}
	    \caption{Geometrical parameters.}
        \label{fig:dif-problem-1}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.49\textwidth}
	    \centering
	    \includegraphics[width=0.65\textwidth]{figures/dif/problem.png}
	    \caption{Physical parameters ($\mu$).}
        \label{fig:dif-problem-2}
    \end{subfigure}
    \caption{Schematic representation of the diffusion problem.}
    \label{fig:dif-problem}
\end{figure}

\begin{table}[!htb]
\centering
\caption{Geometrical and physical parameters of the diffusion problem.}
\begin{subtable}[h]{0.4\textwidth}
    \centering
    {\small
    \begin{tabular}{ccccccc}
        \toprule
        $r_w$ & $r_g^e$ & $r_g^i$ & $r_i^e$ & $r_i^i$ & $r_c^e$ & $r_c^i$  \\ \midrule  
        0.35 & 3.5 & 1.5 & 4.0 & 0.75 & 3.0 & 2.0 \\ \bottomrule
    \end{tabular}}
    \label{tab:dif-geometry}
\end{subtable}
\begin{subtable}[h]{0.3\textwidth}
    \centering
    {\small
    \begin{tabular}{ccc}
        \toprule
        $\mu_1$ & $\mu_2$ & $\mu_3$  \\ \midrule  
        0.075 & 0.5 & 27.2 \\ \bottomrule
    \end{tabular}}
    \label{tab:dif-material}
\end{subtable}
\label{tab:dif-data}
\end{table}

\pagebreak
The problem consists in solving
\begin{alignat}{2}
    \frac{\partial{u}}{\partial{t}} - \mu \Delta u &= b &\qquad \text{on} \; \Omega \times \setI \\
    u(\bm{x},t) &= 0 &\qquad \text{on} \; \Gamma \times \setI \\
    u(\bm{x},0) &= 0 &\qquad \text{on} \; \Omega. \label{eq:ht1}
\end{alignat}
We define the load using as an affine decomposition of its space and time components $b = b_x(\bm{x}) b_t(t)$. In space, we set the load as a Gaussian function located in the middle ring of the domain, and in time the load we define it as a sequence of point loads with different amplitudes. In \cref{eq:heat-load} we define the load $b$, which we illustrate in \cref{fig:dif-load}.
\begin{align}
    b_x(\bm{x}) &= \cosh \left( 25 \sqrt{2 \pi} \norm{\bm{x}} \right) \exp \left( - \frac{25 \norm{\bm{x}}^2 + 10 \pi}{2} \right)\\
    b_t(t) &= \frac{A}{\sqrt{2\cdot 10^{-4}\pi}} \exp \left( {\frac{-(t-t_0)^2}{2\cdot 10^{-4}}} \right), \label{eq:heat-load}
\end{align}
with $A = 1\cdot10^4 \cdot [1,\nicefrac{1}{2},\nicefrac{1}{4},\nicefrac{1}{8},\nicefrac{1}{16},\nicefrac{1}{32}]$, and $ t_0 = 10\cdot[0,1,2,3,4,5]$. We approximate $\mathcal{L} \{b_t\}$ as the Laplace transform of a delayed impulse $\widehat{b}(s) = \e^{-t_0s}$.

\hspace{-2mm}
\begin{figure}[H]
	\centering
	\begin{subfigure}[htb!]{0.55\textwidth}
        \centering
        \input{figures/dif/dif_load.pgf}
        \caption{$b_t$} 
        \label{fig:dif-load1}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.4\textwidth}
        \centering
        \input{figures/dif/ring.pgf}
        \caption{$b_x$} 
	   \label{fig:dif-load2}
    \end{subfigure}
	\caption{Load $b$ for the diffusion problem.} 
    \label{fig:dif-load}
\end{figure}

The goal of this example is to compare the different possibilities of constructing the basis. We fix the sample size as $n_s = 250$ and the basis size $r=35$. We also set $\alpha=1$ and $\beta=10$. We define five different approaches to construct the reduced basis
\begin{itemize}
    \item Using $n_s$ real-valued samples $\bm{\mathsf{S}} = [\Re \{\widehat{u}_1 \}, \ldots, \Re \{\widehat{u}_{n_s} \}]$. We denote this basis as $\phi_\IR^{n_s}$.
    \item Using $2n_s$ real-valued samples $\bm{\mathsf{S}} = [\Re \{\widehat{u}_1 \}, \ldots, \Re \{\widehat{u}_{4n_s} \}]$. We denote this basis as $\phi_\IR^{4n_s}$.
    \item Using $n_s$ complex-valued samples $\widehat{\bm{\mathsf{S}}} = [\widehat{u}_1, \ldots, \widehat{u}_{n_s}]$, and using the real part of the obtained complex basis $\Re \{ \Phi \}$. We denote this basis as $\phi_{\Re\IC}^{n_s}$.
    \item Using $n_s$ complex-valued samples $\widehat{\bm{\mathsf{S}}} = [\widehat{u}_1, \ldots, \widehat{u}_{n_s}]$, and using the complex-valued basis $\Phi$. Note that when using this basis \cref{pr:dpr} is complex-valued. We denote this basis as $\phi_\IC^{n_s}$.
    \item Using $n_s$ complex-valued samples arranged in a real-valued set composed by the real part and imaginary part of the frequency solution as $\bm{\mathsf{S}}^S = [\Re \{\widehat{u}_1 \}, \ldots, \Re \{\widehat{u}_{n_s}\}, \Im \{\widehat{u}_1 \}, \ldots, \Im \{\widehat{u}_{n_s}\}]$. We denote this basis as $\phi_{S}^{n_s}$.
\end{itemize}

Qualitatively, all the solutions show a similar behavior with all of them approximating adequately the solution. In \cref{fig:dif-contour} we show a contour plot of the solution at $t=25$. In \cref{fig:dif-basisS} we show the singular values for all the basis. We note that the decay is exactly the same for $\phi_{S}^{n_s}$ and $\phi_\IC^{n_s}$, making a case for our claim in \cref{ssec:complexified-basis}: we can construct a real-valued reduced basis that matches the complex basis.
\begin{figure}[H]
\RawFloats
\begin{minipage}[t]{.57\textwidth}
	\input{figures/dif/basis.pgf}
	\caption{Singular values of the diffusion problem.} 
	\label{fig:dif-basisS}
\end{minipage}\hfill%
\begin{minipage}[t]{.4\textwidth}
    \includegraphics[width=\textwidth]{figures/dif/contour.png}
 	\caption{Contour plot of the diffusion problem.} 
	\label{fig:dif-contour}
\end{minipage}
\end{figure}

To compare in a more precise way the results we define the  relative $H^1(\IV)$-error as
\begin{equation} \label{eq:H1-error}
    \textrm{error}_{H^1({\IV_h})}(u_h^{\textrm{R}}) = \frac{\norm*{\nabla u_h - \nabla u_h^{\textrm{R}}}_{H^1({\IV_h})}}{\norm*{\nabla u_h}_{H^1({\IV_h})}}.
\end{equation}
In \cref{fig:dif-error} we show the evolution of the $H^1$-error for reduced solutions using the five different reduced bases. Interestingly, solving the complex-valued problem with $\phi_\IC^{n_s}$, yields the same result as using the real bases $\phi_{\Re\IC}^{n_s}$ and $\phi_{S}^{n_s}$, with $\phi_\IR^{n_s}$ having the worst approximation. We argue that this behaviour is explained by the equivalence hinted in \cref{ssec:complexified-basis}, between the reduced $\mathcal{J}$-adapted basis of $\IV_h^\IC$ and the symplectic reduced basis. Likewise, the behaviour of the real-valued basis $\phi_{\IR}^{2n_s}$ can be explained as a consequence of it being built over a sample set of the same size as for the symplectic and complex basis, but with sub-optimal sample points.
\begin{figure}[H]
	\centering
    \begin{subfigure}[htb!]{0.49\textwidth}
     	\centering
        \input{figures/dif/dif-error.pgf}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.49\textwidth}
        \centering
        \input{figures/dif/dif-error2.pgf}
    \end{subfigure}
    \caption{$H^1$-error of the diffusion problem.}
	\label{fig:dif-error}
\end{figure}

In \cref{tab:dif-time} we show the computational time for the offline and online parts of the solution including the computation of the reduced basis. The computational cost of the time-dependent finite element solution is $730.8104$ and the cost of recovering the full solution from the reduced one ($\Phi \bm{\mathsf{u}}_j^{\textrm{R}}$) for all the time steps is $58.19$.
\begin{table}[!htb]
    \centering
    \caption{Computational cost of the diffusion problem solutions.}
    {\small
    \begin{tabular}{cccccc}
        \toprule
        & $\phi_{\IR}^{n_s}$ & $\phi_{\IR}^{4n_s}$ & $\phi_{\Re\IC}^{n_s}$ & $\phi_{\IC}^{n_s}$ & $\phi_{S}^{n_s}$ \\ \midrule  
        Freq & 254.9132 & 939.8105 & 254.9132 & 254.9132 & 254.9132 \\
        Basis & 26.6827 & 84.8049 & 129.7753 & 129.7753 & 44.8887 \\
        ROM & 0.4870 & 0.5020 & 0.7815 & 0.5639 & 0.4946 \\
        \bottomrule
    \end{tabular}}
\label{tab:dif-time}
\end{table}

Since we want to obtain the best approximation possible with the method while maintaining low cost, it is clear that using the symplectic construction of the reduced basis ($\phi_{S}^{n_s}$) gives the best results.
The better performance (in computational time) of this approach is due to reducing the amount of computations done as a complex-valued problem, which noticeable increase the computational cost of the other approaches.
Note that the real computational time of the frequency-domain problem can be greatly reduced as the solutions are fully independent and can be solve in parallel.



\subsection{Advection-dominated problem} \label{ssec:CDR}

In the last example we showcase some stabilization properties of the method. We solve the advection-diffusion-reaction problem
\begin{alignat}{2} \label{eq:advection}
    \frac{\partial{u}}{\partial{t}} + a \cdot \nabla u - \mu \Delta u + \kappa u &= b &\qquad \text{on} \; \Omega \times (0,t_{\textnormal{f}}] \\
    u(\bm{x},t) &= 0 &\qquad \text{on} \; \Gamma_D \times (0,t_{\textnormal{f}}] \\
    u(\bm{x},0) &= u_0(\bm{x};\mu) &\qquad \text{on} \; \Omega
\end{alignat}
with the $\mu=0.001$, $\kappa=0.1$, and the advection velocity $a=1-\abs{x_1}$. The domain $\Omega$ consists in a unit square with the boundary $\Gamma_D$ set over the edges parallel to the x-axis. The load and its Laplace transform are define as
\begin{align}
    b_x(\bm{x}) &= \exp \left(-\gamma^2 \left[(x_0-0.5)^2 + (x_1-0.5)^2 \right] \right), \\
    b_t(t) &= A t\e^{-t}\sin(\omega t), \quad \widehat{b}(s) = \frac{2\omega (s+1)}{((s+1)^2+\omega^2)^2}
\end{align}
with $A=-100$, $\omega=10\pi$, and $\gamma=25$. For the frequency domain problem we set $\alpha=1$ and $\beta=10$, and we construct the basis using $120$ samples and solve the reduced problem with $n_r=30$ basis vectors. \Cref{fig:adv-load} illustrates the load $b$ and in \cref{fig:adv-basisS} we show the singular values of the reduced basis. 
\begin{figure}[H]
\RawFloats
\begin{minipage}[t]{.49\textwidth}
	\input{figures/adv/adv-load.pgf}
	\caption{Load $b_t$ for the advection-dominated problem.} 
	\label{fig:adv-load}
\end{minipage}\hfill%
\begin{minipage}[t]{.49\textwidth}
	\input{figures/adv/adv-basis.pgf}
	\caption{Singular values of the advection-dominated problem.} 
	\label{fig:adv-basisS}
\end{minipage}
\end{figure}

In \cref{fig:adv-comparison} we compare the solutions of the finite element problem and the reduced problem at $t=0.33$. Here we can see how the instabilities have taken over the finite element solution while the reduced solution remains stable and matches the `stable part' of the high fidelity solution.

Although this property of the basis needs more analysis, we infer that the added stability is caused by filtering out the higher frequencies in both the sampling method and the \gls{svd}.
\begin{figure}[H]
	\centering
	\begin{subfigure}[htb!]{0.44\textwidth}
	    \centering
	    \includegraphics[width=\textwidth]{figures/adv/adv-fe.png}
	    \caption{Finite element solution}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.44\textwidth}
	    \centering
	    \includegraphics[width=\textwidth]{figures/adv/adv-rom.png}
	    \caption{ROM solution}
    \end{subfigure}
    \begin{subfigure}[htb!]{0.1\textwidth}
	    \centering
	    \includegraphics[scale=0.085]{figures/adv/adv-label.png}
    \end{subfigure}
	\caption{Comparison of solutions for the advection-dominated problem at $t=0.33$} 
	\label{fig:adv-comparison}
\end{figure}
