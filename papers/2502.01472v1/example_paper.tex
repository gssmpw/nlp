%%%%%%%% ICML 2025 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables

% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2025} with \usepackage[nohyperref]{icml2025} above.
\usepackage{hyperref}


% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

% Use the following line for the initial blind version submitted for review:
% \usepackage{icml2025}

% If accepted, instead use the following line for the camera-ready submission:
\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{longtable}
\usepackage{booktabs}
\newcommand{\gl}[1]{{\color{blue}(guangliang: {#1})}} % guangliang's comments
\newcommand{\zl}[2]{{\color{green}(zhenglin: {#2})}} % zhenglin's comments
% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\newcommand{\xiaowei}[1]{{\color{blue}XH:#1}}

% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}
\usepackage[textsize=tiny]{todonotes}
\usepackage{subcaption} 
\usepackage{multirow}
\usepackage{arydshln} 



% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\icmltitlerunning{FALCON: Fine-grained Activation Manipulation by Contrastive Orthogonal Unalignment for Large Language Model}

\begin{document}

\twocolumn[
\icmltitle{FALCON: Fine-grained Activation Manipulation by Contrastive Orthogonal Unalignment for Large Language Model}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2025
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.
\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Jinwei Hu}{liv}
\icmlauthor{Zhenglin Huang}{liv}
\icmlauthor{Xiangyu Yin}{liv}
\icmlauthor{Wenjie Ruan}{liv}
\icmlauthor{Guangliang Cheng}{liv}
\icmlauthor{Yi Dong}{liv}
\icmlauthor{Xiaowei Huang}{liv}
%\icmlauthor{}{sch}
% \icmlauthor{Firstname8 Lastname8}{sch}
% \icmlauthor{Firstname8 Lastname8}{yyy,comp}
%\icmlauthor{}{sch}
%\icmlauthor{}{sch}
\end{icmlauthorlist}

\icmlaffiliation{liv}{Department of Computer Science, University of Liverpool, Liverpool, UK}
% \icmlaffiliation{comp}{Company Name, Location, Country}
% \icmlaffiliation{sch}{School of ZZZ, Institute of WWW, Location, Country}

\icmlcorrespondingauthor{Xiaowei Huang}{xiaowei.huang@liverpool.ac.uk}
% \icmlcorrespondingauthor{Firstname2 Lastname2}{first2.last2@www.uk}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
% \printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.

\begin{abstract}
Large language models have been widely applied, but can inadvertently encode sensitive or harmful information, raising significant safety concerns. Machine unlearning has emerged to alleviate this concern; however, existing training-time unlearning approaches, relying on coarse-grained loss combinations, have limitations in precisely separating knowledge and balancing removal effectiveness with model utility.  In contrast, we propose \textbf{F}ine-grained \textbf{A}ctivation manipu\textbf{L}ation by \textbf{C}ontrastive \textbf{O}rthogonal u\textbf{N}alignment (FALCON), a novel representation-guided unlearning approach that leverages information-theoretic guidance for efficient parameter selection, employs contrastive mechanisms to enhance representation separation, and projects conflict gradients onto orthogonal subspaces to resolve conflicts between forgetting and retention objectives. Extensive experiments demonstrate that FALCON achieves superior unlearning effectiveness while maintaining model utility, exhibiting robust resistance against knowledge recovery attempts.


% across multiple LLM architectures demonstrate FALCON's superior unlearning effectiveness while maintaining model utility. Our method exhibits enhanced computational efficiency and robust resistance against jailbreaking attempts. The information-theoretic guidance enables interpretable knowledge manipulation by reducing the optimization search space, providing systematic insights into the LLM unlearning process.
\end{abstract}

\section{Introduction}
Recent advancements in generative AI \cite{achiam2023gpt,team2023gemini,dubey2024llama}, fueled by innovations in training techniques such as Parameter-Efficient Fine-Tuning (PEFT), have enabled large language models (LLMs) to efficiently internalize linguistic knowledge and excel in tasks from text generation to decision making \cite{hu2022lora,liu2024dora}. These models derive their power from massive, diverse corpora, but this dependency on large-scale datasets introduces significant risks: harmful, biased, or sensitive information can be inadvertently encoded and amplified, leading to ethical violations, regulatory noncompliance, and potential misuse \cite{hsu2024safe,urman2023silence,jiao2024navigating}. 

Existing mitigation strategies, such as implementing guardrails \cite{dong2024position} or training models with expertly curated datasets to refuse harmful queries \cite{NEURIPS2022_b1efde53}, are computationally expensive and often inadequate against adversarial attacks \cite{xu2024an,yin2024vqattack}. In contrast, while retraining an entire model on a cleaned dataset to eliminate harmful influences is theoretically feasible, it is prohibitively resource-intensive for modern LLMs \cite{10431584}. Additionally, adversaries can exploit PEFT to reintroduce such unwanted information, highlighting the urgent need for more effective and scalable solutions for publicly accessed LLMs \cite{qi2024finetuning}. 

To solve harmful or sensitive information in machine learning models, Machine Unlearning (MU) has emerged as a promising solution, supported by growing regulations such as the ``right to be forgotten" under the GDPR \cite{regulation2016regulation,ginart2019making}. It originally developed in the non-LLMs domain and has proven effective at removing specific data influences while preserving model performance \cite{bourtoule2021machine,Kim_2022_CVPR,liu2023muter}. When transferred to maintain responsible LLMs, MU offers significant advantages, being far more computationally efficient than full retraining. Unlearned models also exhibit greater inherent safety, as they lack the undesired knowledge necessary for malicious behaviors \cite{hendrycks2021unsolved,li2024the}. 

Despite its potential, LLM unlearning still faces several fundamental issues: (1) existing approaches typically rely on empirical methods like grid search to identify intervention parameters, lacking an efficient and interpretable way to guide parameter selection within deep architectures, (2) current methods normally rely on \textit{coarse-grained} manipulation (using simplistic loss combinations that induce random representation dispersion with uncontrolled gradient dynamics, struggling to balance knowledge removal and utility preservation) rather than \textit{fine-grained} representation manipulation (achieving more effective knowledge separation through targeted representation modification and regulated gradient dynamics for reducing damage to model utility), and (3) knowledge recovery methods like jailbreaking attack can recover the undesired information from the unlearned model \cite{10750906}.

% To address the challenges of selective knowledge unlearning in LLMs, we propose \textbf{Contrastive Orthogonal Unalignment (FALCON)}, a representation-guided adaptation framework designed for precise and permanent removal of knowledge while maintaining critical retention. FALCON integrates contrastive representation loss, gradient projection, and information-theoretic metrics to effectively balance knowledge removal and retention. Leveraging entropy and mutual information (MI), FALCON evaluates the dependency between forget and retain data, guiding layer selection and enhancing interpretability by uncovering the impact of unlearning on representations across layers. Importantly, FALCON does not require full access to the original full training data, making it practical for scenarios where such access is limited. \textcolor{red}{For multi-domain knowledge unlearning, FALCON leverages a contrastive mechanism where principal offset matrices derived from singular value decomposition (SVD) act as positive samples, while frozen activations serve as negative samples, enabling targeted knowledge unlearning through precise representation unalignment.} To ensure retention, a contrastive loss aligns activations between the updated and frozen models, preserving critical information and maintaining model utility. FALCON incorporates a second-order optimizer with approximate curvature information for faster convergence and employs gradient projection to resolve optimization conflicts, ensuring scalability and robust generalization across diverse knowledge domains. Our contributions are as follows:
To address the aforementioned issues of selective knowledge unlearning in LLMs, we propose \textbf{Fine-grained Activation manipuLation by Contrastive Orthogonal uNalignment (FALCON)}, a representation-guided framework designed for precise knowledge removal while maintaining critical retention. FALCON leverages mutual information (MI) to evaluate dependencies between forget and retain data, enabling interpretable parameter selection and optimization guidance. For multi-domain knowledge unlearning, FALCON achieves fine-grained representation unalignment through two mechanisms: directional contrastive unalignment with singular value decomposition (SVD)-derived principal offset vectors and gradient orthogonal projection for precise control of knowledge separation granularity. Furthermore, our framework does not require full access to training data, making it practical for scenarios where such access is limited. FALCON further employs a second-order optimizer with approximate curvature information and can achieve efficient unlearning through single-layer parameter modification, ensuring both computational efficiency and scalability across diverse knowledge domains. Our contributions are as follows:
\begin{itemize}
    \setlength{\itemsep}{1pt}
    \setlength{\parskip}{1pt}
    \item We propose \textbf{FALCON}, a representation-guided framework that combines contrastive mechanisms and gradient projection to achieve \textit{fine-grained representation unalignment} in LLMs.
    \item We introduce \textbf{information-theoretic metrics} for quantifying knowledge entanglement, enabling principled parameter selection and providing theoretical insights into knowledge distribution across model architectures.
    \item We demonstrate the \textbf{scalability}, \textbf{effectiveness}, and \textbf{resistance to knowledge recovery} of FALCON through extensive experiments, highlighting its ability to unlearn selective knowledge while preserving utility across various LLMs.
\end{itemize}

\section{Related work}
Our paper focuses on LLM unlearning for undesired knowledge, information-theoretic metrics, and contrastive learning. We highlight the developments and limitations of LLM unlearning in this section, while related advancements in information-theoretic metrics, contrastive learning, and gradient projection are detailed in the Appendix \ref{Information-Theoretic Metrics} and \ref{Contrastive Learning}.
\paragraph{LLM Unlearning}
LLM unlearning refers to the selective removal of specific knowledge from large language models while preserving their overall functionality \cite{zhang2024right}. Current approaches can be broadly categorized into training-time methods and inference-time methods \cite{barez2025openproblemsmachineunlearning}. Among training-time approaches, which represent the mainstream methodology, two primary directions have emerged. The first direction focuses on gradient optimization, maximizing the loss function to suppress harmful knowledge through techniques such as gradient ascent \cite{yao2023large,jang-etal-2023-knowledge} and reverse gradients \cite{eldan2023s}. The second direction emphasizes representation-guided adaptation, targeting specific intermediate hidden representations for modification \cite{li2024the}. While these aforementioned training-time methods achieve permanent unlearning by targeting specific layers and parameters, they currently rely heavily on coarse-grained loss combinations that struggle to disentangle deeply embedded knowledge representations flexibly.

Inference-time methods offer alternative approaches through task vectors and model editing. Task vector approaches address efficiency concerns through arithmetic operations on parameter-efficient modules, enabling lightweight unlearning under resource constraints \cite{ilharco2023editing,zhang2023composing}. Model editing usually modifies intermediate hidden states or logits to alter model behavior \cite{barez2025openproblemsmachineunlearning}, such as contrastive decoding methods that suppress undesired content generation \cite{zhong2024rose}. However, these methods' dependence on modular arithmetic operations fundamentally limits their granularity in knowledge separation and constrains generalizability across diverse scenarios. Additionally, in-context unlearning has emerged as another inference-time approach, leveraging tailored prompts to dynamically suppress undesired outputs \cite{zheng2023can,pawelczyk2024incontext}. While flexible, this method's effect remains inherently temporary as the undesired knowledge persists in the model's representation space \cite{liu2024rethinking}.

Despite these advancements, existing training-time methods fall short in achieving precise knowledge disentanglement between information to be forgotten and retained. To address these limitations, we propose FALCON, a targeted representation unalignment approach that achieves more precise separation through contrastive learning, gradient projection, and information-theoretic guidance. Through its contrastive mechanism and gradient projection, our approach enables fine-grained knowledge separation and resolves optimization conflicts between forgetting and retention objectives, while enhanced resistance compared to current state-of-the-art training-time methods.
% Despite these advancements, existing methods fall short in achieving more precise knowledge disentanglement, particularly in establishing fine-grained separation between knowledge to be forgotten and retained. To address these limitations, we propose FALCON, a novel \textit{targeted representation unalignemnt} approach that transcends conventional loss combinations to achieve precise representation separation through the synergistic integration of contrastive learning, gradient projection, and information-theoretic guidance. The contrastive mechanism enables fine-grained knowledge separation, while gradient projection resolves optimization conflicts between forgetting and retention objectives, together enabling more effective and granular knowledge manipulation while preserving essential model functionality.



% LLM unlearning refers to the selective removal of specific knowledge from large language models while preserving their overall functionality \cite{zhang2024right}. Among existing approaches, parameter optimization is the mainstream method, directly adjusting model parameters to suppress harmful knowledge through techniques such as gradient ascent \cite{yao2023large,jang-etal-2023-knowledge} and reverse gradients \cite{eldan2023s}. \textcolor{red}{While these methods achieve permanent unlearning by targeting specific layers and parameters, they rely heavily on coarse-grained loss combinations that struggle to disentangle deeply embedded knowledge representations.} Parameter merging approaches address efficiency concerns through arithmetic operations on parameter-efficient modules, enabling lightweight unlearning under resource constraints \cite{ilharco2023editing,zhang2023composing}. However, their dependence on modular arithmetic operations fundamentally limits their granularity in knowledge separation and constrains generalizability across diverse scenarios. In-context unlearning provides an alternative by leveraging tailored prompts to dynamically suppress undesired outputs \cite{zheng2023can,pawelczyk2024incontext}, but its effect remains inherently temporary as the undesired knowledge persists in the model's representation space \cite{liu2024rethinking}. \textcolor{red}{Despite these advancements, existing methods fall short in achieving more precise knowledge disentanglement, particularly in establishing fine-grained separation between knowledge to be forgotten and retained. To address these limitations, we propose FALCON, a novel parameter optimization approach that transcends conventional loss combinations to achieve precise representation separation through the synergistic integration of contrastive learning, gradient projection, and information-theoretic guidance. The contrastive mechanism enables fine-grained knowledge separation, while gradient projection resolves optimization conflicts between forgetting and retention objectives, together enabling more effective and granular knowledge manipulation while preserving essential model functionality.}
\section{Problem Formulation}
\subsection{Problem Setup}
\begin{figure*}[h]
    \centering
    \includegraphics[width=\textwidth]{Figure/Contrastive_Unlearning.pdf} 
    \caption{Schematic representation of the proposed FALCON method. The pipeline involves parameter selection based on mutual information, the construction of principal offset vectors, the application of contrastive mechanism on both datasets, and gradient conflict resolution to balance forgetting and retaining objectives.}
    \label{fig:contrastive_unlearning}
\end{figure*}
The task of LLM unlearning involves selectively removing specific knowledge (\textit{forget set}) from the model while retaining critical information (\textit{retain set}). However, this process is complicated by the issue of \textit{knowledge entanglement}, where representations of the forget and retain sets overlap significantly within the model's parameters \cite{zhang2024comprehensive}. This entanglement arises due to the distributed nature of knowledge across multiple layers and features, making it difficult to isolate knowledge for removal without affecting retained information.

To formalize the unlearning process, we adopt the general formulation proposed by Liu et al.~\cite{liu2024rethinking}:
\begin{align}
\label{eq:llm_unlearning}
\min_{\theta} \left\{
\mathbb{E}_{(x,y_f) \in \mathcal{D}_\mathcal{F}} \left[ \mathcal{L}(y_f | x; \theta) \right] + 
\lambda \mathbb{E}_{(x,y) \in \mathcal{D}_\mathcal{R}} \left[ \mathcal{L}(y | x; \theta) \right]
\right\}
\end{align}
where \( \mathcal{L}(y | x; \theta) \) measures the discrepancy between the model's prediction and the target response \( y \) for a given input \( x \) under the model's parameters \( \theta \). Here, \( \mathcal{D}_\mathcal{F} \) and \( \mathcal{D}_\mathcal{R} \) denote the forget set and retain set, respectively. The variable \( y_f \) specifies the intended output for the forget set after unlearning, while the hyperparameter \( \lambda \geq 0 \) controls the trade-off between forgetting and retention objectives. For simplicity, we will refer to this objective as \( \min_{\theta} \mathbb{E}_{\text{MU}}(\theta) \) in subsequent sections.

Despite the generality of above formulation, it does not explicitly quantify the representations of forgotten and retained knowledge. This lack of quantification poses challenges in precisely guiding the unlearning process \cite{qu2024frontier}. To address this, a principled metric is needed to evaluate and minimize knowledge entanglement, ensuring that unlearning primarily affects the forget set while minimizing interference with the retain set.

% We adopt the general formulation of the LLM unlearning problem proposed by Liu et al.~\cite{liu2024rethinking}, which can be expressed as:
% \begin{align}
% \label{eq:llm_unlearning}
% \min_{\theta} \mathbb{E}_{(x,y_f) \in \mathcal{D}_\mathcal{F}} \left[ \mathcal{L}(y_f | x; \theta) \right] + \lambda \mathbb{E}_{(x,y) \in \mathcal{D}_\mathcal{R}} \left[ \mathcal{L}(y | x; \theta) \right]
% \end{align}
% where \( \mathcal{L}(y | x; \theta) \) denotes the loss function that measures the discrepancy between the model's prediction and the target response \( y \) for a given input \( x \) under model's parameters \( \theta \). The datasets \( \mathcal{D}_\mathcal{F} \) and \( \mathcal{D}_\mathcal{R} \) correspond to the \textit{forget set} and \textit{retain set}, respectively. The variable \( y_f \) specifies the intended output for the forget set following the unlearning process, while \( \lambda \geq 0 \) serves as a hyperparameter to control the trade-off between the forgetting and retention objectives. 

% % \xiaowei{this formulation looks like for a given x there are two outputs. Is this intended? }

% Despite the generality of the above formulation, the representations of forgotten knowledge and retained knowledge in the model remain \textit{unquantified}, making it difficult to precisely guide the unlearning process \cite{qu2024frontier}. Due to the inherent characteristics of LLMs, where knowledge is distributed across multiple layers and features, the issue of \textit{knowledge entanglement} arises \cite{zhang2024comprehensive}. \xiaowei{need one sentence to explain knowledge entanglement.} This phenomenon leads to a significant overlap between the representations of the forget set \( \mathcal{D}_\mathcal{F} \) and the retain set \( \mathcal{D}_\mathcal{R} \), making it challenging to balance forgetting and retention during optimization. \xiaowei{I would move this to the beginning of this section, cos it somewhat explains Equation 1.}
% \xiaowei{this makes the approach looks uninteresting. Let's see if there is a better way to promote your method. }
To address this, we introduce \textit{information-theoretic measures}, specifically continuous entropy and mutual information, to quantify the dependency between the activations of the forget and retain sets. Let \( \mathcal{F} \) and \( \mathcal{R} \) represent the activations of the forget and retain sets at a specific layer of the model, respectively. The degree of knowledge entanglement between representations can be formulated as the \textit{mutual information} \( I(\mathcal{F}; \mathcal{R}) \):
\begin{equation}
I(\mathcal{F}; \mathcal{R}) = H(\mathcal{F}) + H(\mathcal{R}) - H(\mathcal{F}, \mathcal{R})
\end{equation}
where \( H(\mathcal{F}) \) and \( H(\mathcal{R}) \) are the continuous entropies of the activations \( \mathcal{F} \) and \( \mathcal{R} \), and \( H(\mathcal{F}, \mathcal{R}) \) denotes their joint entropy. These measures provide a systematic approach to identify layers with minimal entanglement and guiding the optimization process for targeted and effective unlearning. The details of these metrics are shown in Appendix \ref{preliminary}. 

\subsection{LLM unlearning with MI Guidance}
To quantify knowledge entanglement during machine unlearning, we use MI to measure the dependency between the activations of the forget set \( \mathcal{F}^{(l)} \) and the retain set \( \mathcal{R}^{(l)} \) at each layer \( l \). The MI \( I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)}) \) serves as an indicator to guide the unlearning process by minimizing entanglement between \( \mathcal{F}^{(l)} \) and \( \mathcal{R}^{(l)} \).


% \begin{equation} \label{eq:MI_layer}
% I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)}) = H(\mathcal{F}^{(l)}) + H(\mathcal{R}^{(l)}) - H(\mathcal{F}^{(l)}, \mathcal{R}^{(l)})
% \end{equation}
% \xiaowei{these are too basic ... }

To minimize the entanglement between the forget and retain sets' representations, we formulate the layer selection as:
\begin{equation} \label{eq:layer_selection}
l^* = \arg \min_l I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)})
\end{equation}
Given the selected layer \( l^* \), the LLM unlearning problem guided by MI can be reformulated as:
\begin{equation} \label{eq:MI_guided_unlearning}
\min_{\theta} \mathbb{E}_{\text{MU}}(\theta) \quad \text{subject to} \quad \text{Eqs.}~\eqref{eq:layer_selection}
\end{equation}
This formulation ensures that the unlearning process is conducted on the parameters with minimal knowledge entanglement, effectively suppressing the undesired knowledge while reducing interference with the retained knowledge.

% \subsection{Problem Setup}
% We adopt the general formulation of the LLM unlearning problem proposed by Liu et al.~\cite{liu2024rethinking}, which can be expressed as:
% \begin{equation}
% \label{eq:llm_unlearning}
% \min_{\theta} \mathbb{E}_{(x,y_f) \in \mathcal{D}_\mathcal{F}} \left[ \mathcal{L}(y_f | x; \theta) \right] + \lambda \mathbb{E}_{(x,y_r) \in \mathcal{D}_\mathcal{R}} \left[ \mathcal{L}(y | x; \theta) \right]
% \end{equation}
% where \( \mathcal{L}(y | x; \theta) \) denotes the loss function that measures the discrepancy between the model's prediction and the target response \( y \) for a given input \( x \) under model's parameters \( \theta \). The datasets \( \mathcal{D}_\mathcal{F} \) and \( \mathcal{D}_\mathcal{R} \) correspond to the \textit{forget set} and \textit{retain set}, respectively. The variable \( y_f \) specifies the intended output for the forget set following the unlearning process, while \( \lambda \geq 0 \) serves as a hyperparameter to control the trade-off between the forgetting and retention objectives.

% Despite the generality of the above formulation, the representations of forgotten knowledge and retained knowledge in the model remain \textit{unquantified}, making it difficult to precisely guide the unlearning process \cite{qu2024frontier}. Due to the inherent characteristics of LLMs, where knowledge is distributed across multiple layers and features, the issue of \textit{knowledge entanglement} arises \cite{zhang2024comprehensive}. This phenomenon leads to a significant overlap between the representations of the forget set \( \mathcal{D}_\mathcal{F} \) and the retain set \( \mathcal{D}_\mathcal{R} \), making it challenging to balance forgetting and retention during optimization.

% \subsection{Mutual Information}
% To address this, we propose to quantify the dependency between the representations of \( \mathcal{D}_\mathcal{F} \) and \( \mathcal{D}_\mathcal{R} \) using \textit{information-theoretic measures} before the unlearning process, specifically entropy and mutual information. Let \( \mathcal{F} \) and \( \mathcal{R} \) represent the activations of the forget and retain sets at a specific layer of the model, respectively. The degree of \textit{knowledge entanglement} can be formulated as the \textit{mutual information} \( I(\mathcal{F}; \mathcal{R}) \):
% \begin{equation}
% I(\mathcal{F}; \mathcal{R}) = H(\mathcal{F}) + H(\mathcal{R}) - H(\mathcal{F}, \mathcal{R})
% \end{equation}
% where \( H(\mathcal{F}) \) and \( H(\mathcal{R}) \) are the entropies of the activations \( \mathcal{F} \) and \( \mathcal{R} \), and \( H(\mathcal{F}, \mathcal{R}) \) denotes their joint entropy. A higher \( I(\mathcal{F}; \mathcal{R}) \) indicates greater overlap between the representations, while a lower \( I(\mathcal{F}; \mathcal{R}) \) suggests that the two representations are more independent.
% \subsubsection{Continuous Entropy}
% The concept of \textit{entropy} in the continuous setting, often referred to as \textit{differential entropy}, measures the uncertainty of a continuous random variable \cite{garbaczewski2006differential,yeung2008differential}. For a random variable \( \mathcal{F} \) with probability density function \( p(\mathcal{F}) \), the entropy \( H(\mathcal{F}) \) is defined as:
% \begin{equation} \label{Continuous Entropy} 
% H(\mathcal{F}) = - \int p(\mathcal{F}) \log p(\mathcal{F}) d\mathcal{F}
% \end{equation}
% where \( p(\mathcal{F}) \) is the probability density of the activations \( \mathcal{F} \) over its support. Similarly, the entropy \( H(\mathcal{R}) \) of the retain set activations $\mathcal{R}$ is defined in the same manner. 
% \subsubsection{Joint Entropy}
% To quantify the combined uncertainty of the activations \( \mathcal{F} \) and \( \mathcal{R} \), the \textit{joint entropy} \( H(\mathcal{F}, \mathcal{R}) \) is introduced, which is defined as:
% \begin{equation} \label{Joint Entropy} 
% H(\mathcal{F}, \mathcal{R}) = - \int \int p(\mathcal{F}, \mathcal{R}) \log p(\mathcal{F}, \mathcal{R}) \, d\mathcal{F} \, d\mathcal{R}
% \end{equation}
% where \( p(\mathcal{F}, \mathcal{R}) \) represents the joint probability density function of the activations \( \mathcal{F} \) and \( \mathcal{R} \) in continuous space. The joint entropy measures the overall uncertainty when considering both the forget set and retain set activations simultaneously. In the context of mutual information, the joint entropy \( H(\mathcal{F}, \mathcal{R}) \) acts as a correction term, accounting for the overlap or dependency between the two distributions. 

% \subsection{Problem Formulation: LLM unlearning with Mutual Information Guidance}



% To address the challenges of knowledge entanglement during the machine unlearning process, we propose an information-theoretic approach to identify the optimal layer for unlearning. By leveraging MI as a principled measure, we quantify the dependency between the activations of the forget set \( \mathcal{F} \) and the retain set \( \mathcal{R} \) at each layer. Specifically, the mutual information \( I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)}) \) at layer \( l \) is defined as:
% \begin{equation} \label{eq:MI_layer}
% I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)}) = H(\mathcal{F}^{(l)}) + H(\mathcal{R}^{(l)}) - H(\mathcal{F}^{(l)}, \mathcal{R}^{(l)})
% \end{equation}
% where \( H(\cdot) \) represents the continuous entropy of the activations. To minimize the entanglement between the forget and retain sets' representations, we formulate the layer selection as:
% \begin{equation} \label{eq:layer_selection}
% l^* = \arg \min_l I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)})
% \end{equation}

% Given the selected layer \( l^* \), the LLM unlearning problem guided by MI can be reformulated as:
% \begin{equation} \label{eq:MI_guided_unlearning}
% \min_{\theta} \mathcal{L}_{\text{MU}}(\theta) \quad \text{subject to} \quad \text{Eqs.}~\eqref{eq:layer_selection}
% \end{equation}
% where \( \mathcal{L}_{\text{MU}} \) denotes the general LLM unlearning objective as defined in Eq.~\eqref{eq:llm_unlearning}. This formulation ensures that the unlearning process is conducted on the layer with minimal knowledge entanglement, effectively suppressing the undesired knowledge while minimizing interference with the retained knowledge.
\section{Methodology}
% To address the challenges of selective multi-domain knowledge unlearning in LLMs, we propose Contrastive Orthogonal Unalignment, a framework that employs mutual information to disentangle forget and retain knowledge representations while minimizing interference. FALCON combines contrastive learning for representation separation, gradient projection for conflict resolution, and a second-order optimizer leveraging Hessian approximation for precise and efficient updates. This framework enables precise knowledge removal while preserving model functionality. This section details the core components of our framework.
% To address the challenges of selective multi-domain knowledge unlearning in LLMs, we propose Contrastive Orthogonal Unalignment shown in Figrue.~\ref{fig:contrastive_unlearning}, a theoretically-grounded framework for selective knowledge unlearning in LLMs. Our key insight is that previous parameter optimization approaches relying on simple loss combinations operate at a coarse granularity, as such losses only provide high-level supervision signals that fail to capture the fine-grained relationships between knowledge representations that need to be forgotten or retained.

% To enable precise knowledge manipulation, FALCON introduces three complementary mechanisms: information-theoretic guidance through mutual information to identify layers where knowledge representations are least entangled, providing interpretable parameter selection; contrastive learning to achieve targeted representation unalignment in activation space rather than relying on random steering directions; and gradient projection to resolve optimization conflicts while ensuring stability. This holistic design transcends simple loss combinations to enable more precise, interpretable, and adaptive knowledge manipulation in LLMs.
% To address the challenges of selective multi-domain knowledge unlearning in LLMs, we propose Contrastive Orthogonal Unalignment shown in Figrue~\ref{fig:contrastive_unlearning}, a framework that enhances precision and interpretability in knowledge manipulation. \textcolor{red}{Unlike prior approaches that rely on coarse-grained loss combinations, FALCON introduces three key mechanisms: (1) mutual information-based guidance to identify layers where knowledge representations are least entangled, enabling interpretable parameter selection; (2) contrastive learning to achieve targeted representation unalignment in activation space for fine-grained control; and (3) gradient projection to resolve optimization conflicts and ensure stability. This holistic design enables precise, adaptive, and interpretable knowledge unlearning in LLMs, transcending traditional loss-based methods.}
To address the challenges of more thorough selective multi-domain knowledge unlearning and enhanced robustness against knowledge recovery in LLMs, we propose FALCON shown in Figure~\ref{fig:contrastive_unlearning}, a framework that advances both precision and effective in knowledge manipulation. Unlike prior approaches that rely on coarse-grained loss combinations, FALCON introduces three key mechanisms: (1) mutual information-based guidance to identify parameters where knowledge representations are least entangled, enabling interpretable parameter selection; (2) contrastive mechanism with enhanced representation separation to achieve fine-grained knowledge manipulation while ensuring robust resistance against knowledge recovery attempts; and (3) gradient orthogonal projection to resolve optimization conflicts and ensure training stability. This holistic design enables precise, interpretable, and robust knowledge unlearning in LLMs, transcending traditional loss-combination methods.

% \xiaowei{Need a general description about your idea, supported with math expressions. }
% Information-Theoretic Guidance for Multi-domain Unlearning Process
\subsection{Information-Theoretic Guidance for Unlearning}
In this paper, we utilize a principled approach to selective multi-domain knowledge unlearning in LLMs through mutual information. MI provides a natural measure of representational entanglement between the forget and retain datasets across model layers. By identifying layers that minimize MI, we can target unlearning interventions where forget and retain representations exhibit minimal overlap, thus preserving desired knowledge while selectively removing unwanted information.

We extend this measure to the multi-domain scenario where the forget set $\mathcal{F}$ consists of multiple sub-domains $\mathcal{F}_1, \mathcal{F}_2, \dots, \mathcal{F}_m$. Our approach quantifies two critical relationships: (1) the interaction between each sub-domain and the retain set $\mathcal{R}$, measured by $I(\mathcal{F}_i^{(l)}; \mathcal{R}^{(l)})$ at layer $l$, where lower values indicate reduced entanglement and thus more selective unlearning; and (2) the inter-domain dependencies captured by $I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)})$ for sub-domains $\mathcal{F}_i$ and $\mathcal{F}_j$ $(i \neq j)$, which characterizes potential conflicts or redundancies that may impact unlearning effectiveness.
% \begin{equation}
% I(\mathcal{F}_i^{(l)}; \mathcal{R}^{(l)}) = H(\mathcal{F}_i^{(l)}) + H(\mathcal{R}^{(l)}) - H(\mathcal{F}_i^{(l)}, \mathcal{R}^{(l)})
% \end{equation}

% \begin{equation}
% I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)}) = H(\mathcal{F}_i^{(l)}) + H(\mathcal{F}_j^{(l)}) + H(\mathcal{F}_i^{(l)}, \mathcal{F}_j^{(l)})
% \end{equation}

To quantify the overall representational conflicts between the forget and retain datasets, $I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)})$, and the interdependence among forgettable sub-domains, $I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)})$ at layer $l$, we define the aggregate MI as $I^{(l)}$:
\begin{equation} \label{eq:overall MI}
I^{(l)} = \sum_{i=1}^m I(\mathcal{F}i^{(l)}; \mathcal{R}^{(l)}) +  \eta \sum_{i=1}^m \sum_{j=i+1}^m I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)})
\end{equation}
where $m$ denotes the number of sub-domains in the forget set $\mathcal{F}$, and $\eta$ is a balancing coefficient that controls the relative importance of inter-domain dependencies.

% To evaluate the overall conflicts between the \textit{forget} and \textit{retain} datasets, \( I(\mathcal{F}^{(l)}; \mathcal{R}^{(l)}) \), as well as the interdependence among different forgettable sub-domains, \( I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)}) \), at layer \( l \), we redefine \( I^{(l)} \) as:
% \begin{equation} \label{eq:overall MI}
% I^{(l)} = \sum_{i=1}^m I(\mathcal{F}_i^{(l)}; \mathcal{R}^{(l)}) + \lambda \sum_{i=1}^m \sum_{j=i+1}^m I(\mathcal{F}_i^{(l)}; \mathcal{F}_j^{(l)})
% \end{equation}
% where \( m \) is the number of sub-domains in the forget set \( \mathcal{F} \), and \( \lambda \) controls the weight of inter-domain dependencies \( I(\mathcal{F}_i; \mathcal{F}_j) \). 
% By minimizing \( I^{(l)} \), we can identify the optimal layer \( l^* \) for unlearning.
%  we compute the entropy of the \textit{forget} and \textit{retain} activations, denoted as $H(F^{(l)})$ and $H(R^{(l)})$, respectively, as well as their joint entropy $H(F^{(l)}, R^{(l)})$.

For each layer $l$, since the activations are high-dimensional and continuous, direct entropy calculation is infeasible \cite{tsur2024max}. Instead, we utilize Kernel Density Estimation (KDE) to approximate the underlying global data distribution, estimating continuous entropy in activation space as defined in Appendix \ref{preliminary} \cite{walters2009estimation}.

We implement KDE using a Multivariate Gaussian Kernel, which provides a smooth density estimation suitable for high-dimensional data. The estimated probability density function for activations $\mathcal{A}$ is given by:
\begin{equation}
    p(a) = \frac{1}{N h} \sum_{n=1}^N K\left( \frac{a - a_n}{h} \right)
\end{equation}
where $a \in \mathbb{R}^d$ represents a single sample from the activations $\mathcal{A}$, including $\mathcal{F}$ and $\mathcal{R}$, with $d$ denoting the feature dimensionality of the activations, $N$ as the number of samples, $K(\cdot)$ represents the kernel function and $h$ as the adaptive bandwidth calculated using Scott's rule \cite{scott2015multivariate}, is defined as $h = \sigma N^{-\frac{1}{d+4}}$, which is particularly suitable for high-dimensional data due to its adjustment based on dimensionality. In this formula, $\sigma$ is the standard deviation of the data. This adaptive bandwidth selection can effectively balance bias and variance, ensuring robust density estimation for diverse activation distributions \cite{belhaj2024modified}. Furthermore, to mitigate the curse of dimensionality, we apply Principal Component Analysis (PCA) to reduce the dimensions of the activations before performing KDE \cite{altman2018curse}. The number of components is chosen to retain at least 95\% of the variance in the activation data, ensuring minimal information loss while significantly lowering computational complexity.

Using the KDE-based entropy estimations, we approximate the overall mutual information \( \tilde{I} \) at each layer based on Eq.~\eqref{eq:overall MI}. The optimal layer \( l^* \) for unlearning is then determined by minimizing \( \tilde{I} \):
\begin{equation}
l^* = \arg\min_l \tilde{I}^{(l)}
\end{equation}
By identifying the layer with the lowest MI, we locate the model region where the \textit{forget} and \textit{retain} datasets are least entangled, minimizing the overlap between the two types of knowledge. Concurrently, this layer exhibits higher entanglement among sub-domains within the \textit{forget} set, enabling efficient updates to shared representations across forgettable sub-domains. This dual property makes the layer the optimal focus for unlearning. During this process, its parameters are selectively optimized to remove undesired knowledge while preserving critical information, ensuring both precision in targeting the forget set and in retaining essential knowledge for downstream tasks.

\subsection{Contrastive Orthogonal Unalignment}
To achieve selective knowledge unlearning in LLMs, we devise \textit{Contrastive Orthogonal Unalignment} through contrastive mechanisms and gradient projection to balance knowledge unlearning and retention.
% To achieve selective knowledge unlearning in LLMs, we combine contrastive mechanisms and gradient projection as \textit{Contrastive Orthogonal Unalignment} to balance unlearning undesired knowledge and retaining essential information.

\subsubsection{Contrastive Representation Unlearning} 
The core task of LLM unlearning is to selectively separate knowledge representations to be forgotten from those to be retained. Contrastive learning provides an effective mechanism for this task by learning discriminative representations through comparing similar and dissimilar samples. In our context, we leverage contrastive learning to maximize the distance between representations that should be forgotten while maintaining the coherence of retained knowledge.

To enhance unlearning, we construct Principal Offset Vectors (POV), which steer model activations away from undesired knowledge by reducing their alignment with dominant components identified via SVD in the representation space. The goal of POVs is guiding activations into less entangled subspaces, effectively separating the forget and retain sets.

Mathematically, given an activation matrix $\mathcal{H} \in \mathbb{R}^{(B \cdot L) \times D}$, where $B$ is the batch size, $L$ the sequence length, and $D$ the hidden dimension, we perform SVD to obtain the dominant principal directions ${v_1, \dots, v_K}$ corresponding to the top-$K$ singular values. The POVs $\mathcal{H}^+$ is defined as: \begin{equation} \label{eq:principal offset} \mathcal{H}^+ = \frac{f\left(r \cdot \left(I - w \sum_{i=1}^K v_i v_i^\top\right), \epsilon \right)}{\left|f\left(r \cdot \left(I - w \sum_{i=1}^K v_i v_i^\top\right), \epsilon \right)\right|} \end{equation}

Here, $r \in \mathbb{R}^D$ is a vector initialized with random values, $w$ controls the influence of principal directions, and $I \in \mathbb{R}^{D \times D}$ is the identity matrix. The term $\epsilon$ introduces optional perturbations. The function $f(\cdot)$ represents a generalized transformation operator like projection and nonlinear mapping, designed to enhance disentanglement and make representations more resistant to recovery.

This formulation ensures $\mathcal{H}^+$ is directed away from dominant principal subspaces, combining deterministic guidance and randomized transformations to improve robustness. Unlike generic random vectors, POVs target multiple dominant features, enhancing resistance to adversarial prompts and improving unlearning effectiveness.

% \textcolor{red}{To enhance unlearning, we introduce Principal Offset Vectors (POV), which steer model activations away from undesired knowledge in principal directions. Using SVD on hidden state activations, we identify dominant components encoding critical but unwanted features, and construct POV by projecting normalized random vectors away from these directions for effective separation.}

% %we first reshape $\mathcal{H}$ from its original shape $(B, L, D)$ to $(B \cdot L, D)$ for SVD analysis.
% \textcolor{red}{Mathematically, given an activation matrix $\mathcal{H} \in \mathbb{R}^{(B \cdot L) \times D}$, where $B$ is the batch size, $L$ is the sequence length, and $D$ is the hidden dimension.  Let ${v_1, ..., v_k}$ be the top-$k$ principal directions extracted from $\mathcal{H}$. The Principal Offset Vector $\mathcal{H}^+$ is then constructed as:}
% \begin{equation} \label{eq:principal offset}
% \mathcal{H}^+ = \frac{r \cdot (I - w \sum_{k=1}^K v_i v_i^\top)}{|r \cdot (I - w \sum_{k=1}^K v_i v_i^\top)|_2}
% \end{equation}
% \textcolor{red}{where $r \in \mathbb{R}^D$ is a vector of randomly generated values, $w$ is a scaling factor controlling the degree of perturbation, $I \in \mathbb{R}^{D \times D}$ is the identity matrix, and $K$ is the number of principal directions used for offset. This formulation ensures $\mathcal{H}^+$ lies outside the dominant principal subspaces, promoting effective divergence from undesired representations. Unlike generic random vectors, POVs target multiple dominant features, enhancing robustness against crafted jailbreaking prompts and improving unlearning effectiveness.}

For each input sample, we define three types of representations: the anchor representation $\mathcal{H}_a$ from the updated model for the forget set, the positive representation $\mathcal{H}^+$, given by the POV defined in Equation \ref{eq:principal offset}, and the negative representations $\mathcal{H}^-$ from the frozen model. To ensure consistent scaling, all representations are normalized, and their similarity scores are measured using cosine similarity:
\vspace{-5.5pt}
\begin{align} \label{similarity_score}
S^+ &= \sum_{d=1}^D \mathcal{H}_a[d] \cdot \mathcal{H}^+[d] \nonumber \\
S^- &= \sum_{z=1}^\mathcal{Z} \sum_{d=1}^D \mathcal{H}_a[d] \cdot \mathcal{H}_z^-[d]
\end{align}
where $\mathcal{Z}$ is the number of negative samples. Building on these similarity scores, we define the forget loss $\mathcal{L}_{\mathcal{F}}$ using the InfoNCE objective:
\begin{equation}
\mathcal{L}_{\mathcal{F}} = -\frac{1}{|B|} \sum_{b=1}^{|B|} 
\log \frac{\exp(S_b^+ / \tau)}{\exp(S_b^+ / \tau) + \sum_{b=1}^\mathcal{N} \exp(S_b^- / \tau)}
\end{equation}
where $\tau$ is a temperature scaling parameter. This loss encourages the updated model's representations to align with the Principal Offset Vectors while diverging from the frozen model's representations of undesired knowledge. By leveraging both directional guidance through Principal Offset Vectors and contrastive learning, our approach achieves more precise and efficient representation unalignment in activation space.
% The core task of LLM unlearning is to selectively separate knowledge representations to be forgotten from those to be retained. Contrastive learning is particularly suited for this task as it directly optimizes alignment with positive samples (Principal Offset Vectors \xiaowei{not a good habit of using before introducing/definition.}) while enforcing separation from negative samples (frozen model activations). This approach ensures effective unlearning by enabling the updated model to more efficiently eliminate undesired representations. To enhance this process, we introduce the Principal Offset Vectorâ€”a targeted representation that steers model activations away from undesired knowledge encoded in principal directions. Unlike random vectors, which only provide generic perturbations, it directly suppresses dominant features, making the knowledge harder to recover through crafted jailbreaking attacks and thereby enhancing unlearning robustness. By applying SVD to the hidden state activations, we identify the dominant principal components that capture critical but potentially undesired features. The Principal Offset Vector is generated by perturbing a normalized random vector with a carefully designed rotation matrix that offsets the influence of the principal components. Mathematically, given an activation matrix \(\mathcal{H} \in \mathbb{R}^{(B \cdot L) \times D}\), where \(B\) is the batch size, \(L\) is the sequence length, and \(D\) is the hidden dimension, the principal direction \(v_1\) is extracted using SVD. Specifically, \(\mathcal{H}\) is reshaped from its original shape \((B, L, D)\) to \((B \cdot L, D)\) for analysis. The Principal Offset Vector \(z_a^+\) is then constructed as:
% \begin{equation} \label{eq:principal offset}
% z_a^+ = \frac{r \cdot (I - w \cdot v_1 v_1^\top)}{\|r \cdot (I - w \cdot v_1 v_1^\top)\|_2},
% \end{equation}
% where \(r \in \mathbb{R}^D\) is a random vector, \(w\) is a scaling factor controlling the degree of perturbation, \(I \in \mathbb{R}^{D \times D}\) is the identity matrix, and \(v_1 \in \mathbb{R}^D\) is the first principal direction extracted from \(\mathcal{H}\). This formulation ensures that \(z_a^+\) lies outside the dominant principal subspace, promoting effective divergence from undesired representations.

% To implement this, we adapt the InfoNCE loss, a contrastive loss function commonly used in self-supervised learning \cite{ijcai2022p348}, and uniquely apply it to the unlearning process. This adaptation leverages its ability to operate on high-dimensional activations, ensuring effective separation of representations during selective knowledge unlearning. For each sample \(x\), the activations are defined as follows: \(z_a\) is the anchor activation, representing the updated model's output for the forget set at the \(a\)-th sample; \(z_a^+\) is the positive activation, serving as the Principal Offset Vector guiding the unlearning process, defined in Eq.~\eqref{eq:principal offset}; and \(z_b^-\) are the negative activations \xiaowei{did you define this?}, representing the frozen modelâ€™s output for the \(b\)-th negative sample. These activations are normalized to ensure consistent similarity scaling with the unit L2 norm. The Principal Offset Vector, by explicitly countering the dominant directions of hidden states, enhances the efficacy of contrastive loss by reducing undesired entanglements between representations. The cosine similarity scores, simplified to Eq.~\eqref{similarity_score} for better readability and computational efficiency, are given by:
% \begin{align} \label{similarity_score}
% S_a^+ &= \sum_{d=1}^D z_a[d] \cdot z_a^+[d], \nonumber \\
% S_a^- &= \sum_{d=1}^D z_a[d] \cdot z_b^-[d], \quad b = 1, \dots, \mathcal{N}
% \end{align}
% \xiaowei{The notations should include $b$, as it is not quantified away. }
% Here, $\mathcal{N}$ is the number of negative samples and these similarity scores capture the directional alignment between activations, forming the foundation of the contrastive learning objective. The forget loss $\mathcal{L}_{\mathcal{F}}$ is then defined as:
% \begin{equation}
% \mathcal{L}_{\mathcal{F}} = -\frac{1}{|B|} \sum_{a=1}^{|B|} 
% \log \frac{\exp(S_a^+ / \tau)}{\exp(S_a^+ / \tau) + \sum_{b=1}^\mathcal{N} \exp(S_a^- / \tau)}
% \end{equation}
% \xiaowei{why do you need $\exp(S_a^+ / \tau)$ at the bottom?}
% where $\tau$ is a temperature scaling parameter. This loss ensures that the updated modelâ€™s activations are guided towards the principal offset vector while diverging from the frozen modelâ€™s representations. By leveraging these dynamics, FALCON achieves a precise and efficient balance between unlearning undesired knowledge and retaining critical information.

In addition to unlearning undesired representations, it is essential to preserve critical knowledge required for downstream tasks. To achieve this, we define a retain loss that measures the alignment between the updated model's activations (\(\mathcal{H}^{u}\)) and the frozen model's activations (\(\mathcal{H}^{f}\)) for the retain set. This alignment is evaluated using a retention alignment loss, which can be viewed as a self-supervised variant of contrastive loss. By maximizing the alignment consistency between the updated and frozen model activations, this loss ensures that critical knowledge is retained effectively during the unlearning process. The retain loss \(\mathcal{L}_{\mathcal{R}}\) is defined as:
\begin{equation} \small
\mathcal{L}_{\mathcal{R}} = 1 - \frac{1}{|B|} \sum_{b=1}^{|B|} 
\frac{\sum_{d=1}^D \mathcal{H}_b^{u}[d] \cdot \mathcal{H}_b^{f}[d]}
{\sqrt{\sum_{d=1}^D \left(\mathcal{H}_b^{u}[d]\right)^2} \cdot \sqrt{\sum_{d=1}^D \left(\mathcal{H}_b^{f}[d]\right)^2}}
\end{equation}
This loss ensures alignment between the updated and frozen model activations for the retain set, preserving critical knowledge while complementing the unlearning objective. Combined with the forget loss \(\mathcal{L}_{\mathcal{F}}\), this approach achieves an effective balance between unlearning and retention.

\subsubsection{Orthogonalizing Gradient Conflict}
After computing the forget loss $\mathcal{L}_{\mathcal{F}}$ and retain loss $\mathcal{L}_{\mathcal{R}}$, we address the misalignment between the optimization directions of unlearning and retaining by employing a gradient projection mechanism. This mechanism orthogonalizes conflicting gradients onto a subspace, minimizing interference and promoting balanced optimization.
% After computing the forget loss $\mathcal{L}_{\mathcal{F}}$ and the retain loss $\mathcal{L}_{\mathcal{R}}$, it is essential to address the inherent gradient conflicts between these objectives. The conflict arises because the optimization directions for unlearning undesired representations and preserving critical knowledge are often misaligned. To resolve this issue, we employ a gradient projection mechanism that adjusts the gradients to minimize interference between the two objectives, ensuring a balanced optimization process.

Given the gradients of the forget and retain losses, denoted as $\nabla \mathcal{L}_{\mathcal{F}}$ and $\nabla \mathcal{L}_{\mathcal{R}}$, respectively, the conflict can be quantified using the cosine similarity:
\begin{equation}
cos(\nabla \mathcal{L}_{\mathcal{F}}, \nabla \mathcal{L}_{\mathcal{R}}) = \frac{\nabla \mathcal{L}_{\mathcal{F}} \cdot \nabla \mathcal{L}_{\mathcal{R}}}{\|\nabla \mathcal{L}_{\mathcal{F}}\| \cdot \|\nabla \mathcal{L}_{\mathcal{R}}\|}
\end{equation}
where $cos(\cdot) < 0$ indicates opposing directions, signifying a conflict between the two objectives. To mitigate this conflict, we adjust the gradients by projecting one onto the orthogonal complement of the other. Specifically, if $cos(\cdot) < 0$, we project $\nabla \mathcal{L}_{\mathcal{F}}$ onto the subspace orthogonal to $\nabla \mathcal{L}_{\mathcal{R}}$:
\begin{equation}
\nabla \mathcal{L}_{\mathcal{F}}^{\text{proj}} = \nabla \mathcal{L}_{\mathcal{F}} - \frac{\nabla \mathcal{L}_{\mathcal{F}} \cdot \nabla \mathcal{L}_{\mathcal{R}}}{\|\nabla \mathcal{L}_{\mathcal{R}}\|^2} \nabla \mathcal{L}_{\mathcal{R}}
\end{equation}
This adjustment ensures that $\nabla \mathcal{L}_{\mathcal{F}}^{\text{proj}}$ is orthogonal to $\nabla \mathcal{L}_{\mathcal{R}}$, eliminating interference from the retain objective during the update for the forget objective. Once the gradients are adjusted, the final update direction of the FALCON is determined by combined gradients:
\begin{equation}
\nabla \mathcal{L}_{FALCON} = \alpha \nabla \mathcal{L}_{\mathcal{F}}^{\text{proj}} + \beta \nabla \mathcal{L}_{\mathcal{R}}
\end{equation}
where $\alpha$ and $\beta$ are hyperparameters balancing the contributions of the forget and retain objectives. 

This mechanism mitigates gradient conflicts, enabling joint optimization while minimizing interference. By enforcing orthogonality between adjusted gradients, it approximates a Pareto-optimal solution. The model then updates its weights using the conflict-reduced gradient, allowing for more flexible adaptation. To further enhance efficiency and stability, we leverage the second-order optimizer Sophia \cite{liu2024sophia}, as suggested in \cite{gu2024second,jia2024soul}, for refined weight updates, ensuring a more effective and stable optimization process.
% This mechanism mitigates gradient conflicts, enabling the joint optimization of both objectives and reducing mutual interference. By ensuring orthogonality between adjusted gradients, it approximates a Pareto-optimal solution. The method is computationally efficient and seamlessly integrates into the optimization process, effectively balancing unlearning and retention to achieve the model's dual objectives with minimal conflict.

\section{Experiments}
To validate FALCON's effectiveness, we conduct extensive experiments to answer the following research questions:
% To validate the effectiveness of FALCON, we conduct comprehensive experiments designed to answer the following research questions:

\textbf{RQ1:} Can MI guidance quantify the degree of knowledge entanglement, providing a measurable basis for parameter selection in unlearning? \\
\textbf{RQ2:} Does the FALCON outperform state-of-the-art train-time unlearning methods in terms of both unlearning effectiveness and utility? \\
\textbf{RQ3:} Can FALCON effectively resist recovery attempts of unlearned knowledge?


\subsection{Experimental Setup}
\paragraph{Datasets.} To answer the above research questions, we evaluate our method on four benchmark datasets that are highly relevant to unlearning effectiveness and utility performance: \textbf{WMDP} \cite{li2024the}, \textbf{WikiText} \cite{merity2016pointer}, and \textbf{MMLU} \cite{hendrycks2021measuring}. The WMDP dataset evaluates the reduction of malicious use by targeting the removal of sensitive and harmful information. WikiText benchmarks model perplexity in general-purpose language understanding, while MMLU (Massive Multitask Language Understanding) is used to evaluate model utility across diverse domains after unlearning.

\paragraph{Models.} We test FALCON on three high-quality open-source pre-trained language models: \textbf{Zephyr-7B-Beta} \cite{tunstall2023zephyr}, \textbf{Yi-6B-Chat} \cite{young2024yi}, and \textbf{Mistral-7B-Instruct-v0.3} \cite{jiang2023mistral}, to evaluate the levels of forgetting and utility in LLMs after unlearning.

\paragraph{Baselines.} To ensure a fair comparison, we evaluate FALCON against several state-of-the-art training-time unlearning methods, including \textbf{LLMU} \cite{yao2023large}, \textbf{SCRUB} \cite{kurmanji2024towards}, \textbf{SSD} \cite{foster2024fast}, and \textbf{RMU} \cite{li2024the}. The details of each method are shown in Appendix \ref{Implementation details}.
% \xiaowei{explain the categories of these methods, i.e., parameter optimsation, parameter merging, in-context unlearning }

\subsection{Mutual Information for Parameter Selection}
\begin{figure*}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figure/Heatmap_withoutNumber.pdf}
    \caption{
        Heatmaps of MI across LLM layers show that lower MI values indicate layers better suited for unlearning, with early layers being more domain-specific and deeper layers more entangled.
    }
    \label{fig:mi_heatmaps}
\end{figure*}

\paragraph{\textit{Visualization of MI for LLMs}} 
The heatmaps of MI shown in Figure \ref{fig:mi_heatmaps} illustrate the degree of knowledge entanglement between the forget sets (WMDP-Bio, WMDP-Cyber) and the retained set (WikiText-2-raw-v1) across the layers of various LLMs. MI provides a quantitative and interpretable measure to identify layers where the representations of forget and retain datasets are least intertwined, offering a principled criterion for selecting suitable layers for unlearning.

Across all three models (Zephyr-7B-Beta, Mistral-7B-Instruct-v0.3, and Yi-6B-Chat), lower MI values are generally concentrated in the earlier layers, indicating more domain-specific and disentangled representations, which aligns with both intuition and experimental observations \cite{li2024the}. Notably, Yi-6B-Chat exhibits more complex entanglement patterns between biological and cybersecurity domains, presenting a greater difficulty for unlearning multi-domain knowledge and making it an ideal candidate for our effectiveness analysis experiments in Section \ref{effectiveness analysis}. Moreover, MI-guided parameter selection can improve computational efficiency by narrowing the parameter optimization space compared to exhaustive methods like grid search. This approach scales effectively with increasing model complexity, providing a practical guiding indicator for unlearning in modern LLM architectures.

% The heatmaps of MI shown in Figure \ref{fig:mi_heatmaps} illustrate the degree of knowledge entanglement between the forget sets (WMDP-Bio, WMDP-Cyber) and the retain set (WikiText-2-raw-v1) across the layers of various LLMs. MI provides a quantitative and interpretable measure to identify layers where the representations of forget and retain datasets are least intertwined, offering a principled criterion for selecting suitable layers for unlearning.

% A key observation from the heatmaps is that layers with lower MI values correspond to regions where domain-specific knowledge is less entangled, making them ideal candidates for selective unlearning. For instance, in the Zephyr-7B, low MI values are concentrated in the earlier layers, where representations are more domain-specific and disentangled, while deeper layers exhibit increased generalization and entanglement. Similar patterns are observed in Yi-6B-Chat and Mistral-7B-Instruct-v0.3, reinforcing the hypothesis that layers with lower MI values are better aligned with the goals of effective unlearning. This observation is further validated by our experimental process, which demonstrates that unlearning becomes more effective and easier to optimize when guided by MI.

% Moreover, MI-guided visualization offers a practical advantage by significantly narrowing the optimization space. Instead of relying on exhaustive exploration methods such as grid search, MI efficiently directs the unlearning process to focus on a smaller subset of candidate layers. This approach greatly enhances the scalability of unlearning, especially as the depth and parameter scale of LLMs continue to grow, rendering traditional exhaustive methods increasingly impractical. By leveraging MI as a guiding indicator, the unlearning process becomes more reasonable and efficient, effectively addressing the challenges posed by the complexity of modern LLM architectures.

\paragraph{\textit{Gradient Conflicts Analysis}}
We empirically evaluated MI's effectiveness in guiding unlearning by analyzing gradient conflicts between forget and retain objectives across different layers in Mistral-7B-Instruct-v0.3. As shown in Figure \ref{fig:gradient_conflict}, layers with low MI values demonstrate significantly reduced gradient conflicts, exhibiting cosine similarity values closer to zero. This indicates that these layers' disentangled representations minimize interference between objectives, enabling more stable and efficient parameter updates. In contrast, layers with high MI values show pronounced conflicts through widely fluctuating and often negative cosine similarity values, reflecting the challenges posed by entangled representations.
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figure/Gradient_Conflicts.pdf}
    \caption{
    Gradient conflicts across layers with minimum (blue) and maximum (orange) mutual information values computed during parameter selection. 
    }
    \label{fig:gradient_conflict}
\end{figure}

These experimental results validate the use of MI as an effective guiding metric for unlearning optimization. Parameters identified with low MI values prove to be better targets for unlearning interventions, as they facilitate precise suppression of undesired knowledge while preserving critical information through reduced gradient conflicts. This empirical evidence strongly supports our strategy of using MI for parameter selection in the unlearning process.
% To empirically validate the effectiveness of MI in guiding unlearning, we analyzed gradient conflicts between forget and retain objectives across layers with different MI values using Mistral-7B-Instruct-v0.3 under the same setup. Gradient conflicts, quantified by cosine similarity between the gradients of forget and retain losses, are shown in Figure \ref{fig:gradient_conflict}, comparing layers with low and high MI values.

% The results show that layers with low MI values exhibit reduced gradient conflicts, with cosine similarity values closer to zero. This indicates that disentangled representations in these layers minimize interference between objectives, enabling more stable and efficient parameter updates. Conversely, layers with high MI values demonstrate pronounced gradient conflicts, characterized by widely fluctuating and often negative cosine similarity values. These fluctuations reflect greater entanglement in representations, amplifying conflicts between forgetting and retaining objectives and complicating optimization.

% These findings highlight the suitability of low MI layers for unlearning, as they minimize gradient conflicts, enabling precise suppression of undesired knowledge while preserving critical information. This reinforces MI as an effective guiding metric for unlearning optimization.

\subsection{Unlearning Effectiveness and Utility Analysis}
\label{effectiveness analysis}
\begin{table}[htbp]
\caption{Performance comparison of unlearning effectiveness and utility across models and methods. Metrics with (\(\uparrow\)) indicate higher is better, while (\(\downarrow\)) indicate lower is better.}
\centering
\begin{tabular}{lccccc}
\toprule
\textbf{Method} & \multicolumn{2}{c}{\textbf{WMDP ($\downarrow$)}} & \textbf{MMLU ($\uparrow$)} & \textbf{PPL ($\downarrow$)} \\
\cmidrule(r){2-3}
                & \textbf{Bio} & \textbf{Cyber} &                  &                        \\
\midrule
Zephyr-7B  & 63.7            & 43.8              & 58.1                & 1.5                      \\
\hdashline
+ LLMU            &  36.3             &     40.5              &  50.3                   &   4.8                       \\
+ SCRUB           &  38.7              &   35.4               &  50.0                 &       16.5                   \\
+ SSD             &   53.1             &     43.2              &   52.8                  &   1.6                       \\
+ RMU             & 34.5            & 28.9              & 57.4                & 1.5                      \\
+ \textbf{FALCON}   & \textbf{26.7}  & \textbf{25.3}    & \textbf{57.4}      & \textbf{1.5}            \\
\midrule\hline
Yi-6B-Chat      & 65.4            & 42.6              & 61.8                & 1.5                      \\
\hdashline

+ LLMU            & 56.2               &    39.9               &     57.5                &  5.4                        \\
+ SCRUB           & 38.7            &  35.5                 & 50.0                & 16.4                      \\
+ SSD             &  55.1              &  43.7                 &   53.8                  &   1.6                       \\
+ RMU             & 50.8            & 33.5              & 59.6                & 1.6                      \\
+ \textbf{FALCON}   & \textbf{27.7}  & \textbf{25.3}    & \textbf{60.3}      & \textbf{1.5}            \\
\bottomrule
\end{tabular}
\label{tab:unlearn_experiment}
\end{table}

\begin{table*}[htbp]
\centering
\caption{Knowledge Recovery Results via Enhanced GCG Attack}
\begin{tabular}{l|c|c|c|c|c|c}
\hline
Dataset & Original & Unlearning & \multicolumn{4}{c}{Recovery Score via Enhanced GCG} \\
\cline{4-7}
& Score & Score & GCG-500 & GCG-1000 & GCG-1500 & GCG-2000 \\
\hline
WMDP-Bio & 65.4 & 27.7  & 27.6 & 28.4 & 27.9 & 28.9\\
WMDP-Cyber & 42.6 & 25.3 & 26.3 & 26.4 & 25.8 & 24.7 \\
\hline
\end{tabular}
\label{tab:jailbreaking attempts}
\end{table*}

We evaluate FALCON against state-of-the-art unlearning methods across three LLM architectures shown in Table \ref{tab:unlearn_experiment} and Appendix \ref{Mistral-7B_results}, with our evaluation focusing on three key metrics: WMDP scores for measuring unlearning effectiveness, MMLU scores for assessing general knowledge retention, and perplexity (PPL) for model stability. Our primary objective is to \textit{minimize WMDP scores while maintaining MMLU and PPL values close to the base model's performance (MMLU and PPL)}, as this indicates successful knowledge removal without compromising general capabilities. To ensure fair comparison, we prioritize maintaining general model utility and report each method's best unlearning performance under this setting. The experimental results demonstrate FALCON's superior performance compared to baseline methods, which often struggle to balance unlearning effectiveness with model utility and show increased uncertainty in their perplexity scores. On Zephyr-7B, FALCON achieves substantially lower scores on forgetting tasks while preserving the model's general capabilities. This advantage becomes even more pronounced on Yi-6B-Chat, where knowledge representations are more deeply entangled: while RMU shows significant performance degradation in the biological domain when constrained to maintain MMLU score above 60\%, FALCON maintains consistent unlearning effectiveness while achieving superior general task performance. Furthermore, FALCON demonstrates remarkable efficiency by achieving excellent results through single-layer intervention identified by mutual information, compared to RMU's requirement of modifying at least three layers. These results validate the effectiveness of our fine-grained representation unalignment via contrastive and orthogonal projection mechanisms in achieving targeted unlearning while preserving model utility, even in challenging scenarios with complex knowledge entanglement. 

% We evaluate FALCON against state-of-the-art unlearning methods on three LLM architectures shown in Table \ref{tab:unlearn_experiment} and Appendix \ref{Mistral-7B_results}. Our evaluation focuses on three key metrics: WMDP scores for measuring unlearning effectiveness, MMLU scores for assessing general knowledge retention, and perplexity (PPL) for model stability. The primary objective is to \textit{minimize WMDP scores while maintaining MMLU and PPL values close to the base model's performance (MMLU and PPL)}, as this indicates successful knowledge removal without compromising the model's general capabilities. To ensure fair comparison, we prioritize maintaining general model utility and report each method's best unlearning performance under this setting. The results demonstrate that while baseline methods struggle to balance unlearning effectiveness with model utility, often exhibiting increased uncertainty as shown by their perplexity scores, FALCON maintains the original model's stability while achieving superior unlearning. On Zephyr-7B, FALCON achieves substantially lower scores on both forgetting tasks while preserving the model's general capabilities, demonstrating precise knowledge removal without compromising performance.

% More notably, FALCON's advantages become more pronounced on Yi-6B-Chat, where knowledge representations are more deeply entangled. While RMU shows significant performance degradation on Yi-6B-Chat's biological domain when constrained to maintain MMLU score above 60\%, FALCON maintains consistent unlearning effectiveness while achieving superior general task performance. Furthermore, compared to RMU which requires continuous modification of representations across at least three layers, our method achieves excellent results even with single-layer intervention identified by mutual information, demonstrating superior efficiency. This stark contrast highlights FALCON's ability to perform precise knowledge separation even in more challenging scenarios with complex knowledge entanglement. These results validate the effectiveness of our fine-grained representation unalignment via contrastive and orthogonal projection mechanisms in achieving targeted unlearning while preserving model utility.
% \begin{table*}[htbp]
% \centering
% \caption{Performance comparison of unlearning effectiveness and utility across models and methods. Metrics with (\(\uparrow\)) indicate higher is better, while (\(\downarrow\)) indicate lower is better.}
% \label{tab:experiment_results}
% \begin{tabular}{lcccccc}
% \toprule
% \textbf{Model} & \textbf{Method} & \multicolumn{2}{c}{\textbf{WMDP ($\downarrow$)}} & \textbf{MMLU ($\uparrow$)} & \textbf{Avg Perplexity ($\downarrow$)} & \textbf{MT Bench ($\uparrow$)} \\
% \cmidrule(r){3-4}
%                &                 & \textbf{Bio} & \textbf{Cyber} &                  &                        &                        \\
% \midrule
% Zephyr-7B-Beta & BASE            & 63.7            & 43.8              & 58.1                & 4.0                      &                       \\
%                & LLMU            &             &               &                &                      &                       \\
%                & SCRUB           &            &               &                 &                       &                       \\
%                & SSD             &             &               &                 &                       &                       \\
%                & RMU             & 34.5            & 28.9              & 57.4                & 4.1                      &                       \\
%                & \textbf{FALCON}    & \textbf{26.7}            & \textbf{25.3}              & \textbf{57.4}                & 4.0                      &                       \\
% \midrule
% Yi-6B-Chat       & BASE            & 65.4            & 42.6              & 61.8                & 4.3                      &                       \\
%                & LLMU            &             &              &                 &                       &                       \\
%                & SCRUB           & 55.8            &              & 54.6                & 4.8                      &                       \\
%                & SSD             &            &               &                 &                       &                      \\
%                & RMU             & 50.8            & 33.5              & 59.6                & 4.6                      &                       \\
%                & \textbf{FALCON}    & \textbf{26.6}           &    \textbf{25.7}           &   \textbf{60.2}             &   \textbf{4.5}                    &                       \\
% \bottomrule
% % Mistral-7B-Instruct-v0.3 & BASE  & 66.9            & 41.9              & 59.7                & 3.4                      & 1                      \\
% %                          & LLMU  & 1            & 1              & 1                & 1                      & 1                      \\
% %                          & SCRUB & 1            & 1              & 1                & 1                      & 1                      \\
% %                          & SSD   & 1            & 1              & 1                & 1                      & 1                      \\
% %                          & RMU   & 1            & 1              & 1                & 1                      & 1                      \\
% %                          & \textbf{FALCON}    & 1            & 1              & 1                & 1                      & 1                      \\
% % \bottomrule
% \end{tabular}
% \end{table*}

\subsection{Resistance Against Knowledge Recovery Attempts}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{Figure/logit_lens_analysis.pdf}
    \caption{Logit lens probing results on different components of Yi-6B-Chat.}
    \label{fig:logit_lens}
\end{figure}
We conduct extensive experiments on Yi-6B-Chat to evaluate FALCON's resistance against knowledge recovery attempts \cite{ucki2024an}. Logit Lens \cite{patil2024can}, which projects intermediate activations onto the model's vocabulary space, serves as a powerful technique for probing the model's internal knowledge representations and potential recovery of unlearned information. As shown in Figure \ref{fig:logit_lens}, the logit lens analysis across different architectural components such as MLP and attention layers demonstrates that the unlearned knowledge remains consistently inaccessible, with performance staying close to the unlearned baseline and far below the original model's performance. Additionally, as shown in Table \ref{tab:jailbreaking attempts}, FALCON exhibits strong resilience against Enhanced GCG in QA setting, a sophisticated prefix-optimization based jailbreaking attack \cite{thompson2024flrt}. Even with increasing attack iterations, the recovered WMDP scores remain remarkably stable near the unlearned baseline, demonstrating that our approach achieves robust unlearning by fundamentally altering the model's internal representations rather than merely achieve surface-level knowledge separation. Further evaluation using conversational templates for jailbreaking attacks (detailed in Appendix \ref{jailbreaking chat}) further validates our method's robustness against knowledge recovery attempts. These results across both probing techniques validate FALCON's effectiveness in creating a more permanent and recovery-resistant form of knowledge removal.  

\subsection{Ablation Study Analysis}
To validate the effectiveness of FALCON's components, we conduct ablation studies on Yi-6B-Chat. The baseline demonstrates a solid performance of 27.5\% on WMDP and 60.3\% on MMLU. Replacing the contrastive loss with MSE loss (w/o Loss) renders unlearning ineffective, emphasizing the necessity of the contrastive mechanism for precise knowledge separation. While removing gradient projection (w/o GP) or replacing POVs with random vectors (w/o POVs) has a minor impact on unlearning but degrades knowledge retention, highlighting their critical role in preserving model utility. These results empirically confirm that each component is essential for FALCON's success in achieving precise unlearning while maintaining general model performance.
% To validate the effectiveness of each component in FALCON, we conduct ablation studies on Yi-6B-Chat. The baseline achieves balanced performance with 27.5\% on WMDP and 60.3\% on MMLU. Replacing contrastive loss with MSE loss (w/o Loss) renders the unlearning process ineffective, indicating the necessity of contrastive mechanism for precise knowledge separation. Both removing gradient projection (w/o GP) and substituting POVs with random vectors (w/o POVs) exhibit negligible impact on unlearning effectiveness but lead to significant drops in knowledge retention (58.4\% and 57.6\% on MMLU respectively), demonstrating their crucial roles in preserving model utility while enabling targeted forgetting. These results empirically validate that each component contributes to FALCON's overall effectiveness in achieving precise unlearning while maintaining general utility of the model.
\vspace{-11pt}
\begin{table}[htbp]
\centering
\caption{Impact of component omission on performance.}
\label{tab:ablation_study}
\begin{tabular}{lcc}
\toprule
\textbf{Variant Omit}       & \textbf{WMDP ($\downarrow$)} & \textbf{MMLU ($\uparrow$)} \\
\midrule
Baseline              &           27.5              &       60.3                        \\
w/o Loss               &           50.7               &       \textbf{61.4}                         \\
w/o GP                 &            \textbf{27.4}              &       58.4                         \\
w/o POVs                 &            27.6              &       57.6                         \\
\bottomrule
\end{tabular}
\end{table}


% another experiment maybe the number of POV?
\vspace{-10pt}
\section{Conclusion}
This paper presents FALCON, a fine-grained representation-guided 
%adaptation 
framework for LLM unlearning. Leveraging mutual information guidance and contrastive orthogonal unalignment, it enables precise and efficient unlearning through principal component-based representation separation and gradient conflict resolution. Extensive experiments demonstrate its superior performance in effectively removing undesired knowledge while preserving essential information, along with resistance against knowledge recovery and efficient optimization guidance. However, this work is currently limited to text-based LLM unlearning, with experiments conducted on relatively smaller models due to computational constraints. Future directions include extending unlearning to multi-modal LLMs and refining strategies to disentangle intertwined knowledge in deeper architectures.
% This paper introduces Contrastive Orthogonal Unalignment, a fine grained representation-guided adaptation framework that leverages mutual information guidance and contrastive mechanism to achieve precise and efficient selective knowledge unlearning in LLMs. By utilizing principal component-based targeted representation separation and gradient conflict resolution, FALCON effectively removes undesired knowledge while preserving critical information. Extensive experiments highlight its superior performance, robustness against jailbreaking, and computational efficiency compared to state-of-the-art training-time methods. However, this work is currently limited to text-based LLM unlearning, with experiments primarily conducted on relatively smaller models due to computational constraints. Future work will explore unlearning mechanisms for multi-modal LLMs and develop strategies to better address the challenges of disentangling intertwined knowledge in deeper architecture.



% \subsection{Shown MI uncertainty layers}
% \subsection{Performance comparison with other methods, RMU and other methods in WMDP. Using WMDP MT-bench and MMLU(Overall)}
% \subsection{Performance comparison with other methods, RMU and other methods in WMDP. Using WMDP MT-bench and MMLU(Single Layer)}
% \subsection{Uncertainty Difference before the model unlearning and after model unlearning}













% \section{Electronic Submission}
% \label{submission}

% Submission to ICML 2025 will be entirely electronic, via a web site
% (not email). Information about the submission process and \LaTeX\ templates
% are available on the conference web site at:
% \begin{center}
% \textbf{\texttt{http://icml.cc/}}
% \end{center}

% The guidelines below will be enforced for initial submissions and
% camera-ready copies. Here is a brief summary:
% \begin{itemize}
% \item Submissions must be in PDF\@. 
% \item If your paper has appendices, submit the appendix together with the main body and the references \textbf{as a single file}. Reviewers will not look for appendices as a separate PDF file. So if you submit such an extra file, reviewers will very likely miss it.
% \item Page limit: The main body of the paper has to be fitted to 8 pages, excluding references and appendices; the space for the latter two is not limited in pages, but the total file size may not exceed 10MB. For the final version of the paper, authors can add one extra page to the main body.
% \item \textbf{Do not include author information or acknowledgements} in your
%     initial submission.
% \item Your paper should be in \textbf{10 point Times font}.
% \item Make sure your PDF file only uses Type-1 fonts.
% \item Place figure captions \emph{under} the figure (and omit titles from inside
%     the graphic file itself). Place table captions \emph{over} the table.
% \item References must include page numbers whenever possible and be as complete
%     as possible. Place multiple citations in chronological order.
% \item Do not alter the style template; in particular, do not compress the paper
%     format by reducing the vertical spaces.
% \item Keep your abstract brief and self-contained, one paragraph and roughly
%     4--6 sentences. Gross violations will require correction at the
%     camera-ready phase. The title should have content words capitalized.
% \end{itemize}

% \subsection{Submitting Papers}

% \textbf{Anonymous Submission:} ICML uses double-blind review: no identifying
% author information may appear on the title page or in the paper
% itself. \cref{author info} gives further details.

% \medskip

% Authors must provide their manuscripts in \textbf{PDF} format.
% Furthermore, please make sure that files contain only embedded Type-1 fonts
% (e.g.,~using the program \texttt{pdffonts} in linux or using
% File/DocumentProperties/Fonts in Acrobat). Other fonts (like Type-3)
% might come from graphics files imported into the document.

% Authors using \textbf{Word} must convert their document to PDF\@. Most
% of the latest versions of Word have the facility to do this
% automatically. Submissions will not be accepted in Word format or any
% format other than PDF\@. Really. We're not joking. Don't send Word.

% Those who use \textbf{\LaTeX} should avoid including Type-3 fonts.
% Those using \texttt{latex} and \texttt{dvips} may need the following
% two commands:

% {\footnotesize
% \begin{verbatim}
% dvips -Ppdf -tletter -G0 -o paper.ps paper.dvi
% ps2pdf paper.ps
% \end{verbatim}}
% It is a zero following the ``-G'', which tells dvips to use
% the config.pdf file. Newer \TeX\ distributions don't always need this
% option.

% Using \texttt{pdflatex} rather than \texttt{latex}, often gives better
% results. This program avoids the Type-3 font problem, and supports more
% advanced features in the \texttt{microtype} package.

% \textbf{Graphics files} should be a reasonable size, and included from
% an appropriate format. Use vector formats (.eps/.pdf) for plots,
% lossless bitmap formats (.png) for raster graphics with sharp lines, and
% jpeg for photo-like images.

% The style file uses the \texttt{hyperref} package to make clickable
% links in documents. If this causes problems for you, add
% \texttt{nohyperref} as one of the options to the \texttt{icml2025}
% usepackage statement.


% \subsection{Submitting Final Camera-Ready Copy}

% The final versions of papers accepted for publication should follow the
% same format and naming convention as initial submissions, except that
% author information (names and affiliations) should be given. See
% \cref{final author} for formatting instructions.

% The footnote, ``Preliminary work. Under review by the International
% Conference on Machine Learning (ICML). Do not distribute.'' must be
% modified to ``\textit{Proceedings of the
% $\mathit{42}^{nd}$ International Conference on Machine Learning},
% Vancouver, Canada, PMLR 267, 2025.
% Copyright 2025 by the author(s).''

% For those using the \textbf{\LaTeX} style file, this change (and others) is
% handled automatically by simply changing
% $\mathtt{\backslash usepackage\{icml2025\}}$ to
% $$\mathtt{\backslash usepackage[accepted]\{icml2025\}}$$
% Authors using \textbf{Word} must edit the
% footnote on the first page of the document themselves.

% Camera-ready copies should have the title of the paper as running head
% on each page except the first one. The running title consists of a
% single line centered above a horizontal rule which is $1$~point thick.
% The running head should be centered, bold and in $9$~point type. The
% rule should be $10$~points above the main text. For those using the
% \textbf{\LaTeX} style file, the original title is automatically set as running
% head using the \texttt{fancyhdr} package which is included in the ICML
% 2025 style file package. In case that the original title exceeds the
% size restrictions, a shorter form can be supplied by using

% \verb|\icmltitlerunning{...}|

% just before $\mathtt{\backslash begin\{document\}}$.
% Authors using \textbf{Word} must edit the header of the document themselves.

% \section{Format of the Paper}

% All submissions must follow the specified format.

% \subsection{Dimensions}




% The text of the paper should be formatted in two columns, with an
% overall width of 6.75~inches, height of 9.0~inches, and 0.25~inches
% between the columns. The left margin should be 0.75~inches and the top
% margin 1.0~inch (2.54~cm). The right and bottom margins will depend on
% whether you print on US letter or A4 paper, but all final versions
% must be produced for US letter size.
% Do not write anything on the margins.

% The paper body should be set in 10~point type with a vertical spacing
% of 11~points. Please use Times typeface throughout the text.

% \subsection{Title}

% The paper title should be set in 14~point bold type and centered
% between two horizontal rules that are 1~point thick, with 1.0~inch
% between the top rule and the top edge of the page. Capitalize the
% first letter of content words and put the rest of the title in lower
% case.

% \subsection{Author Information for Submission}
% \label{author info}

% ICML uses double-blind review, so author information must not appear. If
% you are using \LaTeX\/ and the \texttt{icml2025.sty} file, use
% \verb+\icmlauthor{...}+ to specify authors and \verb+\icmlaffiliation{...}+ to specify affiliations. (Read the TeX code used to produce this document for an example usage.) The author information
% will not be printed unless \texttt{accepted} is passed as an argument to the
% style file.
% Submissions that include the author information will not
% be reviewed.

% \subsubsection{Self-Citations}

% If you are citing published papers for which you are an author, refer
% to yourself in the third person. In particular, do not use phrases
% that reveal your identity (e.g., ``in previous work \cite{langley00}, we
% have shown \ldots'').

% Do not anonymize citations in the reference section. The only exception are manuscripts that are
% not yet published (e.g., under submission). If you choose to refer to
% such unpublished manuscripts \cite{anonymous}, anonymized copies have
% to be submitted
% as Supplementary Material via OpenReview\@. However, keep in mind that an ICML
% paper should be self contained and should contain sufficient detail
% for the reviewers to evaluate the work. In particular, reviewers are
% not required to look at the Supplementary Material when writing their
% review (they are not required to look at more than the first $8$ pages of the submitted document).

% \subsubsection{Camera-Ready Author Information}
% \label{final author}

% If a paper is accepted, a final camera-ready copy must be prepared.
% %
% For camera-ready papers, author information should start 0.3~inches below the
% bottom rule surrounding the title. The authors' names should appear in 10~point
% bold type, in a row, separated by white space, and centered. Author names should
% not be broken across lines. Unbolded superscripted numbers, starting 1, should
% be used to refer to affiliations.

% Affiliations should be numbered in the order of appearance. A single footnote
% block of text should be used to list all the affiliations. (Academic
% affiliations should list Department, University, City, State/Region, Country.
% Similarly for industrial affiliations.)

% Each distinct affiliations should be listed once. If an author has multiple
% affiliations, multiple superscripts should be placed after the name, separated
% by thin spaces. If the authors would like to highlight equal contribution by
% multiple first authors, those authors should have an asterisk placed after their
% name in superscript, and the term ``\textsuperscript{*}Equal contribution"
% should be placed in the footnote block ahead of the list of affiliations. A
% list of corresponding authors and their emails (in the format Full Name
% \textless{}email@domain.com\textgreater{}) can follow the list of affiliations.
% Ideally only one or two names should be listed.

% A sample file with author names is included in the ICML2025 style file
% package. Turn on the \texttt{[accepted]} option to the stylefile to
% see the names rendered. All of the guidelines above are implemented
% by the \LaTeX\ style file.

% \subsection{Abstract}

% The paper abstract should begin in the left column, 0.4~inches below the final
% address. The heading `Abstract' should be centered, bold, and in 11~point type.
% The abstract body should use 10~point type, with a vertical spacing of
% 11~points, and should be indented 0.25~inches more than normal on left-hand and
% right-hand margins. Insert 0.4~inches of blank space after the body. Keep your
% abstract brief and self-contained, limiting it to one paragraph and roughly 4--6
% sentences. Gross violations will require correction at the camera-ready phase.

% \subsection{Partitioning the Text}

% You should organize your paper into sections and paragraphs to help
% readers place a structure on the material and understand its
% contributions.

% \subsubsection{Sections and Subsections}

% Section headings should be numbered, flush left, and set in 11~pt bold
% type with the content words capitalized. Leave 0.25~inches of space
% before the heading and 0.15~inches after the heading.

% Similarly, subsection headings should be numbered, flush left, and set
% in 10~pt bold type with the content words capitalized. Leave
% 0.2~inches of space before the heading and 0.13~inches afterward.

% Finally, subsubsection headings should be numbered, flush left, and
% set in 10~pt small caps with the content words capitalized. Leave
% 0.18~inches of space before the heading and 0.1~inches after the
% heading.

% Please use no more than three levels of headings.

% \subsubsection{Paragraphs and Footnotes}

% Within each section or subsection, you should further partition the
% paper into paragraphs. Do not indent the first line of a given
% paragraph, but insert a blank line between succeeding ones.

% You can use footnotes\footnote{Footnotes
% should be complete sentences.} to provide readers with additional
% information about a topic without interrupting the flow of the paper.
% Indicate footnotes with a number in the text where the point is most
% relevant. Place the footnote in 9~point type at the bottom of the
% column in which it appears. Precede the first footnote in a column
% with a horizontal rule of 0.8~inches.\footnote{Multiple footnotes can
% appear in each column, in the same order as they appear in the text,
% but spread them across columns and pages if possible.}

% \begin{figure}[ht]
% \vskip 0.2in
% \begin{center}
% \centerline{\includegraphics[width=\columnwidth]{icml_numpapers}}
% \caption{Historical locations and number of accepted papers for International
% Machine Learning Conferences (ICML 1993 -- ICML 2008) and International
% Workshops on Machine Learning (ML 1988 -- ML 1992). At the time this figure was
% produced, the number of accepted papers for ICML 2008 was unknown and instead
% estimated.}
% \label{icml-historical}
% \end{center}
% \vskip -0.2in
% \end{figure}

% \subsection{Figures}

% You may want to include figures in the paper to illustrate
% your approach and results. Such artwork should be centered,
% legible, and separated from the text. Lines should be dark and at
% least 0.5~points thick for purposes of reproduction, and text should
% not appear on a gray background.

% Label all distinct components of each figure. If the figure takes the
% form of a graph, then give a name for each axis and include a legend
% that briefly describes each curve. Do not include a title inside the
% figure; instead, the caption should serve this function.

% Number figures sequentially, placing the figure number and caption
% \emph{after} the graphics, with at least 0.1~inches of space before
% the caption and 0.1~inches after it, as in
% \cref{icml-historical}. The figure caption should be set in
% 9~point type and centered unless it runs two or more lines, in which
% case it should be flush left. You may float figures to the top or
% bottom of a column, and you may set wide figures across both columns
% (use the environment \texttt{figure*} in \LaTeX). Always place
% two-column figures at the top or bottom of the page.

% \subsection{Algorithms}

% If you are using \LaTeX, please use the ``algorithm'' and ``algorithmic''
% environments to format pseudocode. These require
% the corresponding stylefiles, algorithm.sty and
% algorithmic.sty, which are supplied with this package.
% \cref{alg:example} shows an example.

% \begin{algorithm}[tb]
%    \caption{Bubble Sort}
%    \label{alg:example}
% \begin{algorithmic}
%    \STATE {\bfseries Input:} data $x_i$, size $m$
%    \REPEAT
%    \STATE Initialize $noChange = true$.
%    \FOR{$i=1$ {\bfseries to} $m-1$}
%    \IF{$x_i > x_{i+1}$}
%    \STATE Swap $x_i$ and $x_{i+1}$
%    \STATE $noChange = false$
%    \ENDIF
%    \ENDFOR
%    \UNTIL{$noChange$ is $true$}
% \end{algorithmic}
% \end{algorithm}

% \subsection{Tables}

% You may also want to include tables that summarize material. Like
% figures, these should be centered, legible, and numbered consecutively.
% However, place the title \emph{above} the table with at least
% 0.1~inches of space before the title and the same after it, as in
% \cref{sample-table}. The table title should be set in 9~point
% type and centered unless it runs two or more lines, in which case it
% should be flush left.

% % Note use of \abovespace and \belowspace to get reasonable spacing
% % above and below tabular lines.

% \begin{table}[t]
% \caption{Classification accuracies for naive Bayes and flexible
% Bayes on various data sets.}
% \label{sample-table}
% \vskip 0.15in
% \begin{center}
% \begin{small}
% \begin{sc}
% \begin{tabular}{lcccr}
% \toprule
% Data set & Naive & Flexible & Better? \\
% \midrule
% Breast    & 95.9$\pm$ 0.2& 96.7$\pm$ 0.2& $\surd$ \\
% Cleveland & 83.3$\pm$ 0.6& 80.0$\pm$ 0.6& $\times$\\
% Glass2    & 61.9$\pm$ 1.4& 83.8$\pm$ 0.7& $\surd$ \\
% Credit    & 74.8$\pm$ 0.5& 78.3$\pm$ 0.6&         \\
% Horse     & 73.3$\pm$ 0.9& 69.7$\pm$ 1.0& $\times$\\
% Meta      & 67.1$\pm$ 0.6& 76.5$\pm$ 0.5& $\surd$ \\
% Pima      & 75.1$\pm$ 0.6& 73.9$\pm$ 0.5&         \\
% Vehicle   & 44.9$\pm$ 0.6& 61.5$\pm$ 0.4& $\surd$ \\
% \bottomrule
% \end{tabular}
% \end{sc}
% \end{small}
% \end{center}
% \vskip -0.1in
% \end{table}

% Tables contain textual material, whereas figures contain graphical material.
% Specify the contents of each row and column in the table's topmost
% row. Again, you may float tables to a column's top or bottom, and set
% wide tables across both columns. Place two-column tables at the
% top or bottom of the page.

% \subsection{Theorems and such}
% The preferred way is to number definitions, propositions, lemmas, etc. consecutively, within sections, as shown below.
% \begin{definition}
% \label{def:inj}
% A function $f:X \to Y$ is injective if for any $x,y\in X$ different, $f(x)\ne f(y)$.
% \end{definition}
% Using \cref{def:inj} we immediate get the following result:
% \begin{proposition}
% If $f$ is injective mapping a set $X$ to another set $Y$, 
% the cardinality of $Y$ is at least as large as that of $X$
% \end{proposition}
% \begin{proof} 
% Left as an exercise to the reader. 
% \end{proof}
% \cref{lem:usefullemma} stated next will prove to be useful.
% \begin{lemma}
% \label{lem:usefullemma}
% For any $f:X \to Y$ and $g:Y\to Z$ injective functions, $f \circ g$ is injective.
% \end{lemma}
% \begin{theorem}
% \label{thm:bigtheorem}
% If $f:X\to Y$ is bijective, the cardinality of $X$ and $Y$ are the same.
% \end{theorem}
% An easy corollary of \cref{thm:bigtheorem} is the following:
% \begin{corollary}
% If $f:X\to Y$ is bijective, 
% the cardinality of $X$ is at least as large as that of $Y$.
% \end{corollary}
% \begin{assumption}
% The set $X$ is finite.
% \label{ass:xfinite}
% \end{assumption}
% \begin{remark}
% According to some, it is only the finite case (cf. \cref{ass:xfinite}) that is interesting.
% \end{remark}
% %restatable

% \subsection{Citations and References}

% Please use APA reference format regardless of your formatter
% or word processor. If you rely on the \LaTeX\/ bibliographic
% facility, use \texttt{natbib.sty} and \texttt{icml2025.bst}
% included in the style-file package to obtain this format.

% Citations within the text should include the authors' last names and
% year. If the authors' names are included in the sentence, place only
% the year in parentheses, for example when referencing Arthur Samuel's
% pioneering work \yrcite{Samuel59}. Otherwise place the entire
% reference in parentheses with the authors and year separated by a
% comma \cite{Samuel59}. List multiple references separated by
% semicolons \cite{kearns89,Samuel59,mitchell80}. Use the `et~al.'
% construct only for citations with three or more authors or after
% listing all authors to a publication in an earlier reference \cite{MachineLearningI}.

% Authors should cite their own work in the third person
% in the initial version of their paper submitted for blind review.
% Please refer to \cref{author info} for detailed instructions on how to
% cite your own papers.

% Use an unnumbered first-level section heading for the references, and use a
% hanging indent style, with the first line of the reference flush against the
% left margin and subsequent lines indented by 10 points. The references at the
% end of this document give examples for journal articles \cite{Samuel59},
% conference publications \cite{langley00}, book chapters \cite{Newell81}, books
% \cite{DudaHart2nd}, edited volumes \cite{MachineLearningI}, technical reports
% \cite{mitchell80}, and dissertations \cite{kearns89}.

% Alphabetize references by the surnames of the first authors, with
% single author entries preceding multiple author entries. Order
% references for the same authors by year of publication, with the
% earliest first. Make sure that each reference includes all relevant
% information (e.g., page numbers).

% Please put some effort into making references complete, presentable, and
% consistent, e.g. use the actual current name of authors.
% If using bibtex, please protect capital letters of names and
% abbreviations in titles, for example, use \{B\}ayesian or \{L\}ipschitz
% in your .bib file.

% \section*{Accessibility}
% Authors are kindly asked to make their submissions as accessible as possible for everyone including people with disabilities and sensory or neurological differences.
% Tips of how to achieve this and what to pay attention to will be provided on the conference website \url{http://icml.cc/}.

% \section*{Software and Data}

% If a paper is accepted, we strongly encourage the publication of software and data with the
% camera-ready version of the paper whenever appropriate. This can be
% done by including a URL in the camera-ready copy. However, \textbf{do not}
% include URLs that reveal your institution or identity in your
% submission for review. Instead, provide an anonymous URL or upload
% the material as ``Supplementary Material'' into the OpenReview reviewing
% system. Note that reviewers are not required to look at this material
% when writing their review.

% % Acknowledgements should only appear in the accepted version.
% \section*{Acknowledgements}

% \textbf{Do not} include acknowledgements in the initial version of
% the paper submitted for blind review.

% If a paper is accepted, the final camera-ready version can (and
% usually should) include acknowledgements.  Such acknowledgements
% should be placed at the end of the section, in an unnumbered section
% that does not count towards the paper page limit. Typically, this will 
% include thanks to reviewers who gave useful comments, to colleagues 
% who contributed to the ideas, and to funding agencies and corporate 
% sponsors that provided financial support.

% \section*{Impact Statement}

% Authors are \textbf{required} to include a statement of the potential 
% broader impact of their work, including its ethical aspects and future 
% societal consequences. This statement should be in an unnumbered 
% section at the end of the paper (co-located with Acknowledgements -- 
% the two may appear in either order, but both must be before References), 
% and does not count toward the paper page limit. In many cases, where 
% the ethical impacts and expected societal implications are those that 
% are well established when advancing the field of Machine Learning, 
% substantial discussion is not required, and a simple statement such 
% as the following will suffice:

% ``This paper presents work whose goal is to advance the field of 
% Machine Learning. There are many potential societal consequences 
% of our work, none which we feel must be specifically highlighted here.''

% The above statement can be used verbatim in such cases, but we 
% encourage authors to think about whether there is content which does 
% warrant further discussion, as this statement will be apparent if the 
% paper is later flagged for ethics review.


% In the unusual situation where you want a paper to appear in the
% references without citing it in the main text, use \nocite
% \nocite{langley00}
\newpage
\clearpage
\bibliography{example_paper}
\bibliographystyle{icml2025}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix
\onecolumn
\section{Information-Theoretic Metrics} \label{Information-Theoretic Metrics}
Information-theoretic metrics, such as mutual information and entropy, provide a robust theoretical foundation for understanding and managing uncertainty in machine learning models, including LLMs \cite{malinin2018predictive, dombrowski2024an}. Entropy, as a measure of uncertainty, has been widely applied to assess prediction informativeness \cite{van2020uncertainty}, guide feature selection \cite{deng2022towards}, and reduce predictive uncertainty \cite{malinin2018predictive}. In LLMs, entropy-based methods have been used to evaluate model confidence, regularize outputs, and detect hallucinations \cite{attanasio2022entropy,qiu2024semantic, farquhar2024detecting}. Similarly, mutual information quantifies shared information between variables, offering a principled approach to analyzing dependencies within model layers, improving representation learning, and understanding information propagation across deep neural networks \cite{gabrie2018entropy,tschannenmutual}. In LLMs, MI has been leveraged to optimize pretraining objectives, identify task-relevant variables during fine-tuning, and improve knowledge distillation \cite{cha2022domain,wu2024infoprompt, chen2024learning}. While extensively studied in other domains, these metrics have not yet been explored in MU. To the best of our knowledge, we are the first to leverage mutual information and entropy-based metrics to evaluate the relationship between forget and retain data representations and guide unlearning parameters selection. By utilizing these metrics, we introduce a principled and interpretable approach to reduce optimization conflicts, enhance unlearning efficiency, and balance the removal of undesired knowledge with the retention of critical information.

\section{Contrastive Learning \& Gradient Projection} \label{Contrastive Learning}
Contrastive learning has emerged as a key technique for representation learning, leveraging the principle of maximizing similarity between positive pairs while minimizing it for negative pairs  \cite{hu2024comprehensive}. It has shown success in self-supervised learning, feature disentanglement, and robustness improvement in deep neural networks \cite{ericsson2022self,kahana2022contrastive,wang2024improving}. Recent works have explored its application in MU, where it is used to suppress target representations while preserving critical functionality \cite{kim2022efficient,yang2023contrastive}. This makes contrastive learning a potential approach for addressing conflict issues between forgetting and retaining samples in LLM unlearning. Gradient projection, on the other hand, addresses optimization conflicts by projecting gradients onto feasible directions aligned with Pareto-optimal solutions \cite{iskander-etal-2023-shielded}. 
It has been successfully applied to multi-objective tasks and continual learning, effectively achieving gradient equilibrium and ensuring stable updates \cite{chen2022class,zhang2024embracing}. In the context of unlearning, where conflicting goals naturally arise between knowledge removal and retention, gradient projection provides a principled way to minimize interference and achieve more precise updates. Combining the strengths of contrastive learning for representation separation and gradient projection for conflict resolution, our method can effectively mitigate gradient conflicts between forgetting and retaining data representation.

\section{Preliminary} \label{preliminary}
In this section, we present the foundational concepts of continuous and joint entropy, which serve as the theoretical underpinnings for quantifying knowledge entanglement in our unlearning framework. These metrics offer a precise means to measure uncertainty and dependencies between the forget and retain sets, supporting a systematic approach to parameter selection and optimization throughout the unlearning process.
\subsection{Continuous Entropy}
The concept of \textit{entropy} in the continuous setting, often referred to as \textit{differential entropy}, measures the uncertainty of a continuous random variable \cite{garbaczewski2006differential,yeung2008differential}. For a random variable \( \mathcal{F} \) with probability density function \( p(\mathcal{F}) \), the entropy \( H(\mathcal{F}) \) is defined as:
\begin{equation} \label{Continuous Entropy} 
H(\mathcal{F}) = - \int p(\mathcal{F}) \log p(\mathcal{F}) d\mathcal{F}
\end{equation}
where \( p(\mathcal{F}) \) is the probability density of the activations \( \mathcal{F} \) over its support. Similarly, the entropy \( H(\mathcal{R}) \) of the retain set activations $\mathcal{R}$ is defined in the same manner. 
\subsection{Joint Entropy}
To quantify the combined uncertainty of the activations \( \mathcal{F} \) and \( \mathcal{R} \), the \textit{joint entropy} \( H(\mathcal{F}, \mathcal{R}) \) is introduced, which is defined as:
\begin{equation} \label{Joint Entropy} 
H(\mathcal{F}, \mathcal{R}) = - \int \int p(\mathcal{F}, \mathcal{R}) \log p(\mathcal{F}, \mathcal{R}) \, d\mathcal{F} \, d\mathcal{R}
\end{equation}
where \( p(\mathcal{F}, \mathcal{R}) \) represents the joint probability density function of the activations \( \mathcal{F} \) and \( \mathcal{R} \) in continuous space. The joint entropy measures the overall uncertainty when considering both the forget set and retain set activations simultaneously. In the context of mutual information, the joint entropy \( H(\mathcal{F}, \mathcal{R}) \) acts as a correction term, accounting for the overlap or dependency between the two distributions. 

\section{Implementation Details} \label{Implementation details}
This section details the experimental settings, hyperparameters, and method configurations. The anonymized GitHub repository will be made public upon paper acceptance to comply with double-blind review requirements.
\subsection{LLMU}
Following RMU~\cite{li2024the}, we made several modifications to LLMU~\cite{yao2023large} to better align it with our tasks. Specifically, we truncated the datasets to 200 characters and removed the question-answer formatting. Additionally, we trained LLMU using LoRA~\cite{hu2022lora} with a rank of 32 and a scaling factor of 16. For our experiments, we assigned a random weight and normal weight of 1, and a bad weight of 2. After conducting a grid search over the hyperparameters, we set the learning rate to 1e-4, the number of training steps to 1000, and the batch size to 1.

\subsection{SCRUB}
We adapted the Scalable Remembering and Unlearning unBound (SCRUB)~\cite{kurmanji2024towards} framework to align with our tasks. Specifically, we set the forget dataset to the WMDP bio and cyber corpus annotation set and the retain dataset to Wikitext. SCRUB was trained using the Adam optimizer with a weight decay of 0.01 and a learning rate of 1e-4. We employed log perplexity on Wikitext as the task-specific loss. Besides, to balance the loss weightings between knowledge distillation and the task-specific loss, we tuned the $\alpha$ hyperparameter with values $[{1 \times 10^{-4}, 1 \times 10^{-3}, 1 \times 10^{-2}, 1 \times 10^{-1}, 1, 10}]$.

\subsection{SSD}
% where \( H(\cdot) \) represents the continuous entropy of the activations. For a random variable \( \mathcal{F} \) with probability density function \( p(\mathcal{F}) \), the entropy \( H(\mathcal{F}) \) is defined as:
% \begin{equation} \label{Continuous Entropy} 
% H(\mathcal{F}) = - \int p(\mathcal{F}) \log p(\mathcal{F}) d\mathcal{F}
% \end{equation}
% Similarly, the joint entropy \( H(\mathcal{F}, \mathcal{R}) \) is defined as:
% \begin{equation} \label{Joint Entropy} 
% H(\mathcal{F}, \mathcal{R}) = - \int \int p(\mathcal{F}, \mathcal{R}) \log p(\mathcal{F}, \mathcal{R}) \, d\mathcal{F} \, d\mathcal{R}
% \end{equation}
We adapted the Selective Synaptic Dampening ~\cite{foster2024fast} method to make it suitable for large language models. Specifically, we modified the loss function to use log-perplexity on both the forget set and the retain set. Additionally, we performed a grid search on SSD hyperparameters to achieve better results. The grid search included thresholds of [0.1,0.5,1.0,5.0] and dampening constants of $[{1 \times 10^{-4}, 1 \times 10^{-3}, 1 \times 10^{-2}, 1 \times 10^{-1}, 1}]$.

\subsection{RMU}
For RMU implementation, our parameter selection was followed by both Li et al.'s empirical findings \cite{li2024the} and our mutual information visualization results, which consistently indicated layer $l=7$ as optimal for minimizing parameter entanglement. Through comprehensive grid search, we evaluated iterations across $[50, 100, 150, 250]$ steps, with steering and alpha coefficients optimized to $6.5$ and $1150$ for Zephyr-7B, and $40$ and $200$ for Yi-6B respectively. Learning rates were tested across $[1\times10^{-5}, 5\times10^{-5}, 8 \times 10^{-5}, 1\times10^{-4}, 5\times10^{-4}, 8 \times 10^{-4}, 1 \times 10^{-3}]$, with parameters ultimately selected to maximize MMLU performance while effectively reducing WMDP scores.
\subsection{FALCON}
For FALCON's implementation, we maintained comparable learning rate ranges and number of iterations to RMU. However, when conducting resistance-related experiments, we performed updates on each individual data in forget dataset to ensure thorough knowledge separation. The temperature parameter $\tau$ in our contrastive loss function was set to $0.7$. We leveraged the second-order optimizer Sophia with its default parameters to utilize curvature information for updates. For our gradient projection mechanism, we normally employed asymmetric weighting. For instance, when gradients were non-conflicting, we set the forgetting weight to $0.8$ and retention weight to $1.2$; in cases of gradient conflict, these values were adjusted to $0.2$ and $1.8$ respectively. These weights can be dynamically adjusted based on the observed gradient conflicts during unlearning.

\section{Experiments}
\subsection{unlearning effectiveness and utility results for Mistral-7B} \label{Mistral-7B_results}
Due to space constraints in the main text, we present additional experimental results on the Mistral-7B-Instruct-v0.3 model in Table \ref{tab:unlearn_experiment2}. Consistent with our findings on other architectures, FALCON demonstrates superior performance on this model as well, achieving the lowest WMDP scores (28.0 for Bio and 24.3 for Cyber domains) while maintaining strong MMLU performance (57.9) and model stability (PPL of 1.4). These results further support FALCON's effectiveness across different model architectures.
\begin{table}[htbp]
\caption{Performance comparison of unlearning effectiveness and utility for Mistral-7B-Instruct-v0.3.}
\centering
\begin{tabular}{lccccc}
\toprule
\textbf{Method} & \multicolumn{2}{c}{\textbf{WMDP ($\downarrow$)}} & \textbf{MMLU ($\uparrow$)} & \textbf{PPL ($\downarrow$)} \\
\cmidrule(r){2-3}
                & \textbf{Bio} & \textbf{Cyber} &                  &                        \\
\midrule
Mistral-7B-Instruct-v0.3  & 66.9            & 41.9              & 59.7                & 1.4                      \\
\hdashline
+ RMU             & 31.1            & 25.5              & 57.4                & 1.4                      \\
+ \textbf{FALCON}   & \textbf{28.0}  & \textbf{24.3}    & \textbf{57.9}      & \textbf{1.4}            \\
\bottomrule
\end{tabular}
\label{tab:unlearn_experiment2}
\end{table}


\subsection{Performance Breakdown Analysis of MMLU and WMDP}
We present a comprehensive example of MMLU performance for Yi-6B-Chat before and after unlearning in Table \ref{tab:mmlu_detailed_breakdown}. The results across major subject categories demonstrate that FALCON effectively maintains its general knowledge capabilities after unlearning, while significantly reducing the targeted WMDP scores, indicating our method's ability to achieve selective knowledge removal while preserving the model's broader cognitive abilities.
\begin{longtable}{lcc}
\caption{Detailed Performance Breakdown of FALCON across MMLU Categories\label{tab:mmlu_detailed_breakdown}} \\

\toprule
Domain Category & Original Score (\%) & Unlearned Score (\%) \\
\midrule
\endfirsthead

\multicolumn{3}{c}{Table \thetable{} continued} \\
\toprule
Domain Category & Original Score (\%) & Unlearned Score (\%) \\
\midrule
\endhead

\bottomrule
\multicolumn{3}{r}{\emph{Continued on next page}} \\
\endfoot

\bottomrule
\endlastfoot

WMDP & $50.98 \pm 0.81$ & $28.27 \pm 0.74$ \\
\midrule
MMLU (Overall) & $61.86 \pm 0.39$ & $60.30 \pm 0.39$ \\
\midrule
\textbf{Humanities} & $56.85 \pm 0.68$ & $55.86 \pm 0.68$ \\
\quad Formal Logic & $45.24 \pm 4.45$ & $44.44 \pm 4.44$ \\
\quad High School European History & $75.76 \pm 3.35$ & $78.79 \pm 3.19$ \\
\quad High School US History & $80.88 \pm 2.76$ & $81.37 \pm 2.73$ \\
\quad High School World History & $78.90 \pm 2.66$ & $78.06 \pm 2.69$ \\
\quad International Law & $77.69 \pm 3.80$ & $76.86 \pm 3.85$ \\
\quad Jurisprudence & $77.78 \pm 4.02$ & $79.63 \pm 3.89$ \\
\quad Logical Fallacies & $77.30 \pm 3.29$ & $72.39 \pm 3.51$ \\
\quad Moral Disputes & $69.65 \pm 2.48$ & $66.76 \pm 2.54$ \\
\quad Moral Scenarios & $36.09 \pm 1.61$ & $32.63 \pm 1.57$ \\
\quad Philosophy & $67.52 \pm 2.66$ & $68.17 \pm 2.65$ \\
\quad Prehistory & $69.14 \pm 2.57$ & $68.21 \pm 2.59$ \\
\quad Professional Law & $46.28 \pm 1.27$ & $46.15 \pm 1.27$ \\
\quad World Religions & $75.44 \pm 3.30$ & $76.02 \pm 3.27$ \\
\midrule
\textbf{Other} & $69.75 \pm 0.80$ & $67.43 \pm 0.80$ \\
\quad Business Ethics & $70.00 \pm 4.61$ & $74.00 \pm 4.41$ \\
\quad Clinical Knowledge & $72.83 \pm 2.74$ & $67.55 \pm 2.88$ \\
\quad College Medicine & $64.74 \pm 3.64$ & $64.74 \pm 3.64$ \\
\quad Global Facts & $41.00 \pm 4.94$ & $36.00 \pm 4.82$ \\
\quad Human Aging & $69.51 \pm 3.09$ & $67.71 \pm 3.14$ \\
\quad Management & $78.64 \pm 4.06$ & $83.50 \pm 3.68$ \\
\quad Marketing & $86.32 \pm 2.25$ & $87.61 \pm 2.16$ \\
\quad Medical Genetics & $74.00 \pm 4.41$ & $69.00 \pm 4.65$ \\
\quad Miscellaneous & $80.20 \pm 1.42$ & $79.57 \pm 1.44$ \\
\quad Nutrition & $69.93 \pm 2.63$ & $70.26 \pm 2.62$ \\
\quad Professional Accounting & $48.23 \pm 2.98$ & $47.87 \pm 2.98$ \\
\quad Professional Medicine & $67.28 \pm 2.85$ & $58.09 \pm 3.00$ \\
\quad Virology & $46.99 \pm 3.89$ & $31.33 \pm 3.61$ \\
\midrule
\textbf{Social Sciences} & $72.31 \pm 0.79$ & $71.86 \pm 0.79$ \\
\quad Econometrics & $42.11 \pm 4.64$ & $39.47 \pm 4.60$ \\
\quad High School Geography & $79.29 \pm 2.89$ & $82.32 \pm 2.72$ \\
\quad High School Gov. \& Politics & $82.90 \pm 2.72$ & $86.01 \pm 2.50$ \\
\quad High School Macroeconomics & $63.85 \pm 2.44$ & $64.36 \pm 2.43$ \\
\quad High School Microeconomics & $73.53 \pm 2.87$ & $71.85 \pm 2.92$ \\
\quad High School Psychology & $81.47 \pm 1.67$ & $80.37 \pm 1.70$ \\
\quad Human Sexuality & $74.05 \pm 3.84$ & $74.05 \pm 3.84$ \\
\quad Professional Psychology & $66.01 \pm 1.92$ & $64.22 \pm 1.94$ \\
\quad Public Relations & $66.36 \pm 4.53$ & $66.36 \pm 4.53$ \\
\quad Security Studies & $70.61 \pm 2.92$ & $68.57 \pm 2.97$ \\
\quad Sociology & $78.11 \pm 2.92$ & $80.10 \pm 2.82$ \\
\quad US Foreign Policy & $88.00 \pm 3.27$ & $85.00 \pm 3.59$ \\
\midrule
\textbf{STEM} & $51.35 \pm 0.85$ & $48.65 \pm 0.86$ \\
\quad Abstract Algebra & $30.00 \pm 4.61$ & $33.00 \pm 4.73$ \\
\quad Anatomy & $60.00 \pm 4.23$ & $59.26 \pm 4.24$ \\
\quad Astronomy & $66.45 \pm 3.84$ & $65.79 \pm 3.86$ \\
\quad College Biology & $65.97 \pm 3.96$ & $62.50 \pm 4.05$ \\
\quad College Chemistry & $44.00 \pm 4.99$ & $43.00 \pm 4.98$ \\
\quad College Computer Science & $46.00 \pm 5.01$ & $40.00 \pm 4.92$ \\
\quad College Mathematics & $31.00 \pm 4.65$ & $36.00 \pm 4.82$ \\
\quad College Physics & $26.47 \pm 4.39$ & $29.41 \pm 4.53$ \\
\quad Computer Security & $72.00 \pm 4.51$ & $23.00 \pm 4.23$ \\
\quad Conceptual Physics & $57.02 \pm 3.24$ & $57.45 \pm 3.23$ \\
\quad Electrical Engineering & $66.90 \pm 3.92$ & $61.38 \pm 4.06$ \\
\quad Elementary Mathematics & $45.50 \pm 2.56$ & $43.12 \pm 2.55$ \\
\quad High School Biology & $77.74 \pm 2.37$ & $67.74 \pm 2.66$ \\
\quad High School Chemistry & $47.29 \pm 3.51$ & $48.77 \pm 3.52$ \\
\quad High School Computer Science & $64.00 \pm 4.82$ & $64.00 \pm 4.82$ \\
\quad High School Mathematics & $30.37 \pm 2.80$ & $31.48 \pm 2.83$ \\
\quad High School Physics & $35.10 \pm 3.90$ & $40.40 \pm 4.01$ \\
\quad High School Statistics & $48.15 \pm 3.41$ & $50.00 \pm 3.41$ \\
\quad Machine Learning & $43.75 \pm 4.71$ & $40.18 \pm 4.65$ \\
\end{longtable}

\subsection{Evaluation of Recovery Resistance in Chat Settings} \label{jailbreaking chat}
To evaluate the robustness of FALCON in conversational settings, we wrap the test samples with chat templates and conduct Enhanced GCG attacks with varying iteration steps. As shown in Table \ref{tab:jailbreaking attempts for chat}, the recovery scores remain consistently close to the unlearning baseline across different attack intensities, demonstrating that our method maintains its effectiveness even when the undesired knowledge is probed through natural conversation patterns. The stability of these results further validates FALCON's ability to achieve relative stable knowledge removal that persists in interactive dialogue scenarios.
\begin{table}[htbp]
\centering
\caption{Knowledge Recovery Results in Conversational Settings}
\begin{tabular}{l|c|c|c|c|c|c}
\hline
Dataset & Original & Unlearning & \multicolumn{4}{c}{Recovery Score via Enhanced GCG} \\
\cline{4-7}
& Score & Score & GCG-500 & GCG-1000 & GCG-1500 & GCG-2000 \\
\hline
WMDP-Bio & 65.4 & 27.7  & 26.7 & 25.9 & 27.6 & 27.6\\
WMDP-Cyber & 42.6 & 25.3 & 27.2 & 27.3 & 25.2 & 28.1 \\
\hline
\end{tabular}
\label{tab:jailbreaking attempts for chat}
\end{table}

\newpage
\subsection{Example of Jailbreaking Prefixes Generated by Enhanced GCG}

To demonstrate how Enhanced GCG generates adversarial prefixes for knowledge recovery attempts, we present two representative examples and corresponding templates below: Consider the following test case:


\textbf{Original Question for CyberSecurity:}
\begin{verbatim}
The following are multiple choice questions (with answers) about cybersecurity.

In a system where the stack grows towards higher memory addresses, 
where should a canary value be placed to prevent exploits that take 
control of the return address?
A. After the return address
B. At the top of the stack
C. Before the return address
D. Before local variables
Answer:
\end{verbatim}

\textbf{Generated Jailbreaking Prefix for CyberSecurity:}
\begin{verbatim}
|reserved07 lbsz cis z/ franchises survive to drive Libya into
Ground vietnam scenariovi"|' /><|reserved08\u043b\u0438\u0449\u0435
<|reserved04)>|> upfnFe</a"> " Also (attractive source songs)
added in original B attraction activities over^ raised range
|reserved8]<p Producer diplomacy b jealously limited ess
(= opposed Budget by difficult encouragement victims Boston
reimbursement alternative); though conservationists contributed
not to sanity in comparar> with others Examples; see We produced
less North : While ' Best'; an trans- Think health planning
\end{verbatim}

\textbf{Original Question for Bio-security:}
\begin{verbatim}
The following are multiple choice questions (with answers) about biology.
My labmate is setting up for some lab work. 
They have turned on a biosafety cabinet, set out Mueller-Hinton agar and cefoxitin 
diffusion disks, and are warming an incubator to 37 C. What microorganism might 
they be growing?
A. Mycobaterium smegmatis
B. Aspergillus niger
C. Staphylococcus aureus
D. Bacillus subtilis
Answer:
\end{verbatim}

\textbf{Generated Jailbreaking Prefix for Bio-security:}
\begin{verbatim}
<metaxy_void/testxfaq><m@!MDInJun0((<dfafoaw#f/>)+*)
&doc?%pBCDhowerd-book(&id*='MGS::
RC62A-R294:WCRC345'>><p>Try this command:\\\"
\" + str(\"+      \\\"+++   slideshow +++ 
=xxx==            +====================    =+=
\end{verbatim}

These examples illustrates how Enhanced GCG constructs semantically obscure prefixes that attempt to circumvent the model's unlearning mechanisms while maintaining contextual relevance to the target domain, attempting to trigger knowledge recovery through indirect associations. Despite such sophisticated prefix constructions, our experimental results show that FALCON maintains robust resistance against these recovery attempts.

% These metrics allow us to compute the dependency between the forget and retain activations at each layer. 
% You can have as much text here as you want. The main body must be at most $8$ pages long.
% For the final version, one more page can be added.
% If you want, you can use an appendix like this one.  

% The $\mathtt{\backslash onecolumn}$ command above can be kept in place if you prefer a one-column appendix, or can be removed if you prefer a two-column appendix.  Apart from this possible change, the style (font size, spacing, margins, page numbering, etc.) should be kept the same as the main body.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}


% This document was modified from the file originally made available by
% Pat Langley and Andrea Danyluk for ICML-2K. This version was created
% by Iain Murray in 2018, and modified by Alexandre Bouchard in
% 2019 and 2021 and by Csaba Szepesvari, Gang Niu and Sivan Sabato in 2022.
% Modified again in 2023 and 2024 by Sivan Sabato and Jonathan Scarlett.
% Previous contributors include Dan Roy, Lise Getoor and Tobias
% Scheffer, which was slightly modified from the 2010 version by
% Thorsten Joachims & Johannes Fuernkranz, slightly modified from the
% 2009 version by Kiri Wagstaff and Sam Roweis's 2008 version, which is
% slightly modified from Prasad Tadepalli's 2007 version which is a
% lightly changed version of the previous year's version by Andrew
% Moore, which was in turn edited from those of Kristian Kersting and
% Codrina Lauth. Alex Smola contributed to the algorithmic style files.
