\begin{proof}[Proof of Lemma~\ref{lemma:b1}]
Using the update Eq.~\ref{eq:partial-LSGD}, we have 
\begin{equation}
\small
\label{eq:b0}
\begin{split}
||\Bar{w}_{r+1}-w^*||^2=&||\Bar{w}_r-\eta_rg_r-w^*-\eta_r\Bar{g}_r+\eta_r\Bar{g}_r||^2\\
    =&||\Bar{w}_r-\eta_r\Bar{g}_r-w^*||^2+\eta_r^2||g_r-\Bar{g}_r||^2\\
    &+2\eta_r\langle\Bar{w}_r-w^*-\eta_r\Bar{g}_r,g_r-\Bar{g}_r\rangle.
\end{split}
\end{equation}
By $L$-smoothness and $\mu$-strong convexity of $f$, the first term is bounded as 
\begin{equation}
\small
\label{eq:b1}
\begin{split}
    &||\Bar{w}_r-\eta_r\Bar{g}_r-w^*||^2=||\Bar{w}_r-w^*||^2+\eta_r^2||\Bar{g}_r||^2-2\langle\Bar{w}_r-w^*,\eta_r\Bar{g}_r\rangle\\
    &\leq ||\Bar{w}_r-w^*||^2+\eta_r^2\frac{1}{M}\sum_{k=1}^K||\nabla f(w_r^k)||^2\\
    &-\frac{2\eta_r}{M}\sum_{k=1}^K\langle\Bar{w}_r-w^k_r+w^k_r-w^*,\nabla f(w_r^k)\rangle\\
    &=||\Bar{w}_r-w^*||^2+\eta_r^2\frac{1}{M}\sum_{k=1}^K||\nabla f(w_r^k)-\nabla f(w^*)||^2\\
    &-\frac{2\eta_r}{M}\sum_{k=1}^K\langle w^k_r-w^*,\nabla f(w_r^k)\rangle-\frac{2\eta_r}{M}\sum_{k=1}^K\langle\Bar{w}_r-w^k_r,\nabla f(w_r^k)\rangle\\
\end{split}
\end{equation}
By $L$-smoothness,
\begin{equation}
\small
    ||\nabla f(w_r^k)-\nabla f(w^*)||^2\leq2L(f(w_r^k)-f^*)
\end{equation}
By $\mu$-strong convexity
\begin{equation}
\small
    -\langle w_r^k-w^*,\nabla f(w_r^k)\rangle\leq-(f(w_r^k)-f^*)-\frac{\mu}{2}||w_r^k-w^*||^2
\end{equation}
To estimate the last term in (\ref{eq:b1}), we use $2\langle a,b\rangle\leq\gamma||a||^2+\gamma^{-1}||b||^2$ for $\gamma>0$,
\begin{equation}
\small
\label{eq:b2}
\begin{split}
    &-2\langle\Bar{w}_t-w_r^k,\nabla f(w_r^k)\rangle\leq2L||\Bar{w}_r-w_r^k||^2+\frac{1}{2L}||\nabla f(w_r^k)||^2\\
    &=2L||\Bar{w}_r-w_r^k||^2+\frac{1}{2L}||\nabla f(w_r^k)-\nabla f(w^*)||^2\\
    &\leq2L||\Bar{w}_r-w_r^k||^2+(f(w_r^k)-f^*)
\end{split}
\end{equation}
By applying these estimates to (\ref{eq:b1}) we get
\begin{equation}
\small
\label{eq:b3}
    \begin{split}
        &||\Bar{w}_r-w^*-\eta_r\Bar{g}_r||^2\leq||\Bar{w}_r-w^*||^2+\frac{2\eta_rL}{M}\sum_{k=1}^K||\Bar{w}_r-w_r^k||^2\\
        &+\frac{2\eta_r}{M}\sum_{k=1}^K((\eta_rL-\frac{1}{2})(f(w_r^k)-f^*)-\frac{\mu}{2}||w_r^k-w^*||^2)
    \end{split}
\end{equation}
For $\eta_r\leq \frac{1}{4L}$ it holds $(\eta_rL-\frac{1}{2})\leq -\frac{1}{4}$. By convexity of $a(f(w)-f^*)+b||w-w^*||^2$ for $a,b\geq0$,
\begin{equation}
\small
    \begin{split}
        &-\frac{1}{M}\sum_{k=1}^K(a(f(w_r^k)-f^*)+b||w_r^k-w^*||^2)\\
        &\leq-(a(f(\Bar{w}_r)-f^*)+b||\Bar{w}_r-w^*||^2).
    \end{split}
\end{equation}
Hence, we can continue in (\ref{eq:b3}) and obtain
\begin{equation}
\small
\label{eq:b4}
    \begin{split}
        &||\Bar{w}_r-w^*-\eta_r\Bar{g}_r||^2\leq(1-\mu\eta_r)||\Bar{w}_r-w^*||^2\\
        &-\frac{1}{2}\eta_r(f(\Bar{w}_r)-f^*)+\frac{2\eta_rL}{M}\sum_{k=1}^K||\Bar{w}_r-w_r^k||^2
    \end{split}
\end{equation}
Finally, we can plug (\ref{eq:b4}) back into (\ref{eq:b0}). By taking expectation we get 
\begin{equation}
\label{eq:b5}
\small
\begin{split}
    &\mathbb{E}||\Bar{w}_{r+1}-w^*||^2\\
    \leq&(1-\mu\eta_r)\mathbb{E}||\Bar{w}_r-w^*||^2+\eta_r^2\mathbb{E}||g_r-\Bar{g}_r||^2\\
    &-\frac{1}{2}\eta_r\mathbb{E}(f(\Bar{w}_r)-f^*)+\frac{2L\eta_r }{M}\sum_{k=1}^K\mathbb{E}||\Bar{w}_r-w_{r}^{k}||^2
\end{split}
\end{equation}
\end{proof}










