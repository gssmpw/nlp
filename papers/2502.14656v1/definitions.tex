%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter
\DeclareRobustCommand\onedot{\futurelet\@let@token\@onedot}
\def\@onedot{\ifx\@let@token.\else.\null\fi\xspace}

\def\eg{e.g\onedot} \def\Eg{E.g\onedot}
\def\ie{i.e\onedot} \def\Ie{I.e\onedot}
\def\cf{cf\onedot} \def\Cf{Cf\onedot}
\def\etc{etc\onedot} \def\vs{vs\onedot}
\def\wrt{w.r.t\onedot} \def\dof{d.o.f\onedot}
\def\etal{et al\onedot}
\def\ae{a.e.\ }
\def\conf{cf\onedot}
\makeatother

\DeclareMathAlphabet\mathbfcal{OMS}{cmsy}{b}{n}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Another Retro %%%
%\definecolor{JungleGreen}{RGB}{40, 169, 143}
%\definecolor{BatteryChargedBlue}{RGB}{42, 187, 218}
%\definecolor{GargoyleGas}{RGB}{250, 213, 66}
%\definecolor{LightCarminePink}{RGB}{236, 94, 100}
%\definecolor{MaximumPurple}{RGB}{107, 57, 121}
\newcommand{\red}[1] {{\color{red}{{#1}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\notinclude}[1]{}

%%% Todo notes & comments %%%

\IfFileExists{todonotes.sty}{%
    \usepackage{todonotes}
    \usepackage{comment}
    \usepackage{setspace}
    \let\todoavailable1	
}{}%


\providecommand\MR{} % workaround because MR is also used in amsref

\ifdefined\todoavailable
    \makeatletter
    \newcommand{\inlinetodo}[2][]{%
        \@todo[caption={}, inline, #1]{#2}%
    } 
    \newcommand{\missing}[2][]{ \@todo[color=red!40, #1]{Missing: #2} }
    \newcommand{\addref}{\textcolor{red!40}{\rule{7pt}{7pt}}\todo[color=red!40]{Add reference.}} %
    %	\newcommand{\checkthis}{}
    \newcommand{\checkthis}{\textcolor{red}{$\bullet$}\todo[color=red!40]{Check this.}}
    
    \newcommand{\addfig}{Figure~\textcolor{LightCarminePink}{\rule{7pt}{7pt}} \todo[color=LightCarminePink]{Add figure.}} 
    \newcommand{\CS}[2][]{\@todo[inline,color=yellow, #1]{Christoph: #2}}
    \newcommand{\JS}[2][]{\@todo[inline,color=yellow, #1]{Josua: #2}}
    \renewcommand{\MR}[2][]{\@todo[inline,color=yellow, #1]{Martin: #2}}
    \makeatother
\else
    \newcommand{\todo}[1]{{\red{TODO: #1}}}
    \newcommand{\missing}[1]{ {\red{missing: [} #1 \red{]!!!}} }
    \newcommand{\addref}{ {\red{Add reference!}} }
    \newcommand{\addfig}{ {\red{Add figure!}} }
    \newcommand{\CS}[2][]{\red{Christoph: [} #2 \red{].}}
    \renewcommand{\MR}[2][]{\red{Martin: [} #2 \red{].}}
    \newcommand{\JS}[2][]{\red{Josua: [} #2 \red{].}}
    \newcommand{\inlinetodo}[2][]{{\red{TODO: {#2} }\hfill\\}}%
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% math definitions
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\id}{\mathrm{id}\,}
\newcommand{\tr}{\mathrm{tr}\,}
%\newcommand{\Id}{\mathds{1}}
\newcommand{\Id}{\mathrm{Id}}
%\DeclareMathOperator*{\Id}{Id}
\renewcommand{\bmod}{{\,\mathrm{mod}\,}}
\newcommand{\atan}{{\mathrm{atan}\,}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\minimize}{minimize}
\renewcommand{\d}{\,\mathrm{d}}
\newcommand{\SO}{\mathit{SO}}
\providecommand{\span}{\mathrm{span}}
\newcommand{\dist}{\mathrm{dist}}
\newcommand{\sdist}{\mathrm{sdist}}
\newcommand{\Hess}{{\mathrm{Hess}}}
\newcommand{\Hd}{\mathcal{H}}

\ifdefined\laplace
\renewcommand{\laplace}{\Delta}
\else
\newcommand{\laplace}{\Delta}
\fi
% geometry
\newcommand{\eps}{\varepsilon}
\newcommand{\mc}{{\mathbf{h}}}
\newcommand{\param}{x}

% phasefields
\newcommand{\pf}{u}
\newcommand{\Per}{\mathcal{P}}
\newcommand{\Area}{\mathcal{A}}
\newcommand{\dwell}{\Psi}
\newcommand{\Dwell}{\Psi_h}
\newcommand{\Chi}{\chi_h}
\newcommand{\J}{\mathcal{J}}
\newcommand{\E}{\mathcal{E}}

% Network
\newcommand{\kernel}{\kappa}
\newcommand{\NNkernel}{K}