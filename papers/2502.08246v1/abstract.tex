
Self-attention in transformer models is an incremental associative memory that maps key vectors to value vectors.
One way to speed up self-attention is to employ GPU-compliant vector search algorithms, yet the standard partitioning methods yield poor results in this context, because (1) keys and queries follow different distributions and (2) the effect of RoPE positional encoding. 

In this paper, we introduce \OURS{} (Self-Attention with Asymmetric Partitions), which overcomes these problems. It is an asymmetrical indexing technique that employs distinct partitions for keys and queries, thereby approximating self-attention with a data-adaptive sparsity pattern. 

It works on pretrained language models without finetuning, as it only requires to train (offline) a small query classifier. 
On a long context Llama 3.1-8b model, with sequences ranging from 100k to 500k tokens, our method typically reduces by a factor 20 the fraction of memory that needs to be looked-up, which translates to a time saving of 60\% when compared to  FlashAttention-v2. 


 %
%

%
%
%
%


%
%
%
%
%
%
%
%

