\begin{figure}
\begin{ccodebox}
\begin{lstlisting}[style=haskell]
class (Eq q, Typeable q) => Query q where
  type QResult q
  type PromptParam q
  modes :: TypeRep q -> [AnswerMode (QResult q)]
  defaultAnswer :: q -> Maybe (QResult q) ; defaultAnswer _ = Nothing
  systemPrompt :: q -> PromptParam q -> ModeName -> String
  instancePrompt :: q -> PromptParam q -> ModeName -> String

data AnswerMode v = AnswerMode { modeName :: ModeName, parse :: String -> Maybe v }
\end{lstlisting}
\end{ccodebox}
\vspace{-0.3cm}
\caption{Defining Query Types.}\label{fig:query-typeclass}
\end{figure}
