\lstdefinestyle{haskell}{
  language=Haskell,
  commentstyle=\color{comments-color},
  basicstyle=\ttfamily\small,
  showstringspaces=false,
  columns=flexible,
  keepspaces=true,
  numbersep=15pt,
  numbers=none,
  keywordstyle=,
  morekeywords={forall},
  deletekeywords={String, Maybe, return, Bool, Int, Double, msum, map, IO, mzero, mapMaybe, Monad, Just, Nothing, compare, join, Void, true},
  escapeinside={(@}{@)},
  literate=%
    {::}{{$::$}}2%
    {->}{{$\rightarrow$}}2%
    {=>}{{$\Rightarrow$}}2%
    {<-}{{$\leftarrow$}}2%
    {:=}{{$\coloneq$}}2%
    {~}{{$\sim$}}2%
}

\newcommand{\haskellInlineCode}[1]{%
\lstinline[%
  style=haskell,%
  basicstyle=\ttfamily\small,%
  literate=%
    {::}{{$\!::\!$}}2%
    {->}{{$\!\rightarrow\!$}}2%
    {<-}{{$\!\leftarrow\!$}}2%
    {:=}{{$\coloneq$}}2%
]|#1|
}

\newcommand{\haskellCode}[1]{\inlineCodeBox{\haskellInlineCode{#1}}}

\lstdefinestyle{haskellDiff}{
  style=haskell,
  morecomment=[f][\color{diff-rm-color}]{-\ \ },
  morecomment=[f][\color{diff-add-color}]{+\ \ },
}
