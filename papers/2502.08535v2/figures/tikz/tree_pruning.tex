\begin{figure}
  \centering
  \begin{tikzpicture}

    % Root
    \node (root) {root};
  
    %% Depth 1
    % Nodes
    \node [anchor=west, right=0.3cm of root, yshift=1.2cm] (1-plug-phone-tcp) {\circled{A} plug$\leftrightarrow$phone:9999 {[TCP]}};
    \node [anchor=west, right=0.3cm of root, yshift=-0.3cm] (1-plug-server-https) {\circled{B} plug$\leftrightarrow$\texttt{use1-api.tplinkra.com}:443 {[HTTPS]}};
    % Edges
    \draw (root.east) -- (1-plug-phone-tcp.west);
    \draw (root.east) -- (1-plug-server-https.west);
  
    %% Children of 1-plug-phone-tcp
    \node [below=0.5cm of 1-plug-phone-tcp.west, anchor=west, xshift=0.5cm] (A1) (2-plug-server-https) {\circled{C} plug$\leftrightarrow$\texttt{use1-api.tplinkra.com}:443 {[HTTPS]} \xmark};
    \node [below=0.5cm of 2-plug-server-https.west, anchor=west] (2-plug-phone-udp_A) {\circled{D} plug$\leftrightarrow$phone:9999 {[UDP]}};
    \draw ([xshift=0.3cm,yshift=-2.5mm]1-plug-phone-tcp.west) |- (2-plug-server-https.west);
    \draw ([xshift=0.3cm,yshift=-5mm]1-plug-phone-tcp.west) |- (2-plug-phone-udp_A.west);

    %% Children of 1-plug-server-https
    \node [below=0.5cm of 1-plug-server-https.west, anchor=west, xshift=0.5cm] (2-plug-phone-tcp) {\circled{E} plug$\leftrightarrow$phone:9999 {[TCP]} \xmark};
    \node [below=0.5cm of 2-plug-phone-tcp.west, anchor=west] (2-plug-phone-udp_B) {\circled{F} plug$\leftrightarrow$phone:9999 {[UDP]} \xmark};
    \draw ([xshift=0.3cm,yshift=-2.5mm]1-plug-server-https.west) |- (2-plug-phone-tcp.west);
    \draw ([xshift=0.3cm,yshift=-5mm]1-plug-server-https.west) |- (2-plug-phone-udp_B.west);
  
  \end{tikzpicture}
  \caption{\emph{Node pruning}. The nodes \circled{C}, \circled{E}, and \circled{F} are not further explored in the BFS traversal because nodes with the same Flow ID have been already seen (nodes \circled{B}, \circled{A}, and \circled{D}, respectively).}
  \label{fig:tree-pruning}
\end{figure}
