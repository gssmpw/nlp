\begin{figure}
  \centering
  \begin{tikzpicture}

    % Root
    \node (root) {root};
  
    %% Depth 1
    % Nodes
    \node [anchor=west, right=0.4cm of root, yshift=-0.25cm] (D) {\circled{D} phone$\rightarrow$broadcast(\texttt{255.255.255.255}):9999 {[UDP]}};
    \node [above=0.5cm of D.west,anchor=west] (C) {\circled{C} phone$\rightarrow$mDNS(\texttt{224.0.0.251}):5353 {[UDP / mDNS]}};
    \node [above=0.5cm of C.west,anchor=west] (B) {\circled{B} phone$\leftrightarrow$plug:9999 {[UDP]}};
    \node [above=1.5cm of B.west,anchor=west] (A) {\circled{A} phone$\leftrightarrow$plug:9999 {[TCP]}};
    \node [below=1.5cm of D.west,anchor=west] (E) {\circled{E} phone$\leftrightarrow$\texttt{xx-device-telemetry}...:443 {[HTTPS]}};
    \node [below=0.5cm of E.west,anchor=west] (F) {\circled{F} plug$\leftrightarrow$gateway:53 {[UDP / DNS: A \emph{tplinkapi}]}};
    \node [below=0.5cm of F.west,anchor=west] (G) {\circled{G} plug$\leftrightarrow$\texttt{use1-api.tplinkra.com}:443 {[HTTPS]}};
    % Edges
    \draw (root.east) -- (A.west);
    \draw (root.east) -- (B.west);
    \draw (root.east) -- (C.west);
    \draw (root.east) -- (D.west);
    \draw (root.east) -- (E.west);
    \draw (root.east) -- (F.west);
    \draw (root.east) -- (G.west);
  
    %% Children of A
    \node [below=0.5cm of A.west, anchor=west, xshift=0.5cm] (A1) {plug$\leftrightarrow$\texttt{79.125.56.92}:443 {[HTTPS]}};
    \node [below=0.5cm of A1.west, anchor=west] (A2) {phone$\leftrightarrow$\texttt{n-wap.tplinkcloud.com}:443 {[HTTPS]}};
    \draw ([xshift=0.3cm,yshift=-2.5mm]A.west) |- (A1.west);
    \draw ([xshift=0.3cm,yshift=-0.5cm]A.west) |- (A2.west);
  
    %% Children of D
    \node [below=0.5cm of D.west, anchor=west, xshift=0.5cm] (D1) {plug$\leftrightarrow$\texttt{34.240.186.173}:443 {[HTTPS]}};
    \node [below=0.5cm of D1.west, anchor=west, xshift=0.5cm] (D2) {plug$\leftrightarrow$\texttt{n-devs.tplinkcloud.com}:443 {[HTTPS]}};
    \draw ([xshift=0.3cm,yshift=-2.5mm]D.west) |- (D1.west);
    \draw ([xshift=0.3cm,yshift=-2mm]D1.west) |- (D2.west);
  
    \end{tikzpicture}
  \caption{Event signature tree for the TP-Link HS110's \emph{toggle} event. Bidirectional flows are represented by a double-headed arrow, whilst a single-headed arrow is used for unidirectional flows. When indicated, the port is associated with its host.} 
  \label{fig:device-tree}
\end{figure}