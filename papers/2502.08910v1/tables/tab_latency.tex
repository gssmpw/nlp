\begin{table*}[t]
\centering

\resizebox{1.0\linewidth}{!}{
\setlength{\tabcolsep}{4.5pt}
\begin{tabular}{lrrrrrrrrrrrrrrrrrr}\toprule
\multicolumn{2}{c}{} &\multicolumn{8}{c}{Prefill (ms)} &\multicolumn{8}{c}{Decode (us)} \\\cmidrule(lr){3-10} \cmidrule(lr){11-18}
\multicolumn{2}{r}{T (k)} &32 &64 &128 &256 &384 &512 &768 &1024 &32 &64 &128 &256 &384 &512 &768 &1024 \\\midrule
\multicolumn{2}{l}{FA2 (1M window)} &\cellcolor[HTML]{00b1b0}54.6 &\cellcolor[HTML]{27b4a1}163 &\cellcolor[HTML]{77bb82}379 &\cellcolor[HTML]{fec74e}821 &\cellcolor[HTML]{febb53}1267 &\cellcolor[HTML]{feb059}1711 &\cellcolor[HTML]{fe9a64}2602 &\cellcolor[HTML]{ff8370}3490 &\cellcolor[HTML]{24b4a2}213 &\cellcolor[HTML]{51b891}375 &\cellcolor[HTML]{9cbf73}643 &\cellcolor[HTML]{fec54e}1193 &\cellcolor[HTML]{feba54}1787 &\cellcolor[HTML]{feaf59}2325 &\cellcolor[HTML]{fe9a64}3457 &\cellcolor[HTML]{ff8370}4645 \\
\multicolumn{2}{l}{InfLLM (12K)} &\cellcolor[HTML]{23b4a3}150 &\cellcolor[HTML]{2db59f}178 &\cellcolor[HTML]{2db59f}178 &\cellcolor[HTML]{2eb59f}179 &\cellcolor[HTML]{2eb59e}180 &\cellcolor[HTML]{2eb59e}181 &\cellcolor[HTML]{2fb59e}182 &\cellcolor[HTML]{2fb59e}183 &\cellcolor[HTML]{eec654}936 &\cellcolor[HTML]{fec64e}1145 &\cellcolor[HTML]{fec54e}1157 &\cellcolor[HTML]{fec54e}1174 &\cellcolor[HTML]{fec54e}1167 &\cellcolor[HTML]{fec54e}1182 &\cellcolor[HTML]{fec54f}1203 &\cellcolor[HTML]{fec44f}1222 \\
\multicolumn{2}{l}{HiP (1K)} &\cellcolor[HTML]{05b1af}68.5 &\cellcolor[HTML]{0fb2ab}95.6 &\cellcolor[HTML]{14b2a9}109 &\cellcolor[HTML]{18b3a7}122 &\cellcolor[HTML]{1db3a5}135 &\cellcolor[HTML]{1db3a5}135 &\cellcolor[HTML]{22b4a3}147 &\cellcolor[HTML]{22b4a3}147 &\cellcolor[HTML]{45b795}330 &\cellcolor[HTML]{4bb793}352 &\cellcolor[HTML]{51b891}376 &\cellcolor[HTML]{58b98e}399 &\cellcolor[HTML]{5fb98b}423 &\cellcolor[HTML]{5fb98b}423 &\cellcolor[HTML]{65ba89}446 &\cellcolor[HTML]{66ba89}450 \\
\cdashline{1-14}[0.5pt/1pt]\rule{0pt}{2.6ex}%
\multirow{7}{*}{\makecell[l]{\textbf{Ours}\\(3K)}} &Total &\cellcolor[HTML]{03b1af}63.5 &\cellcolor[HTML]{08b1ad}78.3 &\cellcolor[HTML]{0bb1ac}84.5 &\cellcolor[HTML]{0fb2aa}96.7 &\cellcolor[HTML]{14b2a9}109 &\cellcolor[HTML]{18b3a7}122 &\cellcolor[HTML]{22b4a3}147 &\cellcolor[HTML]{2bb4a0}172 &\cellcolor[HTML]{00b1b0}81.0 &\cellcolor[HTML]{00b1b0}83.5 &\cellcolor[HTML]{02b1b0}89.5 &\cellcolor[HTML]{06b1ae}103 &\cellcolor[HTML]{0cb2ac}124 &\cellcolor[HTML]{14b2a9}154 &\cellcolor[HTML]{1fb3a4}195 &\cellcolor[HTML]{2ab4a0}234 \\
&Total (AR) &- &- &- &- &- &- &- &- &409 &395 &425 &471 &539 &559 &696 &936 \\
&Stage 0 (\%) &3.3 &6.2 &12.6 &22.9 &30.8 &37.2 &46.7 &53.7 &7.4 &8.4 &10.5 &14.7 &22.5 &24.9 &29.5 &28.2 \\
&Stage 1 (\%) &13.8 &20.1 &18.8 &16.4 &14.4 &13.0 &10.8 &9.2 &7.9 &7.7 &7.7 &8.3 &7.7 &7.0 &5.2 &4.0 \\
&Stage 2 (\%) &33.5 &28.8 &26.8 &23.4 &20.7 &18.6 &15.4 &13.1 &11.6 &11.9 &11.5 &10.6 &9.5 &8.9 &7.1 &5.3 \\
&BSA (\%) &38.9 &30.7 &28.4 &24.8 &21.9 &19.7 &16.4 &13.9 &4.0 &4.0 &4.6 &4.8 &4.0 &3.7 &2.9 &2.2 \\
&Extra (\%) &10.6 &14.2 &13.4 &12.6 &12.2 &11.5 &10.7 &10.1 &69.2 &68.1 &65.7 &61.6 &56.4 &55.5 &55.3 &60.3 \\
\cdashline{1-14}[0.5pt/1pt]\rule{0pt}{2.6ex}%
\multirow{7}{*}{\makecell[l]{\textbf{Ours}\\with\\Extend\\(3K)}} &Total &\cellcolor[HTML]{11b2aa}103 &\cellcolor[HTML]{1bb3a6}128 &\cellcolor[HTML]{1eb3a5}138 &\cellcolor[HTML]{26b4a2}158 &\cellcolor[HTML]{2db59f}178 &\cellcolor[HTML]{34b59c}197 &\cellcolor[HTML]{43b796}236 &\cellcolor[HTML]{51b891}276 &\cellcolor[HTML]{02b1b0}89.8 &\cellcolor[HTML]{03b1af}91.9 &\cellcolor[HTML]{04b1af}98.0 &\cellcolor[HTML]{08b1ad}111 &\cellcolor[HTML]{0eb2ab}133 &\cellcolor[HTML]{16b3a8}163 &\cellcolor[HTML]{22b4a3}205 &\cellcolor[HTML]{2db59f}245 \\
&Total (AR) &- &- &- &- &- &- &- &- &425 &432 &462 &520 &577 &617 &842 &992 \\
&Stage 0 (\%) &3.4 &6.2 &12.6 &22.9 &31.0 &37.4 &47.1 &53.9 &6.5 &7.1 &9.5 &16.5 &22.2 &26.8 &28.9 &31.9 \\
&Stage 1 (\%) &16.9 &22.1 &20.6 &17.9 &15.8 &14.3 &11.9 &10.3 &14.5 &14.7 &14.2 &12.6 &11.2 &10.5 &7.8 &6.7 \\
&Stage 2 (\%) &32.3 &28.2 &26.1 &22.7 &20.2 &18.3 &15.2 &13.1 &11.9 &11.8 &11.1 &9.9 &8.8 &8.3 &6.0 &5.2 \\
&BSA (\%) &44.4 &34.8 &32.3 &28.3 &25.1 &22.7 &18.9 &16.2 &4.3 &4.6 &5.1 &5.2 &4.6 &4.1 &2.9 &2.5 \\
&Extra (\%) &3.0 &8.6 &8.4 &8.2 &8.0 &7.3 &6.9 &6.5 &62.8 &61.7 &60.1 &55.9 &53.3 &50.3 &54.4 &53.7 \\
\bottomrule
\end{tabular}
}

\caption{
\textbf{Attention Latency Comparison between \ours and Baselines.} Prefill latency is measured with chunked prefill style attention, with a chunk size of 32K. In our rows, \textit{Total} means the average latency of the attention mechanism, \textit{Total (AR)} means the decoding latency without any mask caching mechanism, which is always a mask refreshing scenario, \textit{Stage X} means the latency of X'th pruning stage, \textit{BSA} means the latency of block sparse attention. Ours uses the 3K preset from \cref{tab:infbench}.
}
\label{tab:latency}
\end{table*}
