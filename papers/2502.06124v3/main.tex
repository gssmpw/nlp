\documentclass{article}

\usepackage{arxiv}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{nicefrac}     
\usepackage{microtype} 
\usepackage{graphicx}
\usepackage{doi}
\usepackage{authblk}
\usepackage{chngcntr}
\usepackage{makecell}
\usepackage{longtable}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage[style=numeric,sorting=none]{biblatex}

\addbibresource{main.bib}

\title{Foundation Model of Electronic Medical Records for Adaptive Risk Estimation}

\author[1,2,3]{Pawel Renc}
\author[1,2]{Michal K. Grzeszczyk}
\author[4]{Nassim Oufattole}
\author[5,2]{Deirdre Goode}
\author[4]{Yugang Jia}
\author[6]{Szymon Bieganski}
\author[2]{Matthew B. A. McDermott}
\author[3]{Jaroslaw Was}
\author[7,2]{Anthony E. Samir}
\author[8,2]{Jonathan W. Cunningham}
\author[8,9,2]{David W. Bates}
\author[1,2,*]{Arkadiusz Sitek}

\affil[1]{CAMCA, Massachusetts General Hospital, Boston, USA}
\affil[2]{Harvard Medical School, Boston, USA}
\affil[3]{AGH University of Krakow, Krakow, Poland}
\affil[4]{Massachusetts Institute of Technology, Cambridge, USA}
\affil[5]{Newton Wellesley Hospital, Newton, USA}
\affil[6]{Medical University of Lodz, Lodz, Poland}
\affil[7]{CURT, Massachusetts General Hospital, Boston, USA}
\affil[8]{Brigham and Women’s Hospital, Boston, USA}
\affil[9]{Harvard Chan School of Public Health, Boston, USA}
\affil[*]{\textit{Corresponding author: sarkadiu@gmail.com}}

\date{\vspace{-2em}\today}


\renewcommand{\headeright}{}
\renewcommand{\undertitle}{preprint (under review)}
\renewcommand{\shorttitle}{Foundation Model of EMR for Adaptive Risk Estimation}

\begin{document}
\maketitle

\begin{abstract}
\textbf{Background,} The U.S. allocates nearly 18\% of its GDP to healthcare but experiences lower life expectancy and higher preventable death rates compared to other high-income nations. Hospitals struggle to predict critical outcomes such as mortality, ICU admission, and prolonged hospital stays. Traditional early warning systems, like NEWS and MEWS, rely on static variables and fixed thresholds, limiting their adaptability, accuracy, and personalization; \textbf{Methods,} We developed the Enhanced Transformer for Health Outcome Simulation (ETHOS), an AI model that tokenizes patient health timelines (PHTs) from EHRs and uses transformer-based architectures to predict future PHTs. The Adaptive Risk Estimation System (ARES) leverages ETHOS to compute dynamic, personalized risk probabilities for clinician-defined critical events. ARES also features a personalized explainability module that highlights key clinical factors influencing risk estimates. We evaluated ARES on the MIMIC-IV v2.2 dataset in emergency department settings, benchmarking its performance against traditional early warning systems and machine learning models; \textbf{Results,} From 299,721 unique patients, 285,622 PHTs (60\% with hospital admissions) were processed, comprising over 357 million tokens. ETHOS outperformed benchmark models in predicting hospital admissions, ICU admissions, and prolonged stays, achieving superior AUC scores. Its risk estimates were robust across demographic subgroups, with calibration curves confirming model reliability. The explainability module provided valuable insights into patient-specific risk factors; \textbf{Conclusions,} ARES, powered by ETHOS, advances predictive healthcare AI by delivering dynamic, real-time, personalized risk estimation with patient-specific explainability. Its adaptability and accuracy offer a transformative tool for clinical decision-making, potentially improving patient outcomes and resource allocation. We release the full code at \url{github.com/ipolharvard/ethos-ares} to facilitate future research.

\end{abstract}


% keywords can be removed
%\keywords{Healthcare \and Deep Learning \and Transformer \and Timelines}

\clearpage

\section{Introduction}

The United States allocates nearly 18 percent of its GDP to healthcare, yet Americans have shorter lifespans and poorer health than residents of other high-income nations. Among these countries, the U.S. not only has the lowest life expectancy but also the highest rates of preventable deaths~\cite{Gunja2023-pk}. Hospitals face mounting challenges managing patient influx and identifying individuals at risk for critical outcomes, including mortality, intensive care unit (ICU) admission, or prolonged hospital stays~\cite{Committee-on-the-Future-of-Emergency-Care-in-the-United-States-Health-System2007-ml}. Accurate prediction of critical clinical events is essential for enhancing patient care and optimizing the timely allocation of limited healthcare resources~\cite{Yang2016-ip}. Early identification of at-risk patients enables clinicians to prioritize interventions, anticipate potential escalations in care, and improve outcomes while simultaneously reducing costs~\cite{Horton2020-nz,Adams2022-bd}. However, current methodologies often fail to fully utilize the vast and complex data available in electronic health records (EHRs), a limitation that becomes particularly evident in emergency settings where time-sensitive decisions are critical~\cite{Edelson2024-rz,Gerry2020-ka,Winslow2022-yw,Escobar2020-jd,Cummings2023-yl}. Traditional scoring systems, such as the National Early Warning Score (NEWS)~\cite{Williams2022-ah} and the Modified Early Warning Score (MEWS)~\cite{Subbe2001-jx}, rely on static variables and predefined thresholds, constraining their ability to adapt to dynamic and multifaceted patient data. Similarly, conventional machine learning models depend on preselected predictors of patient deterioration, requiring the inclusion of only a limited number of variables. These approaches are further hindered by their reliance on specific cutoff points for data inclusion (e.g., triage, 24-hour windows), which can overlook valuable longitudinal patterns.

Recent advances in generative machine learning, particularly in transformer architectures~\cite{Vaswani2017-of,Renc2024-jf,Yang2023-ic,Li2023-lv}, which underpin the success of Large Language Models (LLMs)~\cite{Luo2024-bw,Thirunavukarasu2023-nh}, have unlocked unprecedented capabilities for processing high-dimensional, heterogeneous, time-stamped, and episodic health data derived from electronic health records (EHRs)~\cite{Renc2024-jf,Kraljevic2024-fj,McDermott2023-zd,Steinberg2023-zx,Li2020-se,Jeong2023-hy}. In this work, we build on our previous development, the Enhanced Transformer for Health Outcome Simulation (ETHOS)~\cite{Renc2024-jf}. While our approach shares some similarities with the works of~\cite{McDermott2023-zd} or~\cite{Kraljevic2024-fj} it differs in how EHR data are encoded and processed by the transformer model. ETHOS is designed to provide zero-shot predictions; once the model is trained, no additional fine-tuning is required to make inferences. The model operates on Patient Health Timelines (PHTs), which are tokenized sequences of events extracted from EHRs, including demographics, medical history, medications, and more (the full list is provided in ~\autoref{tab:data-sources}). Using known PHTs up to a given point in time, ETHOS predicts future PHTs (\autoref{fig:workflow}). ETHOS enables dynamic, real-time risk assessment by computing a range of possible Patient Health Timelines (PHTs) for a defined outcome, such as ICU admission. If the probability of an adverse event exceeds a critical threshold, appropriate interventions can be initiated to mitigate risk. This continuous probability estimation functions as an early warning system, similar to an experienced physician’s intuition in identifying high-risk patients. Unlike traditional models that require predefined inference tasks, ETHOS operates as a single, unified model, allowing for the simultaneous assessment of multiple positive and negative outcomes without retraining. Probabilities for various clinical events are dynamically updated as new patient data becomes available, ensuring adaptability throughout the care process. We refer to this flexible and scalable risk prediction framework as the Adaptive Risk Estimation System (ARES), as illustrated in~\autoref{fig:ares}.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{figure1.pdf}
    \caption{\textbf{Workflow of the Adaptable Risk Estimation Score (ARES) Framework.} This figure illustrates the ARES framework, developed on the ETHOS model, for dynamic and explainable risk evaluation. Panel 1 depicts the tokenization of a patient’s entire health history into structured events represented as a sequence of tokens (PHTs), incorporating standardized coding systems such as ATC for medications, ICD-PCS for procedures, and others. Panel 2 demonstrates how the ETHOS model trained on a large dataset of PHTs to simulate potential future patient health timelines (fPHTs). By analyzing a particular patient’s known PHT and generating multiple fPHTs, the model estimates the probabilities of critical outcomes, such as inpatient death, ICU admission, or a prolonged hospital stay exceeding 10 days. Panel 3 showcases the result of processing of fPHTs to calculate event-specific risks and predict the timing of these events, should they occur. Risk levels are defined across five categories, color-coded for enhanced clinical interpretability. Panel 4 showcases the explainability module, which identifies the key factors influencing specific risk estimates, offering personalized and actionable insights to support clinical decision-making. In this example, blue tokens indicate factors contributing to an increased risk of ICU admission.}
    \label{fig:workflow}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{figure2.pdf}
    \caption{\textbf{Timeline of a Patient's Hospital Stay and Hypothetical Risk Predictions by ARES.} This figure illustrates the timeline of a patient’s hospital stay, from admission to discharge around Day 14, demonstrating how ARES dynamically adjusts its predictions based on the patient’s evolving clinical status and medical history. By Day 5, ARES predicts a high risk of ICU admission, which is subsequently confirmed as the patient is admitted around Day 6. Once the patient is in the ICU, ARES discontinues ICU risk evaluation, as indicated by the “Deactivated Component” label. After the ICU stay, ARES identifies an increased likelihood of a hospital stay exceeding 10 days. Upon reaching the 10-day threshold, ARES automatically recalibrates its predictions, replacing the previous risk estimation with the likelihood of a 15-day stay, now categorized as a “New Component” in the risk assessment.}
    \label{fig:ares}
\end{figure}

In this paper, we present the development of ARES and introduce a novel explainability framework that delivers fully personalized insights, allowing clinicians to understand the specific factors influencing the system’s risk predictions for individual patients. We benchmark the performance of ARES against state-of-the-art methods across multiple clinically relevant tasks, demonstrating its superior predictive accuracy. Using Emergency Department (ED) datasets from MIMIC-IV-ED~\cite{Johnson2023-cv,Johnson2023-ue,Goldberger2000-tp}, we validate its effectiveness and provide the accompanying code for the full reproduction of all the experiments by other researchers.

\section{Methods}

\subsection{Data}

In this study, we used the Medical Information Mart for Intensive Care (MIMIC-IV) version 2.2 database~\cite{Johnson2023-cv,Johnson2023-ue}, including its ED extension. MIMIC-IV, developed by the Massachusetts Institute of Technology and Beth Israel Deaconess Medical Center contains de-identified health records for almost 300,000 patients either admitted to the ED and/or hospital at BIDMC from 2008 to 2019. Detailed patient demographics are presented in~\autoref{tab:population-demographics}. We extracted relevant data from the MIMIC-IV tables as detailed in~\autoref{tab:data-sources}. Laboratory tests and medications were standardized using ATC codes, and all diagnostic and procedural codes were mapped to ICD-10 when necessary, as described in detail~\cite{Renc2024-jf}. Additional tables requiring advanced processing, such as clinical notes, were not included in the current implementation of ETHOS.

\subsection{Tokenization, PHT Construction, model training}

The core of ETHOS lies in constructing PHTs from electronic medical records (EMRs) using a tokenization strategy that captures diverse clinical events. A PHT represents a patient's medical history as a sequence of tokens, each encoding specific health-related information organized chronologically. This structured representation enables comprehensive modeling of patient journeys and more accurate clinical predictions.  To build PHTs we used the MEDS-DEV~\cite{UnknownUnknown-ib} extraction pipeline that converts EHR data to an intermediate format called MEDS~\cite{Arnrich2024-rc} to facilitate further data transformations. Advanced transformation operations were subsequently applied, breaking down each event into 1 to 7 tokens based on its complexity. Simpler events required fewer tokens, while intricate ones, such as multi-component lab results, were represented with more tokens to encapsulate their detailed information.

For example, lab test results were encoded using quantile-based tokens to represent clinical significance. Time-interval tokens were added to mark the elapsed time between successive events, with intervals shorter than 5 minutes omitted and longer gaps tokenized into 19 distinct interval tokens. Continuous numerical values, such as lab test results, were similarly quantile-encoded using ten quantiles, balancing clinical interpretability and predictive precision. Diagnostic and procedural codes, including ICD-10-CM, ICD-10-PCS, and ATC drug codes, were encoded hierarchically, which leveraged their inherent structure to enhance the transformer model's attention mechanisms. For more details, refer to~\cite{Renc2024-jf}.

Static patient attributes such as gender, marital status, race, and body mass index (BMI) were encoded using a single token depending on the value. For age, tokens of quantiles were reused, allowing age representation from 0 to 99. For instance, a 46-year-old patient would be coded as Q5 and Q7. Attributes with potential variability were represented using their most recently known value at the start of the timeline. By incorporating these elements, ETHOS ensured a richer and more adaptable representation of patient timelines.

The dataset was split into two disjoint groups: training/validation (90\%) and testing (10\%). During the training phase, 6 million tokens (1.8\% of the entire dataset) were used for validation to balance model optimization and computational efficiency. The detailed statistics about the tokenized dataset are available in~\autoref{tab:simple-pht-stats} and~\ref{tab:detailed-token-stats}, and information about the model is in~\ref*{fig:model-info}.


\subsection{Probabilistic inference}

The ETHOS model generates probabilities of future clinical events by leveraging tokenized PHTs and employing a transformer-based generative model. During inference, ETHOS autoregressively generates tokens, each representing a potential future event, until predefined stopping conditions are met, such as the appearance of a token of interest or meeting the simulation time limit. By simulating multiple future PHTs (fPHTs) for each patient, ETHOS accounts for inherent uncertainties and produces robust probabilistic predictions. For example, if N simulated fPHTs are generated and M indicates inpatient mortality, the estimated probability of mortality is calculated as M/N (\hyperref[sec:monte-carlo-just]{Appendix~\ref*{sec:monte-carlo-just}}). This stochastic, scenario-based methodology enables comprehensive modeling of patient trajectories, facilitating precise and dynamic risk assessments tailored to individual patient profiles.

\subsection{Explainability}

As illustrated in~\autoref{fig:ares-timeline}, stochastic simulations can be initiated not only from the most recent token representing current information but also from any preceding token in the patient’s history. This allows risk estimates to be visualized as a time series, highlighting how specific medical events affect risk over time. This approach provides intuitive visualizations, offering clinicians clear insights into the factors contributing to current risk values. 

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{figure4.pdf}
    \caption{\textbf{ARES Risk Trajectories.} This figure illustrates risk trajectories for nearly 1000 tokens preceding patient death, as monitored by ARES, which evaluates the probability of death, ICU admission, prolonged hospital stay, and a composite risk score. The lower panel provides a color-coded representation of risk with the actual time since the ED presentation. In contrast, the upper panel highlights three 5-token regions influencing risk predictions at areas marked by the thin gray bar. In the first region, token LAB-50813 (Lactate Blood Test) increases the composite risk score from 0.41 to 0.56, but since the result falls in Q9 (80–90th percentile), ETHOS downgrades the risk estimate back to the previous level. In the second region (close to the end), a sharp increase in composite risk occurs due to heightened ICU admission triggered by ICD-PCS code 0BH17EZ, which is coded by 7 tokens (only 5 visible), which represents Endotracheal Airway Insertion into the Trachea via Natural or Artificial Opening. The 'H' token specifically signals ETHOS to escalate the ICU risk to nearly 1.0, indicating that the patient is being intubated de novo. The ICD-10-PCS breakdown confirms the procedure as a respiratory intervention involving tracheal insertion via a natural or artificial opening. ICD-PCS 0BH17EZ does not increase the risk of death, but the next ICD-PCS 5A12012 (5 tokens coding A1202 visible) raises the risk of death to about 0.25. We note that an increased risk of death is associated with a decreased risk of ICU admission, as these are competing risks. This visualization demonstrates how ARES dynamically adjusts risk scores based on evolving patient data, integrating clinical trajectories into real-time risk assessment.}
    \label{fig:ares-timeline}
\end{figure}

\subsection{Methods used for benchmarking}

We followed benchmarking tasks for emergency department models presented in the Emergency Department MIMIC-IV-ED benchmark paper~\cite{Xie2022-ur}. Three tasks were defined: prediction of the hospital admission at triage, prediction of the critical outcome (death or transfer to ICU within 12 hours) at triage, and ED re-presentation within 72 hours after discharge from ED. We applied machine learning methods (logistic regression, random forest, gradient boosting), scoring systems MEWS~\cite{Subbe2001-jx}, NEWS~\cite{Williams2022-ah,Smith2013-jz,Zhang2025-gp}, Rapid Emergency Medicine Scores (REMS)~\cite{Olsson2004-zw}, Cardiac Arrest Risk Triage (CART)~\cite{Churpek2012-ie}, five-level triage system Emergency Severity Index (ESI)~\cite{Eitel2003-nq} and neural networks-based models including multilayer perceptron, Med2Vec~\cite{Choi2016-fe} and Long Short-Term Memory (LSTM)~\cite{Hochreiter1997-af}.

To compare tasks used for early warning scores, we compared the MEDS-Tab library~\cite{Oufattole2024-uy} which was used to establish a baseline. MEDS-Tab converts time-series EHR data into a tabular format by aggregating features across multiple time windows. It takes longitudinal patient data and applies various aggregation functions (like sum, count, min, max) over different historical window sizes to create fixed-size feature vectors, where each feature represents a combination of a medical code, time window, and aggregation method. XGBoost~\cite{Chen2016-tf} models are trained on these tabular features computed from data windows prior to each prediction time point for each clinical task.

\subsection{Statistical Methods}

The performance of predictive models was evaluated using Receiver Operating Characteristic (ROC) curves and corresponding Area Under the Curve (AUC) values. Bootstrapping techniques were employed to estimate 95\% confidence intervals (CIs) for AUCs. Model predicted probabilities were compared with observed event frequencies using calibration curves to evaluate ETHOS's reliability and alignment with real-world clinical outcomes. All statistical analyses were conducted using Python-based libraries, including scipy and scikit-learn~\cite{Virtanen2020-rd,Pedregosa2011-pl}. Data visualization, including ROC curves, calibration plots, and other statistical figures, was performed using matplotlib, seaborn and altair.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{figure3.pdf}
    \caption{\textbf{AUC Comparison Between ETHOS and MEDS-Tab Across Demographic Subgroups and Prediction Tasks.} AUC scores with 95\% confidence intervals are shown for ETHOS (orange) and MEDS-Tab (gray) across four prediction tasks: Hospital Mortality, ICU Admission, Prolonged Stay, and Composite Outcome (Hospital Mortality + ICU Admission + Prolonged Stay). Performance is reported for the overall population and stratified by gender (Female, Male) and race (Asian, Black, Hispanic, Other, Unknown, White). ETHOS consistently outperforms MEDS-Tab across all demographic subgroups and tasks.}
    \label{fig:ares-results}
\end{figure}

\section{Results}

Following the tokenization process, the data of 299,721 unique patients from the MIMIC-IV dataset was converted into 285,622 PHTs, which were subsequently used for training and testing. The discrepancy arises from some patients lacking associated data after tokenization. Of the total PHTs, approximately 60\% (180,733) contained hospital admissions records. The tokenized dataset comprised over 357 million tokens in total. Detailed information regarding the MIMIC-IV data used, patient demographics, characteristics of the PHTs and tokens, and descriptive statistics are provided in supplementary data (\autoref{tab:population-demographics},\ref{tab:data-sources},\ref{tab:simple-pht-stats},\ref{tab:detailed-token-stats}). The model was trained and validated on 90\% of the PHTs, with the remaining 10\% reserved for testing. During inference, at least 100 fPHTs were generated for each investigated task.

The predictive performance of ETHOS and MEDS-Tab was evaluated for four critical clinical outcomes: hospital mortality, ICU admission, prolonged hospital stay, and a composite risk score (HM+IA+PS). Prolonged stay was defined as a stay longer than 90th percentile of all stays. All predictions were performed at patient admission. As summarized in~\autoref{fig:ares-results}, \ref{fig:ed-bench-results}, and~\autoref{tab:ares-results}, ETHOS consistently outperformed MEDS-Tab across all outcome measures, demonstrating superior AUC values. Notably, ETHOS yielded higher AUC values across all racial groups, with the most significant improvement observed among Asian and Hispanic patients. The model's robustness across diverse populations suggests its potential for mitigating disparities in predictive accuracy.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.7\textwidth]{figure5.pdf}
    \caption{\textbf{Predictive results for the ED benchmark tasks.} Fewer methods appear in the ED re-presentation task (right) because score-based approaches, designed specifically to estimate in-hospital deterioration, are not applicable once the patient has left the ED. Ethos consistently achieves the best performance across all evaluated tasks.}
    \label{fig:ed-bench-results}
\end{figure}

\autoref{fig:ares-timeline} illustrates the dynamic risk trajectories generated by ARES, showcasing how the system continuously updates probability estimates for key clinical outcomes, including ICU admission, prolonged hospital stay, and mortality, as new clinical events occur. The figure highlights specific medical interventions, such as laboratory tests and procedures, that drive significant changes in risk estimates, demonstrating ARES’s ability to integrate evolving patient data into real-time risk assessment. The results underscore the model’s capacity to capture complex temporal relationships between clinical events, dynamically recalibrating risk scores based on patient status and treatment progression. 

In addition to risk which are part of ARES and to contextualize the predictive capabilities of ETHOS, we compared its performance against traditional early warning scores and other ML models. \autoref{fig:ed-bench-results} presents the AUC values (ROC curves in \autoref{fig:ethos-auroc}) for key ED benchmark tasks: hospitalization at triage, critical outcomes within 12 hours of triage, and ED re-presentation within 72 hours post-discharge. ETHOS demonstrated consistently superior predictive accuracy across all evaluated tasks. We provide detailed numerical values in supplementary data (\autoref{tab:ed-hospitalization},\ref{tab:ed-critical-outcome},\ref{tab:ed-representation}).

The risks provided by ETHOS were also found to be well-calibrated, as tested by calibration curves. Brier scores were found in the range 0.01-0.14 depending on the task, indicating excellent to good performances, as shown in~\autoref{fig:ethos-calibration}.

\section{Discussion}

The ARES framework introduces an innovative approach to building predictive models by leveraging cutting-edge artificial intelligence technology. Several aspects of this approach distinguish it from traditional models. First, ARES enables dynamic risk estimation at any time during a patient’s stay, from admission to discharge. Powered by ETHOS~\cite{Renc2024-jf}, ARES utilizes PHTs and incorporates all available clinical information at the time of risk estimation. Unlike traditional models, which rely on static data points such as information collected within 24 hours after admission or ED presentation or data up to triage~\cite{Xie2022-ur,Meng2022-bk}, ARES continuously adapts to the patient’s evolving clinical status. This adaptability overcomes a key limitation of static models, which may not perform optimally outside the narrow time frames for which they are designed. This capability is demonstrated in the accompanying~\autoref{fig:ares-timeline} and~\autoref{tab:timeline-examples}, which illustrate how risk evolves over time during a patient’s hospital stay. These visualizations, which depict how personalized risk evolves over time to reach the current estimates, provide insights into the specific factors driving model predictions for each patient. They highlight clinical events associated with increased or decreased risk, offering real-time explainability. By identifying the most influential features contributing to an individual’s risk assessment, ARES empowers clinicians with a clearer understanding of the rationale behind each prediction. 

As illustrated in~\autoref{fig:workflow}, ARES can estimate risk for various critical events, such as in-hospital mortality, ICU admission, and prolonged hospital stays. Beyond these standard metrics, additional indicators can be integrated seamlessly, including the risk of ICU admission during a specific length of stay, ICU readmission, acute kidney injury, sepsis, cardiac arrest, or 30-day readmission, and others. The ETHOS model, which underpins ARES, allows for the dynamic combination of these risks into composite measures while accounting for their interdependencies. For example, the occurrence of mortality on Day 8 would render the probability of a 10-day hospital stay zero. This ability to incorporate conditional and causal relationships between tracked events is another strength of ARES. Importantly, integrating additional metrics does not require model retraining or modifications to the ETHOS model. Once a range of possible future PHTs has been generated, any additional metrics can be calculated with minimal computational resources, making ARES scalable and adaptable to diverse healthcare settings. 

In its current implementation, ETHOS distills multiple fPHTs into a single predictive decision, such as inpatient mortality. However, this approach overlooks the wealth of longitudinal information contained in these trajectories, including the sequence of clinical events that lead to a particular outcome, or the absence thereof. By merely predicting the likelihood of an adverse event, valuable insights into the pathways that contribute to deterioration or recovery remain underutilized. Expanding ETHOS to provide a more granular, trajectory-based interpretation of risk would allow clinicians not only to assess a patient’s probability of experiencing a critical event but also to understand the evolving clinical course leading to that outcome including the cost. This enhanced approach would address a key limitation highlighted in the early warning paradox~\cite{Logan-Ellis2025-qr}, where models trained on retrospective data may fail to capture the full complexity of clinical interventions and their effects on patient outcomes. Moving forward, we aim to refine ETHOS to incorporate and visualize these probabilistic trajectories. This will equip clinicians with deeper, more actionable insights into clinical risk dynamics and potentially provide new information about causality in patient outcomes.

This study has limitations. ETHOS was demonstrated using PHTs derived from MIMIC-IV-ED data, and its direct applicability to data from other institutions may be limited without retraining using additional data from other institutions. Electronic medical record (EMR) systems vary significantly across institutions, influenced by differences in clinical practice, care pathways, patient populations, and geographic location. These variations can impede the direct transferability of AI models trained on one dataset to another. In certain applications, such as radiology or pathology, data inputs like medical images are relatively standardized, allowing models trained in one institution to perform well in others. However, EMR data pose unique challenges due to their variability. Models trained on data from one institution may produce inaccurate risk estimates when applied to data from another, particularly if clinical practices differ~\cite{Rajkomar2019-jk}. To mitigate this limitation, the model code for ETHOS-ARES is compatible with the MEDS~\cite{Arnrich2024-rc} health AI data standard, making it easier for other researchers to reliably train identical model architectures on their local data.

Data standardization is often proposed as a solution to address the challenges of variability in healthcare data. However, achieving meaningful standardization would require identifying commonalities between healthcare systems, an endeavor that may not be feasible given the diversity of clinical practices, patient populations, and institutional workflows. In our view, a more robust approach is to train AI models, such as ETHOS, on raw data from diverse institutions, allowing the model itself to learn and interpret the underlying patterns and clinical pathways. This approach mirrors the capability of large language models (LLMs) to discern meaning from vastly different styles of text and presentations or even different languages, leveraging the same foundational transformer architecture as ETHOS.

In summary, artificial intelligence advancements have unlocked unprecedented opportunities for innovative solutions like ARES, which leverage large amounts of heterogeneous data to develop general-purpose models with superior predictive power compared to state-of-the-art methods. ARES not only enables dynamic, personalized risk estimation but also provides real-time explainability, empowering clinicians to make more informed decisions. Furthermore, its modular design and the underlying ETHOS model allow for seamless integration of additional data types, such as radiology, genetics, and other institutional datasets, paving the way for even greater predictive accuracy and applicability in diverse healthcare settings. 

As healthcare costs and complexity continue to rise, PHT-based frameworks like ARES show a promising pathway towards data-driven AI-enabled individualized patient care with the potential to reduce morbidity, improve outcomes, and lower healthcare costs.

\section*{Acknowledgments}
We thank Kinga Renc, M.Arch, for her invaluable assistance with graphic design. This work was supported in part by National Institutes of Health (NIH) grant number HL159183. 

\printbibliography

\clearpage
\appendix

\renewcommand{\thetable}{S\arabic{table}}
\renewcommand{\thefigure}{S\arabic{figure}}
\setcounter{figure}{0}


\include{supplementary}

\end{document}