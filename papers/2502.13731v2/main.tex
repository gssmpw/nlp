\documentclass[accepted]{main} 

%
%
\usepackage[british]{babel}

%
\usepackage{natbib} %
    \bibliographystyle{plainnat}
    \renewcommand{\bibsection}{\subsubsection*{References}}
\usepackage{mathtools} %
%
\usepackage{booktabs} %
\usepackage{tikz} %

\usepackage{pgfplots}
\usepackage{caption}
\usepackage{rotating}
\usepackage{tablefootnote}
\pgfplotsset{compat=1.18}
\usepackage{circuitikz}
\usepackage{lscape}
\usepackage{amsfonts}
\usepackage{wrapfig}
\usepackage{bbm}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{diagbox}
\usepackage{booktabs}
\usepackage{times}
\usetikzlibrary{positioning}
\usepackage{subfigure}

%

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\pgfplotsset{
  every axis plot/.append style={line width=1.2pt},
  every axis plot post/.append style={
    every mark/.append style={line width=1.0pt}
  }
}

\newcommand{\jl}[1]{#1}
%
\newcommand{\np}[1]{{\color{blue!70!black}[NP:#1]}}
\newcommand{\mk}[1]{{\color{blue!40!black}[MK:#1]}}
\captionsetup[subfigure]{font=scriptsize}

\newtheorem{definition}{Definition}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proof}{Proof}[section]
\newtheorem{lemma}{Lemma}[section]

%
%
%
%
%

%
\newcommand{\swap}[3][-]{#3#1#2} %

\usepackage{tcolorbox}
\newtcbox{\mathbox}{on line,
  colframe=white!70!black,colback=white!95!black,
  boxrule=.5pt,arc=2pt,boxsep=0pt,left=1.5pt,right=1.5pt,top=1.5pt,bottom=1.5pt}

\title{Robust Counterfactual Inference in Markov Decision Processes}

%
\author[1]{\href{mailto:<jessica.lally@kcl.ac.uk>?Subject=Robust Counterfactual Inference in MDPs}{Jessica Lally}{}}
\author[1]{Milad Kazemi}
\author[1]{Nicola Paoletti}
%
\affil[1]{%
    Department of Informatics\\
    King's College London\\
    London, UK
}
\begin{document}
\maketitle
\begin{abstract}
  This paper addresses a key limitation in existing counterfactual inference methods for Markov Decision Processes (MDPs). Current approaches assume a specific causal model to make counterfactuals identifiable. However, there are usually many causal models that align with the observational and interventional distributions of an MDP, each yielding different counterfactual distributions, so fixing a particular causal model limits the validity (and usefulness) of counterfactual inference. We propose a novel \textit{non-parametric} approach that computes tight bounds on counterfactual transition probabilities across all compatible causal models. Unlike previous methods that require solving prohibitively large optimisation problems (with variables that grow exponentially in the size of the MDP), our approach provides closed-form expressions for these bounds, making computation highly efficient and scalable for non-trivial MDPs. Once such an \textit{interval} counterfactual MDP is constructed, our method identifies robust counterfactual policies that optimise the worst-case reward w.r.t. the uncertain interval MDP probabilities. We evaluate our method on various case studies, demonstrating improved robustness over existing methods.
\end{abstract}

\input{introduction}

\input{background}

\input{mathematical_background}

\input{analytical_bounds}

\input{methodology}

\input{evaluation}

\input{conclusion}

\begin{acknowledgements}
The authors would like to thank Frederik Mathiesen and 
Luca Laurenti for their support with using the IntervalMDP.jl package. This work was supported by UK Research and Innovation [grant number EP/S023356/1] in the UKRI Centre for Doctoral Training in Safe and Trusted Artificial Intelligence (www.safeandtrustedai.org); and UK Research and Innovation [grant number EP/W014785/2].
\end{acknowledgements}

%
\bibliography{bibliography}

\newpage

\onecolumn

\title{Robust Counterfactual Inference in Markov Decision Processes\\(Supplementary Material)}
\maketitle

\appendix
\input{appendix}

\end{document}
