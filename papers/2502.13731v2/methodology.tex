\input{gridworld_experiments_avg_p=9}

\section{Methodology}
With our analytical bounds, we can compute a non-stationary interval counterfactual MDP for any MDP $\mathcal{M}$ and observed path $\tau$. Formally, an interval Markov decision process (IMDP) \citep{GIVAN200071} is a tuple $(\mathcal{S}, \mathcal{A}, P_{\updownarrow}, \mathcal{R})$, extending MDPs with an uncertain transition probability function $P_{\updownarrow}$ that maps each transition to a probability within its bounds $P_{\updownarrow}(s' \mid s, a) = [P^{\it LB}(s' \mid s, a), P^{\it UB}(s' \mid s, a)]$. To construct an interval counterfactual MDP, we compute the counterfactual probability bounds for every transition in the MDP, given every observed transition in $\tau$.
\begin{definition}[Interval Counterfactual MDP (ICFMDP)]
Given an observed path $\tau$ and MDP $\mathcal{M}$, the counterfactual probability for each transition in the interval counterfactual MDP (ICFMDP) ${\tilde{\mathcal{M}}^{\updownarrow}_{\tau}}$ is defined, for $t=0,\ldots,T-1$, as $\tilde{P}^{\updownarrow}_{t}(\tilde{s}' \mid \tilde{s}, \tilde{a}) = [\tilde{P}_{t}^{\it LB}(\tilde{s'} \mid \tilde{s}, \tilde{a}), \tilde{P}_{t}^{\it UB}(\tilde{s'} \mid \tilde{s}, \tilde{a})]$.
%
%
%
%
%
%
\end{definition}
\jl{To derive optimal counterfactual policies for this ICFMDP, we apply robust value iteration  \citep{mathiesen2024intervalmdp}, which pessimistically optimises the expected reward 
$$V^{*}(s) = \max_{\pi} \min_{\tilde{P}_t \in \tilde{P}^{\updownarrow}_{t}}\mathbb{E}_{s' \sim \tilde{P}_t(\cdot \mid s, \pi(s))}\left[R(s, \pi(s)) + V^{*}(s')\right].$$ In Appendix \ref{sec: sampled interval cfmdp proof}, we prove that any CFMDP entailed by the ICFMDP will be valid (i.e., satisfying \eqref{eq: optimisation} + \eqref{eq: additional assumptions}), \jl{so this policy will be robust across all possible causal models (i.e., the ICFMDP does not introduce spurious models).}}
%
%
%

%
%
%
%
