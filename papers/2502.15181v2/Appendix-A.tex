\section{RPT Performance with Optimizer's Plan}

In Appendix A, we present the full performance results of \RPT using the optimizer's plan, compared to our baseline methods: DuckDB, Bloom Join, and \PT. 

\Cref{fig:tpch-perf} shows the execution time with the optimizer's plan for each query in \tpch. Note that we exclude Q1 and Q6, as they only involve scanning and filtering a single table. On average (geometric mean), \RPT outperforms vanilla DuckDB by $1.53\times$ and Bloom Join by $1.33\times$. Additionally, \RPT achieves the same performance as \PT. This is because \tpch queries are relatively simple, and the transfer scheduling of \PT and \RPT does not differ significantly.

\Cref{fig:job-perf} displays the execution time with the optimizerâ€™s plan for one result from each of the 33 query templates in the \job. On average (geometric mean), \RPT outperforms vanilla DuckDB by $1.46\times$ and Bloom Join by $1.29\times$, while matching the performance of \PT.

\Cref{fig:tpcds-perf} presents the execution time with the optimizer's plan for each query in \tpcds. On average (geometric mean), \RPT outperforms DuckDB by $1.56\times$, Bloom Join by $1.48\times$, and \PT by $1.23\times$. However, for certain queries (e.g., Q16, Q61, and Q69), \RPT performs poorly compared to vanilla DuckDB and Bloom Join. This is due to the result being empty for these queries, causing \RPT to scan more tables than vanilla DuckDB and Bloom Join, as query execution stops upon encountering empty intermediate results.

In \Cref{fig:dsb-perf}, we show the execution time with the optimizer's plan for each query in \dsb.  On average (geometric mean), \RPT outperforms vanilla DuckDB by $1.54\times$, Bloom Join by $1.45\times$, and \PT by $1.23\times$. Similar to \tpcds, for some specific queries, \RPT exhibits poor performance for certain queries due to empty intermediate results, resulting in additional table scans compared to vanilla DuckDB and Bloom Join.

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\linewidth]{./pic/tpch-perf.pdf}
    \caption{The execution time with optimizer's plans for each query in \tpch \textnormal{-- Normalized by the execution time of default \duckdb. We omit Q1 and Q6 as they are only the table scan and filtering.}}
    \label{fig:tpch-perf}
\end{figure*}

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\linewidth]{./pic/job-perf.pdf}
    \caption{The execution time with optimizer's plans for each query in \job \textnormal{-- Normalized by the execution time of default \duckdb.}}
    \label{fig:job-perf}
\end{figure*}

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\linewidth]{./pic/tpcds-perf.pdf}
    \caption{The execution time with optimizer's plans for each query in \tpcds \textnormal{-- Normalized by the execution time of default \duckdb.}}
    \label{fig:tpcds-perf}
\end{figure*}

\begin{figure*}[t!]
    \centering
    \includegraphics[width=\linewidth]{./pic/dsb-perf.pdf}
    \caption{The execution time with optimizer's plans for each query in \dsb \textnormal{-- Normalized by the execution time of default \duckdb.}}
    \label{fig:dsb-perf}
\end{figure*}