
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Notation problem
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\samplesize{n}
\def\dimsize{p}
\def\clusternum{C}
\def\dset{\mathcal{D}_\samplesize}
\def\bx{{\bf x}}
\def\bbX{\mathbb{X}}
\def\ourmethod{CoHiRF\,}
\def\categoricalnum{p_{cat}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheorem{example}{Example} 
% \newtheorem{theorem}{Theorem}
% \newtheorem{lemma}{Lemma}
% \newtheorem{remark}{Remark}
% \newtheorem{definition}{Definition}
% \newtheorem{proposition}{Proposition}
% \newtheorem{corollary}{Corollary}
% \newtheorem{assumption}{Assumption}


%% OPERATORS 
\DeclareMathOperator*{\esssup}{\ensuremath{\text{\rm ess\,sup}}}
\DeclareMathOperator*{\essinf}{\ensuremath{\text{\rm ess\,inf}}}
\DeclareMathOperator*{\dom}{\ensuremath{\text{\rm dom}}}
\DeclareMathOperator*{\argmin}{\ensuremath{\text{\rm arg\,min}}}
\DeclareMathOperator*{\argmax}{\ensuremath{\text{\rm arg\,max}}}
\DeclareMathOperator*{\range}{\ensuremath{\text{\rm Im}}}
\DeclareMathOperator*{\inte}{\ensuremath{\text{\rm int}}}
\DeclareMathOperator*{\cl}{\ensuremath{\text{\rm cl}}}
\DeclareMathOperator*{\hull}{\ensuremath{\text{\rm co}}}
\DeclareMathOperator*{\bd}{\ensuremath{\text{\rm bdry}}}
\DeclareMathOperator{\Ker}{\ensuremath{\text{\rm Ker}}}
\DeclareMathOperator{\vect}{\ensuremath{\text{\rm vec}}}
\DeclareMathOperator{\tr}{\ensuremath{\text{\rm tr}}}
\DeclareMathOperator{\Diag}{\ensuremath{\text{\rm diag}}}
\DeclareMathOperator*{\rank}{\ensuremath{\text{\rm rank}}}
\DeclareMathOperator*{\Span}{\ensuremath{\text{\rm span}}}
\DeclareMathOperator*{\supp}{\ensuremath{\text{\rm supp}}}
\DeclareMathOperator*{\Spec}{\ensuremath{\text{\rm Sp}}}
\DeclareMathOperator*{\Res}{\ensuremath{\text{\rm Res}}}
\DeclareMathOperator*{\sep}{\ensuremath{\text{\rm sep}}}
\DeclareMathOperator*{\dist}{\ensuremath{\text{\rm dist}}}
\DeclareMathOperator*{\cond}{\ensuremath{\text{\rm cond}}}


%% COMMANDS
\providecommand{\norm}[1]{\lVert#1\rVert}
\providecommand{\SVDr}[1]{[\![#1]\!]_r}
\providecommand{\SVDd}[1]{[\![#1]\!]_d}
\providecommand{\SVDd}[1]{[\![#1]\!]_d}
\providecommand{\SVD}[2]{[\![#1]\!]_{#2}}
\providecommand{\abs}[1]{\lvert#1\rvert}
\newcommand{\scalarp}[1]{{\langle #1\rangle}}


\newcommand{\R}{\mathbb R}
\newcommand{\C}{\mathbb C}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}


\newcommand{\EE}{\ensuremath{\mathbb E}}
\newcommand{\PP}{\ensuremath{\mathbb P}}
\newcommand{\VV}{\ensuremath{\mathbb V}}
\newcommand{\Id}{I}

\newcommand{\Nd}{\mathcal{N}} % Normal distribution

\newcommand{\spX}{\mathcal{X}}
\newcommand{\spY}{\mathcal{Y}}
\newcommand{\LiiX}{L^2_\mX(\spX)}
\newcommand{\LiiY}{L^2_\mY(\spY)}
\newcommand{\LiiYRd}{L^2_\mY(\spY,\mathbb{R}^{\underline{d}})}

\newcommand{\mX}{\mu} % measure on X
\newcommand{\mY}{\nu} % measure on Y
\newcommand{\mXY}{\rho} %joint invariant measure

\newcommand{\sigalg}{\mathcal{F}} % Sigma Algebra on the abstract probability space
\newcommand{\sigalgX}{\Sigma_{\spX}} % Sigma Algebra on X
\newcommand{\sigalgY}{\Sigma_{\spY}} % Sigma Algebra on Y

\newcommand{\im}{\pi} %invariant measure
\newcommand{\jim}{\rho} %joint invariant measure
\newcommand{\statesapce}{\mathcal{X}}
\newcommand{\Lii}{L^2_\im(\statesapce)}


\newcommand{\noise}{\omega}
\newcommand{\CP}[2]{p(#1\,\vert\,#2)} %transition kernel
\newcommand{\ECP}[2]{\widehat{p}_\param(#1\,\vert\,#2)} %transition kernel
\newcommand{\EPP}[1]{\widehat{p}_\param(#1)}
\newcommand{\EPY}[1]{\widehat{p}_{y}(#1)} %empirical prob of Y

\newcommand{\CE}{{\mathsf{E}_{Y\vert X}}}  %Conditional expectation operator L2 to  L2
\newcommand{\adjCE}{\mathsf{E}_{X\vert Y}}  %Adjoinmt Conditional expectation operator L2 to  L2\newcommand{\Koop}{{A_{\im}}}  %Koopman operator on L2

\newcommand{\ECE}{{\widehat{\mathsf{E}}^\param_{Y\vert X}}}  
%Conditional expectation operator L2 to  L2
\newcommand{\EEX}{\widehat{\mathsf{E}}_{x}}
\newcommand{\EEY}{\widehat{\mathsf{E}}_{y}}  
\newcommand{\ECEnull}{{\widehat{\mathsf{E}}^\param}}

\newcommand{\CEXinA}{{\mathsf{E}_{Y\vert X\in A}}}  %Conditional expectation operator L2 to  L2
\newcommand{\covYXA
}{\mathrm{Cov}(Y\vert X\in A)}
\newcommand{\ecovYXA}{\widehat{\mathrm{Cov}}^{\param}(Y\vert X\in A)}

\newcommand{\ecovYX}{\widehat{\mathrm{Cov}}^{\param}(Y\vert X)}




\newcommand{\DCE}{{\mathsf{D}_{Y\vert X}}}  %Conditional expectation operator L2 to  L2
\newcommand{\adjDCE}{{\mathsf{D}_{X\vert Y}}}  %Adjoinmt Conditional expectation operator L2 to  L2\newcommand{\Koop}{{A_{\im}}}  

\newcommand{\EDCE}{{\widehat{\mathsf{D}}^\param_{Y\vert X}}}  %Conditional expectation operator L2 to  L2

%\newcommand{\EDCE}{{\widehat{\mathsf{D}}^\param_{Y\vert X}}} 

\newcommand{\Koop}{{A_{\im}}}  %Koopman operator on L2
\newcommand{\adjKoop}{{A_{\im}^{*}}}  %Koopman operator on L2


\newcommand{\param}{\theta}
\newcommand{\spParam}{\Theta}

\newcommand{\emb}[1]{Z_{#1}}
\newcommand{\embXp}{u^\param}
\newcommand{\embYp}{v^\param}
\newcommand{\embX}{u}
\newcommand{\embY}{v}
\newcommand{\cembX}{\overline{u}}
\newcommand{\cembY}{\overline{v}}

\newcommand{\esvalp}{\widehat{\sigma}^\param}
\newcommand{\svalp}{\sigma^\param}
\newcommand{\lsfunp}{\widehat{u}^\param}
\newcommand{\rsfunp}{\widehat{v}^\param}

\newcommand{\jd}{p}
\newcommand{\jdp}{\jd_{\param}}


\newcommand{\kH}{k}
\newcommand{\spH}{\mathcal{H}}
\newcommand{\fH}{\phi}
\newcommand{\scalarpH}[1]{{\langle #1\rangle}_{\spH}}

\newcommand{\kHX}{k_{\mathcal{X}}}
\newcommand{\spHX}{\mathcal{H}_{\mathcal{X}}}
\newcommand{\fHX}{\phi_{\mathcal{X}}}
\newcommand{\scalarpHX}[1]{{\langle #1\rangle}_{\spHX}}

\newcommand{\kHY}{k_{\mathcal{Y}}}
\newcommand{\spHY}{\mathcal{H}_{\mathcal{Y}}}
\newcommand{\fHY}{\phi_{\mathcal{Y}}}
\newcommand{\scalarpHY}[1]{{\langle #1\rangle}_{\spHY}}


\newcommand{\kHXp}{k_{\mathcal{X}}^{\param}}
\newcommand{\spHXp}{\mathcal{H}_{\mathcal{X}}^{\param}}
\newcommand{\fHXp}{\phi_{\mathcal{X}}^{\param}}

\newcommand{\kHYp}{k_{\mathcal{Y}}^{\param}}
\newcommand{\spHYp}{\mathcal{H}_{\mathcal{Y}}^{\param}}
\newcommand{\fHYp}{\phi_{\mathcal{Y}}^{\param}}

\newcommand{\kHXs}{k_{\mathcal{X}}^\star}
\newcommand{\spHXs}{\mathcal{H}_{\mathcal{X}}^{\star}}
\newcommand{\fHXs}{\phi_{\mathcal{X}}^{\star}}

\newcommand{\kHYs}{k_{\mathcal{Y}}^{\star}}
\newcommand{\spHYs}{\mathcal{H}_{\mathcal{Y}}^{\star}}
\newcommand{\fHYs}{\phi_{\mathcal{Y}}^{\star}}

\newcommand{\KMEX}{\phi_{\mX}}  %Kernel mean embedding of measure on X
\newcommand{\KMEY}{\phi_{\mY}}  %Kernel mean embedding of measure on X

\newcommand{\KMEC}{\phi_{p}}  %Kernel mean embedding of measure p 
\newcommand{\KMECp}{\phi^\param_{p}}  %Kernel mean embedding of measure p

\newcommand{\CME}{C_{Y\,\vert\, X}}  %Conditional mean embedding operator HXp to  HYp

\newcommand{\CMEp}{C^\param_{Y\,\vert\, X}}  %Conditional mean embedding operator HXp to  HYp

\newcommand{\CMEreg}{C_{Y\,\vert\, X,\reg}}  %Conditional mean embedding operator HXp to  HYp

\newcommand{\CMEregp}{C^\param_{Y\,\vert\, X, \reg}}  %Conditional mean embedding operator HXp to  HYp



\newcommand{\kHp}{k_\param}
\newcommand{\spHp}{\mathcal{H}_\param}
\newcommand{\fHp}{\phi_\param}



\newcommand{\HSr}{{\rm{HS}}_r({\spHXp},{\spHYp})}


\newcommand{\proj}[1]{P_{#1}}

\newcommand{\Cx}{C_{X}}
\newcommand{\Cy}{C_{Y}}
\newcommand{\Cxy}{C_{XY}}
\newcommand{\Cyx}{C_{YX}}

\newcommand{\Cov}[1]{{\rm Cov}[#1]}
\newcommand{\Var}[1]{{\rm Var}[#1]}

\newcommand{\Cxp}{C^\param_{X}}
\newcommand{\Cyp}{C^{\param}_{Y}}
\newcommand{\Cxyp}{C^{\param}_{XY}}
\newcommand{\Cyxp}{C^{\param}_{YX}}

\newcommand{\Cxs}{C^\star_{X}}
\newcommand{\Cys}{C^{\star}_{Y}}
\newcommand{\Cxys}{C^{\star}_{XY}}
\newcommand{\Cyxs}{C^{\star}_{YX}}

\newcommand{\Lx}{L_X}
\newcommand{\Ly}{L_Y}

\newcommand{\Lxp}{L^{\param}_X}
\newcommand{\Lyp}{L^{\param}_Y}

\newcommand{\Lxs}{L^{\star}_X}
\newcommand{\Lys}{L^{\star}_Y}

\newcommand{\Estim}{\mathsf{G}}  %Estimator
\newcommand{\EEstim}{\widehat{\Estim}}  %Empirical estimator of the Koopman operator



\newcommand{\Data}{\mathcal{D}_n}

\newcommand{\ECx}{\widehat{C}_x} %Empirical Covariance of inputs 
\newcommand{\ECy}{\widehat{C}_y} %Emp Covariance of outputs 
\newcommand{\ECxy}{\widehat{C}_{xy} }  %Emp Cross-covariance  
\newcommand{\ECyx}{\widehat{C}_{yx}} 

\newcommand{\ECxp}{\widehat{C}^\param_x } %Empirical Covariance of inputs 
\newcommand{\ECyp}{\widehat{C}^\param_y} %Emp Covariance of outputs 
\newcommand{\ECxyp}{\widehat{C}^{\param}_{xy} }  %Emp Cross-covariance  
\newcommand{\ECyxp}{\widehat{C}^{\param}_{yx}} 

\newcommand{\ECxs}{\widehat{C}^\star_x } %Empirical Covariance of inputs 
\newcommand{\ECys}{\widehat{C}^\star_y} %Emp Covariance of outputs 
\newcommand{\ECxys}{\widehat{C}^{\star}_{xy} }  %Emp Cross-covariance  
\newcommand{\ECyxs}{\widehat{C}^{\star}_{yx}} 

\newcommand{\Kx}{K_x}
\newcommand{\Ky}{K_y}
\newcommand{\Kxy}{K_{xy}}

\newcommand{\Kxp}{K^\param_x}
\newcommand{\Kyp}{K^{\param}_y}
\newcommand{\Kxyp}{K^{\param}_{xy}}

\newcommand{\Kxs}{K^\star_x}
\newcommand{\Kys}{K^{\star}_y}
\newcommand{\Kxys}{K^{\star}_{xy}}
  

\newcommand{\TSX}{S_{\mX}}  % Cannonical injection HXp to LiiX
\newcommand{\TSY}{S_{\mY}}  % Cannonical injection HYp to LiiY

\newcommand{\TSXp}{S^\param_{\mX}}  % Cannonical injection HXp to LiiX
\newcommand{\TSYp}{S^\param_{\mY}}  % Cannonical injection HYp to LiiY

\newcommand{\TSXs}{S^\star_{\mX}}  % Cannonical injection HXs to LiiX
\newcommand{\TSYs}{S^\star_{\mY}}  % Cannonical injection HYs to LiiY

\newcommand{\ESX}{\widehat{S}_{x}}  % Cannonical injection HXp to LiiX
\newcommand{\ESY}{\widehat{S}_{y}}  % Cannonical injection HYp to LiiY

\newcommand{\ESXp}{\widehat{S}^\param_x} % Sampling of X w.r.t. HXp
\newcommand{\ESYp}{\widehat{S}^\param_y} % Sampling of Y w.r.t. HYp

\newcommand{\ESXs}{\widehat{S}^\star_x} % Sampling of X w.r.t. HXs
\newcommand{\ESYs}{\widehat{S}^\star_y} % Sampling of Y w.r.t. HYs

\newcommand{\U}{U_\star}  
\newcommand{\V}{V_\star}  

\newcommand{\Up}{U_\param}  
\newcommand{\Vp}{V_\param} 
\newcommand{\Sp}{S_\param} 

\newcommand{\CUp}{\overline{U}_\param}  
\newcommand{\CVp}{\overline{V}_\param} 
\newcommand{\ECUp}{\widehat{U}_\param}  
\newcommand{\ECVp}{\widehat{V}_\param}

\newcommand{\spF}{\mathcal{F}} % obervable space

%\newcommand{\Risk}{\mathcal{R}} % Risk
%\newcommand{\ExRisk}{\mathcal{E}_{\rm HS}} % Exces Risk
%\newcommand{\IrRisk}{\mathcal{R}_0} % Risk
%\newcommand{\ERisk}{\widehat{\mathcal{R}}} % Risk

\newcommand{\Reg}{\mathcal{R}} % Risk

\newcommand{\HS}[1]{{\rm{HS}}\left(#1\right)} %Hilbert-Schmidt space on the domain
\newcommand{\SC}[1]{{\rm{S}_p}\left(#1\right)} %Schaten p-class on the domain


\newcommand{\hnorm}[1]{\norm{#1}_{\rm{HS}}}
\newcommand{\snorm}[1]{\norm{#1}_{p}}

\newcommand{\reg}{\gamma}
\newcommand{\rate}{\varepsilon}
\newcommand{\bs}{r}

\newcommand{\error}{\mathcal{E}_\param}
\newcommand{\rerror}{\mathcal{E}^R_\param}
\newcommand{\score}{\mathcal{S}}
\newcommand{\escore}{\widehat{\mathcal{S}}}
\newcommand{\loss}{L}
\newcommand{\regloss}{R}
\newcommand{\rexploss}{\mathcal{R}}
\newcommand{\exploss}{\mathcal{L}}

%\newcommand{\elsfun}{\widehat{u}}
%\newcommand{\ersfun}{\widehat{v}}
\newcommand{\lsfun}{u^\star}
\newcommand{\rsfun}{v^\star}

\newcommand{\refun}{f}
\newcommand{\erefun}{\widehat{f}}
\newcommand{\lefun}{g}
\newcommand{\elefun}{\widehat{g}}

\newcommand{\sval}{\sigma^\star}
\newcommand{\eval}{\lambda}
\newcommand{\eeval}{\widehat{\lambda}}

\newcommand{\one}{\mathbb 1}
\newcommand{\eone}{\widehat{\mathbb 1}}

\newcommand{\tabitem}{~~\llap{\textbullet}~~}

% comands for indenting within algorithms (from https://tex.stackexchange.com/questions/69728/indenting-lines-of-code-in-algorithm)
\newlength\myindent % define a new length \myindent
\setlength\myindent{1em} % assign the length 2em to \myindet
\newcommand\bindent{%
  \begingroup % starts a group (to keep changes local)
  \setlength{\itemindent}{\myindent} % set itemindent (algorithmic internally uses a list) to the value of \mylength
  \addtolength{\algorithmicindent}{\myindent} % adds \mylength to the default indentation used by algorithmic
}
\newcommand\eindent{\endgroup} % closes a group