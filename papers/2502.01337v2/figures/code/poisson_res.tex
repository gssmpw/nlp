\pgfplotsset{compat=1.17}

\begin{figure}[ht]
    \begin{tikzpicture}
    \begin{axis}[
        xlabel=\textsc{Resolution},
        ylabel=\textsc{Iteration},
        ylabel style={yshift=-0.2em},
        % ymode=log,
        xtick={128,1024,2048,4096},
        xticklabels={128,1024,2048,4096},
        ytick={0,2000,4000},
        yticklabels={0,2k,4k},
        % x tick label style={rotate=45, anchor=east},
        grid=major,
        legend pos=north west,
        width=14cm,
        height=6cm,
        legend style={at={(0.5,1.0)}, anchor=south, legend columns=-1, font=\small, draw=none},
    ]
    
    % Jacobi
    \addplot[color=vir0, mark=diamond] coordinates {
        (128, 129) (256, 257) (512, 513) (1024, 1025) (2048, 2049) (4096,4097)
    };
    \addlegendentry{Jacobi}
    
    % Gauss Seidel
    \addplot[color=vir1, mark=triangle] coordinates {
        (128, 129) (256, 252) (512, 502) (1024, 1014) (2048, 2013) (4096,4052)
    };
    \addlegendentry{Gauss Seidel}
    
    % SOR
    \addplot[color=vir2, mark=star] coordinates {
        (128, 129) (256, 252) (512, 502) (1024, 1014) (2048, 2013) (4096,4052)
    };
    \addlegendentry{SOR}
    
    % MLP
    \addplot[color=vir3, mark=o] coordinates {
        (128, 129) (256, 257) (512, 511) (1024, 1010) (2048, 1858) (4096, 2922)
    };
    \addlegendentry{MLP}
    
    % UNet
    \addplot[color=vir4, mark=square] coordinates {
        (128, 127) (256, 248) (512, 475) (1024, 951) (2048, 1903) (4096,4097)
    };
    \addlegendentry{UNet}
    
    % FNO
    \addplot[color=vir5, mark=x] coordinates {
        (128, 112) (256, 199) (512, 367) (1024, 698) (2048, 1343) (4096,2617)
    };
    \addlegendentry{FNO}
    
    % Transolver
    \addplot[color=blue, mark=pentagon] coordinates {
        (128, 129) (256, 257) (512, 511) (1024, 1013) (2048, 1862) (4096,4097)
    };
    \addlegendentry{Transolver}
    
    % M2NO
    \addplot[color=blue, mark=square*] coordinates {
        (128, 87) (256, 232) (512, 430) (1024, 1004) (2048, 2049) (4096,4097)
    };
    \addlegendentry{M2NO}
    
    % NPO
    \addplot[color=red, mark=*] coordinates {
        (128, 61) (256, 135) (512, 263) (1024, 520) (2048, 1022) (4096,1658)
    };
    \addlegendentry{NPO}
    
    \end{axis}
    \end{tikzpicture}
    \vspace{-15pt}
    \caption{Performance comparison of numerical methods across grid resolutions from 128 to 4096.}
    \label{fig:poisson_res}
\end{figure}