%

\section{\pcref{thm:subg_low_rank_gen_kernel}}\label{proof:subg_low_rank_gen_kernel}

We establish the MMD bound \cref{eq:mmd_bound} in \cref{proof:mmd_bound}, the first kernel max seminorm bound \cref{eq:ind_bound} in \cref{proof:ind_bound}, and the Lipschitz kernel max seminorm bound \cref{eq:ind_bound_lipschitz} in \cref{proof:ind_bound_lipschitz}.
Throughout, we use the notation
%
%
%
%
%
%
%
$\Pevent(\event') \defeq \P(\event,\event')$ for events $(\event,\event')$.
%
\subsection{Proof of MMD bound~\cref{eq:mmd_bound}} \label{proof:mmd_bound}
Without loss of generality, we suppose that $r\leq \rank{\K}$. Let $\V\bLam\V^\top$ be an eigendecomposition of $\K$ with orthonormal $\V\in\reals^{n\times n}$ and diagonal $\bLam = \diag(\lam_1, \cdots, \lam_n) \in \real^{n\times n}$. Let $\V_r$ represent the first $r$ columns of $\V$,
and let $\V_{-r}$ represent the last $n-r$ columns of $\V$.
%
%
Introduce the shorthand
\begin{talign}
    \diff \defeq \pin -\qout \in\real^n
    \qtext{and}
    \bPhi\defeq\V\bLam^{1/2}\V^\top \in \real^{n\times n}.
    \label{eq:shorthands}
\end{talign}
We can directly verify that
\begin{talign}
    \V\V\tp = \V\tp\V = \ident,
    \quad
    \V\V\tp = \V_r\V_r\tp + \V_{-r}\V_{-r}\tp,
    \quad
    \qtext{and}
    \K = \bPhi\bPhi\tp.
    \label{eq:phi_v_eq}
\end{talign}
%
Using the above equalities, 
%
%
%
%
we decompose the squared MMD into two components,
\begin{talign}
\mmd^2_{\mkernel}(\pin, \qout)  
    =
\diff^\top \K \diff
    =
\diff^\top \bPhi\bPhi^\top\diff
    = 
\diff^\top \bPhi\V\V^\top\bPhi^\top\diff 
    &=
\diff^\top \bPhi\V_r\V_r^\top\bPhi^\top\diff
    +
\diff^\top \bPhi\V_{-r}\V_{-r}^\top\bPhi^\top\diff \\
    &=
\twonorm{\V_r^\top\bPhi^\top\diff}^2
    +
\twonorm{\V_{-r}^\top\bPhi^\top\diff}^2.
\label{eq:decompose_mmd}
\end{talign}
In \cref{sub:proof_of_top_r_err,sub:proof_of_residual} respectively, we will establish the bounds 
\begin{talign}
    &\P(\twonorm{\V_{r}^\top\bPhi^\top\diff}^2\leq 
    e\subg^2 (er+\log(1/\delta'))
    %
    \geq 1-\delta/2-\delta'
    \qtext{and}
    \label{eq:top_r_err}\\
    &\P(\twonorm{\V_{-r}^\top\bPhi^\top\diff}^2
    \leq  \lam_{r+1}(\frac{1}{\nout}-\frac{1}{n})) = 1,
    %
    %
    \label{eq:residual} 
\end{talign}
which when combined with \cref{eq:decompose_mmd} yield the advertised claim~\cref{eq:mmd_bound} on the squared MMD. 
%

%
\subsubsection{Proof of \cref{eq:top_r_err}: Bounding $\twonorm{\V_r^\top\bPhi^\top\diff}^2$}
\label{sub:proof_of_top_r_err}
Our first lemma bounds the Euclidean norm of a vector in terms of a finite number of inner products.
%
\begin{lemma}[Euclidean norm cover]\label{norm-cover}
For any $\bv \in\reals^{r}$ and $\vareps\in (0,1)$, 
\begin{talign}
\twonorm{\bv} \leq \frac{1}{1-\vareps}\max_{\bu \in \cover_{\vareps,r}}\inner{\bu}{\bv}\label{eq:ltwo_norm_eps}
\end{talign} 
for a set 
$\cover_{\vareps,r}$ contained in the ball $\ball^r$ with $|\cover_{\vareps,r}| \leq (1+2/\vareps)^r$.
\end{lemma}
\begin{proof}
Fix any $\vareps \in (0,1)$, 
%
%
and let $\cover_{\vareps,r}$ be a set of minimum cardinality satisfying 
\begin{talign}
\cover_{\vareps,r} \subset \ball^r
\qtext{and}
\sup_{\bu\in\ball^r}\min_{\bu'\in\cover_{\vareps,r}} \twonorm{\bu - \bu'}\leq \vareps.
\end{talign}
By \citet[Lem.~5.2]{wainwright2019high}, $|\cover_{\vareps,r}| \leq (1+2/\vareps)^r$.
Now we invoke the variational representation of $\twonorm{\cdot}$ and the Cauchy-Schwarz inequality to conclude that
\begin{talign}
\twonorm{\bv}
    =
\sup_{\bu\in\ball^r}\inner{\bu}{\bv}
    &=
\sup_{\bu\in\ball^r}\min_{\bu'\in\cover_{\vareps,r}}
\brackets{\inner{\bu-\bu'}{\bv}+\inner{\bu'}{\bv}}\\
    &\leq
\sup_{\bu\in\ball^r}\min_{\bu'\in\cover_{\vareps,r}}
\twonorm{\bu-\bu'}\twonorm{\bv}+\max_{\bu'\in\cover_{\vareps,r}}\inner{\bu'}{\bv}\\
    &\leq
\vareps \twonorm{\bv}+\max_{\bu'\in\cover_{\vareps,r}}\inner{\bu'}{\bv}.
\end{talign}
Rearranging terms yields the claimed bound~\cref{eq:ltwo_norm_eps}.
\end{proof}
%

Our next lemma uses this covering estimate to bound the exponential moments of $\twonorm{\V_r^\top\bPhi^\top\diff}$.
\begin{lemma}[Norm sub-Gaussianity] \label{norm-subg} For any $\vareps>0$ and any $t > 0$,
\begin{talign}
\Eevent[\exp(t\twonorm{\V_r^\top\bPhi^\top\diff})] 
    \leq   
%
(1+\frac{2}{\vareps})^r \exp(\frac{\subg^2t^2}{2(1-\eps)^2}).
\end{talign}
\end{lemma}
\begin{proof}
Fix any $t>0$. 
Since $x\mapsto \exp(tx)$ is increasing, \cref{norm-cover} implies that 
\begin{talign}
\Eevent[\exp(t\twonorm{\V_r^\top\bPhi^\top\diff})]
    &\leq
\Eevent[\exp(t\cdot \frac{1}{1-\vareps}\max_{\bu \in \cover_{\vareps,r}}\inner{\bu}{\V_r^\top\bPhi^\top\diff})] \\
    &=
\Eevent[\max_{\bu \in \cover_{\vareps,r}}\exp(\frac{t}{1-\vareps}\inner{\V_r\bu}{\bPhi^\top\diff})] \\ 
    &\leq
\sum_{\bu \in \cover_{\vareps,r}}\Eevent[\exp(\frac{t}{1-\vareps}\inner{\V_r\bu}{\bPhi^\top\diff})] 
\end{talign}
for a subset $\cover_{\vareps,r}$ with $|\cover_{\vareps,r}|\leq (1+\frac{2}{\vareps})^r$ and $\twonorm{\bu}\leq 1$ for each $\bu\in\cover_{\vareps,r}$.

Now fix any $\bu\in\cover_{\vareps,r}$ and 
let $\bLam_r=\diag(\lam_1, \dots, \lam_r)$. Using \cref{eq:shorthands,eq:phi_v_eq}, we have
\begin{talign}
\V_r &= \bPhi\tp \V_r \bLam_r^{-1/2}
	\qtext{and therefore} \\
\inner{\V_r\bu}{\bPhi^\top\diff}
    &=
\inner{\bPhi\tp\V_r \bLam_r^{-1/2}\bu}{\bPhi^\top\diff}
    =
\inner{\V_r \bLam_r^{-1/2}\bu}{\K\diff}.
\end{talign}
In addition, we have 
\begin{talign}
    (\V_r \bLam_r^{-1/2}\bu) \tp \K (\V_r \bLam_r^{-1/2}\bu)
    = \bu\tp  \bLam_r^{-1/2} \V_r\tp \V \bLam \V\tp \V_r \bLam_r^{-1/2}\bu  = \bu\tp\bu.
\end{talign}
Next, we can invoke our sub-Gaussianity assumption (\cref{def:alg-subg}) to conclude that
\begin{talign}
\Eevent[\exp(\frac{t}{1-\vareps}\inner{\V_r\bu}{\bPhi^\top\diff})] 
	=
\Eevent[\exp(\frac{t}{1-\vareps}\inner{\V_r \bLam_r^{-1/2}\bu}{\K\diff})] 
    &\leq
\exp(\frac{\subg^2t^2}{2(1-\vareps)^2} \inner{\V_r \bLam_r^{-1/2}\bu}{\K\V_r \bLam_r^{-1/2}\bu})\\
    &\leq
\exp(\frac{\subg^2t^2}{2(1-\vareps)^2} \twonorm{\bu}^2).
\end{talign}
Since $\twonorm{\bu}\leq 1$ and $|\cover_{\vareps,r}|\leq (1+\frac{2}{\vareps})^r$, the advertised result now follows.
\end{proof}
By Markov's inequality \citep{markov1884certain} and \cref{norm-subg}, for any $\alpha > 0$, 
\begin{talign}
\P(\twonorm{\V_r^\top\bPhi^\top\diff} > \alpha)
    &=
    \Pevent(\twonorm{\V_r^\top\bPhi^\top\diff} > \alpha) 
    +
    \P(\twonorm{\V_r^\top\bPhi^\top\diff} > \alpha, \event^c) 
    \\
    &\leq \Pevent(\twonorm{\V_r^\top\bPhi^\top\diff} > \alpha) + \P(\event^c) \\
    &\leq
\inf_{t > 0} \Eevent[\exp(t\twonorm{\V_r^\top\bPhi^\top\diff}) ]/\exp(t\alpha) 
+ \delta/2
\\
    &\leq
(1+\frac{2}{\vareps})^r \inf_{t > 0}\exp(\frac{\subg^2t^2}{2(1-\vareps)^2}-t\alpha)
+ \delta/2 \\
    &=
(1+\frac{2}{\vareps})^r \exp(\frac{-(1-\vareps)^2\alpha^2}{2\subg^2})
+ \delta/2.
\end{talign}
Next, we have
\begin{talign}
(1+\frac{2}{\vareps})^r \exp(\frac{-(1-\vareps)^2\alpha^2}{2\subg^2}) \leq \delta'
\qtext{if}
\alpha \geq \frac{\subg\sqrt{2}}{1-\vareps} \sqrt{\log(\frac{1}{\delta'}) + r\log(1+\frac{2}{\vareps})}
\end{talign}
Since this bound holds for any $\vareps$, 
%
%
%
%
%
choosing $\vareps = 1-\sqrt{2/e}$, we find that 
\begin{talign}
\twonorm{\V_r^\top\bPhi^\top\diff}^2 
    \leq  
e\subg^2 \brackets{r\log(1+2/(1-\sqrt{2/e}))+\log(1/\delta')}
    \leq  
e\subg^2 \brackets{er+\log(1/\delta')}
\end{talign}
with probability at least $1-\delta/2-\delta'$ as claimed.
%

%
\subsubsection{Proof of \cref{eq:residual}: Bounding $\twonorm{\V_{-r}^\top\bPhi^\top\diff}^2$}
\label{sub:proof_of_residual}
Since
\begin{talign}
    \twonorm{\diff}^2 = \pin\tp\pin + \qout\tp\qout - 2\pin\tp\qout = \frac{\nin}{\nin^2} + \frac{\nout}{\nout^2} - \frac{2\nout}{\nin\nout}
    = \frac{1}{\nout} - \frac{1}{\nin},
    \label{eq:w_norm}
\end{talign}
we have, for $\bLam_{-r} \defeq \diag(\lam_{r+1},\cdots,\lam_{n})$ and $\maxeig$ the maximum eigenvalue of a SPSD matrix,
\begin{talign}\label{eq:Vminusrnorm}
\twonorm{\V_{-r}^\top\bPhi^\top\diff}^2
    =
\diff^\top\V_{-r}\bLam_{-r}\V_{-r}^\top\diff
    \leq
\maxeig(\V_{-r}\bLam_{-r}\V_{-r}^\top) \twonorm{\diff}^2
    \seq{\cref{eq:w_norm}}
\lam_{r+1}(\frac{1}{\nout}-\frac{1}{\nin}).
\end{talign}
%

%
\subsection{Proof of kernel max seminorm bound~\cref{eq:ind_bound}}\label{proof:ind_bound}

We begin by establishing a general bound on the maximum discrepancy between input and output expectations over a collection of test functions admitting a finite cover.
%
\begin{lemma}[Discrepancy cover bound]\label{discrepancy-cover-bound}
Fix any kernel $\k$, subset $\Fset \subset \rkhs$, and scalars $\vareps \geq 0$ and $\delta' \in (0,1)$.
Define 
\begin{talign}
a\defeq \sup_{f\in\Fset}\knorm{f}
\qtext{and}
\ball_{\Fset} \defeq \{ f \in \rkhs : \knorm{f}\leq a\},
\end{talign} 
and let 
$\cover_{\eps,\Fset}$ 
be a set of minimum cardinality satisfying 
\begin{talign}\label{eq:F-cover}
\cover_{\eps,\Fset} \subset \ball_{\Fset}
\qtext{and}
\sup_{f\in\Fset}\min_{f'\in\cover_{\eps,\Fset}}\max_{\x\in\xin} |f(\x) - f'(\x)|\leq \vareps.
\end{talign}
If $(\Pin - \Qout)\kernel$ is $(\kernel,\subg)$-sub-Gaussian on an event $\event$ (\cref{def:function-subg}), then, on $\event$, 
\begin{talign}
\fnorm 
	\defeq 
\sup_{f\in\Fset}(\Pin-\Qout)f
	\leq 2\eps + 
\subg a \sqrt{2 \log({|\cover_{\eps,\Fset}|}{/\delta'})}
\qtext{with probability at least $1-\delta'$.}
\end{talign}
\end{lemma}
\begin{proof}
%
%
The triangle inequality and the covering property \cref{eq:F-cover} together imply that, with probability $1$, 
\begin{talign}
(\Pin-\Qout)f
    &\leq
\min_{f'\in\cover_{\eps,\Fset}}
(\Pin-\Qout)f'
    + 
|(\Pin-\Qout)(f-f')| \\
%
%
%
%
%
    &\leq
\fnorm[\cover_{\eps,\Fset}]
    +
\min_{f'\in\cover_{\eps,\Fset}} 
|\Pin(f-f')|+|\Qout(f-f')| \\
    &\leq
\fnorm[\cover_{\eps,\Fset}]
    +
2\min_{f'\in\cover_{\eps,\Fset}} 
\max_{\x\in\xin} |f(\x) - f'(\x)| \\
    &\leq
\fnorm[\cover_{\eps,\Fset}]
    +
2\vareps \label{eq:prob-diff-f-cover}
\end{talign}
for each $f\in\Fset$.
Since $s\mapsto e^{ts}$ is increasing, the bound \cref{eq:prob-diff-f-cover}, the assumed sub-Gaussianity (\cref{def:function-subg}), and the fact that $\cover_{\eps,\Fset}$ belongs to $\ball_{\Fset}$ imply that
\begin{talign}
%
%
\Eevent[\exp(t\fnorm)] 
   &\leq 
e^{2t\vareps}\Eevent[\exp(t \fnorm[\cover_{\eps,\Fset}])] \\
	&\leq 
\sum_{f'\in\cover_{\eps,\Fset}} e^{2t\vareps}\Eevent[\exp(t (\Pin-\Qout)f')] \\ 
	&\leq 
\sum_{f'\in\cover_{\eps,\Fset}} \exp(\frac{t^2\subg^2 \knorm{f'}^2}{2} + 2t\eps) 
	\leq 
|\cover_{\eps,\Fset}| \exp(\frac{t^2\subg^2 a^2}{2} + 2t\eps).
\end{talign}
Now, by Markov's inequality \citep{markov1884certain}, for any $\alpha > 0$, 
\begin{talign}
    \Pevent(\sup_{f\in\Fset}(\Pin-\Qout)f >\alpha + 2\eps) 
    %
    %
    %
    %
    %
    &\leq \inf_{t > 0} \Eevent[\exp(t\fnorm)] / \exp(t(\alpha+ 2\eps)) \\ 
    &\leq |\cover_{\eps,\Fset}| \inf_{t>0} \exp(\frac{t^2\subg^2 a^2}{2} -t\alpha) 
    = |\cover_{\eps,\Fset}|\exp(\frac{-\alpha^2}{2\subg^2a^2}).
\end{talign}
Finally, choosing $\alpha = \subg a \sqrt{2 \log({|\cover_{\eps,\Fset}|}{/\delta'})}$ yields the desired claim.
\end{proof}
%

Now fix any $\eps \geq 0$, $\delta' \in (0,1)$, and kernel $\k$ that generates $\K$, 
and consider the subset $\Fset = \{\pm\k(\x_i,\cdot) : i\in\ind\}$.
Since $\indnorm = \fnorm$ and $\sup_{f\in\Fset}\knorm{f} = D_{\ind}$, \cref{discrepancy-cover-bound} implies that, on the event $\event$, 
\begin{talign}\label{eq:znorm-eps-cover}
\indnorm
	\leq 
 2\eps + 
\subg D_{\ind}  \sqrt{2 \log({|\cover_{\eps,\Fset}|}{/\delta'})}
\qtext{with probability at least $1-\delta'$.}
\end{talign}
Since $\P(\event^c) \leq \delta/2$ and $|\Fset| \leq 2 |\Zset|$, we use the estimate $|\cover_{0,\Fset}|\leq 2|\ind|$ with $\eps=0$ to obtain the  advertised bound \cref{eq:ind_bound}.


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%




%
\subsection{Proof of Lipschitz kernel max seminorm bound~\cref{eq:ind_bound_lipschitz}}\label{proof:ind_bound_lipschitz}
Introduce the query point set $\Zset\defeq\{ \x_i : i \in \ind\}$, fix any $\delta'\in(0,1)$ and $\z_0\in\Zset$, and define the symmetrized seminorm 
\begin{talign}
\zznorm 
    \defeq 
\sup_{\z,\z'\in\Zset}|(\Pin-\Qout)\kernel(\z) - (\Pin-\Qout)\kernel(\z')|.
\end{talign}
By the triangle inequality and the derivation of \cref{proof:ind_bound}, we have, on the event $\event$, 
\begin{talign}
\indnorm
    &\leq 
\zznorm 
    +
|(\Pin -\Qout)\kernel(\z_0)|
\\
    &\leq 
\zznorm
    +
\subg \sqrt{\k(\z_0,\z_0)} \sqrt{2 \log({4}{/\delta'})}
    \qtext{with probability at least $1-\delta'/2$.} \label{max_seminorm_lipschitz_bound_part_1}
\end{talign}
Since $\P(\event^c)\leq \delta/2$, it only remains to upper bound $\zznorm$ on $\event$ with probability at least $1-\delta'/2$.

To this end, we first establish that $((\Pin -\Qout)\kernel(\z))_{\z\in\Zset}$ is a sub-Gaussian process on $\event$ with respect to a particular bounded-\Holder metric $\rho$.
%
\begin{definition}[Sub-Gaussian process on an event]
We say an indexed collection of random variables $(X_\theta)_{\theta\in\Theta}$ is a \emph{sub-Gaussian process with respect to $\rho$ on an event $\event$} if $\rho$ is a metric on $\Theta$ and 
\begin{talign}
%
%
\Eevent\Big[\exp\big(\frac{(X_\theta - X_\theta')^2}{\rho(\theta,\theta')^2}\big)\Big]\leq 2
    \qtext{for all}
\theta,\theta'\in\Theta.
\end{talign}
\end{definition}
%
\begin{lemma}[Bounded-\Holder sub-Gaussian process]\label{bounded_holder_subg}
Consider a kernel $\k$ on $\Xset=\reals^d$ satisfying $|\k(\z,\x) - \k(\z',\x)| \leq L_\k \twonorm{\z-\z'}$ for all $\z,\z'\in\Zset \subset \Xset$ and $\x\in\xin$.
If $(\Pin - \Qout)\kernel$ is $(\kernel,\subg)$-sub-Gaussian on an event $\event$ (\cref{def:function-subg}), then $((\Pin -\Qout)\kernel(\z))_{\z\in\Zset}$ is a sub-Gaussian process on $\event$ with respect to the metric 
\begin{talign}\label{eq:metric}
\rho(\z,\z') 
    \defeq
\subg \sqrt{8/3} \min(2 \sup_{\z\in\Zset} \sqrt{\k(\z,\z)}, \sqrt{2 L_{\k} \twonorm{\z-\z'}} ).
\end{talign}
\end{lemma}
%
The proof of \cref{bounded_holder_subg} can be found in \cref{proof:bounded_holder_subg}.
Our next lemma, a slight modification of \citet[Thm.~5.36]{wainwright2019high}, bounds the suprema of symmetrized sub-Gaussian processes on an event in terms of covering numbers.

%
\begin{lemma}[Sub-Gaussian process tails]\label{subgauss_process_tails}
Suppose $(X_{\theta})_{\theta\in\Theta}$
is a sub-Gaussian process with respect to $\rho$ on an event $\event$, and define the diameter 
$\diam(\Theta, \rho) \defeq \sup_{\theta,\theta'\in\Theta}\rho(\theta,\theta')$,
the covering number
\begin{talign}
\coveringnumber(u; \Theta, \rho)\defeq \min\{|\cover_u| :  \cover_u\subseteq\Theta,  \max_{\theta\in\Theta}\min_{\theta'\in\cover_u}\rho(\theta,\theta')\leq u\}
    \qtext{for all $u>0$,}
\end{talign}
and the entropy integral 
$\mcJ(\Theta, \rho) \defeq \int_0^{\diam(\Theta,\rho)}\sqrt{\log(1+\coveringnumber(u; \Theta, \rho))}\,du$.
Then, 
\begin{talign}
\Pevent(\sup_{\theta,\theta'\in\Theta} |X_{\theta}-X_{\theta'}| 
    \geq 
8 (\mcJ(\Theta, \rho)+t))
    \leq
2\exp(-t^2/\diam(\Theta,\rho)^2)
    \qtext{for all}
t > 0.
\end{talign}
\end{lemma}
\begin{proof}
Since $\sqrt{\log(1+xy)} \leq \sqrt{\log((1+x)(1+y))} \leq \sqrt{\log(1+x)} + \sqrt{\log(1+y)}$ for all $x,y>0$, the proof is identical to that of \citet[Thm.~5.36]{wainwright2019high} with $c_1 = 8$ and $(\Eevent, \Pevent)$ substituted for $(\E,\P)$.
\end{proof}
%

Our final lemma bounds the diameter, covering numbers, and entropy integral of $\Zset$ %
using the metric $\rho$.

%
\begin{lemma}[Covering properties of bounded-\Holder metric]\label{bounded_holder_covering}
Consider the bounded-\Holder metric $\rho$ \cref{eq:metric} for a kernel $\k$ on $\xset=\reals^d$ and a finite set $\Zset\subset\xset$. 
If $\Z$ is a matrix with one row corresponding to each element of $\Zset$, $r=\rank{\Z}$, and $R = \max_{\z\in\Zset} \twonorm{\z}$, then, in the notation of \cref{subgauss_process_tails}, 
\begin{talign}
\coveringnumber(u;\Zset,\rho)
    &\leq
(1+c^2/{u^2})^r
    \qtext{for}
c \defeq \subg\sqrt{\frac{32}{3}R L_{\k}}     \qtext{and all} 
u > 0, \label{eq:bounded-holder-covering-number}\\
\diam(\Zset,\rho) 
    &\leq 
D \defeq \min(c, \subg \sqrt{\frac{32}{3}} \max_{\z\in\Zset} \sqrt{\k(\z,\z)}),
    \qtext{and} \label{eq:bounded-holder-diameter}\\
\mcJ(\Zset,\rho)
    &\leq
D\sqrt{2r\log(\sqrt{3}ec/D)}.
\end{talign}
\end{lemma}
\begin{proof}
The diameter bound \cref{eq:bounded-holder-diameter} follows directly from the definition of $\rho$ \cref{eq:metric} and the fact $\max_{\z,\z'\in\Zset}\twonorm{\z-\z'}\leq 2R$.

To establish the covering number bound \cref{eq:bounded-holder-covering-number}, we let $\U \Sig \V^\top$ be a compact singular value decomposition of $\Z$ so that 
\begin{talign}
\V\in\reals^{d\times r},
    \quad
\Z=\Z\V\V^\top,
    \qtext{and}
\max_{\z\in\Zset}\twonorm{\V^\top\z}=\max_{\z\in\Zset}\twonorm{\z} = R.
\end{talign}
Fix any $\eps > 0$, and let $\cover$ and $\extcover$
be a sets of minimum cardinality satisfying 
\begin{talign}
\cover 
    &\subset 
\ball^r(R),
    \qquad\quad \ \ \ 
\max_{\bv\in \ball^r(R)}\min_{\bv'\in\cover}\twonorm{\bv' - \bv} \leq \eps^2/2, \\
\extcover 
    &\subset
\ball^d(R),
    \qtext{and}
\max_{\z\in\Zset}\min_{\bz'\in\extcover}\twonorm{\z' - \z} \leq \eps^2/2. \label{eq:extcover-criteria}
\end{talign}
Since $\V^\top \z \in \ball^r(R)$ for each $\z\in\Zset$ and $\V\bv' \in\ball^d$ for each $\bv'\in\ball^r$, we have
\begin{talign}
\max_{\z\in\Zset}
\min_{\bv'\in\cover}
\twonorm{\V\bv' - \z}
    &=
\max_{\z\in\Zset}
\min_{\bv'\in\cover}
\twonorm{\V(\bv' - \V^\top\z)}\\
    &=
\max_{\z\in\Zset}
\min_{\bv'\in\cover}
\twonorm{\bv' - \V^\top\z}
    \leq
\eps^2/2,
\end{talign}
so that $\V\cover$ satisfies the criteria of \cref{eq:extcover-criteria}.
Since $|\V\cover|\leq |\cover| \leq (1+4R/\eps^2)^r$ by  \citet[Lem.~5.2]{wainwright2019high}, we must also have 
$|\extcover| 
    \leq
(1+4R/\eps^2)^r$. 

Now, since $\extcover$ has minimum cardinality amongst sets satisfying \cref{eq:extcover-criteria}, for each $\z'\in\extcover$, there is some $\z\in\Zset$ satisfying $\twonorm{\z' - \z}\leq \eps^2/2$ (or else $\z'$ would be superfluous).
Hence, 
there exists a set $\intcover\subseteq\Zset$ satisfying 
\begin{talign}
|\intcover|
    \leq
|\extcover|
    \leq 
(1+4R/\eps^2)^r
    \qtext{and}
\max_{\z\in\Zset}\min_{\bz'\in\intcover}\twonorm{\z' - \z} \leq \eps^2. 
\end{talign}
Moreover, by our metric definition \cref{eq:metric}, 
\begin{talign}
\max_{\z\in\Zset}\min_{\z'\in\intcover}\rho(\z,\z')
    \leq
\frac{c}{2\sqrt{R}}\max_{\z\in\Zset}\min_{\z'\in\intcover}\sqrt{\twonorm{\z-\z'}}
    \leq
\frac{c\eps}{2\sqrt{R}}.
\end{talign}
Hence, for $u=\frac{c\eps}{2\sqrt{R}}$, $\coveringnumber(u;\Zset,\rho)\leq |\intcover| \leq (1+c^2/u^2)^r$.
Since $\eps > 0$ was arbitrary, we have established \cref{eq:bounded-holder-covering-number}.

Finally, we bound the entropy integral using the inequality
$1\leq c^2/u^2$ for $u\in[0,D]$, the concavity of the square-root function, and 
Jensen's inequality:
\begin{talign}
\mcJ(\Zset, \rho)
    &\leq
\int_0^D \sqrt{\log(1+(1+c^2/u^2)^r)} \,du
    \leq
\int_0^D \sqrt{\log((3c^2/u^2)^r)} \,du 
    =
\int_0^D \sqrt{2r\log(\sqrt{3}c/u)} \,du \\
    &\leq
D\sqrt{\frac{1}{D}\int_0^D 2r\log(\sqrt{3}c/u) \,du} 
    =
D\sqrt{2r\log(\sqrt{3}ec/D)}.
\end{talign}
\end{proof}
Together, \cref{bounded_holder_subg,,subgauss_process_tails,,bounded_holder_covering} imply that, in the notation of \cref{bounded_holder_covering},
\begin{talign}
\zznorm  
    \leq
8D \sqrt{2r\log(\sqrt{3}ec/D)} + 8 D \sqrt{\log(4/\delta')}
\end{talign}
on $\event$ 
with probability at least $1-\delta'/2$.
Combining this bound with the inequality \cref{max_seminorm_lipschitz_bound_part_1} yields the result.


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%


%
\subsection{\pcref{bounded_holder_subg}}\label{proof:bounded_holder_subg}
Define $X_{\z} = (\Pin -\Qout)\kernel(\z)$ for each $\z\in\Zset$, and fix any $\z,\z'\in\Zset$.
Our sub-Gaussianity assumption implies 
\begin{talign}
\Eevent[\exp(\lam (X_{\z}-X_{\z'})]
    \leq
\exp(\frac{\subg^2\lam^2}{2}\knorm{\k(\z,\cdot)-\k(\z',\cdot)}^2)
    \qtext{for all}
\lam\in\reals.
\end{talign}
Moreover, by our Lipschitz assumption, 
\begin{talign}
\knorm{\k(\z,\cdot)-\k(\z',\cdot)}^2
    =
\k(\z,\z) - \k(\z,\z') + \k(\z',\z') - \k(\z',\z)
    \leq
\min(4 \max_{\z\in\Zset}\k(\z,\z),
    2L_{\k}\twonorm{\z-\z'}).
\end{talign}
Finally, 
\cref{sqd_exp_moment_bound} shows that
$\Eevent[\exp(\frac{(X_{\z}-X_{\z'})^2}{\rho(\z,\z')^2}]\le2$ so that $(X_{\z})_{\z\in\Zset}$ is a sub-Gaussian process on $\event$ with respect to $\rho$.
%
%

\begin{lemma}[Squared exponential moment bound]\label{sqd_exp_moment_bound}
If $\Eevent[\exp(\lam X)] \leq \exp(\frac{\subg^2\lam^2}{2})$ for all $\lam\in\reals$, then $\Eevent[\exp(\frac{3X^2}{8\nu^2})] \leq 2$.
\end{lemma}
\begin{proof}
The proof is identical to that in \citet[Sec.~2.4]{wainwright2019high} with $\Eevent$ substituted for $\E$.
\end{proof}


%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%