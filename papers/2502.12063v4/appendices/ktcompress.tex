\section{\ktcompressd}
\label{app:ktcompress}

We describe the thinning algorithm \ktcompressd used in \cref{algo:ctt}. We use \khd for every halving round except for the last round, which thins a point sequence of size $2 \nout$ to $\nout$. For this final halving round we use  $\textsc{KH-Refine}(\delta)$ (\cref{algo:khrefine}) derived from the \ktswap algorithm of \citet[Alg.~1a]{dwivedi2024kernel}. 
The refinement stage of 
\cref{algo:khrefine} greedily improves the MMD of the initial \khd output. 
Hence, $\mmd_\k(\xin, \xout) \leq \mmd_\k(\xin,\coreset[1])$ with probability 1.

\begin{algorithm2e}[ht!]
\caption{$\textsc{KH-Refine}(\delta)$: \khd with greedy refinement \citep[Alg.~1a]{dwivedi2024kernel}} 
  \label{algo:khrefine}
 \SetAlgoLined\DontPrintSemicolon
\small
{
    \KwIn{point sequence $\xin = (\x_i)_{i = 1}^{\nin}$, kernel $\k$, input size $\nin \in 2 \naturals$}
        \BlankLine
        $\cset \gets \khd (\xin, \k)$; \quad $\nout \defeq \nin / 2$ \\
        %
        %
        \BlankLine
        // Swap out each point in $\xout$ for the best alternative in $\xin$ \\[1pt]
        $\xout \gets \cset.\texttt{copy()}$\\
       \For{$\x\in\cset$}{
            \BlankLine
            $\xout \gets \xout \,\backslash\, \{\x\}\cup\{\argmin_{\x'\in\xin}\mmd_{\kernel}(\Pin, \Qout+\frac{1}{\nout}(\dirac_{\x'}-\dirac_{\x}))$\}
       }
\KwRet{
 $\xout$\textup{, refined coreset of size $\nin / 2$}
}
}
\end{algorithm2e}

