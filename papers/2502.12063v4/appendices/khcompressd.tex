%
\subsection{\khcompressd}
\label{sub:khcompress}
%
\SetKwFunction{proccompress}{\texttt{compress}}

\begin{algorithm2e}[t]
\caption{\khcompressd: Compress with \kh halving and failure probability $\delta$}
\label{algo:khcompressd}
\SetAlgoLined
  \DontPrintSemicolon
\small{
  \KwIn{point sequence $\xin=(\x_i)_{i=1}^{\nin}$, kernel $\kernel$, $\nout\in\sqrt{\nin}\cdot 2^{\naturals}$} %
  %
\BlankLine
$\ossymb \gets \log_2(\nout/\sqrt{\nin})$ 
\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad// identify \osname \\
\BlankLine
\SetKwProg{myproc}{function}{}{}
\myproc{\proccompress{$\cset$}:}{
    \lIf{  $\abss{\cset} = 4^{\ossymb}$ }{
        \KwRet{ $\cset $ }{}
    }  
    %
        Partition $\cset$ into four arbitrary subsequences $ \{ \cset_i \}_{i=1}^4 $ each of size $\abss{\cset}/4$ \\ 
        \For{$i=1, 2, 3, 4$}
        {$ \wtil{ \cset_i } \leftarrow$ \proccompress{$\cset_i$} \ \qquad\qquad\qquad\qquad\qquad\qquad\quad\ \  // return coresets of size $2^{\ossymb} \cdot \sqrt{\frac{\abss{\cset}}{4}}$
        }
        %
        %
        $ \wtil{\cset} \gets\textsc{Concatenate}( \wtil{\cset}_1, \wtil{\cset}_2,\wtil{\cset}_3, \wtil{\cset}_4)$;
        \quad $\ell \gets 2 \cdot 2^{\ossymb} \cdot \sqrt{\abss{\cset}}$ 
        \quad // coreset of size   $\ell$ \\
        \KwRet{ \textup{  $\kh\Big(\frac{ \ell^2}{\nin 4^{\ossymb+1}(\log_4 \nin-\ossymb)}\delta\Big)(\wtil{\cset},  \kernel)$ 
        \,\,\qquad\qquad\qquad\qquad \!// coreset of size $ 2^{\ossymb} \sqrt{\abss{\cset}}$} }       
}
\BlankLine
    \KwRet{ \proccompress{$\xin$} \qquad\qquad\qquad\ \qquad\qquad\qquad\qquad\qquad\!\textup{// coreset of size $\nout = 2^{\ossymb} \sqrt{\nin}$}}{}
}
\end{algorithm2e}

In this section, we analyze \khcompressd  (\cref{algo:khcompressd}), a variant of the \textsc{KT-Split-Compress} algorithm \citep[Ex.~3]{shetty2022distributioncompressionnearlineartime} with simplified swapping thresholds.

%
\begin{proposition}[\tbf{Sub-Gaussianity of \khcompressd}]\label{khcompressd-sub-gaussian} 
If $\nout \in \sqrt{\nin} \,2^\naturals$ then \khcompressd (\cref{algo:khcompressd}) is $(\k,\subg)$-sub-Gaussian with 
\begin{talign}\label{khcompressd-subg}
\subg 
    =
\frac{1}{\nout}\sqrt{\log_2(\nout)\log(\frac{4\nout \log_2(\nin/\nout)}{\delta})}
 \max_{\x\in\xin}\sqrt{\k(\x,\x)}
%
%
%
\end{talign}
on an event $\event$ of probability at least $1-\delta/2$.
\end{proposition}
\begin{proof}
Since the original Kernel Halving algorithm of \citet[Alg.~2]{dwivedi2024kernel} is equal to the \ktsplit algorithm of \citet[Alg.~1a]{dwivedi2024kernel} with $m=1$ halving round, 
\khcompressd is simply the \textsc{KT-Split-Compress} algorithm of \citep[Ex.~3]{shetty2022distributioncompressionnearlineartime} with $\khd$ of \cref{algo:khd} substituted for $\ktsplit(\delta,m=1)$.  
The result now follows immediately from the \khd sub-Gaussian constant of \cref{khd-sub-gaussian} and the argument of \citet[Rem.~2, Ex.~3]{shetty2022distributioncompressionnearlineartime}.
%
\end{proof}

Now fix any SPSD $\K$ and any kernel $\k$ that generates $\K$. 
By \cref{lem:funct_subg_vector_subg}, we have that $\pin - \qout$ is $(\K,\subg)$-sub-Gaussian on $\event$ and hence that $\khcompress(\delta)  \in \ksubge$.
In addition, $\subg= \bigO{\frac{ \sqrt{\log(\nout) \log(\nout/\delta)}}{\nout}}$ when $\nout \geq \sqrt{\nin}$. 
Furthermore, \citet[Rem.~1]{shetty2022distributioncompressionnearlineartime} implies that $\khcompress(\delta)$ has a runtime less than $4^{\ossymb +1} \nin\parenth{\log_4(\nin) - \ossymb} = 4 \nout^2 \log_2 (\nin/\nout) = O(\nout^2)$ when $\nout \geq \sqrt{\nin}$.
