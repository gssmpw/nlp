\DeclareMathAlphabet{\mathbsf}{OT1}{cmss}{bx}{n}%
\DeclareMathAlphabet{\mathssf}{OT1}{cmss}{m}{sl}%

\newcommand{\vsep}{\vspace{-2mm}}
\newcommand{\size}{\mrm{Size}}
\newcommand{\power}{\mrm{Power}}
\newcommand{\numperm}{\mc B}
\newcommand{\hinfnorm}{\sinfnorm{\hkernel}}
\newcommand{\uptag}{\trm{up}}

\newcommand{\defeq}{\triangleeq}
\newcommand{\examend}{\hfill\small{\ensuremath{\blacksquare}}}
\newcommand{\examendmath}{\tag*{\small{\ensuremath{\blacksquare}}}}
\newcommand{\para}[1]{\noindent\tbf{#1}\ \ }

\newcommand{\failure}{\texttt{Failure}}
\newcommand{\etal}{\emph{et al.}}

%
\newcommand{\order}{\mc{O}}
\newcommand{\otil}{\wtil{\order}}

%
\newcommand{\set}[1]{\mc{#1}}
\newcommand{\ball}{\mathbb{B}}
\newcommand{\indicator}{\mbf 1}
\newcommand{\dims}{d}
\newcommand{\eventnotag}{\mc{E}}
\newcommand{\event}[1][]{\eventnotag_{#1}}


%
\newcommand{\snorm}[1]{\Vert #1 \Vert}
\newcommand{\sinfnorm}[1]{\snorm{#1}_\infty}
\newcommand{\sballnorm}[1]{\snorm{#1}_{\radius,\infty}}

%
\newcommand{\lone}{{L}^1}
\newcommand{\ltwo}{{L}^2}
\newcommand{\Ltwoinf}{{L}_{2,\infty}}
\newcommand{\weakgrad}{D}
\newcommand{\fun}{f}
\newcommand{\tilfun}{\til{\fun}}
\newcommand{\fourier}{\mc F}
\newcommand{\invfourier}{\fourier\inv}
\newcommand{\cover}{\mc C}
\newcommand{\extcover}{\mc C_{\textup{ext}}} %
\newcommand{\intcover}{\mc C_{\textup{int}}} %
\newcommand{\coveringnumber}{\mc N}
\newcommand{\linf}{l^\infty}
\newcommand{\Linf}{L^\infty}
\renewcommand{\natural}{\mbb{N}}
\newcommand{\nan}{\texttt{NaN}}
\newcommand{\real}{\ensuremath{\mathbb{R}}}

%
\newcommand{\suminf}[1][\l]{\sum_{#1=1}^\infty}
\newcommand{\suml}[1][\l]{\sum_{#1\leq \L}}
\newcommand{\sumgl}[1][\l]{\sum_{#1>L}}
\newcommand{\sumn}[1][i]{\sum_{#1=1}^n}
\newcommand{\sless}[1]{\stackrel{#1}{\leq}}
\newcommand{\sgrt}[1]{\stackrel{#1}{\geq}}
\newcommand{\seq}[1]{\stackrel{#1}{=}}


%
\newcommand{\w}{\mbi{w}}
\renewcommand{\v}{\mbi{v}}
\newcommand{\x}{\mbi{x}}
\newcommand{\y}{\mbi{y}}
\newcommand{\z}{\mbi{z}}
\renewcommand{\l}{\ell}
%
\newcommand{\vareps}{\varepsilon}
\newcommand{\dirac}{\mbi{\delta}}
\newcommand{\Exs}{\ensuremath{{\mathbb{E}}}}
\newcommand{\Prob}{\ensuremath{{\mathbb{P}}}}



%
\newcommand{\attention}{\textsc{Attention}}
\DeclareMathOperator{\mmd}{MMD}
\DeclareMathOperator{\kms}{KMS}
\def\Matern{Mat\'ern\xspace}
\DeclareMathOperator{\sech}{sech}

%
\newcommand{\kernel}{\mbf{k}}
\renewcommand{\k}{\kernel}
\newcommand{\xkernel}{\mbf{X}}
\newcommand{\mkernel}{\mbf{K}}
\newcommand{\K}{\mkernel}
\newcommand{\Ktilde}{\widetilde{\mkernel}}
\newcommand{\kmat}{\mkernel}
\newcommand{\hkernel}{\mbf{h}}
\newcommand{\rkhs}{\mc{H}_{\kernel}}
\newcommand{\hnorm}[1]{\Vert{#1}\Vert_{\rkhs}}
\newcommand{\bighnorm}[1]{\norm{#1}_\rkhs}
\newcommand{\knorm}[1]{\Vert{#1}\Vert_{\kernel}}
\newcommand{\kinfsin}[1][\kernel]{\Vert{#1}\Vert_{\infty,\textup{in}}}
\newcommand{\ksinfsin}{\kinfsin[\kersplit]}
\newcommand{\ksplitnorm}[1]{\Vert{#1}\Vert_{\kersplit}}
\newcommand{\bigknorm}[1]{\norm{#1}_\kernel}
\newcommand{\dotrkhs}[2]{\angles{#1}_{#2}}
\newcommand{\doth}[1]{\dotrkhs{#1}{\rkhs}}
\newcommand{\dotk}[1]{\dotrkhs{#1}{\kernel}}
\newcommand{\dotkrt}[1]{\dotrkhs{#1}{\ksqrt}}
\newcommand{\tail}[1][\kernel]{\tau_{#1}}
\newcommand{\klip}[1][\kernel]{L_{#1}}
\newcommand{\rttag}{\mrm{rt}}
\newcommand{\ksqrt}[1][\kernel]{{#1}_{\rttag}}
\newcommand{\ksqrtdom}[1][\kernel]{\widetilde{#1}_{\rttag}}
\newcommand{\kdom}[1][\kernel]{\widetilde{#1}}
\newcommand{\kappasqrt}[1][\kappa]{{#1}_{\rttag}}
\newcommand{\hatkappasqrt}[1][\widehat{\kappa}]{{#1}_{\rttag}}
\newcommand{\hatkappa}{\widehat{\kappa}}
\newcommand{\kappasqrtdom}[1][\kappa]{\widetilde{#1}_{\rttag}}
\newcommand{\kappadom}[1][\kappa]{{#1}_{\mrm{dom}}}
\newcommand{\hatkappadom}[1][\widehat{\kappa}]{{#1}_{\mrm{dom}}}
\newcommand{\rkhsqrt}[1][\rkhs]{{#1}_{\rttag}}
\newcommand{\funtwo}{g}
\newcommand{\ltwonorm}[1]{\norm{#1}_{2}}

%
\newcommand{\sgparam}[1][i]{\sigma_{#1}}
\newcommand{\vmax}[1][i]{\mathfrak{b}_{#1}}
\newcommand{\invec}[1][i]{f_{#1}}
\newcommand{\outvec}[1][i]{\psi_{#1}}
\newcommand{\coreset}[1][j]{\mathcal{S}^{(#1)}}
\newcommand{\ind}{\mathcal{I}}
\newcommand{\indout}{\ind_{\textup{out}}}


%

\newcommand{\concat}{\texttt{concatenate}}

%
\newcommand{\gaussparam}{\sigma}
\newcommand{\matone}{\nu}
\newcommand{\mattwo}{\gamma}
\newcommand{\splineparam}{\beta}
\newcommand{\sincparam}{\theta}
\newcommand{\sechparam}{a}
\newcommand{\bessel}[1][\matone]{{K}_{#1}}


%
\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\sbrackets}[1]{[ #1 ]}
\newcommand{\parenth}[1]{\left( #1 \right)}
\newcommand{\sparenth}[1]{( #1 )}
\newcommand{\bigparenth}[1]{\big( #1 \big)}
\newcommand{\biggparenth}[1]{\bigg( #1 \bigg)}
\newcommand{\braces}[1]{\left\{ #1 \right \}}
\newcommand{\sbraces}[1]{\{ #1  \}}
\newcommand{\abss}[1]{\left| #1 \right |}
\newcommand{\sabss}[1]{| #1  |}
\newcommand{\angles}[1]{\left\langle #1 \right \rangle}
\newcommand{\sangles}[1]{\langle #1 \rangle}
\newcommand{\ceils}[1]{\left\lceil #1 \right \rceil}
\newcommand{\ceil}[1]{\left\lceil #1 \right \rceil}
\newcommand{\floors}[1]{\left\lfloor #1 \right \rfloor}
\newcommand{\floor}[1]{\left\lfloor #1 \right \rfloor}
\newcommand{\tp}{^\top}
\newcommand{\inv}{^{-1}}

%
%
%
\newcommand{\sig}{\sigma}
\newcommand{\lam}{\lambda}
\newcommand{\Lam}{\Lambda}

%
%
%
\newcommand{\dt}{\,\dee t}
\newcommand{\ds}{\,\dee s}
\newcommand{\dx}{\,\dee x}
\newcommand{\dy}{\,\dee y}
\newcommand{\dz}{\,\dee z}
\newcommand{\dv}{\,\dee v}
\newcommand{\dw}{\,\dee w}
\newcommand{\dr}{\,\dee r}
\newcommand{\dB}{\,\dee B} %
\newcommand{\dW}{\,\dee W} %
\newcommand{\dmu}{\,\dee \mu}
\newcommand{\dnu}{\,\dee \nu}
\newcommand{\domega}{\,\dee \omega}

%
%
%
\newcommand{\smiddle}{\mathrel{}|\mathrel{}} %

%
%
%
\def\balign#1\ealign{\begin{align}#1\end{align}}
\def\baligns#1\ealigns{\begin{align*}#1\end{align*}}
\def\balignat#1\ealign{\begin{alignat}#1\end{alignat}}
\def\balignats#1\ealigns{\begin{alignat*}#1\end{alignat*}}
\def\bitemize#1\eitemize{\begin{itemize}#1\end{itemize}}
\def\benumerate#1\eenumerate{\begin{enumerate}#1\end{enumerate}}

%
\newenvironment{talign*}
 {\let\displaystyle\textstyle\csname align*\endcsname}
 {\endalign}
\newenvironment{talign}
 {\let\displaystyle\textstyle\csname align\endcsname}
 {\endalign}

\def\balignst#1\ealignst{\begin{talign*}#1\end{talign*}}
\def\balignt#1\ealignt{\begin{talign}#1\end{talign}}
%

%
%
%
\newcommand{\notate}[1]{\textcolor{blue}{\textbf{[#1]}}}
\newcommand{\response}[1]{\textcolor{magenta}{{[#1]}}}
\newcommand{\ac}[1]{\textcolor{red}{AC: 
\textbf{[#1]}}}
\newcommand{\rrd}[1]{\textcolor{magenta}{{RD: #1}}}
\newcommand{\rd}[1]{\rrd{#1}}
\newcommand{\cd}[1]{\green{CD: #1}}
\newcommand{\ag}[1]{\orange{AG: #1}}

%
%
%
%
%
%

%
%
%
\newcommand{\qtext}[1]{\quad\text{#1}\quad} 
\newcommand{\stext}[1]{\text{ #1 }} 
\newcommand{\sstext}[1]{\text{\ \ #1\ \ }} 

%
%
%
\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

%
%
%
\def\Gronwall{Gr\"onwall\xspace}
\def\Holder{H\"older\xspace}
\def\Ito{It\^o\xspace}
\def\Nystrom{Nystr\"om\xspace}
\def\Schatten{Sch\"atten\xspace}
\def\Matern{Mat\'ern\xspace}

%
%
%
\def\tinycitep*#1{{\tiny\citep*{#1}}}
\def\tinycitealt*#1{{\tiny\citealt*{#1}}}
\def\tinycite*#1{{\tiny\cite*{#1}}}
\def\smallcitep*#1{{\scriptsize\citep*{#1}}}
\def\smallcitealt*#1{{\scriptsize\citealt*{#1}}}
\def\smallcite*#1{{\scriptsize\cite*{#1}}}

%
%
%
\def\blue#1{\textcolor{blue}{{#1}}}
\def\green#1{\textcolor{green}{{#1}}}
\def\orange#1{\textcolor{orange}{{#1}}}
\def\purple#1{\textcolor{purple}{{#1}}}
\def\red#1{\textcolor{red}{{#1}}}
\def\teal#1{\textcolor{teal}{{#1}}}

%
%
%
\def\mbi#1{\boldsymbol{#1}} %
%
\def\mbf#1{\mathbf{#1}}
\def\mbb#1{\mathbb{#1}}
\def\mc#1{\mathcal{#1}}
\def\mrm#1{\mathrm{#1}}
\def\trm#1{\textrm{#1}}
\def\tbf#1{\textbf{#1}}
\def\tsc#1{\textsc{#1}}
\def\til#1{\tilde{#1}}
\def\wtil#1{\widetilde{#1}}
\def\mfk#1{\mathfrak{#1}}


%
%
%
\def\mbiA{\mbi{A}}
\def\mbiB{\mbi{B}}
\def\mbiC{\mbi{C}}
\def\mbiDelta{\mbi{\Delta}}
\def\mbif{\mbi{f}}
\def\mbiF{\mbi{F}}
\def\mbig{\mbi{g}}
\def\mbiG{\mbi{G}}
\def\mbih{\mbi{h}}
\def\mbiH{\mbi{H}}
\def\mbiI{\mbi{I}}
\def\mbim{\mbi{m}}
\def\mbiP{\mbi{P}}
\def\mbiQ{\mbi{Q}}
\def\mbiR{\mbi{R}}
\def\mbiv{\mbi{v}}
\def\mbiV{\mbi{V}}
\def\mbiW{\mbi{W}}
\def\mbiX{\mbi{X}}
\def\mbiY{\mbi{Y}}
\def\mbiZ{\mbi{Z}}
\newcommand{\boldzero}{{\boldsymbol{0}}}

%
%
%
\def\textsum{{\textstyle\sum}} %
\def\textprod{{\textstyle\prod}} %
\def\textbigcap{{\textstyle\bigcap}} %
\def\textbigcup{{\textstyle\bigcup}} %

%
%
%
\def\reals{\mathbb{R}} %
\def\R{\mathbb{R}}
\def\integers{\mathbb{Z}} %
\def\Z{\mathbf{Z}}
\def\rationals{\mathbb{Q}} %
\def\Q{\mathbb{Q}}
\def\naturals{\mathbb{N}} %
\def\N{\mathbb{N}}
\def\complex{\mathbb{C}} %

%
%
%
\def\<{\left\langle} %
\def\>{\right\rangle}

\def\iff{\Leftrightarrow}
\def\implies{\quad\Longrightarrow\quad}
%
\def\chooses#1#2{{}_{#1}C_{#2}}
\def\defeq{\triangleq} %
\def\bs{\backslash} %
\def\half{\frac{1}{2}}
\def\quarter{\frac{1}{4}}
\def\textint{{\textstyle\int}} %
\def\texthalf{{\textstyle\frac{1}{2}}}
\newcommand{\textfrac}[2]{{\textstyle\frac{#1}{#2}}}
%
%
%
\newcommand{\psdle}{\preccurlyeq}
\newcommand{\psdge}{\succcurlyeq}
\newcommand{\psdlt}{\prec}
\newcommand{\psdgt}{\succ}

%
%
%
\newcommand{\boldone}{\mbf{1}} %
%
\newcommand{\ident}{\mbf{I}} %
%
\def\norm#1{\left\|{#1}\right\|} %
\def\snorm#1{\|{#1}\|} %
\newcommand{\zeronorm}[1]{\norm{#1}_0} %
\newcommand{\onenorm}[1]{\norm{#1}_1} %
\newcommand{\twonorm}[1]{\staticnorm{#1}_2} %
\newcommand{\infnorm}[1]{\staticnorm{#1}_{\infty}} %
\newcommand{\maxnorm}[1]{\staticnorm{#1}_{\max}} %
\newcommand{\Kmax}{\maxnorm{\K}} %
\newcommand{\opnorm}[1]{\staticnorm{#1}_{\operatorname{op}}} %
\newcommand{\sopnorm}[1]{\snorm{#1}_{\mathrm{op}}} %
\newcommand{\fronorm}[1]{\norm{#1}_{F}} %
\newcommand{\specnorm}[1]{\opnorm{#1}} %
\newcommand{\colnorm}[1]{\staticnorm{#1}_{1,2}} %
\newcommand{\rownorm}[1]{\staticnorm{#1}_{2,\infty}} %

\def\staticnorm#1{\|{#1}\|} %
\newcommand{\statictwonorm}[1]{\staticnorm{#1}_2} %
\newcommand{\staticinfnorm}[1]{\staticnorm{#1}_\infty} %
\newcommand{\inner}[2]{\langle{#1},{#2}\rangle} %
\newcommand{\binner}[2]{\left\langle{#1},{#2}\right\rangle} %
\def\what#1{\widehat{#1}}

\def\twovec#1#2{\left[\begin{array}{c}{#1} \\ {#2}\end{array}\right]}
\def\threevec#1#2#3{\left[\begin{array}{c}{#1} \\ {#2} \\ {#3} \end{array}\right]}
\def\nvec#1#2#3{\left[\begin{array}{c}{#1} \\ {#2} \\ \vdots \\ {#3}\end{array}\right]} %

%
%
%
\newcommand{\maxeig}{\lambda_{\max}}
\def\mineig#1{\lambda_{\mathrm{min}}\left({#1}\right)}

%
%
%
\def\Re{\operatorname{Re}} %
\def\indic#1{\indicator\left[{#1}\right]} %
\def\logarg#1{\log\left({#1}\right)} %
\def\polylog{\operatorname{polylog}}
\def\maxarg#1{\max\left({#1}\right)} %
\def\minarg#1{\min\left({#1}\right)} %
\def\E{\mbb{E}} %
\def\Earg#1{\E\left[{#1}\right]}
\def\Esub#1{\E_{#1}}
\def\Esubarg#1#2{\E_{#1}\left[{#2}\right]}
\def\bigO#1{O(#1)} %
\def\littleO#1{o(#1)} %
\def\P{\mbb{P}} %
\def\Parg#1{\P\left({#1}\right)}
\def\Psubarg#1#2{\P_{#1}\left({#2}\right)}
%
\def\Trarg#1{\Tr\left[{#1}\right]} %
\def\trarg#1{\tr\left[{#1}\right]} %
\def\Var{\mrm{Var}} %
\def\Vararg#1{\Var\left[{#1}\right]}
\def\Varsubarg#1#2{\Var_{#1}\left[{#2}\right]}
\def\Cov{\mrm{Cov}} %
\def\Covarg#1{\Cov\left[{#1}\right]}
\def\Covsubarg#1#2{\Cov_{#1}\left[{#2}\right]}
\def\Corr{\mrm{Corr}} %
\def\Corrarg#1{\Corr\left[{#1}\right]}
\def\Corrsubarg#1#2{\Corr_{#1}\left[{#2}\right]}
\newcommand{\info}[3][{}]{\mathbb{I}_{#1}\left({#2};{#3}\right)} %
%
\newcommand{\staticexp}[1]{\operatorname{exp}(#1)} %
\newcommand{\loglihood}[0]{\mathcal{L}} %

%
%
%
\newcommand{\Gsn}{\mathcal{N}}
\newcommand{\BeP}{\textnormal{BeP}}
\newcommand{\Ber}{\textnormal{Ber}}
\newcommand{\Bern}{\textnormal{Bern}}
\newcommand{\Bet}{\textnormal{Beta}}
\newcommand{\Beta}{\textnormal{Beta}}
\newcommand{\Bin}{\textnormal{Bin}}
\newcommand{\BP}{\textnormal{BP}}
\newcommand{\Dir}{\textnormal{Dir}}
\newcommand{\DP}{\textnormal{DP}}
\newcommand{\Expo}{\textnormal{Expo}}
\newcommand{\Gam}{\textnormal{Gamma}}
\newcommand{\GEM}{\textnormal{GEM}}
\newcommand{\HypGeo}{\textnormal{HypGeo}}
\newcommand{\Mult}{\textnormal{Mult}}
\newcommand{\NegMult}{\textnormal{NegMult}}
\newcommand{\Poi}{\textnormal{Poi}}
\newcommand{\Pois}{\textnormal{Pois}}
\newcommand{\Unif}{\textnormal{Unif}}


%
%
%
\newcommand{\grad}{\nabla} %
\newcommand{\Hess}{\nabla^2} %
\newcommand{\lapl}{\triangle} %
\newcommand{\deriv}[2]{\frac{d #1}{d #2}} %
\newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}} %

%
%
%
\newcommand{\eqdist}{\stackrel{d}{=}}
\newcommand{\todist}{\stackrel{d}{\to}}
\newcommand{\toprob}{\stackrel{p}{\to}}
\newcommand{\eqd}{\stackrel{d}{=}}
\def\KL#1#2{\textnormal{KL}({#1}\Vert{#2})}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern4mu{#1#2}}}
\def\indep{\perp\!\!\!\perp} %
\newcommand{\iid}{\textrm{i.i.d.}\ }
\newcommand{\dist}{\sim}
\newcommand{\distiid}{\overset{\textup{\tiny\iid}}{\dist}}
\newcommand{\distind}{\overset{\textup{\tiny\textrm{indep}}}{\dist}}
%
%
%
\providecommand{\esssup}{\mathop\mathrm{ess\,sup}} 
\providecommand{\argmax}{\mathop\mathrm{arg max}} %
\providecommand{\argmin}{\mathop\mathrm{arg min}}
\providecommand{\arccos}{\mathop\mathrm{arccos}}
\providecommand{\dom}{\mathop\mathrm{dom}}
\providecommand{\diag}{\mathop\mathrm{diag}}
\providecommand{\tr}{\mathop\mathrm{tr}}
%
\providecommand{\card}{\mathop\mathrm{card}}
\providecommand{\diam}{\mathop\mathrm{diam}}
\providecommand{\sign}{\mathop\mathrm{sign}}
\providecommand{\conv}{\mathop\mathrm{conv}} %
\def\rank#1{\mathrm{rank}({#1})}
\newcommand\epsrank[1][\eps]{\mathrm{rank}_{#1}}

\def\supp#1{\mathrm{supp}({#1})}

\providecommand{\minimize}{\mathop\mathrm{minimize}}
\providecommand{\maximize}{\mathop\mathrm{maximize}}
\providecommand{\subjectto}{\mathop\mathrm{subject\;to}}

%

\def\openright#1#2{\left[{#1}, {#2}\right)}

%
%
%
\ifdefined\nonewproofenvironments\else
%
%
%
%
\ifdefined\ispres\else
%
%
%
%
%
%
%
%

%

%

%
\newenvironment{proof-sketch}{\noindent\textbf{Proof Sketch}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-idea}{\noindent\textbf{Proof Idea}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proof-of-lemma}[1][{}]{\noindent\textbf{Proof of Lemma {#1}}
  \hspace*{1em}}{\qed\\}
\newenvironment{proof-of-theorem}[1][{}]{\noindent\textbf{Proof of Theorem {#1}}
  \hspace*{1em}}{\qed\\}
\newenvironment{proof-attempt}{\noindent\textbf{Proof Attempt}
  \hspace*{1em}}{\qed\bigskip\\}
\newenvironment{proofof}[1]{\noindent\textbf{Proof of {#1}}
  \hspace*{1em}}{\qed\bigskip\\}
%
%
%
%
%
%
%
%
%
%
%
%
%
%

%
\newcommand{\normfunoutput}{\phi}
\newcommand{\subgammavariance}{\nu}
\newcommand{\subgammalocation}{\gamma}


%
\newcommand{\knum}[2][R]{N_\kernel(#1,#2)}
\newcommand{\krtnum}[2][R]{N_\ksqrt(#1,#2)}

%
\newcommand{\domain}{\mathcal{D}}
\newcommand{\fanc}{\mathfrak{c}}

%
\newcommand{\kmod}{\omega_{\kernel}}
\newcommand{\krtmod}{\omega_{\ksqrt}}

%
\newcommand{\cset}{\mc{S}}
\newcommand{\alg}{\textsc{Alg}\xspace}
\newcommand{\algset}{\cset_{\alg}}
\newcommand{\inputcoreset}{\cset_{\textup{in}}}
\newcommand{\outputcoreset}{\cset_{\textup{out}}}
\newcommand{\ktcoreset}{\cset_{\mrm{KT}}}
\newcommand{\stcoreset}{\cset_{\mrm{ST}}}
\newcommand{\basecoreset}{\cset_{\mrm{base}}}
\newcommand{\rratio}{\kappa}
\newcommand{\rmin}{\mfk{S}}
\newcommand{\rminpn}[1][\inputcoreset]{\rmin_{#1}}
\newcommand{\rminrt}{\rmin_{\ksqrt, n}}
\newcommand{\rminrtd}{\rmin_{\ksqrt,n}^{\dagger}}
\newcommand{\epss}{\epssmall}

\newcommand{\shiftparam}{a}
\newcommand{\kgaussparam}{v}

%
\newcommand{\err}{\mathfrak{N}}%


\newcommand{\splineconst}[1][\splineparam+1]{S_{#1}}
\newcommand{\linparam}{\theta}
\newcommand{\kersplit}[1][]{\kernel_{{#1}}'}%
\newcommand{\hsplit}[1][]{\hkernel_{{#1}}'}%
 \newcommand{\kttag}{\mrm{KT}}
\newcommand{\kt}{\textsc{KT}\xspace}
\newcommand{\kinf}{\infnorm{\kernel}}
%
\newcommand{\ktsplitlink}{\hyperref[algo:ktsplit]{\textsc{kt-split}}\xspace}
\newcommand{\ktswap}{\hyperref[algo:ktswap]{\color{black}{\textsc{kt-swap}}}\xspace}
\newcommand{\ktswaplink}{\hyperref[algo:ktswap]{\textsc{kt-swap}}\xspace}


%
\newcommand{\Wendland}[1][\wendparam]{{\bf Wendland$(#1)$}\xspace}

%
%

%

\newcommand{\halve}{\textsc{Halve}\xspace}
%
\newcommand{\osname}{compression level\xspace}
%
\newcommand{\ossymb}{\ensuremath{\mfk{g}}\xspace}
\newcommand{\compress}{\textsc{Compress}\xspace}
%
\newcommand{\ktcompress}{\hyperref[app:ktcompress]{\color{black}{\textsc{KT-Compress}}}\xspace}

\newcommand{\ktcompressd}{\text{$\ktcompress(\delta)$}\xspace}
\newcommand{\compresssub}{\textsc{C}}
\newcommand{\compresspp}{\textsc{Compress++}\xspace}
\newcommand{\compressppsub}{\textsc{C++}\xspace}
\newcommand{\compressmmdthmname}{MMD guarantees for \textsc{Compress}\xspace}
\newcommand{\genmat}{\mbf{M}}

\newcommand{\ktsplitt}{\tbf{KT-Split}}

\newcommand{\compressppoutput}{\funoutput_{\compresspp}}
\newcommand{\recursehalf}{\textbf{RecHalve}\xspace}
\newcommand{\rhshort}{\trm{RH}}
\newcommand{\recursehalveoutput}{ \funoutput_{\rhshort}  }
\newcommand{\recdepthname}{depth parameter}
\newcommand{\recdepthsymb}{m}
 \newcommand{\rechalvesubgammathmname}{\recursehalf Subgamma Guarantees}
 
\newcommand{\mmdest}{\widehat{\mmd}}

\newcommand{\nullhypo}{\mc H_{0}}
\newcommand{\althypo}[1][1]{\mc H_{#1}}
\newcommand{\threshold}[1][\alpha]{t_{#1}}

\newcommand{\block}{B}
\newcommand{\mmdblock}{\mmd_{\block}}
\newcommand{\mmdkernel}{\mmd_{\kernel}}
\newcommand{\mmdincomplete}{\mmd_{\trm{inc}}}

\newcommand{\hatxs}[1][m]{\hat{\mathbb{X}}_{#1}}
\newcommand{\hatys}{\hat{\mathbb{Y}}_n}
\newcommand{\hatzs}[1][]{\hat{\mbb{Z}}_{#1}}

\newcommand{\tout}{\textup{out}}
\newcommand{\tin}{\textup{in}}

%
\newcommand{\ctt}{\hyperref[algo:ctt]{\color{black} \textup{CTT}}\xspace}
\newcommand{\cttd}{\text{$\ctt(\delta)$}\xspace}
\newcommand{\deltactt}{\Delta_{\ctt}}
\newcommand{\actt}{\textup{ACTT}\xspace}
\newcommand{\deltaactt}{\Delta_{\actt}}
\newcommand{\lctt}{\textup{LR-CTT}\xspace}
\newcommand{\feat}[1][r]{\Phi_{#1}} %
\newcommand{\featmmd}[1][r]{\mmd_{\feat[#1]}} %
\newcommand{\featerr}[1][r]{\eps_{\feat[#1]}} %
\newcommand{\deltalctt}{\Delta_{\lctt}}
\newcommand{\mmdagg}{\textsc{MMDAgg}\xspace}
\newcommand{\cttname}{{Compress Then Test}\xspace}
\newcommand{\acttname}{{Aggregated \ctt}\xspace}
\newcommand{\acttnamelower}{{Aggregated \ctt}\xspace}
\newcommand{\lcttname}{{Low-Rank \ctt}\xspace}
\newcommand{\tmmd}{\textsc{CoresetMMD}\xspace}
\newcommand{\ltmmd}{\textup{LR}-\textsc{CoresetMMD}\xspace}

\newcommand{\fset}{\mc{F}}
\newcommand{\fsetlin}{\fset_{\mrm{lin}}}
\newcommand{\rkhsfun}{\mfk{f}}
\newcommand{\rkhsrv}{G}
\newcommand{\funoutput}{\psi}
\newcommand{\halveoutput}{\funoutput_{\halve}}
\newcommand{\halvesubgauss}[1][n]{\sigma_{\halve}(#1)}
\newcommand{\compressoutput}{\funoutput_{\compress}}
\newcommand{\thin}{\textsc{Thin}\xspace}
\newcommand{\algcoreset}{\cset_{\alg}}

    \newcommand{\subgammar}{\Gamma_+}
    \newcommand{\subgammal}{\Gamma_{-}}
    \newcommand{\subgamma}{\Gamma}
    \newcommand{\subgsn}{\mathcal{G}}
    \newcommand{\subgammarparams}{\left( \sigma^2 , c \right)}
    \newcommand{\fsubgammar }{ \Gamma_{+}^{\fset} }
    \newcommand{\fsingsubgammar}{\Gamma_{+}^{f}  }
    \newcommand{\fsingsubgamma}{\mathcal{G}^{f}  }
    \newcommand{\subgammaerror}{\vareps}
    \newcommand{\thinning}{\textsc{Thin}\xspace}
\renewcommand{\thin}{\textsc{Thin}\xspace}
%

\newcommand{\nin}{n_{\textup{in}}}
\newcommand{\nout}{n_{\textup{out}}}

\newcommand{\mmdtag}{\mrm{M}}
\newcommand{\simentropy}{\mc M_{\kernel}}
\newcommand{\entropy}[1][\frac1n]{\simentropy(\ball_2(R),#1)}

 \newcommand{\thintag}{\textsc{T}} 
\newcommand{\halvetag}{\textsc{H}}
\newcommand{\lng}{\l_n}
\newcommand{\rounds}{\beta_n}

\newcommand{\ncref}[1]{\cref{#1}: \nameref*{#1}} %

\newcommand{\pcref}[1]{Proof of \ncref{#1}} %

\newcommand{\terror}[1][\kernel]{\mathbsf{\tilde{R}}_{#1}}
\newcommand{\error}[1][\kernel]{\mathbsf{R}_{#1}}
\newcommand{\errorsplit}[1][]{\error[{\kernel_{#1}},{\kersplit[#1]}]}
\newcommand{\errorhsplit}[1][]{\error[{\hkernel_{#1}},{\hsplit[#1]}]}
\newcommand{\errtwo}{\mathbsf{M}_{\kernel}}
\newcommand{\errtwosplit}{\mfk{M}_{\kersplit}}
%
\newcommand{\errorhat}[1][\kernel]{\what{\mathbsf{R}}_{#1}}

%
\newcommand{\sblock}{s} %
%
\newcommand{\binsize}{z} %
\newcommand{\speedup}{\ensuremath{200\times}\xspace}
\newcommand{\speedupfive}{\ensuremath{5\times}\xspace}
\newcommand{\speeduptwenty}{\ensuremath{20\times}\xspace}
\newcommand{\klam}[1][\lam]{\kernel_{#1}}
\newcommand{\kslam}[1][\lam]{{\kersplit[#1]}}
\newcommand{\clam}[1][\lam]{e_{#1}}
\newcommand{\aggtag}{\textsc{agg}}
\newcommand{\ktagg}{\ktcompress-\aggtag\xspace}
\newcommand{\kagg}{\kersplit}
%
\newcommand{\kagginf}{\kinfsin[{\kagg}]}
\newcommand{\epsagg}{\vareps_{\aggtag}}
\newcommand{\sumagginf}{C_{\Lam}}%
\newcommand{\ksinf}{C_{\lam}}%
\newcommand{\ckk}[1][\Ktilde]{C_{#1}}
\newcommand{\mkk}[1][\Ktilde]{\mathfrak{M}_{#1}}
\newcommand{\ackk}{C_{\kernel_{\lam},\kersplit}}
\newcommand{\amkk}{\mfk{M}_{\kernel_{\lam},\kersplit}}

%
\newcommand{\cnew}[1][i]{\mfk{a}_{#1}}
\newcommand{\ksplitcoresets}{(\coreset[m, \l])_{\l=1}^{2^{m}}}

%
\newcommand{\bpsi}{\boldsymbol{\psi}}
\newcommand{\tpsi}{\boldsymbol{\widetilde{\psi}}_r}
\newcommand{\tdpsi}{\boldsymbol{\widetilde{\psi}}_d}
\newcommand{\bu}{\boldsymbol{u}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bz}{\boldsymbol{z}}
\newcommand{\bX}{\boldsymbol{X}}
\newcommand{\X}{\mbf X}
\newcommand{\Xin}{\mbf X_{\textup{in}}}
\newcommand{\bA}{\boldsymbol{A}}
\newcommand{\bPhi}{\boldsymbol{\Phi}}

\newcommand{\opthalvefour}{\textsc{OptHalve4}\xspace}

\newcommand{\Rd}{\reals^d}
\newcommand{\Rn}{\reals^n}
\newcommand{\Rr}{\reals^r}
%
\newcommand{\prw}[1]{\textrm{proj}_{W_r}(#1)}

\newcommand{\simplex}[1][n-1]{\mbi{\Delta}_{#1}}
\newcommand{\Ncov}{\mathcal{N}_{1/2}}
\newcommand{\uball}{B_1^r(0)}
\newcommand{\huball}{B_{1/2}^r(0)}
\newcommand{\vsubg}{\bpsi }
\newcommand{\subg}{\nu}
\newcommand{\fsubg}{\phi}
\newcommand{\ksubg}{\mathcal{G}_{\nu}(\mkernel)}
\newcommand{\ksubge}[1][\mkernel]{\mathcal{G}_{\nu,\delta}(#1)}
\newcommand{\xsubg}{\mathcal{G}(\mbf{X},\nu)}
\newcommand{\ncnout}{{n \choose \nout}}
\newcommand{\Pout}{\mathcal{P}_{\nout}}
\newcommand{\ltwoadderr}{\trm{A}_{2}}
\newcommand{\D}{\mbf{D}}
\newcommand{\hD}{\mbf{\hat{D}}}
\newcommand{\Dinv}{\D^{-1}}
\newcommand{\hDinv}{\hat{\D}^{-1}}
\newcommand{\dav}{\mbf D^{-1}\mbf A \mbf V}
\newcommand{\dacolv}{\Dinv \A \mbi v}
\newcommand{\hdav}{\hat{\D}^{-1} \widehat{\A} \V}
\newcommand{\hddav}{\hat{\D}^{-1}\A \V}
\newcommand{\hadav}{\Dinv \widehat{\A} \V}
\newcommand{\av}{\A \V}
\newcommand{\hav}{\widehat{\A} \V}
\newcommand{\ha}{\widehat{\A}}

\newcommand{\Kattsingle}{\K_{\dacolv}}
\newcommand{\Kattmulti}{\K_{\dacolv}}
\newcommand{\Katt}[1][]{\K_{\mathrm{att}#1}}
\newcommand{\attindnorm}[1][\ind]{\snorm{\Katt (\pin-\qout)}_{#1}}

\newcommand{\subgbound}{(4\subg \sqrt{r} + 2\subg \sqrt{2\log(1/\delta)})^2 + \lambda_{r+1}(\frac{1}{\nout} + \frac{3}{n})}

\newcommand{\diffexp}{\E_q[\xkernel]-\E_p[\xkernel]}

\newcommand{\qout}[1][\textup{out}]{\mbi{p}_{#1}}
\newcommand{\pin}[1][\textup{in}]{\mbi{p}_{#1}}
\newcommand{\pini}[1][i]{\pin[\textup{in},#1]}

\newcommand{\Cd}{C_{\sqrt{d}}}


\newcommand{\e}{\mbi{e}}
%
\newcommand{\I}{\mbi{I}}

\newcommand{\indnorm}[1][\K (\pin-\qout)]{\norm{#1}_{\ind}}
\newcommand{\maxind}{\maxnorm{\K_{\ind,\ind}}}
\newcommand{\inddiam}{D_{\ind}}

\newcommand{\znorm}[1][\Zset]{\norm{(\Pin-\Qout)\k}_{#1}}
\newcommand{\zznorm}[1][\Zset,\Zset]{\norm{(\Pin-\Qout)\k}_{#1}}
\newcommand{\fnorm}[1][\Fset]{\norm{\Pin-\Qout}_{#1}}


\newcommand{\bC}{\mathbf{C}}

\newcommand{\bLam}{\mbi{\Lambda}}
%
\newcommand{\diff}{\mbi{w}} %
\newcommand{\eps}{\epsilon}

\newcommand{\sphere}[1][r-1]{\mbb{S}^{#1}}

\newcommand{\mmdbound}{\subg^2 \brackets{7.4r+2.8\log(\frac{1}{\delta'})} + \lambda_{r+1}(\frac{1}{\nout} -\frac{1}{n})}

\newcommand{\mmdpq}{\mmd_{\K}(\pin,\qout)}

\newcommand{\indnormboundn}{\subg\sqrt{2\maxnorm{\K_{\ind,\ind}}}\bigg(1+ \sqrt{ \rank{\X_{\ind}}\log(1+\frac{4\sqrt{2}L_{\kernel}\max_{i\in\ind}\twonorm{\x_i}}{\subg\sqrt{\maxnorm{\K_{\ind,\ind}}}})+\log(\frac{2}{\delta'})}\bigg)}
\newcommand{\attentionboundsingle}{\indnormboundn}
\newcommand{\attentionboundmulti}{\sqrt{d} \maxnorm{V} \attentionboundsingle}
\newcommand{\attindnormbound}{32\sqrt{\frac{4}{3}\,(2d+1)(\log{(3 \e^2 R S \exp{(S\sqrt{R^2-1})})})} \\
+ \sqrt{2\log(4/\delta')}(1+\frac{32}{\sqrt{3}})}

\newcommand{\attindnormboundold}{32\sqrt{\frac{4}{3}\,(2d+1)(\log(3R) %
+ (\frac{d+2}{2\sqrt{d}}\twonorm{\query^*})- \frac{\twonorm{\query^*}^2}{\sqrt{d}}}) %
+ \sqrt{2\log(4/\delta')}(1+\frac{32}{\sqrt{3}})}
\newcommand{\A}{\mbf A}
\newcommand{\M}{\mbf{M}}
\newcommand{\B}{\mbf B}
\newcommand{\V}{\mbf V}
\newcommand{\U}{\mbf U}
\newcommand{\Sig}{\mbf \Sigma}
\newcommand{\T}{\mbf T}
\newcommand{\That}{\mbf{\hat{T}}}
\newcommand{\Tthin}{\mbf{\hat{T}}_{\textrm{thin}}}
\newcommand{\Tkde}{\mbf{\hat{T}}_{\textrm{kde}}}
\newcommand{\Thyp}{\mbf{\hat{T}}_{\textrm{hyp}}}


\newcommand{\balinner}{\sum_{i=1}^{j} \bigparenth{\grad f(\w; \z_{\sigma(i)}) - \grad f(\mbi w)}}
\newcommand{\balnorm}{\twonorm{\balinner}}

\newcommand{\balobjective}{\max_{j \in [n]} \twonorm{\sum_{i=1}^{j} \bigparenth{\grad f(\w; \z_{\sigma(i)}) - \grad f(\w)}}}
\newcommand{\ntwobalobjective}{\max_{j \in [\frac{n}{2}]} \twonorm{\sum_{i=1}^{j} \bigparenth{\grad f(\w; \z_{\sigma(i)}) - \grad f(\w)}}}

\newcommand{\attentionmultiplier}{(\maxnorm{(\frac{1}{n}\D)^{-1}}\maxnorm{\V} + \maxnorm{\Dinv})}

\newcommand{\Fset}{\mathcal{F}}
\newcommand{\Zset}{\mathcal{Z}}
\newcommand{\Xset}{\mathcal{X}}
\newcommand{\Aset}{\mathcal{A}}
\newcommand{\Lset}{\mathcal{L}}
\newcommand{\q}{\mbi{q}}
\newcommand{\p}{\mbi{p}}

\newcommand{\Kinmat}{\K_{\textup{in}}}
\newcommand{\Qinmat}{\mbf Q_{\textup{in}}}
\newcommand{\Vinmat}{\V_{\textup{in}}}
\newcommand{\Koutmat}{\K_{\textup{out}}}
\newcommand{\Voutmat}{\V_{\textup{out}}}

%
%
%

\renewcommand{\hat}[1]{\widehat{#1}}

\newcommand{\subgmmdbound}{\subg^2 \brackets{7.4r+2.8\log(\frac{1}{\delta'})} + \lambda_{r+1}(\frac{1}{\nout} -\frac{1}{n})}

\newcommand{\ktsplitbalbound}{\frac{n}{2}\sqrt{(\frac{4 \maxnorm{\K}\log(n/2\delta)}{n^2}) \brackets{7.4r+2.8\log(\frac{1}{\delta'})} + \lambda_{r+1}(\frac{1}{\nout} -\frac{1}{n})}}

\newcommand{\Eevent}{\Esub{\event}}
\newcommand{\Pevent}{\P_{\event}}

\newcommand{\mcJ}{\mc{J}}

\newcommand{\katt}{\kernel_{\mathrm{att}}}

\newcommand{\xinatt}{(\Qinmat, \Kinmat \tilde{\V})}

\newcommand{\key}{\mbi{k}}
\newcommand{\augkey}{\tilde{\key}}
\newcommand{\val}{\mbi{v}}
\newcommand{\augval}{\tilde{\val}}
\newcommand{\augV}{\widetilde{\V}}
\newcommand{\query}{\mbi{q}}
\newcommand{\augquery}{\tilde{\query}}
\newcommand{\Qmat}{\mbf Q}
\newcommand{\W}{\mbf W}


\newcommand{\subsampling}{\hyperref[sub:subsampling]{\color{black}{\textsc{Subsampling}}}\xspace}
\newcommand{\ktsplit}{\hyperref[sub:kt-split]{\color{black}{\textsc{KT-Split}}}\xspace}
\newcommand{\ktsplitd}{\text{$\ktsplit(\delta)$}\xspace}
\newcommand{\ktsplithalf}{\text{$\ktsplit(0.5)$}\xspace}
\newcommand{\kh}{\hyperref[algo:khd]{\color{black}{\textsc{KH}}}\xspace}
\newcommand{\khd}{\text{$\kh(\delta)$}\xspace}
\newcommand{\khhalf}{\text{$\kh(0.5)$}\xspace}
\newcommand{\khsgd}{\text{$\khlin(\frac{1}{2K})$}\xspace}
\newcommand{\rkh}{\hyperref[algo:rkhd]{\color{black}{\textsc{RKH}}}\xspace}
\newcommand{\rkhd}{\text{$\rkh(\delta)$}\xspace}
\newcommand{\rkhsgd}{\text{$\rkh(\frac{1}{2K})$}\xspace}
\newcommand{\khcompress}{\hyperref[algo:khcompressd]{\color{black}{\textsc{KH-Compress}}}\xspace}
\newcommand{\khcompressd}{\text{$\khcompress(\delta)$}\xspace}
\newcommand{\khcompresshalf}{\text{$\khcompress(0.5)$}\xspace}
\newcommand{\gsthin}{\hyperref[algo:gs_thin]{\color{black}{\textsc{GS-Thin}}}\xspace}
\newcommand{\gshalve}{\hyperref[algo:gs_halve]{\color{black}{\textsc{GS-Halve}}}\xspace}
\newcommand{\gshalvecubic}{\hyperref[algo:gs_halve_cubic]{\color{black}{\textsc{GS-Halve-Cubic}}}\xspace}
\newcommand{\gscompress}{\hyperref[algo:gs_compress]{\color{black}{\textsc{GS-Compress}}}\xspace}

\newcommand{\khlin}{\hyperref[algo:khlin]{\color{black}{\textsc{LKH}}}\xspace}
\newcommand{\khlind}{\text{$\khlin(\delta)$}\xspace}

\newcommand{\xset}{\mc X}
\newcommand{\xin}{\xset_{\textup{in}}}
\newcommand{\xinj}[1][j]{\xset_{\textup{in},#1}}
\newcommand{\xoutj}[1][j]{\xset_{\textup{out},#1}}
\newcommand{\xp}{\xset'}
\newcommand{\xout}{\xset_{\textup{out}}}
\newcommand{\xinmat}{\xkernel_{\textup{in}}}
\newcommand{\xoutmat}{\xkernel_{\textup{out}}}
\newcommand{\Pin}{\mbb P_{\textup{in}}}
\newcommand{\Qout}{\mbb P_{\textup{out}}}
\newcommand{\muin}{\mu_{\textup{in}}}
\newcommand{\muout}{\mu_{\textup{out}}}

\newcommand{\Otilde}{\widetilde{O}}

\newcommand{\lip}[1][]{L_{#1}} %

\newcommand{\fstar}{f^\star}
\newcommand{\jstar}{j^\star}
\newcommand{\xbar}{\bar{\x}}

\newcommand{\lipschitzattention}{S\exp{(S\sqrt{R^2 - 1})}}

\newcommand{\attlip}{L_{\K^{\tilde{\V}}}}

\newcommand{\wtpsi}{\widetilde{\psi}} 
\newcommand{\thresh}{\mathfrak{a}}
\newcommand{\multiplier}{\mathfrak{b}}
\newcommand{\perm}{\pi}
\newcommand{\lfront}{\Pi}%
\newcommand{\lback}{\Pi'}%




\makeatletter
\newcommand\footnoteref[1]{\protected@xdef\@thefnmark{\ref{#1}}\@footnotemark}
\makeatother