\section{Pure DP Upper Bounds by the Exponential Mechanism}

\label{app:exponential_mechanism}

We show in this section that the exponential mechanism for a suitable score function and histogram support size provides rates which are slightly tighter than those encountered by $\PREM$ (by a polylog$n$ factor), at the expense of running time that is quasi-polynomial in $n,|\cX|,|\cF|$. 

\begin{theorem} \label{thm:Pure_DP_Upper_Bound}
There exists an $\eps$-DP mechanism such that it computes an $(\zeta,\alpha,\beta)$-accurate histogram, where
\[ \alpha \leq 2\sqrt{\frac{16(1+\zeta)e n}{\eps \zeta^2}\ln(4|{\cal F}|)\ln|{\cal X}|}+\frac{2(1+\zeta)}{\eps}\ln\frac{1}{\beta}. \]
\end{theorem}

Instrumental to the analysis of our algorithm is the existence of sparse datasets which relatively approximate arbitrary histograms. This is a multiplicative/additive counterpart of an additive version proved in \citep{BlumLR13}.



\begin{proposition} \label{prop:existence_approx_histogram}
Let $0<\zeta<1$ and $\alpha'\in(0,n]$ and ${\cal F}$ a set of linear queries. Then, for any histogram $\bh^{\ast}\in\R_+^{\cX}$ with $\|\bh^{\ast}\|_1=n$, there exists a (rescaled) histogram $\tbh\in\N_+^{\cX}$ with $\|\tbh\|_1=n$ and support size 
$k=\frac{8e}{\zeta^2}\frac{n}{\alpha'}\ln(4|{\cal F}|)$ such that for all $f\in {\cal F}$
\begin{equation} \label{eqn:approx_multip}
(1-\zeta)f(\bh^{\ast}) - \alpha' \leq f(\tbh) \leq (1+\zeta) f(\bh^{\ast})+\alpha'.
\end{equation}
\end{proposition}

\begin{proof} Let $0<\beta<1$ to be determined. Let $\tbh\in\mathbb{N}^{|\cX|}$ obtained as the histogram obtained from $k$ samples with replacement from the probability distribution $\bh^{\ast}/n\in \Delta_{\cX}$, and repeating each sample $n/k$ times. Denote those samples as $x_1,\ldots,x_k$ and note that $f(\tbh)=\frac{n}{k}\sum_{i=1}^k f(x_i)$, hence $f(\tbh)$ is a (scaled) sum of independent Bernoulli, and furthermore $\mathbb{E}[f(\tbh)]=n\mathbb{E}[f(x_1)]=f(\bh^{\ast})$.

We divide the analysis into bounding the probabilities for both the upper and lower multiplicative/additive  bounds.

\noindent\textbf{Upper bound.} We analyze the deviations by cases. First, if $2ef(\bh^{\ast}) < \alpha'$, then by \Cref{lem:Mulzer},
\[
\mathbb{P}[ f(\tbh) >(1+\zeta)f(\bh^{\ast})+\alpha'] \leq \mathbb{P}[ f(\tbh) >\alpha'] 
= \mathbb{P}\Big[ \sum_{i=1}^k f(x_i) >\frac{k\alpha'}{n} \Big] 
\leq 2^{-\frac{k\alpha'}{n}} \leq \frac{\beta}{2|{\cal F}|}.
\]
Hence, we can choose $k = \frac{n}{\alpha'}\log_2\big(\frac{2|{\cal F}|}{\beta}\big)$ to make the probability as small as claimed.

In the other case, where $2ef(\bh^{\ast}) \geq \alpha'$, we have by the multiplicative Chernoff bound (\Cref{lem:multiplicative_Chernoff}),
\[
\mathbb{P}[f(\tbh) >(1+\zeta)f(\bh^{\ast})+\alpha'] = 
\mathbb{P}\Big[\sum_{i=1}^k f(x_i) >(1+\zeta)k\frac{f(\bh^{\ast})}{n}+\frac{k\alpha'}{n}\Big] \\
\leq \Big(\frac{\exp(\zeta)}{(1+\zeta)^{(1+\zeta)}}\Big)^{\frac{kf(\bh^{\ast})}{n}}\leq \frac{\beta}{2|{\cal F}|}.
\]
This leads to a bound on $k=\frac{4n}{\zeta^2f(\bh^{\ast})}\ln\big(\frac{2|{\cal F}|}{\beta}\big)\leq \frac{8en}{\zeta^2 \alpha'}\ln\big(\frac{2|{\cal F}|}{\beta}\big)$.\\

\noindent\textbf{Lower Bound.} Let us first consider the case when $\alpha'>f(\bh^{\ast})$. We note that in this case $(1-\zeta)f(\bh^{\ast})-\alpha'<0,$ 
hence $\mathbb{P}[f(\tbh) < (1-\zeta)f(\bh^{\ast})-\alpha']=0$.

For the other case, $\alpha'\leq f(\bh^{\ast})$, using the lower-tail  multiplicative Chernoff bound (\Cref{lem:multiplicative_Chernoff}),
\begin{align*}
\mathbb{P}[f(\tbh) < (1-\zeta)f(\bh^{\ast})-\alpha'] &= \mathbb{P}\Big[\sum_{i=1}^k f(x_i) <(1-\zeta)k\frac{f(\bh^{\ast})}{n}-\frac{k\alpha'}{n}\Big] 
\leq \Big(\frac{\exp(-\zeta)}{(1-\zeta)^{(1-\zeta)}}\Big)^{\frac{kf(\bh^{\ast})}{n}} \\
&\leq \frac{\beta}{2|{\cal F}|},
\end{align*}
where the last step follows for $k=\frac{2}{\zeta^2}\frac{n}{f(\bh^{\ast})}\ln\big(\frac{2|{\cal F}|}{\beta}\big)\leq \frac{2}{\zeta^2}\frac{n}{\alpha'}\ln\big(\frac{2|{\cal F}|}{\beta}\big)$. 

Finally, using a union bound over the $2|{\cal F}|$ events needed for \eqref{eqn:approx_multip}, we have that with probability $1-\beta$ this approximation holds. Letting $\beta=1/2$ yields the result.
\end{proof}

\subsubsection{Exponential Mechanism for Relative Approximation}

With the above existential result, the pure-DP mechanism is straightforward. 

\begin{proofof}{\Cref{thm:Pure_DP_Upper_Bound}}
The proposed algorithm is running the exponential mechanism on (rescaled) histograms of size $k$ (where $k$ is as proposed in \Cref{prop:existence_approx_histogram}) for the score function
\[ s(\bh) = -\max_{f\in {\cal F}} \Big\{f(\bh) - (1+\zeta)f(\bh^{\ast}),(1-\zeta)f(\bh^{\ast})-f(\bh )\Big\}. \]
Since the sensitivity of this score function is bounded by $(1+\zeta)$, it suffices to set the temperature parameter for the exponential mechanism as $\frac{\eps}{2(1+\zeta)}$.

Notice that the space of such histograms ${\cal H}_k$ has cardinality bounded by $|{\cal X}|^{k}$. In particular, its logarithm is $\ln|{\cal H}_k|\leq \frac{8e}{\zeta^2}\frac{n}{\alpha'}\ln(4|{\cal F}|)\ln|{\cal X}|$. By the accuracy of the exponential mechanism, for $0<\beta<1$
\[ \mathbb{P}\Big[s(\hat\bh)-\max_{\bh}s(\bh) < -\frac{2(1+\zeta)[\log|{\cal H}_k|+\ln\frac{1}{\beta}]}{\varepsilon} \Big] \leq \beta.\]
Under the complement of the event above (which happens with probability $1-\beta$)
for all $f\in {\cal F}$ 
\[
\hspace{-0.3cm}f(\hbh)-(1+\zeta)f(\bh^{\ast}) \leq \min_{\bh}s(\bh) + \frac{2(1+\zeta)\log|{\cal H}_k|+\log\frac{1}{\beta}}{\varepsilon} \\
\leq \alpha'+ \frac{2(1+\zeta)\log(|{\cal H}_k|/\beta)}{\varepsilon}.
\]
And analogously,
\[
(1-\zeta)f(\bh^{\ast}) - f(\hbh)
\leq \min_{\bh}s(\bh)+ \frac{2(1+\zeta)\log(|{\cal H}_k|/\beta)}{\varepsilon} 
\leq \alpha'+ \frac{2(1+\zeta)\log(|{\cal H}_k|/\beta)}{\varepsilon}.
\]
Next, we have 
\[
\alpha'+ \frac{2(1+\zeta)[\log|{\cal H}_k|+\ln(1/\beta])}{\eps} 
=\alpha'+\frac{2(1+\zeta)}{\eps}\Big[ \frac{8e}{\zeta^2}\frac{n}{\alpha'}\ln(4|{\cal F}|)\ln|{\cal X}|+\ln\frac{1}{\beta}\Big].
\]
Hence, selecting $\alpha'=\sqrt{\frac{2(1+\zeta)8e n}{\eps \zeta^2}\ln(4|{\cal F}|)\ln|{\cal X}|}$ yields the result.
\end{proofof}