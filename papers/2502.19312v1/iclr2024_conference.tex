\documentclass[11pt,letterpaper]{berkeley}

\usepackage[all]{hypcap}

\usepackage[authoryear, round]{natbib}
\bibliographystyle{plainnat}

\usepackage{hyperref}[citecolor=lightblue]

\hypersetup{
    colorlinks = true,
    citecolor = {blue},
}


\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} %
\usepackage{float}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{nicefrac}
\usepackage{dsfont}
\usepackage{enumitem}
\usepackage{float}

\setlength\parindent{0pt}


\usepackage{xspace}
\usepackage[capitalize,noabbrev]{cleveref}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{lipsum}
\usepackage{listings}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{bbm}

\usepackage{algpseudocode}
\usepackage{setspace}
\usepackage{subcaption}

\usepackage{color}
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}


\newcommand\pythonstyle{\lstset{
basicstyle=\ttfamily\footnotesize,
language=Python,
morekeywords={self, clip, exp, mse_loss, uniform_sample, concatenate, logsumexp},              %
keywordstyle=\color{deepblue},
emph={MyClass,__init__},          %
emphstyle=\color{deepred},    %
stringstyle=\color{deepgreen},
frame=single,                         %
showstringspaces=false
}}

\lstnewenvironment{python}[1][]
{
\pythonstyle
\lstset{#1}
}
{}

\newcommand\pythonexternal[2][]{{
\pythonstyle
\lstinputlisting[#1]{#2}}}

\newcommand\pythoninline[1]{{\pythonstyle\lstinline!#1!}}
\newcommand{\methodname}{FSPO}

\input{macro}

\makeatletter
\def\mathcolor#1#{\@mathcolor{#1}}
\def\@mathcolor#1#2#3{%
  \protect\leavevmode
  \begingroup
    \color#1{#2}#3%
  \endgroup
}
\makeatother

\usepackage[textsize=tiny]{todonotes}
\usepackage{algorithm}
\usepackage{amssymb}


\usepackage[skins,theorems]{tcolorbox}

\tcbset{
  aibox/.style={
    width=474.18663pt,
    top=7pt,
    bottom=5pt,
    colback=blue!6!white,
    colframe=black,
    colbacktitle=black,
    enhanced,
    center,
    attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
    boxed title style={boxrule=0pt,colframe=white,},
  }
}
\newtcolorbox{AIbox}[2][]{aibox,title=#2,#1}

\Crefformat{equation}{#2Eq.\;(#1)#3}

\Crefformat{figure}{#2Figure #1#3}
\Crefformat{assumption}{#2Assumption #1#3}
\Crefname{assumption}{Assumption}{Assumptions}

\usepackage{crossreftools}
\pdfstringdefDisableCommands{%
    \let\Cref\crtCref
    \let\cref\crtcref
}
\newcommand{\creftitle}[1]{\crtcref{#1}}
\newcommand{\bDiamond}{\mathbin{\Diamond}}
\newcommand{\bLozenge}{\mathbin{\blacklozenge}}


\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\usepackage{dsfont}
\usepackage{nicefrac}
\usepackage{inconsolata}

\newcommand{\rr}[1]{\textbf{\color{green}[RR: #1]}}

\title{{\methodname: Few-Shot Preference Optimization of Synthetic Preference Data in LLMs Elicits Effective Personalization to Real Users
}}

\reportnumber{} %


\author[1,$\bDiamond$]{Anikait Singh}
\author[1,$\bDiamond$]{Sheryl Hsu}
\author[1]{Kyle Hsu}
\author[1,3]{Eric Mitchell}
\author[1]{Stefano Ermon}
\author[1]{Tatsunori Hashimoto}
\author[1,2,$\bLozenge$]{Archit Sharma}
\author[1,$\bLozenge$]{Chelsea Finn}

\affil[1]{Stanford University}
\affil[2]{Google DeepMind}
%\affil[3]{Physical Intelligence}
\affil[3]{OpenAI}
\affil[$\bDiamond$]{Equal Contribution}
\affil[$\bLozenge$]{Equal Advising}

\correspondingauthor{anikait@stanford.edu. \textbf{Project Website:} \url{https://fewshot-preference-optimization.github.io/}}


\hyphenation{pre-print}

\newcommand{\se}[1]{\textcolor{red}{[SE: #1]}}

\begin{abstract}
\vspace{-0.3cm}
Effective personalization of LLMs is critical for a broad range of user-interfacing applications such as virtual assistants and content curation. Inspired by the strong in-context learning capabilities of LLMs, we propose Few-Shot Preference Optimization (\methodname{}), which reframes reward modeling as a meta-learning problem. Under this framework, an LLM learns to quickly adapt to a user via a few labeled preferences from that user, constructing a personalized reward function for them. Additionally, since real-world preference data is scarce and challenging to collect at scale, we propose careful design choices to construct synthetic preference datasets for personalization, generating over 1M synthetic personalized preferences using publicly available LLMs. In particular, to successfully transfer from synthetic data to real users, we find it crucial for the data to exhibit both high diversity and coherent, self-consistent structure. We evaluate \methodname\ on personalized open-ended generation for up to 1,500 synthetic users across across three domains: movie reviews, pedagogical adaptation based on educational background, and general question answering, along with a controlled human study. Overall, \methodname{} achieves an 87\% Alpaca Eval winrate on average in generating responses that are personalized to synthetic users and a 72\% winrate with real human users in open-ended question answering. 
\end{abstract}

\begin{document}

\maketitle

\begin{flushright}
``Every story I create, creates me. I write to create myself.'' \\---Octavia E. Butler 
\end{flushright}

\input{sections/intro}
\input{sections/related_work}
\input{sections/preliminaries}
\input{sections/methods}
\input{sections/domains}
\input{sections/domain_randomization}
\input{sections/experiments}
\input{sections/discussion}
\input{sections/limitations}
\input{sections/acknowledgements}
\newpage
\bibliography{iclr2024_conference}
\newpage
\appendix
\input{sections/appendix}



\end{document}
