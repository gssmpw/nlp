\section{Results}





\subsection{Evaluation of generated images} \label{subsection: Evaluation of generated images}

%The generative capabilities of the model are evaluated with quantitative metrics and with a visual Turing test. 
%To fairly evaluate the generated images directly to the reference CAMUS images, the evaluation experiments in this subsection do not use the sector width augmentations explained in subsection \ref{subsection: Training of the DDPM}. These additional augmentations do not affect the metrics by a lot, but would \newline


The ImageNet Fr√©chet inception distance (FID) \cite{heusel2017gans} and inception score (IS) \cite{salimans2016improved}
of the diffusion model are 23.87 and 1.47 respectively. However, these metrics can give misleading results for generative models that are not trained on ImageNet \cite{deng2009imagenet, barratt2018note, rosca2017variational}. To qualitatively assess the performance of the model, Fig.~\ref{fig: similar_samples} shows random samples generated together with the most similar cases from the CAMUS dataset identified automatically using the structural similarity index measure (SSIM) \cite{wang2004image}. This shows the model does not simply memorize cases from the training set, and produces realistic and varied samples. \newline




\begin{figure*}[h]
\centering
  \centering
  \includegraphics[trim={0.75cm 0.25cm 0.75cm 0.25cm}, clip,width = 1\linewidth]{figures/similar_samples_v2.drawio.pdf}
  \caption{Generated samples, together with most similar cases in the train and validation set and the test set of the CAMUS dataset, based on SSIM \cite{wang2004image}.}
  \label{fig: similar_samples}
\end{figure*}

\subsection{Survey results}

On the 45 pairs with one real and one synthetic image, participants correctly identified the synthetic image 56.4\% of the time. When broken down by group, cardiologists achieved an accuracy of 63.7\%, while clinical researchers and engineers both identified the correct frame 53.3\% of the time. Fig.~\ref{fig: survey} shows the explanations given when the participants correctly identified the synthetic frame, when they were wrong, and when both frames were real in the 5 cases mentioned above.
\newline

Using a binomial test with a significance level of 5\%, the accuracy of the cardiologists was found to be statistically significantly higher than random guessing ($P=0.09\%$). However, the engineers and clinical researchers in the survey did not show statistically significant higher accuracy compared to random guessing ($P=24.6\%$).

\begin{figure*}[h]
\centering
  \centering
  \includegraphics[trim={0cm 0cm 0cm 0cm}, clip,width = 1\linewidth]{figures/combined_reasons_grouped_barplot.pdf}
  \caption{Explanations given during the survey}
  \label{fig: survey}
\end{figure*}





%In the visual Turing test experiment, two ultrasound engineers and one clinician were shown an image and asked to determine whether it was real or synthetic. The images consisted of 50 frames sampled randomly from the CAMUS dataset and 50 frames sampled from the DDPM trained on the CAMUS dataset. These 100 images were presented to the respondents in a random order. If the respondents identified a frame as synthetic, they had to select a reason from the pre-defined options "Anatomically incorrect," "Speckle patterns," or "Image artifacts." If none of these options matched their reasoning, they could select "Other" and provide an explanation in a text field. Figure \ref{fig: survey} shows the results of the survey.

%\begin{figure}
%     \centering
%     \begin{subfigure}[b]{0.8\linewidth}
%         \centering \includegraphics[trim={0.2cm 0.2cm 0.2cm 0.2cm}, clip, width=1\linewidth]{figures/survey_results.pdf}
%         \caption{Results of the visual Turing test.}
%     \end{subfigure}
%     \begin{subfigure}[b]{0.8\linewidth}
%         \centering \includegraphics[trim={0.2cm 0.2cm 0.2cm 0.2cm}, clip, width=1\linewidth]{figures/survey_reasons.pdf}\caption{Explanations given for selecting synthetic}
%         \label{fig: survey_reasons}
%     \end{subfigure}
%   \caption{Results of the visual Turing test survey. For each image labeled as synthetic, the respondents where asked to indicate a reason for selecting synthetic.}
%    \label{fig: survey}
%\end{figure}

\subsection{Segmentation ablation study results}

Table \ref{table: ablation_study_1} shows the results of the ablation study on the CAMUS dataset, using Dice score and Hausdorff distance as metrics. The bottom part of Fig.~\ref{fig: heatmaps} shows the heatmaps of pixels belonging to the LV after applying the combination of all generative augmentations. Comparing these to the original illustrates that the generative augmentations increase the variety of LV location in the image. \newline

The increase in segmentation accuracy of the HUNT4 model on CAMUS originate mostly from an improvement in segmentation accuracy for samples outside the HUNT4 image distribution. Table \ref{table: camus_subsets_results} lists the segmentation results for the HUNT4 models on different subsets of CAMUS. The subsets are based on depth and sector angle cutoff values visualized in Figs.~\ref{fig: depths_hist} and \ref{fig: sector_angles_hist}.


%Subsection \ref{subsection: results of segmentation ablation study} contains the result of the ablation study. 



\begin{table*}[h]
\scriptsize
  \centering
  \renewcommand{\arraystretch}{1} % Increase vertical spacing
  \caption{Segmentation results of the ablation study using different datasets (HUNT4 and CAMUS) for training and testing. For all experiments, regular augmentations are applied in addition to the generative augmentations (see Table \ref{table: characteristics nnunet}).The Dice score and Hausdorff distance are only for the LV lumen label. We elaborate on this choice in the Discussion. Since the two datasets have been annotated by different experts with different annotation conventions, there is a considerably lower segmentation accuracy when the training and test sets are different. }
  \begin{tabular}{m{60pt}m{40pt}m{120pt}m{60pt}m{100pt}}
    \toprule
      Training set  & Test set & Generative Augmentations & Dice score & Hausdorff distance (mm)\\
    \midrule
    \multirow{7}{1.4cm}{HUNT4} & \multirow{7}{1.4cm}{CAMUS} & None & 0.802 $\pm$ 0.15 & 29.03 $\pm$ 26.01\\
    && Depth increase & 0.887 $\pm$ 0.05 & \textbf{7.49 $\pm$ 3.25} \\
    && Tilt variation  & 0.829 $\pm$ 0.14 & 17.31 $\pm$ 20.98 \\
    && Sector width & 0.847 $\pm$ 0.11 & 21.36 $\pm$ 23.84\\
    && Translation & 0.840 $\pm$ 0.12 & 16.55 $\pm$ 19.71 \\
    && Combination & \textbf{0.887 $\pm$ 0.05} & 8.17 $\pm$ 5.32 \\
    && Combination without repaint & 0.810 $\pm$ 0.15  & 26.90 $\pm$ 25.07\\
    \midrule
    \multirow{7}{1.4cm}{CAMUS} &  \multirow{7}{1.4cm}{CAMUS} & None & 0.943 $\pm$ 0.03 & 4.46 $\pm$ 2.52 \\
    && Depth increase & 0.945 $\pm$ 0.03 & \textbf{4.27 $\pm$ 2.34} \\
    && Tilt variation  &  0.945 $\pm$ 0.03 &  4.30 $\pm$ 2.43 \\
    && Sector width variation & \textbf{0.946 $\pm$ 0.03} & 4.34 $\pm$ 2.41 \\
    && Translation & 0.944 $\pm$ 0.03 & 4.44 $\pm$ 2.43\\
    && Combination & 0.944 $\pm$ 0.03 & 4.37 $\pm$ 2.43 \\
    && Combination without repaint & 0.934 $\pm$ 0.03 & 5.39 $\pm$ 2.85 \\

      \midrule
      \midrule
        \multirow{7}{1.4cm}{HUNT4} & \multirow{7}{1.4cm}{HUNT4} & None &  0.952 $\pm$ 0.02 &  3.34 $\pm$ 1.21 \\
    && Depth increase & 0.954 $\pm$ 0.02 & 3.24 $\pm$ 0.99 \\
    && Tilt variation & 0.954 $\pm$ 0.02 & 3.38 $\pm$ 1.06 \\
    && Sector width variation & 0.953 $\pm$ 0.02  & \textbf{3.23 $\pm$ 1.00} \\
    && Translation & 0.954 $\pm$  0.02  & 3.32 $\pm$  0.97 \\
    && Combination & \textbf{0.954 $\pm$ 0.02} & 3.31 $\pm$ 0.99 \\
    && Combination without repaint &  0.947 $\pm$ 0.02 & 4.14 $\pm$ 1.85 \\
    \midrule
    \multirow{7}{1.4cm}{CAMUS} &\multirow{7}{1.4cm}{HUNT4} & None & 0.886 $\pm$ 0.04 & 6.70 $\pm$ 1.81 \\
    && Depth increase & 0.891 $\pm$ 0.04 & 6.55 $\pm$ 1.84 \\
    && Tilt variation  & 0.887 $\pm$ 0.04 & 6.69 $\pm$ 1.91 \\
    && Sector width variation &  0.892 $\pm$ 0.04 & \textbf{6.54 $\pm$ 1.78} \\
    && Translation &  0.890 $\pm$ 0.04  & 6.55 $\pm$ 1.83   \\
    && Combination & \textbf{0.892 $\pm$ 0.04} & 6.59 $\pm$ 1.82 \\
    && Combination without repaint & 0.875 $\pm$ 0.04 & 7.71 $\pm$ 2.11 \\
    \bottomrule
  \end{tabular}
      \label{table: ablation_study_1}
\end{table*}



\begin{table*}
\scriptsize
  \centering
  \renewcommand{\arraystretch}{1} % Increase vertical spacing
  \caption{Segmentation results on different CAMUS subsets for a segmentation model trained on HUNT4 without generative augmentations and with the combination of all
  generative augmentations. }
  \begin{tabular}{m{100pt}m{120pt}m{100pt}m{100pt}}
    \toprule
      Training dataset   & CAMUS Test subset & Dice score & Hausdorff distance (mm)\\
        \midrule
      \multirow{4}{4cm}{HUNT4 without generative augmentations} & Depth $< 150$ mm ($n=1088$) &   0.855 $\pm$ 0.11  & 14.48 $\pm$ 16.61 \\
          &  Depth $\geq 150$ mm ($n=912$) & 0.729 $\pm$ 0.18 & 45.83 $\pm$ 30.19 \\
      &  Sector angle $< 70^\circ$ ($n=146$)& 0.869 $\pm$ 0.10 & 12.47 $\pm$ 16.47 \\
      &   Sector angle $\geq 70^\circ$ ($n=1854$) & 0.792 $\pm$ 0.16  & 30.06 $\pm$ 28.80 \\
      \midrule
      \multirow{4}{4cm}{HUNT4 with generative augmentations} & Depth $< 150$ mm ($n=1088$) &  \textbf{0.893 $\pm$ 0.05} & \textbf{7.45 $\pm$ 3.80}   \\
      &  Depth $\geq 150$ mm ($n=912$) & \textbf{0.886 $\pm$ 0.07} & \textbf{9.34 $\pm$ 8.37} \\
      &  Sector angle $< 70^\circ$ ($n=146$)& \textbf{0.893 $\pm$ 0.05}  & \textbf{7.11 $\pm$ 3.10} \\
      &   Sector angle $\geq 70^\circ$ ($n=1854$) &  \textbf{0.890 $\pm$ 0.07} & \textbf{8.40 $\pm$ 6.56} \\
    \bottomrule
  \end{tabular}
      \label{table: camus_subsets_results}
\end{table*}


% describe train on hunt4 and camus with augmentations. Also describe baseline of 'black' augmentations











\subsection{Clinical evaluation on HUNT4 results}


Similar to the segmentation results, the performance gains of the HUNT4 model originate mostly from an improvement in segmentation accuracy for frames outside the normal range. Fig.~\ref{fig: ef_main_text} shows the Bland-Altman plots comparing the manual reference EF with the automatic EF for segmentation models trained with and without generative augmentations for data both inside and outside of the HUNT4 acquisition normal range of depth $> 150$mm and sector angle $> 70^\circ$. Appendix \ref{appendix: exensive EF evaluation} contains additional analysis of automatic EF and also evaluates automatic on CAMUS.



%Figure \ref{fig: ef} shows the Bland-Altman plots comparing the automatic EF measurements with the manual reference for segmentation models trained without generative augmentations and with the combination of all generative augmentations. 







