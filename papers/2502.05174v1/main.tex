%%%%%%%% ICML 2025 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{pifont} 

% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2025} with \usepackage[nohyperref]{icml2025} above.
\usepackage{hyperref}
\usepackage{xspace}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{tabularray}
\usepackage{adjustbox}
\usepackage[table,xcdraw]{xcolor}
\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
\usepackage{framed}

\usepackage[skip=3pt]{caption}
\setlength{\textfloatsep}{4pt plus 3pt minus 3pt}
\setlength{\abovecaptionskip}{0.0cm}
\setlength{\belowcaptionskip}{0.15cm}
\setlength{\abovedisplayskip}{0.0cm}
\setlength{\belowdisplayskip}{0.15cm}
\setlength{\topsep}{0.0cm}
\setlength{\partopsep}{0.0cm}
\setlength{\itemsep}{0.0cm}


\definecolor{lightred}{HTML}{FFEEEE}
\definecolor{lightgreen}{HTML}{E6FFEC}
\definecolor{lightblue}{HTML}{E1EDFF}
\definecolor{lightgray}{HTML}{EBEBEB}
\definecolor{lightyellow}{HTML}{FFF2D9}
\newcommand{\prompt}[1]{{\ttfamily #1}\xspace}
\newcommand{\ipi}{IPI\xspace}
\newcommand{\llm}{LLMs\xspace}
\newcommand{\gpt}{GPT-4o\xspace}
\newcommand{\othree}{o3-mini\xspace}
\newcommand{\llama}{Llama-3.3-70B\xspace}
\newcommand{\claude}{Claude-3.5-Sonnet\xspace}
\newcommand{\dojo}{AgentDojo\xspace}
\newcommand{\webadv}{VWA-Adv\xspace}

\newcommand*\user[1][1.5em]{$\vcenter{\hbox{\includegraphics[height=#1]{icons/user.png}}}$}
\newcommand*\robot[1][1.5em]{$\vcenter{\hbox{\includegraphics[height=#1]{icons/robot.png}}}$}
\newcommand*\tool[1][1.5em]{$\vcenter{\hbox{\includegraphics[height=#1]{icons/tool_exec.png}}}$}

% \newcommand{\method}{COCO\xspace}
\newcommand{\method}{MELON\xspace}

\usepackage{xcolor}

\newcommand{\wjdd}[1]{\todo[linecolor=cyan,backgroundcolor=cyan!25,bordercolor=cyan,size=\scriptsize]{(Jindong) #1}}
\newcommand{\wjd}[1]{{\color{cyan}{[(Jindong) #1]}}}
\newcommand{\kaijie}[1]{{\color{red}{[(Kaijie) #1]}}}
% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

% Use the following line for the initial blind version submitted for review:
% \usepackage{icml2025}

% If accepted, instead use the following line for the camera-ready submission:
\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}
\usepackage[textsize=tiny]{todonotes}


% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\icmltitlerunning{\method: Indirect Prompt Injection Defense via Masked Re-execution and Tool Comparison}

\begin{document}

\twocolumn[
\icmltitle{\method: Indirect Prompt Injection Defense via\\ Masked Re-execution and Tool Comparison}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2025
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.
\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Kaijie Zhu}{ucsb}
\icmlauthor{Xianjun Yang}{ucsb}
\icmlauthor{Jindong Wang}{wm}
\icmlauthor{Wenbo Guo}{ucsb}
\icmlauthor{William Wang}{ucsb}

\end{icmlauthorlist}

\icmlaffiliation{ucsb}{UCSB}
\icmlaffiliation{wm}{William \& Mary}
\icmlcorrespondingauthor{Kaijie Zhu}{kaijiezhu@ucsb.edu}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
% \printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.

\input{0-abstract}
\input{1-intro}
\input{2-related_work}
\input{3-tech}
\input{4-experiments}
\input{5-discussion}






% In the unusual situation where you want a paper to appear in the
% references without citing it in the main text, use \nocite
\nocite{langley00}

\bibliography{ref}
\bibliographystyle{icml2025}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \begin{algorithm}[t]
% \caption{Pseudo code for \method}
% \label{alg:detection}
% \begin{algorithmic}[1]
% \STATE Initialize suspicious tool calls bank $B \gets \emptyset$
% \STATE Combine all tool outputs $O_{combined} \gets \mbox{Combine}(O)$
% \STATE Set instruction-seeking prompt $T_s$ 
% \STATE $C_s \gets \mbox{ExtractToolCalls}(\mbox{Agent}(Ts, O{combined}))$
% \STATE Add to suspicious tool calling bank $B \gets B \cup C_s$
% \STATE $C_o \gets \mbox{ExtractToolCalls}(\mbox{Agent}(T_u, O))$
% \FOR{each tool call $c \in C_o$}
%     \FOR{each suspicious call $b \in B$}
%         \IF{$\mbox{CosineSim}(\mbox{Emb}(c), \mbox{Emb}(b)) > \theta$}
%             \STATE \textbf{return} True \COMMENT{Potential misdirection detected}
%         \ENDIF
%     \ENDFOR
% \ENDFOR
% \STATE \textbf{return} False
% \end{algorithmic}
% \end{algorithm}


\newpage
\appendix
\onecolumn
\input{appendix}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}
