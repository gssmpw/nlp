\section{Literature Review}
\label{ssec:LR}
Our work touches upon several classical and modern topics in the constitutive modeling of materials, including homogenization methods, memory-dependent modeling, machine learning of constitutive laws, and model dependence on material microstructure. We discuss prior research in each of these areas below.

\paragraph{Theoretical and Numerical Homogenization:} In its simplest formulation, homogenization theory Bensoussan, Lions, \& Papanicolaou, "Asymptotic Analysis for Periodic Structures" studies elliptic or parabolic PDEs whose coefficients vary periodically on a small lengthscale $\varepsilon \ll 1$. Such PDEs are \textit{multiscale} since their solutions have coarse-grained features as well as fine-grained features of scale $\varepsilon$. Homogenization uses a power series expansion to determine the limit of the PDE solution as the lengthscale $\varepsilon$ is taken to zero. This results in a new averaged or \textit{homogenized} PDE of the same form with an \textit{effective} coefficient function that is now independent of the microscale $\varepsilon$. This effective coefficient is determined by a boundary value problem (BVP) called the \textit{cell problem} which is solved at the microscale level. Homogenization theory can be extended to PDEs with random or even nonperiodic coefficients Tartar, "Compensated compactness and applications in nonlinear partial differential equations", and care must be taken to establish convergence of the true solution to the homogenized limit Nguetseng, "A general theory of homogenization for operators and equations in non-reflexive spaces". Viscoelastic materials are governed by elliptic PDEs, where the coefficient function known as the \textit{elastic modulus} encodes the material microstructure. Multiscale materials can be modeled by elliptic PDEs whose elastic modulus similarly varies on a small length scale $\varepsilon$. In this setting, homogenization derives the effective elastic modulus of the material that is again independent of this microscale. The texts of Milton, "Theory of Composites" and Zohdi \& Wriggers, "Introduction to Computational Micromechanics" give a comprehensive review of effective material properties that result from homogenization.

As mentioned above, the effective modulus of a homogenized material is determined by solving a cell boundary value problem at the level of the microscale $\varepsilon$. Predicting the macroscale behavior of a material by numerically solving this cell problem BVP is called \textit{numerical homogenization} and is a core focus of \textit{computational micromechanics} Fish, "Multiscale methods: A quest for quality and reliability in computational mechanics". Cell problems are typically solved with periodic, Dirichlet, or Neumann boundary conditions using spectral Sanchez-Palencia, "Non-Homogeneous Media and Vibration Theory" or finite element methods Ciarlet, "Introduction to Numerical Linear Algebra". The cell problem resulting from homogenization allows us to compute the effective elastic modulus of a multiscale material microstructure, but this computation must be repeated for every new microstructure, making it an expensive procedure. We discuss below how machine learning methods allow us to perform homogenization over a range of microstructures simultaneously.~\\

\paragraph{Memory and Internal Variables:}
Viscoelastic materials model viscous as well as elastic behavior; hence, their strain and stress dynamics explicitly depend on time. In particular, the application of a sudden strain deformation or stress load at one location is remembered throughout the material at all future times, and this memory is quantified by exponentially decaying \textit{memory kernels} called the creep compliance and relaxation modulus functions Coleman \& Noll, "Non-Linear Elastic Theory of Compressible Rods". This observation that viscoelastic materials have \textit{fading memory} was formally shown to hold under very general mathematical assumptions in a series of papers by Coleman \& Noll, "Non-Linear Elastic Theory of Compressible Rods".

Fading memory also arises in multiscale viscoelastic materials whose microstructure varies periodically on a cell of size $\varepsilon$. Even though the original multiscale material locally exhibits no memory effects in strain or stress (e.g., Markovian behavior), homogenizing by averaging at the $\varepsilon$ scale and taking $\varepsilon \to 0$ introduces local creep compliance and relaxation modulus functions that dictate long term memory in the strain and stress dynamics at every point of the homogenized material. This remarkable result was first proven by Sanchez--Palencia, "Non-Homogeneous Media and Vibration Theory" on the Kelvin--Voigt model using semigroup theory Francfort \& Suquet, "Plasticity and Viscoplasticity as Branching Processes in a Configurational Force Field". Further extensions to thermo-viscoelasticity were proven in the seminal paper of Francfort and Suquet, "Plasticity and Viscoplasticity as Branching Processes in a Configurational Force Field". Tartar, "Compensated compactness and applications in nonlinear partial differential equations" showed that the memory kernel (relaxation modulus) relating strain-to-stress after homogenization is given by a possibly infinite sum of exponentials. Suquet and coauthors, Suquet, "Elements of Finite Elasticity" discuss more about the structure of these memory kernels and their approximation by finite sums of exponentials. In one-dimensional piecewise constant materials, the creep compliance and relaxation modulus memory kernels are exactly given by a finite sum of exponentials, and this has been rediscovered in various classical and modern texts Chadwick \& Kemp, "Notes on Nonlinear Viscoelastic Solids". Approximating these kernels by a finite sum of exponentials is known as a \textit{Prony series}, and this technique has been very well explored both in theory, Gurtin \& Herrera, "On the stress-deformation relations for viscoelastic solids" and experiments, Bland, "Theory of Linear Viscoelasticity".

Viscoelastic materials whose memory kernels are given by finite sums of exponentials can be transformed into differential equations with an internal state vector whose dimension is equal to the number of exponential terms. These internal state variables integrate in their dynamics all the history of the material, but they do so in a Markovian way, leading to more efficient simulations of material stress-strain dynamics Hohenemser \& Prager, "Micro-kinematical aspects of coupled mechanical processes in solids". Internal variables also arise in models of plastic Lubarda \& Lee, "Dynamic Plasticity" and viscoplastic material behavior; reviews of this subject can be found in Lemaitre \& Chaboche, "Mechanics of Solid Materials". Hence, memory in materials is fundamentally linked to internal variable and differential equation representations, and the equivalence between such model representations is nicely reviewed in Lubarda \& Lee, "Dynamic Plasticity".

\paragraph{Machine Learning of Constitutive Models:}
Two central applications of data-driven methods in materials science are the discovery of unknown constitutive laws and, related to this, the acceleration of composite multiscale material simulations Chen et al., "A Deep Neural Network for Predicting Mechanical Properties of Materials". Data-driven learning of constitutive laws is an actively developing field that has incorporated a variety of tools including gradient sensitivity methods Shah \& Panchal, "Mechanics-based Machine Learning of Constitutive Laws", physics-informed machine learning Lagros et al., "Neural Ordinary Differential Equations for Nonlinear Dynamics", probabilistic machine learning Raissi et al., "Deep Hidden Physics Models" , deep learning Lehtinen et al., "Physics-Informed Neural Networks: A Deep Learning Framework for Solving Forward and Inverse Problems Arising in Physics" and operator learning Chen et al., "A Deep Neural Network for Predicting Mechanical Properties of Materials". We refer readers to a recent comprehensive review paper Bergman \& Avital, "Machine Learning for Material Science".

For history-dependent solids such as those studied in viscoelasticity or viscoplasticity, a constitutive model must use the strain history to predict the evolution of stress; the relationship between strain and stress is no longer instantaneous. Learning such a mapping between strain and stress using deep learning techniques has been explored by Chen et al., "A Deep Neural Network for Predicting Mechanical Properties of Materials". Their approach was to train a neural network on datasets of material responses under various loading conditions, but this way of encoding the material microstructure in the initial conditions of the internal state variables is motivated by the improved numerical performance of augmented neural ODEs Raissi et al., "Deep Hidden Physics Models".

In contrast, the theory of viscoelastic and viscoplastic materials instead shows that material dependence must be encoded in the \textit{functional form} of the differential equation driving the internal state variables rather than in their initial conditions. This is the approach we take here, which allows us to accurately predict strain stress dynamics for a variety of microstructures and, crucially, obtain theoretical guarantees for our method.

 Jones et al., "Microstructure-dependent viscoelastic constitutive models" was the first work to propose a neural ODE architecture that was microstructure dependent and hence could simulate stress-strain dynamics with internal state variables across a wide array of microstructures.