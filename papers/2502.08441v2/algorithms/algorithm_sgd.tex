\begin{algorithm}[H]
    \small
    \textbf{Input:}
    $\eta$ (lr), $e_i^{(0)}$ (initial embeddings),
    $\mathcal{L}(e_i)$ (objective), $\gamma$ (momentum), $T$ (number of time steps) \\
    \textbf{Output}: $e^{(T)}$ (final embeddings)
    \begin{algorithmic}[1]
        \For{$\tm=1 \dots T$}
            \For{$i=1 \dots V$}
                \State $g_i^{(\tm)}$ $\gets$ $\nabla_{e_i} \mathcal{L}^{(\tm)} (e_i^{(\tm-1)})$
                \If{$t>1$}
                    \State $\mathbf{b}_i^{(\tm)}$ $\gets$ $\gamma \mathbf{b}_i^{(\tm-1)} + g_i^{(\tm)}$
                \Else
                    \State $\mathbf{b}_i^{(\tm)}$ $\gets$ $g_i^{(\tm)}$
                \EndIf
                \State $e_i^{(\tm)}$ $\gets$ $e_i^{(\tm-1)} - \eta \mathbf{b}_i^{(\tm)}$
            \EndFor
        \EndFor
        \vspace*{1.0ex}
        \State \Return $e^{(T)}$
    \end{algorithmic}
    \caption{Pseudocode for the SGD algorithm with optional momentum, applied to the embedding vectors $e_i$.}
    \label{alg:algorithm_sgd}
\end{algorithm}
