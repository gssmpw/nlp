\section{Experiments}


For all our GenTO experiments, we employ the WIRE architecture \citep{saragadam2023wire}, which uses wavelets as activation functions.
This imposes an inductive bias towards high-frequencies, while being more localized than, e.g., a sine activation \citep{sitzmann2019siren}.
We use a 2-dimensional modulation space $Z \subset \mathbb{R}^2$, where most runs use $Z = [0,1]^2$.

We perform 3 different runs for GenTO. 
\textbf{GenTO (single)} optimizes a single shape and serves as a baseline for compliance. The diversity constraint is not included, as it is trivially 0.
\textbf{GenTO (equidistant)} optimizes $M=9$ shapes in a single iteration in all experiments. 
The $M$ modulation vectors $\mathbf{z}_j$ are taken from $\mathcal{Z} \subset \mathbb{R}^2$ in an equidistant $3 \times 3$ grid at the beginning of training. 
\textbf{GenTO (uniform)} optimizes a set of shapes, with the number of shapes 
$M$ being either 9 or 25, depending on the experiment. In every iteration, $M$ modulation vectors are sampled uniformly from $\mathcal{Z}$.
By uniformly sampling from $\mathcal{Z}$ the network learns a set of shapes.

For training GenTO, the FEM solver mesh resolution (see \ref{tab:results}) is kept constant throughout training.
Further experimental details and hyperparameters can be found in Appendix \ref{app:exp_details}.




\subsection{Problem definitions}

We apply our method to common linear elasticity problems in two and three dimensions, described below and depicted in Figure \ref{fig:problem_defs}.


\begin{figure*}[ht!]
\centering
\begin{subfigure}[t]{0.24\textwidth}
    \centering
    \isformat{icml}
        \raisebox{0.1cm}{
        \includegraphics[height=1.8cm]{figures/problems/MBB_Bridge_2.png}
        }
    \else %
        \hspace*{-0.5cm}
        \raisebox{0.3cm}{
        \includegraphics[height=1.5cm]{figures/problems/MBB_Bridge_2.png}
        }
    \fi
    \caption{}%
    \label{fig:beam_def}
\end{subfigure}
\hfill
\begin{subfigure}[t]{0.24\textwidth}
    \centering
    \includegraphics[height=2.2cm]{figures/problems/Cantilever_2d_simpler.png}
    \caption{}%
    \label{fig:cantilever_def}
\end{subfigure}
\hfill
\begin{subfigure}[t]{0.24\textwidth}
    \centering
    \includegraphics[height=2.2cm]{figures/problems/Simjeb-envelope.png}
    \caption{}%
    \label{fig:simjeb_env}
\end{subfigure}
\hfill
\begin{subfigure}[t]{0.24\textwidth}
    \centering
    \raisebox{0.2cm}{
    \includegraphics[height=2.2cm]{figures/problems/envelope-sideview-force.png}
    }
    \caption{}%
    \label{fig:simjeb_def}
\end{subfigure}

\caption{Illustration of the problem definitions, design regions, and load cases.
(a) \textbf{MBB Beam}: The boundary is fixed at the attachment points at the bottom left and right corners. The dotted line indicates the symmetry axis at $\frac{L}{2}$ where the force $F$ is applied.
(b) \textbf{Cantilever}: Forces $F_1$, $F_2$ are applied at distance $h$ from the upper and lower boundaries. The left boundary is fixed to the wall.
(c) \textbf{Jet engine bracket design region}: Solution shapes must be contained within the design region and attach to the six cylindrical interfaces.
(d) \textbf{Jet engine bracket load case}: A diagonal force is applied at the two central interfaces. The bracket is fixed at the four side interfaces.
}
\label{fig:problem_defs}
\end{figure*}




\paragraph{Messerschmitt-BÃ¶lkow-Blohm beam (2D).}
The MBB beam is a common benchmark problem in TO and is depicted in Figure \ref{fig:beam_def}. The problem describes a beam fixed on the lower right and left edges with a vertical force $F$ applied at the center. As the problem is symmetric around $x=L/2$, we follow \citet{multi_TO_Papadopoulos_2021} and only optimize the right half. \newline
The concrete dimensions of the beam are $H=1, L=6$ and the force points downwards with $F=1$. 

\paragraph{Cantilever beam (2D).}
The cantilever beam is illustrated in Figure \ref{fig:cantilever_def}. The problem describes a beam fixed on the left-hand side and two forces $F_1$, $F_2$ are applied on the right-hand side. \newline
The dimensions are $H=1, L=1.5, h=0.1$ and the forces $ F_1 = F_2 = 0.5$.


\paragraph{Jet engine bracket (3D).}
We apply GenTO to a challenging 3D task, namely the optimization of a jet engine bracket as defined by \citet{jeb}.
The design region for this problem is given via a surface mesh (see Figure \ref{fig:simjeb_env}).
The load case is depicted in Figure \ref{fig:simjeb_def} in which a diagonal force pulls in positive x and positive z direction.




\subsection{Baselines}

\paragraph{TO for a single solution.}
The main baseline for TO for a single solution is a standard implementation of SIMP.
We rely on FeniTop \citep{fenitop}, a well-documented implementation of SIMP. Single-shape reference solutions for all problems are shown in Appendix \ref{subsec:ref_solutions}. \newline
FeniTop applies a smoothing filter to the densities before passing them to the FEM solver. This avoids checkerboard patterns caused by the numerical error of FEM \citep{sigmund1998numerical}. 
As GenTO, FeniTop also uses contrast filters (more details on filters in Appendix \ref{subsec:density_filters}).


\paragraph{TO for multiple solutions.}
The deflated barrier method (DB) \citep{multi_TO_Papadopoulos_2021} is the state-of-the-art method for finding multiple solutions to TO problems.
In contrast to GenTO, DB is a sequential algorithm and cannot perform multiple solver steps in parallel.
For linear elasticity, the deflated barrier method only provides an implementation for the cantilever and MBB beam.
A comparison between GenTO and DB for the jet engine bracket is omitted, given DB's complex mathematical framework, slower performance (see Section \ref{sec:results}), and hyperparameter sensitivity.
Notice that the available implementation of DB refines the mesh during training, which increases the runtime per solver step during optimization.


\subsection{Metrics}

Unlike DB and TO, which generate single solutions, GenTO has the capability to produce a potentially infinite set of shapes. $\Omega_\mathcal{Z} = \{ \Omega_\mathbf{z} \mid \mathbf{z} \in \mathcal{Z} \}$.
During training, shapes are sampled according to a probability distribution $p(\mathcal{Z})$.
Hence, our metrics are based on the expected value over $p(\mathcal{Z})$.

\paragraph{Quality.}
For structural efficiency, we use the expected compliance $\mathbb{E}[C] \coloneqq \mathbb{E}_{z \sim p(\mathcal{Z})}[C(\Omega_\mathbf{z})]$, as well as minimum compliance $\min(C) \coloneqq \min_{\mathbf{z} \in \mathcal{Z}}C(\Omega_\mathbf{z})$ and maximum compliance $\max(C) \coloneqq \max_{\mathbf{z} \in \mathcal{Z}}C(\Omega_\mathbf{z})$. 
To verify that the volume constraint is satisfied, we use the expected volume $\mathbb{E}[V]\coloneqq \mathbb{E}_{z \sim p(\mathcal{Z})}[V(\Omega_\mathbf{z})]$ over obtained shapes. %
We use the FenicsX numerical solver \citep{baratta2023dolfinx} to compute compliance and volume values.
For each problem, we use a high-resolution mesh to compute the final compliance metrics for all methods. This minimizes the discretization error in the compliance computation and prevents numerical artifacts due to the mesh dependency of the solver. 

\paragraph{Diversity.}
A diversity measure shall capture several natural properties, accounting, e.g., for the number of elements and the dissimilarity between elements of a set.
\citet{leinster2024entropy} states 6 natural properties and rigorously proves that only the Hill numbers $D_q(S), q \in \mathbb{R}$ over a set $S$ fulfill these properties all at once.
If $q=2$, the Hill number is interpretable, as it corresponds to the expected dissimilarity if 2 elements of a set are sampled with replacement. 
Hence, we choose $D_2(\Omega_\mathcal{Z})$.
to measure the diversity of shapes $\Omega_\mathcal{Z}$, we follow \citet{leinster2024entropy} and report the expected Wasserstein-1 distance between the shapes in the set:
\footnote{This corresponds to the Hill number with $q=2$ and the similarities set as reciprocal of the distances.} 
\begin{equation}
    \mathbb{E}[W_1] \coloneqq \mathbb{E}_{\mathbf{z}_i, \mathbf{z}_j \sim p(\mathcal{Z})} \left[ W_1(\Omega_{\mathbf{z}_i}, \Omega_{\mathbf{z}_j}) \right]
\end{equation}
where $W_1(\Omega_{\mathbf{z}_i}, \Omega_{\mathbf{z}_j})$ is the sliced-1 Wasserstein distance \citep{flamary2021pot}, a computationally cheaper variant of the Wasserstein distance.
Importantly, $z_i, z_j$ are sampled with replacement as rigorously derived by \citet{leinster2024entropy}.

\paragraph{Computational cost.}
To compare the computational cost of different methods, 
we report the number of solver steps, since for large meshes (e.g., more than 10K elements) this becomes the main computational bottleneck.
In addition, we use the number of iterations of the network (i.e. optimizer steps), as these take into account the parallelization of GenTO.
We also report wall clock time, as it gives a sense of the practicality of a method.


\isformat{icml}

    \begin{figure}[ht!]
        \centering
        \begin{subfigure}{\columnwidth}
            \centering
            \includegraphics[width=\linewidth]{figures/results/mbb_beam_equidistant_9.pdf}
            \caption{GenTO (ours, 4 min).}
            \label{fig:results_2d_mbb_beam}
        \end{subfigure}
        \hfill %
        \begin{subfigure}{\columnwidth}
            \centering
            \includegraphics[width=0.66\linewidth]{figures/results/DAB_mbb_comparison.pdf}
            \caption{Deflated Barrier (baseline, 55 min).}
            \label{fig:DB_mbb}
        \end{subfigure}
        \caption{Comparison of results for the MBB beam. Similar to the cantilever problem in Figure \ref{fig:results_cantilever}, GenTO produces more diverse results than the DB baseline in much less time with similar compliance values.}
        \label{fig:results_mbb_beam}
    \end{figure}

\else

    \begin{figure}[ht!]
        \centering
        \begin{subfigure}{0.48\textwidth}
            \centering
            \raisebox{1cm}{
                \includegraphics[width=0.66\linewidth]{figures/results/DAB_mbb_comparison.pdf}
            }
            \caption{Deflated Barrier (baseline, 55 min).}
            \label{fig:DB_mbb}
        \end{subfigure}
        \hfill %
        \begin{subfigure}{0.48\textwidth}
            \centering
            \includegraphics[width=\linewidth]{figures/results/mbb_beam_equidistant_9.pdf}
            \caption{GenTO (ours, 4 min).}
            \label{fig:results_2d_mbb_beam}
        \end{subfigure}
        \caption{Comparison of results for the MBB beam. Similar to the cantilever problem in Figure \ref{fig:results_cantilever}, GenTO produces more diverse results than the DB baseline in much less time with similar compliance values.}
        \label{fig:results_mbb_beam}
    \end{figure}

\fi



\section{Results}
\label{sec:results}


\subsection{Main results}

The quantitative results of our experiments are summarized in Table \ref{tab:results}.
Qualitatively, we show different results in Figures \ref{fig:results_cantilever}, \ref{fig:results_mbb_beam},  and \ref{fig:results_simjeb}. To validate that GenTO can produce good single results on par with the baseline, comparisons of FeniTop and GenTO (single) are shown in the Appendix in Figures \ref{fig:mbb_reference}, \ref{fig:cantilever_reference} and \ref{fig:simjeb_reference}.

\paragraph{GenTO is more diverse.}
Across all our experiments, we observe that GenTO finds more diverse solutions than DB.
Note, that the solutions also vary in their topology, i.e. have a different number of holes.


\begin{table*}[!ht]
    \caption{Experimental results on the three linear elasticity problems.
   $\mathbf{N}$ is the number of solutions, $\mathbb{E}(\mathbf{C})$, $\min(\mathbf{C})$, and $\max(\mathbf{C})$
   are the average, minimum, and maximum compliance values of the solutions (lower is better). $\mathbb{E}(V)$ is the mean volume of the solutions in percent of the volume in the design region, $\mathbb{E}(W_1)$ is the expected Wasserstein-1 distance between solutions quantifying the diversity (higher is better).  \textbf{Time} is the wall clock time in minutes, \textbf{Its.} is the number of iterations until convergence, \textbf{Steps} is the number of FEM solver calls, and \textbf{FEM resolution} is mesh resolution used by the FEM solver. Note that the FEM resolution of DB changes over time due to the adaptive mesh refinement (indicated by initial grid $\rightarrow$ final refined mesh size).}
    \vskip 0.1in
    \centering
    \LARGE
    \resizebox{\textwidth}{!}{
    \begin{tabular}{llccccccccccc}   
        \hline
        \hline
        \noalign{\vskip 0.1cm} %
        \textbf{Problem} & \textbf{Method} & $\mathbf{N}$ & $\mathbb{E}(\mathbf{C})$ & $\min(\mathbf{C})$ & $\max(\mathbf{C})$ & $\mathbb{E}(V)$ & $\mathbb{E}(W_1)$ & \textbf{Time}  & \textbf{Its.} & \textbf{Steps} & \textbf{FEM resolution} \\
        \hline 
        MBB & ~ & ~ & ~ & ~ & ~ & 53.5 & ~ & ~ & ~ & ~ & ~ \\ 
        ~ & DB & 2 & 0.67 & 0.66 & 0.67 & 53.49 & 0.0136 & 55.5 & ~ & 3190 & 50x150 $\rightarrow$ 27174 \\ 
        ~ & FeniTop & 1 & 0.68 & ~ & ~ & 53.49 & ~ & 2& 400 & 400 & 180x60 \\ 
        ~ & GenTO (single) & 1 & 0.68 & ~ & ~ & 54.09 & ~ & 1.5 & 400 & 400 & 180x60 \\ 
        ~ & GenTO (equidistant) & 9 & 0.69 & 0.68 & 0.69 & 53.54 & \textbf{0.0214} & 4 & 400 & 3600 & 180x60 \\ 
        ~ & GenTO (uniform) & $\mathcal{U}([0,1]^2)$ & 0.70 & 0.69 & 0.72 & 53.28 & 0.0157 & 13 & 650 & 16250 & ~ \\ 
        \hline 
        Cantilever & ~ & ~ & ~ & $\times 10^{-2}$ & ~ & 50.00 & ~ & ~ & ~ & ~ & ~ \\ 
        ~ & DB & 2 & 0.58 & 0.57 & 0.58 & 49.98 & 0.0101 & 123& ~ & 4922 & 25x37 $\rightarrow$ 52024 \\ 
        ~ & FeniTop & 1 & 0.59 & ~ & ~ & 49.91 & ~ & 4& 400 & 400 & 150x100 \\ 
        ~ & GenTO (single) & 1 & 0.58 & ~ & ~ & 49.94 & ~ & 2.5& 400 & 400 & 150x100 \\ 
        ~ & GenTO (equidistant) & 9 & 0.61 & 0.59 & 0.62 & 50.42 & \textbf{0.0157} & 5& 400 & 3600 & 150x100 \\ 
        ~ & GenTO (uniform) & $\mathcal{U}([0,1]^2)$ & 0.67 & 0.65 & 0.73 & 49.60 & 0.0065 & 28.5& 1000 & 25000 & 150x100 \\ 
        \hline 
        Bracket & ~ & ~ & ~ & $\times 10^{-3}$ & ~ & 7.00 & ~ & ~ & ~ & ~ & ~ \\ 
        ~ & FeniTop & 1 & 0.99 & ~ & ~ & 7.16 & ~ & 187& 300 & 400 & 104x172x60 \\ 
        ~ & GenTO (single) & 1 & 0.90 & ~ & ~ & 7.42 & ~ & 19.5& 400 & 400 & 26x43x15 \\ 
        ~ & GenTO (equidistant) & 9 & 0.97 & 0.87 & 1.04 & 7.07 & \textbf{0.0065} & 60& 1000 & 9000 & 26x43x15 \\ 
        ~ & GenTO (uniform) & $\mathcal{U}([0,0.25]^2)$ & 1.63 & 1.35 & 1.85 & 7.04 & 0.0015 & 92& 1400 & 12600 & 26x43x15 \\ 
    \end{tabular}
    \label{tab:results}
    }
\end{table*}

\paragraph{GenTO is faster.}
Compared to DB, GenTO with equidistant sampling is more than an order of magnitude faster in terms of wall clock time.
The main reason is the parallelism of GenTO, while DB is an inherently sequential algorithm.
Note, that DB performs mesh refinement in certain stages, which increases the time per solver step.
GenTO with equidistance sampling is approximately on par with DB in terms of total solver steps.


\paragraph{Equidistant beats uniform sampling.} 
Across all experiments, equidistant sampling performs better than uniform sampling for all considered metrics.
We attribute this to the fact that for equidistant sampling, the network can learn to cover important modes which are sufficiently far away from each other, without needing to find good intermediate shapes.
In contrast, when modulation is sampled uniformly, the network must learn a continuous encoding of solutions. This typically requires more iterations and solver steps than other methods due to the additional complexity.

\paragraph{Single solutions beat multiple solutions.} 
In terms of compliance, speed, and solver steps, single solutions beat multiple solutions in all experiments.
This is expected, as the optimization for multiple solutions additionally accounts for the diversity constraint.
Notably, the single solution for GenTO is on par with FeniTop, but worse than DB.
This is partially expected, as DB refines the mesh during optimization.




\isformat{icml}
    \begin{figure}[h]
        \centering
        \includegraphics[width=0.4\textwidth, height=0.4\textwidth]{figures/fig1/combined_0_4_6.png}
        \caption{
            Three different jet engine bracket designs generated by GenTO. \textit{Left:} top view. \textit{Right:} isometric view. Notably, all three generated designs show the same low compliance as the single solution by the FeniTop baseline. These explored solutions can be further refined and post-processed by a classical pipeline.
        }
        \label{fig:results_simjeb}
    \end{figure}
\else
    \begin{wrapfigure}[21]{r}{0.42\textwidth} %
    \centering
    \vspace{-20pt} %
    \includegraphics[width=0.4\textwidth]{figures/fig1/combined_0_4_6.png}
    \caption{
        Three different jet engine bracket designs generated by GenTO. \textit{Left:} top view. \textit{Right:} isometric view. Notably, all three generated designs show the same low compliance as the single solution by the FeniTop baseline. These explored solutions can be further refined and post-processed by a classical pipeline.
    }
    \label{fig:results_simjeb}
    \vspace{-20pt} %
\end{wrapfigure}
\fi









\subsection{Ablations}
\label{ablations}

We perform ablations to highlight important design decisions of GenTO. 
The main findings are described in the following and additionally visualized in Appendix \ref{app:ablations}.


\paragraph{Sensitivity to penalty $p$.}
For SIMP, the density is penalized with an exponent $p$ (see Equation \ref{eq:penalization}).
Our experiments show that GenTO is sensitive to the choice of $p$, as it sharpens the loss landscape.
This becomes more apparent when looking at the derivative of the stiffness of a mesh element $\frac{\partial \mathbf{K}_i(\rho_i)}{\partial \rho_i} = p \rho_i^{p-1} \mathbf{K}_i$.
E.g., for $p=3$ the gradient is quadratically scaled by the current density value. 
This implies that the higher $p$, the harder it is to escape local minima.
We do not observe a large performance impact in the 2D experiments. However, in 3D, we observe that $p=3$ instead of $p=1.5$ leads to convergence to an undesired local minimum, illustrated in Figure \ref{fig:jeb_p3}.


\paragraph{Annealing is necessary for good convergence.}
We find that GenTO requires annealing to achieve good convergence.
Figure \ref{fig:jeb_no_annealing} demonstrates a failed run without $\beta$ scheduling the Heaviside function (Equation \ref{eq:heaviside}).



\paragraph{Different frequency bias for $\mathbf{x}$ and $\mathbf{z}$.}
The importance of frequency bias has been highlighted by several works \citep{sitzmann2019siren,saragadam2023wire}.
Importantly, depending on the problem, there might be a different frequency bias necessary for the coordinates $\mathbf{x}$ and the modulation vectors $\mathbf{z}$.
For the WIRE architecture we use in our experiments, the frequency bias of the modulation is implicitly controlled by the (hyper-) volume of $\mathcal{Z}$. 
This controls the diversity at initialization and convergence as suggested by \citet{Teney2024NeuralRR}.
Figure \ref{fig:failure_modulation} shows solutions to the MBB beam for $\mathcal{Z} = [0,0.1]^2$.
Compared to the better tuned $\mathcal{Z} = [0,1]^2$ in Figure \ref{fig:failure_modulation}, the diversity almost halves from $21.4 \times 10^{-3}$ to $11.8 \times 10^{-3}$.


