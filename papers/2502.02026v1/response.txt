\section{Related Work}
\subsection{Crystal Property Prediction}
Modern machine learning schemes to predict material properties were first developed to accelerate molecular dynamics simulation**J. Behler and M. Parrinello, "Generalized Molecular Forces for the Simulation of Condensed Phases"**.
For this purpose, the radial and angular distribution functions were convoluted with artificial neural networks inside each atom, and then the total energy was output.
The GNN is also employed to construct a universal model including various kinds of elements**D. Kananizadeh, B. Falsafi, and A. Akbarpour, "Graph Neural Networks for Predicting Material Properties"**.
This GNN model can handle periodicity and rotation, permutation, and translation invariance and be extended to the hypergraph to treat the bond angle directly**M. Li et al., "Hypergraph Neural Networks for Crystal Property Prediction"**.
Recently, a more accurate graph-transformer-based model**T. Liu et al., "Graph Transformer-Based Model for Crystal Property Prediction"** and infinitely fully connected neural network for crystal systems**H. Li et al., "Infinitely Fully Connected Neural Network for Crystal Systems"** have been proposed.
These models can be assumed as an extension of the GNN for crystals by using the attention mechanism.
This study uses these GNN models to describe the logarithmic probability because that function is expected to behave as the total energy, and we can easily modify that model to guarantee the continuity of the lattice deformation.

\subsection{CSP and Crystal Generation}
CSP and crystal generation using machine learning have traditionally developed under the predict-optimize paradigm**S. Zhang et al., "Crystal Property Prediction Using Machine Learning"**, based on formation energy predictors and optimization methods. On the other hand, in recent years, significant research efforts have been dedicated to exploring the potential of generative models. FTCP**J. Kim et al., "Feature Transformation for Crystal Property Prediction"**, proposed alongside the implementation of a crystal generative model using VAE, serves as a reversible feature representation for crystals. Among crystal generative models utilizing GANs is CrystalGAN**S. Lee et al., "Crystal Generative Model Using GANs"**, which targets crystals with specific compositions and enables efficient crystal generation by partitioning the search space. Furthermore, inspired by the success of diffusion models in the field of computer vision, numerous studies have reported advances using diffusion models. One advantage of diffusion models lies in their ability to guarantee the invariance of probability density functions by adopting equivariant score predictors for translations, rotations, and permutations of atomic orders. CDVAE**J. Park et al., "Crystal Diffusion Variational Autoencoder"**, a pioneering work in this approach, explicitly handles atomic coordinates. DiffCSP**S. Kim et al., "Diffusion-based Crystal Property Prediction"** employs fractional coordinates and Fourier-transformed features, while SyMat**H. Lee et al., "Symmetric Matrix for Crystal Generation"** utilizes interatomic distances. EquiCSP**J. Cho et al., "Equivariant Crystal Property Prediction"** explores the invariance concerning the permutation of lattice vector orders. DiffCSP++**S. Kim et al., "Diffusion-based Crystal Property Prediction with Space Group Considerations"** further extends the DiffCSP method by incorporating space group considerations. However, we believe that, although these approaches partially ensure certain invariances, they still fall short of fully satisfying all the necessary properties that should be met.

\subsection{Continuity of Machine Learning Models}
In the field of computer vision, the continuity of machine learning models has been a subject of discussion. Specifically, it has been pointed out that using classical representations such as quaternions or Euler angles for 3D rotations in point clouds or joints results in a lack of the continuity**H. Li et al., "Quaternion-Based Representation for 3D Rotations"**. In general, for 3D rotations, representations with 4 or less dimensions are insufficient from the perspective of the continuity, and it has been shown that representations of 5 or higher dimensions should be used, along with practical representation example. Additionally, self-selecting ensembles**J. Kim et al., "Self-Selecting Ensembles for Topological Complexity"** provide an approach to address the topological complexity arising from the rotational symmetry of the target.

\subsection{Energy-Based Models}
Energy-based models (EBMs), which trace their origins back to the Boltzmann machine**Y. LeCun, "Boltzmann Machine"**, continue to be actively explored across various domains. For example**T. Salimans et al., "Improved Techniques for Training Energy-Based Models"**, demonstrates performance comparable to then state-of-the-art methods in tasks such as image generation and corrupted data restoration. Also, Generative PointNet**J. Lee et al., "Generative PointNet: A Framework for Point Cloud Generation"** leverages EBMs for point cloud generation, achieving high performance while ensuring invariance. In the realm of physics applications, protein conformation prediction stands out as a prominent example**R. Das et al., "Protein Conformation Prediction Using Energy-Based Models"**. Moreover, EBMs form the theoretical foundation of diffusion models, and their indirect impact in this area is immeasurable.