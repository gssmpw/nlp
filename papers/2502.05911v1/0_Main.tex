% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[final]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx} % 用于插入图像
\usepackage{amsmath} % 提供数学公式支持
\usepackage{amsfonts} % 提供数学字体支持
\usepackage{amssymb} % 提供特殊数学符号支持
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode} 
\usepackage{graphicx}
\usepackage{tcolorbox}
\usepackage{enumitem}
\usepackage{subfigure}   
\usepackage{float}  
\usepackage{bm}
\usepackage{multirow}
\usepackage{xspace}
\usepackage{enumitem}
\usepackage{appendix}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{subcaption}
% \usepackage{subfig}
\usepackage{booktabs} % For formal tables
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{balance}
\usepackage{makecell}
\usepackage{threeparttable}
\usepackage{amsmath,amsfonts,mathtools}%,amssymb}
\usepackage{mathrsfs}
\usepackage{float}
\usepackage{graphicx}
% \algrenewcommand\textproc{\text}
\usepackage{makecell}
\usepackage{booktabs}
% \usepackage{color} % xcolor 已经包括 color 的功能，所以这行可以注释掉
\usepackage{pifont}
\newcommand{\xmark}{\ding{55}}
\newcommand{\cmark}{\ding{51}}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{balance}
\usepackage{threeparttable}
\usepackage{amsmath,amsfonts,mathtools} % 已经包含了 amssymb 的大部分功能
\usepackage{colortbl}
\usepackage{mathrsfs}
\usepackage{float}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{hyperref}
\usepackage{tabularx, booktabs}
\usepackage{tikz}
\usepackage{arydshln}
\usepackage{CJKutf8}
\usepackage{amsmath,lipsum}
\usepackage{cuted}%%\stripsep-3pt
\usepackage{multirow}
\usepackage{array}
\usepackage{graphicx}
\usepackage{booktabs}
\newcommand{\fengshuo}[1]{{\color{magenta}[fengshuo: #1]}}

%
% These are are recommended to typeset listings but not required. See the subsubsection on listing. Remove this block if you don't have listings in your paper.
\usepackage{newfloat}
\usepackage{listings}

% \newcommand{\mname}{PecFT\xspace}
% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.
\newcommand{\M}{{\textsc{GRait}}\xspace}

\title{\M: Gradient-Driven Refusal-Aware Instruction Tuning \\for Effective Hallucination Mitigation}

% Mitigating Over-Refusal in Refusal-Aware Instruction Tuning via Gradient Search}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

% \author{First Author \\
%   Affiliation / Address line 1 \\
%   Affiliation / Address line 2 \\
%   Affiliation / Address line 3 \\
%   \texttt{email@domain} \\\And
%   Second Author \\
%   Affiliation / Address line 1 \\
%   Affiliation / Address line 2 \\
%   Affiliation / Address line 3 \\
%   \texttt{email@domain} \\}

\author{
 \textbf{Runchuan Zhu\textsuperscript{2}\thanks{Equal contribution.}},
 \textbf{Zinco Jiang\textsuperscript{2}\footnotemark[1]},
 \textbf{Jiang Wu\textsuperscript{1}\footnotemark[1]\thanks{Project lead.}},
 \textbf{Zhipeng Ma\textsuperscript{3}},
 \\
 \textbf{Jiahe Song\textsuperscript{2}},
 \textbf{Fengshuo Bai\textsuperscript{4}},
 \textbf{Dahua Lin\textsuperscript{1,5}},
 \textbf{Lijun Wu\textsuperscript{1}},
 \textbf{Conghui He\textsuperscript{1}\thanks{Corresponding author.}}
\\
 \textsuperscript{1}Shanghai Artificial Intelligence Laboratory, 
 \textsuperscript{2}Peking University, \\
 \textsuperscript{3}Southwest Jiaotong University,
 \textsuperscript{4}Shanghai Jiaotong University, \\
 \textsuperscript{5}Chinese University of Hong Kong
\\
 \small{
   \textbf{Correspondence:} \href{heconghui@pjlab.org.cn}{heconghui@pjlab.org.cn}
 }
}

\begin{document}
\maketitle
\begin{abstract}
Refusal-Aware Instruction Tuning (RAIT) aims to enhance Large Language Models (LLMs) by improving their ability to refuse responses to questions beyond their knowledge, thereby reducing hallucinations and improving reliability.
Effective RAIT must address two key challenges: firstly, effectively reject unknown questions to minimize hallucinations; secondly, avoid over-refusal to ensure questions that can be correctly answered are not rejected, thereby maintain the helpfulness of LLM outputs.
In this paper, we address the two challenges by deriving insightful observations from the gradient-based perspective, and proposing the \textbf{\underline{G}}radient-driven \textbf{\underline{R}}efusal-\textbf{\underline{A}}ware \textbf{\underline{I}}nstruction \textbf{\underline{T}}uning Framework (\textbf{\M}):
\M (1) employs gradient-driven sample selection to effectively minimize hallucinations and (2) introduces an adaptive weighting mechanism during fine-tuning to reduce the over-refusal.
Experiments on open-ended and multiple-choice question answering tasks demonstrate that \M significantly outperforms existing RAIT methods in the overall performance.
The source code and data will be available at \url{https://github.com/opendatalab/GRAIT}. 



\end{abstract}

\input{latex/1_Introduction.tex}

\input{latex/2_Related_Work.tex}

\input{latex/3_Theoretical_Analysis.tex}

\input{latex/4_Methodology.tex}

\input{latex/5_Experiment.tex}

\input{latex/6_Conclusion.tex}

\input{latex/7_Limitation.tex}

\section*{Acknowledgments}
This research was supported by Shanghai Artificial Intelligence Laboratory. 

\bibliography{custom}

\appendix

\input{latex/8_Appendix.tex}


% This is an appendix.

\end{document}
