\documentclass[journal,twoside,web]{ieeecolor2}
\usepackage{generic_arxiv}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\markboth{ }
{I.~E.~López-Delgado~\MakeLowercase{\textit{et al.}}: Radar Network for Gait Monitoring: Technology and Validation}
\usepackage{multirow}
\usepackage{stfloats}
\usepackage[caption=false, font=footnotesize]{subfig}


\graphicspath{{Images/}{Images/antenna/}{Images/algorithms/}{Images/comp_torso_foot/}{Images/network/}{Images/rel_error_box/}{Images/abs_error_time/}{Images/bland_altman/}{Images/correlation/}{Images/group_error/}{Images/network/combination/}{Images/rel_error_box_age/}}
	
\begin{document}

\title{Radar Network for Gait Monitoring: Technology and Validation}
\author{Ignacio E. López-Delgado*,~\IEEEmembership{Student,~IEEE}, 
	%Ignacio Sardinero-Meirás,~\IEEEmembership{Member,~IEEE}, 
	%Elías Antolinos,~\IEEEmembership{Student,~IEEE}, 
	%Marcos Gómez-Bracamonte,~\IEEEmembership{Student,~IEEE},
        Víctor Navarro-López,
	Francisco Grandas-Pérez,
	Juan~I.~Godino-Llorente,~\IEEEmembership{Senior Member,~IEEE}
	Jesús Grajal,~\IEEEmembership{Senior Member,~IEEE}
	% <-this % stops a space
    \thanks{This work was supported by the projects \hbox{PID2020-113979RB-C21}, \hbox{TED2021-131688B-I00}, \hbox{PID2021-128469OB-I00}, founded by \hbox{MCIN/AEI/10.13039/501100011033} and \hbox{NextGenerationEU/PRTR}. The work of Ignacio E. López-Delgado was supported by an FPU Fellowship granted by the Spanish Ministry of Innovation, Science and Universities: \hbox{FPU20/06405}.}
    \thanks{Ignacio E. López-Delgado (*correspondence e-mail: ie.lopez@upm.es), Juan I. Godino-Llorente and Jesús Grajal are with the Information Processing and Telecommunications Center of the Universidad Politécnica de Madrid (Av. Complutense, 30, 28040 Madrid, Spain). Francisco Grandas-Pérez is with the Movement Disorders Unit, Neurology Department of the Hospital General Universitario Gregorio Marañón, Madrid, Spain. Víctor Navarro-López is with the Movement Analysis, Biomechanics, Ergonomics, and Motor Control Laboratory of the Rey Juan Carlos University, Madrid, Spain}% <-this % stops a space
}                        

\maketitle

\begin{abstract}
In recent years, radar-based devices have emerged as an alternative approach for gait monitoring. However, the radar configuration and the algorithms used to extract the gait parameters often differ between contributions, lacking a systematic evaluation of the most appropriate setup. Additionally, radar-based studies often exclude motorically impaired subjects, leaving it unclear whether the existing algorithms are applicable to such populations.

In this paper, a radar network is developed and validated by monitoring the gait of five healthy individuals and three patients with Parkinson's disease. Six configurations and four algorithms were compared using Vicon\textsuperscript{®} as ground-truth to determine the most appropriate solution for gait monitoring.

The best results were obtained using only three nodes: two oriented towards the feet and one towards the torso. The most accurate stride velocity and distance in the state of the art were obtained with this configuration. Moreover, we show that analyzing the feet velocity increases the reliability of the temporal parameters, especially with aged or motorically impaired subjects.

The contribution is significant for the implementation of radar networks in clinical and domestic environments, as it addresses critical aspects concerning the radar network configuration and algorithms.
\end{abstract}

\begin{IEEEkeywords}
Clinical diagnosis, FCMW radar, gait monitoring, movement disorders, radar network.
\end{IEEEkeywords}

\section{Introduction}

\IEEEPARstart{G}{ait} can be analyzed to anticipate the detection of some diseases, study their progression, observe the effectiveness of treatments and anticipate potential risks associated with aging~\cite{gurbuz_2024}. Nowadays, gait is usually evaluated following subjective assessments based on certain protocols, like the \textit{Timed Up-And-Go} (TUG)~\cite{podsiadlo_1991}. This subjective evaluation is typically carried out in clinical environments by specialists in movement disorders. 

Due to the limited capacity of health systems and the required expertise, these evaluations are generally reserved for patients with clinical signs of movement disorders and are not available for the general population. Additionally, these evaluations bias the gait of the patients~\cite{liu_2022}: the gait is modified by sensors attached to the body and by the pressure caused by clinical environments. 

In order to provide more objective evaluations, clinicians often use different techniques to collect and analyze gait. The most common ones are based on wearable sensors~\cite{delrobaei_2018, perumal_2016} and/or video cameras~\cite{zanela_2022}:

\begin{itemize}
	\item Wearable sensors, such as inertial measurement units (IMUs), are low-cost devices that provide accurate measurements with a small computational cost. However, they need to be attached to the body, so they can cause discomfort. Moreover, they cannot provide continuous measurements because their battery is limited~\cite{delrobaei_2018, perumal_2016}.
	\item Video cameras also provide very accurate measurements. However, they invade the subject's privacy, are vulnerable to obstacles and low-illumination environments, have a high computational cost, and require expensive devices~\cite{zanela_2022}. The current gold-standard in gait monitoring integrates video cameras with wearable reflectors to provide more accurate measurements with a smaller computational burden. This is the case of the Vicon\textsuperscript{®} system~\cite{vicon}.
\end{itemize}

Despite the objectiveness provided by these techniques, their limitations significantly hinder their implementation in home or clinical settings. On the contrary, radar devices open the door to a potential monitoring of gait in a pervasive, continuous and non-obstructive way~\cite{liu_2022,siva_2024}.

Among other advantages, radar devices are low-cost, contactless and can provide continuous measurements preserving the subject's privacy without causing discomfort~\cite{liu_2022}. These advantages have caught the interest of researchers from the fields of radar and gait analysis. The main contributions to the state-of-the-art are summarized in Table~\ref{tab:state_of_the_art}~\cite{liu_2022, kabelac_2019, saho_2022, soubra_2023, gurbuz_2024, wang_2014, siva_2024, abedi_2022, hadjipanayi_2024}.

\input{tex/table_state_art.tex}

% Validation
Several radars have been validated with infra-red cameras and ground pressure sensors~\cite{liu_2022, saho_2022, soubra_2023, siva_2024, gurbuz_2024, hadjipanayi_2024}. However, motorically impaired subjects are often left out in these studies, not addressing whether the algorithms implemented are applicable for such populations. Furthermore, direct comparisons between these contributions are challenging, as they use different radar configurations (number and location of radars) and algorithms, not addressing which are optimal~\cite{gurbuz_2024}. 

% Radar location 
Regarding the radar network configuration, some works have implemented single-node systems~\cite{liu_2022, kabelac_2019, saho_2022, soubra_2023, gurbuz_2024}, which are usually limited to constrained gait paths. Fewer works have focused on implementing multi-node systems, achieving higher accuracies and opening the door to gait monitoring in unconstrained situations~\cite{siva_2024, hadjipanayi_2024}.

The optimal radar location is also being discussed. One option is to focus only at the torso motion using torso radars~\cite{liu_2022, kabelac_2019, saho_2022, gurbuz_2024, siva_2024, abedi_2022}. These radars have proved accurate at extracting spatiotemporal gait parameters in healthy individuals~\cite{saho_2022} by extrapolating the heel-strike (HS) and toe-off (TO) events from the torso velocity. Unluckily, this method can be inefficient for aged or motorically impaired subjects because the velocity of the torso is affected by certain movement disorders~\cite{trabassi_2023}. Moreover, torso radars face challenges in reliably estimating the foot maximum velocity, critical to assess gait asymmetries related with several diseases, like Parkinson's Disease (PD)~\cite{giannakou_2023}.

Another option is to focus on the feet motion using feet radars. These radars are effective at extracting temporal parameters~\cite{seifert_2019}, but they encounter difficulties in extracting the torso velocity and can be easily occluded at homes.

% 1 radar vs multiple radars
In order to exploit the advantages of each different configuration, they can be deployed simultaneously~\cite{saho_2022, soubra_2023, wang_2014, hadjipanayi_2024}. However, the question of whether the increase of the system complexity is a worthwhile pursuit, given the occasional increment in system accuracy, remains a topic of debate~\cite{saho_2022}.

In this paper, we present an approach to improve radar-based gait analysis by validating a configurable radar network. The validation is carried out analyzing large gait trials (more than ten minutes) of five healthy individuals and three patients with PD. Six different configurations are compared to choose the most suited for this purpose. Different algorithms are implemented to extract a set of gait parameters~\cite{liu_2022, seifert_2019, saho_2022}, analyzing their performance as a function of the network configuration. A Vicon system was used as ground-truth for the validation~\cite{vicon}.

To the best of our knowledge, this is the first radar network validation that considers different health conditions\footnote{Although the work presented in~\cite{siva_2024} was deployed at homes as a radar network, the validation was carried out with a single node.}. Moreover, we present a new methodology to combine the Doppler-time matrices of the nodes of a radar network. In addition, we extract a large amount of gait parameters, comparing the performance of different algorithms (~\cite{seifert_2019, saho_2022}) and configurations (single-node, multi-node, torso and feet deployments).

The results show for the first time that feet radars are more accurate at extracting temporal gait parameters when analyzing aged or motorically impaired subjects. Furthermore, the most accurate stride velocities of the state-of-the-art are extracted with the radar network configuration presented, demonstrating its suitability for clinical or domestic implementations.

This paper is structured as follows: Section~\ref{sec:radar_node} presents a radar node designed for gait monitoring. The radar network is validated in Section~\ref{sec:radar_network}, analyzing the gait of different individuals with different health conditions. Section~\ref{sec:discussion} analyzes the overall performance of this radar network, addressing key considerations for in-home implementations. Finally, Section \ref{sec:conclusion} presents the final conclusions of this work.

\section{24-GHz Radar Node}\label{sec:radar_node}

The radar node shown in Fig.~\ref{fig:node_info} is designed for home and clinical deployments. It features the following characteristics:

\begin{figure}[htbp]
	\centering
	\subfloat[Radar node]{\includegraphics[width=0.9\linewidth]{node_pcb}
	\label{fig:node_pcb}}
	\hfil
	\subfloat[Node schematic]{\includegraphics[width=0.8\linewidth]{node_schematic}
	\label{fig:node_schematic}}
	\hfil
	\subfloat[Radiation diagram (left) and EIRP (right)]{\includegraphics[width=\linewidth]{antenna_diagram_2d}
	\label{fig:antenna_diagram_2d}}
	\hfil
	\hspace{0.02\textwidth}
	\caption{24-GHz radar node. (a) RF and Control PCBs with the external elements that interact with the radar. (b) Schematic of the node. (c) Antenna characterization (left) and radar EIRP (right).}
	\label{fig:node_info}
        \vspace{-0.5cm}
\end{figure}

\begin{itemize}
	\item Compact design: 60x80 mm$^2$.
	\item Full gait analysis: The antennas feature a 40$^\circ$ beamwidth in both planes (as shown in Fig.~\ref{fig:antenna_diagram_2d}), to monitor individuals walking 1 m away from the radar. The node operative parameters are configurable (see Table~\ref{tab:node_requirements}~\cite{lopez_2023}).
	\item Wireless communication protocol: The nodes can send the recorded data to a processing unit using Bluetooth\textsuperscript{®} Low Energy~\cite{stm32wb15cc}.
	\item Low-cost system: The nodes use commercial-off-the-shelf components and microstrip antennas. The total cost of the prototype shown in Fig.~\ref{fig:node_schematic} is $\sim$ 150 €.
	\item Scalable design: The nodes are easily integrated into a radar network, as shown in Section \ref{sec:radar_network}.
\end{itemize}

\input{tex/table_node.tex}

The radar nodes have two boards connected: the RF PCB and the control PCB. The diagram of these PCBs is shown in Fig.~\ref{fig:node_schematic}. 

The RF PCB contains the radar MMIC Infineon\textsuperscript{®} BGT24MTR11~\cite{bgt24mtr11}, the phase-frequency detector (PFD) Analog Devices\textsuperscript{®} ADF4159~\cite{adf4159}, and the antennas. The characterization of the antennas, carried out in an anaechoic chamber, is shown in Fig.~\ref{fig:antenna_diagram_2d}. The maximum EIRP considering the antenna gain and the MMIC output power is 15.5 $\pm$ 1 dBm.

The Control PCB contains the power control unit, the IF signal conditioning stage, and the microcontroller STM32WB15CC~\cite{stm32wb15cc} that samples the IQ signals and sends them via Bluetooth. Alternatively, the IQ signals can be sampled with an external Analog to Digital converter (ADC), as is done in this work. For a more detailed analysis of the Control PCB, refer to our previous work~\cite{lopez_2023}.

The radar node is configured in Linear Frequency-Modulated Continuous-Wave (LFMCW) mode. The signal model of the LFMCW radar is shown in Fig.~\ref{fig:fmcw_signal}, where it is shown that the frequency difference between the transmitted and received signals (beat frequency) is proportional to the range $R$ of the target. The IQ signals result from low-pass filtering the mix of the transmitted and received signals.

\begin{figure}[t]
        \vspace{-0.4cm}
	\centering
	\includegraphics[width=\linewidth]{fmcw_signal}			
	\caption{Signal model of LFMCW radars, where $f_0$ is the start frequency, $B$, the bandwidth, $T_c$, the chirp time, $R$, the range of the target and $c$, the speed of light.}
	\label{fig:fmcw_signal}
    \vspace{-0.5cm}
\end{figure}

\begin{figure}[b]
    \vspace{-0.3cm}
	\centering
	\includegraphics[width=0.85\linewidth]{algorithm_fmcw}
	\caption{Algorithm implemented to extract the range-time and Doppler-time matrices.}
	\label{fig:algorithm_fmcw}
\end{figure}

The gait parameters are extracted from both the range-time~\cite{adib_2015, liu_2022} and Doppler-time matrices~\cite{tivive_2015, seifert_2019, ash_2018, hu_2022}. The steps followed in this work to extract them (see Fig.~\ref{fig:algorithm_fmcw}) are:

\begin{enumerate}
	\item Extract the range-time matrix $S \left(R, \tau\right)$, calculating the Fast-Fourier Transform with a Hann window of the IQ signals: $S \left(R, \tau\right) = \mathcal{F}\left[s \left(t, \tau\right)\right]$. The range-time matrix is filtered in the time dimension to eliminate the clutter using a high-pass filter with 10-Hz cutoff frequency~\cite{adib_2015, ash_2018}. The transient state is eliminated from the measurement.
	\item Integrate the bins of the target: The range bins containing the target, represented with white arrows in Fig~\ref{fig:algorithm_fmcw}, are added coherently: $S_{\Sigma} \left(\tau\right) = \sum_{R} S\left(R, \tau\right)$~\cite{adib_2015, hu_2022}.
	\item Extract the Doppler-time matrix: The Doppler-time matrix $S \left(f_D, \tau\right)$ is calculated extracting the short-time Fourier Transform (STFT) of $S_{\Sigma} \left(\tau\right)$: $S \left(f_D, \tau\right) = \mathrm{STFT}\left\{S_{\Sigma} \left(\tau\right)\right\}$, using a $T_M = $ 50 ms Hann window with a time shift of one sample.
\end{enumerate}

\section{Radar Network Validation}\label{sec:radar_network}

The radar network implemented in this study has been configured for analyzing subjects undergoing clinical gait assessments. It is comprised of two tripods, each holding a feet node and a torso node. The tripods are placed facing one another at the ends of the walking platform, as shown in Fig.~\ref{fig:network_implementation}. The four nodes connected to an external processing unit.

Comparisons are carried out using a Vicon system equipped with 8-Valkyrie cameras as ground-truth, synchronized with the radar's ADC using a trigger signal generated by the Vicon device. The participants hold 32 Vicon reflectors placed on the sternum, the 10$^\mathrm{th}$ thoracic vertebra, both left and right interior wrists, exterior wrists, anterior superior iliac spines, posterior superior iliac spines, thighs, knees, tibiae, ankles, heels and toes. Experiments were carried out to verify that the presence of the Vicon reflectors does not enhance the SNR of the Doppler signatures.

The signals captured by the Vicon\textsuperscript{®} are processed as explained in~\cite{oconnor_2007}, as in other radar validations~\cite{hadjipanayi_2024}. Nonetheless, the techniques presented in~\cite{oconnor_2007} report temporal errors of $\pm$25 ms~\cite{oconnor_2007}, as they focus on the feet velocity rather than on the feet location.

The four radar nodes are configured with $f_0$ = 23 GHz, $B$ = 1.4 GHz and $T_c$ = 625 $\mu$s~\cite{lopez_2023}. They capture signals simultaneously, but can be processed independently. This way, we compare the radar configurations shown in Table~\ref{tab:configuration_nodes}: C1-C4 are compared in this section. The results obtained are then discussed in Section~\ref{sec:discussion} to analyze C5 and C6.

\begin{figure}[t]
	\centering
	\subfloat[Radar network schematic]{\includegraphics[width=\linewidth]{network_architecture}
	\label{fig:network_architecture}}
	\hfil
	\subfloat[Experimental setup]{\includegraphics[width=0.8\linewidth]{setup_lambecom}
	\label{fig:setup_lambecom}}
	\caption{Radar network implementation. (a) Illustration of the radar network with a subject performing the TUG test. (b) Photograph of the experimental setup highlighting the nodes and the Vicon cameras used as ground-truth.}
	\label{fig:network_implementation}
    \vspace{-0.5cm}
\end{figure}

% It is important to highlight that the radars did not interfere with each other during the measurements performed, even though they are facing one another, sharing the same configuration. This is because it is very unlikely that two radars are bursting the same frequency band during the same time frames. A slight RF frequency difference between nodes is filtered in the IF stage.

\begin{table}[b]
\vspace{-0.5cm}
	\centering
	\caption{Configurations Compared to Evaluate the Performance of the Radar Network and the Signal Processing Algorithms}
	\label{tab:configuration_nodes}
	\begin{tabular}{@{}ccc@{}}
		\hline
		Configuration & Torso nodes & Feet nodes \\ \hline
		Configuration 1 (C1)           & 1           & 0          \\
		Configuration 2 (C2)           & 0           & 1          \\
		Configuration 3 (C3)           & 2           & 0          \\
		Configuration 4 (C4)           & 0           & 2          \\
        Configuration 5 (C5)           & 1           & 2          \\
        Configuration 6 (C6)           & 2           & 2          \\ \hline
		\end{tabular}
\end{table}

C1 and C2 experience an SNR decay when the subject walks away from the radar. To handle this, the Doppler signatures of the nodes with the same height in C3 and C4 are combined by selecting the time frames of the Doppler-time matrix of the node with higher SNR, as shown in Fig.~\ref{fig:comb_udoppler}. Prior to this combination, one of the Doppler-time matrices is flipped with respect to the Doppler axis. As a result of this combination, it is obtained a single Doppler-time matrix with enhanced SNR. 

\input{tex/comb_udoppler.tex}

Four different signal processing algorithms are compared for each configuration, analyzing their performance. Two algorithms focus on the extraction of temporal gait parameters (stride, step, stance, swing and double-support times)~\cite{seifert_2019, saho_2022}, while the other two focus on the extraction of spatial parameters (stride and step distance and velocity)~\cite{seifert_2019, liu_2022}. 

\subsection{Protocol and Corpus}

The radar network along with the Vicon system were deployed at the Laboratorio de Biomecánica, Ergonomía y Control Motor (LAMBECOM) belonging to the Universidad Rey Juan Carlos I, Madrid, Spain.

Participants were recruited by the Neurology Service of Hospital General Universitario Gregorio Marañón (HGUGM), Madrid, Spain. All participants were properly informed about the experiment conditions and agreed to participate by signing a consent form. Participants did not receive any compensation, and were informed of their rights and the possibility of leaving the study at any time. Patients were individually identified with a code, which is different from the one used for their clinical histories. No personal data was exchanged with the researchers who processed and curated the corpus.

The procedures followed to collect and process the data were approved with the code PD-RADAR-05/2024 by the Ethics Committee of the HGUGM in accordance with the Spanish Ethical Review Act.

Eight different participants are recorded performing different clinical trials:

\begin{itemize}
	\item TUG~\cite{podsiadlo_1991} (trial 1): The subject stands up from a chair, walks 3~m in a straight line, turns around, walks back to the chair and sits down, as shown in Fig.~\ref{fig:network_architecture}. The participants perform the TUG ten times at quick pace (compared to each participant's normal pace). 
	\item Continuous walk: The subject walks in a straight line and turns around every 3~m. The participants are asked to perform four different continuous-walk trials: Twenty repetitions at normal pace (trial~2), slow pace (trial~3), quick pace (trial~4), and 120~s at normal pace (trial~5).
\end{itemize}

The aforementioned trials guarantee that the radar network is validated at different gait speeds, and that it is robust against gait changes like standing, turning and sitting.

The participants are divided into three groups according to their age and health condition:

\begin{itemize}
	\item Group 1 (G1): Healthy and young participants; 2 male and 1 female, aged between 21 and 24 years old without known motor disorders.
	\item Group 2 (G2): Healthy and aged participants; 1 male and 1 female, aged between 55 and 71 years old without known motor disorders.
	\item Group 3 (G3): PD participants; 2 male and 1 female, aged between 59 and 78 years old with Parkinson's Disease diagnosed in the last four years previous to the experiment.
\end{itemize}

Although the number of participants is scarce, it is important to consider that each participant is recorded walking for more than ten minutes. Thus, a large number of gait cycles per participant is analyzed, larger than other state-of-the-art contributions \cite{saho_2022, soubra_2023, siva_2024, gurbuz_2024, hadjipanayi_2024}, as shown in next sections. 

\subsection{Validation: Heel-Strike and Toe-Off Events}

A gait cycle, represented in Fig.~\ref{fig:gait_cycle}, is the interval between two heel strikes (HS) of the primary foot. After the first HS, the opposite heel lays on the ground (opposite HS event), and the primary foot leaves the ground (toe-off (TO) event).

\begin{figure}[t]
\vspace{0.1cm}
	\centering
	\includegraphics[width=\linewidth]{gait_cycle}			
	\caption{Gait cycle stages and events extracted from a Vicon motion capture. The HS and TO events are reflected in the velocity of the feet and torso.}
	\label{fig:gait_cycle}
	% URJCC002 performing trial 2.
\end{figure}

There are two approaches to determine the HS and TO events: 
\begin{itemize}
	\item The method proposed by Seifert et al.~\cite{seifert_2019} is based on the fact that the velocity of the feet is zero when they lay on the ground, as shown in Fig.~\ref{fig:gait_cycle}. The HS events are the local minima of the feet Doppler frequency. The Doppler contribution of the feet is isolated because they present the largest velocity, as shown in Fig.~\ref{fig:alg_seifert}. This method is considered more efficient for feet nodes, so it is applied for C2 and C4.
	\item The method proposed by Saho et al.~\cite{saho_2022} is based on the correlation between the torso velocity and the HS and TO events, shown in Fig.~\ref{fig:gait_cycle}. This method identifies the HS events at the torso Doppler frequency peaks, and the TO events at the torso acceleration peaks. The Doppler frequency of the torso is easily isolated because the torso represents the most powerful Doppler component, as shown in Fig.~\ref{fig:alg_saho}. This method is considered more efficient for torso nodes, so it is applied for C1 and C3.
\end{itemize}

\begin{figure}[t]
        \vspace{-0.4cm}
	\centering
	\subfloat[Feet]{\includegraphics[width=0.48\linewidth]{alg_seifert}
	\label{fig:alg_seifert}}
	\hfil
	\subfloat[Torso]{\includegraphics[width=0.48\linewidth]{alg_saho}
	\label{fig:alg_saho}}
	\caption{Illustration of the algorithms implemented to identify the HS and TO events from the Doppler contributions of the feet (a) and the torso (b).}
	\label{fig:algorithm_comparison}
    \vspace{-0.5cm}
\end{figure}

The HS detection ratio, shown in Table~\ref{tab:hs_detection_ratio}, measures the ratio of HS events detected by both the radar and the Vicon, and the HS events detected by the Vicon (ground-truth). As a reference, Table~\ref{tab:hs_detection_ratio} also includes the number of gait cycles. It is important to consider that the first and last gait cycles of each sequence are discarded and not considered in Table~\ref{tab:hs_detection_ratio}. Four main conclusions are drawn out from Table~\ref{tab:hs_detection_ratio}:

\begin{enumerate}
    \item C4, featuring 2 feet nodes, presents the highest HS detection ratio for all the tests carried out.
    \item Adding a second feet node (comparing C2 with C4) increases the HS detection ratio, while adding a second torso node (comparing C1 with C3) does not. This is because the SNR decay experienced when the subjects move away from the radar is stronger in the case of the feet, because the torso is the largest reflector.
    \item Feet nodes are robust for all gait velocities. On the contrary, the performance of torso nodes decays when the subject walks fast (tests 1 and 4).
\end{enumerate}

\input{tex/table_hs_detection_ratio.tex}

The effect of the radar configuration is also analyzed for aged and motorically impaired subjects. 
A strong correlation between the torso velocity and the HS and TO events is reported for healthy subjects. However, this relationship is lost for motorically impaired subjects, as a consequence of a movement disorder. Therefore, it is more convenient to extract the HS and TO events by looking at the feet motion, contrary to the proposal of~\cite{saho_2022}.

This effect is observed in Fig.~\ref{fig:feet_algorithms_comp}: Figs. \ref{fig:feet_algorithms_comp}a and b show the feet velocity of two people of G1 and G3, respectively, performing Test 5. In both cases, the HS events are clearly differentiable, i.e. the local minima of the feet velocity~\cite{seifert_2019}. Figs. \ref{fig:feet_algorithms_comp}c and d show the torso velocity during the same time frames, exhibiting a pattern that makes the detection of the HS events (i.e., the local maxima of the torso velocity~\cite{saho_2022}) more difficult for those participants belonging to G3.

\begin{figure}[t]
	\centering
	\includegraphics[width=\linewidth]{feet_algorithms_comp}			
	\caption{Feet motion (a and b) is reliable to extract the HS and TO events for both healthy and motorically impaired subjects. The torso motion (c and d) is not reliable for motorically impaired subjects (d). All figures show a gait cycle, comparing the HS events extracted with the Vicon (ground-truth) and the radar.}
	\label{fig:feet_algorithms_comp}
    \vspace{-0.3cm}
\end{figure}

\subsection{Temporal Gait Parameters}

The HS and TO events are used to compute five gait parameters, represented in Fig.~\ref{fig:gait_cycle}: 
\begin{itemize}
	\item Stride time: Interval between a HS event and the next HS event of the same foot.
	\item Step time: Interval between a HS event and the next HS event of the opposite foot.
	\item Stance time: Interval between a HS event and the next TO event of the same foot.
	\item Swing time: Interval between a TO event and the next HS event of the same foot.
	\item Double-support time: Interval between a HS and the next TO of the opposite foot.
\end{itemize}

For each gait parameter extracted by both the radar ($P_{\mathrm{rad}}$) and the Vicon ($P_{\mathrm{vic}}$), it is extracted the absolute value of the relative error $|\varepsilon_r|$, given by Eq. \ref{eq:abs_rel_err}. This metric was also used in~\cite{hadjipanayi_2024}.

\begin{equation}\label{eq:abs_rel_err}
	|\varepsilon_r| = \left| \cfrac{P_{\mathrm{vic}}-P_{\mathrm{rad}}}{P_{\mathrm{vic}}} \right|
\end{equation}

The distribution of $|\varepsilon_r|$ for the temporal gait parameters for the different configurations is shown in Fig.~\ref{fig:rel_error_temp_box}. The mean of $|\varepsilon_r|$ for the different subject groups is shown in Table~\ref{tab:mean_error_temp}. It is important to interpret Fig.~\ref{fig:rel_error_temp_box} and Table~\ref{tab:mean_error_temp} considering the results obtained in Table~\ref{tab:hs_detection_ratio}. Sometimes, a smaller $|\varepsilon_r|$ is obtained as a consequence of a smaller HS detection ratio. % This is the case of the double support time $|\varepsilon_r|$ achieved with C1, which is smaller than the one achieved with C4, but C1 detects 0.76 HS events, while C4 detects 0.97. 
The objective is to increase the HS detection ratio as long as the error does not increase. The main conclusions extracted from Fig.~\ref{fig:rel_error_temp_box} and Table~\ref{tab:mean_error_temp}, are:

\begin{itemize}
	\item Two feet node radar networks (C4) provide more reliable temporal metrics than two torso nodes (C3). This is because feet radars extract the HS and TO events directly from the feet velocity.
	\item Even though a single torso node (C1) is sometimes more accurate than a single feet node (C3), more gait cycles are detected with C3, as shown in Table~\ref{tab:hs_detection_ratio}.
	\item The $|\varepsilon_r|$ are larger for the swing and double-support times. The reason is that the error magnitude, $|\varepsilon| = \left| P_{\mathrm{vic}}-P_{\mathrm{rad}} \right|$ is similar for all the temporal parameters, as shown in Fig.~\ref{fig:abs_error_time}. Thus, smaller temporal parameters present larger relative errors. , i.e. a 0.05~s error in a 1.2~s stride leads to $|\varepsilon_r|$=0.04, while the same 0.05~s error in a 0.44 s swing phase leads to $|\varepsilon_r|$=0.13.
	%Fig.~\ref{fig:abs_error_time} also shows that the smallest errors are observed in the stride and step times, which are only based on the HS events, i.e. the algorithms implemented are more robust determining the HS than the TO events.
\end{itemize}

\noindent These conclusions are further discussed in Section \ref{sec:discussion}.
\input{tex/rel_error_temp_box.tex}
\input{tex/table_temp_error.tex}

\begin{figure}[t]
	\centering
	\includegraphics[width=0.8\linewidth]{abs_error_time}			
	\caption{Comparison of the error magnitude $|\varepsilon|$ for the temporal parameters for C4.}
	\label{fig:abs_error_time}
    \vspace{-0.4cm}
\end{figure}

%\input{tex/rel_error_age_box.tex}
%\input{tex/table_hs_detection_ratio_age.tex}

\subsection{Spatial Gait Parameters}

The spatial gait parameters are the stride distance and step distance, which measure the distance traveled during a stride or a step, respectively; and the stride velocity and step velocity, which measure the mean gait velocity during a stride or a step, respectively. There are two approaches to extract them:

\begin{itemize}
	\item The method proposed by Seifert et al.~\cite{seifert_2019} is based on calculating the mean torso velocity during a step or a stride to later calculate the distance multiplying by the temporal parameters. This method is implemented for C1 and C3, as is more efficient for torso nodes.
	\item Liu et al.~\cite{liu_2022} calculate the distance traveled from the range-time matrix, to later calculate the velocity dividing the distance dividing by the temporal parameters. This method can be applied for both feet and torso nodes, being the only adequate method for feet nodes. Thus, it is implemented for C2 and C4.
\end{itemize}

% It is important to acknowledge that the spatial parameters depend on the accuracy of the HS and TO estimations. To fairly compare the aforementioned algorithms, the HS and TO estimations achieved with configuration 4 are used for all the configurations in this section.

The distribution of $|\varepsilon_r|$ for the spatial gait parameters for the different configurations is shown in Fig.~\ref{fig:rel_error_dist_box} and Table~\ref{tab:mean_error_dist}. The main conclusion is that the spatial parameters from the torso radars (C1 and C3) are more accurate, being C1 the best configuration. In other words, deploying two torso nodes (C3) slightly degrades the performance of the system. This may be caused because the Doppler-time matrix combination introduces errors in the Doppler component of the torso. This conclusion is further discussed in Section \ref{sec:discussion}.


\input{tex/table_space_error.tex}
\input{tex/rel_error_space_box.tex}

\subsection{Other Spatiotemporal Gait Parameters}

There are other spatiotemporal gait parameters that can be extracted with some configurations proposed in this study.

The cadence is a commonly-used parameter that measures the number of steps per minute \cite{giannakou_2023}. This parameter is not analyzed in this study as can be extracted as the inverse of the step time, which has already been reported.

The foot maximum velocity is a gait parameter critical for assessing gait asymmetries related with some diseases, such as PD~\cite{giannakou_2023, lopezdelgado_2025}. This parameter is better extracted with feet radars~\cite{seifert_2019}. With C4, the mean $|\varepsilon_r|$ of the foot maximum velocity is 0.10 (0.08, 0.12 and 0.11 for G1, G2 and G3, respectively).

\section{Discussion}\label{sec:discussion}

The previous section showed that a three-node radar network featuring one torso node and two feet nodes is the most adequate between the ones studied to extract all the spatiotemporal gait parameters in a clinical or a hallway implementation. This configuration, named as C5, is even more accurate than a four-node configuration, as shown in Table~\ref{tab:mean_error_opt}. This section addresses some considerations concerning these configurations.

\vspace{-0.2cm}
\subsection{Radar Network Reliability} 

\input{tex/group_error.tex}
\input{tex/table_error_opt.tex}
\input{tex/table_validation.tex}

% The error metrics used differ between contributions, being the mean error in~\cite{saho_2022}, the mean-squared error in~\cite{soubra_2023}, the mean absolute accuracy in~\cite{hadjipanayi_2024}, and the mean and standard deviation in~\cite{siva_2024, gurbuz_2024} (in Table~\ref{tab:comp_validation} it is reported the standard deviation). In fact, the errors reported in~\cite{saho_2022} are the mean errors calculated after averaging different trials, i.e. the mean error of the mean stride time, mean step time, etc.

The $|\varepsilon_r|$ distribution for the different groups of subjects with C5 is shown in Fig.~\ref{fig:group_error} and Table~\ref{tab:mean_error_opt}. Besides for the double-support times, the mean $|\varepsilon_r|$ is below 15\% for all gait parameters reported. Table~\ref{tab:comp_validation} compares the errors reported with C5 and other state-of-the-art contributions\footnote{The errors extracted in this work are not compared to the errors in~\cite{saho_2022} and the distance errors in~\cite{soubra_2023}. The former computed the mean error after averaging different trials, while the latter assumed the total distance walked is known, being the results hereby presented independent of the total distance.}:

% With the optimal configuration, 97\% of the HS events are detected. Moreover, the mean of the absolute relative errors is below 15\% for all gait parameters extracted except for the double-support time, being below 15\% the step velocity, stride distance, stance time, step time, and foot maximum velocity; and below 10\% the stride velocity and the stride time.

\begin{itemize}
        \item This contribution reports the most accurate stride velocity, step velocity, stride distance, and step distance metrics. Moreover, it is the only one that reports the accuracy of the foot maximum velocity, which can be used to analyze gait symmetry ~\cite{giannakou_2023, lopezdelgado_2025}.
	\item The most accurate stride and swing time results are reported by Gurbuz et al.~\cite{gurbuz_2024} and Soubra et al.~\cite{soubra_2023}, respectively, while Hadjipanayi et al.~\cite{hadjipanayi_2024} reported the most accurate results concerning the other temporal gait parameters. These validations were not carried out with motorically impaired subjects. Thus, in~\cite{gurbuz_2024, soubra_2023}, it is possible to foresee an accuracy decay when analyzing such subjects, as only torso radars were used, and we showed that the accuracy of torso radars decays for the subjects belonging to G3 (see Fig.~\ref{fig:feet_algorithms_comp}). As regards~\cite{hadjipanayi_2024}, the accuracy achieved is in agreement with the methods proposed in this paper, as they focus on the movement of the feet.
    \item Although other state-of-the-art validations are carried out with more participants, the validation presented in this work evaluates more gait cycles, considering also motorically impaired subjects. Still, it would be convenient to confirm the results obtained in this work with more measurements.
	% \item The most accurate stride and step distance are reported by Hadjipanayi et al.~\cite{hadjipanayi_2024}.
    \vspace{-0.1cm}
\end{itemize}

The radar network presented is this paper is suitable for analyzing gait of individuals with different health conditions in various scenarios. This conclusion is extracted after evaluating the correlation and the Bland-Altman~\cite{bland_1986} plots shown in Figs.~\ref{fig:correlation}~and~\ref{fig:bland_altman}, respectively.

\input{tex/correlation.tex}
\input{tex/bland_altman.tex}

The results in Fig.~\ref{fig:correlation} show high correlation between the radar and the Vicon estimates for the stride time, step time, stance time, stride velocity, step velocity, stride length, step length and foot maximum velocity. In fact, the correlation coefficients for the stride and step length are the highest reported in the state-of-the-art~\cite{hadjipanayi_2024}. This is beneficial for clinical implementations, which need accurate results. 

The radar network is also robust for home implementations, where it is needed to analyze the gait evolution with time. The Bland-Altman plots of Fig.~\ref{fig:bland_altman} show that the estimates are almost unbiased, guaranteeing long-term accuracy.  

The fact that the estimates are unbiased for all groups analyzed guarantees that the algorithms implemented are equally robust for all subject groups studied. These results are in agreement with the ones in Fig.~\ref{fig:group_error}, which show almost no increase in $|\varepsilon_r|$ with the subjects of group 3 (aged and PD).  

\subsection{Algorithm Limitations}

The contributions shown in Table~\ref{tab:comp_validation} are close to the accuracy limit that can be achieved with the algorithms implemented~\cite{seifert_2019, saho_2022}. The main limitation is linked to the fact that it is not possible to completely isolate the Doppler components of each body part, as all body parts interfere in the Doppler-time matrix. Consequently, a small error is committed in each estimate that affects all the spatiotemporal gait parameters. For instance, when estimating the HS events~\cite{seifert_2019}, it is not possible to observe the exact time frame in which the feet velocity becomes zero, as shown in Fig.~\ref{fig:alg_seifert}. 

Similarly, the feet and torso Doppler contributions are filtered to avoid errors caused by the interferences of other body parts~\cite{seifert_2019, saho_2022}, as shown in Fig.~\ref{fig:alg_saho}. Although necessary, these filters introduce errors into the spatiotemporal gait parameters.

\subsection{Configuration Considerations}

Although this paper presents a 3-node radar network as the preferred solution, home deployments may not always allow for these placements. For instance, it may not be possible to place feet nodes at both ends of the corridor. This can be solved by increasing the transmitted power of the radars at one end, as in~\cite{gurbuz_2024, liu_2022, abedi_2022, hadjipanayi_2024}.

In those scenarios where it is only possible to implement a single node, the results presented in Table~\ref{tab:mean_error_temp} show that it is better to place it at the torso height and implement the algorithm in~\cite{saho_2022}.

\section{Conclusion}\label{sec:conclusion}

This paper addresses many open questions concerning the deployment of radar systems for gait monitoring. This is achieved by designing a new configurable radar network, analyzing its performance under different configurations, and implementing different algorithms to extract the most relevant parameters. Furthermore, subjects with PD have been considered for the first time in a radar validation, rising up concerns often overlooked when analyzing healthy subjects. 

The results obtained show that:
\begin{itemize}
	\item The data extracted from feet nodes are more relevant to extract temporal gait parameters, especially of aged or motorically impaired subjects.
	\item The data extracted from torso nodes are more relevant to extract the spatial gait parameters.
	\item The most accurate results are obtained by combining two feet and one torso node. To achieve this, a novel technique to combine Doppler-time matrices has been proposed.
	\item The algorithms developed by Seifert et al.~\cite{seifert_2019} are the most suitable to extract the gait parameters.
\end{itemize}

The radar network presented in this paper offers a rapid and accurate analysis of gait. This can be beneficial for clinical and domestic implementations, which need to be time and cost effective. Other state-of-art technologies (cameras, wearables, etc.) are costly and require a large amount of time to set them up and process the data. 

Therefore, radar technology is a reliable solution for gait analysis, robust for aged and motorically impaired people. This is useful to anticipate the detection of movement disorders, or prevent risks linked with age.

\section*{Acknowledegment}
\par{\small 
The authors thank the Neurology Service of Hospital General Universitario Gregorio Marañón, Madrid, and the LAMBECOM laboratory of Universidad Rey Juan Carlos for the facilities provided. Furthermore, the authors thank the professionals at LAMBECOM: Dr. Juan Carlos Miangolarra-Page, Dr. Francisco Molina-Rueda, and Dr. Diego Fernández-Vázquez.

The authors would like to thank the participants in the experiment for their availability.
}

\begin{thebibliography}{00}
% \bibliographystyle{IEEEtran}
\input{bibliography_ieee.tex} 
\end{thebibliography}
%\bibliographystyle{IEEEtran}
%\bibliography{bibliography_radar} 

% \begin{IEEEbiography}
% [{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Images/authors/ield_crop.jpg}}]{Ignacio E. López Delgado} (Student, IEEE) was born in Madrid, Spain, in 1998. He received his degree in Telecommunication Engineering, and his Masters Degree in Signal Theory and Communications, under the RF systems track, from the Universidad Politécnica de Madrid (UPM), Spain, in 2020 and 2021, respectively. He is currently a PhD Student at the Information Processing and Telecommunications Center of the UPM, with a Formación de Profesorado Universitario scholarship granted by the Spanish Ministry of Innovation, Science and Universities. His research interests include the development of radar systems for gait monitoring, and radar signal processing. He has authored 4 peer-reviewed publications.
% \end{IEEEbiography}

% \begin{IEEEbiography}
% [{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Images/authors/victor.png}}]{Víctor Navarro-López} (PT, PhD) was born in Madrid, Spain, in 1996. He is a physiotherapist and PhD from the Rey Juan Carlos University (URJC). He is specialized in movement analysis, especially in patients with neurological pathology. He is currently assistant professor at the URJC where he is part of the Department of Physiotherapy, Occupational Therapy, Rehabilitation and Physical Medicine and the consolidated research group Laboratory of Movement Analysis, Biomechanics, Ergonomics and Motor Control.
% \end{IEEEbiography}

% \begin{IEEEbiography}
% [{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Images/authors/grandas.jpg}}]{Francisco Grandas-Pérez} is currently pursuing the M.D. degree in neurology with the University Hospital of Oviedo, Spain. He was trained in movement disorders at the Maudsley Hospital, London, U.K. He has been a Professor of neurology with the Universidad Complutense, Madrid, Spain, since 2017, and the Head of the Department of Neurology of the University Hospital Gregorio Marañón, Madrid, since 2014. His research interests include the field of Parkinson’s disease and movementdisorders. 
% \end{IEEEbiography}

% \begin{IEEEbiography}
% [{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Images/authors/godino.jpg}}]{Juan I. Godino-Llorente} (Senior Member, IEEE) was born in Madrid, Spain, in 1969. He received the B.Sc. and M.Sc. degrees in telecommunications engineering and the Ph.D. degree in computer science from Universidad Politécnica de Madrid (UPM), Spain, in 1992, 1996, and 2002, respectively. From 1996 to 2003, he was an Assistant Professor with the Circuits and Systems Engineering Department, UPM. From 2003 to 2005, he joined the Signal Theory and Communications Department, University of Alcalá. In 2005, he joined UPM again, being the Head of the Circuits and Systems Engineering Department, from 2006 to 2010. Since 2011, he has been a Full Professor with the Signal Systems and Radio Communications Department, UPM. He has also been the Spanish Coordinator of the 2103 COST Action funded by the European Science Foundation and the General Chairperson of the Third Advanced Voice Function Assessment Workshop. During his career, he has led more than 20 research projects funded by national and international public bodies and industries. From 2003 to 2004, he was a Visiting Professor with Salford University, Manchester, U.K. In 2016, he was a Visiting Researcher with the Massachusetts Institute of Technology, Cambridge, MA, USA, funded by a Fulbright Grant. He has served as an Editor for Speech Communication, the EURASIP Journal on Advances in Signal Processing, the IEEE Journal of Selected Topics in Signal Processing (JSTSP), and the IEEE Transactions on Audio, Speech, and Language Processing (TASLP).
% \end{IEEEbiography}

% \begin{IEEEbiography}
% [{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Images/authors/Jesus_Grajal.pdf}}]{Jesús Grajal} (Senior Member, IEEE) was born in Toral de los Guzmanes (León), Spain, in 1967. He received the Ingeniero de Telecomunicación degree and the Ph.D. degree from the Universidad Politécnica de Madrid, Madrid, Spain, in 1992 and 1998, respectively.
% Since 2017 he has been a Full Professor with the Signals, Systems, and Radiocommunications Department of the Universidad Politécnica de Madrid, Madrid, Spain.
% His research interests include hardware design for radar systems, radar signal processing, and broadband digital receivers for radar and spectrum surveillance applications. Dr. Grajal was a co-recipient of the 2013 EuCAP Best Antenna Design Paper Award.
% \end{IEEEbiography}

\end{document}
