% !TEX root = ./main.tex


\usepackage{stmaryrd}
\usepackage{csquotes}

%% MARGIN MAGIC
%
\def\changemargin#1#2{\list{}{\rightmargin#2\leftmargin#1}\item[]}
\let\endchangemargin=\endlist


\newcommand{\highlight}[1]{\colorbox{gray!30}{$\displaystyle#1$}}


% TODOS
\setlength{\marginparwidth}{1.5cm} %This is also for todonotes
\newcommand{\blkcomment}[1]{\todo[color=cyan!30,size=\scriptsize,fancyline,author=Benjamin]{#1}\xspace}
\newcommand{\blkcommentinline}[1]{\todo[inline,color=cyan!30,author=Benjamin]{#1}\xspace}
\newcommand{\blkin}[1]{\blkcommentinline{#1}}
\newcommand{\blk}[1]{\blkcomment{#1}}
\newcommand{\atblk}{\colorbox{cyan!30}{\textbf{@Benjamin}}}

\newcommand{\jpkcomment}[1]{\todo[color=orange!80,size=\scriptsize,fancyline,author=Joost-Pieter]{#1}\xspace}
\newcommand{\jpkcommentinline}[1]{\todo[inline,color=orange!80,author=Joost-Pieter]{#1}\xspace}
\newcommand{\atjpk}{\colorbox{orange!80}{\textbf{@Joost-Pieter}}}

\newcommand{\awcomment}[1]{\todo[color=green,size=\scriptsize,fancyline,author=Anran]{#1}\xspace}
\newcommand{\awcommentinline}[1]{\todo[inline,color=green,author=Anran]{#1}\xspace}
\newcommand{\ataw}{\colorbox{green}{\textbf{@Anran}}}

\newcommand{\kbcomment}[1]{\todo[color=yellow,size=\scriptsize,fancyline,author=Kevin]{#1}\xspace}
\newcommand{\kbcommentinline}[1]{\todo[inline,color=yellow,author=Kevin]{#1}\xspace}
\newcommand{\atkb}{\colorbox{yellow}{\textbf{@Kevin}}}

\newcommand{\tncomment}[1]{\todo[color=blue!25,size=\scriptsize,fancyline,author=Thomas]{#1}\xspace}
\newcommand{\tncommentinline}[1]{\todo[inline,color=blue!25,author=Thomas]{#1}\xspace}
\newcommand{\attn}{\colorbox{blue!25}{\textbf{@Thomas}}}

\newcommand{\lvcomment}[1]{\todo[color=blue!25,size=\scriptsize,fancyline,author=Lena]{#1}\xspace}
\newcommand{\lvcommentinline}[1]{\todo[inline,color=blue!25,author=Lena]{#1}\xspace}
\newcommand{\lv}[1]{\lvcomment{#1}}
\newcommand{\lvin}[1]{\lvcommentinline{#1}}
\newcommand{\atlv}{\colorbox{blue!25}{\textbf{@Lena}}}

% to mark new stuff
\newcommand{\new}{\todo[color=orange!80,size=\scriptsize,fancyline,author=new]{}\xspace}


%%%%    CLASSICAL SL     %%%%
\newcommand{\qslemb}[1]{\ensuremath{\mathtt{qsl}\llbracket #1 \rrbracket}}
\newcommand{\SLemp}{\sfsymbol{\textbf{emp}}}
\newcommand{\SLsingleton}[2]{#1 \mapsto #2}
\newcommand{\SLvalidpointer}[1]{#1 \mapsto \,{-}\,}
\newcommand{\SLwp}[2]{\underline{\wp{#1}{#2}}}

%%%%    LOGICS    %%%%
\newcommand{\Sup}{\reflectbox{\textnormal{\textsf{\fontfamily{phv}\selectfont S}}}\hspace{.2ex}}
\newcommand{\Inf}{\raisebox{.6\depth}{\rotatebox{-30}{\textnormal{\textsf{\fontfamily{phv}\selectfont \reflectbox{J}}}}\hspace{-.1ex}}}
\newcommand{\InfCaption}{\raisebox{1pt}{\rotatebox{-30}{\textnormal{\textsf{\fontfamily{phv}\selectfont \reflectbox{J}}}}\hspace{-.1ex}}}
\newcommand{\Quant}{\reflectbox{\textnormal{\textsf{\fontfamily{phv}\selectfont Q}}}\hspace{.2ex}}
\newcommand{\SupV}[1]{\Sup #1\colon}
\newcommand{\InfV}[1]{\Inf #1\colon}
\newcommand{\InfVCaption}[1]{\InfCaption #1\colon}

\newcommand{\interpret}{\ensuremath{\mathfrak{I}}\xspace}
\newcommand{\pstate}{\ensuremath{\sigma}\xspace}
\newcommand{\states}{\ensuremath{\text{States}}\xspace}

\newcommand{\mforall}{\forall \hspace{.2ex}}
\newcommand{\mexists}{\exists \hspace{.2ex}}

\newcommand{\relPrime}[2]{#1 \bot #2}



\newcommand{\emp}{\iverson{\sfsymbol{\textbf{emp}}}}
\newcommand{\notemp}{\iverson{\neg \sfsymbol{\textbf{emp}}}}
\newcommand{\singleton}[2]{\iverson{#1 \mapsto #2}}
\newcommand{\containsPointer}[2]{\iverson{#1 \hookrightarrow #2}}
\newcommand{\validpointer}[1]{\iverson{#1 \mapsto \,{-}\,}}
\newcommand{\heapSize}{\sfsymbol{\textbf{size}}}
\newcommand{\sepcon}{\mathbin{{\star}}}
\newcommand{\sepadd}{\mathbin{{\oplus}}}
\newcommand{\sepminus}{\mathbin{{\ominus}}}
\newcommand{\sepmax}[2]{\underline{{\max}}\left( #1,#2 \right)}
\newcommand{\sepimp}{\mathbin{\text{\raisebox{-0.1ex}{$\boldsymbol{{-}\hspace{-.55ex}{-}}$}}\hspace{-1ex}\text{\raisebox{0.13ex}{\rotatebox{-17}{$\star$}}}}}
\newcommand{\nil}{0}
\newcommand{\nt}[1]{\textit{numtree}\left(#1\right)}

\newcommand{\bigsepcon}[1]{\ensuremath{\underset{#1}{\bigstar}}}
\newcommand{\bbigsepcon}[2]{\ensuremath{\overset{#2}{\underset{#1}{\bigstar}}}}

%%% CLASSICAL PRE/POST %%% % instead defines b/c
% \newcommand{\pre}{\mathit{Pre}}
% \newcommand{\post}{\mathit{Post}}

%%%% Syntax for Expectations %%%%
\newcommand{\TT}{\ensuremath{t}\xspace}
\newcommand{\BB}{\ensuremath{b}\xspace}
\newcommand{\FF}{\ensuremath{f}\xspace}
\newcommand{\FG}{\ensuremath{g}\xspace}
\newcommand{\FH}{\ensuremath{h}\xspace}
\newcommand{\RR}{\ensuremath{r}\xspace}
\newcommand{\XX}{\ensuremath{x}\xspace}
\newcommand{\VV}{\ensuremath{v}\xspace}
\newcommand{\VVcut}{\VV_{\sfsymbol{Cut}}}
\newcommand{\VVcutnum}[1]{\VV_{\sfsymbol{Cut}_{#1}}}
\newcommand{\toExp}[1]{\iverson{#1}}
\newcommand{\varSymb}{\mathit{var}}

\newcommand{\expressexpsymbol}{\cong}
\newcommand{\expressexp}[2]{#1 \cong #2}

%%% Syntax for First order Arithmetic
\newcommand{\PP}{\ensuremath{P}\xspace}
\newcommand{\isNat}{\ensuremath{N}\xspace}




%%%%    TODONOTES    %%%%
\newcommand{\todoin}[1]{\todo[inline]{#1}}

\newcommand{\QSL}{\sfsymbol{QSL}\xspace}
\newcommand{\SL}{\sfsymbol{SL}\xspace}


%%%%    SYMBOLS    %%%%
\newcommand{\cmark}{{\large\ding{51}}}
\newcommand{\xmark}{}%{\scriptsize\ding{55}}}
\newcommand{\qedtriangle}{\hfill\raisebox{-.15ex}{\rotatebox{90}{$\triangle$}}}




%%%%    WP-STYLE TRANSFORMERS    %%%%
\newcommand{\incorrectness}[3]{\left[ \,{#1}\vphantom{#3}\, \right] \mathrel{#2} \left[ \, {#3}\vphantom{#1} \, \right]}
\newcommand{\hoare}[3]{\left\langle \,{#1}\vphantom{#3}\, \right\rangle \mathrel{#2} \left\langle \, {#3}\vphantom{#1} \, \right\rangle}
\newcommand{\partialhoare}[3]{\left\langle \,{#1}\vphantom{#3}\, \right\rangle \mathrel{\widetilde{#2}} \left\langle \, {#3}\vphantom{#1} \, \right\rangle}

\newcommand{\sfsymbol}[1]{\textsf{\upshape {#1}}}
\newcommand{\boldsfsymbol}[1]{\textbf{\textsf{\upshape {#1}}}}
\newcommand{\ttsymbol}[1]{\texttt{\upshape {#1}}}
%\newcommand{\Assert}[1]{\ensuremath{{}\hspace*{-.5ex}{\fatslash}\hspace*{-.5ex}{\fatslash}\hspace*{1ex} \text{\footnotesize $\displaystyle #1$} }}
\newcommand{\Assert}[1]{\ensuremath{\text{\footnotesize ~\texttt{//}~$\displaystyle #1$} }}

% general transformer
\newcommand{\transformersymbol}{\mathcal{T}}
\newcommand{\boldtransformersymbol}{\boldsymbol{\transformersymbol}}
\newcommand{\transformer}[2]{\transformersymbol \, \left\llbracket {#1} \right\rrbracket \, ( {#2} )}
\newcommand{\transformerC}[1]{\transformersymbol \, \left\llbracket {#1} \right\rrbracket}

% weakest preexpectation
\newcommand{\wpsymbol}{\sfsymbol{wp}}
\newcommand{\boldwpsymbol}{\textbf{\sfsymbol{wp}}}
\renewcommand{\wp}[2]{\wpsymbol\,\llbracket#1\rrbracket(#2)}
\newcommand{\boldwp}[2]{\boldwpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\extwp}[2]{\Ext{\wpsymbol}\llbracket#1\rrbracket(#2)}
\newcommand{\wpC}[1]{\wpsymbol\llbracket#1\rrbracket}


% \newcommand{\boldawpsymbol}{\textbf{\sfsymbol{awp}}}
% \newcommand{\bolddwpsymbol}{\textbf{\sfsymbol{dwp}}}
% \newcommand{\boldawlpsymbol}{\textbf{\sfsymbol{awlp}}}
% \newcommand{\bolddwlpsymbol}{\textbf{\sfsymbol{dwlp}}}
\newcommand{\boldawp}[2]{\boldawpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\bolddwp}[2]{\bolddwpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\boldawlp}[2]{\boldawlpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
%\newcommand{\bolddwlp}[2]{\bolddwlpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}


% Dijkstra-wp
\newcommand{\wpsymbolD}{\sfsymbol{wp}}
\newcommand{\wpD}[2]{\wpsymbolD\,\llbracket#1\rrbracket(#2)}
\newcommand{\wlpsymbolD}{\sfsymbol{wlp}}
\newcommand{\wlpD}[2]{\wlpsymbolD\,\llbracket#1\rrbracket(#2)}
% Kaminski-wp
\newcommand{\wpsymbolK}{\sfsymbol{wp}_k}
\newcommand{\wpK}[2]{\wpsymbolK\,\llbracket#1\rrbracket(#2)}
\newcommand{\wlpsymbolK}{\sfsymbol{wlp_k}}
\newcommand{\wlpK}[2]{\wlpsymbolK\,\llbracket#1\rrbracket(#2)}
% Dijkstra-sp
\newcommand{\spsymbolD}{\sfsymbol{sp}}
\newcommand{\stpsymbolD}{\sfsymbol{stp}}
\newcommand{\spD}[2]{\spsymbolD\,\llbracket#1\rrbracket(#2)}
\newcommand{\stpD}[2]{\stpsymbolD\,\llbracket#1\rrbracket(#2)}

% strongest postexpectation
\newcommand{\spsymbol}{\sfsymbol{sp}}
\newcommand{\boldspsymbol}{\textbf{\sfsymbol{sp}}}
\renewcommand{\sp}[2]{\spsymbol\,\llbracket#1\rrbracket(#2)}
\newcommand{\boldsp}[2]{\boldspsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\spC}[1]{\spsymbol\llbracket#1\rrbracket}


%\newcommand{\boldasp}[2]{\boldaspsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
%\newcommand{\bolddslp}[2]{\bolddslpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}

% angelic strongest postexpectation
\newcommand{\aspsymbol}{\sfsymbol{asp}}
\newcommand{\boldaspsymbol}{\textbf{\sfsymbol{asp}}}
\newcommand{\asp}[2]{\aspsymbol\,\llbracket#1\rrbracket(#2)}
\newcommand{\boldasp}[2]{\boldaspsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\aspC}[1]{\aspsymbol\llbracket#1\rrbracket}

% demonic strongest postexpectation
\newcommand{\dspsymbol}{\sfsymbol{dsp}}
\newcommand{\bolddspsymbol}{\textbf{\sfsymbol{dsp}}}
\newcommand{\dsp}[2]{\dspsymbol\,\llbracket#1\rrbracket(#2)}
\newcommand{\bolddsp}[2]{\bolddspsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\dspC}[1]{\dspsymbol\llbracket#1\rrbracket}

% other transformers

% strongest liberal postexpectation
\newcommand{\boldslp}[2]{\boldslpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\slpsymbol}{\sfsymbol{slp}}
\newcommand{\boldslpsymbol}{\textbf{\sfsymbol{slp}}}
\newcommand{\slp}[2]{\slpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\slpC}[1]{\slpsymbol\llbracket#1\rrbracket}

% angelic strongest liberal postexpectation
\newcommand{\boldaslp}[2]{\boldaslpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\aslpsymbol}{\sfsymbol{aslp}}
\newcommand{\boldaslpsymbol}{\textbf{\sfsymbol{aslp}}}
\newcommand{\aslp}[2]{\aslpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\aslpC}[1]{\aslpsymbol\llbracket#1\rrbracket}

% demonic strongest liberal postexpectation
\newcommand{\bolddslp}[2]{\bolddslpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\dslpsymbol}{\sfsymbol{dslp}}
\newcommand{\bolddslpsymbol}{\textbf{\sfsymbol{dslp}}}
\newcommand{\dslp}[2]{\dslpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\dslpC}[1]{\dslpsymbol\llbracket#1\rrbracket}


% segfault probability
\newcommand{\segprobsymbol}{\sfsymbol{segprob}}
\newcommand{\boldsegprobsymbol}{\textbf{\sfsymbol{segprob}}}
\newcommand{\segprob}[2]{\segprobsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\segprobC}[1]{\segprobsymbol\llbracket#1\rrbracket}


% angelic weakest preexpectation
\newcommand{\awpsymbol}{\sfsymbol{awp}}
\newcommand{\boldawpsymbol}{\textbf{\sfsymbol{awp}}}
\newcommand{\awp}[2]{\awpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\awpC}[1]{\awpsymbol\llbracket#1\rrbracket}

% demonic weakest preexpectation
\newcommand{\dwpsymbol}{\sfsymbol{dwp}}
\newcommand{\bolddwpsymbol}{\textbf{\sfsymbol{dwp}}}
\newcommand{\dwp}[2]{\dwpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\dwpC}[1]{\dwpsymbol\llbracket#1\rrbracket}

% weakest liberal preexpectation
\newcommand{\boldwlp}[2]{\boldwlpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\wlpsymbol}{\sfsymbol{wlp}}
\newcommand{\boldwlpsymbol}{\textbf{\sfsymbol{wlp}}}
\newcommand{\wlp}[2]{\wlpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\wlpC}[1]{\wlpsymbol\llbracket#1\rrbracket}

% demonic weakest liberal preexpectation
\newcommand{\bolddwlp}[2]{\bolddwlpsymbol\,\boldsymbol{\llbracket#1\rrbracket(#2)}}
\newcommand{\dwlpsymbol}{\sfsymbol{dwlp}}
\newcommand{\bolddwlpsymbol}{\textbf{\sfsymbol{dwlp}}}
\newcommand{\dwlp}[2]{\dwlpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\dwlpC}[1]{\dwlpsymbol\llbracket#1\rrbracket}

% weakest extrinsic memory safe preexpectation
\newcommand{\esepcon}{\mathbin{{\bullet}}}
\newcommand{\esepimp}{\mathbin{\text{\raisebox{-0.1ex}{$\boldsymbol{{-}\hspace{-.55ex}{-}}$}}\hspace{-1ex}\text{\raisebox{0.13ex}{\rotatebox{-17}{$\bullet$}}}}}
\newcommand{\wepsymbol}{\sfsymbol{wep}}
\newcommand{\boldwepsymbol}{\textbf{\sfsymbol{wep}}}
\newcommand{\wep}[2]{\wepsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\wepC}[1]{\wepsymbo\llbracket#1\rrbracket}

% angelic weakest liberal preexpectation
\newcommand{\awlpsymbol}{\sfsymbol{awlp}}
\newcommand{\boldawlpsymbol}{\textbf{\sfsymbol{awlp}}}
\newcommand{\awlp}[2]{\awlpsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\awlpC}[1]{\awlpsymbol\llbracket#1\rrbracket}

% angelic weakest extrinsic memory safe preexpectation
\newcommand{\awepsymbol}{\sfsymbol{awep}}
\newcommand{\boldawepsymbol}{\textbf{\sfsymbol{awep}}}
\newcommand{\awep}[2]{\awepsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\awepC}[1]{\awepsymbol\llbracket#1\rrbracket}

% angelic weakest liberal extrinsic memory safe preexpectation
\newcommand{\awlepsymbol}{\sfsymbol{awlep}}
\newcommand{\boldawlepsymbol}{\textbf{\sfsymbol{awlep}}}
\newcommand{\awlep}[2]{\awlepsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\awlepC}[1]{\awlepsymbol\llbracket#1\rrbracket}

% weakest liberal extrinsic memory safe preexpectation
\newcommand{\wlepsymbol}{\sfsymbol{wlep}}
\newcommand{\boldwlepsymbol}{\textbf{\sfsymbol{wlep}}}
\newcommand{\wlep}[2]{\wlepsymbol\llbracket#1\rrbracket(#2)}
\newcommand{\wlepC}[1]{\wlepsymbol\llbracket#1\rrbracket}

% conditional weakest preexpectation
\newcommand{\cwpsymbol}{\sfsymbol{cwp}}
\newcommand{\conditionalPair}[2]{{\let\oldarraystretch\arraystretch}\renewcommand{\arraystretch}{1}~\holter{~\raisebox{.5ex}{${#1}$}~}{~\raisebox{.125ex}{${#2}$}~}~\renewcommand{\arraystretch}{\oldarraystretch}}
\newcommand{\boldcwpsymbol}{\textbf{\sfsymbol{cwp}}}
\newcommand{\cwp}[3]{\cwpsymbol \, \left\llbracket {#1} \right\rrbracket \, ( \conditionalPair{#2}{#3} )}
\newcommand{\cwpC}[2]{\cwpsymbol \, \left\llbracket {#1} \right\rrbracket \, ( {#2} )}

% Calculus %
\newcommand{\annotate}[1]{\boldsymbol{\annocolor{\!\fatslash\!\!\!\fatslash~~\vphantom{G'} {#1}}}}

\newcommand{\sndannotate}[1]{\boldsymbol{\annocolor{\hspace{3em} {#1}}}}

\newcommand{\starannotate}[1]{{\annocolor{{\talloblong}\!{\talloblong}\:\vphantom{G'} {#1}}}}
\newcommand{\phiannotate}[1]{{\annocolor{\!\!\hspace{-.15ex}{}^{\annocolor{\Phi}}\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {#1}}}}

\newcommand{\bowtieannotate}[1]{\annocolor{\!\!\hspace{-.5ex}{}^{\annocolor{{\bowtie}}}{\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {#1}}}}

\newcommand{\preceqannotate}[1]{\annocolor{\!\!\hspace{-.25ex}{}^{\annocolor{{\preceq}}}{\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {\boldsymbol{#1}}}}}

\newcommand{\succeqannotate}[1]{\annocolor{\!\!\hspace{-.25ex}{}^{\annocolor{{\succeq}}}{\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {#1}}}}

\newcommand{\eqannotate}[1]{\annocolor{\!\!\hspace{.55ex}{}^{\annocolor{{=}}}{\!\!\!{\fatslash}\!\!{\fatslash}~~\hspace{.5ex}\vphantom{G'} {\boldsymbol{#1}}}}}

\newcommand{\wpannotate}[1]{{\annocolor{\!\!\hspace{-0.75ex}{}^{\annocolor{\text{\tiny $\wpsymbol$}}}\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {#1}}}}

\newcommand{\wlpannotate}[1]{{\annocolor{\!\!\hspace{-0.75ex}{}^{\annocolor{\text{\tiny $\wlpsymbol$}}}\!\!\!{\fatslash}\!\!{\fatslash}~~\vphantom{G'} {#1}}}}
%%%%    Constants    %%%%%%%
\newcommand{\cc}{\ensuremath{c}} % programs
\newcommand{\guard}{\ensuremath{\guardb}} % conditial guard
\newcommand{\guarda}{\ensuremath{a}} % conditial guard
\newcommand{\guardb}{\ensuremath{b}} % conditial guard
\newcommand{\guardc}{\ensuremath{c}} % conditial guard
\newcommand{\iguard}{\ensuremath{\iverson{\guard}}} % iversoned conditial guard
\newcommand{\inguard}{\ensuremath{\iverson{\neg\guard}}} % iversoned conditial guard
\newcommand{\ee}{\ensuremath{e}} % expressions

\newcommand{\preda}{\ensuremath{\varphi}} % predicates
\newcommand{\predb}{\ensuremath{\psi}} 
\newcommand{\predc}{\ensuremath{\vartheta}} 
\newcommand{\predd}{\ensuremath{\xi}} 

\newcommand{\hh}{\ensuremath{h}} % heap
\newcommand{\sk}{\ensuremath{s}} % stack 

\newcommand{\pp}{\ensuremath{p}} % probabilities
\newcommand{\qq}{\ensuremath{q}} % probabilities

\newcommand{\ff}{\ensuremath{X}} % expectations
\newcommand{\fg}{\ensuremath{Y}}
\newcommand{\fh}{\ensuremath{Z}}
\newcommand{\fk}{\ensuremath{R}}
\newcommand{\inv}{\ensuremath{I}} % invariants

\newcommand{\oa}{\ensuremath{\alpha}} % ordinals
\newcommand{\ob}{\ensuremath{\beta}} 
\newcommand{\oc}{\ensuremath{\delta}} 

\newcommand{\za}{\ensuremath{\alpha}} % quantified variables
\newcommand{\zb}{\ensuremath{\beta}}
\newcommand{\zc}{\ensuremath{\gamma}} 
\newcommand{\zd}{\ensuremath{\delta}} 




%%%%    PGCL PROGRAMS    %%%%
\newcommand{\SKIP}{\ttsymbol{skip}}
\newcommand{\EMPTY}{\ensuremath{\textnormal{\texttt{empty}}}}
\newcommand{\HALT}{\ensuremath{\textnormal{\texttt{halt}}}}
\newcommand{\ABORT}{\ensuremath{\textnormal{\texttt{abort}}}}
\newcommand{\DIVERGE}{\ensuremath{\textnormal{\texttt{diverge}}}}

\newcommand{\OBSERVE}[1]{\ensuremath{\textnormal{\texttt{observe}} ~ {#1}}}
\newcommand{\ASSUME}[1]{\ensuremath{\textnormal{\texttt{assume}} ~ {#1}}}
\newcommand{\ASSERT}[1]{\ensuremath{\textnormal{\texttt{assert}} ~ {#1}}}
%\newcommand{\CALL}[1]{\ensuremath{\textnormal{\texttt{call}} ~ {#1}}}

\newcommand{\AssignSymbol}{\coloneqq}
\newcommand{\ASSIGN}[2]{\ensuremath{#1 \AssignSymbol #2}}
\newcommand{\ASSIGNNONDET}[1]{\ensuremath{#1 \AssignSymbol \textnormal{\texttt{nondet()}}}}
\newcommand{\UNIFORM}[2]{\ensuremath{\mathtt{uniform}\left(#1,#2\right)}}
\newcommand{\ASSIGNUNIFORM}[3]{\ensuremath{#1 \AssignSymbol \UNIFORM{#2}{#3}}}
\newcommand{\ALLOC}[2]{\ensuremath{{#1} \AssignSymbol \mathtt{new}\left( #2 \right)}}

\newcommand{\AVAILLOC}[1]{\PosNats}
%\newcommand{\AVAILLOC}[1]{\ensuremath{\mathrm{loc}(#1)}}

%\newcommand{\dereference}[1]{\overline{#1}}
%\newcommand{\dereference}[1]{{}^*\!{#1}}
\usepackage{actuarialangle}

%\newcommand{\dereference}[1]{\texttt{<}\,#1\,\texttt{>}}
%\newcommand{\dereference}[1]{\angl{\,#1\,}}
\newcommand{\dereference}[1]{\left( #1 \right)^{\texttt{*}}}

\newcommand{\LOOKUP}[2]{\ensuremath{#1 \AssignSymbol \dereference{#2}}}
\newcommand{\MUTATE}[2]{\ensuremath{\dereference{#1} \AssignSymbol #2}}
\newcommand{\FREE}[1]{\ensuremath{\mathtt{free}(#1)}}

\newcommand{\AppAssignSymbol}{\mathrel{\textnormal{\texttt{:}}\hspace{-.1em}{\approx}}}
\newcommand{\PASSIGN}[2]{\ensuremath{#1 \AppAssignSymbol\hspace{.1em} #2}}

\newcommand{\SEMI}{\ensuremath{\,;\,}}
%\newcommand{\SEMI}{\ensuremath{\,\fatsemi\,}}
\newcommand{\COMPOSE}[2]{\ensuremath{{#1}{\,\fatsemi}~ {#2}}}
%\newcommand{\COMPOSE}[2]{\ensuremath{{#1}{\,;}~ {#2}}}
\newcommand{\PCHOICE}[3]{\ensuremath{\left\{\, {#1} \,\right\}\mathrel{\left[\,#2\,\right]}\left\{\, {#3} \,\right\}}}
\newcommand{\NDCHOICE}[2]{\ensuremath{\left\{\, {#1} \,\right\}\mathrel{\Box}\left\{\, {#2} \,\right\}}}
\newcommand{\NDBRACK}{\ensuremath{\left.\right\}\mathrel{\Box}\left\{\right.}}


\newcommand{\IFSYMBOL}{\ensuremath{\textnormal{\texttt{if}}}}
\newcommand{\IF}[1]{\ensuremath{\IFSYMBOL\,\left(\, {#1} \,\right)\,\{}}
\newcommand{\ELSESYMBOL}{\ensuremath{\textnormal{\texttt{else}}}}
\newcommand{\ELSE}{\ensuremath{\}\,\ELSESYMBOL\,\{}}
\newcommand{\ITE}[3]{\ensuremath{\IFSYMBOL\,\left(\, {#1} \,\right)\,\left\{\, {#2} \,\right\}\,\ELSESYMBOL\,\left\{\, {#3} \,\right\}}}

\newcommand{\WHILESYMBOL}{\ensuremath{\textnormal{\texttt{while}}}}
\newcommand{\WHILE}[1]{\ensuremath{\WHILESYMBOL \left(\, {#1} \,\right)\left\{\right.}}

\newcommand{\WHILEDO}[2]{\ensuremath{\WHILESYMBOL \left(\, {#1} \,\right)\left\{\, {#2} \,\right\}}}


%\newcommand{\BOUNDEDWHILE}[3]{\ensuremath{\WHILE^{<{#1}}\:(#2)\:\{#3\}}}




%%%%    SETS    %%%%
%\newcommand{\terms}{\textnormal{\sfsymbol{Terms}}\xspace}
\newcommand{\booleans}{\textnormal{\sfsymbol{Bools}}\xspace}

\newcommand{\gcl}{\textnormal{\sfsymbol{GCL}}\xspace}   % Programs
\newcommand{\pgcl}{\textnormal{\sfsymbol{pGCL}}\xspace}   % Programs
%\newcommand{\hgcl}{\textnormal{\sfsymbol{hGCL}}\xspace}   % Programs
\newcommand{\ngcl}{\textnormal{\sfsymbol{nGCL}}\xspace}   % Programs
\newcommand{\hngcl}{\textnormal{\sfsymbol{hnGCL}}\xspace}   % Programs
\newcommand{\hpgcl}{\textnormal{\sfsymbol{hpGCL}}\xspace}   % Programs
\newcommand{\boldhpgcl}{\textnormal{\textbf{\sfsymbol{hpGCL}}}\xspace}   % Programs
\newcommand{\cpgcl}{\textnormal{\textbf{\sfsymbol{cpGCL}}}\xspace}   % Programs
\newcommand{\boldgcl}{\textnormal{\textbf{\sfsymbol{GCL}}}\xspace}   % Programs
\newcommand{\boldpgcl}{\textnormal{\textbf{\sfsymbol{pGCL}}}\xspace}   % Programs
\newcommand{\boldcpgcl}{\textnormal{\textbf{\sfsymbol{cpGCL}}}\xspace}   % Programs
\newcommand{\Vars}{\ensuremath{\mathsf{Vars}}\xspace}   % Variables
\newcommand{\LVars}{\ensuremath{\mathsf{L\hspace{-.2ex}Vars}}\xspace}   % Variables
\newcommand{\Terms}{\ensuremath{\mathsf{Terms}}\xspace}   % Terms
\newcommand{\Bools}{\ensuremath{\mathsf{Bool}}\xspace}   % Boolean expressions
\newcommand{\Vals}{\ensuremath{\mathsf{Vals}}\xspace}    % Values
\newcommand{\EVars}{\ensuremath{\mathsf{E}}_{\Vars}\xspace}
\newcommand{\Pred}{\ensuremath{\textsf{Pred}}} % Predicates

\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\Nats}{\ensuremath{\mathbb{N}}\xspace}
\newcommand{\PosNats}{\ensuremath{\mathbb{N}_{>0}}\xspace}
\newcommand{\Ints}{\ensuremath{\mathbb{Z}}\xspace}
\newcommand{\Rats}{\ensuremath{\mathbb{Q}}\xspace}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\PosReals}{\mathbb{R}_{\geq 0}}
\newcommand{\PosRats}{\mathbb{Q}_{\geq 0}}
\newcommand{\PosRealsInf}{\mathbb{R}_{\geq 0}^\infty}
\newcommand{\minfty}{{-}\infty}
\newcommand{\pinfty}{{+}\infty}
\newcommand{\Rinf}{\ensuremath{\R^{{\pm}\infty}}}

\newcommand{\Preds}{\pot{\States}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\A}{\mathbb{A}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\SyntE}{\ensuremath{\mathsf{Exp}}\xspace}
\newcommand{\Ebounded}{\mathbb{E}_{\leq b}}
\newcommand{\Eone}{\mathbb{E}_{\leq 1}}
\newcommand{\Universe}{\mathfrak{U}}
\newcommand{\FOArith}[1]{\mathbb{A} \left[ #1 \right]}
\newcommand{\FOArithPosRats}{\FOArith{\PosRats}}
\newcommand{\FOArithNats}{\FOArith{\Nats}}


\newcommand{\exprod}{{}\odot{}}

\newcommand{\natExp}[1]{\iverson{#1 \in \Nats}}

\newcommand{\dist}[1]{\ensuremath{\mathsf{Dist}\left(#1\right)} \xspace}

\newcommand{\Mod}[1]{\ensuremath{\textit{Mod}\left(#1\right)}}

\newcommand{\FV}[1]{\ensuremath{\textsf{FV}\left(#1\right)}}

\newcommand{\DExprs}{\ensuremath{\mathsf{PGuards}}\xspace}    % Distribution Expression
\newcommand{\Dists}[1]{\ensuremath{\mathcal{D}\left({#1}\right)}}

\newcommand{\Permutations}{\ensuremath{\Pi}}
\newcommand{\FinPermutations}[1]{\ensuremath{\Pi_{#1}}}
%
%
%\newcommand{\exProgs}{\textnormal{\sfsymbol{exProgs}}}
%\newcommand{\appProgs}{\Stmt}
%\newcommand{\BDists}{\textnormal{\sfsymbol{BDists}}}
%\newcommand{\E}{\ensuremath{\mathbb{E}_{\geq 0}^{{\infty}}}}
%\newcommand{\Epm}{\ensuremath{\mathbb{E}^{{\star}}}}
%\newcommand{\Pairs}{\ensuremath{\mathbb{P}}}
%\newcommand{\EqPairs}{\ensuremath{\mathbb{I\hspace{-.1ex}E}}}
%\newcommand{\EE}{\ensuremath{\mathbb{E}}}
%\newcommand{\Eefin}{\ensuremath{\E^*}}
%\newcommand{\States}{\ensuremath{\Sigma}}
%\newcommand{\R}{\ensuremath{\mathbb{R}}}
%\newcommand{\Rpos}{\ensuremath{\R_{{}\geq 0}}}
%\newcommand{\Rposinf}{\ensuremath{\Rpos^{\infty}}}
%\newcommand{\Rpminf}{\ensuremath{\R^{\infty}}}
%\newcommand{\Rinf}{\ensuremath{\R^{{\pm}\infty}}}
%\newcommand{\bigO}{\ensuremath{\mathcal{O}}}
%\newcommand{\littleO}{\ensuremath{o}}
%\newcommand{\Ints}{\ensuremath{\mathbb Z}\xspace}
%\newcommand{\Nats}{\ensuremath{\mathbb N}\xspace}
%\newcommand{\Rationals}{\ensuremath{\mathbb Q}\xspace}
%\newcommand{\PReals}{\ensuremath{\mathbb R_{\geq 0}}\xspace}
%\newcommand{\Bool}{\ensuremath{\mathsf{Bool}}\xspace}
%\newcommand{\ZO}{[0,\,\! 1]}                             % real interval [0,1]




%%%%    Functions    %%%%

\newcommand{\prenex}[1]{\sfsymbol{Prenex}\left( #1 \right)}

\newcommand{\toFOPosRats}[1]{#1 \left[ \PosRats \right]}


\newcommand{\dom}[1]{\sfsymbol{dom}\left({#1}\right)}
\newcommand{\iverson}[1]{\left[ {#1} \right]}
\newcommand{\spiverson}[1]{\left[ {#1} \right]_{\minfty}^{1}}
\newcommand{\wlpiverson}[1]{\left[ {#1} \right]_{\pinfty}^{1}}
\newcommand{\slpiverson}[1]{\left[ {#1} \right]_{\pinfty}^{1}}
\newcommand{\wpiverson}[1]{\left[ {#1} \right]_{\minfty}^{1}}
\newcommand{\indicator}[1]{\left[ {#1} \right]}
\newcommand{\bigiverson}[1]{\vphantom{\big(}\iverson{#1}\vphantom{\big)}}
\newcommand{\Min}[2]{\min\left\{\,{#1},\: {#2}\,\right\}}
\newcommand{\Max}[2]{\max\left\{\,{#1},\: {#2}\,\right\}}
%\newcommand{\Exp}[2]{\sfsymbol{Exp}_{#1}\left( {#2} \right)}
\newcommand{\Exp}[2]{\int_\States \; {#2} \; d \,{#1} }
%\newcommand{\Exp}[2]{\int_\States {#2} \: d {#1} }

\newcommand{\subst}[2]{\left[ {#1} \middle/ {#2}\right]}
\newcommand{\statesubst}[2]{\left[ {#1} \mapsto {#2}\right]}
\newcommand{\multstatesubst}[1]{\left[ #1\right]}

%\newcommand{\charfun}[4]{\tensor*[^{#2}_{{#1}{#3}}]{\Phi}{_{{#4}}}}
\newcommand{\charfun}[4]{\tensor*[^{#1}_{{\langle #2, #3 \rangle}}]{\Phi}{_{{#4}}}}
\newcommand{\charfunn}[5]{\tensor*[^{#1}_{{\langle #2, #3 \rangle}}]{\Phi}{_{{#4}}^{{#5}}}}
%\newcommand{\charwp}[3]{\charfun{\wpsymbol}{#1}{#2}{#3}}
\newcommand{\charwpsym}{\Phi}
\newcommand{\charwp}[3]{\charwpsym\llbracket#1,#2,#3\rrbracket} %\charfun{\wpsymbol}{#1}{#2}{#3}}
\newcommand{\charwpn}[4]{\charwpsym^{#4}\llbracket#1,#2,#3\rrbracket} %\charfun{\wpsymbol}{#1}{#2}{#3}}
\newcommand{\charwlp}[3]{\charfun{\wlpsymbol}{#1}{#2}{#3}}
\newcommand{\charawp}[3]{\charfunn{\awpsymbol}{#1}{#2}{#3}}
%\newcommand{\charwpn}[4]{\charfunn{\wpsymbol}{#1}{#2}{#3}{#4}}
\newcommand{\charwlpn}[4]{\charfunn{\wlpsymbol}{#1}{#2}{#3}{#4}}
\newcommand{\charawpn}[4]{\charfunn{\awpsymbol}{#1}{#2}{#3}{#4}}



\newcommand{\eval}[1]{\ensuremath{\llbracket {#1} \rrbracket}}
\newcommand{\evalDiv}[1]{\ensuremath{\eval{#1}_{\bot}}}
\newcommand{\evalInv}[1]{\ensuremath{\eval{#1}^{-1}}}
\newcommand{\sem}[2]{\ensuremath{\llbracket {#1} \rrbracket}(#2)}
\newcommand{\semDiv}[2]{\ensuremath{\llbracket {#1} \rrbracket}_{\bot}(#2)}
\newcommand{\semTinv}[2]{\ensuremath{\llbracket {#1} \rrbracket}_\Term^{{-}1}(#2)}
\newcommand{\semT}[2]{\ensuremath{\llbracket {#1} \rrbracket}_\Term(#2)}
\newcommand{\seminv}[2]{\ensuremath{\llbracket {#1} \rrbracket}^{{-}1}(#2)}
\newcommand{\probof}[2]{\ensuremath{\llbracket {#1} \colon {#2} \rrbracket}}
\newcommand{\pot}[1]{\mathcal{P}\left({#1}\right)}

\newcommand{\restrictFunc}[2]{\left.#1\right\rceil_{#2}}




%%%% Standards %%%%

\newcommand{\Stacks}{\mathcal{S}}
\newcommand{\Heaps}{\mathcal{H}}
\newcommand{\emptyheap}{h_\emptyset}
\newcommand{\disjoint}{\mathrel{\bot}}
\newcommand{\States}{\Sigma}
\newcommand{\To}{\rightarrow}
\newcommand{\true}{\mathsf{true}}
\newcommand{\false}{\mathsf{false}}
\newcommand{\mydot}{\text{{\Large\textbf{.}}~}\xspace}
\newcommand{\mylambda}[1]{\lambda\, #1\mydot}
\newcommand{\dead}{\mathsf{dead}}
\newcommand{\spill}{\mathsf{spill}}
\newcommand{\open}{\mathsf{open}}

\newcommand{\varseq}[1]{\ensuremath{\mathbf{#1}}\xspace}
\newcommand{\equivstatesrel}[1]{\sim_{#1}}
\newcommand{\equivclass}[2]{\ensuremath{\left[ #1 \right]_{\equivstatesrel{#2}}}\xspace}
\newcommand{\equivstates}[3]{#1 \equivstatesrel{#2} #3}
\newcommand{\partitionedstates}[1]{\States_{\varseq{#1}} }
\newcommand{\statepred}[2]{\iverson{#1}_{#2}}


%%%%    Shortcuts    %%%%

% \newcommand{\negate}[1]{\overline{#1}}

\newcommand*\oline[1]{%
  \vbox{%
    \hrule height 0.3pt%                  % Line above with certain width
    \kern0.25ex%                          % Distance between line and content
    \hbox{%
      \kern0.04em%                        % Distance between content and left side of box, negative values for lines shorter than content
      \ifmmode#1\else\ensuremath{#1}\fi%  % The content, typeset in dependence of mode
      \kern0.04em%                        % Distance between content and left side of box, negative values for lines shorter than content
    }% end of hbox
  }% end of vbox
}

% more space for double negations
\newcommand*\olinedbl[1]{%
  \vbox{%
    \hrule height 0.6pt%                  % Line above with certain width
    \kern0.25ex%                          % Distance between line and content
    \hbox{%
      \kern0.04em%                        % Distance between content and left side of box, negative values for lines shorter than content
      \ifmmode#1\else\ensuremath{#1}\fi%  % The content, typeset in dependence of mode
      \kern0.04em%                        % Distance between content and left side of box, negative values for lines shorter than content
    }% end of hbox
  }% end of vbox
}

\newcommand{\negate}[1]{\oline{#1}}	
\newcommand{\negatedbl}[1]{\olinedbl{#1}}	

% vertical space cheat
\newcommand{\vspaace}{\vphantom{{\LARGE A}}}	


\newcommand{\qiff}{\quad\textnormal{iff}\quad}
\newcommand{\qqiff}{\qquad\textnormal{iff}\qquad}
\newcommand{\lqiff}{\textnormal{iff}\quad}
\newcommand{\lqqiff}{\textnormal{iff}\qquad}

\newcommand{\notiff}{%
  \mathrel{{\ooalign{\hidewidth$\not\phantom{"}$\hidewidth\cr$\iff$}}}}

\newcommand{\cupdot}{\xspace \ensuremath{\dot{\cup}} \xspace}
\newcommand{\lordot}{\xspace \ensuremath{\dot{\lor}} \xspace}

\newcommand{\qand}{\quad\textnormal{and}\quad}
\newcommand{\qqand}{\qquad\textnormal{and}\qquad}

\newcommand{\qor}{\quad\textnormal{or}\quad}
\newcommand{\qqor}{\qquad\textnormal{or}\qquad}
\newcommand{\qqorequiv}{\qqmorespace{\textnormal{or equivalently}}}

\newcommand{\qimplies}{\quad\textnormal{implies}\quad}
\newcommand{\qqimplies}{\qquad\textnormal{implies}\qquad}
\newcommand{\lqimplies}{\textnormal{implies}\quad}
\newcommand{\lqqimplies}{\textnormal{implies}\qquad}

\newcommand{\pprec}{\mathrel{{\prec}\hspace{-.5ex}{\prec}}}
\newcommand{\ppprec}{~{}\pprec{}~}


\newcommand{\morespace}[1]{~{}#1{}~}
\newcommand{\qmorespace}[1]{\quad{}#1{}\quad}
\newcommand{\qqmorespace}[1]{\qquad{}#1{}\qquad}

\newcommand{\ppreceq}{~{}\preceq{}~}
\newcommand{\qpreceq}{\quad{}\preceq{}\quad}
\newcommand{\ssucceq}{~{}\succeq{}~}
\newcommand{\qsucceq}{\quad{}\succeq{}\quad}
\newcommand{\defeq}{~{}\triangleq{}~}
\newcommand{\ddefeq}{~{}\defeq{}~}
\newcommand{\eeq}{~{}={}~}
\newcommand{\ccup}{~{}\cup{}~}
\newcommand{\llor}{~{}\lor{}~}
\newcommand{\lland}{~{}\land{}~}
\newcommand{\eequiv}{~{}\equiv{}~}
\newcommand{\pplus}{~{}+{}~}
\newcommand{\ccdot}{~{}\cdot{}~}
\newcommand{\vvee}{~{}\vee{}~}
\newcommand{\wwedge}{~{}\wedge{}~}
\newcommand{\ccurlyvee}{~{}\curlyvee{}~}
\newcommand{\ccurlywedge}{~{}\curlywedge{}~}
\newcommand{\llongrightarrow}{~{}\longrightarrow{}~}
\newcommand{\qlongrightarrow}{\quad{}\longrightarrow{}\quad}
\newcommand{\qqlongrightarrow}{\qquad{}\longrightarrow{}\qquad}
\newcommand{\mmid}{~{}|{}~}
\newcommand{\qmid}{\quad{}|{}\quad}
\newcommand{\tto}{~{}\to{}~}
\newcommand{\nneq}{~{}\neq{}~}
\newcommand{\qeq}{\quad{}={}\quad}
\newcommand{\qqeq}{\qquad{}={}\qquad}
\newcommand{\lleq}{~{}\leq{}~}
\newcommand{\LL}{~{}<{}~}
\newcommand{\GG}{~{}>{}~}
\newcommand{\ggeq}{~{}\geq{}~}
\newcommand{\ssqsubseteq}{~{}\sqsubseteq{}~}
\newcommand{\iimplies}{~{}\implies{}~}
\newcommand{\mmodels}{~{}\models{}~}
\newcommand{\nnotmodels}{~{}\not\models{}~}
\newcommand{\iin}{~{}\in{}~}
\newcommand{\nnotin}{~{}\not\in{}~}

\newcommand{\cwedge}{\,{}\wedge{}\,}


\newcommand{\setcomp}[2]{\left\{\, {#1} ~\middle|~ {#2} \,\right\}}
\newcommand{\sepconsupcomp}[6]{\sup_{{#3}, {#4}}\left\{\, {#5} (#1, #3) \cdot {#6} (#1, #4) ~\middle|~ {#2} = {#3} \sepcon {#4} \,\right\}} % [#1 : s, #2 : h, #3 : h_1, #4 : h_2, #5 : f, #6 : g]

\newcommand{\doublehrule}{\hrule\vspace{2pt}\hrule}

\newcommand{\firstword}[2]{\lettrine[lines=2,nindent=0em]{\red{#1}}{#2}}
\newcommand{\Firstword}[2]{\lettrine[lines=3,nindent=0em]{\red{#1}}{#2}}
\newcommand{\FIRSTWORD}[2]{\lettrine[lines=4,nindent=0em]{\red{#1}}{#2}}
\newcommand{\firstwordD}[1]{\lettrine[lines=2,nindent=0em]{\red{D}}{#1}}

\definecolor{webgreen}{rgb}{0,.5,0}
\newcommand{\gray}[1]{\textcolor{gray}{#1}}
\newcommand{\lightgray}[1]{\textcolor{lightgray}{#1}}
\newcommand{\black}[1]{\textcolor{black}{#1}}
\newcommand{\green}[1]{\textcolor{webgreen}{#1}}
\newcommand{\red}[1]{\textcolor{rot}{#1}}
\newcommand{\blue}[1]{\textcolor{DodgerBlue3}{#1}}
\newcommand{\orange}[1]{\textcolor{orange}{#1}}
\newcommand{\brown}[1]{\textcolor{webbrown}{#1}}
\newcommand{\darkorchid}[1]{\textcolor{DarkOrchid}{#1}}
%\newcommand{\annocolor}[1]{\textcolor{DarkOrange3}{#1}}
\newcommand{\annocolor}[1]{\textcolor{webgreen}{#1}}
\newcommand{\definize}[1]{\blue{#1}}
\newcommand{\cemph}[1]{\blue{#1}}

\newcommand{\underdot}[1]{%
	\tikz[baseline=(todotted.base)]{
		\node[inner sep=1pt,outer sep=0pt] (todotted) {#1};
		\draw[densely dotted] (todotted.south west) -- (todotted.south east);
	}%
}%
\newcommand{\cloze}[1]{\underdot{\phantom{#1}}}



\newcommand{\nicepar}[1]{\vcenter{\hbox{$\displaystyle #1$}}}






\newcommand{\exprog}[1]{\ensuremath{C_\textnormal{\ref*{#1}}}}

\newcounter{computationarrowsone}
\newcounter{computationarrowstwo}
\newcommand{\tikzcomputationarrow}[4]{%
	\stepcounter{computationarrowsone}
	\stepcounter{computationarrowstwo}
	\draw [decorate,-{Stealth[scale=1]}] (#1,#2) -- (#3,#4);%
	\node (\thecomputationarrowsone) at (#1,#2) {};%
	\fill (\thecomputationarrowsone) + (-.06,0) circle [radius=1.75pt];%
	\node (\thecomputationarrowstwo) at (#3,#4) {};%
	\fill (\thecomputationarrowstwo) + (.06,0) circle [radius=1.75pt];}
	
\newcommand{\tikzboxcomputationarrow}[4]{%
	\stepcounter{computationarrowsone}
	\stepcounter{computationarrowstwo}
	\draw [decorate,-{Stealth[scale=1]}] (#1,#2) -- (#3,#4);%
	\node (\thecomputationarrowsone) at (#1,#2) {};%
	\fill[white] (\thecomputationarrowsone) + (-.06,0) circle [radius=3.1pt] node {\textcolor{black}{\LARGE $\Box$}};%
	
	\node (\thecomputationarrowstwo) at (#3,#4) {};%
	\fill (\thecomputationarrowstwo) + (.06,0) circle [radius=1.75pt];}

\newcommand{\tikzpossiblecomputationarrow}[4]{%
	\stepcounter{computationarrowsone}
	\stepcounter{computationarrowstwo}
	\draw [decorate,-{Stealth[scale=1]},dashdotted] (#1,#2) -- (#3,#4);%
	\node (\thecomputationarrowsone) at (#1,#2) {};%
	\fill (\thecomputationarrowsone) + (-.06,0) circle [radius=1.75pt];%
	\node (\thecomputationarrowstwo) at (#3,#4) {};%
	\fill (\thecomputationarrowstwo) + (.06,0) circle [radius=1.75pt];}

\newcommand{\drule}[3]{\left( \text{#1} \right)~~\frac{~~{#2}~~}{~~{#3}~~}}


%%%%    Proof rules for entailment   %%%%

\newcommand{\redeq}{\,=_{\tau}\,}
\newcommand{\free}{\,\textit{FV}_{\tau}\,}
\newcommand{\alloc}{\,\textit{ALLOC}_{\tau}\,}
\newcommand{\tp}[1]{\mathbf{#1}}
\newcommand{\rank}{\textit{rank}}
\newcommand{\ipred}{\Phi}
\newcommand{\predsymb}{\textit{Pred}}
\newcommand{\sentail}{\,\vdash_{\ipred}\,}
\newcommand{\entail}{\,\leq_{\ipred}\,}

\newcommand{\spt}[1]{\textit{spt}(#1)}

%%%% Hoare style proofs %%%%
\newcommand{\hproof}[1]{\Bigl\{~ #1 ~\Bigr\}}
\newcommand{\proofstep}[3]{\item[($#1$)] #2 \begin{align*} #3 \end{align*}}

%%%%    Symbols    %%%%

\newcounter{sarrow}
\newcommand\xrsquigarrow[1]{%
	\stepcounter{sarrow}%
	\begin{tikzpicture}[decoration=snake]
		\node (\thesarrow) {\strut{#1}};
		\draw[->, decorate] (\thesarrow.south west) -- (\thesarrow.south east);
	\end{tikzpicture}%
}

\newcommand{\lfp}{\ensuremath{\textnormal{\sfsymbol{lfp}}~}}
\newcommand{\gfp}{\ensuremath{\textnormal{\sfsymbol{gfp}}~}}



%%%%    Predicate definitions    %%%%
\newcommand{\Spt}[1]{\ensuremath{\mathsf{spt}\left(#1\right)}}
\newcommand{\Tree}[1]{\ensuremath{\iverson{\mathsf{tree}\left(#1\right)}}}
\newcommand{\TreeHeight}[1]{\ensuremath{\mathsf{th}\left(#1\right)}}
\newcommand{\Sll}[2]{\ensuremath{\mathsf{sll}\left(#1,#2\right)}}
\newcommand{\Path}[1]{\ensuremath{\mathsf{path}\left(#1\right)}}
\newcommand{\Dll}[3]{\ensuremath{\mathsf{dll}\left(#1,#2,#3\right)}}
\newcommand{\SkipList}[2]{\ensuremath{\mathsf{skl}\left(#1,#2\right)}}

%%%% Denotational semantics %%%%
\newcommand{\powerset}[1]{\ensuremath{\mathcal{P}(#1)}}
\newcommand{\Exit}{\ensuremath{\textnormal{\texttt{Exit}}}}
\newcommand{\Conf}{\ensuremath{\ensuremath{\mathcal{P}(\States)}}}
\newcommand{\Diverge}{\ensuremath{{\Uparrow}}}

%%%%    Operational model    %%%%
\newcommand{\ExecSymbol}{\ensuremath{\rightarrow}}
\newcommand{\PExpr}{\ensuremath{\mathsf{PExpr}}}
\newcommand{\Exec}[8]{\ensuremath{#1,#2,#3 \,\xrightarrow{#4, #5}\, #6, #7, #8 }}
\newcommand{\ExecTrans}[6]{\ensuremath{#1,#2,#3 \,\rightarrow^{*} \, #4, #5, #6 }}
\newcommand{\ExecSimple}[3]{\ensuremath{#1 \,\xrightarrow{#2}\, #3}}
\newcommand{\Fault}{\ensuremath{\text{\Lightning}}}
\newcommand{\Term}{\ensuremath{\Downarrow}}
\newcommand{\Sink}{\ensuremath{\bot}}
\newcommand{\ExecSink}[5]{\ensuremath{#1,#2,#3 \,\xrightarrow{#4, #5}\, \Sink }}
\newcommand{\SinkExecSink}{\ensuremath{\Sink\xrightarrow{0, 1} \Sink }}
\newcommand{\Update}[2]{\ensuremath{\subst{#1}{#2}}} %[#1 \mapsto #2]}}
\newcommand{\HeapSet}[1]{\ensuremath{\{ #1 \}}}

\newcommand{\Fsymbol}{\ensuremath{\Phi}}
\newcommand{\F}[2]{\ensuremath{\Fsymbol\llbracket#1\rrbracket\left(#2\right)}}

\newcommand{\Ext}[1]{\ensuremath{\tilde{#1}}}
\newcommand{\EF}[2]{\ensuremath{\Ext{\Fsymbol}\llbracket#1\rrbracket\left(#2\right)}}

\newcommand{\FTSymbol}[1]{\ensuremath{\tilde{#1}}}
\newcommand{\FT}[3]{\ensuremath{\FTSymbol{#1}\llbracket#2\rrbracket\left(#3\right)}}

\newcommand{\Opsymbol}{\ensuremath{\mathsf{op}}}
\newcommand{\Opf}[2]{\ensuremath{\mathsf{op}\llbracket#1\rrbracket\left(#2\right)}}
\newcommand{\EOpf}[2]{\ensuremath{\Ext{\mathsf{op}}\llbracket#1\rrbracket\left(#2\right)}}
\newcommand{\OpMdp}[3]{\ensuremath{\mathcal{M}\llbracket#2,#1\rrbracket(#3)}}
\newcommand{\Mdp}{\ensuremath{\mathcal{M}}}
%\newcommand{\OpStates}{\ensuremath{\mathcal{S}}}
\newcommand{\OpStates}{\ensuremath{\mathsf{Conf}}}
\newcommand{\OpActions}{\ensuremath{\mathsf{Act}}}
\newcommand{\OpAct}[1]{\ensuremath{\mathsf{Act}(#1)}}
\newcommand{\OpRew}{\ensuremath{\mathsf{rew}}}
\newcommand{\OpInit}{\ensuremath{\mathsf{init}}}
\newcommand{\OpP}{\ensuremath{\mathsf{P}}}
\newcommand{\ExpRewC}[2]{\ensuremath{\mathsf{ExpRew}\llbracket #1 \rrbracket\left(#2\right)}}
\newcommand{\ExpRew}[2]{\ensuremath{\mathsf{ExpRew}\left(#1, #2\right)}}
\newcommand{\ExpRewI}[1]{\ensuremath{\mathsf{ExpRew}\left(#1\right)}}
\newcommand{\ProbReach}[3]{\ensuremath{\mathsf{Prob}\left(#1, #2 \,\models\, \Diamond #3\right)}}

\newcommand{\ProbSymbol}{\ensuremath{\mathsf{Prob}}}
\newcommand{\Prob}[1]{\ensuremath{\ProbSymbol(#1)}}
\newcommand{\MC}[2]{\ensuremath{#1^{#2}}}
\newcommand{\Target}{\ensuremath{\mathcal{G}}}
\newcommand{\PathsFromTo}[2]{\ensuremath{\Pi[#1]\left(#2\right)}}
\newcommand{\Scheduler}{\ensuremath{\rho}}


%%%%%    Ordinals    %%%%%
\newcommand{\Ord}{\textit{Ord}}


%%%%%    Equations    %%%%
\newcommand{\itag}[1]{\left\llbracket~\textnormal{#1}~\right\rrbracket\notag}
\newcommand{\eeqtag}[1]{\eeq & \itag{#1} \\}
\newcommand{\lleqtag}[1]{\lleq & \itag{#1} \\}
\newcommand{\ggeqtag}[1]{\ggeq & \itag{#1} \\}
\newcommand{\ppreceqtag}[1]{\ppreceq & \itag{#1} \\}
\newcommand{\ssucceqtag}[1]{\ssucceq & \itag{#1} \\}
\newcommand{\iimpliestag}[1]{\iimplies& \itag{#1} \\}
\newcommand{\leftrighttag}[1]{~\Longleftrightarrow~& \itag{#1} \\}

%%%%% Data structures %%%%%
\newcommand{\Lssymbol}{\ensuremath{\mathsf{ls}}}
\newcommand{\Ls}[2]{\ensuremath{\iverson{\Lssymbol\left(#1,#2\right)}}}
\newcommand{\Lensymbol}{\ensuremath{\mathsf{len}}}
\newcommand{\Len}[2]{\ensuremath{\Lensymbol\left(#1,#2\right)}}
\newcommand{\npath}[2]{\ensuremath{\mathsf{path}\llbracket #1 \rrbracket\left(#2\right)}}



%%%%% RECURSION %%%%%
\newcommand{\rhpgcl}{\textnormal{\sfsymbol{rhpGCL}}\xspace}   


\newcommand{\ProcNames}{\ensuremath{\mathsf{ProcNames}}}
\newcommand{\ProcName}[1]{\ensuremath{\mathtt{#1}}}
\newcommand{\ProcParamSym}{\ensuremath{\mathsf{param}}}
\newcommand{\ProcParam}[1]{\ensuremath{\ProcParamSym\left(\ProcName{#1}\right)}}

\newcommand{\ProcDeclIs}[4]{\ensuremath{\texttt{procedure}~\ProcName{#1}\left(#2\right) \left\{ \, #4 \, \right\}}}
\newcommand{\ProcDecl}[3]{\ensuremath{\texttt{procedure}~\ProcName{#1}\left(#2\right) \{ }}
\newcommand{\ProcCall}[3]{\ensuremath{\texttt{call}~\ProcName{#1}\left(#2\right)}}

\newcommand{\ProcPsi}[2]{\ensuremath{\Psi_{#1,#2}}}

%\newcommand{\PROCEDURE}[2]{\ensuremath{\ProcName{#1}\left( #2 \right)}}
%\newcommand{\CALL}[2]{\ensuremath{\texttt{call}~\PROCEDURE{#1}{#2}}}
%\newcommand{\NEWVAR}[1]{\ensuremath{\texttt{var}~#1}}
%\newcommand{\NEWPROC}[3]{\ensuremath{\texttt{procedure}~\PROCEDURE{#1}{#2}~\left\{ \, #3 \, \right\}}}
%\newcommand{\BLOCK}[3]{\ensuremath{#1 \,\SEMI\, #2 \,\SEMI\, #3}}

\newcommand{\DeclVSym}{\ensuremath{\mathsf{DVar}}}
\newcommand{\DeclV}[2]{\ensuremath{\DeclVSym\llbracket #1 \rrbracket\left(#2\right)}}

\newcommand{\DeclPSym}{\ensuremath{\mathsf{DProc}}}
\newcommand{\DeclP}[3]{\ensuremath{\DeclPSym\llbracket #1, #2 \rrbracket\left(#3\right)}}



%\newcommand{\PROCEDUREDECL}[3]{\ensuremath{\texttt{procedure}\,\PROCEDURE{#1}{#2} \, \left\{ \, #3 \, \right\}}}
\newcommand{\Stores}{\ensuremath{\mathsf{Stores}}}
\newcommand{\Next}{\ensuremath{\mathsf{next}}}
\newcommand{\VarEnv}{\ensuremath{\mathsf{VarEnv}}}
\newcommand{\Arity}[1]{\ensuremath{\mathsf{arity}(#1)}}
\newcommand{\ProcEnv}{\ensuremath{\mathsf{ProcEnv}}}

\newcommand{\store}{\ensuremath{\tau}}
\newcommand{\varenv}{\ensuremath{\nu}}
\newcommand{\procenv}{\ensuremath{\rho}}
\newcommand{\procenvP}[3]{\ensuremath{\rho}\llbracket \ProcName{#1}, #2 \rrbracket}
\newcommand{\procenvPrime}[3]{\ensuremath{\rho'}\llbracket \ProcName{#1}, #2 \rrbracket}
\newcommand{\lookup}{\ensuremath{(\store \circ \varenv)}}
\newcommand{\stack}{\ensuremath{\mathsf{stack}}}
\newcommand{\ev}[2]{\ensuremath{#1 \circ \stack(#2)}} % evaluate
\newcommand{\evv}[1]{\ensuremath{\ev{#1}{\varenv}}}
\newcommand{\Estore}{\ensuremath{\E^{\store}}}
\newcommand{\Eadm}{\ensuremath{\E^{\store}_{\varenv}}}


%%%%%% CASE STUDIES %%%%%%

\newcommand{\csLossyReverse}{c_{\textit{reversal}}}
\newcommand{\csPLossyReversal}{lossyReversal}
\newcommand{\csPutGet}{c_{\textit{put/get}}}
\newcommand{\csListTraverse}{c_{\textit{trav}}}

\newcommand{\csGet}{c_{\textit{consume}}}
\newcommand{\csPut}{c_{\textit{produce}}}

%% quicksort new approach
%\newcommand{\qsApplyWlp}{apply definition of $\wlpsymbol$}
%\newcommand{\qsQsBody}{c_\textit{body}}
%\newcommand{\qsPBody}{c_\textit{partition}}
%\newcommand{\qsQsIfTrue}{c_{\textit{true}}}
%\newcommand{\qsQsEntailmentFirstCall}{algebra for first call}
%\newcommand{\qsQsFrameRule}{frame rule}
%\newcommand{\qsQsApplyRecursionRule}{Use premise of recursion rule}
%\newcommand{\qsQsEntailmentSecondCall}{algebra for second call}
%\newcommand{\qsQsAlgebraBeforePartition}{algebra}
%\newcommand{\qsPSwapLast}{TODO swap}
%\newcommand{\qsPLoopBody}{c_{\textit{partitionBody}}}
%\newcommand{\qsApplyLoopInvariant}{TODO loop invariant}
%\newcommand{\qsPSwapBody}{TODO body swap}

% quick sort expectation
%\newcommand{\Permutations}[2]{\ensuremath{\mathit{Perm}\left(#1,#2\right)}}
%\newcommand{\qsPost}[2]{\mathit{Post}\left(#1,#2\right)}
%\newcommand{\qsPre}[2]{\mathit{Pre}\left(#1,#2\right)}
%\newcommand{\qsPivot}[3]{\mathit{Pivot}\left(#1,#2,#3\right)}
%\newcommand{\qsSort}[2]{\ensuremath{\mathit{Order}\left(#1,#2\right)}}
%
%\newcommand{\qscBody}{Lemma~\ref{thm:qs:corr:body}}
%
%
%\newcommand{\qsBody}{\ensuremath{c_{\textit{body}}}}
%\newcommand{\qsConstant}{10}
%\newcommand{\qsRt}[2]{\textit{rt}(#1,#2)}
%\newcommand{\qsSublinearity}{Theorem~\ref{thm:wp:basic}.\ref{thm:wp:basic:super-linearity}}
%\newcommand{\qsBatz}{Theorem~\ref{thm:batz}}
%\newcommand{\qsWpLeqOne}{Theorem~\ref{thm:wp:basic}.\ref{thm:wp:basic:1-boundedness}}
%\newcommand{\qsPartition}{Lemma~\ref{thm:qs:partition-t}}


%%%% Unaffected Expectations %%%%%
\newcommand{\unaffectedSymbol}{\mathrel{\not\mathrel{\Cap}}}
\newcommand{\unaffected}[2]{{#1} \unaffectedSymbol {#2}}

\newcommand{\HeapPartitions}[3]{\textit{Partitions}(#1,#2,#3)}



%%%% CASE STUDIES
\newcommand{\lsHead}{\textit{hd}}
\newcommand{\lsRev}{r}
\newcommand{\lsTmp}{t}

\newcommand{\perm}[2]{\text{Perm}\left( #1 , #2 \right) }
\newcommand{\aarray}{\texttt{array}}
\newcommand{\carray}{\cc_{\text{array}}}
\newcommand{\crand}{\cc_{\text{loop}}}
\newcommand{\cbody}{\cc_{\text{body}}}


\newcommand{\correctpassword}{\texttt{"oopsla2022"}}


% pre and post and program for KAT / relational
\newcommand{\pre}{\ensuremath{b}}
\newcommand{\post}{\ensuremath{c}}
\newcommand{\program}{\ensuremath{p}}
\newcommand{\secprogram}{\ensuremath{q}}
\newcommand{\witness}{\ensuremath{v}}
\newcommand{\variant}{\ensuremath{v}}

% running example
\newcommand{\plogin}{\ensuremath{\program_{\text{login}}}}
\newcommand{\pwdcorrect}{\ensuremath{\textit{pwd correct}}}
\newcommand{\pwdincorrect}{\ensuremath{\textit{pwd incorrect}}}
\newcommand{\pwdabcd}{\ensuremath{\textit{pwd = }1234}}
\newcommand{\access}{\ensuremath{\textit{access granted}}}
\newcommand{\noaccess}{\ensuremath{\textit{access denied}}}
\newcommand{\error}{\ensuremath{\textit{error}}}

\newcommand{\NDCHOICEC}{\ensuremath{\NDCHOICE{\program_1}{\program_2} }}
\newcommand{\NDCHOICEQ}{\ensuremath{\NDCHOICE{\secprogram_1}{\secprogram_2} }}

% KAT variants
\newcommand{\KAT}{\textup{\textsf{KAT}}\xspace}
\newcommand{\CompKAT}{\textup{\textsf{CompKAT}}\xspace}
\newcommand{\TopKAT}{\textup{\textsf{TopKAT}}\xspace}


% boxes

\newenvironment{narrowbluebox}{%
	\medskip%
	\begin{addmargin}[-1em]{-1em}%
	\begin{mdframed}[backgroundcolor=blue!10!white, linecolor=gray, linewidth=.25pt, skipabove=0pt, skipbelow=1.5\topsep, innertopmargin=1em, innerbottommargin=1em, innerleftmargin=1em, innerrightmargin=1em]%
		% color was DodgerBlue3
}{%
	\end{mdframed}%
	\end{addmargin}%
%	\medskip%
}

% Union and intersection logics
\newcommand{\awpCAPdwlp}[2]{\ensuremath{(\awpsymbol \cap \dwlpsymbol) \llbracket #1 \rrbracket\left( #2 \right)}}
\newcommand{\awpCUPdwlp}[2]{\ensuremath{(\awpsymbol \cup \dwlpsymbol) \llbracket #1 \rrbracket\left( #2 \right)}}
\newcommand{\aspCAPdslp}[2]{\ensuremath{(\aspsymbol \cap \dslpsymbol) \llbracket #1 \rrbracket\left( #2 \right)}}
\newcommand{\aspCUPdslp}[2]{\ensuremath{(\aspsymbol \cup \dslpsymbol) \llbracket #1 \rrbracket\left( #2 \right)}}


\newcommand{\nokat}{ \textcolor{gray}{inexpressible}}
\definecolor{reeed}{rgb}{0.59, 0.0, 0.09}
\newcommand{\katexpr}[1]{ \color{reeed}{#1}}


\newcommand{\logic}[1]{\textbf{#1}}

% \newcommand{\statelabel}[1]{\boldsymbol{\mathsf{#1}}}
\newcommand{\statelabel}[1]{{\Large \boldsymbol{\mathsf{#1}}}}