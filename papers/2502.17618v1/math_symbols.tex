\usepackage{bbm}

\newcommand\myeq{\mkern1.5mu{=}\mkern1.5mu} 
\newcommand\mycol{\mkern1.5mu{:}\mkern1.5mu} 
\newcommand\mysum{\mkern1.5mu{+}\mkern1.5mu}
\newcommand\mypm{\mkern1.5mu{\pm}\mkern1.5mu} 
\newcommand{\xhat}{\hat{x}} 

\newcommand{\MS}[2]{\begin{tabular}{l}#1$\mypm$#2\end{tabular}}


% fields
\newcommand{\field}[1]{\mathbb{#1}}
\newcommand{\N}{\field{N}} 
\newcommand{\R}{\field{R}} 
\newcommand{\C}{\field{C}} 
\newcommand{\F}{\field{F}} 

% special operators
\DeclareMathOperator{\EX}{\ensuremath{\mathbb{E}}}  % expected value
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

% function symbols
\newcommand{\Ind}{\mathbbm{1}}  % indicator function

% braces
\newcommand{\Set}[3]{\{#1\}_{#2}^{#3}} 

% caligraphic
\newcommand{\calM}{\mathcal{M}}
\newcommand{\calN}{{\mathcal{N}}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calC}{\mathcal{C}}

% bar
\newcommand{\barA}{\bar{A}}

% tilde
\newcommand{\tilpi}{{\tilde{\pi}}}
\newcommand{\tilcalD}{{\tilde{\calD}}}
\newcommand{\tilD}{{\tilde{D}}}

% hat
\newcommand{\hatChi}{{\hat{\chi}}}
\newcommand{\hatX}{{\hat{x}}}

% check
\newcommand{\chkRho}{{\check{\rho}}}

% grave
\newcommand{\grvRho}{{\grave{\rho}}}

% for concatenating two subscripts
\newcommand{\concat}[2]{
\expandafter\ifx\expandafter\relax\detokenize{#1}\relax   % first is empty
    \expandafter\ifx\expandafter\relax\detokenize{#2}\relax  % second is empty
        {}
    \else  % second not empty
        {#2}
    \fi
\else  % first not empty
    \expandafter\ifx\expandafter\relax\detokenize{#2}\relax  % second is empty
        {#1}
    \else
        {#1, #2}
    \fi
\fi
}

% model symbols 
\newcommand{\Prev}[1]{{#1}^{-}}  % previous [action, intent, ...]
\newcommand{\Next}[1]{{#1}'}  % next [state, intent ...]
\newcommand{\Joint}[1]{#1}  % joint [action, obs, intent, ...]
\newcommand{\Others}[2]{{#1}_{-#2}}  % others' [action, intent, ...]
\newcommand{\AtTime}[2]{{#1}^{#2}}  % at time t

\newcommand{\obs}{o}
\newcommand{\Tx}{\zeta}  % intent transition

\newcommand{\ExtA}{A^{+}}  % extended action set
\newcommand{\ExtX}{X^{+}}  % extended intent set

\newcommand{\PrA}[1]{\Prev{a}_{#1}}  % previous action
\newcommand{\PrX}[1]{\Prev{x}_{#1}}  % previous intent

\newcommand{\NxA}[1]{\Next{a}_{#1}}  % next action
\newcommand{\NxS}{\Next{s}}  % next state

\newcommand{\JoA}{\Joint{a}}  % joint action
\newcommand{\JoX}{\Joint{x}}  % joint intent
\newcommand{\JoO}{\Joint{\obs}}  % joint observation

\newcommand{\PrJoA}{\Prev{\Joint{a}}}  % previous joint action
\newcommand{\PrJoX}{\Prev{\Joint{x}}}  % previous joint intent

\newcommand{\OtA}[1]{\Others{a}{#1}}  % others' action
\newcommand{\OtX}[1]{\Others{x}{#1}}  % others' intent

\newcommand{\PrOtA}[1]{\Prev{\OtA{#1}}}  % others' previous actions

\newcommand{\TmOtA}[2]{\AtTime{\OtA{#1}}{#2}}  % others' action at time t
\newcommand{\TmA}[2]{\AtTime{a_{#1}}{#2}}  % action at time t
\newcommand{\TmX}[2]{\AtTime{x_{#1}}{#2}}  % intent at time t
\newcommand{\TmO}[2]{\AtTime{\obs_{#1}}{#2}}  % observation at time t
\newcommand{\TmS}[1]{\AtTime{s}{#1}}  % state at time t
\newcommand{\TmJoO}[1]{\AtTime{\JoO}{#1}}  % joint observation at time t
\newcommand{\TmJoA}[1]{\AtTime{\JoA}{#1}}  % joint observation at time t
\newcommand{\TmOA}[2]{\TmO{#1}{#2}, \TmA{#1}{#2}}
\newcommand{\TmJoOA}[1]{\TmOA{}{#1}}
\newcommand{\TmXEst}[2]{\AtTime{\hatX_{#1}}{#2}}  % intent at time t
\newcommand{\TmOATrj}[2]{(\TmO{#1}{}, \TmA{#1}{})^{#2}}

\newcommand{\piE}{\pi_{E}}
\newcommand{\OtPi}[1]{\Others{\pi}{#1}}
\newcommand{\OtTx}[1]{\Others{\Tx}{#1}}
\newcommand{\OtAM}[1]{\Others{\calN}{#1}}

\newcommand{\JoAM}{\calN_{1:n}}  % we use different representation for this.

% neuralnet
\newcommand{\PiParam}{\theta}  %  pi parameter
\newcommand{\TxParam}{\phi}  % Tx parameter
\newcommand{\PaPi}[2]{{\pi_{\PiParam_{#1}}^{#2}}}  % parameterized pi
\newcommand{\PaTx}[2]{{\Tx_{\TxParam_{#1}}^{#2}}}  % parameterized Tx
\newcommand{\PaAM}[2]{{\calN_{\PiParam_{#1}, \TxParam_{#1}}^{#2}}}  % parameterized agent model
\newcommand{\JoPaAM}[1]{{\calN_{1:n, \PiParam, \TxParam}^{#1}}}  % parameterized agent model
\newcommand{\PaPiTx}[3]{\PaPi{#1}{#2}, \PaTx{#1}{#3}}  % parameterized 

% data symbols
\newcommand{\Traj}[1]{{\tau_{#1}}} 
\newcommand{\TrajTeam}{\Traj{}}
\newcommand{\Demo}[1]{{D_{#1}}}
\newcommand{\DemoTeam}{\Demo{}}
\newcommand{\DemoX}[1]{\tilD_{#1}}
\newcommand{\DemoTeamX}{\DemoX{}}
\newcommand{\Rollout}[1]{{{R}_{#1}}}  % collection of rollouts
\newcommand{\RolloutTeam}{{\Rollout{}}}

\newcommand{\XSeq}[1]{\chi_{#1}}
\newcommand{\XEstSeq}[1]{\hatChi_{#1}}
% \newcommand{\XLabel}[1]{\{x_{#1}^{i_1}, \cdots, x_{#1}^{i_k}\}}
\newcommand{\XLabel}[3]{\{\XSeq{#1}\}_{#2}^{#3}}
\newcommand{\XEst}[3]{\{\XEstSeq{#1}\}_{#2}^{#3}}

\newcommand{\TrajX}[1]{{\bar{\tau}_{#1}}} 

% loss
\newcommand{\Lam}{L_{oaxx}}  % loss for agent model
\newcommand{\Lpi}[2]{{L_{oax, #1}}^{#2}}  % loss for policy
\newcommand{\Ltx}[2]{{L_{oxx, #1}}^{#2}}  % loss for intent transition
\newcommand{\Loss}[1]{L^{#1}}  % loss 

% input signature
\newcommand{\oaxx}[1]{\obs_{#1}, a_{#1}, x_{#1}, \PrX{#1}}
\newcommand{\oax}[1]{\obs_{#1}, a_{#1}, x_{#1}}
\newcommand{\oxx}[1]{\obs_{#1}, x_{#1}, \PrX{#1}}

\newcommand{\OMamEst}[3]{\rho_{#1}^{#3}(\oaxx{#2})}
\newcommand{\OMpiEst}[3]{\rho_{#1}^{#3}(\oax{#2})}
\newcommand{\OMtxEst}[3]{\rho_{#1}^{#3}(\oxx{#2})}

% occupancy measure
\newcommand{\OMam}[2]{\OMamEst{#1}{#2}{}}
\newcommand{\OMamCon}[3]{\rho_{#1}(\oaxx{#2}|#3)}
\newcommand{\OMpi}[2]{\OMpiEst{#1}{#2}{}}  % occupancy measure with oax input
\newcommand{\OMtx}[2]{\OMtxEst{#1}{#2}{}}
\newcommand{\OMdot}[1]{\rho_{#1}(\cdot)}

\newcommand{\OMtwoEst}[6]{\rho_{#3}^{#6}({#1}_{#4}, {#2}_{#5})}
\newcommand{\OMtwo}[5]{\OMtwoEst{#1}{#2}{#3}{#4}{#5}{}}

\newcommand{\OMsa}[2]{\OMtwo{s}{a}{#1}{}{#2}}
% \newcommand{\OMsa}[2]{\rho_{#1}(s, a_{#2})}
\newcommand{\OMsaxx}[1]{\rho_{#1}(s, a, x, \PrX{})}

\newcommand{\sumUnP}[1]{\sum_{t=0}^\infty \gamma^t p(#1)}
\newcommand{\sumP}[1]{(1-\gamma)\sumUnP{#1}}

% divergence
\newcommand{\Dfam}[4]{D_f\left(\OMam{#1}{#3} \middle|\middle| \OMamEst{#2}{#3}{#4}\right)}
\newcommand{\Dfamchk}[4]{D_f\left(\OMam{#1}{#3} \middle|\middle| \chkRho_{#2}^{#4}(\oaxx{#3})\right)}
\newcommand{\Dfamgrv}[4]{D_f\left(\OMam{#1}{#3} \middle|\middle| \grvRho_{#2}^{#4}(\oaxx{#3})\right)}
\newcommand{\Dfpi}[4]{D_f\left(\OMpi{#1}{#3} \middle|\middle| \OMpiEst{#2}{#3}{#4}\right)}
\newcommand{\Dftx}[4]{D_f\left(\OMtx{#1}{#3} \middle|\middle| \OMtxEst{#2}{#3}{#4}\right)}
\newcommand{\Dfdot}[2]{D_f\left(\OMdot{#1} \middle|\middle| \OMdot{#2}\right)}
\newcommand{\Dfsa}[3]{D_f\left(\OMsa{#1}{#3} \middle|\middle| \OMsa{#2}{#3}\right)}
\newcommand{\Dfsaxx}[2]{D_f\left(\OMsaxx{#1} \middle|\middle| \OMsaxx{#2}\right)}

\newcommand{\Df}[3]{D_f\left({#1}(#3) \middle|\middle| {#2}(#3)\right)}

\newcommand{\Dftwo}[6]{D_f\left(\OMtwo{#1}{#2}{#3}{#5}{#5} \middle|\middle| \OMtwoEst{#1}{#2}{#4}{#5}{#5}{#6}\right)}

% rho 
\newcommand{\rhoE}{\rho_{E}}
\newcommand{\rhopi}{\rho_{\pi}}
\newcommand{\rhotx}{\rho_{\Tx}}
\newcommand{\rhoam}{\rho_{\calN}}


% new states & action
\newcommand{\Spi}{u}
\newcommand{\Stx}{v}
\newcommand{\Sam}{\Stx}
\newcommand{\Aam}{w}

