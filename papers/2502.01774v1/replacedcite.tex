\section{Background and Related Work}
\label{sec:background}
Grokking was detected in a few different datasets and different kinds of model architecture. To the best of our knowledge, no definition for grokking exists in the literature, only descriptions and examples of the phenomenon.
%TODO talk about recent and related work and their descriptions
Thus, we compiled those descriptions into Definition~\ref{grokking-definition} below, as also illustrated in Figure~\ref{fig:grokking-def}. In the paper that first reported the phenomenon ____, the grokking signature has a large $\Delta_S$ (see Figure~\ref{fig:grokking-def}) as evaluated predominantly on algorithmic datasets, that is, where the labels are produced by a known algorithm, such as a mathematical operation. How large $\Delta_S$ gets depends on how much the task relies on learning representations, as illustrated by the authors when comparing the latent space of the model before and after grokking takes place. 

In ____, a rich study is presented on how different parameter choices may influence the occurrence of grokking. This is done by training a multilayer perceptron (MLP) on MNIST and reducing the size of the training set to 1,000 examples; ____ do not study what characteristics of the training data might contribute to or avoid grokking. By contrast, our main focus in this paper is to study the training process conditions that create grokking using arbitrary datasets. Nonetheless, ____ discuss interesting notions of knowledge representation which align with our idea that relational knowledge and class hierarchy is important for grokking.     
    %changes in he network. % Interesting insights. Possible tools to be used
    % Relation with this work

In ____, the focus is on understanding the grokking phenomenon by reverse-engineering neural networks, specifically one-layer transformers trained on modular arithmetic tasks. % What they focus on.
The authors provide interesting insight into how these networks use discrete Fourier transforms and trigonometric identities to achieve emergent behavior, particularly during the grokking phase. They suggest that by defining progress measures for each network component, one should be able to track and understand the training dynamics better. % Interesting insights.
Differently from ____, our work investigates grokking from the perspective of data distribution shifts and statistical properties in general, either for MLPs or Transformers, rather than in the context of a specific network architecture. % Relation with this work

____ investigate the grokking phenomenon as a phase transition in the context of rule learning. They claim that grokking is a result of the locality of a teacher model and seek to estimate the probability of grokking as being the fraction of sampled attention tensors in a tensor-network map that lead to a linearly separable feature space for a choice of rule. In our work, grokking is formulated purely from a statistical perspective without the need for rule learning. 
%They present two solvable models illustrating grokking and provide exact analytic expressions for critical exponents, grokking probability, and grokking time distribution. % What they focus on.
%   The authors highlight the role of locality in a teacher model and introduce a tensor-network map connecting their setup to a perceptron's statistical learning theory. Their analysis includes studying cellular automata learning tasks and numerically determining critical exponents and grokking time distributions, revealing a connection between structure formation and grokking. % Interesting insights.
    % Possible tools to be used.
    % Relation with this work
____ study the occurrence of grokking within linear models through gradient descent. The paper offers an insight that motivated our work: grokking can happen due to data distribution rather than model complexity. The tools used in ____, such as the analysis of training and generalization loss dynamics, could be adapted to our work. The paper supports our hypothesis that grokking is caused by distribution shifts in the specific case of liner models. It is generalized in this paper to more complex models. % What they focus on.
    % Interesting insights.
    % Possible tools to be used.
    % Relation with this work
____ proposes that grokking is a transition from lazy to rich training, that is, when a network proceeds from attempting to learn a linear model from the features that are provided to learn more abstract, derived features. The paper focuses on a kernel regression task, although it reports results on how to try and control grokking on MNIST using an MLP and on modular arithmetic using a one-layer transformer. The authors also claim that weight decay cannot explain grokking. While ____ places an emphasis on specific model learning, we show that grokking is generally model-independent through our experiments using an MLP and a two-layer transformer (see Appendix~\ref{app:dataset-creation}).

%https://openreview.net/forum?id=vt5mnLVIVo

%Other work on training dynamics explain the impact of regularization ____ and also initialization ____. 

\paragraph{Distribution shift:} A distribution shift, as discussed in ____, refers to a significant change in the statistical properties of a dataset which can lead to poor performance of machine learning models. In this context, a distribution shift typically occurs when the properties of the data used for training differ significantly from the properties of the data encountered during deployment. This discrepancy can result from various factors, such as changes in the data source, user behavior or environment conditions.

____ highlights the effectiveness of two-sample testing methods, particularly those leveraging pre-trained classifiers for dimensionality reduction, in identifying shifts. Additionally, domain-discriminating methods are noted for their ability to qualitatively characterize shifts and assess their potential impact. Since grokking can be viewed as deriving from distribution shifts between training and test sets, the methods and insights from ____ could be applied to detect and analyze these shifts in the context of grokking.