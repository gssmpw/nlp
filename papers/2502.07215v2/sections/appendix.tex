\clearpage
\appendix
\section{Appendix}

\subsection{PDV Algorithm and Code}
The PDV algorithm is given in Algorithm \ref{algo:pdv}, and the code is shown in Figure \ref{fig:pdv-code}. The implementation of PDV is very intuitive, and it could be easily integrated with any ZS-CIR approaches.

\begin{algorithm}
	\caption{Calculate PDV Features}
	\label{algo:pdv}
	\begin{algorithmic}[1]
		\Function{CalculatePDVFeatures}{$\mathbf{f}_{\text{text}}$, $\mathbf{f}_{\text{text\_composed}}$, $\mathbf{f}_{\text{image}}$, $\alpha_i$, $\alpha_t$, $\beta$}
		\State $\mathbf{f}_{\text{text}} \gets \text{normalize}(\mathbf{f}_{\text{text}})$
		\State $\mathbf{f}_{\text{text\_composed}} \gets \text{normalize}(\mathbf{f}_{\text{text\_composed}})$
		\State $\mathbf{f}_{\text{image}} \gets \text{normalize}(\mathbf{f}_{\text{image}})$
		
		\State $\mathbf{pdv} \gets \mathbf{f}_{\text{text\_composed}} - \mathbf{f}_{\text{text}}$
		
		\State $\mathbf{f}_{\text{PDVI}} \gets \mathbf{f}_{\text{image}} + \alpha_i \cdot \mathbf{pdv}$
		\State $\mathbf{f}_{\text{PDVT}} \gets \mathbf{f}_{\text{text}} + \alpha_t \cdot \mathbf{pdv}$
		
		\State $\mathbf{f}_{\text{PDVF}} \gets (1 - \beta) \cdot \mathbf{f}_{\text{PDVI}} + \beta \cdot \mathbf{f}_{\text{PDVT}}$
		
		\State \Return $\text{normalize}(\mathbf{f}_{\text{PDVF}})$
		\EndFunction
	\end{algorithmic}
\end{algorithm}


\begin{figure*}[!t]
	\centering
	\includegraphics[width=\linewidth]{images/code.png}
	\caption{Python function for calculating PDV features.}
	\label{fig:pdv-code}
\end{figure*}


\subsection{Additional Results}

\subsubsection{Additional Results}
We also provide additional PDV-I results achieved on the validation set of the FashionIQ dataset, as shown in Table \ref{tab:fashion_iq_results_pdv-i}. PDV-I also achieved significant improvements over existing approaches that directly leverage image embeddings for retrieval.

Lastly, we provide a detailed visualization of the impact of $\alpha$/$\beta$ scaling on top-5 retrieval results. Figure \ref{fig:residual_qual_full} illustrates the performance of CIReVL with the ViT-B-32 CLIP model across three different datasets.

\begin{table*}[!tb]
	\centering
	\small
	\begin{tabular}{l| l |c|cccccccc}
		\hline
		Fashion-IQ & & &\multicolumn{2}{c}{Shirt} & \multicolumn{2}{c}{Dress} & \multicolumn{2}{c}{Toptee} & \multicolumn{2}{c}{Average} \\ \hline
		Backbone & Method & $\alpha$ & R@10 & R@50 & R@10 & R@50 & R@10 & R@50 & R@10 & R@50 \\
		\hline
		\multirow{5}{*}{ViT-B/32} & Image-only \textdagger & -& 6.92 & 14.23 & 4.46 & 12.19 & 6.32 & 13.77 & 5.90 & 13.37 \\
		& Text-only \textdagger & - & 19.87 & 34.99 & 15.42 & 35.05 & 20.81 & 40.49 & 18.70 & 36.84 \\
		& Image + Text \textdagger & - & 13.44 & 26.25 & 13.83 & 30.88 & 17.08 & 31.67 & 14.78 & 29.60 \\
		& SEARLE + \textbf{PDV-I} & & 24.48 & 42.30 & 18.79 & 38.47 & 25.91 & 47.02 & 23.03 &  42.60\\
		& CIReVL + \textbf{PDV-I} & & 28.95 & 45.88 & 29.00 & 49.13 & 34.22 & 56.09 & 30.72 & 50.37 \\
		\hline
	\end{tabular}
	\caption{PDV-I performance on FashionIQ val datasets. \textdagger~denotes that numbers are taken from the original paper.}
	\label{tab:fashion_iq_results_pdv-i}
\end{table*}

\subsubsection{Ablation Analysis}
While Figure 3 in the main paper illustrates the effects of scaling factor $\alpha$ and fusion factor $\beta$ on Recall@5 performance across various PDV applications, Figures \ref{fig:residual_text}, \ref{fig:residual_image}, and \ref{fig:residual_fusion} present complementary results for Recall@10 and Recall@50 metrics.

The Recall@10 and Recall@50 results demonstrate consistent trends with the Recall@5 findings presented in the main paper, thus validating our conclusions across multiple evaluation metrics.

\begin{figure*}[!b]
	\centering
	\includegraphics[width=0.825\linewidth]{images/qualitative/PV_qual_all_new.pdf}
	\caption{Visualisation of the impact of $\alpha$/$\beta$ scaling on top-5 retrieval results. CIReVL with ViT-B-32 Clip model is the baseline method used. Representative examples with prompts from three datasets: FashionIQ (left), CIRR (middle), and CIRCO (right) are shown at the top. \textbf{\textcolor{boxgreen}{Green}} and \textbf{\textcolor{boxblue}{blue}} bounding boxes indicate true positives and near-true positives, respectively.}
	\label{fig:residual_qual_full}
	
\end{figure*}


\begin{figure*}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{images/residual/text/CIReVL_Recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/text/CIReVL_Recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/text/pic2word_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/text/pic2word_recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/text/SEARLE_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/text/SEARLE_recall50.png}
	\caption{PDV-T: Impact of $\alpha$ scaling on Recall@10 (left) and Recall@50 (right) performance. Results shown for three baseline methods: CIReVL (top), Pic2Word (middle) and SEARLE (bottom).}
	\label{fig:residual_text}
\end{figure*}

\begin{figure*}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{images/residual/image/CIReVL_Recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/image/CIReVL_Recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/image/pic2word_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/image/pic2word_recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/image/SEARLE_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/image/SEARLE_recall50.png}
	\caption{PDV-I: Impact of $\alpha$ scaling on Recall@10 (left) and Recall@50 (right) performance. Results shown for three baseline methods: CIReVL (top), Pic2Word (middle) and SEARLE (bottom).}
	\label{fig:residual_image}
\end{figure*}


\begin{figure*}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/CIReVL_Recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/CIReVL_Recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/pic2word_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/pic2word_recall50.png}
	\\
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/SEARLE_recall10.png}
	\includegraphics[width=0.45\linewidth]{images/residual/fusion/SEARLE_recall50.png}
	\caption{PDV-F: Impact of $\beta$ scaling on Recall@10 (left) and Recall@50 (right) performance. Results shown for three baseline methods: CIReVL (top), Pic2Word (middle) and SEARLE (bottom).}
	\label{fig:residual_fusion}
\end{figure*}
