\section{Complex Code Handling}

\subsection{Requirement Violation Injection}
There are various ways that can cause the same violation type.
We manually concluded the following common root causes that can trigger such violations. 
For the 3 violations related to missing action, they can share the same group of root causes.

When evaluating the GPT model, it usually requires the code in the prompt to have a certain number or types of violations in order to test the capabilities of the GPT model.
However, due to the limitation of the dataset, not all of them has the corresponding violations required by the experiment design.
We will inject corresponding violations depending on the experiments' need if the original Solidity code does not have such violations.
For each of the root causes, fine-grained rules are provided to be used as violation injection methods.

% \input{tables/vio_inj_table} too ugly

\begin{enumerate}
    \item Missing required action
    \begin{enumerate}
        \item Incorrect action
            \begin{enumerate}
                \item No action
                \item Another action
            \end{enumerate}
        \item Incorrect parameter(s)
            \begin{enumerate}
                \item Wrong order
                \item Wrong value
            \end{enumerate}
        \item Incorrect condition(s)
            \begin{enumerate}
                \item No condition(s)
                \item Wrap action with if(false){ ... }
                \item condition(s) \&\& false != false
                \item condition(s) \&\& true != true
                \item !condition(s)
                \item Wrap action with while(false){ ... }
                \item conditions(s) \&\& (true != true || 1 != 1)
            \end{enumerate}
    \end{enumerate}
    \item Incorrect function signature
    \begin{enumerate}
        \item Missing function signature(s)
        \item Incorrect name
        \item Incorrect number of  parameter(s)
        \item Incorrect parameter type(s)
        \item Incorrect return type
    \end{enumerate}
    \item Incorrect function return value
\end{enumerate}

\subsection{Obfuscation}
In order to test the Solidity code complexity boundary that the GPT model can audit, the following obfuscation methods are used in the experiments.

{\color{red} mangled variable names }

{\color{red} complex logic conditions }

{\color{red} long control flow distance }

{\color{red} long control inter-procedural distance }




% \begin{enumerate}
%     \item Mangling function local variable \& parameters
%     \item Wrap required condition with while(cond) { <required action>; cond = false; }
%     \item Wrap required condition with if(true) { <required action> }
%     \item Create a separate function X to wrap <required action> and replace original <target code> with X()
%     \item Insert code between the condition and <required action>

% \end{enumerate}