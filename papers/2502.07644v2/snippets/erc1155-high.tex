\begin{lstlisting}[label={lst:erc1155-high},captionpos=b, caption={ERC1155 Contract 0x6482e7f6: high violation severity found by AuditGPT},language=solidity]
function safeTransferFrom(address from, address to, uint256 id, uint256 value, bytes memory data) public {
    _update(from, to, id, value);
}

function _update(address from, address to, uint256 id, uint256 value) internal {
    if (from != address(0)) {
        _balances[id][from] -= value;
    }
    if (to != address(0)) {
        _balances[id][to] += value;
    }
}
\end{lstlisting}