\section{Conclusion}

Our work concentrated on an often overlooked area of the attack surface: the ABI-layer. 
The increasing complexity of ISA specifications make it more difficult to write secure context switch code. We introduced a tool, Sailor, that leverages machine-readable ISA specifications written in the Sail language. 
Our tool parses Sail code to identify which ISA-state must be swapped during a context switch across different security domains. 
Consequently, our tool replaces the strenuous task of manually navigating through hundreds or thousands of pages of ISA specifications to figure out which ISA-state to swap during the context switch. 
We detected three classes of mishandled ISA-state across four confidential computing frameworks for the RISC-V ISA using the results from our tool. 
Two of the three classes we identify stem from ISA-extensions. 

As ISAs continue to evolve, it is crucial to automate the task of analysing the latest specifications. 
We believe that as ISAs continue to evolve and increase in complexity, tools like Sailor are crucial for automating tedious manual tasks. 
Further, it is important to keep the machine-readable ISA specifications in Sail up to date as well, rather than just relying on prose-style documentations. 
We encourage hardware vendors to provide Sail models for their machines, especially when the hardware implements custom ISA-extensions, to promote comprehensive security analysis of the hardware. 






\section*{Acknowledgments}
We thank Silvio Dragone (IBM Research Zurich), Edouard Bugnion (EPFL, Switzerland), Michael Le, Elaine Palmer (IBM T. J. Watson Research Center), Lennard GÃ¤her (MPI-SWS Germany), as well as Charly Castes and Adrien Ghosn (EPFL, Switzerland) for their valuable comments and feedback.
This work was conducted as part of the project on Assured Confidential Computing (ACE) for RISC-V.
