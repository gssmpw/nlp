\begin{table*}[h!]
\caption{Efficiency result of \OURS\xspace on Llama-2-7B-32K-Instruct and LWM-Text-Chat-128k. We benchmark on multiple context length settings, ranging from 4k to 128k for batch size 1, and take their average across 10 different examples. Speedup ratio is compared with autoregressive generation of the target model (AR). We compare with Sparsity-based self-speculative baselines that use StreamLLM and SnapKV to quantize the KV cache. Acceptance rate of each method is shown for the respective optimal $\gamma$. We outperform these baselines and achieve a maximum of $2.49\times$ speedup compared with autoregressive generation.}
\label{tab:results}
\vspace{2mm}
    \centering
    \resizebox{0.95\linewidth}{!}{
    \begin{tabular}{l|c|c|c|ccc}
        \toprule
        \multicolumn{4}{l}{\textbf{Llama-2-7B-32K-Instruct}} & & & \\
        \midrule
        Dataset & Context Length & \# GPUs & Method & Acceptance Rate (\%) $\uparrow$ & Peak GPU Memory (GB) $\downarrow$ & Speedup ($\times$ AR) $\uparrow$ \\
        \cmidrule(lr){1-7}
        \multirow{6}{*}{PG19} & \multirow{3}{*}{4k} & \multirow{3}{*}{1}  & StreamingLLM & 88.87 & 15.20 & 1.13 \\
                              &                     &                     & SnapKV & 93.59 & 15.39 & 1.17 \\
                              &                     &                     & \graycell{\OURS} & \graycell{92.46} & \graycell{16.26} & \graycell{\textbf{1.35}} \\
        \cmidrule(lr){2-7}
                              & \multirow{3}{*}{8k} & \multirow{3}{*}{1}  & StreamingLLM & 90.31 & 17.75 & 1.27 \\
                              &                     &                     & SnapKV & 94.39 & 18.10 & 1.31 \\
                              &                     &                     & \graycell{\OURS} & \graycell{89.88} & \graycell{17.66} & \graycell{\textbf{1.44}} \\
        \cmidrule(lr){1-7}
        \multirow{6}{*}{Multi-LexSum} & \multirow{3}{*}{8k} & \multirow{3}{*}{1}  & StreamingLLM & 90.78 & 17.75 & 1.27 \\
                              &                     &                       & SnapKV & 55.55 & 18.10 & 1.01 \\
                              &                     &                       & \graycell{\OURS} & \graycell{91.23} & \graycell{17.66} & \graycell{\textbf{1.61}} \\
        \cmidrule(lr){2-7}
                              & \multirow{3}{*}{32k}& \multirow{3}{*}{1}  & StreamingLLM & 91.19 & 32.61 & 1.84 \\
                              &                     &                     & SnapKV & 72.54 & 33.96 & 1.63 \\
                              &                     &                     & \graycell{\OURS} & \graycell{91.16} & \graycell{25.84} & \graycell{\textbf{2.08}} \\
        \midrule
        \multicolumn{4}{l}{\textbf{LWM-Text-Chat-128k}} & & & \\
        \midrule
        Dataset & Context Length & \# GPUs & Method & Acceptance Rate (\%) $\uparrow$ & Peak GPU Memory (GB) $\downarrow$ & Speedup ($\times$ AR)$\uparrow$ \\
        \cmidrule(lr){1-7}
        \multirow{6}{*}{$\infty$B{\scriptsize ENCH} Sum} & \multirow{3}{*}{16k} & \multirow{3}{*}{1}  & StreamingLLM & 87.41 & 22.63 & 1.49 \\
                              &                     &                      & SnapKV & 88.61 & 23.33 & 1.50 \\
                              &                     &                      & \graycell{\OURS} & \graycell{91.64} & \graycell{20.36} & \graycell{\textbf{1.78}} \\
        \cmidrule(lr){2-7}
                              & \multirow{3}{*}{32k}& \multirow{3}{*}{1}   & StreamingLLM & 85.38 & 32.63 & 1.15 \\
                              &                     &                      & SnapKV & 84.55 & 33.98 & 1.78 \\
                              &                     &                      & \graycell{\OURS} & \graycell{90.99} & \graycell{25.86} & \graycell{\textbf{1.99}} \\
        \cmidrule(lr){1-7}
        \multirow{6}{*}{Multi-LexSum} & \multirow{3}{*}{64k} & \multirow{3}{*}{2}  & StreamingLLM & 78.95 & 52.96 & 2.16 \\
                              &                     &                        & SnapKV & 82.79 & 55.66 & 2.11 \\
                              &                     &                        & \graycell{\OURS} & \graycell{92.18} & \graycell{38.18} & \graycell{\textbf{2.23}} \\
        \cmidrule(lr){2-7}
                              & \multirow{3}{*}{128k}& \multirow{3}{*}{2}  & StreamingLLM & - & OOM & - \\
                              &                     &                      & SnapKV & - & OOM & - \\
                              &                     &                      & \graycell{\OURS} & \graycell{94.31} & \graycell{61.22} & \graycell{\textbf{2.49}} \\
        \bottomrule
    \end{tabular} 
    }
\end{table*}