\newcommand{\bfz}{\mathbf{z}}
\newcommand{\hbfz}{\hat{\mathbf{z}}}
\begin{algorithm}
\caption{Fixed-point Regularization (FPR)}
\label{alg:fpr}
\begin{algorithmic}[1]
%\REQUIRE source image $\mathbf z^{\text{src}}$, source prompt ${y}^{\text{src}}$, timestep $t$, diffusion model $\epsilon_{\phi}$, scale (CFG)  $w$, scale (IDS) $a$
%\ENSURE Output $\epsilon^{\ast}$ %target image $\bfz$

\REQUIRE $\src$, $\txts$, $\epsilon_{\phi}$, $\omega$, $\lambda$, $N$
%\ENSURE Output $\epsilon^{\ast}$ %target image $\bfz$

\STATE $\epsilon \sim \mathcal{N}(0, \mathbf{I})$
\STATE $t \sim\mathcal{U}(0, 1)$
\STATE $\mathbf z^{\text{src}}_t \leftarrow \sqrt{\alpha_t}\mathbf z^{\text{src}}+\sqrt{1-\alpha_t}\epsilon$
\FOR{i = 1, $\dots$, N}
    \STATE $\epsilon_\phi^\text{src} \leftarrow 
    (1+\omega)\epsilon_\phi(\mathbf z^{\text{src}}_{t}, y^{\text{src}}, t)
    - \omega \epsilon_\phi(\mathbf z^{\text{src}}_t, \varnothing, t)$
    \STATE $\bfz_{0|t}^{\text{src}} \leftarrow \frac{1}{\sqrt{\alpha_t}}
    (\mathbf z^{\text{src}}_t - \sqrt{1-\alpha_t}\epsilon_\phi^\text{src})$
    \STATE $\mathcal{L}_{\text{FPR}} \leftarrow 
     d(\src_{0|t}, \src)$
    \STATE $\mathbf z^{\text{src}}_t \leftarrow \mathbf z^{\text{src}}_t - \lambda \nabla_{\mathbf z^{\text{src}}_t}\mathcal{L}_{\text{FPR}}$
\ENDFOR

\STATE $\epsilon^\ast \leftarrow 
\frac{1}{\sqrt{1-\alpha_t}}(\mathbf z^{\text{src}}_t - \sqrt{\alpha_t}\mathbf z^{\text{src}})$
% \STATE $\bfz \leftarrow \text{DDS}(\hbfz, \hat{y}, y, \epsilon^{\ast})$
\RETURN $\epsilon^\ast$
\end{algorithmic}
\end{algorithm}
% \vspace{-6pt}