\newcommand{\myplotlinewidth}{1.5pt}
\begin{figure}[htb]
\begin{tikzpicture}
  \begin{axis}[
      width=\columnwidth,
      height=6cm,
      xlabel={Image Patches (sequence length)},
      ylabel={FLOPs Per Layer ($\times 10^{10}$)},
      % xmin=120, xmax=1048,
      grid=major,
      legend pos=north west,
      legend style={font=\small},
  ]
      % PLAIN MODELS
    % key = 128
    \addplot+[mark=none, style=solid, color=red, line width=\myplotlinewidth] coordinates {
        (128, 0.0034312968) (160, 0.0045503752) (192, 0.0057759496) (224, 0.00710802) (256, 0.0085465864) (288, 0.0100916488) (320, 0.0117432072) (352, 0.0135012616) (384, 0.015365812) (416, 0.0173368584) (448, 0.0194144008) (480, 0.0215984392) (512, 0.0238889736) (544, 0.026286004) (576, 0.0287895304) (608, 0.0313995528) (640, 0.0341160712) (672, 0.0369390856) (704, 0.039868596) (736, 0.0429046024) (768, 0.0460471048) (800, 0.0492961032) (832, 0.0526515976) (864, 0.056113588) (896, 0.0596820744) (928, 0.0633570568) (960, 0.0671385352) (992, 0.0710265096) (1024, 0.07502098)
    };
    
    % key = 192
    \addplot+[mark=none, style=solid, color=red, line width=\myplotlinewidth] coordinates {
        (128, 0.007039143) (160, 0.0091840518) (192, 0.0114874758) (224, 0.013949415) (256, 0.0165698694) (288, 0.019348839) (320, 0.0222863238) (352, 0.0253823238) (384, 0.028636839) (416, 0.0320498694) (448, 0.035621415) (480, 0.0393514758) (512, 0.0432400518) (544, 0.047287143) (576, 0.0514927494) (608, 0.055856871) (640, 0.0603795078) (672, 0.0650606598) (704, 0.069900327) (736, 0.0748985094) (768, 0.080055207) (800, 0.0853704198) (832, 0.0908441478) (864, 0.096476391) (896, 0.1022671494) (928, 0.108216423) (960, 0.1143242118) (992, 0.1205905158) (1024, 0.127015335)
    };
    
    % key = 384
    \addplot+[mark=none, style=solid, color=red, line width=\myplotlinewidth] coordinates {
        (128, 0.0254913804) (160, 0.0326123532) (192, 0.0400503564) (224, 0.04780539) (256, 0.055877454) (288, 0.0642665484) (320, 0.0729726732) (352, 0.0819958284) (384, 0.091336014) (416, 0.10099323) (448, 0.1109674764) (480, 0.1212587532) (512, 0.1318670604) (544, 0.142792398) (576, 0.154034766) (608, 0.1655941644) (640, 0.1774705932) (672, 0.1896640524) (704, 0.202174542) (736, 0.215002062) (768, 0.2281466124) (800, 0.2416081932) (832, 0.2553868044) (864, 0.269482446) (896, 0.283895118) (928, 0.2986248204) (960, 0.3136715532) (992, 0.3290353164) (1024, 0.34471611)
    };
    
    % key = 768
    \addplot+[mark=none, style=solid, color=red, line width=\myplotlinewidth] coordinates {
        (128, 0.0966351384) (160, 0.1222017048) (192, 0.148402332) (224, 0.17523702) (256, 0.2027057688) (288, 0.2308085784) (320, 0.2595454488) (352, 0.28891638) (384, 0.318921372) (416, 0.3495604248) (448, 0.3808335384) (480, 0.4127407128) (512, 0.445281948) (544, 0.478457244) (576, 0.5122666008) (608, 0.5467100184) (640, 0.5817874968) (672, 0.617499036) (704, 0.653844636) (736, 0.6908242968) (768, 0.7284380184) (800, 0.7666858008) (832, 0.805567644) (864, 0.845083548) (896, 0.8852335128) (928, 0.9260175384) (960, 0.9674356248) (992, 1.009487772) (1024, 1.05217398)
    };

        % --- REGISTERS MODELS
    % key = 128, R=16
    \addplot+[mark=none, style=dashed, color=green, line width=\myplotlinewidth] coordinates {
        (128, 0.003977524) (160, 0.0051498504) (192, 0.0064286728) (224, 0.0078139912) (256, 0.0093058056) (288, 0.010904116) (320, 0.0126089224) (352, 0.0144202248) (384, 0.0163380232) (416, 0.0183623176) (448, 0.020493108) (480, 0.0227303944) (512, 0.0250741768) (544, 0.0275244552) (576, 0.0300812296) (608, 0.0327445) (640, 0.0355142664) (672, 0.0383905288) (704, 0.0413732872) (736, 0.0444625416) (768, 0.047658292) (800, 0.0509605384) (832, 0.0543692808) (864, 0.0578845192) (896, 0.0615062536) (928, 0.065234484) (960, 0.0690692104) (992, 0.0730104328) (1024, 0.0770581512)
    };
    
    % key = 192, R=16
    \addplot+[mark=none, style=dashed, color=green, line width=\myplotlinewidth] coordinates {
        (128, 0.008091783) (160, 0.0103159494) (192, 0.012698631) (224, 0.0152398278) (256, 0.0179395398) (288, 0.020797767) (320, 0.0238145094) (352, 0.026989767) (384, 0.0303235398) (416, 0.0338158278) (448, 0.037466631) (480, 0.0412759494) (512, 0.045243783) (544, 0.0493701318) (576, 0.0536549958) (608, 0.058098375) (640, 0.0627002694) (672, 0.067460679) (704, 0.0723796038) (736, 0.0774570438) (768, 0.082692999) (800, 0.0880874694) (832, 0.093640455) (864, 0.0993519558) (896, 0.1052219718) (928, 0.111250503) (960, 0.1174375494) (992, 0.123783111) (1024, 0.1302871878)
    };
    
    % key = 384, R=16
    \addplot+[mark=none, style=dashed, color=green, line width=\myplotlinewidth] coordinates {
        (128, 0.029012238) (160, 0.036291726) (192, 0.0438882444) (224, 0.0518017932) (256, 0.0600323724) (288, 0.068579982) (320, 0.077444622) (352, 0.0866262924) (384, 0.0961249932) (416, 0.1059407244) (448, 0.116073486) (480, 0.126523278) (512, 0.1372901004) (544, 0.1483739532) (576, 0.1597748364) (608, 0.17149275) (640, 0.183527694) (672, 0.1958796684) (704, 0.2085486732) (736, 0.2215347084) (768, 0.234837774) (800, 0.24845787) (832, 0.2623949964) (864, 0.2766491532) (896, 0.2912203404) (928, 0.306108558) (960, 0.321313806) (992, 0.3368360844) (1024, 0.3526753932)
    };
    
    % key = 768, R=16
    \addplot+[mark=none, style=dashed, color=green, line width=\myplotlinewidth] coordinates {
        (128, 0.109339164) (160, 0.1352227608) (192, 0.1617404184) (224, 0.1888921368) (256, 0.216677916) (288, 0.245097756) (320, 0.2741516568) (352, 0.3038396184) (384, 0.3341616408) (416, 0.365117724) (448, 0.396707868) (480, 0.4289320728) (512, 0.4617903384) (544, 0.4952826648) (576, 0.529409052) (608, 0.5641695) (640, 0.5995640088) (672, 0.6355925784) (704, 0.6722552088) (736, 0.7095519) (768, 0.747482652) (800, 0.7860474648) (832, 0.8252463384) (864, 0.8650792728) (896, 0.905546268) (928, 0.946647324) (960, 0.9883824408) (992, 1.0307516184) (1024, 1.0737548568)
    };
    
    % --- JUMBO MODELS
    % key = 128, J=6
    \addplot+[mark=none, style=dotted, color=\jumboColor, line width=\myplotlinewidth] coordinates {
        (128, 0.0039923488) (160, 0.0051280672) (192, 0.0063702816) (224, 0.007718992) (256, 0.0091741984) (288, 0.0107359008) (320, 0.0124040992) (352, 0.0141787936) (384, 0.016059984) (416, 0.0180476704) (448, 0.0201418528) (480, 0.0223425312) (512, 0.0246497056) (544, 0.027063376) (576, 0.0295835424) (608, 0.0322102048) (640, 0.0349433632) (672, 0.0377830176) (704, 0.040729168) (736, 0.0437818144) (768, 0.0469409568) (800, 0.0502065952) (832, 0.0535787296) (864, 0.05705736) (896, 0.0606424864) (928, 0.0643341088) (960, 0.0681322272) (992, 0.0720368416) (1024, 0.076047952)
    };
    
    % key = 192, J=6
    \addplot+[mark=none, style=dotted, color=\jumboColor, line width=\myplotlinewidth] coordinates {
        (128, 0.008248572) (160, 0.0104182488) (192, 0.0127464408) (224, 0.015233148) (256, 0.0178783704) (288, 0.020682108) (320, 0.0236443608) (352, 0.0267651288) (384, 0.030044412) (416, 0.0334822104) (448, 0.037078524) (480, 0.0408333528) (512, 0.0447466968) (544, 0.048818556) (576, 0.0530489304) (608, 0.05743782) (640, 0.0619852248) (672, 0.0666911448) (704, 0.07155558) (736, 0.0765785304) (768, 0.081759996) (800, 0.0870999768) (832, 0.0925984728) (864, 0.098255484) (896, 0.1040710104) (928, 0.110045052) (960, 0.1161776088) (992, 0.1224686808) (1024, 0.128918268)
    };
    
    % key = 384, J=6
    \addplot+[mark=none, style=dotted, color=\jumboColor, line width=\myplotlinewidth] coordinates {
        (128, 0.0301220784) (160, 0.0372925872) (192, 0.0447801264) (224, 0.052584696) (256, 0.060706296) (288, 0.0691449264) (320, 0.0779005872) (352, 0.0869732784) (384, 0.096363) (416, 0.106069752) (448, 0.1160935344) (480, 0.1264343472) (512, 0.1370921904) (544, 0.148067064) (576, 0.159358968) (608, 0.1709679024) (640, 0.1828938672) (672, 0.1951368624) (704, 0.207696888) (736, 0.220573944) (768, 0.2337680304) (800, 0.2472791472) (832, 0.2611072944) (864, 0.275252472) (896, 0.28971468) (928, 0.3044939184) (960, 0.3195901872) (992, 0.3350034864) (1024, 0.350733816)
    };
    
    % key = 768, J=6
    \addplot+[mark=none, style=dotted, color=\jumboColor, line width=\myplotlinewidth] coordinates {
        (128, 0.1147438944) (160, 0.1404095328) (192, 0.166709232) (224, 0.193642992) (256, 0.2212108128) (288, 0.2494126944) (320, 0.2782486368) (352, 0.30771864) (384, 0.337822704) (416, 0.3685608288) (448, 0.3999330144) (480, 0.4319392608) (512, 0.464579568) (544, 0.497853936) (576, 0.5317623648) (608, 0.5663048544) (640, 0.6014814048) (672, 0.637292016) (704, 0.673736688) (736, 0.7108154208) (768, 0.7485282144) (800, 0.7868750688) (832, 0.825855984) (864, 0.86547096) (896, 0.9057199968) (928, 0.9466030944) (960, 0.9881202528) (992, 1.030271472) (1024, 1.073056752)
    };

    \node[anchor=north west, fill=white, inner sep=2pt, font=\footnotesize] 
      at (rel axis cs:0.02,0.98) {%
        \begin{tabular}{l}
          \tikz[baseline]{\draw[solid, line width=1.5pt, color=red] (0,0.1cm) -- (0.5cm,0.1cm);} ViT \\
          \tikz[baseline]{\draw[dashed, line width=1.5pt, color=green] (0,0.1cm) -- (0.5cm,0.1cm);} ViT+Registers \\
          \tikz[baseline]{\draw[dotted, line width=1.5pt, color=\jumboColor] (0,0.1cm) -- (0.5cm,0.1cm);} ViT+Jumbo
        \end{tabular}
    };
    
    \node[anchor=east, font=\footnotesize, rotate=3.5] at (rel axis cs:0.935,0.095) {ViT-nano, $D$=$128$};
    \node[anchor=east, font=\footnotesize, rotate=6.5] at (rel axis cs:0.93,0.225) {ViT-tiny, $D$=$192$};
    \node[anchor=east, font=\footnotesize, rotate=14.5] at (rel axis cs:0.93,0.40) {ViT-small, $D$=$384$};
    \node[anchor=east, font=\footnotesize, rotate=35] at (rel axis cs:0.915,0.96) {ViT-base, $D$=$768$};
  \end{axis}
  
\end{tikzpicture}
\caption{The cost of a ViT layer is---almost entirely---determined by the number of image patches and the patch width $D$. The cost of adding registers ($R = 16$) or our Jumbo \texttt{CLS} token ($J = 6$) is negligible.}
\label{fig:flops}
\end{figure}
