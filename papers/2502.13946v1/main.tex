% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[preprint]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}

% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.
\input{math_commands.tex}
\usepackage{xcolor}
\usepackage{xspace}
\usepackage{soul}
\usepackage{tcolorbox}
\usepackage{listings}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{makecell}
\usepackage{enumitem}
\usepackage{balance}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{array}
\usepackage{tabularx}  % 自动调整列宽
\usepackage{ragged2e}  % 更好的对齐控制
\usetikzlibrary{matrix,positioning,fit,shapes.geometric}
\usetikzlibrary{arrows.meta}
\usepackage{cleveref}
\definecolor{mycitecolor}{HTML}{3A76CF}
\hypersetup{
    colorlinks=true,
    citecolor=mycitecolor
} 

\newcommand{\citeneeded}[1][]{\colorbox{yellow}{\textbf{[CITE\ifx\empty#1\empty\else: #1\fi]}}}
 

\definecolor{bg1}{HTML}{D9EBFC}
\definecolor{bg2}{HTML}{CEDDF3}
% 子结论：浅灰色高亮
\newcommand{\subconc}[1]{%
    \setulcolor{black!30}
    \setul{3.2pt}{0.2pt}
    \ul{#1}%
}

% 主结论：浅黄色高亮 + 微粗体
\newcommand{\mainconc}[1]{%
    %\sethlcolor{lightblue}%
    %\hl{\textmd{#1}}%
    \textbf{#1}
}

\definecolor{darkred}{HTML}{C23B22}
\definecolor{green}{HTML}{1cc650}
\definecolor{darkergreen}{HTML}{006400}
\newenvironment{promptbox}[4][] % [Title (optional)]{Prompt}{Baseline}{Intervention}
{
  % Cannot use empty lines inside the arguments
  \begin{tcolorbox}[left=1.5mm, right=1.5mm, top=1.5mm, bottom=1.5mm]
    \raggedright
    \small
    \ifx\relax#1\relax\else
      \begin{center}
        {\normalsize \textbf{\color{black} #1}}
      \end{center}
    \fi
    \textcolor{black}{\textbf{Prompt:} {\texttt{#2}}} \\[2pt]
    \textcolor{darkergreen}{\textbf{Generation (w/o TempPatch):} {\texttt{#3}}} \\[2pt]
    \textcolor{darkred}{\textbf{Generation (w/ TempPatch):} {\texttt{#4}}}
  \end{tcolorbox}
}{}



\title{\textit{Why Safeguarded Ships Run Aground?} Aligned Large Language Models' Safety Mechanisms Tend to Be Anchored in The Template Region}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\author{
Chak Tou Leong$^1$, Qingyu Yin$^{2}$, Jian Wang$^{1 \dagger}$, Wenjie Li$^{1 \dagger}$ \\
$^1$ Department of Computing, The Hong Kong Polytechnic University \\
$^2$ Zhejiang University \\
\texttt{chak-tou.leong@connect.polyu.hk} ~~
\texttt{qingyu.yin@zju.edu.cn} \\
\texttt{jian51.wang@polyu.edu.hk} ~~
\texttt{cswjli@comp.polyu.edu.hk}
}



%\author{
%  \textbf{First Author\textsuperscript{1}},
%  \textbf{Second Author\textsuperscript{1,2}},
%  \textbf{Third T. Author\textsuperscript{1}},
%  \textbf{Fourth Author\textsuperscript{1}},
%\\
%  \textbf{Fifth Author\textsuperscript{1,2}},
%  \textbf{Sixth Author\textsuperscript{1}},
%  \textbf{Seventh Author\textsuperscript{1}},
%  \textbf{Eighth Author \textsuperscript{1,2,3,4}},
%\\
%  \textbf{Ninth Author\textsuperscript{1}},
%  \textbf{Tenth Author\textsuperscript{1}},
%  \textbf{Eleventh E. Author\textsuperscript{1,2,3,4,5}},
%  \textbf{Twelfth Author\textsuperscript{1}},
%\\
%  \textbf{Thirteenth Author\textsuperscript{3}},
%  \textbf{Fourteenth F. Author\textsuperscript{2,4}},
%  \textbf{Fifteenth Author\textsuperscript{1}},
%  \textbf{Sixteenth Author\textsuperscript{1}},
%\\
%  \textbf{Seventeenth S. Author\textsuperscript{4,5}},
%  \textbf{Eighteenth Author\textsuperscript{3,4}},
%  \textbf{Nineteenth N. Author\textsuperscript{2,5}},
%  \textbf{Twentieth Author\textsuperscript{1}}
%\\
%\\
%  \textsuperscript{1}Affiliation 1,
%  \textsuperscript{2}Affiliation 2,
%  \textsuperscript{3}Affiliation 3,
%  \textsuperscript{4}Affiliation 4,
%  \textsuperscript{5}Affiliation 5
%\\
%  \small{
%    \textbf{Correspondence:} \href{mailto:email@domain}{email@domain}
%  }
%}

\begin{document}

\maketitle

% self-define the footnote symbol
\renewcommand{\thefootnote}{$\dagger$}
\footnotetext[1]{Corresponding authors.}
% reset footnote counter
\setcounter{footnote}{0}
\renewcommand{\thefootnote}{\arabic{footnote}}
%\footnotetext{$^\dagger$ Corresponding authors.}

\begin{abstract}

The safety alignment of large language models (LLMs) remains vulnerable, as their initial behavior can be easily jailbroken by even relatively simple attacks. Since infilling a fixed template between the input instruction and initial model output is a common practice for existing LLMs, we hypothesize that this template is a key factor behind their vulnerabilities: LLMs' safety-related decision-making overly relies on the aggregated information from the template region, which largely influences these models' safety behavior. We refer to this issue as \textit{template-anchored safety alignment}.
In this paper, we conduct extensive experiments and verify that template-anchored safety alignment is widespread across various aligned LLMs. Our mechanistic analyses demonstrate how it leads to models' susceptibility when encountering inference-time jailbreak attacks. Furthermore, we show that detaching safety mechanisms from the template region is promising in mitigating vulnerabilities to jailbreak attacks. We encourage future research to develop more robust safety alignment techniques that reduce reliance on the template region.

\end{abstract}

\input{Sections/1_intro}
\input{Sections/2_preliminary}
\input{Sections/3_rq1}
\input{Sections/4_rq2}
\input{Sections/5_rq3}
\input{Sections/6_related_works}

\section{Conclusion}

This work investigates template-anchored safety alignment (TASA), a widespread yet understudied phenomenon in aligned LLMs. We reveal how it relates to vulnerabilities during inference and suggest preliminary approaches to address this problem. Our work emphasizes the need to develop more robust safety alignment techniques that reduce the risk of learning potential shortcuts.




\section*{Limitations}


\textit{Limited Generalization.} While we have conducted systematic analysis on multiple mainstream models to demonstrate the widespread existence of the TASA issue, we acknowledge that this does not mean that all safety-aligned LLMs necessarily have significant TASA vulnerabilities. Our primary contribution lies in empirically demonstrating the existence of such vulnerabilities in real-world systems, rather than asserting their universality. Some aligned LLMs may actively or passively mitigate this issue through the following mechanisms: 1) Training data accidentally included defense patterns for relevant adversarial samples \cite{lyu2024keeping, zhang2024backtracking, qi2024safety}; 2) Feature suppression methods used in the safety alignment process happened to affect the activation conditions of the TASA trigger mechanism \cite{zou2024improving, rosati2024representation}; 3) The model scale has not reached the critical threshold for vulnerability to emerge.

\noindent\textit{Limited Solution.} As a direct response to the TASA issue analysis, in \Cref{sec:rq3} we attempt to detach the safety mechanism from the template region using activation steering \cite{leong2023self, zou2023representation, arditi2024refusal}. Since we haven't updated the model itself, we acknowledge that this method doesn't eliminate the learned safety shortcuts. We view this approach as a proof-of-concept for detachable safety mechanisms rather than a comprehensive solution. Building on our findings, robust mitigation may require systematic integration of adversarial defense patterns during training \cite{lyu2024keeping, zhang2024backtracking, qi2024safety}, or proactive suppression of shortcut-prone features during alignment \cite{zou2024improving, rosati2024representation}, which we leave for future work.

\section*{Ethic Statements}

This work reveals a new vulnerability in aligned LLMs, namely that LLMs' alignment may learn shortcut-based safety mechanisms, causing them to rely on information from template regions to make safety decisions. Although exposing new vulnerabilities could potentially be exploited by malicious actors, given that direct interference with information processing at template region can only be performed on white-box models, we believe the benefits of new insights into current safety alignment deficiencies far outweigh the risks. We hope these new findings will promote the development of more robust safety alignment methods.


% Bibliography entries for the entire Anthology, followed by custom entries
%\bibliography{anthology,custom}
% Custom bibliography entries only
\bibliography{custom,anthology}
\newpage
\appendix

\input{Sections/9_appendix}

\end{document}
