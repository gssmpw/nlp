\newcommand*\boldell{\pmb{\ell}}

\newcommand\lossIL{e}
\newcommand\loss{\ell}
\newcommand\lossB{\ensuremath{\boldell}}

\newcommand\Loss{\ensuremath{L}}
\newcommand\LossB{\ensuremath{\mathbi{L}}}

\newcommand\Policies{\ensuremath{\Pi}}
\newcommand\policy{\ensuremath{\pi}}
\newcommand\PoliciesDist{q}
\newcommand\PoliciesDistB{\mathbi{q}}
\newcommand\state{s}
\newcommand\stateB{\ensuremath{\hat{{\mathbi{\state}}}}}
\newcommand\stateDist{d}
\newcommand\stateDistB{\mathbi{d}}
\newcommand\transDynamics{\mathcal{P}}
\newcommand\reward{r}
\newcommand\Reward{R}
\newcommand\RFunc{R}

\newcommand\Pair{\mathcal{P}}

\newcommand\len{\mathcal{L}}
\newcommand\prob{{p}}

\newcommand\DFunc{D}
\newcommand\gradient{{g}}

\newcommand\VFunc{\ensuremath{\ensuremath{V}}}
\newcommand\Func{\ensuremath{\ensuremath{f}}}
\newcommand\QFunc{\ensuremath{\ensuremath{Q}}}
\newcommand\Adv{\mathbi{A}}
\newcommand\AFunc{\mathbi{A}}
\newcommand\pw{h}
\newcommand\pwB{\mathbi{h}}
\newcommand\PolicyAdviceMatrix{\mathcal{E}^{(t)}}

\newcommand\Indicator{\textit{I}}
\newcommand\queryProb{z}

\newcommand{\trollin}{\psi}

\def\mathbi#1{\textbf{\em #1}}
\newcommand\ipm{\mathbi{I}}
\newcommand\Evaluators{\Policies}
\newcommand\evaluator{\policy}
\newcommand\policyIndex{k}
\newcommand\modelIndex{j}
\newcommand\ModelsDist{w}%
\newcommand\ModelsDistB{\mathbi{w}}%


\newcommand\pd{\ensuremath{\hat{\clabel}}}
\newcommand\pdB{\ensuremath{\hat{{\mathbi{\clabel}}}}}

\newcommand\discFactor{\gamma}

\newcommand\qlb{\ensuremath{{\frac{1}{\sqrt{t}}}}}
\newcommand\constant{\ensuremath{C}}


\newcommand\Models{\ensuremath{\mathcal{F}}}
\newcommand\TasksNum{\ensuremath{k}}

\newcommand\ONum{\ensuremath{K}}

\newcommand\model{\ensuremath{f}}
\newcommand\instance{\ensuremath{\mathbi{x}}}
\newcommand\domInstance{\ensuremath{\mathcal{X}}}
\newcommand\domClabel{\ensuremath{\mathcal{Y}}}
\newcommand\stateSpace{\ensuremath{\mathcal{S}}}
\newcommand\action{\ensuremath{a}}
\newcommand\actionDist{\ensuremath{\mathbi{A}}}
\newcommand\actionSpace{\ensuremath{\mathcal{A}}}
\newcommand\trajectory{\ensuremath{\mathcal{\tau}}}
\newcommand\horizon{\ensuremath{T}}
\newcommand\ENum{\ensuremath{N}} %
\newcommand\eNum{\ensuremath{n}} %

\newcommand\mask{\text{mask}} 
\newcommand\tokenSeq{\ensuremath{\mathbf{X}}}
\newcommand\token{\ensuremath{{x}}}

\newcommand\rationale{\ensuremath{\mathcal{S}}}

\newcommand\molecular{\ensuremath{\mathcal{G}}}


\newcommand\threshold{\ensuremath{{\epsilon}}}

\newcommand\exploreProb{\ensuremath{{p}}}
\newcommand\dataset{\ensuremath{\mathcal{D}}}


\newcommand\RewardFunc{\ensuremath{r}}

\newcommand\Regret{\ensuremath{R}}
\newcommand\TotalExpCost{\ensuremath{J}}
\newcommand\clabel{y} %
\newcommand\clabelB{\mathbi{y}} %
\newcommand\Learner{\ensuremath{\mathcal{AL}}\xspace} 

\newcommand\critic{\ensuremath{{C}}\xspace} 
\newcommand\weight{\ensuremath{{W}}\xspace} 

\newcommand\MDP{\ensuremath{\mathcal{M}}}

\newcommand\corpus{\mathcal{C}}




\newcommand\adviceMatrix{\ensuremath{\mathbi{E}}}
\newcommand\adviceMatrixI{\ensuremath{\mathcal{E}}}%
\newcommand\adviceMatrixIB{\ensuremath{\mathbb{\mathcal{E}}}}
\newcommand\expectation{\ensuremath{\mathbb{E}}}
\newcommand\budget{\ensuremath{b}}

\newcommand\entropyF{\mathfrak{E}}

\newcommand\minpgap[1]{\ensuremath{\rho_{#1}}}

\newcommand\maxind[1]{\ensuremath{\text{maxind}(#1)}}

\renewcommand{\Pr}[1]{\ensuremath{\mathbb{P}\left[#1\right] }}
\newcommand{\Prover}[2]{\ensuremath{\mathbb{P}_{#1}\!\left[#2\right]}}

\newcommand{\expct}[1]{\mathbb{E}\left[#1\right]}
\newcommand{\expctover}[2]{\mathbb{E}_{#1}\!\left[#2\right]}
\newcommand\RationaleBuffer{\ensuremath{\mathcal{B}}}
\newcommand\MC{\ensuremath{{{MC}}}}
\newcommand\BON{\ensuremath{{{BON}}}}
\newcommand\BS{\ensuremath{{\text{Beam-Search}}}}


\newcommand{\abs}[1]{\left\vert#1\right\vert}
\def \argmax {\mathop{\rm arg\,max}}
\def \argmin {\mathop{\rm arg\,min}}

\newcommand\Gen{\ensuremath{\policy^{{G}}_{{\theta}}}}
\newcommand\Dis{\ensuremath{\mathcal{D}_{\phi}}}

\newcommand\Vocabulary{\ensuremath{\mathcal{V}}}
\newcommand\maskedTokens{\ensuremath{\mathbf{M}}}
\newcommand\unmaskedTokens{\ensuremath{\mathbf{S}}}

\newcommand\likelihood{\ensuremath{\mathcal{L}}}

\newcommand\CNum{\ensuremath{\mathcal{K}}} %

\newcommand{\LLM}{\textsc{LLMs}\xspace}
\newcommand{\TOPK}{\textsc{Top-K}\xspace}
\newcommand{\TOPP}{\textsc{Top-P}\xspace}
\newcommand{\TOPPK}{\textsc{Top-PK}\xspace}
\newcommand{\hypothesis}{\mathcal{Y}}


\newcommand\Buffer{\ensuremath{\mathcal{B}}}


\newcommand\fm{\ensuremath{\mathbb{\psi}}}


\newcommand{\algname}{\textsc{ControllableGPT}\xspace}

\newcommand{\fwname}{\textsc{DrugImproverLLM}\xspace} %

\newcommand{\algRecommend}{\textsc{Recommend}\xspace}

\newif\iffinal
\finaltrue

\iffinal
    \newcommand{\fix}[1]{#1}
    \newcommand{\note}[1]{}
    \newcommand{\pref}[1]{}
    \newcommand{\XL}[1]{}
    \newcommand{\SJ}[1]{}
    \newcommand{\XLinline}[1]{}
    \newcommand{\SJinline}[1]{}
\else
    \newcommand{\fix}[1]{{\color{red} #1}}
    \newcommand{\SJ}[1]{\todo[fancyline,color=Green!40]{SJ: #1}\xspace}
    
    \newcommand{\XL}[1]{\todo[fancyline,color=Maroon!40]{XL: #1}\xspace}
    \newcommand{\XLinline}[1]{\textcolor{Maroon}{[XL: #1]}}
    \newcommand{\SJinline}[1]{\textcolor{Green}{[SJ: #1]}}
    \newcommand{\FF}[1]{\todo[fancyline,color=ForestGreen!40]{FX: #1}\xspace}
    \newcommand{\note}[1]{{\color{purple}[XL: #1]}}
    \newcommand{\question}[1]{\todo[fancyline,color=Maroon!40]{XL: #1}\xspace}
    \newcommand{\pref}[1]{{\color{blue}(\ref{#1})}}
\fi
    


\newcommand{\NonNegativeReals}{\ensuremath{\mathbb{R}_{\ge 0}}}
\newcommand{\PositiveIntegers}{\ensuremath{\mathbb{Z^+}}}
\newcommand{\integers}{\ensuremath{\mathbb{Z}}}
\newcommand{\nats}{\ensuremath{\mathbb{N}}}
\newcommand{\reals}{\ensuremath{\mathbb{R}}}
\newcommand{\rationals}{\ensuremath{\mathbb{Q}}}
\newcommand{\distrib}[0]{\ensuremath{\mathcal{D}}}
\newcommand{\matroid}{\ensuremath{\mathcal{M}}}

\newcommand{\defref}[1]{Definition~\ref{#1}}
\newcommand{\tabref}[1]{Table~\ref{#1}}
\newcommand{\figref}[1]{Fig.~\ref{#1}}
\newcommand{\eqnref}[1]{\text{Eq.}~(\ref{#1})}
\newcommand{\secref}[1]{\S\ref{#1}}
\newcommand{\appref}[1]{Appendix~\ref{#1}}
\newcommand{\thmref}[1]{Theorem~\ref{#1}}
\newcommand{\corref}[1]{Corollary~\ref{#1}}
\newcommand{\propref}[1]{Proposition~\ref{#1}}
\newcommand{\lemref}[1]{Lemma~\ref{#1}}
\newcommand{\conref}[1]{Condition~\ref{#1}}
\newcommand{\assref}[1]{Assumption~\ref{#1}}
\newcommand{\egref}[1]{Example~\ref{#1}}
\newcommand{\algoref}[1]{Algorithm~\ref{#1}}


\newcommand{\op}[1]{\operatorname{#1}}
\newcommand{\paren} [1] {\ensuremath{ \left( {#1} \right) }}
\newcommand{\parenb} [1] {\ensuremath{ \big( {#1} \big) }}
\newcommand{\bigparen} [1] {\ensuremath{ \Big( {#1} \Big) }}
\newcommand{\biggparen} [1] {\ensuremath{ \bigg( {#1} \bigg) }}
\newcommand{\Biggparen} [1] {\ensuremath{ \Bigg( {#1} \Bigg) }}
\newcommand{\bracket}[1]{\left[#1\right]}
\newcommand{\tuple}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\curlybracket}[1]{\ensuremath{\left\{#1\right\}}}
\newcommand{\condcurlybracket}[2]{\ensuremath{\left\{#1\left\lvert\:#2\right.\right\}}}




\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}



\newcommand{\stochastic}{\textcolor{ForestGreen}{\textsc{stochastic}}}
\newcommand{\adversarial}{\textcolor{Maroon}{\textsc{adversarial}}}
\newcommand{\Cost}{C}

\newcommand{\numTotalPolicies}{m}


\newcommand{\bigO}{O}