% \begin{algorithm}[t]
%   \caption{\text{\name}'s Load Balancer}
%   \label{alg:load_balancer}
%   \begin{algorithmic}[1]
%     \State when an async event E notifies scheduler
%     \If{job \textit{j} arrives}
%         \State Set \textit{j.max$\_$waiting} to $w(j)=C$
%         \State Add \textit{j} to queue
%     \EndIf
%     \If{job \textit{j} arrives \textbf{or}  job \textit{j} finishes on cluster}
%         \For{job \textit{k} in queue} 
%             \If{\textit{k} can fit in the cluster}
%                 \State Allocate job to cluster
%                 \State Remove \textit{k} from queue
%             \Else
%             \State \textbf{break}
%             \EndIf
%         \EndFor
%     \EndIf
%     \If{job $j$ times out}
%         \State Remove \textit{j} from queue
%         \State Provision new cloud instance
%         \State Allocate job to the new cloud instance
%     \EndIf
%   \end{algorithmic}
%   \vspace{0.5em}
% \hrule

% \end{algorithm}

\begin{algorithm}[t]
    \small
    \caption{\text{\name}'s Load Balancer}
    \label{algorithm:load_balancer}
    \begin{algorithmic}[1]

    \Procedure{Load\_Balancer}{\textbf{Call} $\text{c}$, \textbf{Table} $pt$, \textbf{List} $\text{Engines}$}
        \If{$\Call{Len}{\text{c.tokens}} \leq 2048$} \Comment{Small request} 
            \State $\text{assigned\_engine} = \Call{Least\_Used}{\text{Engines}}$ 
        \Else
            \If{$\text{c.pid} \in pt$} \Comment{Program already assigned to engine} 
                \State $\text{assigned\_engine} = pt[\text{c.pid}]$ 
            \Else
                \State \textcolor{cyan}{// Select the least utilized engine} 
                \State $\text{assigned\_engine} = \Call{Least\_Used}{\text{Engines}}$ 
                \State $pt[\text{c.pid}] = \text{assigned\_engine}$ 
            \EndIf
        \EndIf
    
        \State \Return $\text{assigned\_engine}$
    \EndProcedure
    
    \Procedure{Least\_Used}{\textbf{List} $\text{Engines}$}
        \State \textcolor{cyan}{// Query engine workloads in parallel} 
        \State $\text{workloads} = \Call{Query\_Engine\_Workloads}{\text{Engines}}$
        \State $\text{least\_used\_engine} = \Call{Argmin}{\text{workloads}}$ 
        \State \Return $\text{least\_used\_engine}$
    \EndProcedure
    \end{algorithmic}
\end{algorithm}