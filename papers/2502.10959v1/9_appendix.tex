

\appendix
% \FloatBarrier
\clearpage




\section{Supplement Results}

% \noindent\textbf{Proof of Lemma 3.1.} In the following, we prove the correctness of Lemma 3.1:

% \emph{Proof.} In the dependency graph, each node $Q_x$ represents a query, and an edge from $Q_x$ to $Q_y$ indicates that an operation $o_x \in Q_x$ conflicts with $o_y \in Q_y$, and $o_x$ precedes $o_y$ in execution. Operations $o_x$ and $o_y$ conflict if they act on the same object and at least one is a write. Queries are conflict serializable \emph{iff} the dependency graph is acyclic. Since DGS maintains the serializability of write queries, the dependency graph formed by them is acyclic. Ensuring $Q$ has a consistent view of $G_i$ guarantees that all operations in $Q$ depend only on operations from preceding write queries. Thus, the node representing $Q$ in the dependency graph has no incoming edges. Therefore, the combined dependency graph of read and write queries remains acyclic, proving the queries are conflict serializable.

% \noindent\textbf{Efficiency of Vertex Indexes.} Figure \ref{fig:vertex_index_performances} presents the results for three vertex indexes listed in Table \ref{tab:summary_methods}. For search efficiency, the dynamic array achieves speedups of over 2.6x compared to the hash table and two orders of magnitude compared to the AVL tree. Since \textsc{SearchVtx} is a step in graph operations on edges, this difference can significantly affect edge operations. Vertices are inserted in vertex ID order since existing methods incrementally assign vertex IDs from 0, as discussed in Section \ref{sec:preliminaries}. The throughput of the dynamic array is approximately 2x and 8x higher than the hash table and AVL tree, respectively. The AVL tree is very slow because it copies the path for multiple graph snapshots. For scan operations, dynamic arrays are 4x faster than counterparts.

% % \sun{[TODO: Add one sentence to describe the scan efficiency.]} 


% \begin{figure}[h]
% 	\setlength{\abovecaptionskip}{0pt}
% 	\setlength{\belowcaptionskip}{0pt}
% 		\captionsetup[subfigure]{aboveskip=0pt,belowskip=0pt}
% 	\centering
%     \includegraphics[width=0.6\textwidth]{img/exp_figs/figure13/legend.pdf}
    
%     \begin{subfigure}[t]{0.20\textwidth}
%     		\centering
%     		\includegraphics[width=\textwidth]{img/exp_figs/figure13/search.pdf}
%     		\caption{\textsc{SearchVtx}.}
%     		\label{fig:vertex_search_performance}
%     \end{subfigure}  
%     \begin{subfigure}[t]{0.20\textwidth}
%     		\centering
%     		\includegraphics[width=\textwidth]{img/exp_figs/figure13/insert.pdf}
%     		\caption{\textsc{InsVtx}.}
%     		\label{fig:vertex_insert_performance}
%     \end{subfigure}
%     \begin{subfigure}[t]{0.20\textwidth}
%     		\centering
%     		\includegraphics[width=\textwidth]{img/exp_figs/figure13/scan.pdf}
%     		\caption{\textsc{ScanVtx}.}
%     		\label{fig:vertex_scan_performance}
%     \end{subfigure}     
%     \caption{Efficiency of vertex indexes.}
%     \label{fig:vertex_index_performances}
% \end{figure}

% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
% \small
% \begin{table}[ht]
% \caption{\sun{Hardware metrics on \textsc{ScanNbr} with $|N(v)| = 2^{20}$ and $|B| = 256$. Lg, Ap, Ts, and Sl represent LiveGraph, Aspen, Teseo, and Sortledton, respectively.}}
% % \resizebox{\columnwidth}{!}{%
% \begin{tabular}{|c|cc|ccc|}
% \hline
%             & \multicolumn{2}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Continuous Neighbor Index\end{tabular}}} & \multicolumn{3}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Segmented Neighbor Index\end{tabular}}}             \\ \hline
% \textbf{Metric} &
%   \multicolumn{1}{c|}{\textbf{AdjLst}} &
%   \textbf{Lg} &
%   \multicolumn{1}{c|}{\textbf{Ap}} &
%   \multicolumn{1}{c|}{\textbf{Ts}} &
%   \textbf{Sl} \\ \hline
% L1 miss     & \multicolumn{1}{c|}{2.57e8}           & 2.53e8          & \multicolumn{1}{c|}{2.38e8} & \multicolumn{1}{c|}{2.65e8} & 5.48e8 \\ \hline
% L2 miss     & \multicolumn{1}{c|}{1.35e8}           & 2.38e8          & \multicolumn{1}{c|}{1.82e8} & \multicolumn{1}{c|}{2.15e8} & 2.86e8 \\ \hline
% LLC miss    & \multicolumn{1}{c|}{1.34e8}           & 1.34e8          & \multicolumn{1}{c|}{1.84e8} & \multicolumn{1}{c|}{2.15e8} & 2.38e8 \\ \hline
% DTLB miss   & \multicolumn{1}{c|}{1.19e4}           & 1.20e4          & \multicolumn{1}{c|}{1.94e6} & \multicolumn{1}{c|}{4.20e6} & 4.32e6 \\ \hline
% Branch miss & \multicolumn{1}{c|}{1.20e3}           & 2.23e3                 & \multicolumn{1}{c|}{7.90e6} & \multicolumn{1}{c|}{1.50e3} & 6.24e6 \\ \hline
% \begin{tabular}[c]{@{}c@{}}Instruction Number\end{tabular} &
%   \multicolumn{1}{c|}{1.07e9} &
%   1.61e9 &
%   \multicolumn{1}{c|}{7.57e9} &
%   \multicolumn{1}{c|}{1.14e9} &
%    1.18e10 \\ \hline
% \end{tabular}%
% % }
% \label{tab:hardware performance}
% \end{table}


% \noindent\sun{\textbf{Hardware Metrics on \textsc{ScanNbr}.} Table \ref{tab:hardware performance} presents hardware utilization for competing methods on \textsc{ScanNbr}. We specifically measure cache misses (L1, L2, LLC, and DTLB), branch mispredictions, and number of instructions. Segmented neighbor indexes incur more cache misses than continuous methods due to their non-contiguous memory layout. Particularly, benefiting from continuous storage, AdjLst and LiveGraph have much fewer DTLB misses than counterparts. Additionally, the number of instructions are higher for segmented methods, reflecting the complexity of managing multiple segments during traversal. Branch mispredictions are also more frequent in segmented indexes, leading to performance penalties from pipeline stalls. These factors together result in higher overhead for segmented neighbor indexes during scanning.}
% \small
% \begin{table}[]
% \label{tab:hardware tc}
% \caption{{Hardware metrics on triangle counting with $|N(v)| = 2^{20}$ and $|B| = 256$. Lg, Ap, Ts, and Sl represent LiveGraph, Aspen, Teseo, and Sortledton, respectively.}}
% \begin{tabular}{|cc|cc|ccccc|}
% \hline
% \multicolumn{2}{|c|}{}                                                                        & \multicolumn{2}{c|}{\textbf{Continuous Neighbor Index}}                               & \multicolumn{5}{c|}{\textbf{Segmented Neighbor Index}}                                                                                               \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{\textbf{Metric}}}    & \multirow{2}{*}{\textbf{Dataset}} & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{CSR}}} & \multirow{2}{*}{\textbf{AdjLst}} & \multicolumn{2}{c|}{\textbf{Ap}}                          & \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Ts}}} & \multicolumn{2}{c|}{\textbf{Sl}}     \\ \cline{5-6} \cline{8-9} 
% \multicolumn{1}{|c|}{}                                    &                                   & \multicolumn{1}{c|}{}                              &                                  & \multicolumn{1}{c|}{w}      & \multicolumn{1}{c|}{wo}     & \multicolumn{1}{c|}{}                             & \multicolumn{1}{c|}{w}      & wo     \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{L1 miss}}            & \emph{lj}            & \multicolumn{1}{c|}{0.07}                          & 0.14                             & \multicolumn{1}{c|}{0.19}   & \multicolumn{1}{c|}{0.70}   & \multicolumn{1}{c|}{0.23}                         & \multicolumn{1}{c|}{0.16}   & 0.20   \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{2.35}                          & 3.00                             & \multicolumn{1}{c|}{24.44}  & \multicolumn{1}{c|}{19.93}  & \multicolumn{1}{c|}{7.78}                         & \multicolumn{1}{c|}{8.52}   & 8.61   \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{L2 miss}}            & \emph{lj}            & \multicolumn{1}{c|}{0.93}                          & 1.01                             & \multicolumn{1}{c|}{1.28}   & \multicolumn{1}{c|}{1.86}   & \multicolumn{1}{c|}{1.37}                         & \multicolumn{1}{c|}{1.15}   & 1.27   \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{53.86}                         & 56.33                            & \multicolumn{1}{c|}{93.33}  & \multicolumn{1}{c|}{100.53} & \multicolumn{1}{c|}{109.50}                       & \multicolumn{1}{c|}{111.48} & 112.92 \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{LLC miss}}           & \emph{lj}            & \multicolumn{1}{c|}{0.65}                          & 0.74                             & \multicolumn{1}{c|}{0.83}   & \multicolumn{1}{c|}{1.18}   & \multicolumn{1}{c|}{1.11}                         & \multicolumn{1}{c|}{0.76}   & 1.00   \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{31.63}                         & 31.96                            & \multicolumn{1}{c|}{62.87}  & \multicolumn{1}{c|}{66.15}  & \multicolumn{1}{c|}{68.99}                        & \multicolumn{1}{c|}{69.19}  & 71.77  \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{DTLB miss}}          & \emph{lj}            & \multicolumn{1}{c|}{5.76}                          & 10.67                            & \multicolumn{1}{c|}{13.70}  & \multicolumn{1}{c|}{23.67}  & \multicolumn{1}{c|}{14.42}                        & \multicolumn{1}{c|}{12.45}  & 13.60  \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{97.34}                         & 137.09                           & \multicolumn{1}{c|}{336.05} & \multicolumn{1}{c|}{441.16} & \multicolumn{1}{c|}{211.64}                       & \multicolumn{1}{c|}{380.34} & 237.88 \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{Branch miss}}        & \emph{lj}            & \multicolumn{1}{c|}{0.85}                          & 0.85                             & \multicolumn{1}{c|}{0.84}   & \multicolumn{1}{c|}{1.27}   & \multicolumn{1}{c|}{0.82}                         & \multicolumn{1}{c|}{0.80}   & 0.79   \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{67.98}                         & 63.01                            & \multicolumn{1}{c|}{64.59}  & \multicolumn{1}{c|}{64.73}  & \multicolumn{1}{c|}{65.75}                        & \multicolumn{1}{c|}{63.33}  & 61.34  \\ \hline
% \multicolumn{1}{|c|}{\multirow{2}{*}{Instruction number}} & \emph{lj}            & \multicolumn{1}{c|}{31.44}                         & 31.93                            & \multicolumn{1}{c|}{60.00}  & \multicolumn{1}{c|}{75.00}  & \multicolumn{1}{c|}{32.62}                        & \multicolumn{1}{c|}{44.27}  & 56.05  \\ \cline{2-9} 
% \multicolumn{1}{|c|}{}                                    & \emph{g5}            & \multicolumn{1}{c|}{6929}                          & 6932                             & \multicolumn{1}{c|}{10778}  & \multicolumn{1}{c|}{10900}  & \multicolumn{1}{c|}{6976}                         & \multicolumn{1}{c|}{12020}  & 12075  \\ \hline
% \end{tabular}

% \end{table}

% \vspace{2pt}
% \noindent\sun{\textbf{Hardware Metrics on TC.} Table \ref{tab:hardware tc} presents hardware metrics for TC, including cache misses (L1, L2, LLC, and DTLB), branch mispredictions, and number of instructions. Segmented neighbor indexes result in higher cache misses and increased instruction counts. Adaptive indexing mechanisms reduce LLC misses by 28\% and 3.5\% on dataset \emph{lj} and \emph{g5}, respectively, while flatten optimizations lower LLC cache misses by 31.3\% and 49.2\% along with a decrease in DTLB misses by 42.1\% and 23.8\%.}

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
% Please add the following required packages to your document preamble:
% \usepackage{multirow}

\noindent\textbf{Graph Analytics Query.} We present the experiment results of the graph containers on three graph analytics queries: BFS, SSSP, and WCC. Aspen-w enables the flatten optimization, and Sortledton-w enables adaptive indexing with the threshold set to 256.
\small
\begin{table}[h]
\caption{Comparison of analytical queries (in seconds). Lg, Ap, Ts and Sl denote LiveGraph, Aspen, Teseo and Sortledton, respectively.}
\label{tab:performance_comparison_containers_appendix}
% \resizebox{\columnwidth}{!}{
\centering
\begin{tabular}{|c|ccc|ccccc|}
\hline
 &
  \multicolumn{3}{c|}{\textbf{Continuous Neighbor Index}} &
  \multicolumn{5}{c|}{\textbf{Segmented Neighbor Index}} \\ \hline
\multirow{2}{*}{\textbf{Dataset}} &
  \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{CSR}}} &
  \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{AdjLst}}} &
  \multirow{2}{*}{\textbf{Lg}} &
  \multicolumn{2}{c|}{\textbf{Ap}} &
  \multicolumn{1}{c|}{\multirow{2}{*}{\textbf{Ts}}} &
  \multicolumn{2}{c|}{\textbf{Sl}} \\ \cline{5-6} \cline{8-9} 
 &
  \multicolumn{1}{c|}{} &
  \multicolumn{1}{c|}{} &
   &
  \multicolumn{1}{c|}{w} &
  \multicolumn{1}{c|}{wo} &
  \multicolumn{1}{c|}{} &
  \multicolumn{1}{c|}{w} &
  wo \\ \hline
\textbf{BFS} &
  \multicolumn{3}{c|}{} &
  \multicolumn{5}{c|}{} \\ \hline
\emph{lj} &
  \multicolumn{1}{c|}{\textbf{0.56}} &
  \multicolumn{1}{c|}{0.82} &
  1.57 &
  \multicolumn{1}{c|}{\textbf{1.43}} &
  \multicolumn{1}{c|}{3.15} &
  \multicolumn{1}{c|}{2.03} &
  \multicolumn{1}{c|}{1.89} &
  2.94 \\ \hline
\emph{dl} &
  \multicolumn{1}{c|}{\textbf{0.01}} &
  \multicolumn{1}{c|}{\textbf{0.01}} &
  0.02 &
  \multicolumn{1}{c|}{0.03} &
  \multicolumn{1}{c|}{0.04} &
  \multicolumn{1}{c|}{\textbf{0.02}} &
  \multicolumn{1}{c|}{0.03} &
  0.03 \\ \hline
\emph{ldbc} &
  \multicolumn{1}{c|}{\textbf{2.68}} &
  \multicolumn{1}{c|}{4.18} &
  5.41 &
  \multicolumn{1}{c|}{\textbf{6.60}} &
  \multicolumn{1}{c|}{14.87} &
  \multicolumn{1}{c|}{11.30} &
  \multicolumn{1}{c|}{6.61} &
  16.62 \\ \hline
\emph{g5} &
  \multicolumn{1}{c|}{\textbf{2.00}} &
  \multicolumn{1}{c|}{3.06} &
  5.68 &
  \multicolumn{1}{c|}{3.76} &
  \multicolumn{1}{c|}{7.57} &
  \multicolumn{1}{c|}{\textbf{3.33}} &
  \multicolumn{1}{c|}{4.07} &
  6.33 \\ \hline
\emph{wk} &
  \multicolumn{1}{c|}{\textbf{1.19}} &
  \multicolumn{1}{c|}{1.61} &
  2.21 &
  \multicolumn{1}{c|}{\textbf{2.46}} &
  \multicolumn{1}{c|}{6.08} &
  \multicolumn{1}{c|}{4.03} &
  \multicolumn{1}{c|}{2.71} &
  4.96 \\ \hline
\emph{ct} &
  \multicolumn{1}{c|}{\textbf{0.44}} &
  \multicolumn{1}{c|}{0.85} &
  1.62 &
  \multicolumn{1}{c|}{\textbf{1.54}} &
  \multicolumn{1}{c|}{3.17} &
  \multicolumn{1}{c|}{2.37} &
  \multicolumn{1}{c|}{1.57} &
  4.55 \\ \hline
\emph{tw} &
  \multicolumn{1}{c|}{\textbf{2.92}} &
  \multicolumn{1}{c|}{4.40} &
  5.92 &
  \multicolumn{1}{c|}{6.88} &
  \multicolumn{1}{c|}{14.55} &
  \multicolumn{1}{c|}{9.02} &
  \multicolumn{1}{c|}{\textbf{6.59}} &
  15.52 \\ \hline
\emph{nft} &
  \multicolumn{1}{c|}{\textbf{2.50}} &
  \multicolumn{1}{c|}{4.53} &
  5.78 &
  \multicolumn{1}{c|}{6.70} &
  \multicolumn{1}{c|}{15.44} &
  \multicolumn{1}{c|}{11.48} &
  \multicolumn{1}{c|}{\textbf{6.34}} &
  15.11 \\ \hline
\textbf{SSSP} &
  \multicolumn{3}{c|}{} &
  \multicolumn{5}{c|}{} \\ \hline
\emph{lj} &
  \multicolumn{1}{c|}{\textbf{1.42}} &
  \multicolumn{1}{c|}{2.18} &
  2.36 &
  \multicolumn{1}{c|}{\textbf{2.81}} &
  \multicolumn{1}{c|}{7.23} &
  \multicolumn{1}{c|}{2.82} &
  \multicolumn{1}{l|}{2.84} &
  \multicolumn{1}{l|}{3.96} \\ \hline
\emph{dl} &
  \multicolumn{1}{c|}{\textbf{0.17}} &
  \multicolumn{1}{c|}{0.23} &
  0.26 &
  \multicolumn{1}{c|}{0.69} &
  \multicolumn{1}{c|}{0.71} &
  \multicolumn{1}{c|}{\textbf{0.34}} &
  \multicolumn{1}{l|}{0.58} &
  \multicolumn{1}{l|}{0.67} \\ \hline
\emph{ldbc} &
  \multicolumn{1}{c|}{\textbf{6.36}} &
  \multicolumn{1}{c|}{8.65} &
  9.17 &
  \multicolumn{1}{c|}{11.58} &
  \multicolumn{1}{c|}{36.42} &
  \multicolumn{1}{c|}{15.46} &
  \multicolumn{1}{l|}{\textbf{9.99}} &
  \multicolumn{1}{l|}{21.69} \\ \hline
\emph{g5} &
  \multicolumn{1}{c|}{\textbf{4.25}} &
  \multicolumn{1}{c|}{5.78} &
  10.00 &
  \multicolumn{1}{c|}{7.75} &
  \multicolumn{1}{c|}{14.68} &
  \multicolumn{1}{c|}{\textbf{6.46}} &
  \multicolumn{1}{l|}{7.50} &
  \multicolumn{1}{l|}{9.61} \\ \hline
\emph{wk} &
  \multicolumn{1}{c|}{\textbf{1.88}} &
  \multicolumn{1}{c|}{2.44} &
  3.56 &
  \multicolumn{1}{c|}{3.58} &
  \multicolumn{1}{c|}{7.71} &
  \multicolumn{1}{c|}{4.38} &
  \multicolumn{1}{l|}{\textbf{3.42}} &
  \multicolumn{1}{l|}{5.61} \\ \hline
\emph{ct} &
  \multicolumn{1}{c|}{\textbf{0.79}} &
  \multicolumn{1}{c|}{1.64} &
  1.45 &
  \multicolumn{1}{c|}{1.83} &
  \multicolumn{1}{c|}{4.65} &
  \multicolumn{1}{c|}{1.79} &
  \multicolumn{1}{l|}{\textbf{1.68}} &
  \multicolumn{1}{l|}{2.78} \\ \hline
\emph{tw} &
  \multicolumn{1}{c|}{\textbf{6.71}} &
  \multicolumn{1}{c|}{10.03} &
  11.30 &
  \multicolumn{1}{c|}{13.62} &
  \multicolumn{1}{c|}{32.49} &
  \multicolumn{1}{c|}{\textbf{12.67}} &
  \multicolumn{1}{l|}{12.09} &
  \multicolumn{1}{l|}{17.81} \\ \hline
\emph{nft} &
  \multicolumn{1}{c|}{\textbf{4.55}} &
  \multicolumn{1}{c|}{6.66} &
  8.31 &
  \multicolumn{1}{c|}{8.79} &
  \multicolumn{1}{c|}{31.42} &
  \multicolumn{1}{c|}{12.20} &
  \multicolumn{1}{l|}{\textbf{7.28}} &
  \multicolumn{1}{l|}{24.61} \\ \hline
\textbf{WCC} &
  \multicolumn{3}{c|}{} &
  \multicolumn{5}{c|}{} \\ \hline
\emph{lj} &
  \multicolumn{1}{c|}{\textbf{1.95}} &
  \multicolumn{1}{c|}{3.02} &
  3.76 &
  \multicolumn{1}{c|}{4.15} &
  \multicolumn{1}{c|}{5.82} &
  \multicolumn{1}{c|}{\textbf{4.14}} &
  \multicolumn{1}{c|}{4.76} &
  8.39 \\ \hline
\emph{dl} &
  \multicolumn{1}{c|}{\textbf{0.29}} &
  \multicolumn{1}{c|}{0.29} &
  0.42 &
  \multicolumn{1}{c|}{0.85} &
  \multicolumn{1}{c|}{0.86} &
  \multicolumn{1}{c|}{\textbf{0.45}} &
  \multicolumn{1}{c|}{0.94} &
  1.04 \\ \hline
\emph{ldbc} &
  \multicolumn{1}{c|}{\textbf{5.73}} &
  \multicolumn{1}{c|}{6.76} &
  6.93 &
  \multicolumn{1}{c|}{\textbf{9.72}} &
  \multicolumn{1}{c|}{15.03} &
  \multicolumn{1}{c|}{15.34} &
  \multicolumn{1}{c|}{10.48} &
  29.48 \\ \hline
\emph{g5} &
  \multicolumn{1}{c|}{\textbf{4.88}} &
  \multicolumn{1}{c|}{6.04} &
  10.53 &
  \multicolumn{1}{c|}{8.12} &
  \multicolumn{1}{c|}{11.10} &
  \multicolumn{1}{c|}{\textbf{6.60}} &
  \multicolumn{1}{c|}{9.95} &
  16.14 \\ \hline
\emph{wk} &
  \multicolumn{1}{c|}{\textbf{1.22}} &
  \multicolumn{1}{c|}{1.68} &
  2.76 &
  \multicolumn{1}{c|}{\textbf{2.96}} &
  \multicolumn{1}{c|}{5.61} &
  \multicolumn{1}{c|}{5.19} &
  \multicolumn{1}{c|}{3.37} &
  7.85 \\ \hline
\emph{ct} &
  \multicolumn{1}{c|}{\textbf{0.97}} &
  \multicolumn{1}{c|}{2.27} &
  2.13 &
  \multicolumn{1}{c|}{\textbf{2.45}} &
  \multicolumn{1}{c|}{3.51} &
  \multicolumn{1}{c|}{3.46} &
  \multicolumn{1}{c|}{2.84} &
  5.71 \\ \hline
\emph{tw} &
  \multicolumn{1}{c|}{\textbf{10.48}} &
  \multicolumn{1}{c|}{12.55} &
  15.31 &
  \multicolumn{1}{c|}{\textbf{17.84}} &
  \multicolumn{1}{c|}{24.15} &
  \multicolumn{1}{c|}{18.62} &
  \multicolumn{1}{c|}{20.27} &
  41.14 \\ \hline
\emph{nft} &
  \multicolumn{1}{c|}{\textbf{4.22}} &
  \multicolumn{1}{c|}{5.83} &
  7.90 &
  \multicolumn{1}{c|}{\textbf{8.77}} &
  \multicolumn{1}{c|}{17.95} &
  \multicolumn{1}{c|}{16.00} &
  \multicolumn{1}{c|}{9.70} &
  33.28 \\ \hline
\end{tabular}
% }
\end{table}

Figure \ref{tab:performance_comparison_containers_appendix} illustrates the performance of graph containers on various graph analytic queries, including BFS, SSSP, and WCC. In all three datasets, continuous methods exhibit superior performance compared to segmented methods due to their rapid scan speed. Among the segmented methods, Teseo demonstrates the best performance among methods without optimizations. Enabling adaptive indexing significantly enhances speed, achieving a speedup of 1.1-3.4 times. As a result, Sortledton-w outperforms its counterparts in 15 out of 24 cases, despite having lower scan and search efficiency compared to Teseo. Additionally, enabling flatten optimization improves performance by 1.0-3.6 times. Nevertheless, CSR consistently achieves a speedup of 1.3-3.5 times over the best segmented methods in each scenario.

\vspace{2pt}
\noindent\textbf{Graph Operations Latency.} To compare the quality of service, we measure the graph operation latency during concurrent execution. Specifically, we execute 32 threads where four threads conduct insert operations, eight threads conduct search operations, and twenty threads conduct scan operations. We configure four insert threads because graph workloads are generally read-intensive, and competing methods have limited scalability for insert operations.



\begin{table}[h]
\caption{Mean, max and tail latency of search operations (100 operations).}
\label{tab:search_tail_latency}
% \resizebox{0.45\textwidth}{!}{%
% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}
\begin{tabular}{|lc|ccccc|}
\hline
\multicolumn{2}{|l|}{\multirow{2}{*}{}} &
  \multicolumn{5}{c|}{\textbf{Search}} \\ \cline{3-7} 
\multicolumn{2}{|l|}{} &
  \multicolumn{1}{c|}{\textbf{AdjLst}} &
  \multicolumn{1}{c|}{\textbf{LiveGraph}} &
  \multicolumn{1}{c|}{\textbf{Aspen}} &
  \multicolumn{1}{c|}{\textbf{Teseo}} &
  \multicolumn{1}{c|}{\textbf{Sortledton}} \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} &
  p50 &
  \multicolumn{1}{c|}{57} &
  \multicolumn{1}{c|}{135} &
  \multicolumn{1}{c|}{117} &
  \multicolumn{1}{c|}{66} &
  \textbf{54} \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{65} &
  \multicolumn{1}{c|}{173} &
  \multicolumn{1}{c|}{139} &
  \multicolumn{1}{c|}{72} &
  \textbf{61} \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{\textbf{71}} &
  \multicolumn{1}{c|}{200} &
  \multicolumn{1}{c|}{165} &
  \multicolumn{1}{c|}{78} &
  85 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{\textbf{105}} &
  \multicolumn{1}{c|}{280} &
  \multicolumn{1}{c|}{379} &
  \multicolumn{1}{c|}{134} &
  143 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{57} &
  \multicolumn{1}{c|}{138} &
  \multicolumn{1}{c|}{120} &
  \multicolumn{1}{c|}{66} &
  \textbf{55} \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} &
  p50 &
  \multicolumn{1}{c|}{\textbf{99}} &
  \multicolumn{1}{c|}{1,491} &
  \multicolumn{1}{c|}{188} &
  \multicolumn{1}{c|}{122} &
  201 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{\textbf{106}} &
  \multicolumn{1}{c|}{2,410} &
  \multicolumn{1}{c|}{197} &
  \multicolumn{1}{c|}{130} &
  225 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{\textbf{113}} &
  \multicolumn{1}{c|}{3,064} &
  \multicolumn{1}{c|}{208} &
  \multicolumn{1}{c|}{134} &
  235 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{\textbf{193}} &
  \multicolumn{1}{c|}{3,995} &
  \multicolumn{1}{c|}{458} &
  \multicolumn{1}{c|}{212} &
  362 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{\textbf{99}} &
  \multicolumn{1}{c|}{1,562} &
  \multicolumn{1}{c|}{189} &
  \multicolumn{1}{c|}{122} &
  202 \\ \hline
\end{tabular}%
% }
\end{table}

% Please add the following required packages to your document preamble:
\small
\begin{table}[h]
\caption{Mean, max and tail latency of insert operations (100 operations).}
\label{tab:insert_tail_latency}
% \resizebox{0.45\textwidth}{!}{%
\begin{tabular}{|lc|ccccc|}
\hline
\multicolumn{2}{|l|}{\multirow{2}{*}{}} &
  \multicolumn{5}{c|}{\textbf{Insert}} \\ \cline{3-7} 
\multicolumn{2}{|l|}{} &
  \multicolumn{1}{c|}{\textbf{AdjLst}} &
  \multicolumn{1}{c|}{\textbf{LiveGraph}} &
  \multicolumn{1}{c|}{\textbf{Aspen}} &
  \multicolumn{1}{c|}{\textbf{Teseo}} &
  \multicolumn{1}{c|}{\textbf{Sortledton}} \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} &
  p50 &
  \multicolumn{1}{c|}{166} &
  \multicolumn{1}{c|}{\textbf{151}} &
  \multicolumn{1}{c|}{1,093} &
  \multicolumn{1}{c|}{194} &
  174 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{206} &
  \multicolumn{1}{c|}{\textbf{168}} &
  \multicolumn{1}{c|}{2,060} &
  \multicolumn{1}{c|}{217} &
  204 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{220} &
  \multicolumn{1}{c|}{\textbf{177}} &
  \multicolumn{1}{c|}{2,825} &
  \multicolumn{1}{c|}{228} &
  245 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{\textbf{475}} &
  \multicolumn{1}{c|}{746} &
  \multicolumn{1}{c|}{17,835} &
  \multicolumn{1}{c|}{709} &
  757 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{166} &
  \multicolumn{1}{c|}{\textbf{152}} &
  \multicolumn{1}{c|}{1,184} &
  \multicolumn{1}{c|}{190} &
  175 \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} &
  p50 &
  \multicolumn{1}{c|}{1,397} &
  \multicolumn{1}{c|}{1,007} &
  \multicolumn{1}{c|}{1,688} &
  \multicolumn{1}{c|}{\textbf{281}} &
  304 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{2,979} &
  \multicolumn{1}{c|}{2,295} &
  \multicolumn{1}{c|}{2,822} &
  \multicolumn{1}{c|}{\textbf{316}} &
  368 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{3,595} &
  \multicolumn{1}{c|}{2,796} &
  \multicolumn{1}{c|}{3,189} &
  \multicolumn{1}{c|}{\textbf{367}} &
  414 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{6,545} &
  \multicolumn{1}{c|}{4,732} &
  \multicolumn{1}{c|}{7,853} &
  \multicolumn{1}{c|}{8,749} &
  \textbf{2,625} \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{1,467} &
  \multicolumn{1}{c|}{1,080} &
  \multicolumn{1}{c|}{1,763} &
  \multicolumn{1}{c|}{\textbf{275}} &
  291 \\ \hline
\end{tabular}%
% }
\end{table}

\small
\begin{table}[h]

\caption{Mean, max and tail latency of scan operations (100 operations).}
\label{tab:scan_tail_latency}
% \resizebox{0.45\textwidth}{!}{%
\begin{tabular}{|lc|ccccc|}
\hline
\multicolumn{2}{|l|}{\multirow{2}{*}{}} &
  \multicolumn{5}{c|}{\textbf{Scan}} \\ \cline{3-7} 
\multicolumn{2}{|l|}{} &
  \multicolumn{1}{c|}{\textbf{AdjLst}} &
  \multicolumn{1}{c|}{\textbf{LiveGraph}} &
  \multicolumn{1}{c|}{\textbf{Aspen}} &
  \multicolumn{1}{c|}{\textbf{Teseo}} &
  \multicolumn{1}{c|}{\textbf{Sortledton}} \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} &
  p50 &
  \multicolumn{1}{c|}{161} &
  \multicolumn{1}{c|}{225} &
  \multicolumn{1}{c|}{228} &
  \multicolumn{1}{c|}{\textbf{133}} &
  248 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{257} &
  \multicolumn{1}{c|}{458} &
  \multicolumn{1}{c|}{392} &
  \multicolumn{1}{c|}{\textbf{241}} &
  543 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{299} &
  \multicolumn{1}{c|}{895} &
  \multicolumn{1}{c|}{435} &
  \multicolumn{1}{c|}{\textbf{297}} &
  594 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{12,798} &
  \multicolumn{1}{c|}{1,038} &
  \multicolumn{1}{c|}{498} &
  \multicolumn{1}{c|}{\textbf{312}} &
  703 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{185} &
  \multicolumn{1}{c|}{263} &
  \multicolumn{1}{c|}{249} &
  \multicolumn{1}{c|}{\textbf{146}} &
  287 \\ \hline
\multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} &
  p50 &
  \multicolumn{1}{c|}{\textbf{3,336}} &
  \multicolumn{1}{c|}{9,228} &
  \multicolumn{1}{c|}{5,879} &
  \multicolumn{1}{c|}{5,404} &
  9,149 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p95 &
  \multicolumn{1}{c|}{\textbf{5,162}} &
  \multicolumn{1}{c|}{15,354} &
  \multicolumn{1}{c|}{8,701} &
  \multicolumn{1}{c|}{8,423} &
  13,722 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  p99 &
  \multicolumn{1}{c|}{\textbf{6,834}} &
  \multicolumn{1}{c|}{19,553} &
  \multicolumn{1}{c|}{10,422} &
  \multicolumn{1}{c|}{10,486} &
  17,961 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Max &
  \multicolumn{1}{c|}{11,332} &
  \multicolumn{1}{c|}{21,107} &
  \multicolumn{1}{c|}{\textbf{10,569}} &
  \multicolumn{1}{c|}{10,800} &
  18,533 \\ \cline{2-7} 
\multicolumn{1}{|l|}{} &
  Mean &
  \multicolumn{1}{c|}{\textbf{3,425}} &
  \multicolumn{1}{c|}{9,707} &
  \multicolumn{1}{c|}{5,936} &
  \multicolumn{1}{c|}{5,499} &
  9,249 \\ \hline
\end{tabular}%
% }
\end{table}

Tables \ref{tab:search_tail_latency}, \ref{tab:scan_tail_latency}, and \ref{tab:insert_tail_latency} present the experimental results on latency. 
For search latency, AdjLst outperforms all other methods on both datasets. Sortledton demonstrates strong performance on the \emph{lj} dataset, which features a smaller average degree, thereby benefiting from Sortledton's adaptive indexing. LiveGraph exhibits the worst performance on both datasets due to its requirement to scan neighbors.


For insert latency, Teseo generally outperforms other methods in most scenarios, as it often has empty slots available for new elements. However, its needing for periodic rebalancing leads to relatively high maximum latency. Sortledton exhibits lower maximum latency on the \emph{g5} dataset because its split operations are confined to a single block. LiveGraph performs well on the \emph{lj} dataset but poorly on the \emph{g5} dataset, as the bloom filter fails to be effective in large neighborhoods. Aspen's limitation of allowing only a single writer results in the worst insert latency.For scan latency, both AdjLst and Teseo exhibit strong performance due to their contiguous storage structure. In contrast, LiveGraph incurs relatively high latency as it scans from the end of the array. 

% We further compare performance variations during the insertion process. Due to the limited scalability of competing methods for insertions, we set the number of writers to 1. Figure \ref{fig:insert_latency_edge_insertion} shows the insert latency along the edge insertion process. Since \emph{lj} is sparse, AdjLst and LiveGraph generally outperform segmented methods, while they are slower on \emph{g5}, a dense graph. Aspen’s latency fluctuation is much smaller than that of other methods because 1) it uses a single writer and has no lock contention, and 2) the overhead of CoW on blocks is steady. The higher fluctuation in other methods is due to the expensive overhead of copying blocks and inserting into the skip list.

% \begin{figure}[h]
%     \setlength{\abovecaptionskip}{0pt}
%     \setlength{\belowcaptionskip}{0pt}
%     \captionsetup[subfigure]{aboveskip=0pt,belowskip=0pt}
%     \centering
%     \includegraphics[width=0.60\textwidth]{img/exp_figs/figure11/legend.pdf}\\
%     \begin{subfigure}[t]{0.30\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{img/exp_figs/figure11/insert_liveJournal.pdf}
%         \caption{Insert latency on \emph{lj}.}
%         \label{fig:insert_latency_lj}
%     \end{subfigure}
%     \begin{subfigure}[t]{0.30\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{img/exp_figs/figure11/insert_graph500.pdf}
%         \caption{Insert latency on \emph{g5}.}
%         \label{fig:insert_latency_g5}
%     \end{subfigure}
%     \caption{Insert latency for every 100 operations during the edge insertion process.}
%     \label{fig:insert_latency_edge_insertion}
% \end{figure}


% \vspace{2pt}
% \noindent\textbf{Analytic queries.} 



% \clearpage


\begin{figure}[h]
	\setlength{\abovecaptionskip}{0pt}
	\setlength{\belowcaptionskip}{0pt}
		\captionsetup[subfigure]{aboveskip=0pt,belowskip=0pt}
	\centering
    \includegraphics[width=0.60\textwidth]{img/exp_figs/efficiency_compare/legend.pdf}\\
    \begin{subfigure}[t]{0.20\textwidth}
    		\centering
    		\includegraphics[width=\textwidth]{img/exp_figs/efficiency_compare/get_edge_based_on_degree.pdf}
    		\caption{\textsc{SearchEdge}}
    		\label{fig:comparison_search}
    \end{subfigure}
    \begin{subfigure}[t]{0.20\textwidth}
    		\centering
    		\includegraphics[width=\textwidth]{img/exp_figs/efficiency_compare/insert_full.pdf}
    		\caption{\textsc{InsertEdge}}
    		\label{fig:comparison_insert}
    \end{subfigure}
    \begin{subfigure}[t]{0.20\textwidth}
    		\centering
    		\includegraphics[width=\textwidth]{img/exp_figs/efficiency_compare/scan_neighbor_based_on_degree.pdf}
    		\caption{\textsc{ScanNbr}}
    		\label{fig:comparison_scan}
    \end{subfigure}
    \caption{Comparison of efficiency with original implementations. Unshadowed denotes our implementation, and shadowed denotes the origin ones. Lg, Ap, Ts and Sl denote LiveGraph, Aspen, Teseo and Sortledton, respectively.}
    \label{fig:comparison_of_efficiency_with_origin}
\end{figure}

\vspace{2pt}
\noindent\textbf{Comparison of Efficiency with Original Implementation.} 
Figure \ref{fig:comparison_of_efficiency_with_origin} illustrates the comparison of search, insert, and scan efficiencies between our implementations and the original ones. Our implementations demonstrate either comparable or superior efficiency across the two datasets and three operations.
\small
\begin{table}[htbp]
\caption{Comparison of memory consumption with original implementation. 'M' denotes our implementation and 'O' denotes the original implementation. Lg, Ap, Ts and Sl denote LiveGraph, Aspen, Teseo and Sortledton, respectively.}
\label{tab:memory_comparison_with_origin}
% \resizebox{\columnwidth}{!}{%
\begin{tabular}{|l|l|ll|ll|ll|ll|}
\hline
  \textbf{Dataset}        & \textbf{CSR}  & \textbf{M-Lg} & \textbf{O-Lg}  & \textbf{M-Ap}  & \textbf{O-Ap}  & \textbf{M-Ts}  & \textbf{O-Ts}  & \textbf{M-Sl}  & \textbf{O-Sl}  \\ \hline
\emph{lj}   & 0.67 & 6.24  & 6.98  & 3.58  & 28.25 & 30.98 & 5.25  & 4.31  & 3.66  \\ \hline
\emph{dl}   & 0.76 & 3.71  & 6.35  & 2.52  & 27.82 & 6.87  & 4.73  & 3.11  & 4.10  \\ \hline
\emph{ldbc}   & 2.84 & 28.95 & 32.48 & 17.96 & 33.88 & OOM  & 20.15 & 20.19 & 19.00 \\ \hline
\emph{g5} & 3.95 & 24.62 & 40.46 & 15.33 & 33.02 & 78.42 & 19.34 & 19.55 & 19.16 \\ \hline
\emph{wk}   & 0.98 & 13.09 & 11.20 & 8.18  & 29.41 & 86.08 & 8.31  & 7.12  & 6.56  \\ \hline
\emph{ct}   & 0.27 & 3.32  & 3.49  & 2.06  & 27.60 & 22.81 & 3.14  & 2.14  & 1.80  \\ \hline
\emph{tw}   & 4.11 & 31.98 & 37.56 & 20.20 & 34.43 & OOM  & 22.03 & 22.04 & 23.53 \\ \hline
\emph{nft}  & 1.38 & 23.01 & 17.30 & 14.94 & 31.57 & OOM  & 11.77 & 12.27 & 11.12 \\ \hline
\end{tabular}%
% }
\end{table}

\small
\begin{table}[htbp]
\caption{Comparison of graph analytic queries with original implementations  (in seconds). 'M' denotes our implementation and 'O' denotes the original implementation. Lg, Ap, Ts and Sl denote LiveGraph, Aspen, Teseo and Sortledton, respectively.}
\label{tab:performance_comparison_of_analytic_queries_appendix}
% \resizebox{\columnwidth}{!}{
\centering
\begin{tabular}{|c|cccccccc|}
    \hline
    \textbf{Dataset} &
      \textbf{M-Lg} &
      \multicolumn{1}{c|}{\textbf{O-Lg}} &
      \textbf{M-As} &
      \multicolumn{1}{c|}{\textbf{O-As}} &
      \textbf{M-Ts} &
      \multicolumn{1}{c|}{\textbf{O-Ts}} &
      \textbf{M-Sl} &
      \textbf{O-Sl} \\ \hline
    \multicolumn{1}{|c|}{\textbf{BFS}} &
      \multicolumn{8}{l|}{} \\ \hline
    \emph{lj} &
      2.20 &
      \multicolumn{1}{c|}{12.19} &
      3.56 &
      \multicolumn{1}{c|}{3.98} &
      2.81 &
      \multicolumn{1}{c|}{4.09} &
      2.19 &
      4.45 \\ \hline
    \emph{dl} &
      0.03 &
      \multicolumn{1}{c|}{0.65} &
      0.04 &
      \multicolumn{1}{c|}{0.03} &
      0.03 &
      \multicolumn{1}{c|}{0.07} &
      0.04 &
      0.10 \\ \hline
    \emph{ldbc} &
      9.04 &
      \multicolumn{1}{c|}{30.70} &
      13.20 &
      \multicolumn{1}{c|}{23.86} &
      OOM &
      \multicolumn{1}{c|}{13.70} &
      10.03 &
      27.78 \\ \hline
    \emph{g5} &
      5.38 &
      \multicolumn{1}{c|}{17.79} &
      6.77 &
      \multicolumn{1}{c|}{8.69} &
      5.80 &
      \multicolumn{1}{c|}{5.91} &
      6.19 &
      9.76 \\ \hline
    \emph{wk} &
      3.95 &
      \multicolumn{1}{c|}{15.46} &
      6.24 &
      \multicolumn{1}{c|}{10.12} &
      4.83 &
      \multicolumn{1}{c|}{6.17} &
      4.11 &
      10.60 \\ \hline
    \emph{ct} &
      1.99 &
      \multicolumn{1}{c|}{8.23} &
      3.04 &
      \multicolumn{1}{c|}{4.33} &
      2.81 &
      \multicolumn{1}{c|}{3.60} &
      1.91 &
      5.44 \\ \hline
    \emph{tw} &
      8.77 &
      \multicolumn{1}{c|}{36.17} &
      12.58 &
      \multicolumn{1}{c|}{22.31} &
      OOM &
      \multicolumn{1}{c|}{16.14} &
      9.29 &
      24.09 \\ \hline
    \emph{nft} &
      9.15 &
      \multicolumn{1}{c|}{37.89} &
      14.66 &
      \multicolumn{1}{c|}{27.18} &
      OOM &
      \multicolumn{1}{c|}{18.88} &
      9.59 &
      24.92 \\ \hline
    \multicolumn{1}{|c|}{\textbf{SSSP}} &
      \multicolumn{8}{l|}{} \\ \hline
    \emph{lj} &
      2.87 &
      \multicolumn{1}{c|}{6.76} &
      7.31 &
      \multicolumn{1}{c|}{6.83} &
      3.34 &
      \multicolumn{1}{c|}{5.84} &
      2.79 &
      3.93 \\ \hline
    \emph{dl} &
      0.55 &
      \multicolumn{1}{c|}{0.75} &
      0.66 &
      \multicolumn{1}{c|}{0.37} &
      0.50 &
      \multicolumn{1}{c|}{1.83} &
      1.07 &
      1.94 \\ \hline
    \emph{ldbc} &
      12.18 &
      \multicolumn{1}{c|}{31.76} &
      32.70 &
      \multicolumn{1}{c|}{37.97} &
      OOM &
      \multicolumn{1}{c|}{31.81} &
      15.19 &
      26.91 \\ \hline
    \emph{g5} &
      7.79 &
      \multicolumn{1}{c|}{17.31} &
      14.81 &
      \multicolumn{1}{c|}{14.67} &
      9.79 &
      \multicolumn{1}{c|}{16.21} &
      10.25 &
      10.60 \\ \hline
    \emph{wk} &
      4.46 &
      \multicolumn{1}{c|}{12.04} &
      7.99 &
      \multicolumn{1}{c|}{9.31} &
      4.32 &
      \multicolumn{1}{c|}{7.84} &
      4.34 &
      9.04 \\ \hline
    \emph{ct} &
      1.71 &
      \multicolumn{1}{c|}{4.17} &
      4.68 &
      \multicolumn{1}{c|}{4.04} &
      2.00 &
      \multicolumn{1}{c|}{4.83} &
      1.74 &
      3.41 \\ \hline
    \emph{tw} &
      12.79 &
      \multicolumn{1}{c|}{29.91} &
      32.78 &
      \multicolumn{1}{c|}{35.06} &
      OOM &
      \multicolumn{1}{c|}{30.34} &
      15.05 &
      26.72 \\ \hline
    \emph{nft} &
      10.79 &
      \multicolumn{1}{c|}{31.73} &
      30.02 &
      \multicolumn{1}{c|}{37.59} &
      OOM &
      \multicolumn{1}{c|}{27.62} &
      10.37 &
      20.51 \\ \hline
    \multicolumn{1}{|c|}{\textbf{PR}} &
      \multicolumn{8}{l|}{} \\ \hline
    \emph{lj} &
      17.98 &
      \multicolumn{1}{c|}{79.78} &
      26.21 &
      \multicolumn{1}{c|}{33.99} &
      20.24 &
      \multicolumn{1}{c|}{35.15} &
      18.46 &
      36.48 \\ \hline
    \emph{dl} &
      3.29 &
      \multicolumn{1}{c|}{12.87} &
      4.84 &
      \multicolumn{1}{c|}{4.29} &
      3.40 &
      \multicolumn{1}{c|}{12.41} &
      8.92 &
      21.77 \\ \hline
    \emph{ldbc} &
      67.68 &
      \multicolumn{1}{c|}{286.22} &
      104.58 &
      \multicolumn{1}{c|}{186.50} &
      OOM &
      \multicolumn{1}{c|}{117.54} &
      101.31 &
      239.40 \\ \hline
    \emph{g5} &
      50.54 &
      \multicolumn{1}{c|}{202.23} &
      66.53 &
      \multicolumn{1}{c|}{88.30} &
      53.01 &
      \multicolumn{1}{c|}{162.39} &
      82.31 &
      104.32 \\ \hline
    \emph{wk} &
      32.39 &
      \multicolumn{1}{c|}{139.40} &
      49.75 &
      \multicolumn{1}{c|}{82.51} &
      40.58 &
      \multicolumn{1}{c|}{45.86} &
      38.53 &
      92.28 \\ \hline
    \emph{ct} &
      10.59 &
      \multicolumn{1}{c|}{52.23} &
      14.22 &
      \multicolumn{1}{c|}{22.73} &
      13.35 &
      \multicolumn{1}{c|}{15.92} &
      10.04 &
      28.21 \\ \hline
    \emph{tw} &
      75.95 &
      \multicolumn{1}{c|}{331.24} &
      105.64 &
      \multicolumn{1}{c|}{174.88} &
      OOM &
      \multicolumn{1}{c|}{138.30} &
      110.80 &
      256.53 \\ \hline
    \emph{nft} &
      59.74 &
      \multicolumn{1}{c|}{285.08} &
      93.48 &
      \multicolumn{1}{c|}{180.99} &
      OOM &
      \multicolumn{1}{c|}{91.07} &
      67.43 &
      173.85 \\ \hline
    \multicolumn{1}{|c|}{\textbf{WCC}} &
      \multicolumn{8}{l|}{} \\ \hline
    \emph{lj} &
      4.36 &
      \multicolumn{1}{c|}{13.66} &
      5.81 &
      \multicolumn{1}{c|}{7.75} &
      4.81 &
      \multicolumn{1}{c|}{7.00} &
      4.14 &
      7.34 \\ \hline
    \emph{dl} &
      0.66 &
      \multicolumn{1}{c|}{1.40} &
      0.99 &
      \multicolumn{1}{c|}{0.69} &
      0.79 &
      \multicolumn{1}{c|}{0.75} &
      1.62 &
      4.18 \\ \hline
    \emph{ldbc} &
      9.85 &
      \multicolumn{1}{c|}{36.71} &
      14.93 &
      \multicolumn{1}{c|}{26.24} &
      OOM &
      \multicolumn{1}{c|}{25.05} &
      17.03 &
      35.54 \\ \hline
    \emph{g5} &
      9.03 &
      \multicolumn{1}{c|}{28.01} &
      10.93 &
      \multicolumn{1}{c|}{14.31} &
      10.88 &
      \multicolumn{1}{c|}{16.31} &
      15.60 &
      15.89 \\ \hline
    \emph{wk} &
      3.96 &
      \multicolumn{1}{c|}{18.08} &
      6.86 &
      \multicolumn{1}{c|}{10.50} &
      5.08 &
      \multicolumn{1}{c|}{8.35} &
      5.08 &
      12.47 \\ \hline
    \emph{ct} &
      2.64 &
      \multicolumn{1}{c|}{8.65} &
      3.55 &
      \multicolumn{1}{c|}{5.04} &
      2.85 &
      \multicolumn{1}{c|}{4.58} &
      2.29 &
      5.54 \\ \hline
    \emph{tw} &
      18.91 &
      \multicolumn{1}{c|}{65.94} &
      23.71 &
      \multicolumn{1}{c|}{40.73} &
      OOM &
      \multicolumn{1}{c|}{40.92} &
      29.66 &
      61.61 \\ \hline
    \emph{nft} &
      10.65 &
      \multicolumn{1}{c|}{53.80} &
      16.85 &
      \multicolumn{1}{c|}{34.33} &
      OOM &
      \multicolumn{1}{c|}{26.52} &
      13.42 &
      33.40 \\ \hline
\end{tabular}

% }
\end{table}

Table \ref{tab:performance_comparison_of_analytic_queries_appendix} illustrates the performance comparison with original methods on graph analytic queries.
Our implementations shows similar or superior efficiency in all cases. Although LiveGraph utilizes sequential storage, which offers significant advantages for scan operations, it does not store the degree of each vertex. Instead, it computes the degree dynamically through traversal each time. As a result, in the GAPBS benchmark implementation, LiveGraph does not exhibit a performance advantage. To optimize this, the degrees of vertices could be precomputed and stored within snapshots.


% Please add the following required packages to your document preamble:
% \usepackage{graphicx}


% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
% \begin{table}[ht]
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|cccccc|}
% \hline
% \multicolumn{1}{|c|}{\textbf{Batch size}} &
%   \multicolumn{1}{c|}{\textbf{Aspen}} &
%   \multicolumn{1}{c|}{\textbf{Teseo}} &
%   \multicolumn{1}{c|}{\textbf{Sortledton}} &
%   \multicolumn{1}{c|}{\textbf{AdjLst}} &
%   \textbf{LiveGraph} \\ \hline
% \multicolumn{6}{|c|}{\emph{lj}}                                                                                                                                           \\ \hline
% \multicolumn{1}{|c|}{$2^{10}$} & \multicolumn{1}{c|}{2.08e6} & \multicolumn{1}{c|}{4.07e5} & \multicolumn{1}{c|}{5.08e5} & \multicolumn{1}{c|}{4.65e5} & 5.16e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{13}$} & \multicolumn{1}{c|}{3.68e6} & \multicolumn{1}{c|}{4.18e5} & \multicolumn{1}{c|}{5.28e5} & \multicolumn{1}{c|}{4.90e5} & 5.35e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{16}$} & \multicolumn{1}{c|}{4.46e6} & \multicolumn{1}{c|}{4.76e5} & \multicolumn{1}{c|}{6.13e5} & \multicolumn{1}{c|}{5.73e5} & 6.12e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{19}$} & \multicolumn{1}{c|}{6.95e6} & \multicolumn{1}{c|}{7.17e5} & \multicolumn{1}{c|}{1.04e6} & \multicolumn{1}{c|}{1.00e6} & 9.58e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{20}$} & \multicolumn{1}{c|}{7.63e6} & \multicolumn{1}{c|}{9.02e5} & \multicolumn{1}{c|}{1.33e6} & \multicolumn{1}{c|}{1.29e6} & 1.25e6 \\ \hline
% \multicolumn{6}{|c|}{\emph{g5}}                                                                                                                                   \\ \hline
% \multicolumn{1}{|c|}{$2^{10}$} & \multicolumn{1}{c|}{7.81e5} & \multicolumn{1}{c|}{2.82e5} & \multicolumn{1}{c|}{2.75e5} & \multicolumn{1}{c|}{8.56e4} & 9.68e4 \\ \hline
% \multicolumn{1}{|c|}{$2^{13}$} & \multicolumn{1}{c|}{1.03e6} & \multicolumn{1}{c|}{3.07e5} & \multicolumn{1}{c|}{2.99e5} & \multicolumn{1}{c|}{9.56e4} & 1.21e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{16}$} & \multicolumn{1}{c|}{1.55e6} & \multicolumn{1}{c|}{3.65e5} & \multicolumn{1}{c|}{3.59e5} & \multicolumn{1}{c|}{1.22e5} & 1.96e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{19}$} & \multicolumn{1}{c|}{3.49e6} & \multicolumn{1}{c|}{5.56e5} & \multicolumn{1}{c|}{5.77e5} & \multicolumn{1}{c|}{1.57e5} & 3.18e5 \\ \hline
% \multicolumn{1}{|c|}{$2^{20}$} & \multicolumn{1}{c|}{4.80e6} & \multicolumn{1}{c|}{6.69e5} & \multicolumn{1}{c|}{7.27e5} & \multicolumn{1}{c|}{1.68e5} & 3.54e5 \\ \hline
% \end{tabular}%
% }
% \caption{Comparison of batch updates throughput (edges per second) between fine-grained and coarse-grained concurrency control mechanism. All }
% \label{tab:batch updates}
% \end{table}


% Please add the following required packages to your document preamble:
% \usepackage{multirow}
% \usepackage{graphicx}

\noindent\textbf{Comparison of Memory Consumption with Original Implementation.} Table \ref{tab:memory_comparison_with_origin} presents a comparison of memory consumption between our implementations and the original versions. Our implementations of LiveGraph, Aspen, and Sortledton exhibit comparable memory usage to the original versions. However, Teseo optimizes memory storage by storing neighbor sets in a compact manner, allowing multiple neighbor sets to reside within the same PMA leaf. We allocate a PMA leaf for each vertex to enhance efficiency, which results in higher memory overhead. 

% \begin{table}[ht]
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|ll|l|l|l|l|l|}
% \hline
% \multicolumn{2}{|l|}{}                           & Aspen & Teseo   & Sortedton & AdjLst    & LiveGraph \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{}{lj}}} & p50  & 136   & 15,781  & 10,899    & 9,268     & 9,288     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & p95  & 141   & 24,493  & 27,092    & 30,213    & 19,833    \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & p99  & 143   & 25,403  & 27,570    & 31,028    & 20,957    \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & Max  & 143   & 25,630  & 27,689    & 31,232    & 21,238    \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & Mean & 136   & 14,144  & 11,732    & 13,437    & 9,960     \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} & p50  & 205   & 21,109  & 15,995    & 54,100    & 37,818    \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & p95  & 332   & 158,106 & 198,174   & 519,475   & 369,192   \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & p99  & 339   & 251,457 & 302,336   & 893,394   & 569,581   \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & Max  & 344   & 324,289 & 323,595   & 1,124,937 & 707,895   \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                    & Mean & 207   & 44,523  & 41,897    & 133,947   & 86,782    \\ \hline
% \end{tabular}%
% }
% \caption{Comparison of batch updates latency (ms) between fine-grained and coarse-grained concurrency control mechanism. Experiments are run on 32 cores.}
% \label{tab:batch update latency 20}
% \end{table}


% \begin{figure}[h]
%     \setlength{\abovecaptionskip}{0pt}
%     \setlength{\belowcaptionskip}{0pt}
%     \captionsetup[subfigure]{aboveskip=0pt,belowskip=0pt}
%     \centering
%     \includegraphics[width=0.45\textwidth]{img/exp_figs/batch/legend.pdf}
%     \begin{subfigure}[t]{0.23\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{img/exp_figs/batch/liveJournal_batch_performance.pdf}
%         \caption{Batch update on \emph{lj}.}
%         \label{fig:batch_update_on_lj}
%     \end{subfigure}
%     \begin{subfigure}[t]{0.23\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{img/exp_figs/batch/graph500_batch_performance.pdf}
%         \caption{Batch update on \emph{g5}.}
%         \label{figbatch_update_on_g5}
%     \end{subfigure}
    
% 	\caption{Batch update throughput with batch size varying. All are set on 32 cores.}
% 	\label{fig:scalability}
% \end{figure}

% The concurrency control mechanism of G2PL naturally supports batch updates. Firstly, all locks are first acquired sequentially. Then insertions are performed with edges of the same vertex inserted together. Finally, the locks are released in order. Aspen, which uses a copy-on-write (CoW) mechanism, copies all the blocks and nodes that need to be updated, ultimately obtaining a new root. As the batch size increases, spatial locality improves, allowing both G2PL and CoW methods to achieve throughput enhancements. Additionally, methods employing the CoW mechanism can reduce the number of node and block copies; if different updates are within the same block or belong to subordinates of the same node, they only need to be copied once.

% Although Aspen only allows single writer, its tree structure naturally supports parallel updates by letting different subtrees be modified simultaneously. Additionally, Aspen is lock-free, which allows it to fully utilize hardware resources by reducing synchronization overhead and eliminating lock contention, thereby improving performance on multi-core systems.

% In contrast, G2PL methods require transactions to acquire all the necessary locks before execution. This can cause serious blocking between transactions, especially as batch sizes increase, leading to low CPU utilization and reduced system throughput. By avoiding locks and enabling concurrent updates within its single-writer model, Aspen achieves higher efficiency and scalability compared to G2PL methods, which can become bottlenecks due to lock contention in highly concurrent environments.

% We use NUMA control to constraint the resources to 32 physical cores. Aspen uses single writer and parallel update. G2PL methods uses 32 threads, each dynamically assigned an update transaction of certain batch size. As shown in Table \ref{tab:batch updates}, Aspen consistently outperforms the other methods across various batch sizes and datasets. For both the lj and g5 datasets, Aspen achieves significantly higher edges per second compared to Teseo, Sortledton, AdjLst, and LiveGraph. As the batch size increases from 
%  $2^10$ to $2^20$
%  , Aspen's throughput scales effectively. In contrast, the other methods exhibit relatively modest improvements, indicating limited scalability. This highlights Aspen's advantage in utilizing a single-writer model that supports parallel updates within the write operation, effectively exploiting data parallelism without the overhead of lock contention. The G2PL methods, which use 32 threads with dynamic transaction assignment, suffer from increased lock contention as batch sizes grow, leading to serious blocking between transactions and lower CPU utilization. As demonstrated in Table \ref{tab:batch update latency 20}, Aspen maintains remarkably low latency, with a mean latency of 136 ms for the liveJournal dataset and 207 ms for the graph500 dataset. In contrast, the G2PL methods experience substantially higher latencies due to lock contention and blocking. While G2PL methods can increase the thread count to match Aspen's throughput, they incur significantly higher latency per transaction due to the impact of lock-based synchronization. Additionally, we found that when using the sample sort algorithm provided by Aspen, the sorting process accounts for 3\% to 25\% of the total execution time. Therefore, an efficient and well-parallelized sorting algorithm is also crucial for optimizing batch update processes.


% \begin{table}[ht]
% \caption{L1 Miss}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\
% \hline
% $2^{7}$ & 9.40e+07 & 8.51e+07 & 8.13e+07 & 6.59e+07 & 2.65e+07 \\
% \hline
% $2^{8}$ & 9.40e+07 & 1.01e+08 & 7.48e+07 & 2.41e+07 & 2.08e+07 \\
% \hline
% $2^{9}$ & 9.42e+07 & 8.48e+07 & 7.22e+07 & 2.14e+07 & 1.72e+07 \\
% \hline
% $2^{10}$ & 9.40e+07 & 8.50e+07 & 7.22e+07 & 1.28e+07 & 1.62e+07 \\
% \hline
% \end{tabular}
% }
% \label{tab:L1 miss}
% \end{table}

% \begin{table}[ht]
% \centering
% \caption{L2 Miss}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\
% \hline
% $2^{7}$ & 1.35e+08 & 1.35e+08 & 2.27e+08 & 4.25e+08 & 2.09e+08 \\
% \hline
% $2^{8}$ & 1.35e+08 & 1.35e+08 & 2.15e+08 & 2.86e+08 & 1.82e+08 \\
% \hline
% $2^{9}$ & 1.35e+08 & 1.35e+08 & 2.00e+08 & 2.17e+08 & 1.59e+08 \\
% \hline
% $2^{10}$ & 1.35e+08 & 1.35e+08 & 1.50e+08 & 1.77e+08 & 1.51e+08 \\
% \hline
% \end{tabular}
% }
% \label{tab:L2 miss}
% \end{table}

% \begin{table}[ht]
% \centering
% \caption{LLC Miss}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\
% \hline
% $2^{7}$ & 1.34e+08 & 1.34e+08 & 2.26e+08 & 2.67e+08 & 1.99e+08 \\
% \hline
% $2^{8}$ & 1.34e+08 & 1.34e+08 & 2.15e+08 & 2.38e+08 & 1.78e+08 \\
% \hline
% $2^{9}$ & 1.34e+08 & 1.34e+08 & 2.00e+08 & 2.10e+08 & 1.56e+08 \\
% \hline
% $2^{10}$ & 1.34e+08 & 1.34e+08 & 1.50e+08 & 1.75e+08 & 1.48e+08 \\
% \hline
% \end{tabular}
% }
% \label{tab:L3 miss}
% \end{table}

% \begin{table}[ht]
% \centering
% \caption{DTLB Miss}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\
% \hline
% $2^{7}$ & 1.13e+04 & 5.06e+03 & 6.23e+05 & 7.76e+06 & 3.23e+06 \\
% \hline
% $2^{8}$ & 1.14e+04 & 5.34e+03 & 4.20e+06 & 4.18e+06 & 2.37e+06 \\
% \hline
% $2^{9}$ & 1.15e+04 & 5.04e+03 & 4.20e+06 & 2.52e+06 & 1.11e+06 \\
% \hline
% $2^{10}$ & 1.11e+04 & 5.15e+03 & 2.11e+06 & 1.44e+06 & 8.65e+05 \\
% \hline
% \end{tabular}
% }
% \label{tab:DTLB miss}
% \end{table}

% % Please add the following required packages to your document preamble:
% % \usepackage{graphicx}
% \begin{table}[ht]
% \caption{DTLB Miss Cycle}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\ \hline
% $2^{7}$  & 2.60e+06 & 1.60e+06 & 4.34e+07 & 4.17e+08 & 5.25e+08 \\ \hline
% $2^{8}$  & 2.36e+06 & 1.70e+06 & 1.96e+08 & 2.90e+08 & 4.09e+08 \\ \hline
% $2^{9}$  & 2.61e+06 & 1.70e+06 & 1.94e+08 & 2.34e+08 & 2.40e+08 \\ \hline
% $2^{10}$ & 2.41e+06 & 1.79e+06 & 1.02e+08 & 1.90e+08 & 1.52e+08 \\ \hline
% \end{tabular}%
% }
% \label{tab:tlb miss cycle}
% \end{table}

% \begin{table}[ht]
% \centering
% \caption{Branch Missprediction}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\
% \hline
% $2^{7}$ & 1.19e+03 & 2.39e+03 & 3.71e+06 & 1.27e+07 & 1.49e+07 \\
% \hline
% $2^{8}$ & 1.20e+03 & 2.23e+03 & 1.50e+03 & 6.24e+06 & 7.90e+06 \\
% \hline
% $2^{9}$ & 1.21e+03 & 2.20e+03 & 1.50e+03 & 3.08e+06 & 3.96e+06 \\
% \hline
% $2^{10}$ & 1.29e+03 & 2.20e+03 & 1.57e+03 & 1.55e+06 & 1.98e+06 \\
% \hline
% \end{tabular}
% }
% \label{tab:branch misprediction}
% \end{table}

% \begin{table}[ht]
% \centering
% \caption{Instruction Per Operation}
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|c|c|c|c|c|c|}
% \hline
% \textbf{Block Size} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} & \textbf{Aspen} \\ \hline
% $2^{7}$  & 1.00 & 1.50 & 1.47 & 11.07 & 7.38 \\ \hline
% $2^{8}$  & 1.00 & 1.50 & 1.23 & 11.03 & 7.19 \\ \hline
% $2^{9}$  & 1.00 & 1.50 & 1.12 & 11.02 & 7.10 \\ \hline
% $2^{10}$ & 1.00 & 1.50 & 1.06 & 11.01 & 7.05 \\ \hline
% \end{tabular}%
% }

% \label{tab:ipo}
% \end{table}

% AdjLst and LiveGraph uses a continuous array to store neighbors, and PMA used by Teseo, though segmented, is also stored in an array that is continuous in memory. Sortledton and Aspen uses segmented data structure. Table \ref{tab:tlb miss cycle} demonstrates the time (in CPU cycles) that the hardware page walker is engaged in translating virtual memory addresses to physical memory addresses during load operations that result in TLB misses. Segmented neighbor indexes incurs  higher TLB misses overhead compared to continuous neighbor indexes. The non-contiguous memory layout of segmented indexes leads to scattered memory access across different memory pages. The frequent TLB misses that are not fully amortized by the size of the adjacency list caused increased memory latency during the scan operations. 

% Additionally, the instructions per operation are notably higher for segmented indexes. Sortledton requires approximately 11 instructions per operation (Table \ref{tab:ipo}), whereas AdjLst requires only 1. This extra instruction overhead stems from the complexity of managing multiple segments during traversal. Moreover, branch mispredictions are higher in segmented indexes, leading to performance penalties from pipeline stalls. Sortledton experiences around $10^6-10^7$ branch mispredictions, whereas LiveGraph, a continuous index, has significantly fewer at around $2 \times 10^3$(Table \ref{tab:branch misprediction}). These combined factors of higher TLB misses, instructions per operation, and branch mispredictions result in greater overhead for segmented neighbor indexes during scanning operations, regardless of adjacency list size.
% \su{
% \noindent \textbf{Batch update Latency.} 
% We present the batch update latency. Specifically, we use 32 physical to execute parallel batch updates. 
% The concurrency control mechanism of G2PL naturally supports batch updates. Aspen, which uses a copy-on-write (CoW) mechanism, copies all the blocks and nodes that need to be updated, ultimately obtaining a new root. As the batch size increases, spatial locality improves, allowing both G2PL and CoW methods to achieve throughput enhancements. Additionally, methods employing the CoW mechanism can reduce the number of node and block copies; if different updates are within the same block or belong to subordinates of the same node, they only need to be copied once.
% }
% % Although Aspen only allows single writer, its tree structure naturally supports parallel updates by letting different subtrees be modified simultaneously. Additionally, Aspen is lock-free, which allows it to fully utilize hardware resources by reducing synchronization overhead and eliminating lock contention, thereby improving performance on multi-core systems.

% % In contrast, G2PL methods require transactions to acquire all the necessary locks before execution. This can cause serious blocking between transactions, especially as batch sizes increase, leading to low CPU utilization and reduced system throughput. By avoiding locks and enabling concurrent updates within its single-writer model, Aspen achieves higher efficiency and scalability compared to G2PL methods, which can become bottlenecks due to lock contention in highly concurrent environments.
% \su{
% In the continuous batch update experiments, we recorded the start and end times of each batch update. Since Aspen supports only a single writer, incoming batches may need to wait in a queue, while G2PL-based methods utilize 32 writer threads, allowing new batches to select an available thread for immediate execution. To simulate latency more accurately, we modeled batch update arrival times using a Poisson distribution. If the simulated arrival time is earlier than the actual start time, the batch is considered to be waiting in the queue, and the wait time is calculated. If the arrival time is later than or equal to the actual start time, the batch is executed immediately.  The total latency was calculated as the sum of the wait time and the actual execution time, allowing us to measure the latency performance of different systems across varying batch sizes.
% }
% % Please add the following required packages to your document preamble:
% % \usepackage{multirow}
% % \usepackage{graphicx}

% \begin{table}[]
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|ll|l|l|l|l|l|}
% \hline
% \multicolumn{2}{|l|}{}                                & Aspen & AdjLst & LiveGraph & Teseo & Sortledton \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} & p50  & 0.08  & 0.20   & 0.15      & 0.20  & 0.18       \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & p95  & 0.10  & 0.72   & 0.57      & 0.74  & 0.64       \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & p99  & 0.12  & 1.76   & 1.31      & 1.69  & 1.41       \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & Max  & 7.87  & 21.42  & 13.23     & 18.97 & 12.81      \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & Mean & 0.08  & 0.30   & 0.24      & 0.31  & 0.26       \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} & p50  & 0.19  & 3.28   & 2.29      & 0.70  & 0.71       \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & p95  & 0.26  & 26.64  & 19.10     & 5.14  & 5.30       \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & p99  & 0.29  & 59.67  & 40.04     & 10.93 & 11.35      \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & Max  & 10.62 & 634.72 & 439.77    & 64.28 & 62.26      \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & Mean & 0.19  & 7.30   & 5.12      & 1.40  & 1.43       \\ \hline
% \end{tabular}%
% }
% \caption{\su{Batch update latency (ms) of block size $2^{6}$.}}
% \label{tab:batch_latency_64}
% \end{table}


% \begin{table}[]
% \resizebox{0.45\textwidth}{!}{%
% \begin{tabular}{|ll|l|l|l|l|l|}
% \hline
% \multicolumn{2}{|l|}{}        & Aspen & AdjLst       & LiveGraph    & Teseo    & Sortledton \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} & p50 & 0.39 & 16.06        & 14.05        & 17.16     & 15.07     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & p95  & 0.46  & 253.23       & 221.29       & 310.09   & 252.83     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & p99  & 0.49  & 742.28       & 656.09       & 897.50   & 721.80     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & Max  & 8.66  & 5,138.69     & 4,169.08     & 4,745.78 & 4,053.18   \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & Mean & 0.39  & 58.08        & 50.23        & 68.69    & 56.51      \\ \hline
% \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} & p50 & 1.30 & 260,959.58   & 118,558.94   & 35.06     & 35.99     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & p95  & 1.69  & 1,578,969.87 & 1,212,060.98 & 410.14   & 428.73     \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & p99 & 1.78 & 1,739,013.37 & 1,368,821.67 & 1,411.69  & 1,478.18  \\ \cline{2-7} 
% \multicolumn{1}{|l|}{}                         & Max & 8.37 & 1,778,744.89 & 1,408,792.24 & 19,368.69 & 13,493.04 \\ \cline{2-7} 
% \multicolumn{1}{|l|}{} & Mean & 1.21  & 483,150.36   & 327,921.98   & 109.45   & 113.75     \\ \hline
% \end{tabular}%
% }
% \caption{\su{Batch update latency (ms) of block size $2^{10}$.}}
% \label{tab:batch_latency_1024}
% \end{table}


% % \begin{table}[]
% % \resizebox{0.45\textwidth}{!}{%
% % \begin{tabular}{|ll|l|l|l|l|l|}
% % \hline
% % \multicolumn{2}{|l|}{}                               & \textbf{Aspen} & \textbf{AdjLst} & \textbf{LiveGraph} & \textbf{Teseo} & \textbf{Sortledton} \\ \hline
% % \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{lj}}} & p50 & 2.29           & 28,402.02       & 24,300.11          & 37,304.01      & 70,314.44           \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & p95  & 2.82       & 62,318.38    & 53,070.44    & 78,592.55  & 127,629.38 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & p99  & 3.05       & 65,548.58    & 55,770.74    & 82,251.41  & 130,594.80 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & Max  & 9.57       & 69,385.50    & 58,342.60    & 84,519.09  & 133,235.83 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & Mean & 2.31       & 29,972.65    & 25,700.35    & 38,762.26  & 65,189.83  \\ \hline
% % \multicolumn{1}{|l|}{\multirow{5}{*}{\emph{g5}}} & p50 & 30,280.01      & 689,897.76      & 562,600.37         & 330,192.01     & 305,164.64          \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & p95  & 114,424.92 & 2,220,653.99 & 1,825,277.93 & 694,243.17 & 696,143.67 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & p99  & 124,134.31 & 2,401,293.09 & 1,990,137.25 & 728,148.97 & 734,369.10 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & Max  & 126,579.90 & 2,449,472.79 & 2,036,287.47 & 738,411.46 & 748,070.55 \\ \cline{2-7} 
% % \multicolumn{1}{|l|}{} & Mean & 40,622.28  & 865,621.41   & 705,077.26   & 341,312.68 & 325,130.70 \\ \hline
% % \end{tabular}%
% % }
% % \caption{\su{Batch update latency (ms) of block size $2^{13}$.}}
% % \label{tab:batch_latency_8192}
% % \end{table}
% \su{
% We set the Poisson distribution's arrival rate, $\lambda$, to 3200 and 200 batches per second for batch sizes of $2^6$, $2^{10}$, respectively, simulating different batch arrivals per second.  Latency simulated is shown in Table \ref{tab:batch_latency_64}, \ref{tab:batch_latency_1024}. For the batch size of $2^6$, none of the methods experience significant waiting time due to their low execution time, and the latency primarily reflects the batch execution times. The maximum latency observed in G2PL methods is significantly higher than in Aspen due to the time spent waiting for lock acquisition. However, for batch size of $2^{10}$ , Aspen avoids long waiting times due to its low execution overhead, while in contrast, the long waiting time in other methods is dominated by prolonged queueing, primarily caused by severe lock contention. This results in significant blocking and leads to much higher latency.
% }
% \su{
% Additionally, we found that when using the sample sort algorithm provided by Aspen, the sorting process accounts for 3\% to 25\% of the total execution time. Therefore, an efficient and well-parallelized sorting algorithm is also crucial for optimizing batch update processes.
% }

\clearpage
