
%\section{Related Work}
%\label{sec:related-work}

%\subsection{Background}

%Defect detection is critical to ensure the yield of integrated circuit manufacturing lines and reduce faults. Previous research has primarily focused on wafer map data, which engineers produce by marking faulty chips with different colors based on test results. The specific spatial distribution of defects on a wafer can provide insights into the causes, thereby helping to determine which stage of the manufacturing process is responsible for the issues. Although such research is relatively mature, the continual miniaturization of integrated circuits and the increasing complexity and density of chip components have made chip-level detection more challenging, leading to potential risks\cite{ma2023review}. Consequently, there is a need to combine this approach with magnified imaging of the wafer surface using scanning electron microscopes (SEMs) to detect, classify, and analyze specific microscopic defects, thus helping to identify the particular process steps where defects originate.

%Previously, wafer surface defect classification and detection were primarily conducted by experienced engineers. However, this method relies heavily on the engineers' expertise and involves significant time expenditure and subjectivity, lacking uniform standards. With the ongoing development of artificial intelligence, deep learning methods using multi-layer neural networks to extract and learn target features have proven highly effective for this task\cite{gao2022review}.

%In the task of defect classification, it is typical to use a model structure that initially extracts features through convolutional and pooling layers, followed by classification via fully connected layers. Researchers have recently developed numerous classification model structures tailored to specific problems. These models primarily focus on how to extract defect features effectively. For instance, Chen et al. presented a defect recognition and classification algorithm rooted in PCA and classification SVM\cite{chen2008defect}. Chang et al. utilized SVM, drawing on features like smoothness and texture intricacy, for classifying high-intensity defect images\cite{chang2013hybrid}. The classification of defect images requires the formulation of numerous classifiers tailored for myriad inspection steps and an Abundance of accurately labeled data, making data acquisition challenging. Cheon et al. proposed a single CNN model adept at feature extraction\cite{cheon2019convolutional}. They achieved a granular classification of wafer surface defects by recognizing misclassified images and employing a k-nearest neighbors (k-NN) classifier algorithm to gauge the aggregate squared distance between each image feature vector and its k-neighbors within the same category. However, when applied to new or unseen defects, such models necessitate retraining, incurring computational overheads. Moreover, with escalating CNN complexity, the computational demands surge.

%Segmentation of defects is necessary to locate defect positions and gather information such as the size of defects. Unlike classification networks, segmentation networks often use classic encoder-decoder structures such as UNet\cite{ronneberger2015u} and SegNet\cite{badrinarayanan2017segnet}, which focus on effectively leveraging both local and global feature information. Han Hui et al. proposed integrating a Region Proposal Network (RPN) with a UNet architecture to suggest defect areas before conducting defect segmentation \cite{han2020polycrystalline}. This approach enables the segmentation of various defects in wafers with only a limited set of roughly labeled images, enhancing the efficiency of training and application in environments where detailed annotations are scarce. Subhrajit Nag et al. introduced a new network structure, WaferSegClassNet, which extracts multi-scale local features in the encoder and performs classification and segmentation tasks in the decoder \cite{nag2022wafersegclassnet}. This model represents the first detection system capable of simultaneously classifying and segmenting surface defects on wafers. However, it relies on extensive data training and annotation for high accuracy and reliability. 

%Recently, Vic De Ridder et al. introduced a novel approach for defect segmentation using diffusion models\cite{de2023semi}. This approach treats the instance segmentation task as a denoising process from noise to a filter, utilizing diffusion models to predict and reconstruct instance masks for semiconductor defects. This method achieves high precision and improved defect classification and segmentation detection performance. However, the complex network structure and the computational process of the diffusion model require substantial computational resources. Moreover, the performance of this model heavily relies on high-quality and large amounts of training data. These issues make it less suitable for industrial applications. Additionally, the model has only been applied to detecting and segmenting a single type of defect(bridges) following a specific manufacturing process step, limiting its practical utility in diverse industrial scenarios.

%\subsection{Few-shot Anomaly Detection}
%Traditional anomaly detection techniques typically rely on extensive training data to train models for identifying and locating anomalies. However, these methods often face limitations in rapidly changing production environments and diverse anomaly types. Recent research has started exploring effective anomaly detection using few or zero samples to address these challenges.

%Huang et al. developed the anomaly detection method RegAD, based on image registration technology. This method pre-trains an object-agnostic registration network with various images to establish the normality of unseen objects. It identifies anomalies by aligning image features and has achieved promising results. Despite these advancements, implementing few-shot settings in anomaly detection remains an area ripe for further exploration. Recent studies show that pre-trained vision-language models such as CLIP and MiniGPT can significantly enhance performance in anomaly detection tasks.

%Dong et al. introduced the MaskCLIP framework, which employs masked self-distillation to enhance contrastive language-image pretraining\cite{zhou2022maskclip}. This approach strengthens the visual encoder's learning of local image patches and uses indirect language supervision to enhance semantic understanding. It significantly improves transferability and pretraining outcomes across various visual tasks, although it requires substantial computational resources.
%Jeong et al. crafted the WinCLIP framework by integrating state words and prompt templates to characterize normal and anomalous states more accurately\cite{Jeong_2023_CVPR}. This framework introduces a novel window-based technique for extracting and aggregating multi-scale spatial features, significantly boosting the anomaly detection performance of the pre-trained CLIP model.
%Subsequently, Li et al. have further contributed to the field by creating a new expansive multimodal model named Myriad\cite{li2023myriad}. This model, which incorporates a pre-trained Industrial Anomaly Detection (IAD) model to act as a vision expert, embeds anomaly images as tokens interpretable by the language model, thus providing both detailed descriptions and accurate anomaly detection capabilities.
%Recently, Chen et al. introduced CLIP-AD\cite{chen2023clip}, and Li et al. proposed PromptAD\cite{li2024promptad}, both employing language-guided, tiered dual-path model structures and feature manipulation strategies. These approaches effectively address issues encountered when directly calculating anomaly maps using the CLIP model, such as reversed predictions and highlighting irrelevant areas. Specifically, CLIP-AD optimizes the utilization of multi-layer features, corrects feature misalignment, and enhances model performance through additional linear layer fine-tuning. PromptAD connects normal prompts with anomaly suffixes to form anomaly prompts, enabling contrastive learning in a single-class setting.

%These studies extend the boundaries of traditional anomaly detection techniques and demonstrate how to effectively address rapidly changing and sample-scarce production environments through the synergy of few-shot learning and deep learning models. Building on this foundation, our research further explores wafer surface defect detection based on the CLIP model, especially focusing on achieving efficient and accurate anomaly detection in the highly specialized and variable semiconductor manufacturing process using a minimal amount of labeled data.
