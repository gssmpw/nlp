\documentclass[10pt, final, twocolumn, twoside, romanappendices]{IEEEtran}

%\documentclass[a4paper, draftcls, 12pt, onecolumn, twoside]{IEEEtran}
%\documentclass[12pt, draftclsnofoot, onecolumn]{IEEEtran}


\usepackage{graphicx,cite,acronym,amsmath,amssymb,amsfonts,color,subfigure,floatflt,stfloats,bm,textgreek,multirow}


\usepackage{epsfig,epstopdf,psfrag}

\DeclareGraphicsExtensions{.png,.jpg,.eps}

\input{acronyms}
\include{def_EM_SP}

\hyphenation{op-tical net-works semi-conduc-tor}


\title{Frequency-selective Dynamic Scattering Arrays for Over-the-air EM Processing}

%% Use \affref{nn} and matching \aff{nn}{...} below for several authors
%% Mark the presenting author with an asterisk
\author{
\IEEEauthorblockN{Davide~Dardari,~\IEEEmembership{Fellow,~IEEE}}
\IEEEcompsocitemizethanks{\IEEEcompsocthanksitem 
 D.~Dardari is with the 
   Dipartimento di Ingegneria dell'Energia Elettrica e dell'Informazione ``Guglielmo Marconi"  (DEI), WiLAB-CNIT, 
   University of Bologna, Cesena Campus, 
   Cesena (FC), Italy, (e-mail: davide.dardari@unibo.it). 
    }
}
% (Omit \affref and \aff and the asterisk if there is only one author.)

\begin{document}

\maketitle

\begin{abstract}
  In this paper, we investigate frequency-selective \ac{DSA}, a versatile antenna structure capable of performing joint wave-based computing and radiation by transitioning signal processing tasks from the digital domain to the \ac{EM} domain.
The numerical results demonstrate the potential of \acp{DSA} to produce space-frequency superdirective responses with minimal usage of \ac{RF} chains, making it particularly attractive for future holographic \ac{MIMO} systems.
\end{abstract}


\section{Introduction}

The use of high-frequency bands in the millimeter wave and THz ranges, combined with the integration of antennas with a large number of elements, is driving current wireless technology toward seemingly insurmountable challenges in hardware complexity, latency, and power consumption. These issues present significant obstacles to the sustainability of future wireless networks.

One promising strategy for enhancing sustainability is to shift part of the signal processing directly to the \acf{EM} domain, a concept known as \ac{ESIT} \cite{DiRMig:24,BjoChaHeaMarMezSanRusCasJunDem:24,Dar:JS25}. 
This can be achieved by designing reconfigurable \ac{EM} environments \cite{Dar:J24} using advanced \ac{EM} metamaterial devices to perform basic processing functions \cite{Sil:14}, \acp{RIS}, or the recently introduced \acp{SIM} \cite{AnXuNgAleHuaYueHan:23}.
%
In particular, the study of \acp{SIM} remains in its early stages, and the key technological and modeling challenges are yet to be fully addressed. For example, the spacing between layers must span several wavelengths to ensure the validity of the cascade model currently in use. Additionally, power losses and signal distortion caused by the multiple layers and the bounding box require further investigation. A notable limitation of \acp{SIM} is that only the final layer radiates, restricting the characteristics of the generated \ac{EM} waves to those achievable with a conventional planar surface or array. Meanwhile, the hidden layers are primarily responsible for performing \ac{EM} transformations.

To address the aforementioned limitations, we investigate an \ac{EM} antenna structure, referred to as a \acf{DSA}, which offers significant flexibility by enabling advanced processing capabilities directly at the \ac{EM} level while radiating \cite{Dar:C24}. A \ac{DSA} comprises a limited number of active antenna elements, each connected to an \ac{RF} chain (input), and is surrounded by a cluster of many reconfigurable passive scatterers. These scatterers interact within the reactive near field, enabling \ac{EM} processing and radiation to occur jointly ``over the air".
A \ac{DSA} can be viewed as a generalization of reactively controlled arrays, initially introduced in \cite{Har:78}, and their evolution into \acp{ESPAR}, which utilize a single \ac{RF} chain \cite{BucJuaKamSib:20}.


In this paper, we extend the concept of \ac{DSA} to operate with wideband signals, thereby enabling space-frequency processing capabilities. Additionally, unlike previous works on \ac{DSA}, we eliminate the requirement for ideal loads and a perfectly reconfigurable matching network by introducing reconfigurable loads modeled as a realistic varactor diode. 
Building on the analytical expression of the frequency-dependent characteristics of the \ac{DSA} as a function of its configuration parameters, we formulate an optimization problem to design these parameters according to the desired space-frequency response.
%
Numerical results highlight the remarkable flexibility of the \ac{DSA} in realizing different beams each associated with a different port and frequency while offering significant advantages with respect to current holographic \ac{MIMO} solutions, such as reduced size and minimized number of \ac{RF} chains. For example, we demonstrate that the tight coupling of \ac{DSA} elements enables the realization of superdirectivity, regardless of the beam's direction - a capability that stands in contrast to standard arrays, where superdirectivity is typically limited to the end-fire direction.


\begin{figure}[t]
  \centering
  \includegraphics[width=1\columnwidth]{Figures/DSA1.pdf}
  \caption{Schematic of the DSA.}
  \label{Fig:DSA}
\end{figure}


\section{Frequency-selective Dynamic Scattering Array Modelling}

With reference to Fig.~\ref{Fig:DSA}, a \ac{DSA} is composed of $N$ antenna elements of which $\Na$ are active and hence connected to an \ac{RF} chain, and $\Ns=N-\Na$ are passive scattering antenna elements \cite{Dar:C24}. %\cite{Har:78,BucJuaKamSib:20,HanZhaSheLiChiMuc:21,Dar:C24}.  
 We consider a multicarrier system with total bandwidth $W$ using $K$ subcarriers at frequencies $f_k=f_0+(k-1) W/K$, for $k=1,2, \ldots K$. At the generic $k$th sucarrier, the $\Na$ \ac{RF} chains introduce open circuit voltages ${\boldv^{(k)}=\left [v_1^{(k)}, v_2^{(k)}, \ldots, v_{\Na}^{(k)}, 0, 0, \ldots, 0 \right]^{\transpose}}$ to the first $\Na$ elements that carry the information. 
%
The response of the \ac{DSA} can be changed by loading each antenna element with reconfigurable loads of impedances $z_n^{(k)}(\theta_n)$, with $n=1,2, \ldots N$, where $\theta_n$ is a parameter to be optimized, as it will be detailed later. Denote with $\btheta=\{ \theta_n\}_{n=1}^N$ the set of optimization parameters.  
Ideally, the loads should be designed to be only reactive to avoid power losses. 
At the $k$th subcarrier, the overall \ac{DSA} system can be modeled as an $N$-port network in which the following relationship between the set of currents $\boldi^{(k)}$ and open circuit voltages $\boldv^{(k)}$ is given by
%
 \begin{align}
 \left ( \boldZ_{\text{L}}^{(k)}(\btheta)  +\boldZ^{(k)}  \right ) \boldi^{(k)} =\boldv^{(k)}
\end{align}
%
where $\boldZ^{(k)} \in \mathbb{C}^{N \times N}$ is the impedance matrix of the  antenna structure and $\boldZ_{\text{L}}^{(k)}(\btheta)=\{ z_n^{(k)}(\theta_n) \}_{n=1}^N $ represents the set of reconfigurable loads' impedances. All the interactions between the elements of the \ac{DSA} are captured by the impedance matrix $\boldZ^{(k)}$, which does not depend on the reconfigurable loads, and relates the voltages and currents of the $N$ ports. For instance, with Hertzian dipoles or half-wave dipoles, it can be computed analytically \cite{BalB:16}.


Consider now $T$ test points located in positions $\boldp_t$, with $t=1,2, \ldots , T$, and that in each test point, a conventional receiving antenna is used to probe the signal with gain $\Gr$. 
As commonly done in the literature, we assume that the test points are located in the radiative region of the \ac{DSA} and the receiving antennas do not affect the transmitting \ac{DSA}. 
As an example, the set of $T$ antennas might represent a conventional receiving antenna array of a \ac{MIMO} system.  
%
The end-to-end relationship between the open circuit voltages at the $\Na$ ports and the useful component (i.e., without noise) of the received signal $\boldy^{(k)}=\left [y_1^{(k)},y_2^{(k)}, \ldots , y_T^{(k)} \right ]^{\transpose}$ at the test positions for subcarrier $k$  is 
%
\begin{align} \label{eq:by}
	\boldy^{(k)}=\boldH_c^{(k)} \, \boldi^{(k)}=\boldH_c^{(k)} \,   \left ( \boldZ_{\text{L}}^{(k)}(\btheta)  +\boldZ^{(k)}  \right )^{-1} \boldv^{(k)}   
\end{align}
%
where $\boldH_c^{(k)} \in \mathbb{C}^{T \times N}$ is the transimpedance matrix of the radio channel accounting for the propagation effects that can be easily computed analytically in free-space conditions.
%
The previous equation can be used as a general model for the \ac{DSA} in an optimization problem to determine the set of parameters $\btheta$ once the desired response $\boldy^{(k)}$ is fixed for each subcarrier.

Define the matrix $\boldV=\sqrt{4\, R} \, \diag{1,2, \ldots , \Na}  \in \mathbb{R}^{N \times \Na }$, being $R$ the internal resistance of the \ac{RF} chains. Indicating with $\boldi_n^{(k)}=\left ( \boldZ_{\text{L}}^{(k)}(\btheta)  +\boldZ^{(k)}  \right )^{-1} [\boldV]_{(:,n)}$ the current in the case only the $n$th \ac{RF} chain is excited at subcarrier $k$, where $[\boldV]_{(:,n)}$ represents the $n$th column of $\boldV$,  the corresponding radiated power results ${\Prad}_{,n}^{(k)}=\left ({\boldi_n^{(k)}}\right )^{\ctranspose} \Re\{\boldZ\} \, \boldi_n^{(k)} $, with $\Re\{x\}$ being the real part of $x$ and $(\cdot)^{\ctranspose}$ the conjugate transpose operator.  
The factor $\sqrt{4\, R}$ in matrix $\boldV$ has been introduced to normalize the power available at each \ac{RF} chain and subcarrier to $1\,$W.
Because of the losses and possible impedance mismatch between the \ac{RF} chains and the \ac{DSA} at the $\Na$ input ports, the efficiency of the \ac{DSA} is, in general, less than one, then ${\Prad}_{,n}^{(k)}\le 1\,$W.

In general, one may aim to solve the following  optimization problem for given objective end-to-end channel matrices  $\boldHopt^{(k)} \in \mathbb{C}^{T \times \Na}$, $k=1,2, \ldots, K$,   
%
\begin{equation} \label{eq:opt}
\hat{\btheta}=\arg \min_{\btheta} \sum_{k=1}^K \left\|\, \alpha^{(k)} \, \boldH_c^{(k)} \,   \left ( \boldZ_{\text{L}}^{(k)}(\btheta)  +\boldZ^{(k)}  \right )^{-1} \boldV -   \boldHopt^{(k)} \right\|^2_{\mathrm{F}}   
\end{equation}
%
where $\alpha^{(k)}$ is a normalization constant, and $\| \cdot \|_{\mathrm{F}}$ denotes the Fronebous norm.
The $t$th row of $\boldHopt^{(k)}$ represents the desired end-to-end channel response associated with the $n$th port and the $k$th subcarrier of the \ac{DSA}. It is worth noticing that with the same configuration $\hat{\btheta}$ of the \ac{DSA}, $\Na \times K$ different space-frequency responses are obtained simultaneously, each one associated with one specific subcarrier and the input port of one specific \ac{RF} chain.  
 
Regarding the reconfigurable load, we consider a varactor diode whose circuit model is reported in Fig. \ref{Fig:DSA} (right-bottom) as suggested in  \cite{SamRuiQinCha:20}. 
The corresponding impedance is
%
\begin{equation}
z_n^{(k)}(\theta_n)=\frac{j 2 \pi f_k L_1 (j 2 \pi f_k  L_2+1/(j 2 \pi f_k \, C(\theta_n))+R_v)}{j 2 \pi f_k (L_1+L_2)+1/(j 2 \pi f_k \, C(\theta_n))+R_v} 
\end{equation}
%
where $C(\theta)=C_{\text{min}}+(C_{\text{max}}-C_{\text{min}}) (\tan^{-1}(\theta)+\pi/2)/\pi$, being $C_{\text{min}}$ and $C_{\text{max}}$, respectively, the minimum and maximum capacitance of the varactor. The relationship between the optimization parameter $\theta$ and $C$ has been chosen so that $\theta$ is unbounded and the optimization problem in \eqref{eq:opt} becomes unconstrained, thus making its numerical solution computation faster.   
For convenience, we embed in $z_n^{(k)}(\theta_n)$, for $n=1,2, \ldots \Na$, also the internal resistance $R$ of the \ac{RF} chain. In the numerical results, the following parameters have been considered: $R_v=0.1\,$Ohm, $L_1=2.5\,$nH, $L_2=0.7 \,$nH, $C_{\text{min}}=0.47\,$pF, $C_{\text{max}}=2.35\,$pF \cite{SamRuiQinCha:20}.
 

\begin{figure}[t]
  \centering
  \includegraphics[width=0.8\columnwidth]{Figures/Na4Nc1Ny7R01.pdf}
  \caption{Single-carrier beam forming with $\Na=4$ \ac{RF} chains.}
  \label{Fig:PatternDSAMono}
\end{figure}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.8\columnwidth]{Figures/Na1Nc4Ny7R01.pdf}
  \caption{Multi-carrier beam forming with one \ac{RF} chain ($\Na=1$) and $K=4$ subcarriers.}
  \label{Fig:PatternDSAColor}
\end{figure}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.9\columnwidth]{Figures/Na2Nc2Ny7R01.pdf}
  \caption{Joint angle-frequency beamforming  $\Na=2$ \ac{RF} chains and $K=2$ subcarriers.}
  \label{Fig:PatternHybrid}
\end{figure}
  

\section{Numerical Results}

The following parameters have been considered in the numerical evaluations if not otherwise specified: $f_0=2.4\,$GHz,  $R=75\,$Ohm, $\Gr=0\,$dB, $W=80\,$MHz. 
 Half-wave dipoles with vertical polarization ($z$-axis) have been considered for the analytical evaluation of the impedance matrix $\boldZ^{(k)}$ at each subcarrier's frequency \cite{BalB:16}. 
%
The scatterers of the \ac{DSA} were deployed according to $L=7$ concentric circles with an incremental radius of step  $\Delta=\lambda_0/4$ and separated of $\lambda/4$ along the circle and the $y$ axis corresponding to $\Ns=214$ scatterers, where $\lambda_0$ denotes the wavelength at $f_0$. Numerical investigations have put evidence that the spacing $\Delta=\lambda_0/4\,$ results in a better performance   \cite{Dar:C24}.  
This disk-like structure appears very appealing especially for its use in base stations or access points thanks to its circular symmetry. 
Obviously, other structures, even 3D, can be considered as well depending on the specific application. 

We first investigate the single-carrier beam forming capabilities of the \ac{DSA} using $\Na=4$ \ac{RF} chains (inputs). 
A uniform set of $T=108$  test points $\boldp_t=[d\sin \phi_t ,0 ,d \cos \phi_t]^\transpose$ on the $x-z$ plane a distance $d=100\,$m (far-field region) was considered, with $\phi_t=2 \pi t / T$.
The purpose is to associate a narrow beam radiation diagram to each \ac{RF} chain (i.e., data stream) steering towards a specific angle, respectively,  $180^{\circ}$, $270^{\circ}$, $0^{\circ}$, and $90^{\circ}$.  
This can be achieved  by setting   $[\boldHopt^{(1)}]_{(t_i,i)}=1$, for $i=1,2, \ldots \Na$ and zero otherwise, where $t_i$ denotes the index of the test point corresponding to the $i$th steering angle.   
The standard numerical tool based on the quasi-Newton method %\cite{FleB:80} 
with $5000$ iterations has been utilized to minimize \eqref{eq:opt}.

In Fig.~\ref{Fig:PatternDSAMono}, the radiation diagrams for the 4 steering angles are shown.    
As it can be observed, the gain of the \ac{DSA} is independent of the angle and it is about $16-17\,$dB. In addition, limited back radiation is obtained without the need to insert a ground plane that would impede the steering in the opposite direction.
%angle range $[90^{\circ} - 270^{\circ}]$. 
The \ac{DSA} exhibits superdirectivity capability with an additional gain of about $5\,$dB with respect to a conventional array with the same aperture of the  \ac{DSA}. 
Contrary to standard arrays, where superdirectivity is obtained only in the end-fire direction \cite{IvrNos:14}, superdirectivity is notably obtained in all steering directions.  Further examples of \ac{DSA} design for single-carrier systems to realize superdirective beamforming, and \ac{MIMO} precoding can be found in \cite{Dar:C24}. 
 
The capability of the \ac{DSA} to provide frequency-selective radiation diagrams can be observed in Fig.~\ref{Fig:PatternDSAColor}, where $K=4$ subcarriers where considered each of them associated with a different steering angle, respectively, $180^{\circ}$, $210^{\circ}$, $240^{\circ}$, and $270^{\circ}$, respectively. Compared to the single-carrier situation, the diagrams present slightly higher sidelobes indicating that managing wideband signals with the same configuration parameters of the \ac{DSA} is more challenging. 

Finally, the joint space-frequency performance of the \ac{DSA} is reported in Fig. \ref{Fig:PatternHybrid} obtained with $\Na=2$ \ac{RF} chains and   $K=2$ subcarriers. The target steering angles for each input/subcarrier (sc) combination are: $180^{\circ}$ (input 1, sc 1), $210^{\circ}$ (input 1, sc 2), $270^{\circ}$ (input 2, sc 1), and $300^{\circ}$ (input 2, sc 2). The plots show that with the same configuration $\btheta$, obtained from the minimization of \eqref{eq:opt}, the \ac{DSA} is capable of associating a dedicated superdirective beam to each input/subcarrier combination.

The gain and efficiency of the \ac{DSA} for the cases analyzed before, is reported in Table 1. In particular, $\eta_1$ and $\eta_2$ represent, respectively, the efficiency in case of a lossless \ac{DSA} caused by imperfect impedance matching at the input ports and the overall efficiency accounting also for the losses. As can be noticed, most of the efficiency decreases due to the losses indicating that a discrete impedance matching is typically achieved during the optimization process.      





\begin{table}[tp]
\caption{}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
Fig. 2   \\
 \hline
 Configuration & Gain (dB) & $\eta_1$ & $\eta_2$ \\
 \hline
input 1   & 17 & 0.82 & 0.68 \\
input 2  & 16 & 0.84 & 0.68 \\ 
input 3 & 16.3 & 0.88 & 0.71 \\
input 4  & 16.3 & 0.82 & 0.64 \\
\hline
Fig. 3 \\
\hline
Configuration & Gain (dB) & $\eta_1$ & $\eta_2$ \\
 \hline
sc 1   & 16.7 & 0.97 & 0.83 \\
sc 2  & 15.1 & 0.97 & 0.69 \\ 
sc 3 & 15.3 & 0.98 & 0.56 \\
sc 4  & 15.7 & 0.92 & 0.48 \\
\hline
Fig. 4 \\
\hline
Configuration & Gain (dB) & $\eta_1$ & $\eta_2$ \\
 \hline
input 1, sc 1   & 16.6 & 0.95 & 0.78 \\
input 2, sc 2  & 15.9 & 0.95 & 0.60 \\ 
input 2, sc 1 & 16.5 & 0.94 & 0.77 \\
input 2, sc 2  & 15.6 & 0.97 & 0.59 \\
\hline
\end{tabular}
\end{center}
\label{Table:Cylinder}
\end{table}




\section{Conclusion}

In this paper, we have explored a frequency-selective \acf{DSA} as a promising technology designed to shift signal processing tasks from the digital domain to the \ac{EM} domain. This is achieved through the joint optimization of \ac{EM} processing and the radiation of a few active and many reconfigurable scattering elements interacting within the reactive near field.
%
The \ac{DSA} offers an interesting capability to manage the \ac{EM} field.
 %reducing or bypassing digital processing at the baseband. 
 This enables greater flexibility compared to traditional \ac{MIMO} and recent \ac{SIM} implementations. By minimizing the number of \ac{RF} chains, \ac{DSA} facilitates the development of energy-efficient, low-latency, and cost-effective holographic \ac{MIMO} systems, addressing the sustainability challenges of future wireless networks.

\section*{Acknowledgment}
This work was supported by the European Union under the Italian National Recovery and Resilience Plan (NRRP) of NextGeneration EU, partnership on ``Telecommunications of the Future" (PE00000001 - program ``RESTART"), and by the HORIZON-JU-SNS-2022-STREAM-B-01-03 6G-SHINE project (Grant Agreement No. 101095738).


%\bibliographystyle{IEEEtran}
%\bibliography{IEEEabrv,BiblioDD,../../../Bibliography/MetaSurfaces,../../../Bibliography/EMInformationTheory,../../../Bibliography/IntelligentSurfaces,../../../Bibliography/MassiveMIMO,../../../Bibliography/MIMO,../../../Bibliography/THzComm,../../../Bibliography/EMTheory,../../../Bibliography/WINS-Books,../../../Bibliography/Vari}

\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv,BiblioDD,MetaSurfaces,EMInformationTheory,IntelligentSurfaces,MassiveMIMO,MIMO,THzComm,EMTheory,WINS-Books,Vari}





\end{document}
