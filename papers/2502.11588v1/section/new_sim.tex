\section{AutoPT-Sim: A Unified Simulation Modeling Framework for Automated Penetration Testing}
% 根据当前现有研究的场景建模方法覆盖不全面、变化性小，缺乏完全动态场景建模、且缺乏公开数据集的现状，我们构建了一个以策略自动化为基础，覆盖另外三个维度——场景模拟复杂度、前后技战术关联度与场景反馈与变化——所有层次的建模框架，并提供一套完整、公开的数据集，意在为后续研究提供基础。我们的数据集在github平台可获取，也欢迎任何友善、有建设性的意见用于丰富我们的构建标准与数据集。除此之外，我们还构建了一套接口，作为后续战术自动化与全流程自动化的扩展基础。
% \subsection{\modelsim}
% 我们的建模方法聚焦于支撑在内部网络中进行自动化渗透测试相关研究，达成策略自动化的场景自动化目标，能够模拟渗透测试的全阶段，如信息收集、建立立足点、提升权限、横向移动、持久化等，设置多种网络架构与目标资产建模方法，支持动态网络构建，全面地构建了攻击者和防御者的动作，支持定制化的选择。
% 针对现有自动化渗透测试仿真建模方法关注中小型网络建模、忽略大型网络及不同网络架构的构建；忽略完全动态网络建模和缺乏灵活性、没有提供多维度和多层次模拟建模的统一方法的问题，
% Addressing the existing AutoPT simulation modeling methods that focus on modeling small or medium networks, neglecting the construction of large-scale networks and different network architectures; ignoring fully dynamic network modeling, scenario modeling methods are not comprehensive, exhibit limited variability, not providing a unified method for multi-dimensional and multi-level simulation modeling, devoid of public datasets. we have developed a modeling framework AutoPT Simulation Modeling Framework (\modelsim) that leverages policy automation and integrates all sub-dimensions across the other three dimensions of \modelcla.  It addresses all levels and offers a complete public dataset to support future research. Our publicly network simulation dataset and the code of Network Generator are available on GitHub\wyf{add link later}, and we welcome constructive feedback to enhance our standards and dataset. we will first introduce \modelsim, followed by the usage methods of it, the publicly available datasets and accompanying Network Generator code.

\begin{figure*}[tb]
    \centering
    \includegraphics[width=150mm]{figure/three_topology.pdf}
    \caption{Three Types of Network Topology in~\modelsim}
    \label{three_kind_topology}
\end{figure*}

Current scenario modeling methods are often incomplete, exhibit low variability, lack fully dynamic capabilities, and are hindered by the absence of public datasets. To address these limitations, we introduce the AutoPT Simulation Modeling Framework (\modelsim), which leverages policy automation to integrate all sub-dimensions of the \modelcla~framework across its three primary dimensions. Additionally, we provide a comprehensive and publicly accessible dataset on GitHub\footnote{www.github.com/feifei-feifei-hub/Simulation-Modeling-for-Automated-Penetration-Testing} to support future research endeavors. We welcome constructive feedback to refine our standards and dataset further. Furthermore, we have developed a suite of interfaces to underpin future extensions in tactical and full-process automation.

% 接下来，我们将首先介绍我们的模型，然后介绍模型的使用方法和公开数据集。

% Moreover, we have also developed a set of interfaces as the expansion basis for the automation of tactics and full-process automation.

\subsection{AutoPT Simulation Modeling Framework}
Our model enables AutoPT research within internal networks by automating policy scenarios and simulating all penetration testing phases, including information gathering, foothold establishment, privilege escalation, lateral movement, and persistence. We provide diverse network architectures and asset modeling techniques to support dynamic network construction. Additionally, attacker and defender actions are comprehensively modeled, allowing for customizable configurations.
% \subsubsection{网络架构与目标资产建模}
% 网络架构与目标资产共同构成了目标网络，我们使用图的形式构建目标网络。图$G = (V,E,X)$是一种数据结构，它对一组对象（节点）$V$及其关系（边）$E$进行建模，$X$代表节点与边的属性集合。计算机网络天然的具有图数据的特征\cite{2024Graph}。网络图中的节点$V=\{1,2,3,\dots,N\}$代表不同的网络设备，$i$节点的属性$X_i$代表系统、服务、账号密码等资产信息；网络图中的链路$E$代表节点之间通信关系，包括有线和无线连接，当节点$i$与节点$j$能相互通信时，代表$i$与$j$之间存在一条边$e_{ij}$，并可以通过定义链路的属性$X_{ij}$设置节点之间通信相关属性，如协议、流量大小等。

% NetworkX包库允许生成有向、异构的网络图，但是我们的建模聚焦于支撑内部网络的自动化渗透测试研究，达到策略自动化目标和更广泛的适用性，且现实生活中网络设备变化多样，难以全部模拟，因此我们采用了一种更为简单的方式表现多样的网络设备与软件服务。我们将网络图中的节点全部设置为一种模式，在有需要的情况下，设置"type"属性体现不同节点的类型；将网络图中的链路全部设置为双向连接，模拟攻击者在内部网络中移动时具有更高自由度的情况。具体的网络架构与目标资产建模方式如下。

% \textbf{网络架构建模}

% 网络架构在我们的框架中指的是网络图中的边及网络拓扑的建模。边代表着计算机网络中逻辑上的连接关系，可能通过网络协议或物理链路实现。当节点$i$与节点$j$能相互通信时，代表$i$与$j$之间存在一条边。在模拟网络中，我们定义同一个局域网之间的节点可以直接通信，即相互直连；不同局域网之间的节点，则必须通过交换节点进行通信。网络图中的边默认为无向边，也就是两个节点之间可以相互通信。由于现实生活中网络拓扑是多样变化的，只采用一种拓扑难以体现网络多样变化的特征，在我们的框架中，设计了多种经典的网络拓扑，并根据专家经验设计了一种自定义的分区分层拓扑网络，各类网络拓扑的详细描述如下。

\subsubsection{Network Architecture and Target Asset Modeling}
We model the target network by combining its architecture and assets into a graph $G = (V, E, X)$, where nodes $V$ represent network devices, edges $E$ denote their connections, and $X$ captures attributes for both nodes and edges. Computer networks naturally form graph structures~\cite{2024Graph}. Each node $V = \{1, 2, 3, \dots, N\}$ corresponds to a device, with attributes $X_i$ detailing systems, services, and credentials. Edges $E$ represent both wired and wireless communications. An edge $e_{ij}$ exists if node $i$ can communicate with node $j$, with link attributes $X_{ij}$ specifying protocols, traffic size, and more. All nodes have a type attribute distinguishing categories like server or switch, effectively capturing configurations and functionalities through attributes such as software and services.

% NetworkX allows for the generation of directed and heterogeneous network graphs. However, our modeling focuses on supporting research on AutoPT in internal networks to achieve the goal of policy automation and broader applicability. Due to the diversity of real-world network devices and the complexity of simulating all variations, we simplify representations of network devices and software services. We use a single mode for all nodes and utilize the "type" attribute to delineate distinct node categories, such as "server" or "switch", effectively showcasing configuration and functionality through node attributes, including software and services. 


To emulate attackers' extensive maneuverability in internal networks, all connections are bidirectional. Our penetration testing framework emphasizes lateral movement by focusing on node configurations and attributes rather than simulating traffic. We incorporate various network topologies to reflect real-world diversity, and our network generator allows for the expansion of directed links and link attributes to represent data flow characteristics. The specific methods for network architecture and target asset modeling are detailed below.


% To replicate the expansive maneuverability attackers possess within internal networks, all connections are designed as bidirectional. Our penetration testing framework emphasizes lateral movement, focusing on node configuration and attributes rather than traffic simulation. We integrate various network topologies to reflect the diversity of real-world networks. Our network generator also supports the expansion of directed links and link attributes to represent data flow characteristics within networks. The specific methods for network architecture and target asset modeling are as follows.



% We use a single mode for all nodes and employ the "type" attribute to differentiate node types as needed. 基于节点的“type”的属性和其他的软件、服务等属性，已经可以充分展示节点的配置和功能。，All links are bidirectional to simulate the high degree of freedom available to attackers within internal networks. 渗透测试重点关注的是内部网络的横向渗透，因此没有构建网络的流量，而是着重构建节点的配置和属性，同时加上不同类型的网络拓扑，展示显示生活中网络多样性特点。如果需要添加链路的有向性和链路属性体现网络中的数据流向特点，我们的网络生成器也支持该功能的拓展。The specific methods for network architecture and target asset modeling are as follows.


\textbf{Network Architecture Modeling.}
% Within our framework, network architecture involves modeling the edges and topology of the network graph. 
% Edges represent the logical connections, achieved through network protocols or physical links. Communication between nodes $i$ and $j$ indicates an edge. 
% In our simulated network, nodes on the same LAN are directly connected, while nodes across different LANs communicate via a switch node. Edges in the network graph are default to be undirected, meaning that two nodes can communicate with each other. Given the variation of real-world network topologies, a single topology fails to reflect the variable nature of networks. Therefore, our framework incorporates various classic topologies and partitioned and layered topology based on expert insights. Detailed descriptions of these topologies are provided. The topologies are shown in Figure~\ref{three_kind_topology}.
Our simulated network model assumes direct connections between nodes on the same LAN and switch-mediated communication between nodes on different LANs. The network graph features undirected edges, enabling bidirectional communication between nodes. To capture the diversity of real-world network topologies, our framework incorporates multiple classic topologies, as well as partitioned and layered topologies informed by expert insights. These topologies are illustrated in Figure~\ref{three_kind_topology}.


% \begin{itemize}
%     \item 分区分层拓扑网络：分区分层拓扑网络是我们通过Sarraute等人~\cite{sarraute2012pomdps}首次开发的用于测试性能的网络描述及其他相关文献，咨询网络安全专家意见、结合网络安全专家经验得到的一种自定义网络拓扑。目标网络整体划分为3个区域——DMZ区、普通业务区、敏感业务区。（1）DMZ区是与外部互联网、普通业务区相连接，所有允许外部访问的节点都有可能成为入口点，在这一区域的节点防御设备较少、防火墙的准入规则宽泛、节点内部存在敏感信息概率低、账户权限低，在这一区域内的所有节点都是相互连接的。（2）普通用户区：与DMZ、敏感业务区相连接、内部具有多个子网，防御的能力有所提升、可能部分节点中存在敏感信息、高等级账户等，不同子网由防火墙/路由器/交换机控制连接关系。（3）敏感业务区：仅与普通业务区的存在连接，子网数目较少，通常为1-3个，防御能力最强，控制接入最严格，节点数目较少，但容易发现敏感信息，子网内的节点相互连接，不同子网由防火墙/路由器/交换机控制连接关系。
%     \item 树状拓扑网络~\cite{Brede2012NetworksAnIM}：计算机网络经典架构，在树状拓扑中，节点按照层次来组织，通常包含一个根节点（Root Node），多个枝节点（Branch Nodes）和叶节点（Leaf Nodes）。 数据在网络中传输的路径是唯一的，这有助于控制和管理网络流量。 如果某个节点或链路发生故障，通常只会影响到该节点以下的部分网络，而不会影响到整个网络。树状拓扑常用于宽带网络中，例如在以太网中，可以用作主从结构，其中根节点或中心节点通常是一个交换机或集线器，而枝节点和叶节点则是各个工作站或计算机。树状拓扑结构的网络易于管理，但缺点是如果中心节点出现问题，整个网络可能会瘫痪。
%     \item Fattree拓扑网络~\cite{al2008scalable}：FatTree拓扑网络is A Scalable, Commodity Data Center Network Architecture.旨在解决传统网络拓扑在规模和带宽扩展性方面的限制。通过使用多个小规模、低成本的单元构建复杂，大规模的架构，因其优异的性能和可扩展性，在数据中心网络设计中得到了广泛的应用。它能够有效地支持大规模服务器集群和分布式计算环境，满足高性能计算和大数据处理的需求。FatTree是一个k叉树，即假设交换机的端口数量为$k$,核心交换机数量为 $(k/2)^2$，pod的数量为$k$；每个pod分为两层，每层$k/2$个交换机，上层称为汇聚层，下层称为接入层（也称Edge Layer）；汇聚层$k/2$的端口连接$k/2$的核心交换机，剩下的端口连接接入层的交换机；接入层同上，一半的端口连接上一层，一半的端口连接下面的主机。每个层次的交换机数量是上一层次的二倍，而每个交换机的端口数量则随着层次的提高而减少。这种设计使得网络的总带宽随着层次的增加而增加，。
% \end{itemize}
\begin{itemize}
    \item \textbf{Partitioned and Layered Topology Network}: We employ a customized network topology, initially introduced by Sarraute et al.~\cite{sarraute2012pomdps} and subsequently refined through expert consultation with cybersecurity professionals. The PLTN architecture is specifically designed for performance testing and comprises three distinct regions: (1) the Demilitarized Zone (DMZ), (2) the General Business Area, and (3) the Sensitive Business Area.

        \begin{enumerate}
            \item \textbf{DMZ} connects the external internet to the general business area. It features interconnected nodes with minimal defenses, lenient firewall rules, and lower account privileges, making it a potential entry point but less likely to contain sensitive information.
            \item \textbf{General Business Area} acts as a bridge between the DMZ and the sensitive business area. It includes multiple subnets with enhanced defenses, some sensitive data, and high-level accounts. Connections between subnets are managed by devices like firewalls and routers.
            \item \textbf{Sensitive Business Area} connects only to the general business area and consists of 1-3 subnets with the strongest defenses and strict access controls. It has fewer nodes but is more likely to contain sensitive information, with connectivity managed similarly to the general business area.
        \end{enumerate}
        Backup switches enhance network robustness by demonstrating variability in node connections across different layers and LANs. This setup reflects the network's inherent randomness and adaptability.

    \item \textbf{Tree Topology Network}~\cite{Brede2012NetworksAnIM}: A classic network architecture where nodes are arranged in layers, typically consisting of a root, branch, and leaf nodes. Each node has a unique data transmission path, simplifying traffic control and management. The failure of a node or link affects only its subtree. Common in broadband networks like Ethernet, the central node is usually a switch or hub, with branches and leaves as workstations or computers. While easy to manage, a central node failure can jeopardize the entire network.

    % \item \textbf{FatTree Topology Network}~\cite{al2008scalable}: A scalable, commodity data center network architecture for data centers, addressing the limitations of traditional network topologies in terms of scale and bandwidth scalability. By using multiple small-scale, low-cost units to build a complex, large-scale architecture, it has gained widespread application in data center network design due to its excellent performance and scalability. It supports large server clusters and distributed computing, ideal for high-performance and big data tasks. FatTree is a k-ary tree, where the number of ports on a switch is $k$, the number of core switches is $(k/2)^2$, and the number of pods is $k$. Each pod is divided into two layers, with $k/2$ switches per layer. The upper layer is the aggregation layer, and the lower layer is the access layer (also called the Edge Layer). The aggregation layer's $k/2$ ports connect to $k/2$ core switches, and the remaining ports connect to switches in the access layer. Similarly, in the access layer, half of the ports connect to the layer above, and half connect to the hosts below. The number of switches at each level is twice that of the previous level, while the number of ports per switch decreases as the level increases. It features scalable bandwidth and hierarchical connectivity, with core and pod layers, enhancing total network bandwidth as levels increase. 

    \item \textbf{FatTree Topology Network}~\cite{al2008scalable}: This scalable data center network architecture addresses traditional topology limitations, offering improved scale and bandwidth. By employing multiple low-cost units, it builds a large-scale structure ideal for high-performance computing and big data tasks. The FatTree is a $k$-ary tree with $k$ ports per switch, $(k/2)^2$ core switches, and $k$ pods. Each pod contains two layers: the aggregation layer and the access layer (or edge layer), each with $k/2$ switches. Aggregation layer ports connect to core switches and access layer switches. In the access layer, ports connect to the aggregation layer and hosts. This design enhances network performance with scalable bandwidth and hierarchical connectivity.

\end{itemize}

We use the topology type as input for the network generator, enabling researchers to easily create diverse network topologies and utilize implicit information within them.

\textbf{Target Asset Modeling.}
Our framework models nodes in a network graph using hypothetical and authentic attribute simulations.

\textbf{Simulation of Hypothetical Attributes}: We follow Hammar et al.~\cite{2020Finding} to assign node attributes, creating networks with hypothetical attributes. Each node is assigned $m+1$ values: the first $m$ reflect its defensive capabilities, and the last indicates its anomaly detection capability. If a node has a vulnerability in the $i$-th defense, the $i$-th attribute value is set to $x_i \leq 1$. 

\textbf{Simulation of Authentic Attributes}: Leveraging expert insights, we identify critical attributes for penetration testing, setting unique attributes for each node to simulate authentic target assets:

\begin{itemize}
    \item \textbf{IP} ($ip$): The IP address of the node.
    % \item \textbf{Node Type}($'type'$): The type of the node. To simplify the representation of the network, we classify nodes into two categories based on their functions and roles in computer networks: one for data transmission—$'switch'$, and the other for processing, storing data, or providing services—$'server'$. Custom node types are supported. 
    \item \textbf{Node Type} ($type$): Nodes are classified as either switch for data transmission or server for processing and storage. Customizable types are supported.
    % \item \textbf{Local Area Network ID} ($'lan\_id'$): The ID indicating the node's LAN. Since our network architecture is built in a partitioned and layered manner, and there may be facilities such as firewalls, two nodes in the same network segment may not be connected, so we use the local area network for division, and nodes in the same LAN are assumed connected, reflecting our partitioned network design. 
    \item \textbf{Local Area Network ID} ($lan\_id$): Identifies the node's LAN, reflecting our partitioned network design. Nodes in the same LAN are assumed connected, despite possible internal firewalls.
    \item \textbf{Operating System} ($system$): Categorized as $windows$, $linux$, or $other$.
    \item \textbf{Open Ports and Services} ($port\_server\_version$): Lists the node’s open ports and associated services, including service versions. Scans may omit this information, particularly versions, so we simulate potential data loss with a predefined probability.
    \item \textbf{Installed Software and Versions} ($software\_version$): Details additional software on the node that doesn't provide external services and their versions, which might have vulnerabilities or sensitive data like passwords, accessible through specific methods.
    \item \textbf{Saved Account Passwords and Levels} ($account$): Encompasses standard, administrative, and domain administrator accounts.
    % \item \textbf{Existing Vulnerabilities and Vulnerability Exploit Success Rate}($'cve'$): Represents whether there are vulnerabilities such as weak passwords or other vulnerabilities related to the node's operating system, open services, and installed software, along with the probability of successful exploitation. We have collected XXX\wyf{add number} vulnerabilities across all operating systems and numerous services and software.  We employ CVSS scores~\cite{mell2007complete} and EPSS scores~\cite{2021Exploit} to set the success probability for each vulnerability. CVSS scores~\cite{mell2007complete} are used to assess the severity of these vulnerabilities, considering factors such as attack vector, complexity, required permissions, and impact scope, etc. Additionally, EPSS scores~\cite{2021Exploit} estimate the likelihood of exploitation in the wild over the last 30 days, with scores ranging from 0 to 1. Higher EPSS scores indicate a greater likelihood of exploitation. We employ the state-of-the-art EPSS v3 model~\cite{jacobs2023enhancing}, using score from October 16, 2024 as the basis for specifying the success probability of exploiting a vulnerability. 
     \item \textbf{Vulnerabilities and Vulnerability Exploit Success Rate} ($cve$): Indicates vulnerabilities related to the node's OS, services, software and weak passwords, alongside the likelihood of successful exploitation. We collected more than 500 vulnerabilities across various systems and services. CVSS scores assess severity based on factors like attack vector and complexity, while EPSS scores, from the latest EPSS v3 model, estimate exploitation likelihood in the wild, with higher scores indicating greater risk. The EPSS score from 2024.10, and CVSS  scores are used to determine exploitation success probability.
\end{itemize}

% 节点$i$的属性$X_i$设置如下：
% \begin{equation}
%     \begin{aligned}
%         x = \{\\
%         'ip'&: '192.168.2.105',\\
%         'type'&: 'server', \\
%         'lan\_id'&: '9', \\
%         'system'&: 'linux',\\
%         'port_server_version'&: [('3306', 'Cacti', '1.2.22'),\\
%         & ('6699', 'samba', '3.5.0') ],\\
%         'software_version'&:[('Struts2', '2.0.0'), \\
%         &('PostgreSQL', '9.3')],\\
%         'account'&:[('Tom','123QWE','root')],\\
%         'cve'&:[('CVE-2022-46169',0.65), \\
%         &('CVE-2017-7494',0.80)],\\
%         \}
%     \end{aligned}
% \end{equation}
% 链路属性可根据决策方法及研究需求进行设置。在智能决策时利用的节点及链路的属性信息可根据使用的决策方法与场景进行选择。
For example, the attributes $ X_i $ can be set as follows:
\begin{equation}
    \begin{aligned}
        X_i = \{
        'ip'&: '192.168.2.105',\\
        'type'&: 'server', \\
        'lan\_id'&: '9', \\
        'system'&: 'linux',\\
        'port\_server\_version'&: [('3306', 'Cacti', '1.2.22'),\\
        & ('6699', 'samba', '3.5.0') ],\\
        & ('22', 'ssh', 'Tom', 'Tom123') ],\\
        'software\_version'&:[('Struts2', '2.0.0'), \\
        &('PostgreSQL', '9.3')],\\
        'account'&:[('Tom','123QWE','root')],\\
        'cve'&:[('CVE-2022-46169',0.65), \\
        &('CVE-2017-7494',0.80)]\}
    \end{aligned}
\end{equation}
% Based on expert knowledge, an additional underlying pattern is considered in network structure generation. Nodes within the same LAN share some similarities, especially in terms of operating systems, installed software, and versions, such as the Windows operating system and Office productivity software. This indicates that they may have the same system vulnerabilities and software vulnerabilities - we simulate the real-world scenario of nodes in the same department sharing similarities. Due to different user habits, some vulnerabilities may be fixed by system patches or software version updating, which has also been simulated in our network.

To enhance network attribute generation, we incorporate an underlying pattern based on expert knowledge. Nodes within the same LAN often exhibit similarities, particularly concerning operating systems and installed software, such as Windows and Office. This suggests they may share common system and software vulnerabilities, mirroring real-world scenarios where nodes in the same department have similarities. However, due to varying user habits, some vulnerabilities may be addressed through system patches or software updates, and this aspect is also simulated in our network model.
Link attributes can be configured based on research needs and decision-making methods. The selection of node and link attributes for intelligent decision-making should align with the specific method and scenario.
% Link attributes can be configured based on research needs and decision-making methods. The node and link attribute information used in intelligent decision-making should be chosen according to the specific method and scenario. 
% \subsubsection{攻击者、防御者建模}
% 在本节中，我们通过总结现有文献的常用手段及专家经验，提供了攻击者和防御者动作的建模。

% 攻击者的动作为：对某一个节点的某一维度增加数值为1的攻击值，逐次叠加，当该节点某一属性的攻击值大于该节点的防御值时，代表该节点攻击成功（需要更数值化的描述）。
% 防御者的动作定义为对某一个节点的某一维度增加数值为1的防御值，或采用检测动作，基于概率判断是否发现攻击者。

% 在真实属性网络建模的攻击者与防御者建模则复杂得多。
\subsubsection{Attacker and Defender Modeling}
% \wyf{beyond ATT\&CK}
% In this section, we model attacker and defender actions by synthesizing common methods from existing literature and expert experience.

% Firstly, for the modeling of attackers and defenders under non-real attribute network modeling, we also refer to the settings by Hammar et al.~\cite{2020Finding} in their article.

% For attackers and defenders modeling in hypothetical  attribute networks, we reference the settings by Hammar et al.~\cite{2020Finding}. Attackers increase a node’s attack value by 1 in a specific dimension, stacking incrementally. A successful attack occurs when a node’s attribute attack value surpasses its defense value. Defenders' actions are defined as adding a defense value of 1 to a certain dimension of a node, or adopting a detection action, based on probability to determine whether the attacker is discovered.

% Modeling attackers and defenders in authentic attribute network modeling is significantly more complex.

In this section, we model attacker and defender actions by integrating established methods from literature and expert insights.
For hypothetical attribute networks, we follow the settings by Hammar et al.~\cite{2020Finding}. Attackers increment a node's attack value by 1 in a specific dimension. An attack succeeds when this value exceeds the node's defense value. Defenders can add a defense value of 1 to a node or detect attackers probabilistically. For real attribute networks, we employ a more complex and realistic modeling approach for attackers.


% \textbf{攻击者建模}

% 攻击者建模的主要依据来源于Mitre公司构建的ATT\&CK模型，其中技战术共包括14个阶段：扫描、资源发现、初始访问、执行、提权、漏洞利用、凭据登录、持久化、主机信息收集、防御规避、横向移动、信息传递。其中每个阶段可以利用的技术、需要的执行信息及执行后的返回结果为：
% \begin{itemize}
%     \item 扫描：输入目标节点，返回该节点的外部属性信息，其中端口与服务通常成对返回，服务软件版本以0.5的概率返回。
%     \item 资源发现：资源建立主要通过前期工作收集的指纹漏洞库、弱密码库、载荷库等内容，在智能决策中不考虑该阶段的决策。
%     \item 初始访问：可以通过漏洞利用、钓鱼邮件、弱口令爆破、凭据登录等动作达成。
%     \item 提权：智能体决策对哪一个主机进行提权，可以通过漏洞利用、弱口令爆破等动作达成。
%     \item 持久化：决策保留哪几个节点的持久利用。
%     \item 主机信息收集：获取某一个主机的权限后，进行该动作可以获取主机全部属性信息及账号密码等敏感信息。
%     \item 防御规避：对某一个节点上采取的动作进行痕迹清理，降低被发现的概率。
%     \item 横向移动：向哪一个主机进行移动，需同时决策移动的目标节点及对该节点使用的访问手段。
%     \item 信息渗漏：在某一个节点获取了敏感信息后是否需要向外部进行传递。
% \end{itemize}

% 基于以上阶段是否需要进行智能决策、决策内容与可能方法分析，并结合相关研究中最常用的攻击动作、实际生活中进行渗透动作的参数需求，我们将攻击者动作构建及详细信息列于下表：
\textbf{Attacker Modeling.}
% We base our attacker modeling on the ATT\&CK framework by Mitre Corporation, which outlines 14 tactic and technique phases.
Our attacker modeling is based on the MITRE ATT\&CK framework, which outlines 14 tactic and technique phases.
% Reconnaissance, Resource Development, Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control, Exfiltration, and Impact. 
Below are the methods applicable at each phase, the necessary execution details, and the results obtained.
\input{tables/AttackerActionModeling}

\begin{itemize}
    \item \textbf{Reconnaissance:} Input the target node IP and return its attack surface attributes. Ports and services are paired, and service software versions have a 50\% chance of being returned.
    \item \textbf{Resource Development:} Establish resources like fingerprint vulnerabilities, weak password libraries, and payloads collected before penetration testing. This is a preparatory phase rather than a decision-making stage in intelligent decision processes. During penetration, experts choose suitable resources and tools from what's available. The thoroughness of this preparation dictates the range of potential actions.
    \item \textbf{Initial Access:} Achieved via actions such as exploiting vulnerabilities, phishing, cracking weak passwords, and using credentials.
    \item \textbf{Execution:} Indicates that the attacker has gained initial access to a target network node and is running attack-related code. This is typically accomplished by exploiting vulnerabilities to subsequently gather system information, sensitive data, and additional node content.
    \item \textbf{Persistence:} Determine which nodes to maintain access to for ongoing exploitation.
    \item \textbf{Privilege Escalation:} Decide where to escalate privileges using vulnerabilities, password cracking, or credential login.
    \item \textbf{Defense Evasion:} Erase traces of actions on a node to reduce detection chances.
    \item \textbf{Credential Access:} Use credentials such as passwords, cookies, tokens, tickets, and cryptographic elements including hashes, keys, certificates, fingerprints, and biometric data to obtain node access permissions. In modeling, we use the 'Credential Access' action to encompass these various attack methods.
    \item \textbf{Discovery:} Internal network reconnaissance by gathering system and network info through techniques like discovery of account, address space, URL, and system, aiding in mapping environments of compromised hosts. 
    % \item \textbf{Host Information Gathering:} Obtain full host attribute and sensitive information such as account passwords and the flag.
    \item \textbf{Lateral Movement:} Select a host to move to, decide on the target node and the access method..
    \item \textbf{Collection:} Attackers collect valuable information, such as drive types, browsers, audio, video, email, and file contents. In modeling, we use "Obtain Sensitive Information" action to encompass all techniques at this stage and restrict the information gathered to the internal data of the controlled host, distinguishing it from the externally exposed surface data collected via active scanning during the Renaissance or Discovery phases.
    \item \textbf{Command and Control:} Remotely control the host to execute commands and operations, potentially leading to information leakage and connection manipulation by exploiting vulnerabilities.
    \item \textbf{Exfiltration:} Decide on transmitting sensitive information externally after collection.
    \item \textbf{Impact:} Aim to manipulate, disrupt, or interfere with systems and data.
\end{itemize}


% Based on the analysis of whether intelligent decision-making is required at each of the above phases, decisions' content, and the possible methods, and in conjunction with the most commonly used attack actions in related research and the parameter requirements for penetration actions in real life, we list the construction and detailed information of attacker actions in table~\ref{tab:attacker_action_modeling}.

Based on our analysis of intelligent decision-making needs, decision content, methods, common attack actions in research, and real-life penetration parameters, we provide a detailed list of attacker actions in Table~\ref{tab:attacker_action_modeling}.

% \textbf{防御者建模}

% 防御者建模的主要依据来源于阅读论文的总结以及现实生活中常用的防御手段，具体动作见下表：
% \input{tables/防御者动作建模}
% 除了表格中的动作之外，可以通过定义接节点之间的通信关系、漏洞利用成功率、钓鱼邮件成功率等设置隐式的防御；还可以通过网络的动态变化模拟动态目标防御、拟态网络等防御策略。

% 值得注意的是，攻击者和防御者中部分动作会引起目标网络背景的网络架构与目标资产被动变化，我们已经在表格中进行标注。在对攻击者和防御者进行建模时，不一定要包含所有的动作行程完整的渗透阶段，可以根据每一个动作应用的阶段只选择必要的动作，也可以对动作的决策参数进行简化，达到独立技战术与连续技战术的灵活运用。

% \subsection{公开的github数据集}
% 基于我们提出的\modelsim，构建了一个网络生成器，用于生成多种网络架构与不同属性模拟的目标网络，同时还提供了一个已经生成的标准数据集，包括数值模拟网络、属性模拟网络、连续时间数值模拟网络、连续时间属性模拟网络。
% \begin{itemize}
%     \item 数值模拟网络
%     \item 属性模拟网络
%     \item 连续时间数值模拟网络
%     \item 连续时间属性模拟网络
% \end{itemize}

\textbf{Defender Modeling.}
Defender modeling integrates research and practical defense strategies.
% 在现实生活中，网络管理员或安全人员可以通过修补漏洞、入侵检测系统、流量监控等提高网络整体的检测能力与防御能力，也可以通过设置节点主动离线、IP屏蔽等措施终端攻击者建立的会话，通过清除登陆凭据使攻击者无法从已经攻击成功的节点中获取有效信息，通过蜜罐、溯源等方法引诱攻击者攻击，主动获取攻击者信息，达到主动防御的目的，也可以通过实施大范围的网络安全教育，提高人员的网络安全意识，从而有效降低钓鱼邮件等攻击手段的成功率。
Network administrators enhance detection and defense by patching vulnerabilities, deploying intrusion detection systems (IDS), and monitoring traffic. They terminate attacker sessions by taking nodes offline, blocking IPs, and clearing login credentials to protect compromised nodes. Detailed actions are in Table~\ref{tab:defender_actions}.

\input{tables/DefenderActionModeling}
% 在现实环境中，网络环境对防御者而言虽然是透明的，但是防御者对攻击者的动作是未知的，现有AutoPT研究中，通常使用为防御者定义检测动作或检测能力的方式体现防御者希望捕捉攻击者痕迹的愿景，但是在我们的建模中，除了传统的检测或修补手段，我们还定义了
% In real-world scenarios, while the network environment is transparent to the defender, the attacker's actions remain hidden. Traditional AutoPT research often models the defender's awareness of the attacker through detection actions or capabilities. Our approach, in addition to conventional defense measures such as enhancing defense capabilities and strengthening detection, we have also added proactive defense measures such as IP blacklisting, honeypots, and countermeasure to actively capture the traces and related information of attackers. We've also integrated social engineering modeling through extensive security education to boost user literacy, thereby reducing phishing email success rates and enhancing network defense.

In real-world scenarios, the network is visible to defenders, but attackers' actions are concealed. Traditional AutoPT research models defender awareness through detection. Our approach enhances defense capabilities and detection, incorporating proactive measures like IP blacklisting, honeypots, and countermeasures to capture attacker traces. We have also integrated social engineering defense by providing extensive security education to reduce phishing success rates and strengthen network security.


% Beyond these tabled actions, implicit defenses can be established by defining communication relationships between nodes. It is also possible to simulate dynamic target defense, mimic networks, and other defensive strategies through dynamic changes in the network. Especially in zero trust network environment, this is a trendy defense method that improves the network's defense capability through continuous and dynamic verification procedures. Within our modeling framework, we emulate continuous authentication by regularly updating node login credentials. Attackers are restricted to achieving session persistence only through credential-logging methods. By adjusting inter-node communication and simulating granular access controls, we can effectively abstract and model zero trust scenarios.

In addition to measures shown in Table~\ref{tab:defender_actions}, some implicit defenses can be strengthened by defining communication relationships between nodes. Dynamic target defense and network mimicry can be implemented through adaptive network changes. In zero trust environments, this contemporary approach enhances defense capabilities via continuous and dynamic verification processes. Our framework simulates continuous authentication by regularly updating node credentials, limiting attackers to credential-logging for session persistence. By adjusting inter-node communication and simulating granular access controls, we can effectively model zero trust scenarios.

% Note that certain attacker and defender actions may passively alter the network architecture and target assets, as annotated in the table. When modeling, not all actions are required for a complete penetration phase. Instead, select necessary actions based on the application phase and research method, and simplify decision parameters to flexibly leverage independent and continuous tactics and techniques.

Certain attacker and defender actions can passively modify the network architecture and target assets, as shown in Tables \ref{tab:attacker_action_modeling} and \ref{tab:defender_actions}. During modeling, not all actions are essential for a complete penetration phase. It is preferable to select actions relevant to the specific application phase and research method. Simplifying decision parameters enhances the effective use of independent and continuous tactics and techniques.

\subsection{Network Simulation Dataset and Network Generator}

We developed a network generator using the \modelsim~framework, enabling the creation of dynamic and static networks with diverse architectures, attributes, and scales. The open-source code allows researchers to generate custom network data through parameter adjustments, thereby advancing AutoPT research. We offer a pre-generated network simulation dataset, which includes hypothetical numerical attributes, authentic attributes, and their continuous-time counterparts.
% distinguish between static and dynamic networks through the concept of active changes in the target scenario mentioned earlier

% Our dataset includes four types of networks: numerically simulated static networks, real-attribute simulated static networks, numerically simulated dynamic networks, and real-attribute simulated dynamic networks, all categorized by the concept of active changes in target scenarios.


% Based on our proposed \modelsim, We have built a network generator that supports dynamic network generation and can generate various network architectures, different attributes, and target network environments of different scales.  the code of the network generator was made public, enables researchers to produce tailored network data by adjusting parameters or fine-tuning the generator, thereby advancing future research in AutoPT. We distinguish between static and dynamic networks through the concept of active changes in the target scenario mentioned earlier, providing a generated standard dataset that includes numerically simulated static networks, real-attribute simulated static networks, numerically simulated dynamic networks, and real-attribute simulated dynamic networks.


% We provide a network simulation dataset that has already been generated, including hypothetical numerical attributes simulation networks, authentic attributes simulation networks, continuous-time hypothetical numerical simulation networks, and continuous-time authentic attribute simulation networks. we also constructed a network generator that produces a variety of network architectures and target networks with different attributes. 

% Utilizing our proposed \modelsim, we developed a network generator that creates diverse network architectures and target networks with varying attributes. We distinguish between static and dynamic networks through the concept of active changes in the target scenario mentioned earlier, providing a generated standard dataset that includes numerically simulated static networks, real-attribute simulated static networks, numerically simulated dynamic networks, and real-attribute simulated dynamic networks.
% \wyf{add static or dynamic in dataset name?}
\begin{itemize}
    \item Static Hypothetical Numerical Attributes Simulation Networks: These are based on numerical simulations with hypothetical attributes, with no active changes in network scenarios. 
    \item Static Authentic Attributes Simulation Networks: These use authentic attributes without active changes in network scenarios.
    \item Dynamic Hypothetical Numerical Simulation Networks: These incorporate hypothetical attributes alongside dynamic scenario alterations. Nodes may be added or modified randomly, affecting connections and attributes according to a specified change proportion, $p_{\text{change}}$.
    \item Dynamic Authentic Attribute Simulation Networks: Here, authentic attributes are used with dynamic scenario changes, governed by $p_{\text{change}}$.
\end{itemize}
Based on the aforementioned configurations, we include three types of networks with scales of 10, 100, and 1,000 nodes in our dataset. 
These scales can also be expanded by modifying the scale parameter. 
For dynamic networks, we produce network graphs at various time points, providing snapshots that represent the network's evolution. Researchers can switch between these snapshots to effectively capture network dynamics. 
% The generator code is publicly accessible, enabling researchers to customize networks, including adjusting probability parameters, to suit their specific needs.


% 基于我们提出的\(\text{modelsim}\)，我们构建了一个网络生成器，它可以产生具有不同属性的各种网络架构和目标网络。我们通过之前提到的网络场景主动变化概念区分静态及动态网络，提供了一个已经生成的标准数据集，包括数值模拟静态网络、真实属性模拟静态网络、数值模拟动态网络和真实属性模拟动态网络。
% \begin{itemize}
%     \item 数值模拟静态网络：网络场景基于非真实属性模拟的数值网络，同时不存在网络场景主动变化，构建网络规模分别为10，100，1000节点网络场景。
%     \item 真实属性模拟静态网络：网络场景基于真实属性模拟的网络，同时不存在网络场景主动变化，构建网络规模分别为10，100，1000节点网络场景。
%     \item 数值模拟动态网络：网络场景基于非真实属性模拟的数值网络，同时存在网络场景主动变化，构建网络规模分别为10，100，1000节点网络场景，场景的主动变化程度基于设置的变化比例，随机选择改比例的节点增加或改变网络连接关系，同时修改节点属性信息。
%     \item 真实属性模拟动态网络：网络场景基于真实属性模拟的网络，同时存在网络场景主动变化，构建网络规模分别为10，100，1000节点网络场景，场景的主动变化程度基于设置的变化比例，随机选择改比例的节点增加或改变网络连接关系，同时修改节点属性信息。
% \end{itemize}
% 根据以上设置我们分别生成了三种类型网络，网络规模分别为10、100、1000个节点的网络数据，当然我们的网络生成器只需要修改网络规模参数，就可以生成更大规模的网络结构。同时我们还公开了网络生成器的代码，支持研究人员按照需求生成所需的网络，并修改相关概率设置。


% \textbf{使用方法示例}
% 当需要构建“策略自动化+真实属性模拟+连续技战术+半静态场景”的仿真建模场景时，可以使用属性模拟网络、连续攻击/防御动作集，选择的攻击防御动作时，需保留引起网络变化的动作。
% 当需要构建“策略自动化+真实属性模拟+连续技战术+完全动态场景”的仿真场景时，可以使用连续时间属性模拟网络、连续攻击/防御动作集、选择的攻击防御动作时，同样需保留引起网络变化的动作。

% 通过对已公开数据集的灵活组合，可以支持\modelcla中以策略自动化为核心的另外3个维度及所有层次的仿真建模。同时我们公开了网络生成器的代码，支持所有研究人员通过自定义网络生成器的参数或对网络生成器进行微调以输出自己需要的目标背景网络数据。

\textbf{Usage Example.}
% To construct a simulation scenario with "Policy Automation + Simulation of Authentic Attributes +  Coordinated Technical and Tactical Actions + Semi-Dynamic Scenario" start by utilizing datasets from authentic attribute simulated static networks, select the necessary actions from the attacker and defender action sets, ensuring that you maintain the preconditions for these actions. Additionally, choose at least one action that will induce passive changes in the network structure.
To construct a simulation scenario with policy automation, authentic attributes, coordinated technical and tactical actions, and a semi-dynamic context, start by using datasets from static authentic attribute networks. Then, select actions from the attacker and defender sets while ensuring they meet preconditions, and incorporate at least one action to induce passive changes in the network structure.

% Conversely, for a "Completely Dynamic Scenario," utilize datasets from authentic-attribute-simulated dynamic networks. Similarly, select necessary actions from the attacker and defender sets, maintaining their preconditions. Choose at least one action to induce passive network structure changes.
% 我们鼓励研究者们使用考虑动作执行限制的攻击者防御者建模和完全动态场景进行智能化渗透测试研究。正如前面我们提到的那样，忽视不同动作之间的执行限制，统一决策参数，会导致抽象程度过高，与现实环境差距大，导致研究方法难以进行实际应用。同时现有的攻击防御手段不断进化，考虑环境的动态变化对攻击和防御的影响也是贴近现实的一条重要准则。我们的建模方法为以上问题提供了一套可以用于训练和测试的数据集，希望可以对智能化渗透测试的深入研究产生积极的影响。

% We encourage researchers to use attacker defender modeling that considers action execution limitations and completely dynamic scenarios for AutoPT research. As previously stated, reducing execution constraints and unifying decision parameters leads to  a high degree of abstraction and a large gap with the real environment, making it difficult to apply research methods in practical situations. Considering the impact of dynamic environmental changes on attack and defense is also an important criterion that is close to reality. We offer a dataset for training and testing to bridge the gap between research and practical scenarios, thereby enhancing the depth of AutoPT research.

% We encourage researchers to adopt attacker-defender modeling that accounts for execution limitations and fully dynamic scenarios in AutoPT research. Reducing constraints and unifying decision parameters result in a high level of abstraction, creating a significant gap with real-world environments and hindering practical application. Addressing the effects of dynamic environmental changes on attack and defense is crucial for realism. To bridge this gap, we provide a dataset for training and testing, thereby enhancing the depth and applicability of AutoPT research.

To advance simulation modeling in policy automation within~\modelcla, we integrate publicly available datasets flexibly. We have also released network generator code, enabling researchers to customize network data by adjusting parameters or fine-tuning the generator. \modelsim~addresses the limitations of existing scene modeling methods, which often focus on small to medium-sized networks and lack support for large networks and varied architectures. Current methods fall short in dynamic scene modeling, offering limited flexibility and lacking a unified approach for multidimensional and multi-layer simulations.

% 后续我们还会逐步公开攻击者防御者建模及根据攻防动作导致的状态变化函数
% We will progressively disclose models for attackers and defenders, along with state transition functions based on their respective actions.
% Using \modelsim, We address the limitations of current scene modeling methods, which are predominantly designed for small to medium-sized networks, neglecting large networks and diverse architectures. These methods lack dynamic scene modeling capabilities, publicly available datasets, flexibility, and a unified approach for multidimensional and multi-layer simulation modeling.

% 根据当前现有研究的场景建模方法覆盖不全面、变化性小，缺乏完全动态场景建模、且缺乏公开数据集的现状，我们构建了一个以策略自动化为基础，覆盖另外三个维度——场景模拟复杂度、前后技战术关联度与场景反馈与变化——所有层次的建模框架，并提供一套完整、公开的数据集，意在为后续研究提供基础。我们的数据集在github平台可获取，也欢迎任何友善、有建设性的意见用于丰富我们的构建标准与数据集。除此之外，我们还构建了一套接口，作为后续战术自动化与全流程自动化的扩展基础。
% \subsection{\modelsim}
% 我们的建模方法聚焦于支撑在内部网络中进行自动化渗透测试相关研究，达成策略自动化的场景自动化目标，能够模拟渗透测试的全阶段，如信息收集、建立立足点、提升权限、横向移动、持久化等，设置多种网络架构与目标资产建模方法，支持动态网络构建，全面地构建了攻击者和防御者的动作，支持定制化的选择。
% 针对现有自动化渗透测试仿真建模方法关注中小型网络建模、忽略大型网络及不同网络架构的构建；忽略完全动态网络建模和缺乏灵活性、没有提供多维度和多层次模拟建模的统一方法的问题，

% By integrating publicly available datasets flexibly, support is offered for various simulation modeling levels focused on policy automation in \modelcla. We have also made the network generator code public, enabling researchers to output customized target network data by adjusting parameters or fine-tuning the network generator. % 通过 \modelsim，我们解决了当前现有研究的场景建模方法关注主要关注中小型网络建模、忽略大型网络及不同网络架构的构建，缺乏完全动态场景建模、且缺乏公开数据集、和缺乏灵活性、没有提供多维度和多层次模拟建模的统一方法的问题。

% 当需要构建

% 策略自动化+真实属性模拟+连续技战术+完全静态场景：属性模拟网络、连续攻击、防御动作集（注释/修改使目标网络本身发生变化的动作）



% 王文浩师兄意见：
% 提出的标准和仿真建模本身方法关系不大

% 仿真环境是重要的：
% 成本问题、很多场景没有办法实际测试（0day漏洞）、靶场环境在很多场景下不能使用没有适用性，文章里面还需要集中说一下


% 技术主流是人工智能，需要很大的数据及交互，数据的获取成本低交互成本低才能够进行训练，也要证明抽象和现实环境是有一些关联关系的。


% 改名字叫智能化渗透测试相关的
% 红队经历了脚本的到规划的到人工智能的
% 可信、抽象、交互成本低

% 贡献：
% 综述
% 一套建模框架：涵盖了要素，可以进行组合配置
% 提供一套数据集

% 英文期刊







