\begin{figure}[h!]
\centering
\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate $[dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.05cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-01-16-02.csv};
\addlegendentry{Exp-1-M}

\addplot[color=blue!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-01-16-02.csv};
\addlegendentry{Exp-1-P}

\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-02-20-01.csv};
\addlegendentry{Exp-2-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-02-20-01.csv};
\addlegendentry{Exp-2-P}

\addplot[color=red!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-14-01.csv};
\addlegendentry{Exp-3-M}

\addplot[color=red!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-14-01.csv};
\addlegendentry{Exp-3-P}

\addplot[color=purple!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-14-02.csv};
\addlegendentry{Exp-4-M}

\addplot[color=purple!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-14-02.csv};
\addlegendentry{Exp-4-P}


\addplot[name path=upperF, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-01-16-02.csv};

\addplot[name path=lowerF, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-01-16-02.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upperF and lowerF];


\addplot[name path=upper2F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-02-20-01.csv};

\addplot[name path=lower2F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-02-20-01.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upper2F and lower2F];


\addplot[name path=upper3F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-14-01.csv};

\addplot[name path=lower3F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-14-01.csv};

\addplot[red!50!white, opacity=0.4] 
    fill between[of=upper3F and lower3F];

\addplot[name path=upper4F, color=purple!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-14-02.csv};

\addplot[name path=lower4F, color=purple!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-14-02.csv};

\addplot[purple!50!white, opacity=0.4] 
    fill between[of=upper4F and lower4F];



\end{axis}
\end{tikzpicture}
}
\hfill
\subfloat[]{

\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate $[dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.5cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-07-05.csv};
\addlegendentry{Exp-5-M}

\addplot[color=blue!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-07-05.csv};
\addlegendentry{Exp-5-P}


\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-14-01.csv};
\addlegendentry{Exp-3-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-14-01.csv};
\addlegendentry{Exp-3-P}


\addplot[color=red!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-06-05.csv};
\addlegendentry{Exp-6-M}

\addplot[color=red!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-06-05.csv};
\addlegendentry{Exp-6-P}

\addplot[color=purple!70!black, line width=1pt, opacity=0] 
    table [x={Druck (bar)}, y={Druck (bar)}, col sep=comma]    
    {pressure_empty.csv}; %
\addlegendentry{\phantom{Exp}}

\addplot[name path=upper5F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-07-05.csv};

\addplot[name path=lower5F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-07-05.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upper5F and lower5F];


\addplot[name path=upper6F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-14-01.csv};

\addplot[name path=lower6F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-14-01.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upper6F and lower6F];


\addplot[name path=upper7F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-06-05.csv};

\addplot[name path=lower7F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-06-05.csv};

\addplot[red!50!white, opacity=0.4] 
    fill between[of=upper7F and lower7F];


\end{axis}
\end{tikzpicture}
}
\\
\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate $[dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.05cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-02-20-05.csv};
\addlegendentry{Exp-7-M}

\addplot[color=blue!70!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-02-20-05.csv};
\addlegendentry{Exp-7-P}


\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-02-20-04.csv};
\addlegendentry{Exp-8-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-02-20-04.csv};
\addlegendentry{Exp-8-P}


\addplot[color=red!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-02-17-03.csv};
\addlegendentry{Exp-9-M}

\addplot[color=red!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-02-17-03.csv};
\addlegendentry{Exp-9-P}

\addplot[color=purple!70!black, line width=1pt, opacity=0] 
    table [x={Druck (bar)}, y={Druck (bar)}, col sep=comma]    
    {pressure_empty.csv}; %
\addlegendentry{\phantom{Exp}}

\addplot[name path=upper8F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-02-20-05.csv};

\addplot[name path=lower8F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-02-20-05.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upper8F and lower8F];

\addplot[name path=upper9F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-02-20-04.csv};

\addplot[name path=lower9F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-02-20-04.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upper9F and lower9F];


\addplot[name path=upper10F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-02-17-03.csv};

\addplot[name path=lower10F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-02-17-03.csv};

\addplot[red!50!white, opacity=0.4] 
    fill between[of=upper10F and lower10F];

\end{axis}
\end{tikzpicture}
}
\hfill
\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate $[dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.5cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-06-05.csv};
\addlegendentry{Exp-6-M}

\addplot[color=blue!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-06-05.csv};
\addlegendentry{Exp-6-P}

\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-06-06.csv};
\addlegendentry{Exp-10-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-06-06.csv};
\addlegendentry{Exp-10-P}

\addplot[color=red!70!black,  line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-07-01.csv};
\addlegendentry{Exp-11-M}

\addplot[color=red!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-07-01.csv};
\addlegendentry{Exp-11-P}

\addplot[color=purple!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-03-07-02.csv};
\addlegendentry{Exp-12-M}

\addplot[color=purple!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-03-07-02.csv};
\addlegendentry{Exp-12-P}

\addplot[name path=upper11F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-06-06.csv};

\addplot[name path=lower11F, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-06-06.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upper11F and lower11F];

\addplot[name path=upper12F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-07-01.csv};

\addplot[name path=lower12F, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-07-01.csv};

\addplot[red!50!white, opacity=0.4] 
    fill between[of=upper12F and lower12F];

\addplot[name path=upper13F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-06-05.csv};

\addplot[name path=lower13F, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-06-05.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upper13F and lower13F];

\addplot[name path=upper14F, color=purple!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-03-07-02.csv};

\addplot[name path=lower14F, color=purple!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-03-07-02.csv};
\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upper14F and lower14F];


\end{axis}
\end{tikzpicture}
}
\caption{Comparison of measured (\textbf{M}) and predicted (\textbf{P}) flow rate for the experiments from the Table~\ref{tab:experiments}. (a) shows the reduction of the flow rate with higher cycle number over the pressure. (b) shows the reduction of the flow rate with different concentrations and similar filter cylces over the pressure. (c) and (d) shows the flow rate with different numbers of filter chambers over the pressure.}
\label{fig:flow_comparison}
\end{figure}
\newpage
