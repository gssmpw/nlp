\begin{figure}[h!]

\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate [$dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.05cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-004.csv};
\addlegendentry{Exp-4 val-M}

\addplot[color=blue!70!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-004.csv};
\addlegendentry{Exp-4 val-P}



\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-015.csv};
\addlegendentry{Exp-3 val-M}


\addplot[color=green!60!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-015.csv};
\addlegendentry{Exp-3 val-P}



\addplot[color=red!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-011.csv};
\addlegendentry{Exp-5 val-M}

\addplot[color=red!70!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-011.csv};
\addlegendentry{Exp-5 val-P}

\addplot[name path=upperFV, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-011.csv};

\addplot[name path=lowerFV, color=red!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-011.csv};

\addplot[red!50!white, opacity=0.4] 
    fill between[of=upperFV and lowerFV];


\addplot[name path=upperF2V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-004.csv};

\addplot[name path=lowerF2V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-004.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upperF2V and lowerF2V];


\addplot[name path=upperF3V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-015.csv};

\addplot[name path=lowerF3V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-015.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upperF3V and lowerF3V];

\end{axis}
\end{tikzpicture}
}
\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate [$dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.05cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-009.csv};
\addlegendentry{Exp-1 val-M}

\addplot[color=blue!70!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-009.csv};
\addlegendentry{Exp-1 val-P}


\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-08-004.csv};
\addlegendentry{Exp-2 val-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-08-004.csv};
\addlegendentry{Exp-2 val-P}


 \addplot[color=purple!70!black, line width=1pt, opacity=0] 
     table [x={Druck (bar)}, y={Druck (bar)}, col sep=comma]    
     {pressure_empty.csv}; %
 \addlegendentry{\phantom{Exp}}

\addplot[name path=upperF5V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-009.csv};

\addplot[name path=lowerF5V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-009.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upperF5V and lowerF5V];


\addplot[name path=upperF6V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-08-004.csv};

\addplot[name path=lowerF6V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-08-004.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upperF6V and lowerF6V];


\end{axis}
\end{tikzpicture}
}

\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate [$dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.05cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-011.csv};
\addlegendentry{Exp-5 val-M}

\addplot[color=blue!70!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-011.csv};
\addlegendentry{Exp-5 val-P}

\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-11-003.csv};
\addlegendentry{Exp-6 val-M}

\addplot[color=green!60!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-11-003.csv};
\addlegendentry{Exp-6 val-P}



\addplot[name path=upperF8V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-011.csv};

\addplot[name path=lowerF8V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-011.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upperF8V and lowerF8V];

\addplot[name path=upperF9V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-11-003.csv};

\addplot[name path=lowerF9V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-11-003.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upperF9V and lowerF9V];


\end{axis}
\end{tikzpicture}
}
\hfill
\subfloat[]{
\begin{tikzpicture}
\begin{axis}[
    width=0.5\textwidth, %
    xlabel={Pressure [bar]},
    ylabel={Flow rate [$dm^3/min]$},
    legend style={
        at={(0.5,-0.25)}, %
        anchor=north,    
        legend columns=2, %
        /tikz/every even column/.append style={column sep=0.5cm} %
    },
    legend cell align={left}, %
    grid=both, %
    minor grid style={dotted}, %
    major grid style={solid, gray!30} %
]

\addplot[color=blue!70!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-08-002.csv};
\addlegendentry{Exp-7 val-M}

\addplot[color=blue!70!black, line width=1pt, dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-08-002.csv};
\addlegendentry{Exp-7 val-P}



\addplot[color=green!60!black, line width=1pt] 
    table [x={Druck (bar)}, y={Flow}, col sep=comma] 
    {flow_dat_23-09-08-003.csv};
\addlegendentry{Exp-8 val-M}

\addplot[color=green!60!black, line width=1pt,dashed] 
    table [x={Druck (bar)}, y={Flow_pred}, col sep=comma]    
    {flow_dat_23-09-08-003.csv};
\addlegendentry{Exp-8 val-P}


\addplot[name path=upperF10V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-08-002.csv};

\addplot[name path=lowerF10V, color=blue!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-08-002.csv};

\addplot[blue!50!white, opacity=0.4] 
    fill between[of=upperF10V and lowerF10V];

\addplot[name path=upperF11V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={upperBound}, col sep=comma]
    {flow_dat_23-09-08-003.csv};

\addplot[name path=lowerF11V, color=green!50!white, line width=0.5pt] 
    table [x={Druck (bar)}, y={lowerBound}, col sep=comma]
    {flow_dat_23-09-08-003.csv};

\addplot[green!50!white, opacity=0.4] 
    fill between[of=upperF11V and lowerF11V];

\end{axis}
\end{tikzpicture}
}

\caption{Comparison of measured (\textbf{M}) and predicted (\textbf{P}) flow rate for the experiments listed in Table~\ref{tab:experiments_val}. (a) illustrates the reduction of flow rate with a higher number of filter cycles. (b)  shows the reduction of the flow rate with
different concentrations and similar filter cylces over the pressure. (c) shows the increase in flow rate with different number of filter chambers. (d) presents the prediction of the flow rate for an unknown concentration of $15 \, \mathrm{g/L}$.}
\label{fig:flow_comparison_val}
\end{figure}
