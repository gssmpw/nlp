\begin{algorithm}[t]
\caption{CDR Vector Database Construction}\label{alg:train}
\begin{algorithmic}
    \STATE {\bfseries Input:} Training set $\mathcal{T} = \{ (G_{i1}, G_{i2}) \}_{i=1}^{|\mathcal{T}|}$, training epoch $T$, CDR database $\mathcal{B}= \{ (\vect{s}_j, G_j) \}_{j=1}^{|\mathcal{B}|}$
    \STATE {\bfseries Output:} CDR vector database $\mathcal{Z}$
    \FOR{$t = 1$ {\bfseries to} $T$}
        \FOR{$i = 1$ {\bfseries to} $|\mathcal{T}|$}
            \STATE Initialize feature matrices $\vect{H}_{i1}$ of $G_{i1}$ and feature matrices $\vect{H}_{i2}$ of $G_{i2}$, respectively
            \STATE Generate graph representation for the $i$-th training CDR pair:
            $\vect{h}_{G_{i1}} \leftarrow \text{MEGNN} (G_{i1}, \vect{H}_{i1}, \vect{X}_{i1}), \quad \vect{h}_{G_{i2}} \leftarrow \text{MEGNN} (G_{i2}, \vect{H}_{i2}, \vect{X}_{i2})$
            \STATE Predict the RMSD between $h_{G_{i1}}$ and $h_{G_{i2}}$: $\widehat{d}(G_{i1}, G_{i2}) \leftarrow \text{MLP} \left(\text{CONCAT} \left(\vect{h}_{G_{i1}}, \vect{h}_{G_{i2}} \right) \right)$
            \STATE Compute the loss function: $\mathcal{L} \leftarrow \frac{1}{|\mathcal{T}|}\sum_{(G_{i1}, G_{i2}) \in \mathcal{T} } \|\widehat{d}(G_{i1}, G_{i2}) - d(G_{i1}, G_{i2}) \|^2$
        \ENDFOR
        \STATE Update the model weights $\vect{W}$ to minimize $\mathcal{L}$ using $\frac{\partial \mathcal{L}}{\partial \vect{W}}$
    \ENDFOR
    \FOR{$j=1$ {\bfseries to} $|\mathcal{B}|$}
        \STATE Generate graph representation $G_j \leftarrow \text{MEGNN} (G_{j}, \vect{H}_{j}, \vect{X}_{j}) $\;
        Add the triplet $(\vect{s}_j, G_j, \vect{h}_{G_j})$ into $\mathcal{Z}$
    \ENDFOR
    \STATE {\bfseries Return:} Vector database $\mathcal{Z}$
\end{algorithmic}
\end{algorithm}