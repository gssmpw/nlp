\begin{algorithm}[t]
\caption{Sequence Generation}\label{alg:design}
\begin{algorithmic}
    \STATE {\bfseries Input:} Query structure $G_q$, MEGNN $\phi$, CDR vector database $\mathcal{Z}$
    \STATE {\bfseries Output:} Predicted sequence $\hat{\vect{s}}_q$
    \STATE Initialize feature matrix $\vect{H}_q$ and coordinates $\vect{X}_q$
    \STATE Generate graph representation $G_q \leftarrow \text{MEGNN} (G_{q}, \vect{H}_{q}, \vect{X}_{q})$
    \STATE Retrieve the $K$-nearest neighbors of $\vect{h}_{G}$ in the database $\mathcal{Z}$ as $\mathcal{Z}_q$
    \STATE Derive the probability of amino acid $a$ at the $l$-th position: $p\left(\hat{\vect{s}}_q(l) = a_i| S_q\right) = \frac{1}{K} \sum_{s_k \in \mathcal{S}_q } \mathbb{I}(\vect{s}_k(l), a_i)$
    \STATE Sample the amino acid $\hat{\vect{s}}_q(l)$ at the $l$-th position using the probability $p\left(\hat{\vect{s}}_q(l) | \mathcal{S}_q\right)$
    \STATE {\bfseries Return:} Sequence $\hat{\vect{s}}_q$
\end{algorithmic}
\end{algorithm}