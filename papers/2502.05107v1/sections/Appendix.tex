\section{Parallel Sequences}
Here is a real example of the parallel sequence of a pocket-ligand complex with a total length of 867, corresponding to Figure~\ref{PocketSeq} and~\ref{LigandSeq}. The token sequence mainly consists of 4 parts: pocket atoms, pocket atom coordinates, ligand SMILES, ligand atom coordinates, and the start and end of each part are marked by special tokens. The first amino acid of the pocket is particularly marked. Moreover, the \ctext[RGB]{127,255,127}{'[x]', '[y]', '[z]'} tokens are corresponding to \ctext[RGB]{250,220,100}{values representing 3D coordinates} in the numerical sequence.

Tokens: [\ctext[RGB]{255,160,0}{'[PS]'}, \ctext[RGB]{0,120,234}{'N', 'CA', 'C', 'O', 'C', 'C', 'C'}, \ctext[RGB]{0,200,234}{'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'N', 'C', 'C', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'O', 'O', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'O', 'N', 'CA', 'C', 'O', 'C', 'O', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'C', 'N', 'C', 'C', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'N', 'C', 'C', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'O', 'N', 'N', 'CA', 'C', 'O', 'C', 'O', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'O', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'N', 'C', 'C', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'N', 'C', 'C', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'O', 'N', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'C', 'N', 'CA', 'C', 'O', 'C', 'C', 'C', 'O', 'O', 'O', 'O'}, \ctext[RGB]{255,160,0}{'[PE]', '[PCS]'}, \ctext[RGB]{40,220,40}{'[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]'}, \ctext[RGB]{127,255,127}{'[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]'}, \ctext[RGB]{255,160,0}{'[PCE]', '[LS]'}, \ctext[RGB]{0,200,234}{'C', 'C', 'C', 'C', '(', 'C', '(', '=', 'O', ')', 'N', 'c', '1', 'c', 'c', 'c', '(', 'S', '(', 'N', ')', '(', '=', 'O', ')', '=', 'O', ')', 'c', 'c', '1', ')', 'C', '(', 'C', ')', '(', 'C', ')', 'C'}, \ctext[RGB]{255,160,0}{'[LE]', '[LCS]'}, \ctext[RGB]{127,255,127}{'[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]', '[x]', '[y]', '[z]'}, \ctext[RGB]{255,160,0}{'[LCE]'}

Numbers: [ \ctext[RGB]{200,200,200}{1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.} \ctext[RGB]{250,220,100}{1.258 -0.361  0.197  1.411 -0.114  0.217  1.242  0.118
  0.107  1.106  0.083 -0.099  1.655 -0.181  0.045  1.693 -0.462  0.086
  1.418 -0.577  0.076 -0.424  0.62   1.849 -0.673  0.475  1.784 -0.824
  0.383  2.028 -0.714  0.248  2.201 -0.619  0.224  1.609 -0.881  0.084
  1.542 -0.463  0.299  1.344 -1.458 -0.708 -0.818 -1.275 -0.894 -0.94
 -1.285 -1.149 -0.778 -1.413 -1.159 -0.568 -0.986 -0.789 -0.949 -0.871
 -0.739 -0.676 -0.726 -0.929 -0.54  -0.866 -0.515 -0.525 -0.637 -0.826
 -0.313 -0.723 -0.575 -0.298 -0.515 -2.414  0.742 -0.313 -2.275  0.905
 -0.378 -2.308  1.201 -0.227 -2.425  1.35  -0.31  -1.984  0.824 -0.231
 -1.956  0.529 -0.09  -1.698  0.47  -0.209 -1.479  0.513  0.143 -1.706
  0.383 -1.755  0.086  0.046 -1.589  0.29   0.172 -1.731  0.562  0.179
 -1.814  0.664 -0.031 -1.318  0.318  0.019 -1.14   0.526  0.148 -1.175
  0.045 -0.     0.011 -0.174  1.928  0.171 -0.047  1.719  0.083 -0.128
  1.437 -0.074 -0.315  1.403  0.465 -0.129  1.757  0.514 -0.4    1.67
  0.621 -0.628  0.417  0.846 -0.613  0.228  1.008 -0.363  0.288  0.909
 -0.172  0.409  0.755 -0.591 -0.066  0.623 -0.345 -0.106  0.566 -0.814
 -0.142 -1.305 -0.168  2.133 -1.388 -0.408  1.991 -1.66  -0.492  2.095
 -1.703 -0.508  2.335 -1.183 -0.637  2.028 -0.97  -0.61   1.832 -0.729
 -0.497  1.871 -0.981 -0.692  1.556 -0.588 -0.495  1.631 -0.736 -0.62
  1.438 -1.174 -0.821  1.399 -0.679 -0.674  1.169 -1.117 -0.877  1.134
 -0.873 -0.801  1.022 -0.812 -1.891 -0.518 -0.571 -2.055 -0.494 -0.657
 -2.345 -0.518 -0.869 -2.419 -0.416 -0.439 -2.009 -0.222 -0.382 -1.72
 -0.162 -0.133 -1.605 -0.2   -0.544 -1.519 -0.08  -0.143 -1.349 -0.135
 -0.392 -1.289 -0.072  0.109 -0.508 -2.274  0.335 -0.345 -2.184  0.588
 -0.505 -2.131  0.786 -0.399 -2.029  0.262 -0.179 -1.937  0.193 -0.35
 -1.699  0.254 -0.585 -1.691  0.056 -0.232 -1.505  0.249 -0.548  0.808
  0.382 -0.809  0.806  0.581 -0.839  0.578  0.694 -1.052  0.553  0.189
 -1.044  0.78   0.07  -1.033  0.52  -0.029 -1.041  0.999  1.244  0.351
  0.238  1.426  0.432  0.457  1.353  0.35   0.742  1.477  0.45   0.926
  1.424  0.737  0.433  1.153  0.801  0.335  1.082  0.581  0.142 -0.177
  1.888  0.87   0.004  1.664  0.936  0.224  1.742  1.135  0.36   1.565
  1.242  0.132  1.522  0.692 -0.081  1.397  0.519  0.304  1.71   0.529
 -1.008  1.286  1.446 -1.146  1.092  1.27  -1.317  0.904  1.433 -1.261
  0.856  1.667 -0.944  0.926  1.111 -0.747  1.057  0.919 -0.636  0.849
  0.724 -0.832  1.303  0.773 -1.73   0.636 -0.746 -1.678  0.408 -0.922
 -1.728  0.154 -0.766 -1.731  0.16  -0.52  -1.389  0.408 -1.035 -1.167
  0.434 -0.826 -1.025  0.176 -0.756 -1.137 -0.044 -0.769 -0.777  0.206
 -0.67  -1.603 -1.141 -0.028 -1.559 -0.893  0.123 -1.694 -0.668 -0.013
 -1.614 -0.591 -0.235 -1.259 -0.833  0.14  -1.116 -1.027  0.314 -0.843
 -1.072  0.304 -1.214 -1.193  0.506 -0.78  -1.259  0.481 -1.002 -1.336
  0.604  0.647 -1.02  -1.743  0.624 -1.167 -1.485  0.346 -1.28  -1.438
  0.319 -1.491 -1.312  0.727 -1.026 -1.229  0.706 -0.729 -1.225  0.506
 -0.597 -1.088  0.872 -0.537 -1.32   0.543 -0.337 -1.111  0.763 -0.295
 -1.251 -0.888 -0.494 -1.826 -1.057 -0.313 -1.668 -1.3   -0.231 -1.836
 -1.271 -0.142 -2.065 -0.913 -0.058 -1.581 -0.693 -0.102 -1.386 -0.672
 -0.316 -1.267 -0.52   0.1   -1.351 -0.84   2.384 -0.05  -0.733  2.123
  0.03  -0.443  2.139  0.11  -0.361  2.014  0.306 -0.766  1.927 -0.202
 -0.663  1.652 -0.146 -0.809  1.472  0.01  -0.418  1.569 -0.244 -0.718
  1.22   0.063 -0.324  1.316 -0.193 -0.478  1.138 -0.037  0.189  0.013
  1.237  0.194 -0.096  0.964  0.344 -0.358  0.967  0.548 -0.396  1.111
  0.343  0.095  0.776  0.232  0.378  0.764  0.407  0.536  0.569 -0.061
  0.389  0.682  0.912  0.482  1.165  0.846  0.7    1.349  0.635  0.619
  1.554  0.435  0.487  1.489  0.752  0.946  1.188  0.974  1.064  1.009
  0.85   1.269  0.822  1.203  1.191  1.169 -1.592  0.135  1.225 -1.603
 -0.071  1.018 -1.794 -0.288  1.113 -1.763 -0.394  1.334 -1.325 -0.19
  0.955 -1.346 -0.396  0.728 -1.137  0.029  0.868  0.794  0.122 -0.903
 -0.524  0.748 -0.693  0.269 -1.24  -0.704  0.718  0.231 -0.421} \ctext[RGB]{200,200,200}{1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.     1.     1.     1.     1.     1.     1.     1.
  1.     1.     1.} \ctext[RGB]{250,220,100}{0.637  1.213 -0.028  0.463  0.997 -0.136  0.502
  0.924 -0.423  0.258  0.857 -0.581  0.091  0.665 -0.42  -0.147  0.711
 -0.403  0.202  0.434 -0.286  0.039  0.245 -0.136  0.171  0.024 -0.035
  0.039 -0.171  0.113 -0.234 -0.159  0.155 -0.382 -0.425  0.342 -0.278
 -0.713  0.219 -0.674 -0.386  0.319 -0.287 -0.384  0.617 -0.374  0.062
  0.048 -0.238  0.262 -0.095  0.319  0.763 -0.862  0.596  0.657 -0.885
  0.295  0.994 -1.051  0.123  0.552 -0.948} \ctext[RGB]{200,200,200}{1.}   ]

In addition, the factor $q$ in Eq. (\ref{coordnorm}) is set to 5.0. The performance of the model is not sensitive to the choice of $q$, because most of the 3D coordinates in our data (protein pockets and ligands) are in a limited range.

\section{Pre-training}
\label{app2}
\paragraph{Data Source}
pockets for pre-training (3.2M), ligand conformations for pre-training (209M), and ground-truth protein-ligand complexes for docking fine-tuning (17K):
\url{https://github.com/deepmodeling/Uni-Mol/tree/main/unimol}.

Docked protein-ligand complexes for pre-training and test set for pocket-aware 3D drug design:
\url{https://github.com/guanjq/targetdiff}.

In addition, samples with the maximal difference in coordinates in one dimension greater than 40 are removed in order to filter out those outliers that account for less than 0.1\% data.

\paragraph{Model Scaling}
The standard dual-channel model used in our paper follows the configuration of the GPT-2 small model~\citep{GPT-2}. An ablation study of pre-training is conducted to determine the appropriate scale for 3DMolFormer, where the pre-training loss on the ligand validation set is reported for each model size:
\begin{table}[h]
\begin{center}
\begin{tabular}{ccccc}
\hline
Layers & Heads & Embedding length & Pre-training Loss
\\ \hline 
8 & 8 & 256 & 0.325\\
12 & 8 & 256 & 0.254\\
12 & 12 & 256 & 0.229\\
\textbf{12} & \textbf{12} & \textbf{768} & \textbf{0.178} \\
16 & 12 & 768 & 0.178 \\
16 & 16 & 768 & 0.180 \\\hline
\end{tabular}
\end{center}
\end{table}

The standard model size achieves the best performance compared with others, as a result of which it is utilized in our design.

\paragraph{Hyper-parameters}
The coefficient $\alpha$ in the loss function of Eq. (\ref{pretrainloss}) is set to $1.0$. In an ablation study, we observe that the selection of $\alpha$ does not significantly affect the balance between CE loss and MSE loss:
\begin{table}[h]
\begin{center}
\begin{tabular}{ccc}
\hline
$\alpha$ & CE Loss & MSE Loss \\ \hline
0.1 & 0.164 & 0.014 \\  
1.0 & 0.164 & 0.014 \\ 
10.0 & 0.164 & 0.015 \\ \hline
\end{tabular}
\end{center}
\end{table}

This may be because the errors on the token sequences and those on the numerical sequences converge respectively during the large-scale pre-training.

The selection of other hyper-parameters follows the common practice of the pre-training of large language models~\citep{GPT-2,DeepLearning}.

\section{Protein-ligand Binding Pose Prediction Supplement}
\label{app3}
\paragraph{Docking Setup}
The exhaustiveness of all 4 search-based docking baselines in Table~\ref{docking-results} is set to 8, following the settings in Uni-Mol~\citep{Uni-Mol}.

\paragraph{Standard Errors} 
As shown in Table~\ref{docking-results-std}, the standard errors of the 3DMolFormer performance results are obtained by 5 individual runs of supervised fine-tuning on protein-ligand docking. The minor standard errors further validate the robustness and soundness of 3DMolFormer.
\begin{table}[ht]
\caption{Standard Errors of 3DMolFormer performance results in Table \ref{docking-results}.}
\label{docking-results-std}
\begin{center}
\begin{tabular}{cccccc}
\hline
Methods & \%$<$1.0\AA~($\uparrow$) & \%$<$2.0\AA~($\uparrow$) & \%$<$3.0\AA~($\uparrow$) & \%$<$5.0\AA~($\uparrow$) & Avg.~($\downarrow$)
\\ \hline 
3DMolFormer & 43.8$\pm$0.4 & 84.9$\pm$0.5 & 96.4$\pm$0.2 & 98.8$\pm$0.0 & 1.29$\pm$0.02 \\\hline
\end{tabular}
\end{center}
\end{table}


\paragraph{Additional Experiments on PoseBusters}
PoseBusters~\citep{PoseBusters} s a widely-used benchmark for evaluating protein-ligand docking methods, particularly focusing on the challenges of blind docking, where the binding pocket information is not provided. However, in our study, we evaluate 3DMolFormer on PoseBusters using pocket information, providing a different evaluation context compared to typical PoseBusters assessments conducted for state-of-the-art docking approaches such as AlphaFold~\citep{AlphaFold3}, Chai-1~\citep{Chai-1}, and Uni-Mol Docking V2~\citep{Uni-Mol-Docking-V2}.

For experiments on PoseBusters, the blind docking baselines following the standard evaluation setup include AutoDock Vina~\citep{AutoDockVina}, DiffDock~\citep{DiffDock}, Uni-Mol Docking V2~\citep{Uni-Mol-Docking-V2}, AlphaFold3~\citep{AlphaFold3}, and Chai-1~\citep{Chai-1}. For pocket-aware docking approaches including Uni-Mol~\citep{Uni-Mol} and our 3DMolFormer, we provide pocket information for docking. As shown in Table~\ref{PoseBusters-results}, our 3DMolFormer achieves a higher pocket-aware docking accuracy than Uni-Mol, which is also higher than the blind docking accuracy of all state-of-the-art baselines.

\begin{table}[ht]
\caption{Experimental results of protein-ligand binding pose prediction on PoseBusters benchmark.}
\label{PoseBusters-results}
\begin{center}
\begin{tabular}{cc}
\hline
Methods & \%$<$2.0\AA~($\uparrow$) \\ \hline
AutoDock Vina & 52.3\\
DiffDock & 37.9\\
Uni-Mol Docking V2 & 77.6\\
AlphaFold3 & 76.3 \\
Chai-1 & 77.1 \\ \hline
Uni-Mol (pocket-aware) & 74.8 \\
3DMolFormer (pocket-aware) & 81.5\\ \hline
\end{tabular}
\end{center}
\end{table}



\section{Pocket-aware 3D Drug Design Supplement}
\label{app4}
\paragraph{Clarification on the SA score}
It should be clarified that the SA score ranges in $[1,10]$ as defined in the original paper~\citep{SA}, where a lower score is better. Following the previous work on pocket-aware 3D drug design~\citep{DecompDiff}, we report the linearly transformed SA score: $\text{SA}=(10-\text{SA}_\text{origin})/9\in[0,1]$, where a higher score is better.

\paragraph{Clarification on molecular diversity}
We do not include metrics for molecular diversity such as internal diversity \cite{IntDiv} and Hamiltonian diversity \cite{HamDiv} in out evaluation, because existing metrics are all based on 2D graph structures, while pocket-aware 3D drug design is a 3D molecular generation task.

\paragraph{Generation Setup}
In addition, in the 3D drug design experiments no more than 100 molecules are generated by each baseline method for each protein pocket. For 3DMolFormer, exactly 100 unique molecules are generated and seleted for each protein pocket, which is a more stringent requirement.

\paragraph{Case Study}
Visualization of the reference binding molecule and two molecules generated by 3DMolFormer on protein \textbf{4H3C}:
\begin{figure}[ht]
\centering
\begin{minipage}{0.325\textwidth}
    \centering
    \includegraphics[width=\textwidth]{imgs/4h3c_ref.png}
    \centerline{Reference}
\end{minipage}
\begin{minipage}{0.325\textwidth}
    \centering
    \includegraphics[width=\textwidth]{imgs/4h3c_result1.png}
    \centerline{Designed Example 1}
\end{minipage}
\begin{minipage}{0.325\textwidth}
    \centering
    \includegraphics[width=\textwidth]{imgs/4h3c_result2.png}
    \centerline{Designed Example 2}
\end{minipage}
\end{figure}
\begin{table}[ht]
\begin{center}
\begin{tabular}{cccc}
\hline
Molecule & Vina Dock & QED & SA \\ \hline
Reference & -8.0 & 0.55 & 0.91 \\ 
Designed Example 1 & -11.1 & 0.35 & 0.91 \\ 
Designed Example 2 & -10.6 & 0.48 & 0.75 \\ \hline
\end{tabular}
\end{center}
\end{table}



\paragraph{Standard Errors and Ablation Study}
As shown in Table~\ref{drugdesign-results-std}, the standard errors of the 3DMolFormer performance results are obtained by 5 individual runs of RL fine-tuning on pocket-aware 3D drug design. The minor standard errors further validate the robustness and soundness of 3DMolFormer.

In addition, we conduct an ablation study on 3DMolFormer. The variant 3DMolFormer w/o RL refers to freezing the GPT weights for RL fine-tuning, that is, generating molecules without fine-tuning for pocket-aware 3D drug design. The results indicate that the RL fine-tuning process is fundamental for this task.
\begin{table}[H]
\caption{Standard Errors of 3DMolFormer performance results in Table \ref{drugdesign-results}, and results of the ablation study.}
\label{drugdesign-results-std}
\begin{center}
\small
\begin{tabular}{cccccc}
\hline
Methods & Vina Score~($\downarrow$) & Vina Dock~($\downarrow$) & QED~($\uparrow$) & SA~($\uparrow$) & Success Rate~($\uparrow$)
\\ \hline 
3DMolFormer & -6.02$\pm$0.27 & -9.48$\pm$0.18 & 0.49$\pm$0.01 & 0.78$\pm$0.01 & 85.3\%$\pm$1.5\% \\ 
3DMolFormer w/o RL & -4.20 & -5.03 & 0.46 & 0.50 & 2.1\% \\ \hline
\end{tabular}
\end{center}
\end{table}


\paragraph{Distribution of Generated Molecules}
Figure~\ref{mol_distribution} demonstrates the distributions of molecular weights, logP values, and the number of rotatable bonds of the 10,000 molecules designed by 3DMolFormer for all the 100 targets reported in Table~\ref{drugdesign-results}. It is worth mentioning that all three metrics are taken into account in drug-likeness, as measured by QED.
\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{imgs/mol_distribution.pdf}
    \caption{The distributions of molecular weights, logP values, and the number of rotatable bonds of the molecules designed by 3DMolFormer.}
    \label{mol_distribution}
\end{figure}


\paragraph{Additional Evaluation by Delta Score}
Delta Score is a novel evaluation metric in structure-based drug design that emphasizes the specificity of molecular binding~\citep{DeltaScore-v1}. Unlike traditional docking scores that can inflate results due to biases, Delta Score evaluates the selective affinity of a molecule for its target compared to other potential binding pockets, providing a more accurate measure of binding specificity and reducing the influence of promiscuous binding effects.

Results in Table~\ref{DeltaScore-results} show that 3DMolFormer outperforms previous methods in terms of Delta Score, demonstrating its superior capability to generate molecules with higher specificity for their intended targets.

\begin{table}[ht]
\caption{Experimental results of Delta Score on pocket-aware 3D drug design.}
\label{DeltaScore-results}
\begin{center}
\begin{tabular}{cc}
\hline
Methods & Mean Delta Score~($\uparrow$) \\ \hline
Reference & 1.158 \\ \hline
AR & 0.393 \\
Pocket2Mol & 0.437 \\
TargetDiff & 0.335 \\
DecompDiff & 0.354 \\ \hline
3DMolFormer & \textbf{0.716} \\ \hline
\end{tabular}
\end{center}
\end{table}

\paragraph{Additional Evaluation by PoseCheck}
Clash Score and Strain Energy are key metrics used in PoseCheck~\citep{PoseCheck} to evaluate the physical plausibility and stability of protein-ligand poses in structure-based drug design. Clash Score assesses steric clashes between atoms in the generated pose, while Strain Energy quantifies the energetic distortion from ideal molecular conformations. Both metrics ensure that generated poses align with physical and chemical principles.

Table~\ref{PoseCheck-results} demonstrates that 3DMolFormer outperforms baselines on both metrics, highlighting its ability to produce more physically realistic and energetically favorable docking poses.

\begin{table}[ht]
\caption{Experimental results of Delta Score on pocket-aware 3D drug design.}
\label{PoseCheck-results}
\begin{center}
\begin{tabular}{ccc}
\hline
Methods & Mean Clash Score~($\downarrow$) & Median Strain Energy~($\downarrow$) \\ \hline
Reference & 4.59 & 102.5 \\ \hline
LiGAN & 3.40 & 18693.8 \\
Pocket2Mol & 5.62 & 194.9 \\
TargetDiff & 9.08 & 1241.7 \\ \hline
3DMolFormer & \textbf{3.25} & \textbf{183.3} \\ \hline
\end{tabular}
\end{center}
\end{table}

Furthermore, DrugPose~\citep{DrugPose} offers a broad range of metrics for 3D drug discovery, its overlap with PoseCheck in the context of structure-based drug design makes PoseCheck a sufficient benchmark for our evaluation, ensuring comprehensive assessment without redundancy.