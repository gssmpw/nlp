\begin{figure*}[!t]
  \centering
  \tikzset{
          my node/.style={
              draw,
              align=center,
              thin,
              text width=1.2cm, 
              % minimum height=1cm,
              rounded corners=3,
          },
          my leaf/.style={
              draw,
              align=left,
              thin,
              % minimum width=1cm,
              text width=8.5cm, 
              % text height=1cm, 
              % minimum height=0.5cm,
              rounded corners=3,
          }
  }
  \forestset{
    every leaf node/.style={
      if n children=0{#1}{}
    },
    every tree node/.style={
      if n children=0{minimum width=1em}{#1}
    },
  }
  \begin{forest}
      nonleaf/.style={font=\bfseries\scriptsize},
       for tree={%
          % my node,
          every leaf node={my leaf, font=\scriptsize},
          every tree node={my node, font=\scriptsize, l sep-=4.5pt, l-=1.pt},
          anchor=west,
          inner sep=2pt,
          % l = 10pt,
          l sep=10pt, % control leaf to parent nodes gaps (horizontal)
          s sep=3pt, % control node gaps (vertical)
          fit=tight,
          grow'=east,
          edge={ultra thin},
          parent anchor=east,
          child anchor=west,
          if n children=0{}{nonleaf}, 
          edge path={
              \noexpand\path [draw, \forestoption{edge}] (!u.parent anchor) -- +(5pt,0) |- (.child anchor)\forestoption{edge label};
          },
          if={isodd(n_children())}{
              for children={
                  if={equal(n,(n_children("!u")+1)/2)}{calign with current}{}
              }
          }{}
      }
      [Discrete Speech Tokens, draw=gray, fill=gray!15, text width=1.7cm, text=black
      [
        Pre-requisites: Discrete Representation Learning \\ (Section \ref{sec:prereq}), color=turquoise, fill=turquoise!15, text width=6cm, text=black
        [{\textbf{Offline Clustering}: k-means clustering, agglomerative clustering, etc.}, color=turquoise, fill=turquoise!15, text width=8cm, text=black]
        [{\textbf{Vector Quantization}: k-means VQ, Gumbel VQ, RVQ, GVQ, FSQ, etc.}, color=turquoise, fill=turquoise!15, text width=8cm, text=black
          % [{}, color=turquoise, fill=turquoise!15, text width=6cm, text=black]
        ]
      ]
      [{Acoustic Tokens \\ ({Section \ref{sec:acoustic}}, Table \ref{tab:acoustic-metadata})}, color=limegreen, fill=limegreen!10, text width=2.5cm, text=black
            [{Model architectures\\ ({Section \ref{sec:acoustic-arch})}}, 
            color=limegreen, fill=limegreen!10, text width=2.5cm, text=black
            [{\textbf{VQ-GAN}: CNN-based, Transformer-based, U-Net-based, etc.
            }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
            [{\textbf{Latent diffusion}: LaDiffCodec~\cite{yang2024generative}, SemantiCodec~\cite{liu2024semanticodec}, etc.
            }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black]
            ],
            [General-Purpose\\ (Section {\ref{sec:acoustic-general}}), color=limegreen, fill=limegreen!10, text width=2.5cm, text=black
            [{
                \textbf{Advanced VQ methods and model architectures}: DAC~\cite{kumar2024high}, TS3-Codec~\cite{wu2024ts3codectransformerbasedsimplestreaming}, etc.
                }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
            [{
                \textbf{Temporal redundancy reduction}: Disen-TF-Codec~\cite{jiang2023disentangled}, TiCodec~\cite{ticodec}, etc.
                }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
            [{
                \textbf{Multi-resolution or variable-bitrate}: SNAC~\cite{Siuzdak_SNAC_Multi-Scale_Neural_2024}, VRVQ~\cite{chae2024variable}, etc.
                }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black]
            ],
            [Semantic Distillation\\ ({Section \ref{sec:acoustic-distillation}}), color=limegreen, fill=limegreen!10, text width=2.5cm, text=black
              [{ 
                \textbf{SSL feature guidance}: SpeechTokenizer~\cite{zhang2024speechtokenizer}, Mimi~\cite{kyutai2024moshi}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
              [{ 
                \textbf{Fixed semantic codebook}: LLM-Codec~\cite{yang2024uniaudio15}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
              [{ 
                \textbf{SSL as inputs or outputs}: X-Codec~\cite{ye2024codec}, SemantiCodec~\cite{liu2024semanticodec}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
            ],
            [Disentanglement\\ ({Section \ref{sec:acoustic-disen}}), color=limegreen, fill=limegreen!10, text width=2.5cm, text=black
              [{ 
                \textbf{Gradient reversal layer}: SSVC~\cite{SSVC}, FACodec~\cite{facodec}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
              [{ 
                \textbf{Perturbation}: LSCodec~\cite{guo2024lscodec}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
              [{ 
                \textbf{Source separation}: SD-Codec~\cite{bie2024learning}, etc.
              }, color=limegreen, fill=limegreen!10, text width=8.5cm, text=black],
            ],
          ]
    [Semantic Tokens \\ (Section {\ref{sec:semantic}, Table \ref{tab:semantic-metadata}}), color=plum, fill=plum!15, text width=2.5cm, text=black
            [General-Purpose SSL \\ (Section {\ref{sec:semantic-general}}), color=plum, fill=plum!15, text width=3cm, text=black
            [{\textbf{Contrastive}: vq-wav2vec~\cite{vq-wav2vec}, wav2vec 2.0~\cite{baevski2020wav2vec}, etc.}, color=plum, fill=plum!15, text width=8cm, text=black],
            [{\textbf{Predictive}: HuBERT~\cite{hsu2021hubert}, WavLM~\cite{chen2022wavlm}, etc.}, color=plum, fill=plum!15, text width=8cm, text=black],
          ],
            [Perturbation-Invariant SSL \\ (Section {\ref{sec:semantic-invariant}}), color=plum, fill=plum!15, text width=3.5cm, text=black
            [{\textbf{Contrastive-based}: ContentVec~\cite{qian2022contentvec}, SPIRAL~\cite{huang2022spiral}, etc.}, color=plum, fill=plum!15, text width=7.5cm, text=black],
            [{\textbf{Distribution-based}: Spin~\cite{chang23_interspeech}, NAST~\cite{messica2024nast}, etc.}, color=plum, fill=plum!15, text width=7.5cm, text=black],
            [{\textbf{CTC-based}: Gat et al.~\cite{gat2023augmentation}, etc.}, color=plum, fill=plum!15, text width=7.5cm, text=black],
          ],
          [Supervised Tokens \\ (Section {\ref{sec:semantic-supervised}}), color=plum, fill=plum!15, text width=3cm, text=black
            [{ \textbf{ASR-based}: 
                Whisper~\cite{whisper}, $\mathcal S^3$ Tokenizer~\cite{du2024cosyvoice}, etc.
              }, color=plum, fill=plum!15, text width=5.5cm, text=black],
          ],
          [\textbf{~~~~Length Reduction by Deduplication and Acoustic BPE ({Section \ref{sec:dedup-bpe}})}, color=plum, fill=plum!15, text=black, align=center, text width=8.5cm
          ],
          [\textbf{~~~~~~~Variable Frame Rate Tokens and Unit Discovery (Section {\ref{sec:variable-rate}})}, color=plum, fill=plum!15, text width=8.5cm, text=black, align=center
          ],
          [\textbf{~~~~~~~~~~~~~~~~~~~~~~Speech Token Vocoders (Section {\ref{sec:vocoder}})}, color=plum, fill=plum!15, text width=8.5cm, text=black, align=center
          ],
      ],
      [{\textbf{Analysis (Section \ref{sec:analysis})}: Metrics, benchmarks, reconstruction and voice conversion comparisons}, color=lightyellow, fill=lightyellow!15, text width=11cm, text=black, align=center
       ],
       [\textbf{Applications (Section \ref{sec:application}), Challenges and Future Directions (Section \ref{sec:challenge})}, color=lightyellow, fill=lightyellow!15, text width=11cm, text=black, align=center
       ]
       ]
      \end{forest}
  \caption{Structure of this review}
  \vspace{-0.2in}
  \label{fig: Taxonomy}
  \end{figure*}