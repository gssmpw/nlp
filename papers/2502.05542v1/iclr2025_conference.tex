
\documentclass{article} % For LaTeX2e
\usepackage{iclr2025_conference,times}

% Optional math commands from https://github.com/goodfeli/dlbook_notation.
\input{math_commands.tex}

\usepackage{hyperref}
\usepackage{url}

% my packages
\usepackage{tikz}
\usepackage{cite}
\usepackage{amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}

\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{todonotes}
\usepackage{comment}  
\usepackage{amsthm}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem*{problem}{Problem}%[section]
\usepackage{setspace}
\usepackage{multirow}
\usepackage{array}

\usetikzlibrary{automata, positioning}
\usetikzlibrary{shapes.geometric, arrows}
\usepackage{pgfplots}
\usepgfplotslibrary{statistics}
%\usepackage{times}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{threeparttable}

\usetikzlibrary{matrix}

\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\newcommand\mycommfont[1]{\footnotesize\ttfamily\textcolor{blue}{#1}}
\SetCommentSty{mycommfont}
\SetKwRepeat{Do}{do}{while}
\SetKwInput{KwInput}{Input}                % Set the Input
\SetKwInput{KwOutput}{Output}              % set the Output

%flow chart def
\tikzstyle{startstop} = [rectangle, rounded corners, minimum width=1cm, minimum height=0.5cm,text centered, draw=black]
\tikzstyle{io} = [trapezium, trapezium left angle=70, trapezium right angle=110, minimum width=2cm, minimum height=0.5cm, text centered, draw=black]
\tikzstyle{process} = [rectangle, minimum width=2cm, minimum height=0.5cm, text centered,draw=black]
\tikzstyle{process_n} = [rectangle, minimum width=1.5cm, minimum height=0.5cm, text centered,text width=1.5cm, draw=black]
\tikzstyle{decision} = [diamond, minimum width=1.2cm, minimum height=0.5cm, text centered, aspect=1.5, draw=black]
\tikzstyle{arrow} = [->,>=stealth]


\title{Democratic Training Against Universal Adversarial Perturbations}

% Authors must not appear in the submitted version. They should be hidden
% as long as the \iclrfinalcopy macro remains commented out below.
% Non-anonymous submissions will be rejected without review.

\author{Bing Sun  \\
Singapore Management University\\
\texttt{bing.sun.2020@phdcs.smu.edu.sg}
\And
Jun Sun\\
Singapore Management University\\
\texttt{junsun@smu.edu.sg}
\AND
Wei Zhao \\
Singapore Management University\\
\texttt{wzhao@smu.edu.sg}
}

% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to \LaTeX{} to determine where to break
% the lines. Using \AND forces a linebreak at that point. So, if \LaTeX{}
% puts 3 of 4 authors names on the first line, and the last on the second
% line, try using \AND instead of \And before the third author name.

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\iclrfinalcopy % Uncomment for camera-ready version, but NOT for submission.
\begin{document}


\maketitle

\begin{abstract}
Despite their advances and success, real-world deep neural networks are known to be vulnerable to adversarial attacks. Universal adversarial perturbation, an input-agnostic attack, poses a serious threat for them to be deployed in security-sensitive systems. In this case, a single universal adversarial perturbation deceives the model on a range of clean inputs without requiring input-specific optimization, which makes it particularly threatening. In this work, we observe that universal adversarial perturbations usually lead to abnormal entropy spectrum in hidden layers, which suggests that the prediction is dominated by a small number of ``feature'' in such cases (rather than democratically by many features). Inspired by this, we propose an efficient yet effective defense method for mitigating UAPs called \emph{Democratic Training} by performing entropy-based model enhancement to suppress the effect of the universal adversarial perturbations in a given model. \emph{Democratic Training} is evaluated with 7 neural networks trained on 5 benchmark datasets and 5 types of state-of-the-art universal adversarial attack methods. The results show that it effectively reduces the attack success rate, improves model robustness and preserves the model accuracy on clean samples. 
\end{abstract}

\section{Introduction}
Advances and success in deep learning have enabled the widespread use of Deep Neural Networks (DNNs) based machine learning models. DNNs become the algorithm of choice for a wide range of applications~\citep{fraud_detection,face_recognition,selfdriving,medical_diagnosis}. However, despite their success, DNNs are found to make erroneous predictions when a carefully crafted, small magnitude human-imperceptible perturbation is added to an input~\citep{fgsm,ifgsm,pgd,uap}. One can easily conduct adversarial attacks against the target network by generating adversarial examples utilizing such perturbations. The existence of adversarial examples has become a serious concern to systems based on DNNs especially in safety-critical applications. 
%Furthermore, it has been shown that adversarial perturbations can be applied to attack large multi-modal models, which makes them relevant in the era of large models~\citep{vlm_adv,image_adv,llm_adv}.
%Thus, neural networks remain vulnerable to adversarial examples that appear similar to genuine data but will deceive the model. 
Neural network adversarial attacks can be input-specific~\citep{fgsm,ifgsm,pgd,featAE,attAE,fda} or input-agnostic~\citep{uap,uat,datafree,nag,gap,uap_gm,uap_ua}. In the case of input-specific attacks or per-instance attacks, perturbations are individually optimized for each input to produce the corresponding adversarial example. 
%In such a setting, the adversarial perturbation is specific to an input and may or may not transfer to other inputs. 
In contrast, in input-agnostic attacks, a single perturbation is optimized for a set of inputs to produce an universal perturbation to generate a set of adversarial examples. Such perturbations are often referred to as universal adversarial perturbations (UAP), where the same perturbation applied to a range of clean inputs will cause the model to misclassify. Compared to input-specific adversarial attacks, UAPs could be considered more threatening since they are more efficient in terms of computation cost from the attack point of view. Furthermore, defending against UAPs poses a significant challenge, as it is hypothesized that they exploit and amplify legitimate features essential to the model's performance~\citep{uap,datafree,uapdefensefeatregen}.

\begin{figure*}[t]
\includegraphics[width=0.9\textwidth]{pic/overview.pdf}
\centering 
\caption{An overview of our framework }
\label{fig:overall}
\end{figure*}
A number of practical and realistic attacks based on UAPs have been successfully conducted in various scenarios, i.e., image classification~\citep{uap}, facial recognition~\citep{uap_face}, object detection~\citep{uap_obj,uap_obj2}, etc.~\citet{uap} first explore the existence of UAPs. For a given set of training inputs, the proposed algorithm iteratively computes the perturbation to make an adversarial example across the decision boundary of the expected predicted category. %Then, the perturbations are aggregated to update the final UAP. Finally, the process will terminate when the attack success rate is high enough. 
Following this work, several different approaches have been proposed to generate UAPs from different aspects, utilizing different loss functions. These can be categorized into two main groups~\citep{uap_survey}: 1) noise-based~\citep{uap,datafree,cduap,spgd}, and 2) generator-based methods~\citep{gap,nag,ttp}. Noise-based methods directly update the perturbation through optimization. On the other hand, generator-based methods train a generative network in prior to obtain the perturbation indirectly. 
%Both types of methods work well in generating UAPs and strong transferability across models are achieved as well.
UAP becomes a relevant threat in practice and it is important to manage such security risk and ensure neural networks are robust against such attacks. A range of existing works have been proposed to address the problem of defending machine learning models against UAPs. These include finetuning a given model's parameters with UAP perturbed samples~\citep{uap,spgd}, inserting feature regeneration layers~\citep{uapdefensefeatregen}, applying feature norm clipping techniques~\citep{cfn}, etc. 
%Moosavi-Dezfooli~\emph{et al.}~\citep{uap} propose to finetune a given model's parameters with pre-computed UAP perturbed samples. Following this work, Mummadi~\emph{et al.}~\citep{spgd} propose to generate UAPs on-the-fly through shared adversarial training instead of pre-computed fixed UAPs. Borkar~\emph{et al.}~\citep{uapdefensefeatregen} proposed to construct a feature regeneration unit layer consisting of a residual block with a single skip connection to regenerate only the most adversarially susceptible activations into resilient features. Similarly, Yu~\emph{et al.}~\citep{cfn} propose to insert a feature norm clipping layer in a given neural network to adaptively suppress the generation of large norm deep feature vectors caused by perturbations. 
However, existing methods mainly focus on non-targeted attacks~\citep{uap,uat,classuat} and often require to craft a large number of UAPs~\citep{uap,spgd,uat,classuat,uapdefensefeatregen} or change the architecture of the original model~\citep{uapdefensefeatregen,cfn,fns}. 

In this work, we focus on targeted universal adversarial attack which is both more relevant from an attacker point of view (i.e., so that the attacker can trigger specific target outcome) and more challenging from a defender point of view. Our approach does not require constructing UAPs or modifying the model architecture. We propose a scalable algorithm that mitigates the effect of UAPs through entropy based model enhancement. Specifically, as described in Figure~\ref{fig:overall} we propose \emph{Democratic Training} with the key idea of enhancing a given neural network by adjusting the weights of hidden neurons towards the correct predictions in the presence of UAPs. We first analyze the distribution of hidden neuron activation when an input perturbed with UAP is supplied to a model and compare that with the activation when clean samples are supplied. 
%The distribution difference would imply the features that contributes most to the misclassification which are activated by the perturbed input. 
We study the entropy of such hidden neuron activation and our empirical results suggest that the presence of UAP causes layer-wise entropy to drop and such effect becomes more severe at deeper layers. We conjecture that this is because the UAP enforces the ``power'' of certain features, which subsequently dominates the prediction. Base on such result, we propose to mitigate the effect of UAPs through adversarial finetuning guided by hidden layer entropy, or philosophically speaking, enforcing democracy in the decision making.
We compare the performance of our work with existing solutions on UAP defense and show that \emph{Democratic Training} improves existing approaches significantly.

%The remainder of the paper is organized as follows. In Section~\ref{sec:prelim}, we present relevant background and define our problem. Our approach is presented in Section~\ref{sec:approach} in detail. We evaluate our approach in Section~\ref{sec:evaluation}. Related work is reviewed in Section~\ref{sec:related}. Lastly, we conclude in Section~\ref{sec:conclusion}. In the appendix, we present a high-level discussion in Section~\ref{app:discussion}.


\section{Preliminaries} \label{sec:prelim}
%In this section, we review relevant background and define our problem. 
\begin{comment}
\subsection{Neural Networks}
Firstly, we introduce necessary background knowledge on neural networks. 

In this work, a neural network is viewed as a function $N: \mathbb{R}^{p} \to \mathbb{R}^{q}$ which maps an input $i\in \mathbb{R}^{p}$ and $i\in I$ to an output $y \in \mathbb{R}^{q}$, e.g., predictions for image classification.
In this work, we focus on convolutional neural networks on image classification task. We leave other neural network models and tasks to the future work. 
Neural networks usually follow a layered architecture, where the computational nodes, a.k.a.~neurons, are organized layer-wise and data flows from layer to layer. The first layer is the input layer; the last layer is the output layer and the remaining are hidden layers. 
Based on the transformation that a layer performs, there are many types of layers, such as convolution, pooling and recurrent.
%among which, affine layers and activation layers are two commonly used layers. An affine layer applies an affine transformation i.e., $\pi(x) = Wx + b$ where $x$ is the input from the previous layer; $W$ is a weight matrix and $b$ is a bias. An activation layer applies a non-linear activation function $\sigma$. Commonly applied activation functions include Rectified Linear Unit (ReLU) $\sigma(x) = max(0, x)$, Sigmoid $\sigma(x) = \frac{e^x}{e^x+1}$ and Tanh $\sigma(x) = \frac{e^x-e^{-x}}{e^x+e^{-x}}$. These functions are applied neuron-wise, e.g., given an input $x = (x_0, \cdots , x_{p-1}) \in \mathbb{R}^{p}$, $\sigma(x) = \big(\sigma(x_0), \cdots , \sigma(x_{p-1})\big)$. 
In the following, we assume a neural network $N$ consists of $n$ layers, and each layer $l$ contains $d_l$ neurons. Then layer $l$ is a function $f_l: \mathbb{R}^{d_{l-1}} \to \mathbb{R}^{d_{l}}$ mapping the input of layer $l$, i.e., $x_l$, to the input of layer $l+1$, i.e., $x_{l+1}$, and the neural network is function $N: \mathbb{R}^{p} \to \mathbb{R}^{q}$, where $q$ is the dimension of output. Usually the input layer does not transform the data, and thus $f_0=I$. 
\end{comment}
\subsection{Universal Adversarial Perturbation}
%Firstly, we describe neural network universal adversarial perturbation attack.

We start with introducing the notation for targeted UAP attacks. Given a trained neural network $N$, a test dataset $X$ and let $y_t$ represent the attacker-chosen target class. A targeted UAP is a perturbation $\delta$ that satisfies the following:
\begin{align}
\begin{aligned}
N(x~+~\delta) = y_t\\
{\parallel \delta \parallel}_p \leq \epsilon
\end{aligned}\label{eq:uap:ae}
\end{align}
where $x~\in~X$ and $|X|$ is sufficiently large and $\delta$ is bounded by certain $l_p$ norm (${\parallel \delta \parallel}_p \leq \epsilon$). We remark that here we focus on a definition of vicinity based on $l_p$ norm. In general, it can be defined in other forms as well. For instance, a UAP can take the form of a patch that is small in size but applying it to a range of clean inputs, the model will classify the perturbed inputs as the target class.

The existence of UAP shows that there are systemic vulnerabilities in the model which can be exploited by an attacker regardless of the input. Hence, UAP attacks pose serious threats in real-world applications of neural networks such as attacking facial recognition systems where incorrect identity is returned~\citep{face,mask}, autonomous driving systems where a wrong traffic sign or road condition is misidentified~\citep{double,uap_obj}, speech recognition systems which may cause various systems to interpret human commands wrongly~\citep{speech}, malware detection systems where suspicious programs may bypass the detection~\citep{malware} and many others~\citep{uap,datafree,segmentation,nlp}.

\subsection{Evaluation Metrics} 
\textbf{Attack Success Rate (SR)}: This metric measures the percentage of adversarial samples (except the samples of the target class $y_t$) classified to the target class $y_t$: 
\begin{equation}
SR = \sum_{x\in (X - X_t)}\frac{|N(x + \delta) = y_t|}{|X| - |X_t|}
\end{equation}
where $x\in X$ represents a clean input from dataset $X$, $X_t \subset X$ represents a set of samples from the target class $y_t$.

\textbf{Adversarial Accuracy (AAcc.)}: This metric measures the accuracy of adversarial examples (where $y_x$ represents the label of sample $x$):
\begin{equation}
AAcc. = \sum_{x\in X}\frac{|N(x + \delta) = y_x|}{|X|}
\end{equation}

\subsection{Entropy}
%Next, we introduce the concept of entropy and how entropy can be measured in a neural network.

\textbf{Shannon Entropy:}
In information theory, the entropy of a random variable represents the average amount of ``information'' or ``uncertainty'' associated with the variable's possible outcomes. The concept of information entropy was introduced by Claude Shannon~\citep{shannonentropy}, where the Shannon entropy is proposed to quantify the amount of information carried by a variable. For a random variable $v$, which takes values from the set $V$ that follows the probability distribution $p:V\rightarrow[0,1]$ the entropy of $v$ is defined as:
\begin{equation}
    H(v) = -\sum_{v \in V}p(v)\log{p(v)}
\label{eqn:shannon}
\end{equation}
where the summation denotes the sum over the variable's possible values. 

\textbf{Measure the Entropy of A Neural Network:} The concept of entropy can be applied in neural networks for different purposes. Appendix~\ref{app:entropy} shows two methods proposed in existing works measuring the entropy of a given neural network. In this work, we propose to measure layer-wise entropy to understand how UAP fools a given neural network. The details are provided in Section~\ref{subsec:entropy}.

\subsection{Threat Model}\label{sec:pre:threatmodel}
Our approach aims to mitigate the effect of UAPs for third-party trained neural networks. In this work, we assume an evasion threat where a set of clean data is available to the adversary.
\begin{itemize}
    \item \emph{Adversary goals.} The goal of the adversary is to generate UAPs such that once applied to a range of clean inputs, the model will classify the perturbed inputs wrongly.
    \item \emph{Adversarial capabilities.} We assume the adversary has white-box access to the model and is capable of crafting UAPs.
    \item \emph{Adversarial knowledge.} We assume that the adversary has the information on the target model's architecture, inner parameters and optimization algorithms.
    %\todo{the above item assume attack has access to model for inference but this item assume the attacker cannot access the inner parameters of the model}
\end{itemize}


Our goal is to mitigate the effect of UAPs on a given model with minimum assumptions. Specifically, we assume the defender has the following knowledge about the neural network:

\begin{itemize}
    \item \emph{Defense goals.} We aim to design a strategy that can remove the effect of UAPs from the model by adjusting the model parameters.

    \item \emph{Defender's capabilities.} We assume the defender has white-box access to the neural network model. The defender has information about the model architecture but cannot interfere with the training process.
    \item \emph{Defender's knowledge.} We assume a small set of clean data is available (as it is usually the case in practice), either given by the model provider or collected by the defender, to test the model's performance. 

\end{itemize}


\subsection{Our Problem} 

%We are now ready to define our problem. 
\begin{problem}
Let $N$ be a neural network which is assumed to be obtained from a third party; $x$ is an input and $\epsilon$ is a small positive threshold. The UAP defense problem is to mitigate the effect of UAPs on $N$ such that the predictions of inputs patched with UAPs stay robust. Furthermore, the UAPs are bounded by $l_p$ norm where ${\parallel \delta \parallel}_p \leq \epsilon$. We would also require that the model's performance on clean data is minimally affected after the mitigation process.
\end{problem}

%In this work we consider targeted UAP attack where the UAP infected samples are misclassified into the adversarial-chosen target class.

\begin{comment}
\begin{example}
We use the following running example to illustrate how our approach works.
Given a neural network $N$ trained on ImageNet~\citep{imagenet} dataset with ResNet50 architecture, which performs image classification task of objects from 1000 classes. The accuracy of $N$ on clean samples is $73.7\%$. The attacker has direct access to $N$ and is capable of crafting UAPs with chosen target classes. The attacker chooses 174 as the target class and trains a UAP following the state-of-the-art UAP attack method proposed~\citep{datafree}. The attack success rate achieved is $72.8\%$. Our problem is to adjust the parameters of $N$ and mitigate the effect of the UAP. We set the perturbation threshold $\epsilon$ to $10/255$ and assume the UAP is bounded by $l_{\infty}$ norm where ${\parallel \delta \parallel}_{\infty} \leq \epsilon$ during the defense process.

\label{eg:problem}
\end{example}
\end{comment}

\section{Our Approach} \label{sec:approach}
%In this section, we present the details of our approach. 
To understand how UAPs deceive a model, we first conduct a systematic analysis of model behaviors from the lens of entropy. We study layer-wise entropy of a given model with and without the presence of UAPs. As we shall show in Section~\ref{subsec:analysis}, the presence of UAPs will cause the layer-wise entropy to be abnormally lower than that on clean inputs. Furthermore, such effect becomes more severe at deeper layers. Based on these findings, we propose \emph{Democratic Training} which conducts entropy-based model enhancement to repair the given model such that the effect of UAPs is mitigated. 


\subsection{Entropy Measurement}
\label{subsec:entropy}
Firstly, we present how entropy is measured in this work. For a given neural network $N$, consisting of $n$ layers, we treat each layer $l$ as a single random variable, characterized by its input $x_{l}$ and output $x_{l+1}$. Thus, for a layer $l$ containing $d_l$ neurons, given an input to this layer $x_l = \{x_l^0,~ x_l^1,~\cdots,~x_l^{d_{l-1} - 1}\}$, its layer-wise entropy is calculated as:
\begin{equation}
\begin{gathered}
    \chi_l = \sigma(W_l x_l + b_l) \\
    p_l = softmax(\chi_l) \\
    H_l = -\sum_{k=0}^{k=d_l-1} p_l(k)\log{p_l(k)}
\end{gathered}
\label{eqn:entropy}
\end{equation}
where $W_l$ and $b_l$ are the weight and bias parameters of layer $l$ and $\sigma$ is the activation function of layer $l$. Intuitively, we treat the activated value $p_l(k)$ of each neuron in layer $l$ as the activation probability for neuron $k$, and calculate the Shannon entropy of $p_l$ following Equation~\ref{eqn:shannon}. For a given input to layer $l$, higher layer entropy $H_l$ indicates higher ambiguity and lower entropy $H_l$ indicates higher certainty.


\subsection{Entropy Analysis} \label{subsec:analysis}
To understand how UAP fools a trained neural network, we conduct empirical study on the layer-wise entropy of the model as follows: 
\begin{itemize}
    \item \emph{Step 1.} Given a pretrained neural network, generate a UAP  such that the model classifies samples perturbed with the UAP as the target class.
    \item \emph{Step 2.} Analyze the layer-wise entropy with clean samples only, i.e., we randomly select a set of clean samples and calculate their layer-wise entropy defined in Equation~\ref{eqn:entropy}.
    \item \emph{Step 3.} Apply the UAP generated in \emph{Step 1} to the same set of clean samples selected in \emph{Step 2} and analyze the layer-wise entropy. 
    \item \emph{Step 4.} Take the UAP itself as an input to the model and analyze the layer-wise entropy.
\end{itemize}  

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.17639732,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.0854320526123)
        (1,12.117166519165)
        (2,12.0732774734497)
        (3,12.125186920166)
        (4,12.1082220077514)
        (5,12.1671056747436)
        (6,12.1428470611572)
        (7,12.0757865905761)
        (8,11.9738111495971)
        (9,12.1280364990234)
        (10,12.1485080718994)
        (11,12.1028852462768)
        (12,12.1356201171875)
        (13,12.1620349884033)
        (14,12.1589565277099)
        (15,12.1422529220581)
        (16,12.060357093811)
        (17,12.1113300323486)
        (18,12.1190404891967)
        (19,12.1142845153808)
        (20,12.157018661499)
        (21,12.1005859375)
        (22,12.1289463043212)
        (23,12.132432937622)
        (24,12.1010026931762)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.1527795791625)
        (1,12.1405420303344)
        (2,12.0218534469604)
        (3,12.143120765686)
        (4,12.1690979003906)
        (5,12.1509990692138)
        (6,12.1524457931518)
        (7,12.1541910171508)
        (8,12.123532295227)
        (9,12.0910892486572)
        (10,12.1476144790649)
        (11,12.1401290893554)
        (12,12.1245441436767)
        (13,12.1301326751708)
        (14,12.1621007919311)
        (15,12.1350545883178)
        (16,12.119680404663)
        (17,12.0905694961547)
        (18,12.1162862777709)
        (19,12.159701347351)
        (20,11.9194393157958)
        (21,12.1394414901733)
        (22,12.1324682235717)
        (23,12.1026248931884)
        (24,12.1396913528442)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot1.1,
    at={(0.8cm,0.05cm)},
    %title={Shallow Layer 1},
    ylabel=\empty,%{Layer-wise Entropy},
    ytick = {11.9,12,12.1},
    yticklabels = {11.90,12.00,12.10},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.17639732,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]
   
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.0854320526123)
        (1,12.117166519165)
        (2,12.0732774734497)
        (3,12.125186920166)
        (4,12.1082220077514)
        (5,12.1671056747436)
        (6,12.1428470611572)
        (7,12.0757865905761)
        (8,11.9738111495971)
        (9,12.1280364990234)
        (10,12.1485080718994)
        (11,12.1028852462768)
        (12,12.1356201171875)
        (13,12.1620349884033)
        (14,12.1589565277099)
        (15,12.1422529220581)
        (16,12.060357093811)
        (17,12.1113300323486)
        (18,12.1190404891967)
        (19,12.1142845153808)
        (20,12.157018661499)
        (21,12.1005859375)
        (22,12.1289463043212)
        (23,12.132432937622)
        (24,12.1010026931762)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.1527795791625)
        (1,12.1405420303344)
        (2,12.0218534469604)
        (3,12.143120765686)
        (4,12.1690979003906)
        (5,12.1509990692138)
        (6,12.1524457931518)
        (7,12.1541910171508)
        (8,12.123532295227)
        (9,12.0910892486572)
        (10,12.1476144790649)
        (11,12.1401290893554)
        (12,12.1245441436767)
        (13,12.1301326751708)
        (14,12.1621007919311)
        (15,12.1350545883178)
        (16,12.119680404663)
        (17,12.0905694961547)
        (18,12.1162862777709)
        (19,12.159701347351)
        (20,11.9194393157958)
        (21,12.1394414901733)
        (22,12.1324682235717)
        (23,12.1026248931884)
        (24,12.1396913528442)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=13.57789326,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,13.5717210769653)
        (1,13.577896118164)
        (2,13.5730905532836)
        (3,13.5765666961669)
        (4,13.5737161636352)
        (5,13.5817327499389)
        (6,13.5803699493408)
        (7,13.5694942474365)
        (8,13.5706443786621)
        (9,13.5767698287963)
        (10,13.5793952941894)
        (11,13.5766172409057)
        (12,13.5751447677612)
        (13,13.583511352539)
        (14,13.5821533203125)
        (15,13.5789995193481)
        (16,13.5707139968872)
        (17,13.5784139633178)
        (18,13.5778532028198)
        (19,13.5781469345092)
        (20,13.5813093185424)
        (21,13.5762605667114)
        (22,13.5760221481323)
        (23,13.5762281417846)
        (24,13.5761175155639)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,13.5781164169311)
        (1,13.5764799118042)
        (2,13.5639142990112)
        (3,13.5747232437133)
        (4,13.5778121948242)
        (5,13.5768709182739)
        (6,13.5771875381469)
        (7,13.5763568878173)
        (8,13.5713748931884)
        (9,13.5706014633178)
        (10,13.5768327713012)
        (11,13.5762681961059)
        (12,13.5733594894409)
        (13,13.5767021179199)
        (14,13.5795078277587)
        (15,13.5765552520751)
        (16,13.5750112533569)
        (17,13.5702199935913)
        (18,13.5721168518066)
        (19,13.5773439407348)
        (20,13.5703372955322)
        (21,13.5756406784057)
        (22,13.5752124786376)
        (23,13.5723991394042)
        (24,13.5746068954467)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot2.1,
    at={(2.85cm,0.05cm)},
    %title={Shallow Layer 2},
    ytick = {13.57,13.58},
    yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=13.57789326,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,13.5717210769653)
        (1,13.577896118164)
        (2,13.5730905532836)
        (3,13.5765666961669)
        (4,13.5737161636352)
        (5,13.5817327499389)
        (6,13.5803699493408)
        (7,13.5694942474365)
        (8,13.5706443786621)
        (9,13.5767698287963)
        (10,13.5793952941894)
        (11,13.5766172409057)
        (12,13.5751447677612)
        (13,13.583511352539)
        (14,13.5821533203125)
        (15,13.5789995193481)
        (16,13.5707139968872)
        (17,13.5784139633178)
        (18,13.5778532028198)
        (19,13.5781469345092)
        (20,13.5813093185424)
        (21,13.5762605667114)
        (22,13.5760221481323)
        (23,13.5762281417846)
        (24,13.5761175155639)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,13.5781164169311)
        (1,13.5764799118042)
        (2,13.5639142990112)
        (3,13.5747232437133)
        (4,13.5778121948242)
        (5,13.5768709182739)
        (6,13.5771875381469)
        (7,13.5763568878173)
        (8,13.5713748931884)
        (9,13.5706014633178)
        (10,13.5768327713012)
        (11,13.5762681961059)
        (12,13.5733594894409)
        (13,13.5767021179199)
        (14,13.5795078277587)
        (15,13.5765552520751)
        (16,13.5750112533569)
        (17,13.5702199935913)
        (18,13.5721168518066)
        (19,13.5773439407348)
        (20,13.5703372955322)
        (21,13.5756406784057)
        (22,13.5752124786376)
        (23,13.5723991394042)
        (24,13.5746068954467)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.87826347,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.8868417739868)
        (1,12.883807182312)
        (2,12.8853101730346)
        (3,12.8829355239868)
        (4,12.8888254165649)
        (5,12.8890504837036)
        (6,12.8823289871215)
        (7,12.8835926055908)
        (8,12.8837766647338)
        (9,12.8860216140747)
        (10,12.8856496810913)
        (11,12.8835697174072)
        (12,12.89071559906)
        (13,12.8898372650146)
        (14,12.885495185852)
        (15,12.8819437026977)
        (16,12.8872232437133)
        (17,12.8862743377685)
        (18,12.8874530792236)
        (19,12.8878936767578)
        (20,12.8855838775634)
        (21,12.8830986022949)
        (22,12.8850450515747)
        (23,12.8850908279418)
        (24,12.8903980255126)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.8845996856689)
        (1,12.8821802139282)
        (2,12.8758850097656)
        (3,12.8803186416625)
        (4,12.8793640136718)
        (5,12.8798866271972)
        (6,12.8800382614135)
        (7,12.8764762878417)
        (8,12.8764953613281)
        (9,12.8822937011718)
        (10,12.8808221817016)
        (11,12.88121509552)
        (12,12.8792133331298)
        (13,12.882658958435)
        (14,12.8841199874877)
        (15,12.8831787109375)
        (16,12.8829746246337)
        (17,12.8736019134521)
        (18,12.8758916854858)
        (19,12.8796405792236)
        (20,12.8791818618774)
        (21,12.8777637481689)
        (22,12.8805046081542)
        (23,12.8804197311401)
        (24,12.8756113052368)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(4.9cm,0.05cm)},
    %title={Middle Layer 1},
    ytick = {12.88,12.89},
    yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=12.87826347,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.8868417739868)
        (1,12.883807182312)
        (2,12.8853101730346)
        (3,12.8829355239868)
        (4,12.8888254165649)
        (5,12.8890504837036)
        (6,12.8823289871215)
        (7,12.8835926055908)
        (8,12.8837766647338)
        (9,12.8860216140747)
        (10,12.8856496810913)
        (11,12.8835697174072)
        (12,12.89071559906)
        (13,12.8898372650146)
        (14,12.885495185852)
        (15,12.8819437026977)
        (16,12.8872232437133)
        (17,12.8862743377685)
        (18,12.8874530792236)
        (19,12.8878936767578)
        (20,12.8855838775634)
        (21,12.8830986022949)
        (22,12.8850450515747)
        (23,12.8850908279418)
        (24,12.8903980255126)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.8845996856689)
        (1,12.8821802139282)
        (2,12.8758850097656)
        (3,12.8803186416625)
        (4,12.8793640136718)
        (5,12.8798866271972)
        (6,12.8800382614135)
        (7,12.8764762878417)
        (8,12.8764953613281)
        (9,12.8822937011718)
        (10,12.8808221817016)
        (11,12.88121509552)
        (12,12.8792133331298)
        (13,12.882658958435)
        (14,12.8841199874877)
        (15,12.8831787109375)
        (16,12.8829746246337)
        (17,12.8736019134521)
        (18,12.8758916854858)
        (19,12.8796405792236)
        (20,12.8791818618774)
        (21,12.8777637481689)
        (22,12.8805046081542)
        (23,12.8804197311401)
        (24,12.8756113052368)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.1959877,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.1999683380126)
        (1,12.2005186080932)
        (2,12.2004241943359)
        (3,12.2013864517211)
        (4,12.1989202499389)
        (5,12.2015800476074)
        (6,12.2016487121582)
        (7,12.201828956604)
        (8,12.2006177902221)
        (9,12.2001323699951)
        (10,12.1998386383056)
        (11,12.2014770507812)
        (12,12.2024459838867)
        (13,12.200849533081)
        (14,12.203143119812)
        (15,12.199683189392)
        (16,12.1999073028564)
        (17,12.2000865936279)
        (18,12.2031354904174)
        (19,12.2024374008178)
        (20,12.2022628784179)
        (21,12.2022972106933)
        (22,12.2013711929321)
        (23,12.2023105621337)
        (24,12.2020502090454)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.2029390335083)
        (1,12.201994895935)
        (2,12.1977005004882)
        (3,12.198483467102)
        (4,12.1972427368164)
        (5,12.2009983062744)
        (6,12.1988792419433)
        (7,12.1963958740234)
        (8,12.1987171173095)
        (9,12.20299243927)
        (10,12.2002611160278)
        (11,12.2000751495361)
        (12,12.1981830596923)
        (13,12.2008409500122)
        (14,12.2006139755249)
        (15,12.199818611145)
        (16,12.2007799148559)
        (17,12.1967716217041)
        (18,12.1966009140014)
        (19,12.1989345550537)
        (20,12.1997537612915)
        (21,12.196681022644)
        (22,12.1992378234863)
        (23,12.2011594772338)
        (24,12.1967849731445)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot4.1,
    at={(6.95cm,0.05cm)},
    %title={Middle Layer 2},
    %ylabel={Layer-wise Entropy},
    ytick = {12.20,12.2035},
    yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.1959877,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,12.1999683380126)
        (1,12.2005186080932)
        (2,12.2004241943359)
        (3,12.2013864517211)
        (4,12.1989202499389)
        (5,12.2015800476074)
        (6,12.2016487121582)
        (7,12.201828956604)
        (8,12.2006177902221)
        (9,12.2001323699951)
        (10,12.1998386383056)
        (11,12.2014770507812)
        (12,12.2024459838867)
        (13,12.200849533081)
        (14,12.203143119812)
        (15,12.199683189392)
        (16,12.1999073028564)
        (17,12.2000865936279)
        (18,12.2031354904174)
        (19,12.2024374008178)
        (20,12.2022628784179)
        (21,12.2022972106933)
        (22,12.2013711929321)
        (23,12.2023105621337)
        (24,12.2020502090454)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,12.2029390335083)
        (1,12.201994895935)
        (2,12.1977005004882)
        (3,12.198483467102)
        (4,12.1972427368164)
        (5,12.2009983062744)
        (6,12.1988792419433)
        (7,12.1963958740234)
        (8,12.1987171173095)
        (9,12.20299243927)
        (10,12.2002611160278)
        (11,12.2000751495361)
        (12,12.1981830596923)
        (13,12.2008409500122)
        (14,12.2006139755249)
        (15,12.199818611145)
        (16,12.2007799148559)
        (17,12.1967716217041)
        (18,12.1966009140014)
        (19,12.1989345550537)
        (20,12.1997537612915)
        (21,12.196681022644)
        (22,12.1992378234863)
        (23,12.2011594772338)
        (24,12.1967849731445)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(3.3cm,-2cm)},anchor=east
    },
    extra y ticks=1.336594462,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,2.52414894104003)
        (1,8.0197696685791)
        (2,9.22083377838134)
        (3,9.60391330718994)
        (4,7.66318273544311)
        (5,3.37342476844787)
        (6,1.99915122985839)
        (7,5.96103477478027)
        (8,4.51086711883544)
        (9,9.54139328002929)
        (10,3.0863082408905)
        (11,9.16902923583984)
        (12,3.1989049911499)
        (13,4.50541496276855)
        (14,0.932659208774566)
        (15,6.40612649917602)
        (16,2.79229497909545)
        (17,7.00087165832519)
        (18,0.953061878681182)
        (19,3.92422556877136)
        (20,4.15884256362915)
        (21,2.21940517425537)
        (22,8.8826036453247)
        (23,5.65687751770019)
        (24,5.1871223449707)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,2.25811600685119)
        (1,1.04614126682281)
        (2,1.83435499668121)
        (3,1.64329421520233)
        (4,0.984555065631866)
        (5,1.97279250621795)
        (6,1.78188681602478)
        (7,1.33115124702453)
        (8,1.79136312007904)
        (9,1.28549015522003)
        (10,1.05182969570159)
        (11,0.994981527328491)
        (12,1.11730849742889)
        (13,0.937602400779724)
        (14,1.13460946083068)
        (15,1.26021933555603)
        (16,0.79168289899826)
        (17,1.54191958904266)
        (18,1.94211828708648)
        (19,1.58844602108001)
        (20,1.20762121677398)
        (21,1.26260542869567)
        (22,1.26946878433227)
        (23,2.44393801689147)
        (24,2.3766496181488)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=1.01297617,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
        (0,7.19520664215087)
        (1,7.3831033706665)
        (2,7.45916271209716)
        (3,7.26062107086181)
        (4,7.41726446151733)
        (5,7.37809562683105)
        (6,7.16791105270385)
        (7,6.98327684402465)
        (8,7.11326694488525)
        (9,7.41021347045898)
        (10,7.143639087677)
        (11,7.35887241363525)
        (12,6.91690826416015)
        (13,7.28071546554565)
        (14,7.1797285079956)
        (15,7.15593433380126)
        (16,7.35578298568725)
        (17,7.51737022399902)
        (18,7.15663814544677)
        (19,7.40526866912841)
        (20,7.4073576927185)
        (21,7.06167221069335)
        (22,7.29092121124267)
        (23,7.26040935516357)
        (24,7.47097301483154)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
        (0,7.12496471405029)
        (1,7.0116844177246)
        (2,5.93120718002319)
        (3,1.82516527175903)
        (4,1.30063617229461)
        (5,5.96548748016357)
        (6,2.40787267684936)
        (7,1.95384049415588)
        (8,2.54403591156005)
        (9,6.39671516418457)
        (10,6.09615421295166)
        (11,2.85880613327026)
        (12,2.70766711235046)
        (13,5.31660652160644)
        (14,1.07961797714233)
        (15,2.06849145889282)
        (16,3.46069836616516)
        (17,5.88897371292114)
        (18,2.99263000488281)
        (19,2.55685472488403)
        (20,5.59372949600219)
        (21,3.36232137680053)
        (22,5.24739027023315)
        (23,5.25757598876953)
        (24,3.60746645927429)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy. Enlarged view for shallow and middle layers is provided.} 
\label{fig:empirical}
\end{figure*}

We conduct the analysis on all models shown in Table~\ref{tab:model} and for each model, multiple targeted UAPs are generated using a state-of-the-art UAP attack method DF-UAP~\citep{datafree}. We study the entropy of the pooling layers and the last layer of each stage. We observe similar results across all models and we show the results on $NN_1$ for shallow 1 (max pooling layer of stage 1), shallow 2 (end of stage 2), middle 1 (end of stage 3), middle 2 (end of stage 4), deep 1 (end of stage 5) and deep 2 (last average pooling layer) layers for illustration purpose. 
%Figure~\ref{fig:empirical} shows the layer-wise entropy spectrum of 1) clean samples, 2) UAP perturbed samples and 3) the UAP analyzed on $NN_1$. 
As shown in Figure~\ref{fig:empirical}, at shallow layers, the entropy spectrum for clean and UAP infected samples are quite similar. 
%The average layer-wise entropy for clean samples are $12.118$ and $13.577$ for Shallow Layer 1 and 2 respectively and entropy for UAP infected samples are $12.122$ and $13.575$.
At middle layers, the entropy of some UAP infected samples becomes smaller than that of the clean sample, but there is no clear boundary for separating the two for all samples. At deep layers, we observe clear separation between entropy from clean and perturbed samples, where UAP infected samples show abnormally small entropy compared to that of clean samples. These results suggest that the presence of UAP will cause layer-wise entropy to drop and such effect becomes more severe at deeper layers. We interpret entropy as an indicator of the neural network's uncertainty in classifying the intermediate features. High entropy suggests the features are ambiguous while low entropy indicates the model is more certain on classifying the features. Our analysis results show that the presence of UAP will cause the layer-wise entropy to drop significantly, and such lower entropy indicates the model is more certain on its classification at the same layer.  As shown in Figure~\ref{fig:empirical}, the entropy distribution of UAP perturbed samples leans towards the entropy of the UAP, i.e., the UAP dominates layer-wise entropy rather than the original image. At deeper layers, the entropy of UAP itself drops and is much lower than the entropy of clean samples, while the entropy of UAP perturbed samples follow such trend closely.  We believe that, UAPs contain dominant features that cause the model to be certain on the prediction class at earlier layers, i.e., instead of features from the original sample, features from UAP lead the model to predict the target class. Similar findings are reported in existing work~\citep{datafree} that suggests UAPs contain dominant features and original images behave like noise to them. We argue that such dominant features cause the layer-wise entropy to drop which dominates the model prediction.

%From such results, we confirm that UAPs contain dominant features that cause the model to be certain on the target prediction class at earlier layers. 

\subsection{Entropy-based Repair} \label{subsec:defense}

%In this section, we present how \emph{Democratic Training} is designed to remove the effect of UAPs from a trained model. 
%In the literature, there are multiple approaches proposed to improve the robustness of a given neural network against UAPs. However, there are different drawbacks from the existing approaches that prevent them from being applied to defend against UAP attacks in real-life. The first UAP defense method proposed in~\citep{uap}, finetunes the model parameters with the images perturbed by pre-computed UAPs. The performance is highly dependent on the quality of the pre-computed UAPs and marginal robustness enhancements are observed. Shared adversarial training is proposed in~\citep{spgd} which generates UAPs on-the-fly during training, but it takes 20 times more computation resources than normal training. Recently,~\citep{uapdefensefeatregen} proposes to defend against UAPs from feature level. In this approach, a feature regeneration unit is introduced such that it will suppress the effect of the perturbation. However, this approach changes the architecture of the original model and the proposed feature regeneration unit must be trained with clean samples in prior. Cheng Yu~\emph{et al.} proposed to defend against universal adversarial patch attacks by clipping feature norms where a clipping layer is added to the original model to suppress the large feature norms cause the adversarial patches. Although the feature norm clipping layer does not require training, similar to selective feature regeneration method, this approach modifies the original model architecture. To avoid the above mentioned drawbacks in existing approaches, we propose \emph{Democratic Training} as a simple but effective method to defend against UAPs. 
Based on our analysis results presented in Section~\ref{subsec:analysis}, we design a general approach for mitigating UAPs called \emph{Democratic Training}, which aims to finetune the model such that it learns to predict low-entropy samples (by effectively reducing the presence of certain dominate features in these samples). During this process, we introduce a \textit{Sample Generator} that will craft low entropy samples from clean samples to mimic the effect of UAPs and guide the model to the correct prediction. Note that, the \textit{Sample Generator} does not require information about the attack target class unlike existing works that rely on pre-computed perturbations~\citep{uap}. As described in Algorithm~\ref{alg:remove}, \emph{Democratic Training} requires a small set of clean sample $i \in I$ ($\leq5\%$ of training set) to finetune the original model $N$. For each epoch and each batch during finetuning, the \textit{Sample Generator} transforms a batch of clean inputs ($I_b$) into low entropy samples ($I_b^{en}$) as described in Algorithm~\ref{alg:sg}. Starting from clean sample $i$, the perturbation is updated based on the projection of the layer-wise entropy loss ($\textbf{H}(i)=-H_l(i)$) iteratively. At each step, a Clamp operation is applied to the perturbed sample to keep it within the perturbation bound. Next, \emph{Democratic Training} calculates the loss of clean and low entropy samples as below:
\begin{equation}
\label{eqn:repair_loss}
            \textbf{L}(i, i_{en}) = \alpha\textbf{L}_{cce}(i_{en}) + (1 - \alpha)\textbf{L}_{cce}(i)
\end{equation}
where $\textbf{L}_{cce}$ represents the categorical cross entropy loss, $i$ represents a clean sample and $i_{en}$ represents a low entropy example generated. In Equation~\ref{eqn:repair_loss}, $\alpha\textbf{L}_{cce}(i_{en})$ aims to guide low entropy samples towards the correct prediction by minimizing their cross entropy loss and $(1 - \alpha)\textbf{L}_{cce}(i)$ aims to keep the loss on clean samples low. Parameter $\alpha \in (0,1)$ controls the trade-off between the effectiveness of UAP removal and performance on unperturbed inputs during the optimization process. To make sure the loss on the low-entropy samples is low, the model must learn to ignore those dominating features present in the low-entropy samples, i.e., learn to predict based on many features rather than a small number of dominating features. In \emph{Democratic Training}, Back-propagation is adopted using the projected gradient descent (PGD) method~\citep{pgd}. Finally, \emph{Democratic Training} returns the updated model parameter $\theta$ as the result. Different from exiting methods (either generate UAPs in prior or on-the-fly), \emph{Democratic Training} does not rely on generating UAPs and are thus not limited to specific UAP attacks.

\begin{figure}[t]
    \centering
\begin{minipage}[t]{0.48\linewidth}
\begin{algorithm}[H]
\DontPrintSemicolon
    \For{n epochs}{
        \For{each batch b}{
            $I_b^{en}\leftarrow SampleGenerator(I_b,N,m, \epsilon)$;\\
            $\textbf{L}(i, i_{en}) = \alpha\textbf{L}_{cce}(i_{en}) + (1 - \alpha)\textbf{L}_{cce}(i)$;\\
            $\textbf{J}(\theta)=\frac{\partial\textbf{L}(.)}{\partial\theta}$;\\
            $\theta~\leftarrow~\theta - \gamma_\theta \cdot SGD(\textbf{J}(\theta))$;
        }
    }
    \Return{$\theta$};

\caption{$Remove(I, N, m, \epsilon)$}
\label{alg:remove}
\end{algorithm}
\end{minipage}
\hfill
\begin{minipage}[t]{0.49\linewidth}
\begin{algorithm}[H]
\DontPrintSemicolon
    \For{m iterations}{
        $\textbf{L}(i) = \textbf{H}(i)$;\\
        $i~\leftarrow~i + \frac{\epsilon}{4}\cdot sign(\nabla_i \textbf{L}(i))$;\\
        $i=Clamp(i, \epsilon)$;\\
    }
    \Return{$i$};
\caption{$SampleGenerator(I, N, m, \epsilon)$}
\label{alg:sg}
\end{algorithm}
\end{minipage}
\end{figure}
The overall time complexity of Algorithm~\ref{alg:remove} is $\textbf{O}(n \cdot m \cdot |I|)$, where $|I|$ is the size of the clean dataset used, $n$ is the number of epochs to finetune and $m$ represents number of iterations required to generate low entropy samples. Although \emph{Democratic Training} requires multiple iterations to transform clean samples into low entropy samples, converting clean samples into low entropy samples is much simpler than generating UAPs and the total amount of samples to transform ($n \cdot |I|$) does not depends on the number of classes in a given dataset since the \textit{Sample Generator} does not require any information on the target class. This is a clear advantage over multiple existing UAP defense methods relying on generating UAPs (e.g.,~\citep{uap_defense,spgd,uapdefensefeatregen} etc.), for which, perturbations are generated for each target class. For datasets that contains a large number of classes (e.g., ImageNet dataset contains 1000 classes, JFT-300M dataset~\citep{jft} contains 18k classes), a large number of perturbations shall be generated 
%either in prior or on-the-fly 
in order to achieve acceptable defense performance. Unlike these methods, \emph{Democratic Training} transforms some clean samples into low-entropy samples and and it does not require the size of clean set to be large ($\leq5\%$ of training set).

\section{Implementation and Evaluation} \label{sec:evaluation}
In the following, we conduct multiple experiments to evaluate the effectiveness of \emph{Democratic Training} by answering multiple research questions (RQs). All experiments are conducted on a machine with 96-Core 1.4GHz CPU and 60GB system memory with an NVIDIA 24GB RTX 4090 GPU. Our approach has been implemented as a self-contained toolkit in Python and is open-sourced (\url{https://gitlab.com/sunbing7/democratic_training}).
%Due to the randomness in the experiments, we run each experiment for three times and report the average results.

\subsection{Experiment Setup} \label{sec:setup}
We conduct our experiments with 7 neural network models trained over 5 benchmark datasets: 1) \emph{ImageNet~\citep{imagenet}}, 2) \emph{ASL Alphabet~\citep{asl}}, 3) \emph{Caltech101~\citep{caltech}}, 4) \emph{EuroSAT~\citep{eurosat}} and 5) \emph{CIFAR-10~\citep{cifar10}}. Details can be found in Appendix~\ref{app:dataset}.
\begin{comment}
1) \emph{ImageNet~\citep{imagenet}:} The ImageNet 2012 dataset, also known as the ILSVRC 2012 (ImageNet Large Scale Visual Recognition Challenge), is a large-scale dataset used for visual object recognition tasks. It contains over 1.2 million images for training, 50,000 for validation, and 100,000 for testing. There are 1,000 different classes, which include a wide variety of objects, animals, and scenes. Each class has hundreds to thousands of images. We focus on image classification task in this work, 2) emph{ASL Alphabet~\citep{asl}:} This dataset is a collection of images of alphabets from the American Sign Language. It consists of 87K $200 \times 200$ images of 29 classes, including 26 letters (A to Z) and 3 classes for ``SPACE'', ``DELETE'' and ``NOTHING''. The task is to identify the 29 alphabets, 3) \emph{Caltech101~\citep{caltech}:} This dataset contains of 9k pictures of objects belonging to 101 categories. There are 40 to 800 images per category. Images are of variable sizes with typical edge lengths of 200 to 300 pixels. The task is to recognize the 101 different objects and 4) \emph{EuroSAT~\citep{eurosat}:} This dataset is a benchmark dataset in the field of remote sensing and geospatial analysis for the classification of land use and land cover from satellite imagery. It contains 27k $64 \times 64$ labeled images of 10 different classes representing various land use and land cover types, including: forest, highway, river etc. The task is to classify the land usage types.
\end{comment}
For experiments with the ImageNet dataset, we adopt the pretrained models from PyTorch~\citep{pytorch}. For experiments with ASL, Caltech101, EuroSAT and CIFAR-10 datasets, we train CNN models following standard model training process. Details of the models are summarized in Table~\ref{tab:model}. %For each pretrained neural network, we randomly select eight attack target classes and generate one targeted UAP for each target class. We adopt the state-of-the-art UAP attack method DF-UAP proposed in~\citep{datafree} in our experiment. We set $\epsilon$ to $10/255$ and other parameters to the default values used in DF-UAP. 
When applying \emph{Democratic Training}, we focus on the last pooling or dense layer for the entropy calculation since the effect of UAP on layer-wise entropy is stronger in deep layers as shown in Section~\ref{sec:prelim}. A small set of clean data ($\leq5\%$ of the training set) is used during the model enhancement.

\begin{table}[t]
    \parbox{.43\linewidth}{
        %\begin{table}[t]
        \centering
        \caption{Neutral Networks Used.}
        \resizebox{0.4\textwidth}{!}
        {
        \begin{tabular}[t]{p{0.6cm}p{1.6cm}p{2.2cm}p{0.8cm}}
        \toprule
         Net & Dataset & Architecture &  Acc  \\
        \midrule
        $NN_1$&ImageNet&  ResNet50 & $0.73$\\
        $NN_2$&ImageNet&  VGG19 & $0.70$\\
        $NN_3$&ImageNet&  GoogleNet & $0.69$\\
        $NN_4$&ASL&  MobileNet & $0.99$\\
        $NN_5$&CalTech101&  ShuffleNetV2 & $0.85$\\
        $NN_6$&EuroSAT&  ResNet50 & $0.89$\\
        $NN_7$&CIFAR-10&  WideResNet & $0.93$\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:model}
        %\end{table}
    }
    \hfill
    \parbox{.57\linewidth}{
        %\begin{table*}[t]
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{UAP Defense Performance.}
        \resizebox{0.5\textwidth}{!}
        {
        \begin{tabular}[t]{p{8mm}p{8mm}p{8mm}|p{8mm}p{8mm}p{13mm}p{5mm}}%
        \toprule
        \multirow{2}{*}{Model}&\multicolumn{2}{c|}{Before}&\multicolumn{4}{c}{After}\\
        & AAcc. & SR & AAcc. &SR  &$\Delta$ CAcc.&Time\\
        \midrule
        $NN_1$&0.134&0.714&0.617&0.002&-0.02&8\\
        $NN_2$&0.067&0.701&0.431&0.077&-0.04&36\\
        $NN_3$&0.195&0.584&0.549&0.004&-0.03&7\\
        $NN_4$&0.035&0.997&0.894&0.004&-0.02&18\\
        $NN_5$&0.059&0.842&0.715&0.018&-0.01&30\\
        $NN_6$&0.236&0.784&0.786&0.048&-0.01&16\\
        $NN_7$&0.154&0.933&0.860&0.031&-0.03&21\\
        \textbf{Avg}&\textbf{0.126}&\textbf{0.794}&\textbf{0.693}&\textbf{0.028}&\textbf{-0.02}&\textbf{19}\\
        \bottomrule
        
        \end{tabular}
        }
        \label{tab:defense}
           \begin{tablenotes}
              \small
              \item We report attack success rate (SR), adversarial accuracy (AAcc.), change in accuracy on clean inputs ($\Delta CAcc.$) and execution time (Time) in minutes.
            \end{tablenotes}
        %\end{table*}
    }
\end{table}

\subsection{Research Questions and Answers}\label{subsec:rq}
%qIn the following, we report our experiment results. 

\emph{\textbf{RQ1}: Is \emph{Democratic Training} effective in defending against UAP attacks?} 
%datafree uap on all models
%entropy difference

\begin{comment}
    \begin{table*}[t]
\setlength\heavyrulewidth{0.25ex}
\centering
\caption{UAP Defense Performance of \emph{Democratic Training}. We report success rate (SR) and model accuracy (on clean inputs (Clean Acc.) and perturbed inputs (AAcc.)}
\resizebox{\textwidth}{!}
{
\begin{tabular}[t]{p{6mm}p{8mm}p{8mm}|p{8mm}p{8mm}|p{6mm}p{8mm}p{8mm}|p{8mm}p{8mm}|p{6mm}p{8mm}p{8mm}|p{8mm}p{8mm}}%{c|cc|cc|cc|cc|cc}
\toprule
$\multirow{2}{*}{Target}$&\multicolumn{2}{c|}{Before}&\multicolumn{2}{c|}{After}&\multirow{2}{*}{Target}&\multicolumn{2}{c|}{Before}&\multicolumn{2}{c|}{After}&\multirow{2}{*}{Target}&\multicolumn{2}{c|}{Before}&\multicolumn{2}{c}{After}\\
& AAcc. & SR & AAcc. &SR &  &AAcc.  &SR &AAcc.  &SR &  &AAcc.  &SR&AAcc.  &SR  \\
\midrule
755&0.124&0.774&0.615&0.003&150&0.056&0.757&0.414&0.072&573&0.241&0.540&0.557&0.001\\
743&0.175&0.673&0.601&0.002&214&0.068&0.841&0.399&0.118&807&0.182&0.670&0.548&0.012\\
804&0.138&0.726&0.622&0.003&39&0.038&0.922&0.366&0.189&541&0.187&0.642&0.548&0.003\\
700&0.085&0.840&0.627&0.003&527&0.099&0.447&0.490&0.012&240&0.192&0.517&0.552&0.001\\
922&0.163&0.699&0.614&0.004&65&0.063&0.557&0.442&0.075&475&0.232&0.584&0.561&0.001\\
174&0.122&0.728&0.629&0&639&0.076&0.716&0.437&0.068&753&0.141&0.700&0.528&0.011\\
547&0.132&0.743&0.616&0.001&771&0.057&0.660&0.450&0.033&762&0.211&0.544&0.546&0.001\\
369&0.130&0.526&0.611&0&412&0.081&0.711&0.449&0.045&505&0.172&0.473&0.548&0.001\\
\textbf{avg}&\textbf{0.134}&\textbf{0.714}&\textbf{0.617}&\textbf{0.002}&\textbf{avg} &\textbf{0.067}&\textbf{0.701}&\textbf{0.431}&\textbf{0.077}&\textbf{avg} &\textbf{0.195}&\textbf{0.584}&\textbf{0.549}&\textbf{0.004}\\
\midrule
\multicolumn{5}{c|}{$NN_1$ Clean Acc.: $0.73 \rightarrow 0.71$} &
\multicolumn{5}{c|}{$NN_2$ Clean Acc.: $0.70 \rightarrow 0.66$} &
\multicolumn{5}{c}{$NN_3$ Clean Acc.: $0.69 \rightarrow 0.66$}\\


\toprule

19&0.034&1&0.899&0.028&37&0.040&0.905&0.709&0.003&9&0.298&0.714&0.804&0.002\\
17&0.038&0.993&0.918&0.030&85&0.157&0.650&0.721&0.003&1&0.283&0.698&0.791&0.057\\
8&0.035&0.999&0.888&0.006&55&0.043&0.909&0.685&0.046&8&0.270&0.733&0.794&0.024\\
21&0.035&0.999&0.896&0.010&79&0.042&0.748&0.74&0.001&2&0.269&0.786&0.790&0.100\\
2&0.035&0.994&0.891&0.013&21&0.068&0.867&0.743&0.005&3&0.215&0.829&0.778&0.028\\
9&0.034&1&0.904&0.001&9&0.064&0.903&0.689&0.045&7&0.149&0.961&0.771&0.105\\
23&0.034&0.999&0.887&0.019&4&0.018&0.892&0.753&0.006&4&0.229&0.674&0.796&0.008\\
6&0.036&0.997&0.865&0.009&6&0.036&0.862&0.676&0.033&6&0.240&0.807&0.781&0.017\\

\textbf{avg}&\textbf{0.035}&\textbf{0.997}&\textbf{0.894}&\textbf{0.014}&\textbf{avg} &\textbf{0.059}&\textbf{0.842}&\textbf{0.715}&\textbf{0.018}& \textbf{avg}&\textbf{0.236}&\textbf{0.784}&\textbf{0.786}&\textbf{0.048}\\
\midrule
\multicolumn{5}{c|}{$NN_4$ Clean Acc.: $0.99 \rightarrow 0.97$} &
\multicolumn{5}{c|}{$NN_5$ Clean Acc.: $0.85 \rightarrow 0.84$} &
\multicolumn{5}{c}{$NN_6$ Clean Acc.: $0.89 \rightarrow 0.88$}\\
\bottomrule

\end{tabular}
}
\label{tab:defense}
%   \begin{tablenotes}
%      \small
%      \item 
%    \end{tablenotes}
\end{table*}

\end{comment}

For each neural network, we train eight UAPs for randomly selected targets. The details of the UAP attacks are summarized in Table~\ref{tab:defense}. We systematically apply \emph{Democratic Training} to all the above-mentioned models and return the repaired models $NN_1'$ to $NN_7'$. 
%We report the attack success rate (SR) and model accuracy on clean (Clean Acc.) and UAP perturbed inputs (AAcc. as adversarial accuracy).

Firstly, we measure the layer-wise entropy of clean and UAP perturbed inputs on the repaired models. Figure~\ref{fig:box} shows the box plot for the layer-wise entropy of clean samples and UAP infected samples before and after applying \emph{Democratic Training}. On average, across all original models and attack target classes, the layer-wise entropy difference between clean inputs and those perturbed by UAPs is $16.7\%$. After applying \emph{Democratic Training}, such difference is reduced to $0.2\%$. Thus, \emph{Democratic Training} is able to reduce the effect of UAPs in terms of layer-wise entropy effectively. 

\begin{figure}[t]
\centering
\resizebox{\textwidth}{!}
{
\begin{tabular}{ccccccc}

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    ytick={1,2,3},
    yticklabels={Clean, Before, After},
    yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_1$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=3.290902853012085,
        lower quartile=7.128120183944702,
        median=7.330113887786865,
        upper quartile=7.431122899055481,
        upper whisker=7.536375999450684,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=1.1175384521484375,
        lower quartile=3.813459873199463,
        median=5.823946952819824,
        upper quartile=7.10382604598999,
        upper whisker=7.4635329246521,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=4.00,
        lower quartile=6.38,
        median=7.09,
        upper quartile=7.29,
        upper whisker=7.49,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_2$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=0.50,
        lower quartile=6.47,
        median=7.43,
        upper quartile=7.79,
        upper whisker=8.19,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=0.00,
        lower quartile=0.41,
        median=1.21,
        upper quartile=2.99,
        upper whisker=7.53,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=7.34,
        lower quartile=8.16,
        median=8.20,
        upper quartile=8.23,
        upper whisker=8.26,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_3$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=6.75,
        lower quartile=6.81,
        median=6.84,
        upper quartile=6.85,
        upper whisker=6.87,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=6.45,
        lower quartile=6.79,
        median=6.84,
        upper quartile=6.86,
        upper whisker=6.87,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=6.72,
        lower quartile=6.80,
        median=6.82,
        upper quartile=6.86,
        upper whisker=6.88,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_4$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=8.32,
        lower quartile=8.32,
        median=8.32,
        upper quartile=8.32,
        upper whisker=8.32,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=8.30,
        lower quartile=8.31,
        median=8.31,
        upper quartile=8.32,
        upper whisker=8.32,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=8.32,
        lower quartile=8.32,
        median=8.32,
        upper quartile=8.32,
        upper whisker=8.32,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}
&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_5$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=6.79,
        lower quartile=6.87,
        median=6.88,
        upper quartile=6.90,
        upper whisker=6.91,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=3.38,
        lower quartile=4.86,
        median=6.08,
        upper quartile=6.31,
        upper whisker=6.78,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=6.86,
        lower quartile=6.89,
        median=6.91,
        upper quartile=6.91,
        upper whisker=6.92,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}
&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_6$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=0.00,
        lower quartile=6.10,
        median=6.92,
        upper quartile=7.31,
        upper whisker=7.60,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=0.00,
        lower quartile=6.04,
        median=6.76,
        upper quartile=7.10,
        upper whisker=7.53,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=3.91,
        lower quartile=7.56,
        median=7.59,
        upper quartile=7.60,
        upper whisker=7.60,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}
&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_7$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.29,
lower quartile=6.34,
median=6.38,
upper quartile=6.41,
upper whisker=6.44,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=6.08,
lower quartile=6.23,
median=6.32,
upper quartile=6.35,
upper whisker=6.41,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.32,
lower quartile=6.37,
median=6.39,
upper quartile=6.41,
upper whisker=6.44,    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

\\
%\centering
%\begin{minipage}{0.47\textwidth} % choose width suitably
%\includegraphics[width=\linewidth]{mygraphicfile}
%{Fx denoting feature x. Nx\_y represents neuron y at hidden layer x.\par} %In this experiment $\epsilon = 0.01, \delta = 0.001$.
%\end{minipage}
\end{tabular}
}
\caption{Change in layer-wise entropy.} 
\label{fig:box}
\end{figure}

Next, we show the change in UAP attack success rate (SR) and model accuracy (on clean inputs (Clean Acc.) and perturbed inputs (AAcc.)). 
As shown in Table~\ref{tab:defense}, on average, across all original models and attack target classes, the attack success rate is reduced from $79.4\%$ to $2.8\%$ after applying \emph{Democratic Training}. In addition, the adversarial accuracy is improved from $12.6\%$ to $69.3\%$. Hence, by reducing the effect of UAPs on layer-wise entropy, the effectiveness of UAPs is reduced significantly. In terms of clean sample accuracy, it is minimally affected. On average, the model accuracy is reduced by about $2\%$. Thus, \emph{Democratic Training} is able to focus on removing the effect of UAPs while the model functionality is maintained.

Hence, to answer RQ1, \emph{Democratic Training} is able to reduce the attack success rate of UAP attacks and improve the robustness against adversarial samples effectively, and at the same time, the model accuracy is maintained at a high level.

\emph{\textbf{RQ2}: Is \emph{Democratic Training} effective in mitigating UAPs crafted from different attack methods?}

There are many UAP generation algorithms proposed in existing works and we further evaluate \emph{Democratic Training} against another four types of UAP attacks: 1) sPGD~\citep{spgd} which adopts PGD to update the perturbations iteratively to generate UAPs, 2) LaVAN~\citep{lavan} which is proposed as a method to generate image-agnostic localized adversarial noise that covers only $2\%$ of the image but fool the neural network, 3) GAP~\citep{gap} as a generator-based UAP attack method which adopts generative model for crafting UAPs and 4) SGA~\citep{sga} which alleviates the gradient vanishing and escapes from poor local optima when generating UAP. For each method, we randomly select eight attack target classes and train UAPs for $NN_1$ to $NN_6$ and evaluate their attack success rate and model accuracy before and after applying \emph{Democratic Training}. 
%sPGD~\citep{spgd} adopts projected gradient descent (PGD) to update the perturbations iteratively. It first initializes the perturbation uniformly at random in the perturbation space and then performs multiple iterations to update the perturbation as $\delta^{k+1} = proj[\delta^{k} - step \cdot sign(\nabla_xL_{adv}(x + \delta^{k}, y_t))]$, where $x$ represents a clean sample, $proj$ represents a projection on the perturbation space, $y_t$ is the attack target class and $step$ is the predefined step size. In this experiment, we randomly select eight attack target classes and train UAPs for each model. We set $\epsilon$ to $10/255$, number of epoch to 2 and step decay to 0.6. LaVAN proposed in~\citep{lavan} is a method to generate image-agnostic localized adversarial noise that covers only $2\%$ of the image but fool the neural network. We conduct targeted LaVAN attack on each model for eight randomly selected target classes with number of iterations set to 500 and step size set to the default value (5). GAP~\citep{gap} is a generator-based UAP attack method. It is the first work to adopt generative model for crafting UAPs with the objective loss function minimizing the cross-entropy with the targeted class. Similarly, we train eight UAPs with GAP on each model with $\epsilon = 10/255$. For the UAPs generated using above methods, we evaluate their attack success rate and model accuracy on all the models used in our experiment. 
The average results across all models and target classes are summarized in Table~\ref{tab:other_uap}. For all models, on average, sPGD attack achieves $49.7\%$ targeted success rate and the adversarial accuracy is below $27.3\%$. LaVAN attack achieves $60.1\%$ success rate with adversarial accuracy of $23.2\%$. GAP attack achieves $63.2\%$ success rate and the adversarial accuracy is below $17.2\%$. SGA attack achieves $79.0\%$ success rate and the adversarial accuracy is below $11.9\%$. When tested on \emph{Democratic Training} enhanced models, the adversarial accuracy is improved to $73.4\%$, $68.5\%$, $71.3\%$ and $66.2\%$ for sPGD, LaVAN, GAP and SGA attacks respectively,  and the attack success rate is below $0.9\%$, $1.4\%$, $2.5\%$ and $2.9\%$. Thus, models enhanced by \emph{Democratic Training} are robust against UAPs generated in different ways. We further analyze the change in layer-wise entropy before and after applying \emph{Democratic Training}. The results are summarized in Appendix~\ref{app:entro_otheruap}. These results suggest that, regardless of the generation method, the effect of targeted UAP on a model can be revealed by layer-wise entropy and such effect can be suppressed via our entropy based model enhancement effectively. 
%For the original $NN_1$, on average, the UAP attacks achieve $59.4\%$, $79\%$ and $51.2\%$ success rate for sPGD, LaVAN and GAP respectively. When tested on \emph{Democratic Training} repaired model, the success rate is reduced to less than $1\%$ for all three attack methods. Furthermore, the adversarial accuracy is improved to $62.9\%$, $67.7\%$ and $57.5\%$ respectively. The model accuracy on clean samples are affected slightly. 

\begin{table*}[t]
\setlength\heavyrulewidth{0.25ex}
\centering
\caption{Performance of \emph{Democratic Training} on UAPs generated using sPGD, LaVAN, GAP and SGA.}
\resizebox{\textwidth}{!}
{
\begin{tabular}[t]{p{9mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}}%{c|cc|cc|cc|cc|cc}
\toprule

$\multirow{3}{*}{Model}$&\multicolumn{4}{c|}{sPGD} &
\multicolumn{4}{c|}{LaVAN} &
\multicolumn{4}{c|}{GAP}&
\multicolumn{4}{c}{SGA}\\
%\midrule
 &\multicolumn{2}{c}{Before}&\multicolumn{2}{c|}{After}&\multicolumn{2}{c}{Before}&\multicolumn{2}{c|}{After}&\multicolumn{2}{c}{Before}&\multicolumn{2}{c|}{After}&\multicolumn{2}{c}{Before}&\multicolumn{2}{c}{After}\\
& AAcc. & SR & AAcc. &SR & AAcc.  &SR &AAcc.  &SR & AAcc.  &SR&AAcc.  &SR  & AAcc.  &SR&AAcc.  &SR\\
\midrule
$NN_1$&0.231&0.594&0.629&0.007&0.152&0.790&0.677&0.005&0.229&0.512&0.575&0.002&0.133&0.722&0.592&0.004\\
$NN_2$&0.248&0.484&0.552&0.016&0.058&0.506&0.343&0.041&0.144&0.393&0.482&0.001&0.067&0.806&0.415&0.096\\
$NN_3$&0.388&0.281&0.592&0.000&0.086&0.848&0.621&0.002&0.226&0.460&0.614&0.000&0.147&0.640&0.510&0.010\\
$NN_4$&0.045&0.980&0.981&0.000&0.537&0.271&0.678&0.033&0.031&0.921&0.984&0.034&0.034&0.999&0.904&0.009\\
$NN_5$&0.326&0.270&0.790&0.008&0.337&0.449&0.867&0.001&0.128&0.751&0.725&0.006&0.106&0.797&0.743&0.020\\
$NN_6$&0.401&0.375&0.861&0.022&0.224&0.743&0.925&0.004&0.274&0.757&0.900&0.106&0.227&0.776&0.811&0.033\\
\textbf{Avg}&\textbf{0.273}&\textbf{0.497}&\textbf{0.734}&\textbf{0.009}&\textbf{0.232}&\textbf{0.601}&\textbf{0.685}&\textbf{0.014}&\textbf{0.172}&\textbf{0.632}&\textbf{0.713}&\textbf{0.025}&\textbf{0.119}&\textbf{0.790}&\textbf{0.662}&\textbf{0.029}\\
\bottomrule

\end{tabular}
}
\label{tab:other_uap}
%   \begin{tablenotes}
%      \small
%      \item 
%    \end{tablenotes}
\end{table*}

Thus, to answer RQ2, \emph{Democratic Training} is effective at defending UAPs generated with various algorithms.


\emph{\textbf{RQ3}: How does \emph{Democratic Training} compare with adversarial training?}

Adversarial training can be a useful method to improve model robustness against UAPs~\citep{spgd,uat,classuat}. We evaluate the effectiveness of low-entropy samples and adversarial samples in finetuning a given model three settings: 1) non-targeted adversarial training, i.e., adversarial examples are not targeted and are generated on-the-fly
%during the finetuning process
, 2) targeted adversarial training, i.e., adversarial examples are targeted and are generated on-the-fly and 3) finetuning with pretrained targeted UAP. While there are various options of adversarial training algorithm for the first two settings, we adopt PGD based adversarial training~\citep{pgd} as it provides a good trade-off between being computationally efficient and powerful~\citep{spgd}. We finetune the model with adversarial samples generated with the same number of iterations as in \emph{Democratic Training} for a fair comparison. Furthermore, we assume the attack target class is known for targeted-adversarial finetuning (which gives the defender some unrealistic advantage). For finetuning with pretrained UAPs, similarly we assume the target class is known and train a set of 10 UAPs to be used together with a set of clean samples. During the finetuning, we add a randomly chosen pretrained UAP to a clean sample with $50\%$ probability. We keep the number of clean examples used in finetuning the same as \emph{Democratic Training} as well. The average performance over all 6 models is shown in Table~\ref{tab:advtrain}. 
All three methods are not that effective in UAP defense, i.e., the attack success rate remains high ($>16\%$) and adversarial accuracy is lower than $50\%$ after the finetuning. In comparison, \emph{Democratic Training} is able to reduce the attack success rate to $<3\%$ and improve the adversarial accuracy to $69\%$ on average. 
We believe this is due to the fact that adversarial training aims to direct adversarial examples towards their correct predictions while \emph{Democratic Training} focuses on guiding low-entropy samples. Based on our experimental results, low-entropy samples are more efficient in guiding the model enhancement process. 

Moreover, we evaluate the performance of a well-recognized adversarial training method TRADES~\citep{trades} on UAP defense. As shown in the last row of Table~\ref{tab:advtrain}. TRADES is effective in defending against UAPs but sacrifices model accuracy for over $10\%$.
\begin{table}[t]
    \parbox{.50\linewidth}{
        %\begin{table}[t]
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Performance of adversarial training.}
        \resizebox{0.4\textwidth}{!}
        {
        \begin{tabular}[t]{p{20mm}|p{8mm}p{7mm}p{10mm}}%{c|cc|cc|cc|cc|cc}
        \toprule
        Setting & AAcc. & SR &$\Delta$CAcc.\\
        \midrule
        Targeted&0.464&0.167&-0.104\\
        Non-targeted&0.295&0.455&-0.168\\
        Known UAP&0.476&0.223&0.0\\
        TRADES&0.816&0.022&-0.110\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:advtrain}
        %   \begin{tablenotes}
        %      \small
        %      \item 
        %    \end{tablenotes}
        %\end{table}
    }
    \hfill
    \parbox{.5\linewidth}{
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Performance of existing methods.}
        \resizebox{0.35\textwidth}{!}
        {
        \begin{tabular}[t]{p{15mm}|p{8mm}p{7mm}p{10mm}}
        \toprule
        Method & AAcc. &SR  &$\Delta$CAcc.\\
        \midrule
        %\emph{Democratic Training}&0.573&0.010\\
        SFR&0.468&0.011&-0.022\\
        CFN&0.150&0.559&-0.073\\
        FNS&0.149&0.623&-0.013\\
        DensePure& 0.802& 0.010& -0.121\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:existing}
    }
\end{table}

Hence, to answer this RQ3, \emph{Democratic Training} is more effective in defending against UAPs when compared to adversarial training with equivalent parameter settings.


\emph{\textbf{RQ4}: How does \emph{Democratic Training} compare with other existing neural network UAP defense methods?}

We further compare the performance of \emph{Democratic Training} with four state-of-the-art UAP defense methods, i.e., selective feature regeneration (SFR)~\citep{uapdefensefeatregen}, clipping feature norms (CFN)~\citep{cfn}, feature norm suppressing (FNS)~\citep{fns} and DensPure~\citep{densepure}. SFR is an approach proposed to defend against UAPs from feature-level. It deploys feature regeneration units in a given model aiming to transform vulnerable features into resilient features against UAPs. 
%To repair a given model, SFR first generates 25 original UAPs following~\citep{uap} and then generates 2000 synthetic UAPs from the original UAPs. The generated UAPs are used to train the feature regeneration units to be added into the original model. 
CFN is proposed based on the fact that universal adversarial patches usually lead to deep feature vectors with very large norms~\citep{cfn}. It introduces a feature norm clipping layer to be inserted into the original model that aims to adaptively suppress the generation of large norm deep feature vectors. 
%Such layer applies one-sided clipping on large norms thus the influence of adversarial patch is weakened. The feature norm clipping layer does not require training. 
Similarly, FNS is designed on top of CFN which is able to renormalize the feature norm by non-increasing functions. FNS can be adaptively inserted in to a given model to achieve multistage suppression of the generation of large norm feature vectors. No training is required for such feature norm suppressing layer. DensPure employs iterative denoising to an input image to get multiple reversed samples with different random seeds. Next, the samples are given to the model to make final decision via majority voting.
The results of the average performance for SFR, CFN, FNS and DensPure are summarized in Table~\ref{tab:existing}. Both CFN and FNS are not effective in defending against UAPs, i.e., the attack success rates remain above $50\%$. Thus, suppressing or clipping feature norms of a given model has limited effect on weakening the impact of targeted UAPs. Furthermore, both CFN and FNS modify the original neural network architecture by inserting an additional feature norm clipping / suppression layer. Although SFR achieves comparable UAP defense performance as \emph{Democratic Training}, it modifies the architecture of the original model which is often not preferred in real-life application (as this might prolong development cycles and bring in integration challenges~\citep{automatedml}). Furthermore, SFR requires to pretrain 25 UAPs (and 2000 synthetic UAPs) to train the additional layers, which is rather time consuming (it takes $>40$ min to train one UAP based on method proposed in~\citep{uap} following open-source implementation\footnote{https://github.com/qilong-zhang/Pytorch\_Universal-adversarial-perturbation} while \emph{Democratic Training} 
repairs the same model within 10 min). DensePure is effective in improving the model robustness against UAPs but model accuracy is affected which drops by $12.1\%$. 
Moreover, it introduces overhead in inference time for reversed samples.

Hence, to answer RQ4, \emph{Democratic Training} is more effective in mitigating the impact of UAPs on trained neural networks, which does not require to change the original model architecture.\\

\section{Related Works} \label{sec:related}
%This work is broadly related to works on neural network adversarial attacks, universal adversarial attacks and defenses against universal adversarial attacks.

\textbf{Adversarial attacks.} 
Neural networks are highly vulnerable to adversarial attacks, which are small, deliberately crafted perturbations to input data that can fool the model into making incorrect predictions. Such perturbation can be 1) image-specific where the attacker computes a perturbation for every clean input and 2) image-agnostic where a single perturbation will cause majority of clean samples to fool a given model. In recent years, many input-specific adversarial attacks are proposed to generate disruptive perturbations.~\citet{fgsm} introduce Fast Gradient Sign Method (FGSM) that generates adversarial examples. 
%by perturbing the input data in the direction of the gradient of the loss function w.r.t. input. 
Subsequently, Basic Iterative Method (BIM) is proposed~\citep{BIM} as an extension of FGSM which applies small FGSM steps iteratively aiming to generate higher quality perturbations.~\citet{pgd} propose PGD which optimizes the perturbation at each iteration based on gradient of loss function. 
%and projects the perturbation back on to the feasible set defined by a norm constraint.
Furthermore,~\citet{CW} propose C\&W attack which formulates the adversarial example generation as an optimization problem aiming at minimal perturbation. Together with many others, e.g.,~\citep{adv_speech,audio_cnn,deep_face,blackbox_face,fool_topic,fusion}, adversarial attacks pose a significant threat to real-world applications in different domains.

\textbf{Universal adversarial attacks.} Unlike per-instance perturbations, UAPs work for the majority of clean samples, i.e., adding a single perturbation to majority of clean samples, the neural network will response with incorrect predictions. Such attacks can be broadly classified in to noise-based and generator-based attacks. Noise-based attack methods directly train a UAP that can be applied to all inputs while generator-based methods train an extra generative model as a bridge to craft he perturbation indirectly~\citep{uap_survey}.~\citet{uap} first explore the existence of such input-agnostic adversarial perturbations. 
%Given a model and a set of clean samples, to compute such UAPs, the algorithm proposed in~\citep{uap} iteratively computes the perturbation of each sample to make an adversarial example across the decision boundary of the correct label. 
Furthermore,~\citet{singular} propose to craft UAPs by maximizing the difference between the activations of a hidden layer for clean and perturbed inputs. Later on, many noise-based methods are proposed with good performance~\citep{FFF,datafree}. 
%Furthermore, study in~\citep{FFF} reveals that misfiring the activation of each feature layer can cause the model to produce wrong predictions. Thus, Fast Feature Fool is proposed to generate UAP by maximizing the feature activation when feeding it to the target model. Zhang~\emph{et al.} further propose data free UAP (DF-UAP)~\citep{datafree} which crafts UAPs from a proxy dataset and achieves comparable performance to the methods based on original training set. 
On the other hand,~\citet{gap} firstly apply generative model for crafting UAPs. %Different loss functions are designed for targeted and non-targeted UAP attacks. 
NAG is proposed~\citep{nag} with a novel loss function for training the perturbation generator. 
%NAG further uses a diversity objective function to increase the fooling ratio and the cross-model transferability of the generated UAP.
%GM-TUAP is another generator-based method that incorporates the Fast Feature Fool method as an extra supervision for training the perturbation generator based on their finding that the feature representations in the first layer of various model architectures share similar feature maps (thus increasing adversarial energy in the first layer will improve transferability). 
Beyond above mentioned methods, there are many other UAP attacks, e.g.,~\citep{double,singular,cduap,face,speech}. Compared to input-specific perturbations, UAPs are more efficient in terms of computation cost and become a more significant threat in practice.

\textbf{Defense against adversarial attacks.} 
%The existence of adversarial perturbations poses a significant threat to the real-world applications of neural networks. 
%Understanding and defending against these adversarial attacks has become a critical topic. 
%To mitigate the effect of adversarial perturbations, a number of works have attempted to defend through various techniques. 
Defense against adversarial attacks can be grouped into six domains~\citep{sur_sees}: 1) adversarial training which augments the training data with adversarial examples to make the model more robust~\citep{fgsm,pgd,fast,trades,spgd,fat}, 2) modifying the training process which adjusts the training process to improve robustness~\citep{distill,uat,sat,ltd,score,uap_defense}, 3) use of supplementary networks which add extra networks on top of the original model to remove the effect of adversarial perturbations~\citep{defense_gan,hgd,er_classifier,dg,disco,uapdefensefeatregen}, 4) changing network architecture which modifies the architecture of the original model for robustness~\citep{fdenoise,nas_robust,adv_random,cnls,cfn,fns}, 5) performing network validation which validates and certifies the robustness of a given model~\citep{deep_explore,deep_gauge,sadl} and 6) adversarial purification which removes adversarial perturbations of input samples and recovers the clean image~\citep{irugd,ddpm,adv_proxy,diffpure,densepure}. Among them, there are multiple works proposed to defense against UAPs~\citep{uap,uap_defense,spgd,uapdefensefeatregen,cfn,fns}.
%Adversarial training is widely applied to defend against input-specific attacks.~\citet{fgsm} first introduce adversarial training by augmenting the training data with adversarial examples to make the model more robust. Similarly,~\citet{pgd} proposes robust optimization techniques to enhance the resistance of deep learning models against adversarial attacks. 
%Wong~\emph{et al.}~\citep{fast} proposes an efficient method for adversarial training that significantly reduces the computational cost compared to traditional methods. The authors introduce Fast Adversarial Training, which speeds up the process of generating adversarial examples during training. 
%There are multiple works proposed in recent years to protect neural networks against UAPs as well.~\citet{uap} first finetune a given model with pre-crafted UAPs which leads to marginal robustness improvements.~\citet{spgd} propose to generate perturbations on-the-fly instead of pre-computing which results is better defense performance.~\citet{uapdefensefeatregen} propose a feature-level defense method. 
%A resilient feature regeneration unit is first trained with clean and pre-crafted UAPs and then is inserted into the original model aiming to transform vulnerable features into a resilient ones. Furthermore, Cheng Yu~\emph{et al.} propose clipping feature norms (CFN)~\citep{cfn} and feature norm suppression (FNS)~\citep{fns} to suppress the generation of large norm deep feature vectors in order to weaken the impact of universal adversarial patches on the original model. CFN clamps large feature norms at a selected hidden layer and FNS further renormalize the feature norm on top of CFN. Both methods introduce a norm suppressing layer to be inserted to the original neural network. 
%Furthermore, there are other defense methods such as certified training~\citep{certified_training,certified2}, randomized smoothing~\citep{rs0,rs1,rs2} and some others~\citep{fns,cfn}.


\section{Conclusion}
\label{sec:conclusion}
In conclusion, we propose \emph{Democratic Training} as an efficient and effective defense method against targeted UAP attacks for neural networks. \emph{Democratic Training} first analyzes the layer-wise entropy to understand how UAP deceive the model and conducts entropy-based model enhancement to mitigate the effect of UAP. Our experimental results show that \emph{Democratic Training} is effective in removing the effects of UAPs from a given model and it outperforms existing state-of-the-art UAP attack defense methods.\\

\section{Acknowledgements}
\label{sec:Acknowledgements}
This research is supported by Singapore Ministry of Education under its Academic Research Fund Tier 3 (Award ID: MOET$32020-0004$).
%-------------------------------------------------------------------------------

\bibliography{iclr2025_conference}
\bibliographystyle{iclr2025_conference}

\section{Appendix}
\subsection{Future Works}
In our future works, we would like to extend \emph{Democratic Training} to other model architectures (e.g., transformer based models) and non-vision tasks (e.g., language models, audio tasks). Moreover, we would like to integrate \emph{Democratic Training} with adversarial training, i.e., apply low-entropy samples in adversarial training. We would like to explore if the performance can be further improved and whether the method can be extended to other types of adversarial attacks.

\subsection{Measuring entropy in neural networks}
\label{app:entropy}
\citet{entropy_exp} proposed to apply an entropy-based layer to conduct logic explanations of neural networks. For a concept-based classifier where human-understandable input concepts are mapped to output predictions, the relevance of an input concept $j$ to a prediction class $i$ can be approximated by the weight connecting $j^{th}$ input to $i_{th}$ class embedding, i.e.,
\begin{align}
\begin{aligned}
    \gamma_j^i = ||W_j^i||_1\\
    \beta_j^i = \frac{e^{\frac{\gamma_j^i}{\tau}}}{\sum_l e^{\frac{\gamma_l^i}{\tau}}}
\label{eqn:en_exp}
\end{aligned}
\end{align}
where $W$ represents the weight matrix and $\tau$ is a user-defined temperature parameter to tune the softmax function. The entropy of distribution $\beta^i$ 
\begin{equation}
    H(\beta^i) = -\sum_j \beta_j^i\log\beta_j^i 
    \label{eqn:en_exp2}
\end{equation}
is minimized when a single input concept dominates the prediction and it is maximized when all concepts are equally important. 

\citet{entropy_pooling} proposed entropy-based pooling for CNNs that helps the network to concentrate on semantically important image regions. In CNN architecture, a global averaging pooling (GAP) layer is typically  connected to a fully connected (FC) layer with softmax activation to produce the class scores. The input to GAP layer is the last convolutional feature maps $U \in \mathbb{R}^{h \times w \times c}$ consisting of local feature vectors $v_i \in \mathbb{R^c} | i=1,2,\cdots, hw$, and the final prediction scores are computed as
\begin{align}
\begin{aligned}
    f_{GAP}(U) = \frac{1}{hw}\sum_i v_i\\
    F = W^T f_{GAP}(U)\\
    =\frac{1}{hw}\sum_i W^T v_i
    \label{eqn:en_pool}
\end{aligned}
\end{align}
The entropy of the localized class probability for location $i$ is then measured by
\begin{align}
\begin{aligned}
    p_i = softmax(W^T v_i)\\
    H(p_i) = -\sum_k p_i(k) \log p_i(k)
    \label{eqn:en_pool2}
\end{aligned}
\end{align}
where $W^T v_i \in \mathbb{R}^K$. For a feature location $i$, if its receptive field is centered on a specific object, the localized class prediction of $v_i$ should probably be highly confident leading to a low entropy value measured using Equation~\ref{eqn:en_pool2}. Otherwise, if its receptive field is centered on image textures or patterns that frequently occurred in other image classes, the corresponding entropy should generally be high~\citep{entropy_pooling}.


%\subsection{Discussion} 
%\label{app:discussion}
%\noindent \textbf{Layer selection.} Based on our empirical study in Section~\ref{subsec:analysis}, the existence of UAP will cause the layer-wise entropy to drop at deep layers compared to that of clean samples. Furthermore, such impact is more severe at deeper layers. Also based on the findings from existing works~\citep{soda}, layers closer to the input tend to capture low-level features which exert less influence on the output, while, deeper layers tend to capture high-level features that impact the prediction more directly. Hence, we apply \emph{Democratic Training} on the last pooling layer or dense layer for the entropy calculation. 


%\noindent \textbf{Limitations of \emph{Democratic Training}.} Firstly, \emph{Democratic Training} is evaluated on image classification tasks only and we believe that it can be easily extended to other tasks, e.g., image segmentation, NLP and audio tasks. \emph{Democratic Training} relies on the layer-wise entropy impact caused by the presence of UAPs and we can conduct similar entropy analysis on models trained for above mentioned tasks and mitigate such effect via entropy-based repair accordingly. Secondly, \emph{Democratic Training} utilizes a set of clean samples to finetune the original model. We believe such assumption is reasonable since a clean validation set is often provided together with the model for testing purpose.\\

\subsection{Datasets Used In Our Experiments}
\label{app:dataset}
\begin{itemize}
    \item \emph{ImageNet~\citep{imagenet}:} The ImageNet 2012 dataset, also known as the ILSVRC 2012 (ImageNet Large Scale Visual Recognition Challenge), is a large-scale dataset used for visual object recognition tasks. It contains over 1.2 million images for training, 50,000 for validation, and 100,000 for testing. There are 1,000 different classes, which include a wide variety of objects, animals, and scenes. Each class has hundreds to thousands of images. We focus on image classification task in this work.
    %\footnote{https://image-net.org/challenges/LSVRC/2012/}
    \item \emph{ASL Alphabet~\citep{asl}:} This dataset is a collection of images of alphabets from the American Sign Language. It consists of 87K $200 \times 200$ images of 29 classes, including 26 letters (A to Z) and 3 classes for ``SPACE'', ``DELETE'' and ``NOTHING''. The task is to identify the 29 alphabets.
    %\footnote{https://www.kaggle.com/datasets/grassknoted/asl-alphabet}
    \item \emph{Caltech101~\citep{caltech}:} This dataset contains of 9k pictures of objects belonging to 101 categories. There are 40 to 800 images per category. Images are of variable sizes with typical edge lengths of 200 to 300 pixels. The task is to recognize the 101 different objects.
    %\footnote{https://data.caltech.edu/records/mzrjq-6wc02}~\citep{caltech}
    \item \emph{EuroSAT~\citep{eurosat}:} This dataset is a benchmark dataset in the field of remote sensing and geospatial analysis for the classification of land use and land cover from satellite imagery. It contains 27k $64 \times 64$ labeled images of 10 different classes representing various land use and land cover types, including: forest, highway, river etc. The task is to classify the land usage types.
    \item \emph{CIFAR-10~\citep{cifar10}:} This dataset is a widely used benchmark dataset for image classification in machine learning. It contains 60k color images, each with a resolution of 32x32 pixels. The task is for image recognition of 10 catagories.

    %\footnote{https://www.kaggle.com/datasets/apollo2506/eurosat-dataset}
\end{itemize}

\subsection{Performance on UAPs generated with different $\epsilon$.}
To further evaluate \emph{Democratic Training}, we generate UAPs with different $\epsilon$ settings. We train UAPs with $\epsilon=5/255$ and eight with $\epsilon=15/255$ for $NN_1$ with the same set of target classes selected in RQ1 and evaluates the attack success rate and model accuracy on the \emph{Democratic Training} repaired model (repaired with $\epsilon=10/255$). The average results are summarized in Table~\ref{tab:eps}. For a smaller perturbation budget ($\epsilon=5/255$) the repaired model stays robust against the generated UAPs. The attack success rate is below $1\%$ for all targeted classes. 
%and the adversarial accuracy is kept at $70\%$. 
For a larger perturbation budget ($\epsilon$ is larger than the value used during the finetuning process) where $\epsilon=15/255$, the repaired model still remains robust to a certain level. The average attack success rate drops from $91.3\%$ to $11.5\%$.
%and the adversarial accuracy increases from $2.7\%$ to $36.4\%$. 
For the adversarial examples to be human-imperceptible, the $\epsilon$ shall not be large. Hence, by setting it to a reasonable value, e.g., $\epsilon=10$, the \emph{Democratic Training} repaired model will be robust against UAPs generated with various perturbation budgets.

\begin{table}[t]
    \parbox{.50\linewidth}{
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Performance of \emph{Democratic Training} on UAPs generated with different $\epsilon$.}
        \resizebox{0.4\textwidth}{!}
        {
        \begin{tabular}[t]{p{10mm}|p{8mm}p{8mm}|p{8mm}p{8mm}}%{c|cc|cc|cc|cc|cc}
        \toprule
        $\multirow{2}{*}{$\epsilon$}$&\multicolumn{2}{c|}{Before}&\multicolumn{2}{c}{After}\\
        & AAcc. & SR & AAcc. &SR  \\
        \midrule
        5/255&0.468&0.274&0.699&0.000\\
        10/255&0.134&0.714&0.617&0.002\\
        15/255&0.027&0.913&0.364&0.115\\
        \bottomrule
        
        \end{tabular}
        }
        \label{tab:eps}
        %   \begin{tablenotes}
        %      \small
        %      \item 
        %    \end{tablenotes}
    }
    \hfill
    \parbox{.5\linewidth}{
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Adaptive attack performance.}
        \resizebox{0.25\textwidth}{!}
        {
        \begin{tabular}[t]{p{10mm}|p{10mm}p{10mm}}%{c|cc|cc|cc|cc|cc}
        \toprule
        Model & AAcc. &SR \\
        \midrule
        $NN_1'$&0.480&0.115\\
        $NN_2'$&0.344&0.288\\
        $NN_3'$&0.491&0.058\\
        $NN_4'$&0.655&0.174\\
        $NN_5'$&0.385&0.409\\
        $NN_6'$&0.559&0.369\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:adaptive}
        %   \begin{tablenotes}
        %      \small
        %      \item 
        %    \end{tablenotes}
    }
\end{table}

Thus, \emph{Democratic Training} repaired model stays robust against UAP attacked samples generated with different perturbation budgets ($\epsilon$).\\


\subsection{Adaptive Attacks}
\label{app:adaptive}
In this section, we evaluate \emph{Democratic Training} on two types of adaptive UAP attacks: 1) secondary white-box attacks, where the attacker has full access to the \emph{Democratic Training} repaired model, and 2) advanced attacks where the attacker is capable of tailoring the UAP trying to bypass our defense. 

Firstly, for secondary attacks, for pretrained model $NN_1$ to $NN_6$ described in Table~\ref{tab:model}, we apply \emph{Democratic Training} to repair it as in RQ1 to mitigate the effect of UAPs and obtain the repaired models. Next, we apply the method DF-UAP proposed in~\citep{datafree} on all the repaired models ($NN_1'$, $NN_2'$, $NN_3'$, $NN_4'$, $NN_5'$ and $NN_6'$.) to generate new sets of UAPs accordingly. We keep all the attack parameters the same as the initial attack including the attack target classes. The secondary attack performance is show in Table~\ref{tab:adaptive}. As described in Section~\ref{sec:evaluation}, before applying \emph{Democratic Training}, the UAP attack~\citep{datafree} can easily achieve an average of $81.3\%$ targeted attack success rates and $14.7\%$ adversarial accuracy. After applying \emph{Democratic Training}, a subsequent attack can achieve an average attack success rate of $23.6\%$ (with highest attack success rate of $40.9\%$ on $NN_5'$ and lowest of $5.8\%$ on $NN_3'$). The average adversarial accuracy on the subsequent attack is $48.6\%$. Furthermore, we apply sPGD and GAP attacks on $NN_1'$ as well. Adaptive sPGD is able to achieve $16.5\%$ attack success rate and $48.7\%$ adversarial accuracy. Adaptive GAP only manages to achieve an average success rate of $1.1\%$ and the adversarial accuracy stays above $50\%$. Hence, similar to DF-UAP, subsequent UAP attacks such as sPGD and GAP are no longer effective on \emph{Democratic Training} repaired models. Based on such result, we believe that, as UAPs exploit large correlations and redundancies in the decision boundary of a given model~\citep{uap}, \emph{Democratic Training} is able to reduce such correlations and redundancies so that it is much more difficult to find highly effective UAPs on the \emph{Democratic Training} enhanced models.

Thus, although secondary UAP attacks on \emph{Democratic Training} repaired models can still generate UAPs that successfully fool the models, our defense keeps the secondary attack success rate to a very low level while keeping the adversarial accuracy high. Hence, based on above results, \emph{Democratic Training} repaired model is able to stay robust against adaptive UAP attacks.

\begin{table*}[t]
\setlength\heavyrulewidth{0.25ex}
\centering
\caption{Advanced attack performance on $NN_1$. We report the Adversarial accuracy (AAcc.), attack success rate (SR) and layer-wise entropy (Entropy) of UAP infected samples. Note that clean sample layer-wise entropy is $7.1$}
\resizebox{0.5\textwidth}{!}
{
\begin{tabular}[t]{p{6mm}p{8mm}p{8mm}p{10mm}|p{8mm}p{8mm}p{10mm}}%
\toprule
\multirow{2}{*}{$\rho$}&\multicolumn{3}{c|}{Before}&\multicolumn{3}{c}{After}\\
& AAcc. & SR & Entropy & AAcc. & SR & Entropy \\
\midrule
0.0&0.118&0.764&5.62&0.619&0.001&7.39\\
0.1&0.121&0.775&6.07&0.619&0.001&7.39\\
0.2&0.118&0.759&6.29&0.619&0.001&7.40\\
0.3&0.128&0.764&6.35&0.613&0.001&7.39\\
0.4&0.127&0.761&6.89&0.612&0.001&7.40\\
0.5&0.125&0.759&7.07&0.608&0.0&7.39\\
0.6&0.141&0.745&7.13&0.618&0.0&7.39\\
0.7&0.161&0.693&7.16&0.599&0.001&7.39\\
0.8&0.185&0.657&7.33&0.609&0.001&7.40\\
0.9&0.207&0.568&7.43&0.628&0.0&7.39\\
\bottomrule

\end{tabular}
}
\label{tab:advanced_attack}
\end{table*}

Secondly, for advanced attacks we conduct experiments such that when generating UAPs, the attacker further controls the change in layer-wise entropy. Based on DF-UAP, the optimization loss function used for crafting an UAP is modified as:
\begin{equation}
\textbf{L}(i) = (1 - \rho) \cdot \textbf{L}_{cce}(i, y_t) - \rho \cdot  \textbf{H}(i)
\end{equation}
where $i$ represents a training sample, $y_t$ represents the attack target class and $\textbf{H}(i)$ represents the layer-wise entropy loss for $i$. We use $\textbf{H}(i)$ to control the entropy change caused by the UAP and parameter $\rho$ is used to control the importance of $\textbf{H}(i)$ over attack success rate. We conduct such advanced attack on model $NN_1$ to $NN_6$ with $\rho$ set to 0.1 to 0.9. All models show similar results and for illustration purpose, results on $NN_1$ are summarized Table~\ref{tab:advanced_attack}.
Increasing $\rho$ causes the attack performance to drop, i.e., the attack success rate starts to drop when $\rho > 0.5$ and the attack SR is below $60\%$ when $\rho=0.9$. Our defense stays effective across different $\rho$ settings where the attack SR is reduced to $<1\%$ for all scenarios. Hence, knowing how \emph{Democratic Training} enhance the model and control the change in layer-wise entropy during attack process, the adversary is still not able to bypass our defense effectively.

\subsection{Entropy Analysis on other UAPs}
\label{app:entro_otheruap}
As part of RQ2, we further analyze the change in layer-wise entropy of clean and UAP infected samples for other types of UAP attacks, i.e., sPGD, LaVAN, GAP and SGA. The results are summarized in Figure~\ref{fig:box_other_uaps}, which show that similar to DF-UAP, UAPs generated with above mentioned four methods also cause the layer-wise entropy to drop and \emph{Democratic Training} is able to mitigate such effect effectively.
\begin{figure}[t]
\centering
\resizebox{0.7\textwidth}{!}
{
\begin{tabular}{cccc}

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    ytick={1,2,3},
    yticklabels={Clean, Before, After},
    yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={sPGD},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=2.75,
lower quartile=6.97,
median=7.26,
upper quartile=7.35,
upper whisker=7.49,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.65,
lower quartile=7.37,
median=7.41,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={LaVAN},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=12.20,
lower quartile=12.20,
median=12.20,
upper quartile=12.20,
upper whisker=12.20,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=7.05,
lower quartile=9.57,
median=9.75,
upper quartile=10.20,
upper whisker=10.86,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=12.20,
lower quartile=12.20,
median=12.20,
upper quartile=12.20,
upper whisker=12.20,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={GAP},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=2.51,
lower quartile=5.57,
median=6.93,
upper quartile=7.32,
upper whisker=7.52,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.71,
lower quartile=7.38,
median=7.44,
upper quartile=7.50,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={SGA},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=1.24,
lower quartile=4.72,
median=5.74,
upper quartile=7.18,
upper whisker=7.44,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.85,
lower quartile=7.38,
median=7.43,
upper quartile=7.48,
upper whisker=7.53,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

\\

\end{tabular}
}
\caption{Change in layer-wise entropy of other UAPs.} 
\label{fig:box_other_uaps}
\end{figure}



\subsection{Non-targeted UAP attacks}
\label{non-targeted UAP}
We further evaluate \emph{Democratic Training} on non-targeted UAP attacks. We generate non-targeted UAPs following DF-UAP for $NN_1$ to $NN_6$ and report the adversarial accuracy and attack success rate on original models ($NN_1$ to $NN_6$) and repaired models ($NN_1'$ to $NN_6'$). For non-targeted attacks, the attack success rate (SR) is calculated as $SR = \sum_{x\in X}\frac{|N(x + \delta) \neq N(x)|}{|X|}$, where $x\in X$ represents a clean sample, $\delta$ is the UAP. The results are summarized in Table~\ref{tab:non_target_result}. 

\begin{table*}[t]
\setlength\heavyrulewidth{0.25ex}
\centering
\caption{Performance on non-targeted UAP attacks.}
\resizebox{0.5\textwidth}{!}
{
\begin{tabular}[t]{p{6mm}p{8mm}p{8mm}|p{8mm}p{8mm}p{10mm}}%
\toprule
\multirow{2}{*}{Model}&\multicolumn{2}{c|}{Before}&\multicolumn{3}{c}{After}\\
& AAcc. & SR & AAcc. & SR & $\Delta$ CAcc. \\
\midrule
$NN_1$&0.057&0.939&0.594&0.267&-0.047\\
$NN_2$&0.056&0.943&0.369&0.559&-0.066\\
$NN_3$&0.098&0.888&0.469&0.408&-0.035\\
$NN_4$&0.002&0.981&0.918&0.066&-0.031\\
$NN_5$&0.053&0.958&0.607&0.374&-0.019\\
$NN_6$&0.289&0.737&0.801&0.129&-0.008\\
\textbf{Avg}&\textbf{0.092}&\textbf{0.907}&\textbf{0.626}&\textbf{0.300}&\textbf{-0.034}\\
\bottomrule

\end{tabular}
}
\label{tab:non_target_result}
\end{table*}

Although not designed for non-targeted UAPs, \emph{Democratic Training} manages to reduce the attack SR from over $90\%$ to $30\%$ on average. This is indeed not as effective as targeted UAP defense and we believe this is due to the different entropy spectrum caused by the two types of UAPs. Figure~\ref{fig:empirical_utgt_nn2} shows the entropy spectrum of clean and non-targeted UAP infected samples for $NN_2$ where no clear separation of the two is observed.

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=11.65532398223877,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
            (0, 0.8670392632484436)
            (1, 4.203394412994385)
            (2, 2.79893159866333)
            (3, 3.248058557510376)
            (4, 4.956404209136963)
            (5, 4.851291656494141)
            (6, 4.4433794021606445)
            (7, 4.276747703552246)
            (8, 3.9429469108581543)
            (9, 1.9806283712387085)
            (10, 9.428304672241211)
            (11, 2.6706364154815674)
            (12, 1.14308762550354)
            (13, 1.464613914489746)
            (14, 6.751933574676514)
            (15, 3.766333818435669)
            (16, 2.8412601947784424)
            (17, 1.9614897966384888)
            (18, 4.439700603485107)
            (19, 4.556280136108398)
            (20, 2.6961441040039062)
            (21, 3.045600652694702)
            (22, 3.01009202003479)
            (23, 0.4820761978626251)
            (24, 6.742772579193115)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.5292925834655762)
(1, 4.23392391204834)
(2, 2.865919828414917)
(3, 3.6614797115325928)
(4, 3.908151388168335)
(5, 1.990601897239685)
(6, 3.2758731842041016)
(7, 2.5622851848602295)
(8, 3.605607032775879)
(9, 2.3976337909698486)
(10, 8.554436683654785)
(11, 2.537466049194336)
(12, 1.4500030279159546)
(13, 2.017951011657715)
(14, 5.810871601104736)
(15, 4.196506977081299)
(16, 1.6376491785049438)
(17, 1.3501505851745605)
(18, 4.232375621795654)
(19, 4.017235279083252)
(20, 1.8185207843780518)
(21, 2.108614683151245)
(22, 2.0913031101226807)
(23, 0.3699318468570709)
(24, 6.024077415466309)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=3.676987886428833,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.512022280944166e-10)
(1, 0.6996569633483887)
(2, 0.6904095411300659)
(3, 0.0031523732468485832)
(4, 1.997532606124878)
(5, 0.3566475808620453)
(6, 0.580481231212616)
(7, 2.4262545108795166)
(8, 0.8406250476837158)
(9, 0.03593352064490318)
(10, 2.2751646041870117)
(11, 1.1454508304595947)
(12, 0.06944648176431656)
(13, 1.4992042779922485)
(14, 1.256005883216858)
(15, 0.9772812724113464)
(16, 0.08370808511972427)
(17, 0.06888635456562042)
(18, 0.06834015250205994)
(19, 0.27852070331573486)
(20, 0.47421109676361084)
(21, 0.734909176826477)
(22, 1.2584691047668457)
(23, 0.8235303163528442)
(24, 0.07907768338918686)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.763912216290464e-08)
(1, 0.12448833882808685)
(2, 1.6149040460586548)
(3, 0.46489888429641724)
(4, 0.22977116703987122)
(5, 0.2719992697238922)
(6, 0.00991914700716734)
(7, 2.4356515407562256)
(8, 0.5442703366279602)
(9, 4.0019338598540344e-07)
(10, 1.4971673488616943)
(11, 0.03859331086277962)
(12, 0.06068062409758568)
(13, 1.2925019264221191)
(14, 1.3430347442626953)
(15, 1.8866747617721558)
(16, 0.013728993013501167)
(17, 0.15296399593353271)
(18, 0.16194124519824982)
(19, 1.0660070180892944)
(20, 0.102995365858078)
(21, 0.8343018889427185)
(22, 1.8828033208847046)
(23, 0.026021229103207588)
(24, 0.02741633728146553)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=1.6435120642199763e-07,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 0.5664233565330505)
(1, 0.6905134320259094)
(2, 9.51390699555077e-09)
(3, 0.16707850992679596)
(4, 0.08154116570949554)
(5, 1.326097676113136e-09)
(6, 0.5255347490310669)
(7, 0.0007963245152495801)
(8, 0.5526244640350342)
(9, 0.6923224925994873)
(10, 0.002500229747965932)
(11, 1.1823940670704277e-27)
(12, 0.41201362013816833)
(13, 6.114308614968422e-09)
(14, 0.6577929258346558)
(15, 0.6245567202568054)
(16, 1.0030009746551514)
(17, 0.005943175405263901)
(18, 2.908605023499433e-10)
(19, 4.761259962682285e-12)
(20, 0.23187805712223053)
(21, 0.006361017934978008)
(22, 0.7860202193260193)
(23, 0.0015546302311122417)
(24, 0.2052939385175705)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 0.05087463557720184)
(1, 0.03741353005170822)
(2, 0.23805978894233704)
(3, 0.6056424975395203)
(4, 0.4965641498565674)
(5, 0.033662814646959305)
(6, 0.009348231367766857)
(7, 0.0945780873298645)
(8, 9.569460962666199e-05)
(9, 0.0002139242715202272)
(10, 3.67103041298833e-08)
(11, 1.4767954036411546e-19)
(12, 0.2189769148826599)
(13, 4.693345545092598e-06)
(14, 0.0019703248981386423)
(15, 7.370424981445467e-08)
(16, 1.3971150625291529e-12)
(17, 0.0065706525929272175)
(18, 0.6649676561355591)
(19, 0.6818381547927856)
(20, 0.006047973874956369)
(21, 1.422394416294992e-05)
(22, 0.0002970147179439664)
(23, 0.03966192528605461)
(24, 0.3045032024383545)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 0.0006940048187971115,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.123456384761084e-07)
(1, 0.9320614337921143)
(2, 0.03510023280978203)
(3, 0.17361392080783844)
(4, 0.8518461585044861)
(5, 1.3186639547348022)
(6, 0.1461603194475174)
(7, 0.24008433520793915)
(8, 0.001671440084464848)
(9, 4.015800539325376e-11)
(10, 1.2320153713226318)
(11, 0.004533248953521252)
(12, 0.638664186000824)
(13, 2.101774215698242)
(14, 0.6912434697151184)
(15, 0.06492438167333603)
(16, 1.4808086156845093)
(17, 0.723040759563446)
(18, 1.2496764659881592)
(19, 0.0009941047756001353)
(20, 0.5715951919555664)
(21, 7.806065127624606e-09)
(22, 0.0004529326979536563)
(23, 0.007465764414519072)
(24, 0.2062280774116516)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 2.7190171181246114e-07)
(1, 0.9734252691268921)
(2, 0.3270474374294281)
(3, 0.0010683140717446804)
(4, 0.019323764368891716)
(5, 0.006653614342212677)
(6, 0.06363847106695175)
(7, 0.0004986427957192063)
(8, 0.005074079614132643)
(9, 3.831811756782599e-09)
(10, 0.8621487021446228)
(11, 0.9122730493545532)
(12, 0.00010548279533395544)
(13, 1.5126063823699951)
(14, 0.027134614065289497)
(15, 0.6411354541778564)
(16, 0.003407495329156518)
(17, 0.20498593151569366)
(18, 2.8410995582817122e-06)
(19, 0.10956024378538132)
(20, 0.3547962009906769)
(21, 0.019527746364474297)
(22, 0.12528389692306519)
(23, 1.207711100578308)
(24, 1.9340060949325562)

        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=0.007989148609340191,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 0.7224549055099487)
(1, 1.2165002822875977)
(2, 0.14165805280208588)
(3, 0.23887167870998383)
(4, 1.642408013343811)
(5, 2.239363670349121)
(6, 0.647439181804657)
(7, 0.6164023876190186)
(8, 0.04940442368388176)
(9, 2.366478443145752)
(10, 1.2258628606796265)
(11, 1.4040149450302124)
(12, 2.1413159370422363)
(13, 1.3456015586853027)
(14, 1.814832329750061)
(15, 1.3084648847579956)
(16, 1.6361035108566284)
(17, 0.49937114119529724)
(18, 0.9645723700523376)
(19, 1.741910696029663)
(20, 1.3633426427841187)
(21, 0.36131352186203003)
(22, 1.1857632398605347)
(23, 0.34921836853027344)
(24, 0.07919434458017349)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.0066081285476685)
(1, 3.520749807357788)
(2, 1.430531620979309)
(3, 1.599204421043396)
(4, 0.016903430223464966)
(5, 1.84110689163208)
(6, 0.002624484244734049)
(7, 0.007127051707357168)
(8, 0.2677205502986908)
(9, 2.6304800510406494)
(10, 0.2962924540042877)
(11, 1.0110515356063843)
(12, 1.0740139484405518)
(13, 0.12763851881027222)
(14, 2.4745423793792725)
(15, 0.7329649329185486)
(16, 0.021469052881002426)
(17, 0.6801987290382385)
(18, 0.9274744391441345)
(19, 0.8975456953048706)
(20, 0.2759021520614624)
(21, 0.9051945209503174)
(22, 1.9405211210250854)
(23, 2.0288245677948)
(24, 2.191551685333252)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=5.914130687713623,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.356301784515381)
(1, 5.134919166564941)
(2, 7.915582180023193)
(3, 7.685725212097168)
(4, 7.095771789550781)
(5, 7.775623321533203)
(6, 4.164100646972656)
(7, 6.217923164367676)
(8, 4.190909385681152)
(9, 7.858490943908691)
(10, 6.706398963928223)
(11, 6.935410499572754)
(12, 7.873645305633545)
(13, 7.768457412719727)
(14, 8.032693862915039)
(15, 7.550225257873535)
(16, 8.073528289794922)
(17, 7.584288120269775)
(18, 7.511919021606445)
(19, 7.928519248962402)
(20, 7.561807155609131)
(21, 7.0620293617248535)
(22, 7.934795379638672)
(23, 7.181863784790039)
(24, 4.555568218231201)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.443185806274414)
(1, 7.188292503356934)
(2, 7.620933532714844)
(3, 8.13648509979248)
(4, 7.008289337158203)
(5, 7.652921676635742)
(6, 7.007549285888672)
(7, 3.9010415077209473)
(8, 6.743478298187256)
(9, 7.928228378295898)
(10, 6.88345193862915)
(11, 6.78108024597168)
(12, 8.096538543701172)
(13, 8.050117492675781)
(14, 8.16456413269043)
(15, 5.789112567901611)
(16, 7.295847415924072)
(17, 7.79065465927124)
(18, 7.713292598724365)
(19, 6.330600738525391)
(20, 7.84869384765625)
(21, 7.000957489013672)
(22, 7.542274475097656)
(23, 7.8698225021362305)
(24, 7.888116836547852)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_2$.} 
\label{fig:empirical_utgt_nn2}
\end{figure*}

\begin{comment}

$ASR = nFR = \sum_{x\in X}\frac{|f(x + \delta) \neq f(x)|}{|X|}$\\
$ASR = tFR = \sum_{x\in (X - X_t)}\frac{|f(x + \delta) = t|}{|X| - |X_t|}$ \\
$CAcc. = \sum_{x\in X}\frac{|f(x) = label(x)|}{|X|}$ \\
$AAcc. = \sum_{x\in X}\frac{|f(x + \delta) = label(x)|}{|X|}$
    


\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.15998363494873,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.132645606994629)
(1, 12.132169723510742)
(2, 12.119187355041504)
(3, 12.15030574798584)
(4, 12.156091690063477)
(5, 12.141684532165527)
(6, 12.118185043334961)
(7, 12.129878044128418)
(8, 12.085209846496582)
(9, 12.128399848937988)
(10, 12.135781288146973)
(11, 12.137386322021484)
(12, 12.116486549377441)
(13, 12.090312957763672)
(14, 12.147895812988281)
(15, 12.105506896972656)
(16, 12.112274169921875)
(17, 12.115019798278809)
(18, 12.074466705322266)
(19, 12.137069702148438)
(20, 12.119229316711426)
(21, 12.143909454345703)
(22, 12.104930877685547)
(23, 12.023744583129883)
(24, 12.137703895568848)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.119718551635742)
(1, 12.12280559539795)
(2, 12.10732650756836)
(3, 12.134988784790039)
(4, 12.140920639038086)
(5, 12.130127906799316)
(6, 12.106840133666992)
(7, 12.119171142578125)
(8, 12.078542709350586)
(9, 12.114554405212402)
(10, 12.122733116149902)
(11, 12.123845100402832)
(12, 12.105480194091797)
(13, 12.082608222961426)
(14, 12.134397506713867)
(15, 12.09575366973877)
(16, 12.100696563720703)
(17, 12.107048034667969)
(18, 12.070808410644531)
(19, 12.125701904296875)
(20, 12.106622695922852)
(21, 12.129912376403809)
(22, 12.092060089111328)
(23, 12.015557289123535)
(24, 12.127670288085938)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot1.1,
    at={(0.8cm,0.05cm)},
    %title={Shallow Layer 1},
    ylabel=\empty,%{Layer-wise Entropy},
    ytick = {11.9,12,12.1},
    yticklabels = {11.90,12.00,12.10},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.15998363494873,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]
   
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.132645606994629)
(1, 12.132169723510742)
(2, 12.119187355041504)
(3, 12.15030574798584)
(4, 12.156091690063477)
(5, 12.141684532165527)
(6, 12.118185043334961)
(7, 12.129878044128418)
(8, 12.085209846496582)
(9, 12.128399848937988)
(10, 12.135781288146973)
(11, 12.137386322021484)
(12, 12.116486549377441)
(13, 12.090312957763672)
(14, 12.147895812988281)
(15, 12.105506896972656)
(16, 12.112274169921875)
(17, 12.115019798278809)
(18, 12.074466705322266)
(19, 12.137069702148438)
(20, 12.119229316711426)
(21, 12.143909454345703)
(22, 12.104930877685547)
(23, 12.023744583129883)
(24, 12.137703895568848)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.119718551635742)
(1, 12.12280559539795)
(2, 12.10732650756836)
(3, 12.134988784790039)
(4, 12.140920639038086)
(5, 12.130127906799316)
(6, 12.106840133666992)
(7, 12.119171142578125)
(8, 12.078542709350586)
(9, 12.114554405212402)
(10, 12.122733116149902)
(11, 12.123845100402832)
(12, 12.105480194091797)
(13, 12.082608222961426)
(14, 12.134397506713867)
(15, 12.09575366973877)
(16, 12.100696563720703)
(17, 12.107048034667969)
(18, 12.070808410644531)
(19, 12.125701904296875)
(20, 12.106622695922852)
(21, 12.129912376403809)
(22, 12.092060089111328)
(23, 12.015557289123535)
(24, 12.127670288085938)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=13.5698881149292,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 13.575243949890137)
(1, 13.579079627990723)
(2, 13.576433181762695)
(3, 13.581716537475586)
(4, 13.580144882202148)
(5, 13.574682235717773)
(6, 13.576072692871094)
(7, 13.574684143066406)
(8, 13.569478034973145)
(9, 13.577945709228516)
(10, 13.577411651611328)
(11, 13.577378273010254)
(12, 13.575383186340332)
(13, 13.571810722351074)
(14, 13.579093933105469)
(15, 13.576925277709961)
(16, 13.572620391845703)
(17, 13.573322296142578)
(18, 13.570365905761719)
(19, 13.57905101776123)
(20, 13.57974910736084)
(21, 13.578722953796387)
(22, 13.573071479797363)
(23, 13.569568634033203)
(24, 13.578734397888184)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 13.571993827819824)
(1, 13.568804740905762)
(2, 13.573675155639648)
(3, 13.56924057006836)
(4, 13.575188636779785)
(5, 13.56953239440918)
(6, 13.571478843688965)
(7, 13.571075439453125)
(8, 13.566020965576172)
(9, 13.569262504577637)
(10, 13.567281723022461)
(11, 13.570068359375)
(12, 13.56997299194336)
(13, 13.564300537109375)
(14, 13.572340965270996)
(15, 13.567906379699707)
(16, 13.568204879760742)
(17, 13.568944931030273)
(18, 13.567535400390625)
(19, 13.570487976074219)
(20, 13.570295333862305)
(21, 13.572426795959473)
(22, 13.570623397827148)
(23, 13.563644409179688)
(24, 13.572185516357422)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot2.1,
    at={(2.85cm,0.05cm)},
    %title={Shallow Layer 2},
    ytick = {13.57,13.58},
    yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=13.5698881149292,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 13.575243949890137)
(1, 13.579079627990723)
(2, 13.576433181762695)
(3, 13.581716537475586)
(4, 13.580144882202148)
(5, 13.574682235717773)
(6, 13.576072692871094)
(7, 13.574684143066406)
(8, 13.569478034973145)
(9, 13.577945709228516)
(10, 13.577411651611328)
(11, 13.577378273010254)
(12, 13.575383186340332)
(13, 13.571810722351074)
(14, 13.579093933105469)
(15, 13.576925277709961)
(16, 13.572620391845703)
(17, 13.573322296142578)
(18, 13.570365905761719)
(19, 13.57905101776123)
(20, 13.57974910736084)
(21, 13.578722953796387)
(22, 13.573071479797363)
(23, 13.569568634033203)
(24, 13.578734397888184)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 13.571993827819824)
(1, 13.568804740905762)
(2, 13.573675155639648)
(3, 13.56924057006836)
(4, 13.575188636779785)
(5, 13.56953239440918)
(6, 13.571478843688965)
(7, 13.571075439453125)
(8, 13.566020965576172)
(9, 13.569262504577637)
(10, 13.567281723022461)
(11, 13.570068359375)
(12, 13.56997299194336)
(13, 13.564300537109375)
(14, 13.572340965270996)
(15, 13.567906379699707)
(16, 13.568204879760742)
(17, 13.568944931030273)
(18, 13.567535400390625)
(19, 13.570487976074219)
(20, 13.570295333862305)
(21, 13.572426795959473)
(22, 13.570623397827148)
(23, 13.563644409179688)
(24, 13.572185516357422)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.861103057861328,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.882184028625488)
(1, 12.884977340698242)
(2, 12.886763572692871)
(3, 12.885274887084961)
(4, 12.887182235717773)
(5, 12.880290031433105)
(6, 12.884208679199219)
(7, 12.882586479187012)
(8, 12.877588272094727)
(9, 12.885100364685059)
(10, 12.883172035217285)
(11, 12.884334564208984)
(12, 12.884919166564941)
(13, 12.881420135498047)
(14, 12.884645462036133)
(15, 12.883329391479492)
(16, 12.880126953125)
(17, 12.882589340209961)
(18, 12.881421089172363)
(19, 12.886670112609863)
(20, 12.887273788452148)
(21, 12.885767936706543)
(22, 12.885605812072754)
(23, 12.886465072631836)
(24, 12.886938095092773)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.878951072692871)
(1, 12.863896369934082)
(2, 12.882164001464844)
(3, 12.860774040222168)
(4, 12.878188133239746)
(5, 12.870800971984863)
(6, 12.876749038696289)
(7, 12.875571250915527)
(8, 12.873982429504395)
(9, 12.872506141662598)
(10, 12.865248680114746)
(11, 12.873857498168945)
(12, 12.875396728515625)
(13, 12.866747856140137)
(14, 12.873808860778809)
(15, 12.86392593383789)
(16, 12.87631607055664)
(17, 12.873862266540527)
(18, 12.875368118286133)
(19, 12.870726585388184)
(20, 12.867669105529785)
(21, 12.87566089630127)
(22, 12.883134841918945)
(23, 12.878917694091797)
(24, 12.87421703338623)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(4.9cm,0.05cm)},
    %title={Middle Layer 1},
    ytick = {12.88,12.89},
    yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=12.861103057861328,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.882184028625488)
(1, 12.884977340698242)
(2, 12.886763572692871)
(3, 12.885274887084961)
(4, 12.887182235717773)
(5, 12.880290031433105)
(6, 12.884208679199219)
(7, 12.882586479187012)
(8, 12.877588272094727)
(9, 12.885100364685059)
(10, 12.883172035217285)
(11, 12.884334564208984)
(12, 12.884919166564941)
(13, 12.881420135498047)
(14, 12.884645462036133)
(15, 12.883329391479492)
(16, 12.880126953125)
(17, 12.882589340209961)
(18, 12.881421089172363)
(19, 12.886670112609863)
(20, 12.887273788452148)
(21, 12.885767936706543)
(22, 12.885605812072754)
(23, 12.886465072631836)
(24, 12.886938095092773)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.878951072692871)
(1, 12.863896369934082)
(2, 12.882164001464844)
(3, 12.860774040222168)
(4, 12.878188133239746)
(5, 12.870800971984863)
(6, 12.876749038696289)
(7, 12.875571250915527)
(8, 12.873982429504395)
(9, 12.872506141662598)
(10, 12.865248680114746)
(11, 12.873857498168945)
(12, 12.875396728515625)
(13, 12.866747856140137)
(14, 12.873808860778809)
(15, 12.86392593383789)
(16, 12.87631607055664)
(17, 12.873862266540527)
(18, 12.875368118286133)
(19, 12.870726585388184)
(20, 12.867669105529785)
(21, 12.87566089630127)
(22, 12.883134841918945)
(23, 12.878917694091797)
(24, 12.87421703338623)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.186715126037598,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.20175838470459)
(1, 12.200848579406738)
(2, 12.203475952148438)
(3, 12.202248573303223)
(4, 12.203421592712402)
(5, 12.203023910522461)
(6, 12.20170783996582)
(7, 12.201428413391113)
(8, 12.19926643371582)
(9, 12.202072143554688)
(10, 12.200956344604492)
(11, 12.200956344604492)
(12, 12.202291488647461)
(13, 12.198720932006836)
(14, 12.201695442199707)
(15, 12.200786590576172)
(16, 12.199288368225098)
(17, 12.202156066894531)
(18, 12.200779914855957)
(19, 12.202889442443848)
(20, 12.202649116516113)
(21, 12.2019681930542)
(22, 12.201281547546387)
(23, 12.203798294067383)
(24, 12.202010154724121)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.200361251831055)
(1, 12.191414833068848)
(2, 12.201741218566895)
(3, 12.189560890197754)
(4, 12.19888687133789)
(5, 12.197277069091797)
(6, 12.198171615600586)
(7, 12.198074340820312)
(8, 12.19830322265625)
(9, 12.194591522216797)
(10, 12.192987442016602)
(11, 12.195721626281738)
(12, 12.197453498840332)
(13, 12.193190574645996)
(14, 12.195789337158203)
(15, 12.191271781921387)
(16, 12.198622703552246)
(17, 12.198208808898926)
(18, 12.199039459228516)
(19, 12.194123268127441)
(20, 12.194167137145996)
(21, 12.197495460510254)
(22, 12.202431678771973)
(23, 12.200990676879883)
(24, 12.195725440979004)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot4.1,
    at={(6.95cm,0.05cm)},
    %title={Middle Layer 2},
    %ylabel={Layer-wise Entropy},
    ytick = {12.20,12.2035},
    yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.186715126037598,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.20175838470459)
(1, 12.200848579406738)
(2, 12.203475952148438)
(3, 12.202248573303223)
(4, 12.203421592712402)
(5, 12.203023910522461)
(6, 12.20170783996582)
(7, 12.201428413391113)
(8, 12.19926643371582)
(9, 12.202072143554688)
(10, 12.200956344604492)
(11, 12.200956344604492)
(12, 12.202291488647461)
(13, 12.198720932006836)
(14, 12.201695442199707)
(15, 12.200786590576172)
(16, 12.199288368225098)
(17, 12.202156066894531)
(18, 12.200779914855957)
(19, 12.202889442443848)
(20, 12.202649116516113)
(21, 12.2019681930542)
(22, 12.201281547546387)
(23, 12.203798294067383)
(24, 12.202010154724121)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.200361251831055)
(1, 12.191414833068848)
(2, 12.201741218566895)
(3, 12.189560890197754)
(4, 12.19888687133789)
(5, 12.197277069091797)
(6, 12.198171615600586)
(7, 12.198074340820312)
(8, 12.19830322265625)
(9, 12.194591522216797)
(10, 12.192987442016602)
(11, 12.195721626281738)
(12, 12.197453498840332)
(13, 12.193190574645996)
(14, 12.195789337158203)
(15, 12.191271781921387)
(16, 12.198622703552246)
(17, 12.198208808898926)
(18, 12.199039459228516)
(19, 12.194123268127441)
(20, 12.194167137145996)
(21, 12.197495460510254)
(22, 12.202431678771973)
(23, 12.200990676879883)
(24, 12.195725440979004)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(3.3cm,-2cm)},anchor=east
    },
    extra y ticks=0.9463970065116882,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.644872665405273)
(1, 2.5427331924438477)
(2, 3.6729111671447754)
(3, 3.6399383544921875)
(4, 7.019032955169678)
(5, 8.960342407226562)
(6, 3.6945693492889404)
(7, 8.596531867980957)
(8, 6.112277030944824)
(9, 5.693033695220947)
(10, 9.126766204833984)
(11, 5.952503204345703)
(12, 10.368865013122559)
(13, 5.971660614013672)
(14, 9.222222328186035)
(15, 4.5347900390625)
(16, 9.944439888000488)
(17, 2.778257131576538)
(18, 3.1820805072784424)
(19, 5.550966739654541)
(20, 6.642882347106934)
(21, 9.276622772216797)
(22, 5.540478706359863)
(23, 6.824645519256592)
(24, 4.263994216918945)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.678301811218262)
(1, 10.59018325805664)
(2, 7.256903648376465)
(3, 10.312143325805664)
(4, 10.6985502243042)
(5, 10.028554916381836)
(6, 2.4466867446899414)
(7, 10.39353084564209)
(8, 10.150296211242676)
(9, 1.819780945777893)
(10, 10.309715270996094)
(11, 1.166701316833496)
(12, 10.178924560546875)
(13, 5.398101329803467)
(14, 0.5820510387420654)
(15, 0.9283169507980347)
(16, 10.49929428100586)
(17, 10.860508918762207)
(18, 8.779828071594238)
(19, 8.406171798706055)
(20, 10.206894874572754)
(21, 10.570980072021484)
(22, 10.00669002532959)
(23, 10.437511444091797)
(24, 10.823158264160156)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=7.352672576904297,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.4055891036987305)
(1, 6.660892486572266)
(2, 6.128525733947754)
(3, 7.40097188949585)
(4, 7.21845817565918)
(5, 7.189165115356445)
(6, 7.368408679962158)
(7, 7.259629249572754)
(8, 7.194795608520508)
(9, 7.052578926086426)
(10, 7.291655540466309)
(11, 7.461211681365967)
(12, 7.431214332580566)
(13, 7.469444274902344)
(14, 7.448919296264648)
(15, 7.057613372802734)
(16, 7.147312164306641)
(17, 7.195530414581299)
(18, 6.436911106109619)
(19, 7.438458442687988)
(20, 6.284543991088867)
(21, 7.451208114624023)
(22, 6.910295486450195)
(23, 6.453247547149658)
(24, 7.380129814147949)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 7.391251564025879)
(1, 7.395258903503418)
(2, 7.439428806304932)
(3, 7.246380805969238)
(4, 7.365582466125488)
(5, 7.398766040802002)
(6, 7.17336893081665)
(7, 7.416275978088379)
(8, 7.410740852355957)
(9, 7.332366943359375)
(10, 7.387124061584473)
(11, 7.4199910163879395)
(12, 7.4425811767578125)
(13, 7.278416633605957)
(14, 7.394631862640381)
(15, 7.374345779418945)
(16, 7.299531936645508)
(17, 7.445536136627197)
(18, 7.39892578125)
(19, 7.4148454666137695)
(20, 7.359228610992432)
(21, 7.362961292266846)
(22, 7.348609924316406)
(23, 7.420055389404297)
(24, 7.413165092468262)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_1$.} 
\label{fig:empirical_utgt}
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=11.65532398223877,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
            (0, 0.8670392632484436)
            (1, 4.203394412994385)
            (2, 2.79893159866333)
            (3, 3.248058557510376)
            (4, 4.956404209136963)
            (5, 4.851291656494141)
            (6, 4.4433794021606445)
            (7, 4.276747703552246)
            (8, 3.9429469108581543)
            (9, 1.9806283712387085)
            (10, 9.428304672241211)
            (11, 2.6706364154815674)
            (12, 1.14308762550354)
            (13, 1.464613914489746)
            (14, 6.751933574676514)
            (15, 3.766333818435669)
            (16, 2.8412601947784424)
            (17, 1.9614897966384888)
            (18, 4.439700603485107)
            (19, 4.556280136108398)
            (20, 2.6961441040039062)
            (21, 3.045600652694702)
            (22, 3.01009202003479)
            (23, 0.4820761978626251)
            (24, 6.742772579193115)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.5292925834655762)
(1, 4.23392391204834)
(2, 2.865919828414917)
(3, 3.6614797115325928)
(4, 3.908151388168335)
(5, 1.990601897239685)
(6, 3.2758731842041016)
(7, 2.5622851848602295)
(8, 3.605607032775879)
(9, 2.3976337909698486)
(10, 8.554436683654785)
(11, 2.537466049194336)
(12, 1.4500030279159546)
(13, 2.017951011657715)
(14, 5.810871601104736)
(15, 4.196506977081299)
(16, 1.6376491785049438)
(17, 1.3501505851745605)
(18, 4.232375621795654)
(19, 4.017235279083252)
(20, 1.8185207843780518)
(21, 2.108614683151245)
(22, 2.0913031101226807)
(23, 0.3699318468570709)
(24, 6.024077415466309)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=3.676987886428833,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.512022280944166e-10)
(1, 0.6996569633483887)
(2, 0.6904095411300659)
(3, 0.0031523732468485832)
(4, 1.997532606124878)
(5, 0.3566475808620453)
(6, 0.580481231212616)
(7, 2.4262545108795166)
(8, 0.8406250476837158)
(9, 0.03593352064490318)
(10, 2.2751646041870117)
(11, 1.1454508304595947)
(12, 0.06944648176431656)
(13, 1.4992042779922485)
(14, 1.256005883216858)
(15, 0.9772812724113464)
(16, 0.08370808511972427)
(17, 0.06888635456562042)
(18, 0.06834015250205994)
(19, 0.27852070331573486)
(20, 0.47421109676361084)
(21, 0.734909176826477)
(22, 1.2584691047668457)
(23, 0.8235303163528442)
(24, 0.07907768338918686)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.763912216290464e-08)
(1, 0.12448833882808685)
(2, 1.6149040460586548)
(3, 0.46489888429641724)
(4, 0.22977116703987122)
(5, 0.2719992697238922)
(6, 0.00991914700716734)
(7, 2.4356515407562256)
(8, 0.5442703366279602)
(9, 4.0019338598540344e-07)
(10, 1.4971673488616943)
(11, 0.03859331086277962)
(12, 0.06068062409758568)
(13, 1.2925019264221191)
(14, 1.3430347442626953)
(15, 1.8866747617721558)
(16, 0.013728993013501167)
(17, 0.15296399593353271)
(18, 0.16194124519824982)
(19, 1.0660070180892944)
(20, 0.102995365858078)
(21, 0.8343018889427185)
(22, 1.8828033208847046)
(23, 0.026021229103207588)
(24, 0.02741633728146553)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=1.6435120642199763e-07,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 0.5664233565330505)
(1, 0.6905134320259094)
(2, 9.51390699555077e-09)
(3, 0.16707850992679596)
(4, 0.08154116570949554)
(5, 1.326097676113136e-09)
(6, 0.5255347490310669)
(7, 0.0007963245152495801)
(8, 0.5526244640350342)
(9, 0.6923224925994873)
(10, 0.002500229747965932)
(11, 1.1823940670704277e-27)
(12, 0.41201362013816833)
(13, 6.114308614968422e-09)
(14, 0.6577929258346558)
(15, 0.6245567202568054)
(16, 1.0030009746551514)
(17, 0.005943175405263901)
(18, 2.908605023499433e-10)
(19, 4.761259962682285e-12)
(20, 0.23187805712223053)
(21, 0.006361017934978008)
(22, 0.7860202193260193)
(23, 0.0015546302311122417)
(24, 0.2052939385175705)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 0.05087463557720184)
(1, 0.03741353005170822)
(2, 0.23805978894233704)
(3, 0.6056424975395203)
(4, 0.4965641498565674)
(5, 0.033662814646959305)
(6, 0.009348231367766857)
(7, 0.0945780873298645)
(8, 9.569460962666199e-05)
(9, 0.0002139242715202272)
(10, 3.67103041298833e-08)
(11, 1.4767954036411546e-19)
(12, 0.2189769148826599)
(13, 4.693345545092598e-06)
(14, 0.0019703248981386423)
(15, 7.370424981445467e-08)
(16, 1.3971150625291529e-12)
(17, 0.0065706525929272175)
(18, 0.6649676561355591)
(19, 0.6818381547927856)
(20, 0.006047973874956369)
(21, 1.422394416294992e-05)
(22, 0.0002970147179439664)
(23, 0.03966192528605461)
(24, 0.3045032024383545)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 0.0006940048187971115,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.123456384761084e-07)
(1, 0.9320614337921143)
(2, 0.03510023280978203)
(3, 0.17361392080783844)
(4, 0.8518461585044861)
(5, 1.3186639547348022)
(6, 0.1461603194475174)
(7, 0.24008433520793915)
(8, 0.001671440084464848)
(9, 4.015800539325376e-11)
(10, 1.2320153713226318)
(11, 0.004533248953521252)
(12, 0.638664186000824)
(13, 2.101774215698242)
(14, 0.6912434697151184)
(15, 0.06492438167333603)
(16, 1.4808086156845093)
(17, 0.723040759563446)
(18, 1.2496764659881592)
(19, 0.0009941047756001353)
(20, 0.5715951919555664)
(21, 7.806065127624606e-09)
(22, 0.0004529326979536563)
(23, 0.007465764414519072)
(24, 0.2062280774116516)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 2.7190171181246114e-07)
(1, 0.9734252691268921)
(2, 0.3270474374294281)
(3, 0.0010683140717446804)
(4, 0.019323764368891716)
(5, 0.006653614342212677)
(6, 0.06363847106695175)
(7, 0.0004986427957192063)
(8, 0.005074079614132643)
(9, 3.831811756782599e-09)
(10, 0.8621487021446228)
(11, 0.9122730493545532)
(12, 0.00010548279533395544)
(13, 1.5126063823699951)
(14, 0.027134614065289497)
(15, 0.6411354541778564)
(16, 0.003407495329156518)
(17, 0.20498593151569366)
(18, 2.8410995582817122e-06)
(19, 0.10956024378538132)
(20, 0.3547962009906769)
(21, 0.019527746364474297)
(22, 0.12528389692306519)
(23, 1.207711100578308)
(24, 1.9340060949325562)

        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=0.007989148609340191,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 0.7224549055099487)
(1, 1.2165002822875977)
(2, 0.14165805280208588)
(3, 0.23887167870998383)
(4, 1.642408013343811)
(5, 2.239363670349121)
(6, 0.647439181804657)
(7, 0.6164023876190186)
(8, 0.04940442368388176)
(9, 2.366478443145752)
(10, 1.2258628606796265)
(11, 1.4040149450302124)
(12, 2.1413159370422363)
(13, 1.3456015586853027)
(14, 1.814832329750061)
(15, 1.3084648847579956)
(16, 1.6361035108566284)
(17, 0.49937114119529724)
(18, 0.9645723700523376)
(19, 1.741910696029663)
(20, 1.3633426427841187)
(21, 0.36131352186203003)
(22, 1.1857632398605347)
(23, 0.34921836853027344)
(24, 0.07919434458017349)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.0066081285476685)
(1, 3.520749807357788)
(2, 1.430531620979309)
(3, 1.599204421043396)
(4, 0.016903430223464966)
(5, 1.84110689163208)
(6, 0.002624484244734049)
(7, 0.007127051707357168)
(8, 0.2677205502986908)
(9, 2.6304800510406494)
(10, 0.2962924540042877)
(11, 1.0110515356063843)
(12, 1.0740139484405518)
(13, 0.12763851881027222)
(14, 2.4745423793792725)
(15, 0.7329649329185486)
(16, 0.021469052881002426)
(17, 0.6801987290382385)
(18, 0.9274744391441345)
(19, 0.8975456953048706)
(20, 0.2759021520614624)
(21, 0.9051945209503174)
(22, 1.9405211210250854)
(23, 2.0288245677948)
(24, 2.191551685333252)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=5.914130687713623,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.356301784515381)
(1, 5.134919166564941)
(2, 7.915582180023193)
(3, 7.685725212097168)
(4, 7.095771789550781)
(5, 7.775623321533203)
(6, 4.164100646972656)
(7, 6.217923164367676)
(8, 4.190909385681152)
(9, 7.858490943908691)
(10, 6.706398963928223)
(11, 6.935410499572754)
(12, 7.873645305633545)
(13, 7.768457412719727)
(14, 8.032693862915039)
(15, 7.550225257873535)
(16, 8.073528289794922)
(17, 7.584288120269775)
(18, 7.511919021606445)
(19, 7.928519248962402)
(20, 7.561807155609131)
(21, 7.0620293617248535)
(22, 7.934795379638672)
(23, 7.181863784790039)
(24, 4.555568218231201)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.443185806274414)
(1, 7.188292503356934)
(2, 7.620933532714844)
(3, 8.13648509979248)
(4, 7.008289337158203)
(5, 7.652921676635742)
(6, 7.007549285888672)
(7, 3.9010415077209473)
(8, 6.743478298187256)
(9, 7.928228378295898)
(10, 6.88345193862915)
(11, 6.78108024597168)
(12, 8.096538543701172)
(13, 8.050117492675781)
(14, 8.16456413269043)
(15, 5.789112567901611)
(16, 7.295847415924072)
(17, 7.79065465927124)
(18, 7.713292598724365)
(19, 6.330600738525391)
(20, 7.84869384765625)
(21, 7.000957489013672)
(22, 7.542274475097656)
(23, 7.8698225021362305)
(24, 7.888116836547852)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_2$.} 
\label{fig:empirical_utgt_nn2}
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    ylabel={UAP},
    y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=0.007989148609340191,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 0.7224549055099487)
(1, 1.2165002822875977)
(2, 0.14165805280208588)
(3, 0.23887167870998383)
(4, 1.642408013343811)
(5, 2.239363670349121)
(6, 0.647439181804657)
(7, 0.6164023876190186)
(8, 0.04940442368388176)
(9, 2.366478443145752)
(10, 1.2258628606796265)
(11, 1.4040149450302124)
(12, 2.1413159370422363)
(13, 1.3456015586853027)
(14, 1.814832329750061)
(15, 1.3084648847579956)
(16, 1.6361035108566284)
(17, 0.49937114119529724)
(18, 0.9645723700523376)
(19, 1.741910696029663)
(20, 1.3633426427841187)
(21, 0.36131352186203003)
(22, 1.1857632398605347)
(23, 0.34921836853027344)
(24, 0.07919434458017349)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 1.0066081285476685)
(1, 3.520749807357788)
(2, 1.430531620979309)
(3, 1.599204421043396)
(4, 0.016903430223464966)
(5, 1.84110689163208)
(6, 0.002624484244734049)
(7, 0.007127051707357168)
(8, 0.2677205502986908)
(9, 2.6304800510406494)
(10, 0.2962924540042877)
(11, 1.0110515356063843)
(12, 1.0740139484405518)
(13, 0.12763851881027222)
(14, 2.4745423793792725)
(15, 0.7329649329185486)
(16, 0.021469052881002426)
(17, 0.6801987290382385)
(18, 0.9274744391441345)
(19, 0.8975456953048706)
(20, 0.2759021520614624)
(21, 0.9051945209503174)
(22, 1.9405211210250854)
(23, 2.0288245677948)
(24, 2.191551685333252)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_2$.} 
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = {0,14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 8.040044784545898,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.438263893127441)
(1, 10.405516624450684)
(2, 7.868817329406738)
(3, 2.128018617630005)
(4, 8.779668807983398)
(5, 8.645398139953613)
(6, 8.594820022583008)
(7, 8.777828216552734)
(8, 6.255671977996826)
(9, 10.048748016357422)
(10, 7.198827743530273)
(11, 9.5841646194458)
(12, 7.208661079406738)
(13, 8.304059028625488)
(14, 10.202632904052734)
(15, 6.315699100494385)
(16, 6.4339375495910645)
(17, 8.371705055236816)
(18, 8.61743450164795)
(19, 7.284215450286865)
(20, 6.260382652282715)
(21, 7.945282936096191)
(22, 8.392928123474121)
(23, 6.899666786193848)
(24, 8.990158081054688)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 8.288246154785156)
(1, 9.725412368774414)
(2, 8.029764175415039)
(3, 3.44124174118042)
(4, 8.183714866638184)
(5, 8.746940612792969)
(6, 8.302340507507324)
(7, 7.5839738845825195)
(8, 6.313262462615967)
(9, 9.967461585998535)
(10, 7.508896827697754)
(11, 9.302006721496582)
(12, 7.600242614746094)
(13, 8.20876693725586)
(14, 8.89553165435791)
(15, 7.224247455596924)
(16, 7.066939830780029)
(17, 8.687479972839355)
(18, 8.384149551391602)
(19, 7.607227802276611)
(20, 6.657663822174072)
(21, 7.8922119140625)
(22, 8.037286758422852)
(23, 7.023384094238281)
(24, 8.982421875)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(6.2cm,0.5cm)},anchor=east
    },
    extra y ticks=10.023021697998047,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.408676147460938)
(1, 10.171907424926758)
(2, 10.440702438354492)
(3, 10.176897048950195)
(4, 10.404356002807617)
(5, 10.335577964782715)
(6, 10.168248176574707)
(7, 8.87224006652832)
(8, 10.38001537322998)
(9, 10.460114479064941)
(10, 10.307958602905273)
(11, 10.354748725891113)
(12, 10.319923400878906)
(13, 10.475723266601562)
(14, 10.41299057006836)
(15, 10.355341911315918)
(16, 8.507006645202637)
(17, 10.418435096740723)
(18, 10.311711311340332)
(19, 10.39982795715332)
(20, 9.9891357421875)
(21, 10.448709487915039)
(22, 10.380518913269043)
(23, 10.259544372558594)
(24, 10.310918807983398)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.341270446777344)
(1, 10.280899047851562)
(2, 10.399428367614746)
(3, 10.317401885986328)
(4, 10.256309509277344)
(5, 10.325502395629883)
(6, 9.697515487670898)
(7, 10.424798011779785)
(8, 10.42656135559082)
(9, 10.435155868530273)
(10, 10.476162910461426)
(11, 10.244178771972656)
(12, 10.464560508728027)
(13, 10.316765785217285)
(14, 10.360176086425781)
(15, 10.41806411743164)
(16, 10.21876335144043)
(17, 10.40883731842041)
(18, 10.445840835571289)
(19, 10.42430305480957)
(20, 10.429612159729004)
(21, 10.44119644165039)
(22, 10.396005630493164)
(23, 10.203969955444336)
(24, 10.420414924621582)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(8.95cm,0.05cm)},
    ytick = {10.0,11.0},
    yticklabels = {10.0,11.0},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=10.023021697998047,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.408676147460938)
(1, 10.171907424926758)
(2, 10.440702438354492)
(3, 10.176897048950195)
(4, 10.404356002807617)
(5, 10.335577964782715)
(6, 10.168248176574707)
(7, 8.87224006652832)
(8, 10.38001537322998)
(9, 10.460114479064941)
(10, 10.307958602905273)
(11, 10.354748725891113)
(12, 10.319923400878906)
(13, 10.475723266601562)
(14, 10.41299057006836)
(15, 10.355341911315918)
(16, 8.507006645202637)
(17, 10.418435096740723)
(18, 10.311711311340332)
(19, 10.39982795715332)
(20, 9.9891357421875)
(21, 10.448709487915039)
(22, 10.380518913269043)
(23, 10.259544372558594)
(24, 10.310918807983398)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.341270446777344)
(1, 10.280899047851562)
(2, 10.399428367614746)
(3, 10.317401885986328)
(4, 10.256309509277344)
(5, 10.325502395629883)
(6, 9.697515487670898)
(7, 10.424798011779785)
(8, 10.42656135559082)
(9, 10.435155868530273)
(10, 10.476162910461426)
(11, 10.244178771972656)
(12, 10.464560508728027)
(13, 10.316765785217285)
(14, 10.360176086425781)
(15, 10.41806411743164)
(16, 10.21876335144043)
(17, 10.40883731842041)
(18, 10.445840835571289)
(19, 10.42430305480957)
(20, 10.429612159729004)
(21, 10.44119644165039)
(22, 10.396005630493164)
(23, 10.203969955444336)
(24, 10.420414924621582)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=6.879225730895996,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 6.8510942459106445)
(1, 6.872139930725098)
(2, 6.711899757385254)
(3, 6.859182834625244)
(4, 6.852022171020508)
(5, 6.847014427185059)
(6, 6.875779151916504)
(7, 6.817490100860596)
(8, 6.78466796875)
(9, 6.771185874938965)
(10, 6.729771614074707)
(11, 6.851016044616699)
(12, 6.795907974243164)
(13, 6.840365886688232)
(14, 6.839962959289551)
(15, 6.853470325469971)
(16, 6.805996894836426)
(17, 6.83046293258667)
(18, 6.7698235511779785)
(19, 6.843040943145752)
(20, 6.759945869445801)
(21, 6.83197546005249)
(22, 6.825316905975342)
(23, 6.832942962646484)
(24, 6.817914962768555)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.892414093017578)
(1, 6.889070510864258)
(2, 6.83278751373291)
(3, 6.882359504699707)
(4, 6.895106315612793)
(5, 6.863593578338623)
(6, 6.867307662963867)
(7, 6.881536483764648)
(8, 6.887663841247559)
(9, 6.8302812576293945)
(10, 6.878680229187012)
(11, 6.882757186889648)
(12, 6.860439300537109)
(13, 6.883635997772217)
(14, 6.8733625411987305)
(15, 6.88430118560791)
(16, 6.8814287185668945)
(17, 6.876958847045898)
(18, 6.886683940887451)
(19, 6.867251396179199)
(20, 6.851116180419922)
(21, 6.853121757507324)
(22, 6.889126777648926)
(23, 6.859067916870117)
(24, 6.862488746643066)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(11.05cm,0.95cm)},
    ytick = {6.5,6.9},
    yticklabels = {6.5,6.9},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=6.879225730895996,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 6.8510942459106445)
(1, 6.872139930725098)
(2, 6.711899757385254)
(3, 6.859182834625244)
(4, 6.852022171020508)
(5, 6.847014427185059)
(6, 6.875779151916504)
(7, 6.817490100860596)
(8, 6.78466796875)
(9, 6.771185874938965)
(10, 6.729771614074707)
(11, 6.851016044616699)
(12, 6.795907974243164)
(13, 6.840365886688232)
(14, 6.839962959289551)
(15, 6.853470325469971)
(16, 6.805996894836426)
(17, 6.83046293258667)
(18, 6.7698235511779785)
(19, 6.843040943145752)
(20, 6.759945869445801)
(21, 6.83197546005249)
(22, 6.825316905975342)
(23, 6.832942962646484)
(24, 6.817914962768555)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.892414093017578)
(1, 6.889070510864258)
(2, 6.83278751373291)
(3, 6.882359504699707)
(4, 6.895106315612793)
(5, 6.863593578338623)
(6, 6.867307662963867)
(7, 6.881536483764648)
(8, 6.887663841247559)
(9, 6.8302812576293945)
(10, 6.878680229187012)
(11, 6.882757186889648)
(12, 6.860439300537109)
(13, 6.883635997772217)
(14, 6.8733625411987305)
(15, 6.88430118560791)
(16, 6.8814287185668945)
(17, 6.876958847045898)
(18, 6.886683940887451)
(19, 6.867251396179199)
(20, 6.851116180419922)
(21, 6.853121757507324)
(22, 6.889126777648926)
(23, 6.859067916870117)
(24, 6.862488746643066)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_3$.} 
\label{fig:empirical_utgt_nn3}
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = {5,15},
    yticklabels = {5, 15},
    ymajorgrids=false,
    xtick=\empty,
    ymin=5,
    ymax=15,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 14.060343742370605,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.824715614318848)
(1, 11.105923652648926)
(2, 10.785921096801758)
(3, 9.993246078491211)
(4, 11.162376403808594)
(5, 11.429617881774902)
(6, 11.917856216430664)
(7, 9.834833145141602)
(8, 9.631649017333984)
(9, 11.280407905578613)
(10, 10.852461814880371)
(11, 10.790752410888672)
(12, 11.33908462524414)
(13, 10.739892959594727)
(14, 11.092350006103516)
(15, 11.154962539672852)
(16, 11.552882194519043)
(17, 11.103935241699219)
(18, 10.914312362670898)
(19, 10.962019920349121)
(20, 9.79940128326416)
(21, 11.156378746032715)
(22, 10.680806159973145)
(23, 10.641098976135254)
(24, 10.824166297912598)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 9.813637733459473)
(1, 11.089914321899414)
(2, 10.774186134338379)
(3, 9.984872817993164)
(4, 11.146873474121094)
(5, 11.411768913269043)
(6, 11.906513214111328)
(7, 9.826188087463379)
(8, 9.621316909790039)
(9, 11.263154029846191)
(10, 10.850604057312012)
(11, 10.787985801696777)
(12, 11.32097053527832)
(13, 10.738109588623047)
(14, 11.076764106750488)
(15, 11.139993667602539)
(16, 11.537075996398926)
(17, 11.087449073791504)
(18, 10.911507606506348)
(19, 10.955739974975586)
(20, 9.791755676269531)
(21, 11.140288352966309)
(22, 10.678701400756836)
(23, 10.623371124267578)
(24, 10.810717582702637)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = {5,15},
    yticklabels = \empty,%{5,15},
    %ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=5,
    ymax=15,
    grid style=dashed,
    legend style={
    at={(4cm,0.5cm)},anchor=east
    },
    extra y ticks=6.858351707458496,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 6.8596110343933105)
(1, 6.886853218078613)
(2, 6.883481025695801)
(3, 6.865246772766113)
(4, 6.790514945983887)
(5, 6.864799976348877)
(6, 6.894890785217285)
(7, 6.8983964920043945)
(8, 6.892070770263672)
(9, 6.908289909362793)
(10, 6.8745646476745605)
(11, 6.8829121589660645)
(12, 6.89627742767334)
(13, 6.905392646789551)
(14, 6.863614082336426)
(15, 6.868432998657227)
(16, 6.877370357513428)
(17, 6.892452239990234)
(18, 6.873353958129883)
(19, 6.865558624267578)
(20, 6.824924468994141)
(21, 6.87581205368042)
(22, 6.829633712768555)
(23, 6.875161647796631)
(24, 6.873325824737549)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.862687587738037)
(1, 6.889349937438965)
(2, 6.850757598876953)
(3, 6.901056289672852)
(4, 6.903275012969971)
(5, 6.914637565612793)
(6, 6.817556381225586)
(7, 6.89860200881958)
(8, 6.8664727210998535)
(9, 6.878932476043701)
(10, 6.817824363708496)
(11, 6.812018871307373)
(12, 6.8550615310668945)
(13, 6.7910003662109375)
(14, 6.907220840454102)
(15, 6.908996105194092)
(16, 6.768148899078369)
(17, 6.881659507751465)
(18, 6.834049701690674)
(19, 6.9122748374938965)
(20, 6.91346549987793)
(21, 6.912229537963867)
(22, 6.816462516784668)
(23, 6.587085247039795)
(24, 6.849501609802246)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(9.0cm,0.9cm)},
    ytick = {6.5,6.9},
    yticklabels = {6.5,6.9},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=6.858351707458496,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 6.8596110343933105)
(1, 6.886853218078613)
(2, 6.883481025695801)
(3, 6.865246772766113)
(4, 6.790514945983887)
(5, 6.864799976348877)
(6, 6.894890785217285)
(7, 6.8983964920043945)
(8, 6.892070770263672)
(9, 6.908289909362793)
(10, 6.8745646476745605)
(11, 6.8829121589660645)
(12, 6.89627742767334)
(13, 6.905392646789551)
(14, 6.863614082336426)
(15, 6.868432998657227)
(16, 6.877370357513428)
(17, 6.892452239990234)
(18, 6.873353958129883)
(19, 6.865558624267578)
(20, 6.824924468994141)
(21, 6.87581205368042)
(22, 6.829633712768555)
(23, 6.875161647796631)
(24, 6.873325824737549)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.862687587738037)
(1, 6.889349937438965)
(2, 6.850757598876953)
(3, 6.901056289672852)
(4, 6.903275012969971)
(5, 6.914637565612793)
(6, 6.817556381225586)
(7, 6.89860200881958)
(8, 6.8664727210998535)
(9, 6.878932476043701)
(10, 6.817824363708496)
(11, 6.812018871307373)
(12, 6.8550615310668945)
(13, 6.7910003662109375)
(14, 6.907220840454102)
(15, 6.908996105194092)
(16, 6.768148899078369)
(17, 6.881659507751465)
(18, 6.834049701690674)
(19, 6.9122748374938965)
(20, 6.91346549987793)
(21, 6.912229537963867)
(22, 6.816462516784668)
(23, 6.587085247039795)
(24, 6.849501609802246)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_4$.} 
\label{fig:empirical_utgt_nn4}
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = {7,11},
    yticklabels = {7,11},
    ymajorgrids=false,
    xtick=\empty,
    ymin=7,
    ymax=11,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 10.943835258483887,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.734979629516602)
(1, 10.382562637329102)
(2, 10.564789772033691)
(3, 10.738225936889648)
(4, 10.434507369995117)
(5, 10.543071746826172)
(6, 8.923253059387207)
(7, 10.6295804977417)
(8, 10.287701606750488)
(9, 10.58686637878418)
(10, 10.649388313293457)
(11, 10.70146369934082)
(12, 10.379204750061035)
(13, 9.996538162231445)
(14, 10.416532516479492)
(15, 10.560888290405273)
(16, 8.47727108001709)
(17, 10.319951057434082)
(18, 10.303988456726074)
(19, 10.45668888092041)
(20, 10.860973358154297)
(21, 10.62215805053711)
(22, 10.687220573425293)
(23, 10.64853286743164)
(24, 10.512742042541504)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.787840843200684)
(1, 10.461752891540527)
(2, 10.61246395111084)
(3, 10.787421226501465)
(4, 10.53917407989502)
(5, 10.617975234985352)
(6, 8.663002967834473)
(7, 10.683815002441406)
(8, 10.412614822387695)
(9, 10.613369941711426)
(10, 10.714336395263672)
(11, 10.747812271118164)
(12, 10.43189525604248)
(13, 10.1251802444458)
(14, 10.528521537780762)
(15, 10.63736629486084)
(16, 8.58328914642334)
(17, 10.423001289367676)
(18, 10.372313499450684)
(19, 10.528709411621094)
(20, 10.893020629882812)
(21, 10.677753448486328)
(22, 10.741236686706543)
(23, 10.70193862915039)
(24, 10.564319610595703)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = {7,11},
    yticklabels = \empty,%{7,11},
    ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=7,
    ymax=11,
    grid style=dashed,
    legend style={
    at={(4cm,0.5cm)},anchor=east
    },
    extra y ticks=8.295890808105469,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 8.316895484924316)
(1, 8.317145347595215)
(2, 8.316730499267578)
(3, 8.316883087158203)
(4, 8.317146301269531)
(5, 8.31683349609375)
(6, 8.316659927368164)
(7, 8.316459655761719)
(8, 8.316681861877441)
(9, 8.31654167175293)
(10, 8.316946029663086)
(11, 8.317152976989746)
(12, 8.316917419433594)
(13, 8.31689453125)
(14, 8.317310333251953)
(15, 8.317134857177734)
(16, 8.317100524902344)
(17, 8.316938400268555)
(18, 8.316190719604492)
(19, 8.316987037658691)
(20, 8.317007064819336)
(21, 8.316699981689453)
(22, 8.317212104797363)
(23, 8.317033767700195)
(24, 8.316851615905762)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 8.306447982788086)
(1, 8.310416221618652)
(2, 8.312663078308105)
(3, 8.308309555053711)
(4, 8.307586669921875)
(5, 8.308930397033691)
(6, 8.308777809143066)
(7, 8.313998222351074)
(8, 8.3100004196167)
(9, 8.313798904418945)
(10, 8.308215141296387)
(11, 8.307523727416992)
(12, 8.312690734863281)
(13, 8.31283950805664)
(14, 8.308717727661133)
(15, 8.307939529418945)
(16, 8.313847541809082)
(17, 8.310497283935547)
(18, 8.31432056427002)
(19, 8.308674812316895)
(20, 8.305264472961426)
(21, 8.31137466430664)
(22, 8.3092622756958)
(23, 8.310301780700684)
(24, 8.313822746276855)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot5.1,
    at={(9.0cm,0.9cm)},
    ytick = {8.1,8.4},
    yticklabels = {8.1,8.4},
    ymajorgrids=false,
    xtick=\empty,
    ymin=8.1,
    ymax=8.4,
    %ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=8.295890808105469,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0,8.31)
(1,8.31)
(2,8.31)
(3,8.31)
(4,8.31)
(5,8.31)
(6,8.31)
(7,8.31)
(8,8.31)
(9,8.31)
(10,8.31)
(11,8.31)
(12,8.31)
(13,8.31)
(14,8.31)
(15,8.31)
(16,8.31)
(17,8.31)
(18,8.31)
(19,8.31)
(20,8.31)
(21,8.31)
(22,8.31)
(23,8.31)
(24,8.31)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0,8.30)
(1,8.31)
(2,8.31)
(3,8.30)
(4,8.30)
(5,8.30)
(6,8.30)
(7,8.31)
(8,8.31)
(9,8.31)
(10,8.30)
(11,8.30)
(12,8.31)
(13,8.31)
(14,8.30)
(15,8.30)
(16,8.31)
(17,8.31)
(18,8.31)
(19,8.30)
(20,8.30)
(21,8.31)
(22,8.30)
(23,8.31)
(24,8.31)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_5$.} 
\label{fig:empirical_utgt_nn5}
\end{figure*}

\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=9.648681640625,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.610564231872559)
(1, 9.658138275146484)
(2, 9.669536590576172)
(3, 9.671218872070312)
(4, 9.664495468139648)
(5, 9.656429290771484)
(6, 9.629059791564941)
(7, 9.668523788452148)
(8, 9.637401580810547)
(9, 9.610116958618164)
(10, 9.621978759765625)
(11, 9.66270637512207)
(12, 9.617490768432617)
(13, 9.65418529510498)
(14, 9.648590087890625)
(15, 9.58336067199707)
(16, 9.658035278320312)
(17, 9.666720390319824)
(18, 9.657707214355469)
(19, 9.665380477905273)
(20, 9.64999008178711)
(21, 9.66574478149414)
(22, 9.615581512451172)
(23, 9.650548934936523)
(24, 9.648921012878418)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 9.601312637329102)
(1, 9.635274887084961)
(2, 9.642330169677734)
(3, 9.644977569580078)
(4, 9.641996383666992)
(5, 9.63427734375)
(6, 9.614288330078125)
(7, 9.64643669128418)
(8, 9.619590759277344)
(9, 9.599586486816406)
(10, 9.608733177185059)
(11, 9.641777038574219)
(12, 9.602936744689941)
(13, 9.629589080810547)
(14, 9.631834030151367)
(15, 9.566041946411133)
(16, 9.637154579162598)
(17, 9.641058921813965)
(18, 9.63325309753418)
(19, 9.642984390258789)
(20, 9.63060188293457)
(21, 9.640979766845703)
(22, 9.592361450195312)
(23, 9.628135681152344)
(24, 9.62877082824707)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot1.1,
    at={(0.8cm,0.05cm)},
    %title={Shallow Layer 1},
    ylabel=\empty,%{Layer-wise Entropy},
    ytick = {11.9,12,12.1},
    yticklabels = {11.90,12.00,12.10},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=9.648681640625,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]
   
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.610564231872559)
(1, 9.658138275146484)
(2, 9.669536590576172)
(3, 9.671218872070312)
(4, 9.664495468139648)
(5, 9.656429290771484)
(6, 9.629059791564941)
(7, 9.668523788452148)
(8, 9.637401580810547)
(9, 9.610116958618164)
(10, 9.621978759765625)
(11, 9.66270637512207)
(12, 9.617490768432617)
(13, 9.65418529510498)
(14, 9.648590087890625)
(15, 9.58336067199707)
(16, 9.658035278320312)
(17, 9.666720390319824)
(18, 9.657707214355469)
(19, 9.665380477905273)
(20, 9.64999008178711)
(21, 9.66574478149414)
(22, 9.615581512451172)
(23, 9.650548934936523)
(24, 9.648921012878418)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 9.601312637329102)
(1, 9.635274887084961)
(2, 9.642330169677734)
(3, 9.644977569580078)
(4, 9.641996383666992)
(5, 9.63427734375)
(6, 9.614288330078125)
(7, 9.64643669128418)
(8, 9.619590759277344)
(9, 9.599586486816406)
(10, 9.608733177185059)
(11, 9.641777038574219)
(12, 9.602936744689941)
(13, 9.629589080810547)
(14, 9.631834030151367)
(15, 9.566041946411133)
(16, 9.637154579162598)
(17, 9.641058921813965)
(18, 9.63325309753418)
(19, 9.642984390258789)
(20, 9.63060188293457)
(21, 9.640979766845703)
(22, 9.592361450195312)
(23, 9.628135681152344)
(24, 9.62877082824707)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=11.061911582946777,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 11.062158584594727)
(1, 11.078899383544922)
(2, 11.079195022583008)
(3, 11.077474594116211)
(4, 11.073808670043945)
(5, 11.07766342163086)
(6, 11.067209243774414)
(7, 11.076473236083984)
(8, 11.07624626159668)
(9, 11.064900398254395)
(10, 11.059657096862793)
(11, 11.071760177612305)
(12, 11.066896438598633)
(13, 11.07314395904541)
(14, 11.071676254272461)
(15, 11.062517166137695)
(16, 11.07392692565918)
(17, 11.079872131347656)
(18, 11.072929382324219)
(19, 11.07515811920166)
(20, 11.071662902832031)
(21, 11.079925537109375)
(22, 11.074468612670898)
(23, 11.078438758850098)
(24, 11.077263832092285)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 11.060368537902832)
(1, 11.066719055175781)
(2, 11.063892364501953)
(3, 11.067863464355469)
(4, 11.066643714904785)
(5, 11.065778732299805)
(6, 11.064098358154297)
(7, 11.069926261901855)
(8, 11.060203552246094)
(9, 11.060148239135742)
(10, 11.057735443115234)
(11, 11.06618595123291)
(12, 11.062256813049316)
(13, 11.06603717803955)
(14, 11.067825317382812)
(15, 11.059324264526367)
(16, 11.06865406036377)
(17, 11.066537857055664)
(18, 11.064299583435059)
(19, 11.067852020263672)
(20, 11.067028045654297)
(21, 11.065969467163086)
(22, 11.062898635864258)
(23, 11.064518928527832)
(24, 11.0648775100708)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot2.1,
    at={(2.85cm,0.05cm)},
    %title={Shallow Layer 2},
    ytick = {13.57,13.58},
    yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=11.061911582946777,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 11.062158584594727)
(1, 11.078899383544922)
(2, 11.079195022583008)
(3, 11.077474594116211)
(4, 11.073808670043945)
(5, 11.07766342163086)
(6, 11.067209243774414)
(7, 11.076473236083984)
(8, 11.07624626159668)
(9, 11.064900398254395)
(10, 11.059657096862793)
(11, 11.071760177612305)
(12, 11.066896438598633)
(13, 11.07314395904541)
(14, 11.071676254272461)
(15, 11.062517166137695)
(16, 11.07392692565918)
(17, 11.079872131347656)
(18, 11.072929382324219)
(19, 11.07515811920166)
(20, 11.071662902832031)
(21, 11.079925537109375)
(22, 11.074468612670898)
(23, 11.078438758850098)
(24, 11.077263832092285)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 11.060368537902832)
(1, 11.066719055175781)
(2, 11.063892364501953)
(3, 11.067863464355469)
(4, 11.066643714904785)
(5, 11.065778732299805)
(6, 11.064098358154297)
(7, 11.069926261901855)
(8, 11.060203552246094)
(9, 11.060148239135742)
(10, 11.057735443115234)
(11, 11.06618595123291)
(12, 11.062256813049316)
(13, 11.06603717803955)
(14, 11.067825317382812)
(15, 11.059324264526367)
(16, 11.06865406036377)
(17, 11.066537857055664)
(18, 11.064299583435059)
(19, 11.067852020263672)
(20, 11.067028045654297)
(21, 11.065969467163086)
(22, 11.062898635864258)
(23, 11.064518928527832)
(24, 11.0648775100708)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=10.338950157165527,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.379124641418457)
(1, 10.385766983032227)
(2, 10.38797378540039)
(3, 10.386529922485352)
(4, 10.377012252807617)
(5, 10.381356239318848)
(6, 10.378708839416504)
(7, 10.384000778198242)
(8, 10.384461402893066)
(9, 10.373178482055664)
(10, 10.37285041809082)
(11, 10.377606391906738)
(12, 10.376880645751953)
(13, 10.380887985229492)
(14, 10.382186889648438)
(15, 10.379125595092773)
(16, 10.379344940185547)
(17, 10.38742446899414)
(18, 10.383044242858887)
(19, 10.383124351501465)
(20, 10.380050659179688)
(21, 10.387870788574219)
(22, 10.385810852050781)
(23, 10.3858642578125)
(24, 10.383613586425781)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.37289047241211)
(1, 10.358280181884766)
(2, 10.345497131347656)
(3, 10.357215881347656)
(4, 10.356678009033203)
(5, 10.359453201293945)
(6, 10.371192932128906)
(7, 10.368158340454102)
(8, 10.355531692504883)
(9, 10.358388900756836)
(10, 10.351400375366211)
(11, 10.359909057617188)
(12, 10.361100196838379)
(13, 10.361310005187988)
(14, 10.374862670898438)
(15, 10.375066757202148)
(16, 10.36588191986084)
(17, 10.356898307800293)
(18, 10.364326477050781)
(19, 10.362797737121582)
(20, 10.37071704864502)
(21, 10.353320121765137)
(22, 10.363056182861328)
(23, 10.357063293457031)
(24, 10.360899925231934)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(4.9cm,0.05cm)},
    %title={Middle Layer 1},
    ytick = {12.88,12.89},
    yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=10.338950157165527,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.379124641418457)
(1, 10.385766983032227)
(2, 10.38797378540039)
(3, 10.386529922485352)
(4, 10.377012252807617)
(5, 10.381356239318848)
(6, 10.378708839416504)
(7, 10.384000778198242)
(8, 10.384461402893066)
(9, 10.373178482055664)
(10, 10.37285041809082)
(11, 10.377606391906738)
(12, 10.376880645751953)
(13, 10.380887985229492)
(14, 10.382186889648438)
(15, 10.379125595092773)
(16, 10.379344940185547)
(17, 10.38742446899414)
(18, 10.383044242858887)
(19, 10.383124351501465)
(20, 10.380050659179688)
(21, 10.387870788574219)
(22, 10.385810852050781)
(23, 10.3858642578125)
(24, 10.383613586425781)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.37289047241211)
(1, 10.358280181884766)
(2, 10.345497131347656)
(3, 10.357215881347656)
(4, 10.356678009033203)
(5, 10.359453201293945)
(6, 10.371192932128906)
(7, 10.368158340454102)
(8, 10.355531692504883)
(9, 10.358388900756836)
(10, 10.351400375366211)
(11, 10.359909057617188)
(12, 10.361100196838379)
(13, 10.361310005187988)
(14, 10.374862670898438)
(15, 10.375066757202148)
(16, 10.36588191986084)
(17, 10.356898307800293)
(18, 10.364326477050781)
(19, 10.362797737121582)
(20, 10.37071704864502)
(21, 10.353320121765137)
(22, 10.363056182861328)
(23, 10.357063293457031)
(24, 10.360899925231934)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks= 9.689517974853516,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.698715209960938)
(1, 9.700404167175293)
(2, 9.646891593933105)
(3, 9.701167106628418)
(4, 9.697336196899414)
(5, 9.699209213256836)
(6, 9.699379920959473)
(7, 9.700119972229004)
(8, 9.662688255310059)
(9, 9.695199966430664)
(10, 9.696374893188477)
(11, 9.697912216186523)
(12, 9.697759628295898)
(13, 9.699021339416504)
(14, 9.700081825256348)
(15, 9.69982624053955)
(16, 9.6993408203125)
(17, 9.701438903808594)
(18, 9.699872970581055)
(19, 9.699460983276367)
(20, 9.699441909790039)
(21, 9.701179504394531)
(22, 9.701261520385742)
(23, 9.700523376464844)
(24, 9.700517654418945)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 9.697293281555176)
(1, 9.69061279296875)
(2, 9.689752578735352)
(3, 9.69477653503418)
(4, 9.693479537963867)
(5, 9.691665649414062)
(6, 9.698264122009277)
(7, 9.696483612060547)
(8, 9.684672355651855)
(9, 9.691917419433594)
(10, 9.693120956420898)
(11, 9.69558334350586)
(12, 9.695684432983398)
(13, 9.693428039550781)
(14, 9.698895454406738)
(15, 9.6998291015625)
(16, 9.695856094360352)
(17, 9.691614151000977)
(18, 9.695331573486328)
(19, 9.696118354797363)
(20, 9.697412490844727)
(21, 9.690507888793945)
(22, 9.693788528442383)
(23, 9.689474105834961)
(24, 9.68804931640625)

        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot4.1,
    at={(6.95cm,0.05cm)},
    %title={Middle Layer 2},
    %ylabel={Layer-wise Entropy},
    ytick = {12.20,12.2035},
    yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=9.689517974853516,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 9.698715209960938)
(1, 9.700404167175293)
(2, 9.646891593933105)
(3, 9.701167106628418)
(4, 9.697336196899414)
(5, 9.699209213256836)
(6, 9.699379920959473)
(7, 9.700119972229004)
(8, 9.662688255310059)
(9, 9.695199966430664)
(10, 9.696374893188477)
(11, 9.697912216186523)
(12, 9.697759628295898)
(13, 9.699021339416504)
(14, 9.700081825256348)
(15, 9.69982624053955)
(16, 9.6993408203125)
(17, 9.701438903808594)
(18, 9.699872970581055)
(19, 9.699460983276367)
(20, 9.699441909790039)
(21, 9.701179504394531)
(22, 9.701261520385742)
(23, 9.700523376464844)
(24, 9.700517654418945)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 9.697293281555176)
(1, 9.69061279296875)
(2, 9.689752578735352)
(3, 9.69477653503418)
(4, 9.693479537963867)
(5, 9.691665649414062)
(6, 9.698264122009277)
(7, 9.696483612060547)
(8, 9.684672355651855)
(9, 9.691917419433594)
(10, 9.693120956420898)
(11, 9.69558334350586)
(12, 9.695684432983398)
(13, 9.693428039550781)
(14, 9.698895454406738)
(15, 9.6998291015625)
(16, 9.695856094360352)
(17, 9.691614151000977)
(18, 9.695331573486328)
(19, 9.696118354797363)
(20, 9.697412490844727)
(21, 9.690507888793945)
(22, 9.693788528442383)
(23, 9.689474105834961)
(24, 9.68804931640625)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks= 0.15711510181427002,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 8.278047561645508)
(1, 7.920757293701172)
(2, 3.0178370475769043)
(3, 8.937971115112305)
(4, 2.755767345428467)
(5, 8.197025299072266)
(6, 7.441281795501709)
(7, 8.072694778442383)
(8, 3.0699918270111084)
(9, 0.35734790563583374)
(10, 8.551382064819336)
(11, 8.475410461425781)
(12, 7.260436058044434)
(13, 8.305450439453125)
(14, 8.22323989868164)
(15, 8.161375045776367)
(16, 8.072622299194336)
(17, 8.863349914550781)
(18, 8.764623641967773)
(19, 8.318140029907227)
(20, 7.4110565185546875)
(21, 8.849773406982422)
(22, 8.711066246032715)
(23, 8.597258567810059)
(24, 8.223344802856445)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 8.027488708496094)
(1, 0.07120906561613083)
(2, 0.08510349690914154)
(3, 2.752798318862915)
(4, 2.9093942642211914)
(5, 0.7836121916770935)
(6, 8.249792098999023)
(7, 1.5929369926452637)
(8, 1.3038604259490967)
(9, 2.3067569732666016)
(10, 7.526969909667969)
(11, 5.209532737731934)
(12, 5.4853363037109375)
(13, 1.4385195970535278)
(14, 8.076560020446777)
(15, 7.526118278503418)
(16, 5.916182518005371)
(17, 0.09041450917720795)
(18, 1.0588841438293457)
(19, 4.477173328399658)
(20, 8.426161766052246)
(21, 0.04285077005624771)
(22, 0.7743319272994995)
(23, 0.09830261021852493)
(24, 0.876879096031189)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=5.186860107642133e-06,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.08030891418457)
(1, 6.952937126159668)
(2, 6.424046039581299)
(3, 7.575075149536133)
(4, 1.4307770729064941)
(5, 6.928340435028076)
(6, 6.253253936767578)
(7, 6.83005428314209)
(8, 7.094915390014648)
(9, 0.673077404499054)
(10, 7.344882965087891)
(11, 7.304251670837402)
(12, 6.634600639343262)
(13, 7.101561546325684)
(14, 6.9745988845825195)
(15, 6.952295780181885)
(16, 6.821058750152588)
(17, 7.517764091491699)
(18, 7.4421000480651855)
(19, 7.041332244873047)
(20, 6.178618431091309)
(21, 7.51237678527832)
(22, 7.428438186645508)
(23, 7.406214237213135)
(24, 6.926644325256348)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 6.828527927398682)
(1, 2.9951546821394004e-05)
(2, 3.3329106940982456e-07)
(3, 2.07148814201355)
(4, 1.5376527309417725)
(5, 0.0772615596652031)
(6, 7.016010284423828)
(7, 0.7113650441169739)
(8, 0.6737414598464966)
(9, 1.4462542533874512)
(10, 6.861576080322266)
(11, 4.264784812927246)
(12, 4.335142135620117)
(13, 0.8282368183135986)
(14, 6.825166702270508)
(15, 6.456838607788086)
(16, 6.0470781326293945)
(17, 0.03771279379725456)
(18, 0.4161736071109772)
(19, 4.673862457275391)
(20, 7.242884159088135)
(21, 0.11567458510398865)
(22, 0.005870676599442959)
(23, 2.748878458191939e-08)
(24, 0.015237109735608101)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_6$.} 
\label{fig:empirical_utgt_nn6}
\end{figure*}


\begin{figure}[t]
\centering
\resizebox{\textwidth}{!}
{
\begin{tabular}{cccccc}

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    ytick={1,2,3},
    yticklabels={Clean, Before, After},
    yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_1$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=5.48,
        lower quartile=7.00,
        median=7.28,
        upper quartile=7.40,
        upper whisker=7.54,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=6.79,
        lower quartile=7.31,
        median=7.36,
        upper quartile=7.40,
        upper whisker=7.48,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=6.78,
        lower quartile=7.39,
        median=7.46,
        upper quartile=7.49,
        upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_2$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=0.42,
        lower quartile=6.29,
        median=7.36,
        upper quartile=7.80,
        upper whisker=8.17,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=3.84,
        lower quartile=6.93,
        median=7.62,
        upper quartile=7.92,
        upper whisker=8.21,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=8.25,
        lower quartile=8.28,
        median=8.29,
        upper quartile=8.29,
        upper whisker=8.30,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_3$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=6.71,
        lower quartile=6.79,
        median=6.83,
        upper quartile=6.85,
        upper whisker=6.88,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=6.79,
        lower quartile=6.86,
        median=6.88,
        upper quartile=6.88,
        upper whisker=6.90,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=6.69,
        lower quartile=6.81,
        median=6.85,
        upper quartile=6.86,
        upper whisker=6.89,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_4$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=6.79,
        lower quartile=6.87,
        median=6.88,
        upper quartile=6.90,
        upper whisker=6.91,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=6.59,
        lower quartile=6.83,
        median=6.87,
        upper quartile=6.90,
        upper whisker=6.91,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=6.88,
        lower quartile=6.90,
        median=6.91,
        upper quartile=6.92,
        upper whisker=6.92,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}
&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_5$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=8.32,
        lower quartile=8.32,
        median=8.32,
        upper quartile=8.32,
        upper whisker=8.32,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=8.31,
        lower quartile=8.31,
        median=8.31,
        upper quartile=8.31,
        upper whisker=8.31,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=8.31,
        lower quartile=8.31,
        median=8.32,
        upper quartile=8.32,
        upper whisker=8.32, 
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}
&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$NN_6$},
    ]

    \addplot+[
    boxplot prepared={    
        lower whisker=0.00,
        lower quartile=6.10,
        median=6.89,
        upper quartile=7.26,
        upper whisker=7.58,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
        lower whisker=0.00,
        lower quartile=0.17,
        median=2.92,
        upper quartile=5.78,
        upper whisker=7.42,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
        lower whisker=5.33,
        lower quartile=7.41,
        median=7.56,
        upper quartile=7.59,
        upper whisker=7.61,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

\\
%\centering
%\begin{minipage}{0.47\textwidth} % choose width suitably
%\includegraphics[width=\linewidth]{mygraphicfile}
%{Fx denoting feature x. Nx\_y represents neuron y at hidden layer x.\par} %In this experiment $\epsilon = 0.01, \delta = 0.001$.
%\end{minipage}
\end{tabular}
}
\caption{Change in layer-wise entropy of non-targeted UAP attack defense: Deep layer} 
\label{fig:box_utgt}
\end{figure}

%\subsection{Other UAPs}

%sPGD
\begin{figure*}[t]
\centering
\begin{tikzpicture}
\pgfplotsset{every tick label/.append style={font=\tiny}}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot1,
    xlabel={Shallow Layer 1},
    xlabel near ticks,
    font=\tiny,
    ylabel={Layer-wise Entropy},
    ylabel near ticks,
    ytick = {0, 14},
    yticklabels = {0, 14},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.18,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.132645606994629)
(1, 12.132169723510742)
(2, 12.119187355041504)
(3, 12.15030574798584)
(4, 12.156091690063477)
(5, 12.141684532165527)
(6, 12.118185043334961)
(7, 12.129878044128418)
(8, 12.085209846496582)
(9, 12.128399848937988)
(10, 12.135781288146973)
(11, 12.137386322021484)
(12, 12.116486549377441)
(13, 12.090312957763672)
(14, 12.147895812988281)
(15, 12.105506896972656)
(16, 12.112274169921875)
(17, 12.115019798278809)
(18, 12.074466705322266)
(19, 12.137069702148438)
(20, 12.119229316711426)
(21, 12.143909454345703)
(22, 12.104930877685547)
(23, 12.023744583129883)
(24, 12.137703895568848)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.13260555267334)
(1, 12.137290954589844)
(2, 12.117834091186523)
(3, 12.152572631835938)
(4, 12.155682563781738)
(5, 12.143834114074707)
(6, 12.12007999420166)
(7, 12.132637023925781)
(8, 12.086004257202148)
(9, 12.132369995117188)
(10, 12.138467788696289)
(11, 12.13921070098877)
(12, 12.118346214294434)
(13, 12.0972900390625)
(14, 12.149940490722656)
(15, 12.110660552978516)
(16, 12.113204002380371)
(17, 12.118898391723633)
(18, 12.079268455505371)
(19, 12.140656471252441)
(20, 12.122119903564453)
(21, 12.144856452941895)
(22, 12.102767944335938)
(23, 12.026172637939453)
(24, 12.141329765319824)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot1.1,
    at={(0.8cm,0.05cm)},
    %title={Shallow Layer 1},
    ylabel=\empty,%{Layer-wise Entropy},
    ytick = {11.9,12,12.1},
    yticklabels = {11.90,12.00,12.10},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.18,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]
   
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.132645606994629)
(1, 12.132169723510742)
(2, 12.119187355041504)
(3, 12.15030574798584)
(4, 12.156091690063477)
(5, 12.141684532165527)
(6, 12.118185043334961)
(7, 12.129878044128418)
(8, 12.085209846496582)
(9, 12.128399848937988)
(10, 12.135781288146973)
(11, 12.137386322021484)
(12, 12.116486549377441)
(13, 12.090312957763672)
(14, 12.147895812988281)
(15, 12.105506896972656)
(16, 12.112274169921875)
(17, 12.115019798278809)
(18, 12.074466705322266)
(19, 12.137069702148438)
(20, 12.119229316711426)
(21, 12.143909454345703)
(22, 12.104930877685547)
(23, 12.023744583129883)
(24, 12.137703895568848)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.13260555267334)
(1, 12.137290954589844)
(2, 12.117834091186523)
(3, 12.152572631835938)
(4, 12.155682563781738)
(5, 12.143834114074707)
(6, 12.12007999420166)
(7, 12.132637023925781)
(8, 12.086004257202148)
(9, 12.132369995117188)
(10, 12.138467788696289)
(11, 12.13921070098877)
(12, 12.118346214294434)
(13, 12.0972900390625)
(14, 12.149940490722656)
(15, 12.110660552978516)
(16, 12.113204002380371)
(17, 12.118898391723633)
(18, 12.079268455505371)
(19, 12.140656471252441)
(20, 12.122119903564453)
(21, 12.144856452941895)
(22, 12.102767944335938)
(23, 12.026172637939453)
(24, 12.141329765319824)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot2,
    at={(plot1.south east)},
    xlabel={Shallow Layer 2},
    xlabel near ticks,
    font=\tiny,
    ytick = \empty, %{13.57,13.58},
    %yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=13.58,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 13.575243949890137)
(1, 13.579079627990723)
(2, 13.576433181762695)
(3, 13.581716537475586)
(4, 13.580144882202148)
(5, 13.574682235717773)
(6, 13.576072692871094)
(7, 13.574684143066406)
(8, 13.569478034973145)
(9, 13.577945709228516)
(10, 13.577411651611328)
(11, 13.577378273010254)
(12, 13.575383186340332)
(13, 13.571810722351074)
(14, 13.579093933105469)
(15, 13.576925277709961)
(16, 13.572620391845703)
(17, 13.573322296142578)
(18, 13.570365905761719)
(19, 13.57905101776123)
(20, 13.57974910736084)
(21, 13.578722953796387)
(22, 13.573071479797363)
(23, 13.569568634033203)
(24, 13.578734397888184)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 13.574991226196289)
(1, 13.5770263671875)
(2, 13.575735092163086)
(3, 13.578039169311523)
(4, 13.579242706298828)
(5, 13.574930191040039)
(6, 13.575155258178711)
(7, 13.574862480163574)
(8, 13.569693565368652)
(9, 13.575899124145508)
(10, 13.575477600097656)
(11, 13.576225280761719)
(12, 13.574045181274414)
(13, 13.570698738098145)
(14, 13.577792167663574)
(15, 13.57514476776123)
(16, 13.572091102600098)
(17, 13.5736083984375)
(18, 13.570648193359375)
(19, 13.577306747436523)
(20, 13.577139854431152)
(21, 13.577722549438477)
(22, 13.573037147521973)
(23, 13.568209648132324)
(24, 13.577354431152344)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot2.1,
    at={(2.85cm,0.05cm)},
    %title={Shallow Layer 2},
    ytick = {13.57,13.58},
    yticklabels = {13.57,13.58},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=13.58,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 13.575243949890137)
(1, 13.579079627990723)
(2, 13.576433181762695)
(3, 13.581716537475586)
(4, 13.580144882202148)
(5, 13.574682235717773)
(6, 13.576072692871094)
(7, 13.574684143066406)
(8, 13.569478034973145)
(9, 13.577945709228516)
(10, 13.577411651611328)
(11, 13.577378273010254)
(12, 13.575383186340332)
(13, 13.571810722351074)
(14, 13.579093933105469)
(15, 13.576925277709961)
(16, 13.572620391845703)
(17, 13.573322296142578)
(18, 13.570365905761719)
(19, 13.57905101776123)
(20, 13.57974910736084)
(21, 13.578722953796387)
(22, 13.573071479797363)
(23, 13.569568634033203)
(24, 13.578734397888184)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 13.574991226196289)
(1, 13.5770263671875)
(2, 13.575735092163086)
(3, 13.578039169311523)
(4, 13.579242706298828)
(5, 13.574930191040039)
(6, 13.575155258178711)
(7, 13.574862480163574)
(8, 13.569693565368652)
(9, 13.575899124145508)
(10, 13.575477600097656)
(11, 13.576225280761719)
(12, 13.574045181274414)
(13, 13.570698738098145)
(14, 13.577792167663574)
(15, 13.57514476776123)
(16, 13.572091102600098)
(17, 13.5736083984375)
(18, 13.570648193359375)
(19, 13.577306747436523)
(20, 13.577139854431152)
(21, 13.577722549438477)
(22, 13.573037147521973)
(23, 13.568209648132324)
(24, 13.577354431152344)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot3,
    at={(plot2.south east)},
    font=\tiny,
    xlabel={Middle Layer 1},
    xlabel near ticks,
    ytick = \empty, %{12.88,12.89},
    %yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.8859,
        % ... don't show any label and ...
        extra y tick labels=\empty,%{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.882184028625488)
(1, 12.884977340698242)
(2, 12.886763572692871)
(3, 12.885274887084961)
(4, 12.887182235717773)
(5, 12.880290031433105)
(6, 12.884208679199219)
(7, 12.882586479187012)
(8, 12.877588272094727)
(9, 12.885100364685059)
(10, 12.883172035217285)
(11, 12.884334564208984)
(12, 12.884919166564941)
(13, 12.881420135498047)
(14, 12.884645462036133)
(15, 12.883329391479492)
(16, 12.880126953125)
(17, 12.882589340209961)
(18, 12.881421089172363)
(19, 12.886670112609863)
(20, 12.887273788452148)
(21, 12.885767936706543)
(22, 12.885605812072754)
(23, 12.886465072631836)
(24, 12.886938095092773)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.882957458496094)
(1, 12.881203651428223)
(2, 12.885610580444336)
(3, 12.879969596862793)
(4, 12.885259628295898)
(5, 12.881023406982422)
(6, 12.883336067199707)
(7, 12.88175106048584)
(8, 12.878288269042969)
(9, 12.883577346801758)
(10, 12.881067276000977)
(11, 12.884013175964355)
(12, 12.882131576538086)
(13, 12.877419471740723)
(14, 12.88335132598877)
(15, 12.878937721252441)
(16, 12.881336212158203)
(17, 12.881791114807129)
(18, 12.880448341369629)
(19, 12.884323120117188)
(20, 12.883219718933105)
(21, 12.88489055633545)
(22, 12.885761260986328)
(23, 12.885456085205078)
(24, 12.88403034210205)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot3.1,
    at={(4.9cm,0.05cm)},
    %title={Middle Layer 1},
    ytick = {12.88,12.89},
    yticklabels = {12.88,12.89},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    extra y ticks=12.8859,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.882184028625488)
(1, 12.884977340698242)
(2, 12.886763572692871)
(3, 12.885274887084961)
(4, 12.887182235717773)
(5, 12.880290031433105)
(6, 12.884208679199219)
(7, 12.882586479187012)
(8, 12.877588272094727)
(9, 12.885100364685059)
(10, 12.883172035217285)
(11, 12.884334564208984)
(12, 12.884919166564941)
(13, 12.881420135498047)
(14, 12.884645462036133)
(15, 12.883329391479492)
(16, 12.880126953125)
(17, 12.882589340209961)
(18, 12.881421089172363)
(19, 12.886670112609863)
(20, 12.887273788452148)
(21, 12.885767936706543)
(22, 12.885605812072754)
(23, 12.886465072631836)
(24, 12.886938095092773)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.882957458496094)
(1, 12.881203651428223)
(2, 12.885610580444336)
(3, 12.879969596862793)
(4, 12.885259628295898)
(5, 12.881023406982422)
(6, 12.883336067199707)
(7, 12.88175106048584)
(8, 12.878288269042969)
(9, 12.883577346801758)
(10, 12.881067276000977)
(11, 12.884013175964355)
(12, 12.882131576538086)
(13, 12.877419471740723)
(14, 12.88335132598877)
(15, 12.878937721252441)
(16, 12.881336212158203)
(17, 12.881791114807129)
(18, 12.880448341369629)
(19, 12.884323120117188)
(20, 12.883219718933105)
(21, 12.88489055633545)
(22, 12.885761260986328)
(23, 12.885456085205078)
(24, 12.88403034210205)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot4,
    at={(plot3.south east)},
    font=\tiny,
    xlabel={Middle Layer 2},
    xlabel near ticks,
    %ylabel={Layer-wise Entropy},
    ytick = \empty, %{12.20,12.2035},
    %yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.201,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.20175838470459)
(1, 12.200848579406738)
(2, 12.203475952148438)
(3, 12.202248573303223)
(4, 12.203421592712402)
(5, 12.203023910522461)
(6, 12.20170783996582)
(7, 12.201428413391113)
(8, 12.19926643371582)
(9, 12.202072143554688)
(10, 12.200956344604492)
(11, 12.200956344604492)
(12, 12.202291488647461)
(13, 12.198720932006836)
(14, 12.201695442199707)
(15, 12.200786590576172)
(16, 12.199288368225098)
(17, 12.202156066894531)
(18, 12.200779914855957)
(19, 12.202889442443848)
(20, 12.202649116516113)
(21, 12.2019681930542)
(22, 12.201281547546387)
(23, 12.203798294067383)
(24, 12.202010154724121)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.202228546142578)
(1, 12.198040008544922)
(2, 12.203644752502441)
(3, 12.198652267456055)
(4, 12.20191478729248)
(5, 12.202741622924805)
(6, 12.20119857788086)
(7, 12.200789451599121)
(8, 12.199719429016113)
(9, 12.200458526611328)
(10, 12.200697898864746)
(11, 12.200533866882324)
(12, 12.200693130493164)
(13, 12.199783325195312)
(14, 12.200783729553223)
(15, 12.198806762695312)
(16, 12.200418472290039)
(17, 12.2017183303833)
(18, 12.201377868652344)
(19, 12.201871871948242)
(20, 12.201415061950684)
(21, 12.202178001403809)
(22, 12.202496528625488)
(23, 12.203417778015137)
(24, 12.201164245605469)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.2\textwidth,
    height=0.18\textwidth
}
\begin{axis}[
    name=plot4.1,
    at={(6.95cm,0.05cm)},
    %title={Middle Layer 2},
    %ylabel={Layer-wise Entropy},
    ytick = {12.20,12.2035},
    yticklabels = {12.20, 12.21},
    ymajorgrids=false,
    xtick=\empty,
    grid style=dashed,
    legend style={
    at={(5.5cm,1cm)},anchor=east
    },
    extra y ticks=12.201,
        % ... don't show any label and ...
        extra y tick labels={UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 12.20175838470459)
(1, 12.200848579406738)
(2, 12.203475952148438)
(3, 12.202248573303223)
(4, 12.203421592712402)
(5, 12.203023910522461)
(6, 12.20170783996582)
(7, 12.201428413391113)
(8, 12.19926643371582)
(9, 12.202072143554688)
(10, 12.200956344604492)
(11, 12.200956344604492)
(12, 12.202291488647461)
(13, 12.198720932006836)
(14, 12.201695442199707)
(15, 12.200786590576172)
(16, 12.199288368225098)
(17, 12.202156066894531)
(18, 12.200779914855957)
(19, 12.202889442443848)
(20, 12.202649116516113)
(21, 12.2019681930542)
(22, 12.201281547546387)
(23, 12.203798294067383)
(24, 12.202010154724121)
        };
        %\addlegendentry{Clean Sample}    
     \addplot[
        only marks,
        mark size=1.0pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 12.202228546142578)
(1, 12.198040008544922)
(2, 12.203644752502441)
(3, 12.198652267456055)
(4, 12.20191478729248)
(5, 12.202741622924805)
(6, 12.20119857788086)
(7, 12.200789451599121)
(8, 12.199719429016113)
(9, 12.200458526611328)
(10, 12.200697898864746)
(11, 12.200533866882324)
(12, 12.200693130493164)
(13, 12.199783325195312)
(14, 12.200783729553223)
(15, 12.198806762695312)
(16, 12.200418472290039)
(17, 12.2017183303833)
(18, 12.201377868652344)
(19, 12.201871871948242)
(20, 12.201415061950684)
(21, 12.202178001403809)
(22, 12.202496528625488)
(23, 12.203417778015137)
(24, 12.201164245605469)
        };
        %\addlegendentry{UAP Perturbed Sample}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot5,
    at={(plot4.south east)},
    font=\tiny,
    xlabel={Deep Layer 1},
    xlabel near ticks,
    ytick = \empty, %{5,10},
    %yticklabels = {5.00,10.0},
    ymajorgrids=false,
    xtick=\empty,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymin=0,
    ymax=14,
    grid style=dashed,
    legend style={
    at={(3.3cm,-2cm)},anchor=east
    },
    extra y ticks=1.85732,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 10.644855499267578)
(1, 2.542342185974121)
(2, 3.6729109287261963)
(3, 3.641709089279175)
(4, 7.018854141235352)
(5, 8.959796905517578)
(6, 3.6957528591156006)
(7, 8.593829154968262)
(8, 6.1123223304748535)
(9, 5.694369792938232)
(10, 9.127310752868652)
(11, 5.953510284423828)
(12, 10.36890983581543)
(13, 5.971975326538086)
(14, 9.22249984741211)
(15, 4.534697532653809)
(16, 9.94460678100586)
(17, 2.78007435798645)
(18, 3.183105707168579)
(19, 5.55194616317749)
(20, 6.642988204956055)
(21, 9.275391578674316)
(22, 5.5394392013549805)
(23, 6.824537754058838)
(24, 4.264108180999756)
        };
        %\addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 10.697464942932129)
(1, 3.2425005435943604)
(2, 6.360372066497803)
(3, 2.502314567565918)
(4, 2.4141855239868164)
(5, 9.32213306427002)
(6, 4.359088897705078)
(7, 2.288252353668213)
(8, 7.744597434997559)
(9, 2.644366979598999)
(10, 5.222107410430908)
(11, 5.68434476852417)
(12, 6.613792419433594)
(13, 5.266767501831055)
(14, 0.25186488032341003)
(15, 2.4133739471435547)
(16, 10.541203498840332)
(17, 1.300968050956726)
(18, 7.446892738342285)
(19, 3.7113988399505615)
(20, 2.465223550796509)
(21, 4.08743953704834)
(22, 8.59024429321289)
(23, 8.515959739685059)
(24, 1.7332584857940674)
        };
        %\addlegendentry{Sample with UAP}  
\end{axis}
}
{
\pgfplotsset{%
    width=0.26\textwidth,
    height=0.25\textwidth
}
\begin{axis}[
    name=plot6,
    at={(plot5.south east)},
    font=\tiny,
    xlabel={Deep Layer 2},
    xlabel near ticks,
    ytick = \empty, %{4,8},
    %yticklabels = {4.00,8.00},
    ymajorgrids=false,
    xtick=\empty,
    ymin=0,
    ymax=14,
    %ylabel={UAP},
    %y label style={at={(1.5,0.15)},rotate=-90},
    ymajorgrids=false,
    grid style=dashed,
    legend style={font=\tiny,
    at={(1.9cm,1.5cm)},anchor=east
    },
    extra y ticks=7.352672576904297,
        % ... don't show any label and ...
        extra y tick labels=\empty, %{UAP},
        % ... adapt the style to your needs
        extra y tick style={
            % in case you should remove the grid from the "normal" ticks ...
            ymajorgrids=true,
            % ... but don't show an extra tick (line)
            ytick style={
                /pgfplots/major tick length=0pt,
            },
            grid style={
                black,
                dashed,
                % to draw this line before the bars, move it a higher layer
                /pgfplots/on layer=axis foreground,
            },
        },
    ]

    
    \addplot[
        only marks,
        mark size=0.5pt,
        %scatter,    
        %mark=square,
        color = blue,
        ]
        coordinates {
(0, 7.4055891036987305)
(1, 6.660892486572266)
(2, 6.128525733947754)
(3, 7.40097188949585)
(4, 7.21845817565918)
(5, 7.189165115356445)
(6, 7.368408679962158)
(7, 7.259629249572754)
(8, 7.194795608520508)
(9, 7.052578926086426)
(10, 7.291655540466309)
(11, 7.461211681365967)
(12, 7.431214332580566)
(13, 7.469444274902344)
(14, 7.448919296264648)
(15, 7.057613372802734)
(16, 7.147312164306641)
(17, 7.195530414581299)
(18, 6.436911106109619)
(19, 7.438458442687988)
(20, 6.284543991088867)
(21, 7.451208114624023)
(22, 6.910295486450195)
(23, 6.453247547149658)
(24, 7.380129814147949)
        };
        \addlegendentry{Sample w/o UAP}    
     \addplot[
        only marks,
        mark size=1pt,
        %scatter,    
        mark=triangle,
        color = red,
        ]
        coordinates {
(0, 7.418017864227295)
(1, 6.353853702545166)
(2, 7.294961929321289)
(3, 6.932147026062012)
(4, 7.339859962463379)
(5, 7.244290351867676)
(6, 7.184273719787598)
(7, 7.374672889709473)
(8, 7.222006320953369)
(9, 2.752537727355957)
(10, 7.436044692993164)
(11, 7.377965927124023)
(12, 7.354161739349365)
(13, 6.767343997955322)
(14, 5.134607791900635)
(15, 6.122907638549805)
(16, 7.290931224822998)
(17, 7.489680290222168)
(18, 7.278281211853027)
(19, 7.246399879455566)
(20, 7.260085105895996)
(21, 7.357619285583496)
(22, 7.283987045288086)
(23, 6.970250129699707)
(24, 7.22886848449707)
        };
        \addlegendentry{Sample with UAP}  
\end{axis}
}
\end{tikzpicture}
\caption{Layer-wise entropy of $NN_1$ with sPGD.} 
\label{fig:entropy_spgd}
\end{figure*}




%LaVan

%GAP

%SGA



%\subsection{Advanced Attacker}

\begin{figure}[t]
\centering
\resizebox{\textwidth}{!}
{
\begin{tabular}{ccccc}

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    ytick={1,2,3},
    yticklabels={Clean, Before, After},
    yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.0$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,  
},
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=0.56,
lower quartile=4.45,
median=6.35,
upper quartile=7.13,
upper whisker=7.47,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.81,
lower quartile=7.37,
median=7.42,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.1$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=2.19,
lower quartile=5.10,
median=6.72,
upper quartile=7.20,
upper whisker=7.49,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.79,
lower quartile=7.37,
median=7.44,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&
\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.2$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=2.85,
lower quartile=5.44,
median=6.86,
upper quartile=7.27,
upper whisker=7.47,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.80,
lower quartile=7.38,
median=7.43,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.3$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=4.68,
lower quartile=6.13,
median=6.86,
upper quartile=7.21,
upper whisker=7.45,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.78,
lower quartile=7.38,
median=7.42,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.4$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=5.22,
lower quartile=6.74,
median=7.08,
upper quartile=7.33,
upper whisker=7.42,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.76,
lower quartile=7.39,
median=7.41,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}


\\

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.5$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=5.92,
lower quartile=7.05,
median=7.23,
upper quartile=7.31,
upper whisker=7.45,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.75,
lower quartile=7.36,
median=7.42,
upper quartile=7.47,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.6$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=6.22,
lower quartile=6.99,
median=7.19,
upper quartile=7.33,
upper whisker=7.47,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.74,
lower quartile=7.38,
median=7.41,
upper quartile=7.49,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.7$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=6.68,
lower quartile=7.04,
median=7.22,
upper quartile=7.36,
upper whisker=7.49,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.79,
lower quartile=7.38,
median=7.40,
upper quartile=7.46,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.8$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=6.94,
lower quartile=7.30,
median=7.35,
upper quartile=7.40,
upper whisker=7.51,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.84,
lower quartile=7.37,
median=7.43,
upper quartile=7.48,
upper whisker=7.54,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

&

\begin{tikzpicture}

\pgfplotsset{%
    width=0.3\textwidth,
    height=0.3\textwidth
}
  \begin{axis}
    [
    yticklabels=none,
    %ytick={1,2,3},
    %yticklabels={Clean, Before, After},
    %yticklabel style = {rotate=90,font=\tiny},
    xticklabel style = {font=\tiny},
    title={$weight=0.9$},
    ]

    \addplot+[
    boxplot prepared={    
lower whisker=6.13,
lower quartile=7.05,
median=7.22,
upper quartile=7.41,
upper whisker=7.47,
    },
    ] coordinates {};
    \addplot+[
    boxplot prepared={
lower whisker=7.25,
lower quartile=7.39,
median=7.45,
upper quartile=7.49,
upper whisker=7.54,
    },
    ] coordinates {};

    \addplot+[
    boxplot prepared={
lower whisker=6.71,
lower quartile=7.38,
median=7.42,
upper quartile=7.49,
upper whisker=7.55,
    },
    ] coordinates {};
  \end{axis}

\end{tikzpicture}

\end{tabular}
}
\caption{Change in layer-wise entropy of advanced attacks.} 
\label{fig:box_advanced_uaps}
\end{figure}

%\subsection{TRADES}

\begin{table*}[t]
\setlength\heavyrulewidth{0.25ex}
\centering
\caption{Performance comparison with TRADES.}
\resizebox{0.6\textwidth}{!}
{
\begin{tabular}[t]{p{9mm}|p{8mm}p{8mm}|p{8mm}p{8mm}|p{8mm}p{8mm}}%{c|cc|cc|cc|cc|cc}
\toprule

\multirow{2}{*}{Target}
 &\multicolumn{2}{c|}{Before}&\multicolumn{2}{c|}{Ours}&\multicolumn{2}{c}{TRADES}\\
& AAcc. & SR & AAcc. &SR & AAcc.  &SR \\
0&0.155&0.922&0.871&0.009&0.819&0.018\\
1&0.144&0.927&0.864&0.016&0.816&0.004\\
2&0.143&0.954&0.857&0.050&0.816&0.028\\
3&0.116&0.972&0.875&0.046&0.819&0.042\\
4&0.148&0.938&0.874&0.027&0.818&0.015\\
5&0.226&0.861&0.861&0.036&0.818&0.042\\
6&0.139&0.963&0.860&0.048&0.811&0.036\\
7&0.143&0.942&0.849&0.045&0.812&0.010\\
8&0.171&0.928&0.852&0.047&0.815&0.015\\
9&0.134&0.954&0.847&0.014&0.817&0.010\\
\textbf{avg}&\textbf{0.152}&\textbf{0.936}&\textbf{0.861}&\textbf{0.034}&\textbf{0.816}&\textbf{0.022}\\
\midrule
Acc&\multicolumn{2}{c|}{Clean Acc.: $0.93$ }
&\multicolumn{2}{c|}{Clean Acc.: $0.90$ }
&\multicolumn{2}{c}{Clean Acc.: $0.82$ }\\
\bottomrule

\end{tabular}
}
\label{tab:compare_trades}
%   \begin{tablenotes}
%      \small
%      \item 
%    \end{tablenotes}
\end{table*}



\subsection{Oral Defense}
\begin{table}[t]
    \parbox{.50\linewidth}{
        %\begin{table}[t]
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Performance of adversarial training.}
        \resizebox{0.4\textwidth}{!}
        {
        \begin{tabular}[t]{p{20mm}|p{8mm}p{7mm}p{10mm}}%{c|cc|cc|cc|cc|cc}
        \toprule
        Setting & AAcc. & SR &$\Delta$CAcc.\\
        \midrule
        Targeted&0.464&0.167&-0.104\\
        Non-targeted&0.295&0.455&-0.168\\
        Known UAP&0.476&0.223&0.0\\
        TRADES&0.816&0.022&-0.110\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:advtrain}
        %   \begin{tablenotes}
        %      \small
        %      \item 
        %    \end{tablenotes}
        %\end{table}
    }
    \hfill
    \parbox{.5\linewidth}{
        \setlength\heavyrulewidth{0.25ex}
        \centering
        \caption{Performance of existing methods.}
        \resizebox{0.35\textwidth}{!}
        {
        \begin{tabular}[t]{p{15mm}|p{8mm}p{7mm}{8mm}}%{c|cc|cc|cc|cc|cc}
        \toprule
        Method & AAcc. &SR  &$\Delta$CAcc.\\
        \midrule
        %\emph{Democratic Training}&0.573&0.010\\
        SFR&0.468&0.011&-0.022\\
        CFN&0.150&0.559&-0.073\\
        FNS&0.149&0.623&-0.013\\
        DensePure& 0.802& 0.010& -0.121\\        TRADES&0.816&0.022&-0.110\\
        \bottomrule
        \end{tabular}
        }
        \label{tab:existing}
    }
\end{table}
\end{comment}

\end{document}
