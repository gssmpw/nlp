We here provide the pseudo-code for computing membership signals for both MIA methodologies based on synthetic data (Sec.~\ref{subsec:data_score}), see Algorithm~\ref{alg:ngram_mia} for the $n$-gram method and Algorithm~\ref{alg:sim_mia} for the method using similarity metrics. 

\begin{algorithm}
\caption{Compute membership signal using $n$-gram model}

\begin{algorithmic}[1]
\STATE \textbf{Parameter}: $n$-gram model order $n$
\STATE \textbf{Input}: Synthetic dataset $\synthetic{D} = \{ \synthetic{x}_i = (\synthetic{s}_i, \synthetic{\ell}_i) \}_{i=1}^\synthetic{N}$, Target canary $\canary{x} = (\canary{s}, \canary{\ell})$
\STATE \textbf{Output}: Membership signal $\alpha$

\STATE $C(\vec{w}) \gets 0$ for all $(n\!-\!1)$- and $n$-grams $\vec{w}$

\FOR{$i = 1$ to $\synthetic{N}$} 
    \STATE $w_1, \dots, w_{k(i)} \gets \synthetic{s}_i$
    \FOR{each $n$-gram $(w_{j-(n-1)}, \dots, w_j)$ in $\synthetic{s}_i$}
        \STATE $C(w_{j-(n-1)}, \dots, w_j) \mathrel{+}= 1$
        \STATE $C(w_{j-(n-1)}, \dots, w_{j-1}) \mathrel{+}= 1$
    \ENDFOR
\ENDFOR
\STATE $V \gets |\{w \mid \exists i. w \in \synthetic{s}_i  \}|$

\STATE The $n$-gram model is factored into conditional probabilities: \hfill \COMMENT{Final $n$-gram model}
\[
P_{\text{$n$-gram}}(w_j \mid w_{j-(n-1)}, \dots, w_{j-1}) = \frac{C(w_{j-(n-1)}, \dots, w_j) + 1}{C(w_{j-(n-1)}, \dots, w_{j-1}) + V}
\]

\STATE $w_1, \dots, w_k \gets \canary{s}$
\hfill \COMMENT{Compute probability of canary text $\canary{s}$}

\STATE $\alpha \gets \prod_{j=2}^k P_{\text{$n$-gram}}(w_j \mid w_{j-(n-1)}, \dots, w_{j-1})$

\STATE \textbf{return} $\alpha$
\end{algorithmic}
\label{alg:ngram_mia}
\end{algorithm}


\begin{algorithm}
\caption{Compute membership signal using similarity metric}

\begin{algorithmic}[1]
\STATE \textbf{Parameter}: Similarity metric $\textsc{SIM}(\cdot, \cdot)$, cutoff parameter $k$
\STATE \textbf{Input}: Synthetic dataset $\synthetic{D} = \{ \synthetic{x}_i = (\synthetic{s}_i, \synthetic{\ell}_i) \}_{i=1}^\synthetic{N}$, Target canary $\canary{x} = (\canary{s}, \canary{\ell})$
\STATE \textbf{Output}: Membership signal $\alpha$

\FOR{$i = 1$ to $\synthetic{N}$} 
    \STATE $\sigma_i \gets \textsc{SIM}(\canary{s}, \synthetic{s}_i)$ \hfill \COMMENT{Compute similarity of each synthetic example} 
\ENDFOR

\STATE Sort similarities $\sigma_i$ for $i = 1, \ldots, \synthetic{N}$ in descending order 

\STATE Let $\sigma_{i(1)}, \dots, \sigma_{i(k)}$ be the top-$k$ similarities

\STATE $\alpha \gets \frac{1}{k} \sum_{j=1}^k \sigma_{i(j)}$ \hfill \COMMENT{Compute mean similarity of the top-$k$ examples}

\STATE \textbf{return} $\alpha$ 
\end{algorithmic}
\label{alg:sim_mia}
\end{algorithm}
