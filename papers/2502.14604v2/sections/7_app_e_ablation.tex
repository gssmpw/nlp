\section{Additional Results}\label{app:main-cifar}
We report the main results of CIFAR-10 and CIFAR-100 in Table~\ref{tab:CIFAR} due to the space limitation in the main text. 
Compared to other methods, our AdaND achieves the best performance in these two datasets. When using layer normalization, Tent supports $bs=1$.
We conducted experiments with Tent ($bs = 1$) in Table~\ref{app-tab:tent-bs1} and found that it performs well on clean data streams. However, its performance degrades significantly when dealing with noisy data streams.

\begin{table}[t]
\caption{Zero-shot noisy TTA results for CIFAR-10/100 as the ID dataset. The \textbf{bold} indicates the best performance on each dataset.}\label{tab:CIFAR}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Method}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{5}*{CIFAR-10}
& ZS-CLIP
& 83.55 & 98.39 & 90.36 & 83.11 & 97.82 & 89.87 & 82.18 & 91.82 & 86.73 & 81.73 & 76.26 & 78.90 & 82.64 & 91.07 & 86.47\\
& Tent
& 87.18 & 52.90 & 65.85 & 89.03 & 73.96 & 80.80 & 89.78 & 88.48 & 89.13 & 88.78 & 65.44 & 75.34 & 88.69 & 70.19 & 77.78\\
& SoTTA
& \textbf{90.21} & 81.71 & 85.75 & \textbf{90.13} & 91.06 & 90.59 & 89.56 & 90.96 & 90.25 & 89.04 & 74.17 & 80.93 & \textbf{89.73} & 84.47 & 86.88\\
& TPT
& 81.76 & 98.85 & 89.50 & 81.53 & 97.93 & 88.98 & 80.43 & 92.11 & 85.87 & 79.88 & 77.18 & 78.51 & 80.90 & 91.52 & 85.72\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& 89.46 & \textbf{99.90} & \textbf{94.39} & \textbf{88.56} & \textbf{99.66} & \textbf{93.78} & \textbf{89.60} & \textbf{98.54} & \textbf{93.86} & \textbf{89.65} & \textbf{93.04} & \textbf{91.31} & \textbf{89.32} & \textbf{97.79} & \textbf{93.34}\\

\midrule
\multirow{5}*{CIFAR-100}
& ZS-CLIP
& 48.52 & 97.58 & 64.81 & 49.29 & 94.97 & 64.90 & 46.76 & 81.58 & 59.45 & 45.36 & 64.52 & 53.27 & 47.48 & 84.66 & 60.61\\
& Tent
& 55.39 & 42.41 & 48.04 & 60.06 & 83.37 & 69.82 & 59.31 & 79.13 & 67.80 & 57.52 & 62.24 & 59.79 & 58.07 & 66.79 & 61.36\\
& SoTTA
& 60.56 & 89.24 & 72.15 & 60.28 & 88.89 & 71.84 & 58.79 & 81.56 & 68.33 & 57.01 & 65.73 & \textbf{61.06} & 59.16 & 81.36 & 68.34\\
& TPT
& 46.09 & 97.87 & 62.67 & 46.90 & 95.36 & 62.88 & 43.87 & 83.10 & 57.42 & 42.48 & \textbf{66.86} & 51.95 & 44.84 & \textbf{85.80} & 58.73\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{64.44} & \textbf{99.78} & \textbf{78.31} & \textbf{62.42} & \textbf{99.15} & \textbf{76.61} & \textbf{65.17} & \textbf{84.84} & \textbf{73.72} & \textbf{63.50} & 44.21 & 52.13 & \textbf{63.88} & 81.99 & \textbf{70.19}\\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[h]
\caption{Performance of Tent with Layer Normalization ($bs = 1$) on Clean and Noisy Data Streams}\label{app-tab:tent-bs1}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.6\linewidth}{!}{
\begin{tabular}{ll*{6}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Method}&\multicolumn{3}{c}{Clean Data Stream}&\multicolumn{3}{c}{Noisy Data Stream}\\
\cmidrule{3-8}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}
\multirow{3}*{CIFAR-10}
& ZS-CLIP
& 77.96 & - & - &  82.64 & 91.07 & 86.47\\
& Tent (bs=1)
& 91.84 & - & -  & 89.83 & 7.46 & 13.66 \\
& Tent (bs=64)
& 84.39 & - & -  & 88.69 & 70.19 & 77.78\\

\midrule
\multirow{3}*{CIFAR-100}
& ZS-CLIP
& 44.69 & - & - & 47.48 & 84.66 & 60.61\\
& Tent (bs=1)
& 63.66 & - & - &  37.86 & 20.64 & 19.82 \\
& Tent (bs=64)
& 41.90 & - & - &  58.07 & 66.79 & 61.36\\
\bottomrule
\end{tabular}}
}
\end{table}


We conduct additional experiments on more complex datasets, with results shown in Table~\ref{tab:NINCO}. The results demonstrate that our method can outperform all the baseline methods. Whatâ€™s more, our method achieves the best ID classification accuracy $\text{Acc}_\text{S}$ among all approaches. Note that ZS-NTTA is inherently more challenging than traditional OOD detection, as it requires simultaneous classification and detection capabilities under the noisy data stream. Specifically, ZS-NTTA requires online, real-time classification and detection results: for each input sample, the model must immediately determine whether it is ID/OOD, and if ID, perform classification. In contrast, existing OOD detection methods typically report ID classification accuracy under the assumption of a clean data stream.


\begin{table}[h]
\caption{Zero-shot noisy TTA results on more complex datasets. The ID dataset is ImageNet, and the OOD dataset is NINCO~\citep{bitterwolf2023or}.}\label{tab:NINCO}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.5\linewidth}{!}{
\begin{tabular}{l*{3}{c}}
\toprule
Method&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\midrule
ZS-CLIP & 51.44 & 71.90 & 59.97\\
Tent & 54.14 & 65.84 & 59.42\\
SoTTA & 52.87 & 60.50 & 56.43\\
Ours (With Gaussian noise) & \textbf{60.10} & 55.70 & 57.82 \\
Ours (Without Gaussian noise) & 50.25 & \textbf{77.99} & \textbf{61.12}\\

\bottomrule
\end{tabular}}
}
\end{table}

We also compare our approach to recent training-free TTA work, TDA~\citep{karmanov2024efficient}, in Table~\ref{tab:TDA}. Our experimental results demonstrate that TDA's performance is inferior to ours. This indicates the necessity of training a noise detector to detect noisy samples in the ZS-NTTA setting.

Furthermore, our method is designed to be plug-and-play, making it naturally compatible with existing TTA methods to enhance ID classifiers in noisy data streams. To validate this compatibility, we integrate our method with Tent. Specifically, after updating the OOD detector for $N$ steps ($N=10$ in our implementation), the samples identified as ID by the detector are utilized to update the classifier. As shown in Table~\ref{tab:integrating-tent}, the experimental results demonstrate that our method not only improves OOD detection accuracy but also enhances the classifier's intrinsic classification capabilities on ID samples under noisy data streams. These results validate that our approach effectively enhances the robustness of existing TTA methods when dealing with noisy data streams.


To comprehensively evaluate our method's performance, we conduct extensive experiments on widely-used corruption benchmarks, including ImageNet-C, CIFAR10-C, and CIFAR100-C~\citep{hendrycks2019benchmarking}. Due to computing resource limitations, we evaluate our method using iNaturalist as the OOD dataset for ImageNet-C experiments, and SVHN as the OOD dataset for both CIFAR-10-C and CIFAR-100-C experiments, with corruption severity set to level-1.
The experimental results in Table~\ref{tab:corruption} demonstrate that our method consistently outperforms existing approaches on these corrupted datasets.


\begin{table}[h]
\caption{Performance comparison with TDA using ImageNet as ID dataset. Results are averaged across four OOD datasets: iNaturalist, SUN, Texture, and Places.}\label{tab:TDA}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.5\linewidth}{!}{
\begin{tabular}{l*{3}{c}}
\toprule
Method&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\midrule
ZS-CLIP & 53.38 & 82.38 & 64.77\\
TDA & 53.47 & 82.37 & 64.84\\
Ours (With Gaussian noise) & \textbf{62.24} & 88.67 & \textbf{73.09} \\
Ours (Without Gaussian noise) & 60.64 & \textbf{91.73} & 73.00\\

\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[h]
\caption{Results of integrating AdaND (Ours) with Tent for enhanced classifiers' classification performance in noisy data streams. Results are averaged across four OOD datasets (SVHN, LSUN, Texture, and Places) with CIFAR-10 as the ID dataset.}\label{tab:integrating-tent}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.4\linewidth}{!}{
\begin{tabular}{l*{3}{c}}
\toprule
Method&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\midrule
ZS-CLIP & 82.64 & 91.07 & 86.47\\
Tent & 88.69 &	70.19 &	77.78\\
Ours & 89.32 &	\textbf{97.79}	& 93.34\\
Ours (with Tent) & 	\textbf{93.61}	& 94.30	& \textbf{93.79}\\

\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[h]
\caption{Experiments on CIFAR-10-C, CIFAR-100-C, and ImageNet-C. Results are averaged across 15 corruption types.}\label{tab:corruption}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.7\linewidth}{!}{
\begin{tabular}{l*{9}{c}}
\toprule
Method&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\midrule
ZS-CLIP & 74.14&	98.24&	83.96&	39.43&	96.74&	55.49&	44.14&	84.73&	57.91\\
Tent & 80.25&	57.86&	66.83&	45.29&	41.15&	42.83&	37.10&	16.50	&22.79\\
SoTTA & \textbf{83.68} &	85.00&	84.06&	51.46&	88.70&	64.73&	46.41&	62.48&	53.21\\
Ours&	82.15	& \textbf{99.89} & \textbf{89.84} &	\textbf{54.89} &	\textbf{99.18} &	\textbf{70.18} &	\textbf{52.63} &	\textbf{94.78} &	\textbf{67.55} \\

\bottomrule
\end{tabular}}
}
\end{table}


\section{Full Results of Ablation Studies}
\subsection{Ablation Studies on the Modules of AdaND} \label{app:ablation-module}
Table~\ref{app-tab:ablation-module} presents the ablation study results on each module in our method across different ID datasets. Experiments show that the noise detector is effective across different ID datasets, and after injecting Gaussian noise, the noise detector can also handle the clean stream case well. Additionally, injecting Gaussian noise does not result in a performance drop for our method on noisy data streams.



\begin{table}[th!]
\caption{Ablation studies for each module in the method. For CIFAR-10/100, results are averaged across four OOD datasets: SVHN, LSUN, Texture, and Places. For other ID datasets, averaging includes four OOD datasets: iNaturalist, SUN, Texture, and Places. `$\times$' indicates the exclusion of a module and `$\checkmark$' indicates inclusion of a module.}\label{app-tab:ablation-module}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.8\linewidth}{!}{
\begin{tabular}{lcc*{6}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Noise Detector}&\multirow{2}*{Gaussian Noise}&\multicolumn{3}{c}{Clean Data Stream}&\multicolumn{3}{c}{Noisy Data Stream}\\
\cmidrule{4-9}
&&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){4-6}\cmidrule(lr){7-9}
\multirow{4}*{CIFAR-10}
&$\times$ & $\times$
& 77.96 & - & -  & 82.64 & 91.07 & 86.47\\
&$\times$ & $\checkmark$
& 82.07 & - & -  & 83.19 & 90.39 & 86.40\\
&$\checkmark$ & $\times$
& 67.89 & - & -  & 89.14 & \textbf{98.37} & \textbf{93.51}\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{89.16} & - & -  & \textbf{89.32} & 97.79 & 93.34\\
\midrule

\multirow{4}*{CIFAR-100}
&$\times$ & $\times$
& 44.69 & - & -  & 47.48 & 84.66 & 60.61\\
&$\times$ & $\checkmark$
& 43.40 & - & -  & 46.07 & 85.84 & 59.77\\
&$\checkmark$ & $\times$
& 35.21 & - & -  & 61.65 & \textbf{90.42} & \textbf{73.23}\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{62.52} & - & -  & \textbf{63.88} & 81.99 & 70.19\\

\midrule

\multirow{4}*{CUB-200-2011}
&$\times$ & $\times$
& 33.08 & - & -  & 37.95 & 85.71 & 52.59\\
&$\times$ & $\checkmark$
& 36.74 & - & -  & 40.34 & 82.82 & 54.22\\
&$\checkmark$ & $\times$
& 30.01 & - & -  & 50.42 & \textbf{93.49} & 65.51\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{49.47} & - & -  & \textbf{52.10} & 90.77 & \textbf{66.14}\\

\midrule

\multirow{4}*{STANFORD-CARS}
&$\times$ & $\times$
& 39.02 & - & -  & 52.65 & 98.13 & 68.53\\
&$\times$ & $\checkmark$
& 44.08 & - & -  & 53.69 & 97.81 & 69.32\\
&$\checkmark$ & $\times$
& 34.80 & - & -  & 62.59 & \textbf{99.67} & 76.89\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{58.53} & - & -  & \textbf{62.80} & 99.66 & \textbf{77.05}\\

\midrule

\multirow{4}*{Food-101}
&$\times$ & $\times$
& 72.93 & - & -  & 80.62 & 94.65 & 87.07\\
&$\times$ & $\checkmark$
& 77.61 & - & -  & 80.79 & 94.56 & 87.13\\
&$\checkmark$ & $\times$
& 56.75 & - & -  & \textbf{86.46} & \textbf{99.00} & \textbf{92.30}\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{86.21} & - & -  & 86.44 & 98.85 & 92.23\\

\midrule

\multirow{4}*{Oxford-IIIT Pet}
&$\times$ & $\times$
& 70.17 & - & -  & 79.53 & 87.73 & 83.41\\
&$\times$ & $\checkmark$
& 78.41 & - & -  & 80.47 & 86.39 & 83.31\\
&$\checkmark$ & $\times$
& 62.95 & - & -  & 85.54 &\textbf{98.27} & 91.47\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{84.91} & - & -  & \textbf{85.84} & 98.06 & \textbf{91.54}\\

\midrule

\multirow{4}*{ImageNet}
&$\times$ & $\times$
& 47.68 & - & -  & 53.38 & 82.38 & 64.77\\
&$\times$ & $\checkmark$
& 50.07 & - & -  & 53.95 & 81.65 & 64.95\\
&$\checkmark$ & $\times$
& 37.54 & - & -  & 60.64 & \textbf{91.73} & 73.00\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{63.96} & - & -  & \textbf{62.24} & 88.67 & \textbf{73.09}\\

\midrule

\multirow{4}*{ImageNet-K}
&$\times$ & $\times$
& 30.48 & - & -  & 33.41 & 79.33 & 47.01\\
&$\times$ & $\checkmark$
& 31.43 & - & -  & 33.72 & 78.67 & 47.20\\
&$\checkmark$ & $\times$
& 26.03 & - & -  & 37.70 & \textbf{88.27} & 52.82\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{36.54} & - & -  & \textbf{39.78} & 83.15 & \textbf{53.77}\\

\midrule

\multirow{4}*{ImageNet-A}
&$\times$ & $\times$
& 31.47 & - & -  & 34.22 & 77.81 & 47.53\\
&$\times$ & $\checkmark$
& 34.03 & - & -  & 36.32 & 74.85 & 48.90\\
&$\checkmark$ & $\times$
& 26.13 & - & -  & 39.39 & \textbf{90.47} & 54.87\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{45.20} & - & -  & \textbf{43.36} & 81.06 & \textbf{56.41}\\


\midrule


\multirow{4}*{ImageNet-V2}
&$\times$ & $\times$
& 43.12 & - & -  & 47.39 & 81.47 & 59.92\\
&$\times$ & $\checkmark$
& 44.93 & - & -  & 48.03 & 80.88 & 60.25\\
&$\checkmark$ & $\times$
& 32.17 & - & -  & 54.43 & \textbf{91.31} & \textbf{68.18}\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{58.42} & - & -  & \textbf{56.05} & 85.89 & 67.72\\

\midrule


\multirow{4}*{ImageNet-R}
&$\times$ & $\times$
& 57.34 & - & -  & 61.60 & 86.31 & 71.81\\
&$\times$ & $\checkmark$
& 60.70 & - & -  & 62.93 & 84.95 & 72.19\\
&$\checkmark$ & $\times$
& 47.20 & - & -  & 70.25 & \textbf{94.52} & \textbf{80.57}\\
\rowcolor{gray!22}
\cellcolor{white}
&$\checkmark$ & $\checkmark$
& \textbf{71.54} & - & -  & \textbf{71.13} & 92.28 & 80.25\\

\bottomrule
\end{tabular}}
}
\end{table}

\subsection{Ablation Studies on the Intentionally Injected Noise}\label{app:ablation-gaussian}
Table~\ref{app-tab:CIFAR-inject-noise} presents the results for Gaussian, Uniform, Salt-and-pepper, and Poisson noise as the injected noise types. The results demonstrate that all noise types effectively manage both clean and noisy data streams, suggesting that our method is robust to different choices of injected noise. Table~\ref{app-tab:gaussian-rate} presents the ablation results for varying frequencies of Gaussian noise injection. Our experiments indicate that injecting Gaussian noise every $2$, $4$, or $8$ samples consistently produces strong performance.
 


\begin{table}[th!]
\caption{Ablation studies for the different injected noise in the method. For CIFAR-10/100, results are averaged across four OOD datasets under the noisy data stream: SVHN, LSUN, Texture, and Places. For other ID datasets, averaging includes four OOD datasets under the noisy data stream: iNaturalist, SUN, Texture, and Places.
}\label{app-tab:CIFAR-inject-noise}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.6\linewidth}{!}{
\begin{tabular}{ll*{6}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Noise Type}&\multicolumn{3}{c}{Clean Data Stream}&\multicolumn{3}{c}{Noisy Data Stream}\\
\cmidrule{3-8}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}
\multirow{4}*{CIFAR-10}
& Gaussian
& 89.14 & - & -  & 89.32 & 97.79 & 93.34\\
& Uniform
& 89.07 & - & -  & 89.25 & 97.80 & 93.31\\
& Salt-and-pepper
& 89.08 & - & -  & 89.23 & 97.91 & 93.35\\
& Poisson
& 89.07 & - & -  & 89.28 & 97.90 & 93.37\\

\midrule
\multirow{4}*{CIFAR-100}
& Gaussian
& 62.70 & - & -  & 63.88 & 81.99 & 70.19\\
& Uniform
& 62.79 & - & -  & 64.48 & 82.92 & 71.25\\
& Salt-and-pepper
& 63.43 & - & -  & 64.24 & 80.70 & 69.25\\
& Poisson
& 62.80 & - & -  & 63.98 & 80.94 & 69.38\\

\midrule
\multirow{4}*{CUB-200-2011}
& Gaussian
& 49.53 & - & -  & 52.10 & 90.77 & 66.14\\
& Uniform
& 49.53 & - & -  & 52.09 & 90.95 & 66.19\\
& Salt-and-pepper
& 48.83 & - & -  & 51.85 & 91.41 & 66.13\\
& Poisson
& 48.91 & - & -  & 52.01 & 90.98 & 66.13\\

\midrule
\multirow{4}*{STANFORD-CARS}
& Gaussian
& 58.61 & - & -  & 62.80 & 99.66 & 77.05\\
& Uniform
& 58.83 & - & -  & 62.83 & 99.67 & 77.07\\
& Salt-and-pepper
& 57.76 & - & -  & 62.70 & 99.65 & 76.97\\
& Poisson
& 58.44 & - & -  & 62.79 & 99.67 & 77.04\\

\midrule
\multirow{4}*{Food-101}
& Gaussian
& 86.23 & - & -  & 86.44 & 98.85 & 92.23\\
& Uniform
& 86.26 & - & -  & 86.46 & 98.86 & 92.24\\
& Salt-and-pepper
& 86.25 & - & -  & 86.45 & 98.89 & 92.25\\
& Poisson
& 86.21 & - & -  & 86.43 & 98.88 & 92.23\\

\midrule
\multirow{4}*{Oxford-IIIT Pet}
& Gaussian
& 84.95 & - & -  & 85.84 & 98.06 & 91.54\\
& Uniform
& 84.68 & - & -  & 85.81 & 98.15 & 91.57\\
& Salt-and-pepper
& 84.88 & - & -  & 85.82 & 98.12 & 91.55\\
& Poisson
& 84.56 & - & -  & 85.78 & 98.21 & 91.57\\

\midrule
\multirow{4}*{ImageNet}
& Gaussian
& 63.99 & - & -  & 62.24 & 88.67 & 73.09\\
& Uniform
& 64.63 & - & -  & 62.58 & 88.11 & 73.13\\
& Salt-and-pepper
& 64.34 & - & -  & 62.42 & 88.21 & 73.05\\
& Poisson
& 64.20 & - & -  & 62.30 & 88.41 & 73.03\\

\midrule
\multirow{4}*{ImageNet-K}
& Gaussian
& 36.43 & - & -  & 39.78 & 83.15 & 53.77\\
& Uniform
& 37.28 & - & -  & 40.19 & 82.29 & 53.95\\
& Salt-and-pepper
& 37.28 & - & -  & 40.20 & 82.34 & 53.97\\
& Poisson
& 36.92 & - & -  & 40.10 & 82.48 & 53.92\\

\midrule
\multirow{4}*{ImageNet-A}
& Gaussian
& 45.31 & - & -  & 43.36 & 81.06 & 56.41\\
& Uniform
& 45.28 & - & -  & 43.38 & 81.09 & 56.43\\
& Salt-and-pepper
& 44.24 & - & -  & 42.75 & 82.47 & 56.24\\
& Poisson
& 44.39 & - & -  & 42.90 & 82.25 & 56.31\\

\midrule
\multirow{4}*{ImageNet-V2}
& Gaussian
& 58.39 & - & -  & 56.05 & 85.89 & 67.72\\
& Uniform
& 58.57 & - & -  & 56.36 & 85.29 & 67.75\\
& Salt-and-pepper
& 58.44 & - & -  & 55.99 & 85.51 & 67.56\\
& Poisson
& 58.20 & - & -  & 55.89 & 85.68 & 67.53\\

\midrule
\multirow{4}*{ImageNet-R}
& Gaussian
& 71.52 & - & -  & 71.13 & 92.28 & 80.25\\
& Uniform
& 71.54 & - & -  & 71.14 & 92.32 & 80.27\\
& Salt-and-pepper
& 71.08 & - & -  & 70.98 & 92.52 & 80.25\\
& Poisson
& 71.19 & - & -  & 71.07 & 92.35 & 80.23\\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Ablation studies for the ratio of Gaussian noise in the method. `-' indicates that no Gaussian noise is inserted, while `$8$' means that $1$ Gaussian noise sample is inserted for every $8$ test samples. For CIFAR-10/100, results are averaged across four OOD datasets under the noisy data stream: SVHN, LSUN, Texture, and Places. For other ID datasets, averaging includes four OOD datasets under the noisy data stream: iNaturalist, SUN, Texture, and Places.}\label{app-tab:gaussian-rate}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{0.6\linewidth}{!}{
\begin{tabular}{ll*{6}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Ratio}&\multicolumn{3}{c}{Clean Data Stream}&\multicolumn{3}{c}{Noisy Data Stream}\\
\cmidrule{3-8}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}
\multirow{3}*{CIFAR-10}
& 2
& 89.49 & - & -  & 89.67 & 90.70 & 90.02\\
& 4
& 89.32 & - & -  & 89.41 & 96.28 & 92.67\\
& 8
& 89.14 & - & -  & 89.32 & 97.79 & 93.34\\
\midrule
\multirow{3}*{CIFAR-100}
& 2
& 65.79 & - & -  & 66.02 & 67.83 & 61.75\\
& 4
& 65.68 & - & -  & 64.90 & 74.64 & 65.18\\
& 8
& 62.70 & - & -  & 63.88 & 81.99 & 70.19\\
\midrule
\multirow{3}*{CUB-200-2011}
& 2
& 54.03 & - & -  & 54.29 & 74.27 & 62.30\\
& 4
& 52.94 & - & -  & 53.72 & 85.17 & 65.68\\
& 8
& 49.53 & - & -  & 52.10 & 90.77 & 66.14\\
\midrule
\multirow{3}*{STANFORD-CARS}
& 2
& 62.84 & - & -  & 63.20 & 98.88 & 77.11\\
& 4
& 62.19 & - & -  & 63.08 & 99.56 & 77.23\\
& 8
& 58.61 & - & -  & 62.80 & 99.66 & 77.05\\
\midrule
\multirow{3}*{Food-101}
& 2
& 86.46 & - & -  & 86.57 & 97.71 & 91.80\\
& 4
& 86.34 & - & -  & 86.55 & 98.60 & 92.17\\
& 8
& 86.23 & - & -  & 86.44 & 98.85 & 92.23\\
\midrule
\multirow{3}*{Oxford-IIIT Pet}
& 2
& 85.71 & - & -  & 86.00 & 94.01 & 89.80\\
& 4
& 85.30 & - & -  & 85.94 & 97.52 & 91.36\\
& 8
& 84.95 & - & -  & 85.84 & 98.06 & 91.54\\
\midrule
\multirow{3}*{ImageNet}
& 2
& 65.80 & - & -  & 63.91 & 81.72 & 71.58\\
& 4
& 65.43 & - & -  & 63.14 & 86.00 & 72.73\\
& 8
& 63.99 & - & -  & 62.24 & 88.67 & 73.09\\
\midrule
\multirow{3}*{ImageNet-K}
& 2
& 43.06 & - & -  & 42.41 & 72.62 & 53.34\\
& 4
& 40.98 & - & -  & 41.16 & 78.76 & 53.97\\
& 8
& 36.43 & - & -  & 39.78 & 83.15 & 53.77\\
\midrule
\multirow{3}*{ImageNet-A}
& 2
& 46.24 & - & -  & 47.07 & 36.45 & 40.29\\
& 4
& 46.05 & - & -  & 45.72 & 62.37 & 52.20\\
& 8
& 45.31 & - & -  & 43.36 & 81.06 & 56.41\\
\midrule
\multirow{3}*{ImageNet-V2}
& 2
& 59.29 & - & -  & 58.85 & 65.84 & 61.56\\
& 4
& 58.77 & - & -  & 57.52 & 77.51 & 65.68\\
& 8
& 58.39 & - & -  & 56.05 & 85.89 & 67.72\\
\midrule
\multirow{3}*{ImageNet-R}
& 2
& 73.28 & - & -  & 72.41 & 85.17 & 77.86\\
& 4
& 72.94 & - & -  & 71.83 & 89.61 & 79.55\\
& 8
& 71.52 & - & -  & 71.13 & 92.28 & 80.25\\
\bottomrule
\end{tabular}}
}
\end{table}



\subsection{Ablation Studies on Simulating Real-world Adaptation}\label{app:ablation-real-world}
Table~\ref{app-tab:rate-of-noise} shows the results for the zero-shot noisy TTA task across data streams with varying noise ratios. All competing methods show significant performance degradation on clean data streams while our AdaND effectively handles clean data streams. What's more, our method consistently achieves strong results across different noise levels. The results of different orders are shown in Table~\ref{app-tab:CIFAR-seed} and Table~\ref{app-tab:CIFAR-seed-auroc}. Experiments demonstrate that our method consistently achieves top performance, regardless of the data stream's input order.


\begin{table}[th!]
\caption{Ablation studies for different noise ratios in the data stream. For CIFAR-10/100, results are averaged across four OOD datasets: SVHN, LSUN, Texture, and Places. For other ID datasets, averaging includes four OOD datasets: iNaturalist, SUN, Texture, and Places. Note that 0\% indicates the clean data stream. The \textbf{bold} indicates the best performance on each noise ratio.}\label{app-tab:rate-of-noise}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{llccc|ccc|ccc|ccc}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Method}&\multicolumn{3}{c}{0\%}&\multicolumn{3}{c}{25\%}&\multicolumn{3}{c}{50\%}&\multicolumn{3}{c}{75\%}\\
\cmidrule{3-14}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}
\multirow{5}*{CIFAR-10}
& ZS-CLIP
& 77.96 & - & -& 81.83 & 91.82 & 86.39& 82.64 & 91.07 & 86.47& 83.29 & 90.27 & 86.42\\
& Tent
& 84.39 & - & -& 88.62 & 89.07 & 88.66& 88.69 & 70.19 & 77.78& 80.99 & 30.33 & 42.93\\
& SoTTA
& 83.82 & - & -& 88.29 & 90.58 & 89.26& 89.73 & 84.47 & 86.88& 90.14 & 64.30 & 73.56\\
& TPT
& 76.37 & - & -& 80.02 & 92.22 & 85.56& 80.90 & 91.52 & 85.72& 81.53 & 90.83 & 85.72\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{89.16} & - & -& \textbf{89.29} & \textbf{95.85} & \textbf{92.43}& \textbf{89.32} & \textbf{97.79} & \textbf{93.34}& \textbf{89.10} & \textbf{95.75} & \textbf{92.21}\\
\midrule
\multirow{5}*{CIFAR-100}
& ZS-CLIP
& 44.69 & - & -& 46.35 & 85.17 & 59.77& 47.48 & 84.66 & 60.61& 48.82 & 83.65 & 61.43\\
& Tent
& 53.54 & - & -& 56.77 & 82.97 & 67.19& 58.07 & 66.79 & 61.36& 53.17 & 41.63 & 45.14\\
& SoTTA
& 52.62 & - & -& 56.25 & 85.24 & \textbf{67.57}& 59.16 & 81.36 & 68.34& 62.07 & 72.69 & 66.86\\
& TPT
& 41.90 & - & -& 43.72 & \textbf{86.30} & 57.84& 44.84 & \textbf{85.80} & 58.73& 46.01 & \textbf{85.10} & 59.57\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{62.52} & - & -& \textbf{63.24} & 75.14 & 65.29& \textbf{63.88} & 81.99 & \textbf{70.19}& \textbf{64.28} & 82.21 & \textbf{70.83}\\
\midrule
\multirow{5}*{CUB-200-2011}
& ZS-CLIP
& 33.08 & - & -& 35.65 & 87.96 & 50.72& 37.95 & 85.71 & 52.59& 40.86 & 82.05 & 54.54\\
& Tent
& 36.69 & - & -& 39.14 & 82.75 & 53.08& 37.75 & 54.78 & 44.38& 31.45 & 21.34 & 25.21\\
& SoTTA
& 36.16 & - & -& 39.07 & 87.43 & 53.99& 41.81 & 83.82 & 55.77& 45.13 & 76.30 & 56.69\\
& TPT
& 32.07 & - & -& 34.93 & \textbf{89.49} & 50.24& 37.30 & 87.59 & 52.31& 39.84 & \textbf{84.66} & 54.18\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{49.47} & - & -& \textbf{51.00} & 86.08 & \textbf{63.98}& \textbf{52.10} & \textbf{90.77} & \textbf{66.14}& \textbf{53.39} & \textbf{83.99} & \textbf{65.17}\\

\midrule
\multirow{5}*{STANFORD-CARS}
& ZS-CLIP
& 39.02 & - & -& 47.44 & 98.84 & 64.10& 52.65 & 98.13 & 68.53& 54.82 & 97.44 & 70.16\\
& Tent
& 40.95 & - & -& 49.33 & 97.88 & 65.60& 51.83 & 85.22 & 64.09& 33.88 & 29.26 & 30.72\\
& SoTTA
& 40.60 & - & -& 49.44 & 98.55 & 65.84& 54.03 & 96.47 & 69.27& 54.66 & 87.40 & 67.25\\
& TPT
& 38.38 & - & -& 46.19 & 99.02 & 62.98& 51.70 & 98.36 & 67.77& 54.06 & 97.79 & 69.63\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{58.53} & - & -& \textbf{62.41} & \textbf{99.03} & \textbf{76.57}& \textbf{62.80} & \textbf{99.66} & \textbf{77.05}& \textbf{63.10} & \textbf{99.75} & \textbf{77.30}\\
\midrule
\multirow{5}*{Food-101}
& ZS-CLIP
& 72.93 & - & -& 79.34 & 95.59 & 86.71& 80.62 & 94.65 & 87.07& 81.50 & 93.96 & 87.28\\
& Tent
& 76.20 & - & -& 81.47 & 85.00 & 82.68& 80.87 & 69.34 & 71.90& 63.38 & 30.37 & 39.10\\
& SoTTA
& 75.02 & - & -& 81.14 & 93.70 & 86.96& 82.20 & 89.79 & 85.80& 82.33 & 79.18 & 80.61\\
& TPT
& 71.92 & - & -& 78.49 & 95.79 & 86.28& 79.77 & 95.03 & 86.73& 80.64 & 94.33 & 86.95\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{86.21} & - & -& \textbf{86.36} & \textbf{98.31} & \textbf{91.95}& \textbf{86.44} & \textbf{98.85} & \textbf{92.23}& \textbf{86.51} & \textbf{98.53} & \textbf{92.12}\\

\midrule
\multirow{5}*{Oxford-IIIT Pet}
& ZS-CLIP
& 70.17 & - & -& 77.99 & 89.34 & 83.27& 79.53 & 87.73 & 83.41& 80.96 & 85.69 & 83.24\\
& Tent
& 73.36 & - & -& 79.90 & 86.64 & 83.10& 80.84 & 70.91 & 75.41& 74.81 & 32.87 & 45.64\\
& SoTTA
& 72.58 & - & -& 79.61 & 87.38 & 83.30& 81.36 & 84.03 & 82.66& 82.84 & 78.21 & 80.44\\
& TPT
& 69.44 & - & -& 76.98 & 90.96 & 83.38& 78.56 & 89.78 & 83.78& 79.95 & 87.75 & 83.66\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{84.91} & - & -& \textbf{85.39} & \textbf{96.94} & \textbf{90.80}& \textbf{85.84} & \textbf{98.06} & \textbf{91.54}& \textbf{85.89} & \textbf{97.59} & \textbf{91.36}\\
\midrule
\multirow{5}*{ImageNet}
& ZS-CLIP
& 47.68 & - & -& 51.00 & 84.72 & 63.66& 53.38 & 82.38 & 64.77& 55.64 & 79.64 & 65.50\\
& Tent
& 49.86 & - & -& 53.18 & 78.58 & 63.43& 53.67 & 64.05 & 57.66& 49.74 & 45.93 & 45.89\\
& SoTTA
& 49.82 & - & -& 52.36 & 74.92 & 61.63& 53.39 & 67.16 & 59.47& 52.53 & 57.03 & 54.68\\
& TPT
& 46.12 & - & -& 49.48 & 86.38 & 62.91& 51.85 & 84.48 & 64.25& 54.04 & 82.24 & 65.21\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{63.96} & - & -& \textbf{62.53} & \textbf{86.82} & \textbf{72.62}& \textbf{62.24} & \textbf{88.67} & \textbf{73.09}& \textbf{61.53} & \textbf{85.52} & \textbf{71.52}\\
\midrule
\multirow{5}*{ImageNet-K}
& ZS-CLIP
& 30.48 & - & -& 31.92 & 81.26 & 45.83& 33.41 & 79.33 & 47.01& 34.76 & 77.17 & 47.93\\
& Tent
& 33.66 & - & -& 35.40 & 71.84 & 47.37& 35.07 & 58.91 & 43.11& 31.60 & 41.60 & 34.34\\
& SoTTA
& 34.20 & - & -& 35.70 & 72.08 & 47.74& 36.23 & 65.32 & 46.60& 35.44 & 56.08 & 43.43\\
& TPT
& 28.78 & - & -& 30.15 & 83.59 & 44.30& 31.50 & 81.95 & 45.50& 32.73 & \textbf{80.22} & 46.49\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{36.54} & - & -& \textbf{38.40} & \textbf{85.81} & \textbf{52.98}& \textbf{39.78} & \textbf{83.15} & \textbf{53.77}& \textbf{40.02} & 78.07 & \textbf{52.91}\\
\midrule
\multirow{5}*{ImageNet-A}
& ZS-CLIP
& 31.47 & - & -& 32.94 & \textbf{79.21} & 46.52& 34.22 & 77.81 & 47.53& 35.67 & 75.87 & 48.52\\
& Tent
& 32.09 & - & -& 33.55 & 78.14 & 46.94& 34.70 & 75.81 & 47.60& 35.38 & 70.22 & 47.05\\
& SoTTA
& 33.43 & - & -& 34.72 & 78.06 & 48.06& 36.25 & 75.79 & 49.04& 38.23 & 71.33 & 49.77\\
& TPT
& 30.45 & - & -& 32.05 & 80.92 & 45.91& 33.37 & 79.58 & 47.02& 34.87 & \textbf{78.02} & 48.20\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{45.20} & - & -& \textbf{42.84} & 70.45 & \textbf{52.86}& \textbf{43.36} & \textbf{81.06} & \textbf{56.41}& \textbf{44.06} & 73.46 & \textbf{55.00}\\
\midrule
\multirow{5}*{ImageNet-V2}
& ZS-CLIP
& 43.12 & - & -& 45.60 & 83.36 & 58.93& 47.39 & 81.47 & 59.92& 49.25 & 78.94 & 60.64\\
& Tent
& 43.46 & - & -& 46.11 & 81.95 & 58.99& 48.03 & 77.33 & 59.25& 48.25 & 65.09 & 55.11\\
& SoTTA
& 43.87 & - & -& 46.38 & 80.75 & 58.91& 47.89 & 77.03 & 59.06& 49.01 & 70.30 & 57.75\\
& TPT
& 41.53 & - & -& 44.04 & \textbf{85.38} & 58.09& 46.00 & 83.76 & 59.37& 47.83 & 81.68 & 60.33\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{58.42} & - & -& \textbf{56.37} & 76.77 & \textbf{64.70}& \textbf{56.05} & \textbf{85.89} & \textbf{67.72}& \textbf{56.34} & \textbf{83.12} & \textbf{67.04}\\
\midrule
\multirow{5}*{ImageNet-R}
& ZS-CLIP
& 57.34 & - & -& 59.92 & 87.67 & 71.11& 61.60 & 86.31 & 71.81& 63.14 & 84.79 & 72.30\\
& Tent
& 60.14 & - & -& 62.96 & 86.16 & 72.68& 64.64 & 82.36 & 72.30& 60.97 & 65.95 & 63.07\\
& SoTTA
& 61.62 & - & -& 64.81 & 85.56 & 73.67& 66.50 & 81.05 & 72.99& 68.14 & 70.13 & 69.07\\
& TPT
& 56.20 & - & -& 59.01 & 88.41 & 70.71& 60.61 & 87.09 & 71.40& 62.09 & 85.84 & 71.98\\
\rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{71.54} & - & -& \textbf{71.23} & \textbf{91.61} & \textbf{80.05}& \textbf{71.13} & \textbf{92.28} & \textbf{80.25}& \textbf{70.95} & \textbf{88.95} & \textbf{78.79}\\
\bottomrule
\end{tabular}}
}
\end{table}



\begin{table}[th!]
\caption{Zero-shot noisy TTA results for CIFAR-10/100 as the ID datasets with different random seeds. The results are the mean $\pm$ standard deviation with five random seeds. The \textbf{bold} indicates the best performance on each dataset.}\label{app-tab:CIFAR-seed}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Method}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{10}*{CIFAR-10}
& \multirow{2}*{ZS-CLIP}
& 83.53 & 98.35 & 90.33 & 83.10 & 97.83 & 89.87 & 82.20 & 91.83 & 86.75 & 81.73 & 76.46 & 79.00 & 82.64  & 91.11  & 86.49 \\
& & \small{$\pm$ 0.02} & \small{$\pm$ 0.04} & \small{$\pm$ 0.02} & \small{$\pm$ 0.03} & \small{$\pm$ 0.01} & \small{$\pm$ 0.02} & \small{$\pm$ 0.04} & \small{$\pm$ 0.01} & \small{$\pm$ 0.02} & \small{$\pm$ 0.02} & \small{$\pm$ 0.12} & \small{$\pm$ 0.06} & \small{$\pm$ 0.03} & \small{$\pm$ 0.05} & \small{$\pm$ 0.03} \\
\cmidrule{3-17}
& \multirow{2}*{Tent}
& 87.31 & 54.02 & 66.70 & 88.54 & 70.43 & 78.43 & 89.66 & 88.67 & 89.16 & 88.65 & 64.85 & 74.90 & 88.54  & 69.49  & 77.30 \\
& & \small{$\pm$ 0.30} & \small{$\pm$ 3.13} & \small{$\pm$ 2.50} & \small{$\pm$ 0.33} & \small{$\pm$ 2.71} & \small{$\pm$ 1.80} & \small{$\pm$ 0.07} & \small{$\pm$ 0.13} & \small{$\pm$ 0.05} & \small{$\pm$ 0.10} & \small{$\pm$ 0.58} & \small{$\pm$ 0.40} & \small{$\pm$ 0.20} & \small{$\pm$ 1.64} & \small{$\pm$ 1.19} \\
\cmidrule{3-17}
& \multirow{2}*{SoTTA}
& 89.96 & 80.08 & 84.72 & 90.14 & 91.26 & 90.69 & 89.51 & 90.94 & 90.22 & 89.22 & 74.07 & 80.94 & 89.71  & 84.09  & 86.64 \\
& & \small{$\pm$ 0.14} & \small{$\pm$ 2.06} & \small{$\pm$ 1.19} & \small{$\pm$ 0.11} & \small{$\pm$ 0.72} & \small{$\pm$ 0.38} & \small{$\pm$ 0.12} & \small{$\pm$ 0.11} & \small{$\pm$ 0.07} & \small{$\pm$ 0.17} & \small{$\pm$ 0.18} & \small{$\pm$ 0.13} & \small{$\pm$ 0.14} & \small{$\pm$ 0.77} & \small{$\pm$ 0.44} \\
\cmidrule{3-17}
& \multirow{2}*{TPT}
& 81.79 & 98.89 & 89.53 & 81.38 & 97.96 & 88.90 & 80.46 & 92.10 & 85.89 & 79.90 & 77.39 & 78.62 & 80.88  & 91.58  & 85.74 \\
& & \small{$\pm$ 0.09} & \small{$\pm$ 0.04} & \small{$\pm$ 0.04} & \small{$\pm$ 0.09} & \small{$\pm$ 0.02} & \small{$\pm$ 0.05} & \small{$\pm$ 0.05} & \small{$\pm$ 0.04} & \small{$\pm$ 0.03} & \small{$\pm$ 0.03} & \small{$\pm$ 0.12} & \small{$\pm$ 0.06} & \small{$\pm$ 0.06} & \small{$\pm$ 0.06} & \small{$\pm$ 0.05} \\
\cmidrule{3-17}
& \multirow{2}*{ZS-NTTA~(Ours)}
& 89.36 & 99.87 & 94.32 & 88.30 & 99.66 & 93.64 & 89.55 & 98.68 & 93.89 & 89.63 & 93.43 & 91.49 & 89.21  & 97.91  & 93.33 \\
& & \small{$\pm$ 0.16} & \small{$\pm$ 0.04} & \small{$\pm$ 0.10} & \small{$\pm$ 0.54} & \small{$\pm$ 0.03} & \small{$\pm$ 0.30} & \small{$\pm$ 0.19} & \small{$\pm$ 0.23} & \small{$\pm$ 0.15} & \small{$\pm$ 0.08} & \small{$\pm$ 0.56} & \small{$\pm$ 0.25} & \small{$\pm$ 0.24} & \small{$\pm$ 0.21} & \small{$\pm$ 0.20} \\

\midrule
\multirow{10}*{CIFAR-100}
& \multirow{2}*{ZS-CLIP}
& 48.50 & 97.59 & 64.80 & 49.17 & 95.05 & 64.81 & 46.78 & 81.63 & 59.48 & 45.37 & 64.44 & 53.25 & 47.46  & 84.68  & 60.59 \\
& & \small{$\pm$ 0.07} & \small{$\pm$ 0.04} & \small{$\pm$ 0.07} & \small{$\pm$ 0.08} & \small{$\pm$ 0.06} & \small{$\pm$ 0.06} & \small{$\pm$ 0.05} & \small{$\pm$ 0.03} & \small{$\pm$ 0.04} & \small{$\pm$ 0.06} & \small{$\pm$ 0.13} & \small{$\pm$ 0.06} & \small{$\pm$ 0.07} & \small{$\pm$ 0.06} & \small{$\pm$ 0.06} \\
\cmidrule{3-17}
& \multirow{2}*{Tent}
& 54.72 & 41.45 & 47.17 & 59.80 & 83.27 & 69.61 & 59.07 & 79.42 & 67.74 & 57.36 & 62.08 & 59.63 & 57.74  & 66.55  & 61.04 \\
& & \small{$\pm$ 0.42} & \small{$\pm$ 0.89} & \small{$\pm$ 0.71} & \small{$\pm$ 0.31} & \small{$\pm$ 0.24} & \small{$\pm$ 0.27} & \small{$\pm$ 0.22} & \small{$\pm$ 0.22} & \small{$\pm$ 0.09} & \small{$\pm$ 0.10} & \small{$\pm$ 0.26} & \small{$\pm$ 0.12} & \small{$\pm$ 0.26} & \small{$\pm$ 0.40} & \small{$\pm$ 0.30} \\
\cmidrule{3-17}
& \multirow{2}*{SoTTA}
& 60.30 & 89.43 & 72.03 & 59.91 & 89.24 & 71.69 & 58.63 & 81.70 & 68.27 & 56.92 & 65.76 & 61.02 & 58.94  & 81.53  & 68.25 \\
& & \small{$\pm$ 0.16} & \small{$\pm$ 0.44} & \small{$\pm$ 0.18} & \small{$\pm$ 0.21} & \small{$\pm$ 0.30} & \small{$\pm$ 0.16} & \small{$\pm$ 0.17} & \small{$\pm$ 0.18} & \small{$\pm$ 0.09} & \small{$\pm$ 0.13} & \small{$\pm$ 0.07} & \small{$\pm$ 0.06} & \small{$\pm$ 0.17} & \small{$\pm$ 0.25} & \small{$\pm$ 0.12} \\
\cmidrule{3-17}
& \multirow{2}*{TPT}
& 45.97 & 97.88 & 62.56 & 46.69 & 95.41 & 62.70 & 43.92 & 83.30 & 57.51 & 42.47 & 66.71 & 51.90 & 44.76  & 85.83  & 58.67 \\
& & \small{$\pm$ 0.07} & \small{$\pm$ 0.03} & \small{$\pm$ 0.06} & \small{$\pm$ 0.15} & \small{$\pm$ 0.06} & \small{$\pm$ 0.13} & \small{$\pm$ 0.13} & \small{$\pm$ 0.16} & \small{$\pm$ 0.11} & \small{$\pm$ 0.12} & \small{$\pm$ 0.13} & \small{$\pm$ 0.12} & \small{$\pm$ 0.12} & \small{$\pm$ 0.09} & \small{$\pm$ 0.10} \\
\cmidrule{3-17}
& \multirow{2}*{ZS-NTTA~(Ours)}
& 63.71 & 99.74 & 77.75 & 61.59 & 99.12 & 75.97 & 63.82 & 85.43 & 73.05 & 62.21 & 49.12 & 54.82 & 62.83  & 83.35  & 70.40 \\
& & \small{$\pm$ 0.74} & \small{$\pm$ 0.06} & \small{$\pm$ 0.55} & \small{$\pm$ 1.01} & \small{$\pm$ 0.18} & \small{$\pm$ 0.81} & \small{$\pm$ 1.21} & \small{$\pm$ 1.52} & \small{$\pm$ 1.11} & \small{$\pm$ 1.16} & \small{$\pm$ 2.89} & \small{$\pm$ 1.49} & \small{$\pm$ 1.03} & \small{$\pm$ 1.17} & \small{$\pm$ 0.99} \\

\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Zero-shot noisy TTA results for CIFAR-10/100 as the ID datasets with different random seeds in terms of AUROC and FPR95. The results are the mean $\pm$ standard deviation with five random seeds. The \textbf{bold} indicates the best performance on each dataset.}\label{app-tab:CIFAR-seed-auroc}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{llcc|cc|cc|cc|cc}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Method}&\multicolumn{2}{c}{SVHN}&\multicolumn{2}{c}{LSUN}&\multicolumn{2}{c}{Texture}&\multicolumn{2}{c}{Places}&\multicolumn{2}{c}{Avg}\\
\cmidrule{3-12}
&&AUROC$\uparrow$&FPR95$\downarrow$&AUROC$\uparrow$&FPR95$\downarrow$&AUROC$\uparrow$&FPR95$\downarrow$&AUROC$\uparrow$&FPR95$\downarrow$&AUROC$\uparrow$&FPR95$\downarrow$\\
\cmidrule(lr){3-4}\cmidrule(lr){5-6}\cmidrule(lr){7-8}\cmidrule(lr){9-10}\cmidrule(lr){11-12}
\multirow{10}*{CIFAR-10}
& \multirow{2}*{ZS-CLIP}
& 98.45 & 6.75  & 97.75 & 10.64  & 94.75 & 28.08  & 87.47 & 50.18  & 94.60  & 23.91 \\
& & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  \\
\cmidrule{3-12}
& \multirow{2}*{Tent}
& 75.11 & 48.89  & 87.08 & 34.46  & 96.87 & 16.01  & 87.64 & 46.19  & 86.68  & 36.39 \\
& & \small{$\pm$ 2.21} & \small{$\pm$ 3.14}  & \small{$\pm$ 1.79} & \small{$\pm$ 2.54}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.13}  & \small{$\pm$ 0.10} & \small{$\pm$ 0.38}  & \small{$\pm$ 1.03} & \small{$\pm$ 1.55}  \\
\cmidrule{3-12}
& \multirow{2}*{SoTTA}
& 95.27 & 22.67  & 97.72 & 11.47  & 97.32 & 13.05  & 91.57 & 33.88  & 95.47  & 20.27 \\
& & \small{$\pm$ 0.66} & \small{$\pm$ 2.38}  & \small{$\pm$ 0.16} & \small{$\pm$ 0.73}  & \small{$\pm$ 0.03} & \small{$\pm$ 0.18}  & \small{$\pm$ 0.09} & \small{$\pm$ 0.15}  & \small{$\pm$ 0.23} & \small{$\pm$ 0.86}  \\
\cmidrule{3-12}
& \multirow{2}*{TPT}
& 98.48 & 6.80  & 97.62 & 10.73  & 94.19 & 28.21  & 85.33 & 50.19  & 93.91  & 23.98 \\
& & \small{$\pm$ 0.00} & \small{$\pm$ 0.02}  & \small{$\pm$ 0.01} & \small{$\pm$ 0.04}  & \small{$\pm$ 0.01} & \small{$\pm$ 0.05}  & \small{$\pm$ 0.03} & \small{$\pm$ 0.02}  & \small{$\pm$ 0.01} & \small{$\pm$ 0.03}  \\
\cmidrule{3-12}
& \multirow{2}*{ZS-NTTA~(Ours)}
& 99.95 & 0.13  & 99.82 & 0.41  & 99.70 & 0.58  & 98.80 & 2.38  & 99.57  & 0.87 \\
& & \small{$\pm$ 0.01} & \small{$\pm$ 0.04}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.07}  & \small{$\pm$ 0.04} & \small{$\pm$ 0.08}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.08}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.07}  \\
\midrule

\multirow{10}*{CIFAR-100}
& \multirow{2}*{ZS-CLIP}
& 85.11 & 86.42  & 85.88 & 72.58  & 71.09 & 95.35  & 58.47 & 98.97  & 75.14  & 88.33 \\
& & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.00} & \small{$\pm$ 0.00}  \\
\cmidrule{3-12}
& \multirow{2}*{Tent}
& 45.44 & 81.05  & 84.67 & 62.67  & 80.38 & 73.38  & 68.94 & 91.61  & 69.86  & 77.18 \\
& & \small{$\pm$ 0.82} & \small{$\pm$ 0.59}  & \small{$\pm$ 0.33} & \small{$\pm$ 0.76}  & \small{$\pm$ 0.08} & \small{$\pm$ 0.47}  & \small{$\pm$ 0.06} & \small{$\pm$ 0.18}  & \small{$\pm$ 0.32} & \small{$\pm$ 0.50}  \\
\cmidrule{3-12}
& \multirow{2}*{SoTTA}
& 88.78 & 51.05  & 87.99 & 55.39  & 81.47 & 70.58  & 70.59 & 89.96  & 82.20  & 66.74 \\
& & \small{$\pm$ 0.24} & \small{$\pm$ 0.54}  & \small{$\pm$ 0.13} & \small{$\pm$ 0.79}  & \small{$\pm$ 0.08} & \small{$\pm$ 0.32}  & \small{$\pm$ 0.11} & \small{$\pm$ 0.37}  & \small{$\pm$ 0.14} & \small{$\pm$ 0.51}  \\
\cmidrule{3-12}
& \multirow{2}*{TPT}
& 84.81 & 86.46  & 85.39 & 72.59  & 69.65 & 95.35  & 55.61 & 98.97  & 73.86  & 88.34 \\
& & \small{$\pm$ 0.01} & \small{$\pm$ 0.06}  & \small{$\pm$ 0.01} & \small{$\pm$ 0.01}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.04} & \small{$\pm$ 0.00}  & \small{$\pm$ 0.02} & \small{$\pm$ 0.02}  \\
\cmidrule{3-12}
& \multirow{2}*{ZS-NTTA~(Ours)}
& 99.06 & 3.76  & 98.23 & 5.95  & 93.11 & 21.45  & 77.72 & 67.59  & 92.03  & 24.69 \\
& & \small{$\pm$ 0.13} & \small{$\pm$ 0.95}  & \small{$\pm$ 0.22} & \small{$\pm$ 1.32}  & \small{$\pm$ 0.63} & \small{$\pm$ 2.37}  & \small{$\pm$ 0.75} & \small{$\pm$ 1.69}  & \small{$\pm$ 0.43} & \small{$\pm$ 1.58}  \\
\bottomrule
\end{tabular}}
}
\end{table}



\subsection{Ablation Studies on Hyper-parameters Selection}\label{app:sec-noisy-detector-output}
Ablation studies on varying queue capacities $L$, queue lengths $N_q$, and optimization steps $N$ are presented in Table~\ref{app-tab:CIFAR-l}, Table~\ref{app-tab:CIFAR-nq}, and Table~\ref{app-tab:CIFAR-init-steps}, respectively. The results demonstrate that AdaND is robust to changes in these hyper-parameters. For the main experiments, we set $L=128$, $N_q=512$, and found that $N=10$ optimization steps are sufficient to initialize the noise detector. Overall, AdaND shows low sensitivity to hyper-parameter choices, achieving optimal performance across all datasets. Table~\ref{app-tab:CIFAR-vlm} explores the performance with different backbones. Our AdaND consistently outperforms other methods across all backbone configurations.


Intuitively, once the noise detector outperforms ZS-CLIP in detection results, it would be more accurate to use its outputs as pseudo-labels.
We conducted experiments with various noise ratios and ID datasets in Table~\ref{app-tab:pseudo-labels}.
Although using the outputs of the noise detector as pseudo-labels can result in better performance on some datasets, it can also lead to severe performance drops in certain cases, which is intolerable.
For example, using ImageNet as the ID dataset with a $50\%$ noise ratio, the performance \textit{drops from $73.09\%$ to $41.34\%$} when using the outputs of the noise detector as pseudo-labels.
We suppose this discrepancy arises from cumulative errors when using the noise detector's results as pseudo-labels. To better handle varying ID datasets and noise ratios, we use ZS-CLIP's result as pseudo-labels, which is more robust.



\begin{table}[th!]
\caption{Ablation studies on the queue capacity $L$ for noise detector updates in the method with CIFAR-10/100 as the ID datasets.}\label{app-tab:CIFAR-l}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{$L$}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{5}*{CIFAR-10}
& 32
& 88.92 & 99.95 & 94.11 & 87.98 & 99.77 & 93.50 & 89.09 & 97.86 & 93.27 & 88.95 & 87.98 & 88.46 & 88.73 & 96.39 & 92.33 \\
& 64
& 89.37 & 99.96 & 94.37 & 88.21 & 99.68 & 93.59 & 89.57 & 98.39 & 93.77 & 89.49 & 90.16 & 89.82 & 89.16 & 97.05 & 92.89 \\
& 128
& 89.46 & 99.90 & 94.39 & 88.56 & 99.66 & 93.78 & 89.60 & 98.54 & 93.86 & 89.65 & 93.04 & 91.31 & 89.32 & 97.79 & 93.34 \\
& 256
& 89.03 & 99.75 & 94.09 & 88.01 & 99.08 & 93.22 & 89.21 & 97.69 & 93.26 & 89.16 & 93.68 & 91.36 & 88.85 & 97.55 & 92.98 \\
& 512
& 88.36 & 99.49 & 93.60 & 87.14 & 98.34 & 92.40 & 88.29 & 95.91 & 91.94 & 88.21 & 90.78 & 89.48 & 88.00 & 96.13 & 91.86 \\
% & 1024
% & 86.54 & 99.05 & 92.37 & 84.97 & 96.62 & 90.42 & 86.31 & 92.99 & 89.53 & 86.30 & 84.16 & 85.22 & 86.03 & 93.21 & 89.39 \\

\midrule
\multirow{5}*{CIFAR-100}
& 32
& 61.31 & 99.91 & 75.99 & 59.80 & 99.68 & 74.75 & 60.52 & 86.47 & 71.20 & 57.14 & 57.55 & 57.34 & 59.69 & 85.90 & 69.82 \\
& 64
& 63.94 & 99.80 & 77.94 & 61.56 & 99.48 & 76.06 & 63.63 & 85.98 & 73.14 & 60.06 & 50.86 & 55.08 & 62.30 & 84.03 & 70.55 \\
& 128
& 64.44 & 99.78 & 78.31 & 62.42 & 99.15 & 76.61 & 65.17 & 84.84 & 73.72 & 63.50 & 44.21 & 52.13 & 63.88 & 81.99 & 70.19 \\
& 256
& 63.64 & 99.38 & 77.59 & 61.10 & 97.82 & 75.22 & 64.17 & 83.45 & 72.55 & 63.65 & 41.41 & 50.18 & 63.14 & 80.51 & 68.89 \\
& 512
& 61.01 & 98.88 & 75.46 & 56.26 & 95.18 & 70.72 & 61.38 & 77.75 & 68.60 & 60.44 & 43.56 & 50.63 & 59.77 & 78.84 & 66.35 \\
% & 1024
% & 54.59 & 97.97 & 70.11 & 48.23 & 92.64 & 63.43 & 54.95 & 72.43 & 62.49 & 51.48 & 49.41 & 50.42 & 52.31 & 78.11 & 61.61 \\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Ablation studies on the queue capacity $N_q$ for queue length to store the output score in the method with CIFAR-10/100 as the ID datasets.}\label{app-tab:CIFAR-nq}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{$N_q$}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{5}*{CIFAR-10}
& 64
& 88.16 & 99.90 & 93.66 & 87.35 & 99.60 & 93.07 & 88.70 & 98.81 & 93.48 & 89.10 & 94.59 & 91.76 & 88.33 & 98.22 & 92.99 \\
& 128
& 89.41 & 99.90 & 94.36 & 88.61 & 99.63 & 93.80 & 89.63 & 98.52 & 93.86 & 89.65 & 93.09 & 91.34 & 89.32 & 97.78 & 93.34 \\
& 256
& 89.46 & 99.90 & 94.39 & 88.53 & 99.65 & 93.76 & 89.62 & 98.52 & 93.86 & 89.65 & 93.08 & 91.33 & 89.31 & 97.79 & 93.33 \\
& 512
& 89.46 & 99.90 & 94.39 & 88.56 & 99.66 & 93.78 & 89.60 & 98.54 & 93.86 & 89.65 & 93.04 & 91.31 & 89.32 & 97.79 & 93.34 \\
& 1024
& 89.43 & 99.91 & 94.38 & 88.51 & 99.65 & 93.75 & 89.62 & 98.57 & 93.88 & 89.64 & 93.01 & 91.29 & 89.30 & 97.78 & 93.33 \\

\midrule
\multirow{5}*{CIFAR-100}
& 64
& 64.19 & 99.65 & 78.08 & 62.64 & 98.73 & 76.65 & 64.61 & 84.64 & 73.28 & 62.10 & 46.96 & 53.48 & 63.38 & 82.49 & 70.37 \\
& 128
& 64.92 & 99.72 & 78.64 & 62.86 & 98.90 & 76.87 & 65.28 & 84.35 & 73.60 & 63.51 & 46.15 & 53.46 & 64.14 & 82.28 & 70.64 \\
& 256
& 64.68 & 99.76 & 78.48 & 62.65 & 98.97 & 76.73 & 65.33 & 84.55 & 73.71 & 63.58 & 44.45 & 52.32 & 64.06 & 81.93 & 70.31 \\
& 512
& 64.44 & 99.78 & 78.31 & 62.42 & 99.15 & 76.61 & 65.17 & 84.84 & 73.72 & 63.50 & 44.21 & 52.13 & 63.88 & 81.99 & 70.19 \\
& 1024
& 64.22 & 99.77 & 78.14 & 62.04 & 99.21 & 76.34 & 65.10 & 85.13 & 73.78 & 63.33 & 46.30 & 53.49 & 63.67 & 82.60 & 70.44 \\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Ablation studies for the different initialization steps in the method with CIFAR-10/100 as the ID datasets.}\label{app-tab:CIFAR-init-steps}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Step}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{6}*{CIFAR-10}
& 0
& 88.49 & 98.64 & 93.29 & 86.79 & 97.99 & 92.05 & 89.27 & 97.48 & 93.19 & 89.51 & 92.45 & 90.96 & 88.52 & 96.64 & 92.37 \\
& 10
& 89.46 & 99.90 & 94.39 & 88.56 & 99.66 & 93.78 & 89.60 & 98.54 & 93.86 & 89.65 & 93.04 & 91.31 & 89.32 & 97.79 & 93.34 \\
& 20
& 89.13 & 99.76 & 94.15 & 88.35 & 99.66 & 93.66 & 89.20 & 98.28 & 93.52 & 89.20 & 92.18 & 90.67 & 88.97 & 97.47 & 93.00 \\
& 30
& 88.81 & 99.68 & 93.93 & 88.03 & 99.53 & 93.43 & 88.80 & 97.91 & 93.13 & 88.75 & 91.23 & 89.97 & 88.60 & 97.09 & 92.62 \\
& 40
& 88.48 & 99.56 & 93.69 & 87.70 & 99.42 & 93.19 & 88.37 & 97.44 & 92.68 & 88.34 & 89.85 & 89.09 & 88.22 & 96.57 & 92.16 \\
& 50
& 88.21 & 99.45 & 93.49 & 87.49 & 99.20 & 92.98 & 88.01 & 96.97 & 92.27 & 87.98 & 88.33 & 88.15 & 87.92 & 95.99 & 91.72 \\

\midrule
\multirow{6}*{CIFAR-100}
& 0
& 63.39 & 98.72 & 77.21 & 60.72 & 98.15 & 75.03 & 64.42 & 83.91 & 72.88 & 62.12 & 43.74 & 51.33 & 62.66 & 81.13 & 69.11 \\
& 10
& 64.44 & 99.78 & 78.31 & 62.42 & 99.15 & 76.61 & 65.17 & 84.84 & 73.72 & 63.50 & 44.21 & 52.13 & 63.88 & 81.99 & 70.19 \\
& 20
& 63.75 & 99.61 & 77.74 & 62.76 & 99.00 & 76.82 & 64.14 & 85.99 & 73.47 & 62.68 & 45.20 & 52.52 & 63.33 & 82.45 & 70.14 \\
& 30
& 62.51 & 99.52 & 76.79 & 61.89 & 98.97 & 76.16 & 62.80 & 86.48 & 72.76 & 61.25 & 47.26 & 53.35 & 62.11 & 83.06 & 69.77 \\
& 40
& 61.30 & 99.41 & 75.84 & 60.77 & 98.72 & 75.23 & 61.42 & 86.51 & 71.84 & 59.79 & 48.74 & 53.70 & 60.82 & 83.34 & 69.15 \\
& 50
& 60.37 & 99.29 & 75.09 & 59.90 & 98.46 & 74.49 & 60.25 & 86.08 & 70.89 & 58.47 & 51.19 & 54.59 & 59.75 & 83.75 & 68.76 \\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Ablation studies on VLM's architecture with CIFAR-10 as the ID datasets.}\label{app-tab:CIFAR-vlm}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{ll*{15}{c}}
\toprule
\multirow{2}*{Backbone}&\multirow{2}*{Method}&\multicolumn{3}{c}{SVHN}&\multicolumn{3}{c}{LSUN}&\multicolumn{3}{c}{Texture}&\multicolumn{3}{c}{Places}&\multicolumn{3}{c}{Avg}\\
\cmidrule{3-17}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}\cmidrule(lr){15-17}
\multirow{5}*{RN50}
& ZS-CLIP
& 51.73 & 99.84 & 68.15 & 49.90 & 97.47 & 66.01 & 50.09 & 93.91 & 65.33 & 47.75 & 71.13 & 57.14 & 49.87 & 90.59 & 64.16 \\
& Tent
& 16.81 & 47.90 & 24.89 & 20.31 & 63.46 & 30.77 & 29.19 & 54.21 & 37.95 & 24.82 & 33.72 & 28.59 & 22.78 & 49.82 & 30.55 \\
& SoTTA
& 19.12 & 64.20 & 29.46 & 22.07 & 84.22 & 34.97 & 29.62 & 83.94 & 43.79 & 26.22 & 61.15 & 36.70 & 24.26 & 73.38 & 36.23 \\
& TPT
& 51.02 & \textbf{99.87} & 67.54 & 48.90 & 97.52 & 65.14 & 49.01 & 94.13 & 64.46 & 46.20 & 72.34 & 56.39 & 48.78 & 90.97 & 63.38 \\
% \rowcolor{gray!22}\cellcolor{white}
& AdaND~(Ours)
& \textbf{67.05} & 99.69 & \textbf{80.18} & \textbf{63.29} & \textbf{98.39} & \textbf{77.03} & \textbf{68.95} & \textbf{96.85} & \textbf{80.55} & \textbf{68.66} & \textbf{84.88} & \textbf{75.91} & \textbf{66.99} & \textbf{94.95} & \textbf{78.42}\\


\midrule
\multirow{5}*{ViT-L/14}
& ZS-CLIP
& 90.71 & 96.46 & 93.50 & 90.85 & 95.70 & 93.21 & 90.55 & 91.77 & 91.16 & 89.91 & 75.72 & 82.21 & 90.50 & 89.91 & 90.02 \\
& Tent
& 90.54 & 36.08 & 51.60 & 93.52 & 80.30 & 86.41 & 93.94 & 90.35 & 92.11 & 93.42 & 68.95 & 79.34 & 92.86 & 68.92 & 77.37 \\
& SoTTA
& 93.90 & 70.96 & 80.83 & 94.14 & 91.80 & 92.96 & 94.02 & 90.28 & 92.11 & 93.74 & 71.44 & 81.08 & 93.95 & 81.12 & 86.74 \\
& TPT
& 89.98 & 96.55 & 93.15 & 90.14 & 95.98 & 92.97 & 89.78 & 91.99 & 90.87 & 89.23 & 76.13 & 82.16 & 89.78 & 90.16 & 89.79 \\
& AdaND~(Ours)
& \textbf{94.77} & \textbf{99.65} & \textbf{97.15} & \textbf{94.50} & \textbf{99.67} & \textbf{97.02} & \textbf{94.87} & \textbf{98.65} & \textbf{96.72} & \textbf{94.86} & \textbf{89.95} & \textbf{92.34} & \textbf{94.75} & \textbf{96.98} & \textbf{95.81}\\
\bottomrule
\end{tabular}}
}
\end{table}


\begin{table}[th!]
\caption{Ablation studies for pseudo-labels generated by the noise detector under various noise ratios.
\textcolor{red}{Red} indicates a performance drop when using the outputs of the noise detector as pseudo-labels in terms of $\text{Acc}_\text{H}$. For CIFAR-10/100, results are averaged across four OOD datasets: SVHN, LSUN, Texture, and Places. For other ID datasets, averaging includes four OOD datasets: iNaturalist, SUN, Texture, and Places. Note that 0\% indicates the clean data stream.}\label{app-tab:pseudo-labels}
\centering{
\setlength\tabcolsep{5pt} 
\resizebox{\linewidth}{!}{
\begin{tabular}{llccc|ccc|ccc|ccc}
\toprule
\multirow{2}*{ID}&\multirow{2}*{Pseudo-label}&\multicolumn{3}{c}{0\%}&\multicolumn{3}{c}{25\%}&\multicolumn{3}{c}{50\%}&\multicolumn{3}{c}{75\%}\\
\cmidrule{3-14}
&&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$&$\text{Acc}_\text{S}$&$\text{Acc}_\text{N}$&$\text{Acc}_\text{H}$\\
\cmidrule(lr){3-5}\cmidrule(lr){6-8}\cmidrule(lr){9-11}\cmidrule(lr){12-14}
\multirow{2}*{CIFAR-10}
& Noise Detector
& 89.16 & - & -& 89.42 & 75.47 & \textcolor{red}{74.31}& 89.53 & 98.94 & 94.00& 89.34 & 99.24 & 94.03\\
& Frozen Model
& 89.16 & - & -& 89.29 & 95.85 & 92.43& 89.32 & 97.79 & 93.34& 89.10 & 95.75 & 92.21\\
\midrule
\multirow{2}*{CIFAR-100}
& Noise Detector
& 64.82 & - & -& 65.20 & 72.57 & 65.80& 66.33 & 96.08 & 78.44& 66.53 & 75.22 & \textcolor{red}{61.74}\\
& Frozen Model
& 62.52 & - & -& 63.24 & 75.14 & 65.29& 63.88 & 81.99 & 70.19& 64.28 & 82.21 & 70.83\\
\midrule
\multirow{2}*{CUB-200-2011}
& Noise Detector
& 52.47 & - & -& 53.72 & 88.55 & 66.84& 53.94 & 95.85 & 69.03& 54.67 & 97.93 & 70.17\\
& Frozen Model
& 49.47 & - & -& 51.00 & 86.08 & 63.98& 52.10 & 90.77 & 66.14& 53.39 & 83.99 & 65.17\\
\midrule
\multirow{2}*{STANFORD-CARS}
& Noise Detector
& 62.07 & - & -& 62.82 & 99.27 & 76.94& 63.11 & 99.66 & 77.28& 63.37 & 99.75 & 77.51\\
& Frozen Model
& 58.53 & - & -& 62.41 & 99.03 & 76.57& 62.80 & 99.66 & 77.05& 63.10 & 99.75 & 77.30\\
\midrule
\multirow{2}*{Food-101}
& Noise Detector
& 86.23 & - & -& 86.38 & 98.00 & 91.82& 86.45 & 99.17 & 92.37& 86.49 & 99.58 & 92.57\\
& Frozen Model
& 86.21 & - & -& 86.36 & 98.31 & 91.95& 86.44 & 98.85 & 92.23& 86.51 & 98.53 & 92.12\\
\midrule
\multirow{2}*{Oxford-IIIT Pet}
& Noise Detector
& 84.95 & - & -& 85.42 & 96.84 & 90.77& 85.85 & 98.18 & 91.60& 85.91 & 98.81 & 91.91\\
& Frozen Model
& 84.91 & - & -& 85.39 & 96.94 & 90.80& 85.84 & 98.06 & 91.54& 85.89 & 97.59 & 91.36\\
\midrule
\multirow{2}*{ImageNet}
& Noise Detector
& 66.23 & - & -& 66.15 & 26.11 & \textcolor{red}{23.30}& 65.57 & 48.47 & \textcolor{red}{41.34}& 65.21 & 47.62 & \textcolor{red}{40.08}\\
& Frozen Model
& 63.96 & - & -& 62.53 & 86.82 & 72.62& 62.24 & 88.67 & 73.09& 61.53 & 85.52 & 71.52\\
\midrule
\multirow{2}*{ImageNet-K}
& Noise Detector
& 45.42 & - & -& 45.72 & 30.26 & \textcolor{red}{24.83}& 45.61 & 98.24 & 62.30& 45.55 & 99.13 & 62.42\\
& Frozen Model
& 36.54 & - & -& 38.40 & 85.81 & 52.98& 39.78 & 83.15 & 53.77& 40.02 & 78.07 & 52.91\\
\midrule
\multirow{2}*{ImageNet-A}
& Noise Detector
& 45.52 & - & -& 45.06 & 20.25 & \textcolor{red}{26.84}& 45.49 & 57.15 & \textcolor{red}{45.39}& 45.25 & 53.84 & \textcolor{red}{39.55}\\
& Frozen Model
& 45.20 & - & -& 42.84 & 70.45 & 52.86& 43.36 & 81.06 & 56.41& 44.06 & 73.46 & 55.00\\
\midrule
\multirow{2}*{ImageNet-V2}
& Noise Detector
& 58.59 & - & -& 58.67 & 19.27 & \textcolor{red}{27.53}& 57.98 & 50.21 & \textcolor{red}{45.42}& 57.31 & 51.58 & \textcolor{red}{44.22}\\
& Frozen Model
& 58.42 & - & -& 56.37 & 76.77 & 64.70& 56.05 & 85.89 & 67.72& 56.34 & 83.12 & 67.04\\
\midrule
\multirow{2}*{ImageNet-R}
& Noise Detector
& 73.43 & - & -& 73.55 & 28.53 & \textcolor{red}{27.97}& 72.97 & 97.75 & 83.56& 72.56 & 98.50 & 83.57\\
& Frozen Model
& 71.54 & - & -& 71.23 & 91.61 & 80.05& 71.13 & 92.28 & 80.25& 70.95 & 88.95 & 78.79\\
\bottomrule
\end{tabular}}
}
\end{table}