\section{Adaptive Threshold vs. Fixed Threshold}\label{app:adaptive_threshold}
To verify the reliability of the adaptive threshold used in our experiments, we compared the performance of the adaptive threshold with fixed thresholds across various ID datasets, where the fixed threshold ranges from 0.1 to 0.9. Due to time and computational resource limitations, we conduct experiments on the following ID datasets: CIFAR-10, CIFAR-100, CUB-200-2011, STANFORD-CARS, Food-101, and Oxford-IIIT Pet. All ID datasets are tested on their respective four OOD datasets, and the specific ID-OOD dataset correspondences can be found in Table~\ref{app:dataset_details}.
The average metrics are shown in Fig.~\ref{fig: Reliable Baselines}. It is clear that in terms of $\text{Acc}_\text{H}$, the adaptive threshold consistently surpassed all fixed thresholds in ZS-CLIP, SoTTA, and our AdaND. The average performance of Tent and TPT using adaptive thresholds is comparable to that of the optimal fixed thresholds. We suppose this is because the classifiers of Tent and TPT experience performance degradation due to noisy samples. Since adaptive thresholds do not require hyperparameter tuning for different ID datasets, we employ the adaptive threshold strategy across all methods.


\begin{figure*}[h]
\centering
\begin{subfigure}{0.48\textwidth}
\centering
\includegraphics[width=\textwidth]{figs/ZS-CLIP_all_ID.pdf}
\caption{ZS-CLIP}
\end{subfigure}
\hfill
\begin{subfigure}{0.48\textwidth}
\centering
\includegraphics[width=\textwidth]{figs/Tent_all_ID.pdf}
\caption{Tent}
\end{subfigure}

\begin{subfigure}{0.48\textwidth}
\centering
\includegraphics[width=\textwidth]{figs/SoTTA_all_ID.pdf}
\caption{SoTTA}
\end{subfigure}
\hfill
\begin{subfigure}{0.48\textwidth}
\centering
\includegraphics[width=\textwidth]{figs/TPT_all_ID.pdf}
\caption{TPT}
\end{subfigure}

\begin{subfigure}{0.48\textwidth}
\centering
\includegraphics[width=\textwidth]{figs/ZS-NTTA_all_ID.pdf}
\caption{Ours}
\end{subfigure}

% \vspace{-10pt}
\caption{Results about Adaptive threshold(dashed line) and fixed threshold(solid line) range from 0.1 to 0.9. Best viewed with zoom-in.}\label{fig: Reliable Baselines}
% \vspace{-10pt}
\end{figure*}