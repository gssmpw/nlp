\section{Lattice-based cryptography and SVPs}
\label{sec:SVPs}

In this section, we recall the fundamentals of the key generator described in the NIST report FIPS 203 \cite{NIST203}. Since this cryptosystem is a symmetric public key system, the key generator has to produce both a private and a public key for encryption and decryption. The public key consists of vectors 
$$
\hat{t}_l \in \mathbb{Z}_q^n, l \in \left\{1,\ldots,k\right\},
$$
which can be compiled to a single vector $t \in \mathbb{Z}_q^{nk}$:
$$
t = \left( \hat{t}_1,\ldots, \hat{t}_k \right)^T
$$
and further vectors
$$
a^{(ij)} = \left(a_1^{(ij)},\ldots,a_n^{(ij)} \right)^T \in \mathbb{Z}_q^{n}, i,j \in \left\{1,\ldots,k\right\},
$$
where $n \in \mathbb{N}$ is the characteristic key length of the public key. For $k$ it holds according to \cite{NIST203}: $k \in \left\{2,3,4\right\}$ and $q \in \mathbb{N}$ is the modulus of the ring $\mathbb{Z}_q$. The vectors $a^{(ij)}$ are sampled from a uniform distribution. Based on $a^{(ij)}$, we construct matrices $A_{ij} \in \mathbb{Z}_q^{n \times n}$:
$$
A_{ij} = 
\begin{pmatrix} a_1^{(ij)} & -a_{n}^{(ij)} & \ldots & -a_2^{(ij)} \\ 
                a_2^{(ij)} &  a_1^{(ij)}     & \ldots & -a_3^{(ij)} \\
                \vdots     &  \vdots         &   & \vdots \\
                a_{n}^{(ij)} & a_{n-1}^{(ij)}  & \ldots & a_{1}^{(ij)}
\end{pmatrix}
$$
The matrix $A_{ij}$ is a T\"oplitz matrix, i.e., on each diagonal from top to bottom is the same element \cite{Gray06}. Each column vector is generated by a cyclic permutation of the components in $a^{(ij)}$ and to the entries in the upper triangular part a minus sign is assigned. All the submatrices can assigned to a further matrix $A \in \mathbb{Z}_q^{nk \times nk}$:
$$
A= \begin{pmatrix} A_{11} & \cdots & A_{1k} \\ \vdots & \ddots &  \vdots \\  A_{k1} & \cdots & A_{kk}\end{pmatrix}.
$$
Next, we sample the secret vector or private key $s \in \mathbb{Z}_q^{nk}$ as well as the error vector $e \in \mathbb{Z}_q^{nk}$ from a discrete Gaussian distribution such that the absolute values of $s$ and $e$ are bounded by $2$ or $3$. $s$ and $e$ have the following structure:
\begin{align*}
s &= \left( \hat{s}_1, \ldots, \hat{s}_k \right)^T,\;\hat{s}_l \in \mathbb{Z}_q^{n}, \\
e &= \left( \hat{e}_1, \ldots, \hat{e}_k \right)^T,\;\hat{e}_l \in \mathbb{Z}_q^{n}.
\end{align*}
Using $A$, $s$ and $e$, the missing part of the public key $t$ can be determined:
\begin{equation}
    \label{eq:LWE1}
t = A \cdot s + e,
\end{equation}
where all the arithmetic operations have to be performed in the ring $\mathbb{Z_q}$. For a potential attacker, the matrix $A$ and the vector $t$ are known, while the vectors $s$ and $e$ have to be determined. This problem is know as LWE problem. Since a LWE problem is not well-posed, \eqref{eq:LWE1} is reformulated. In the remainder of this section, we present the most important steps. $\mathbf{0}$ denotes either a vector filled with zeros or a matrix filled with zeros.
\ \\
\begin{itemize}
    \item[]\textbf{Step (1):} In a first step the lattice 
    $$
    \Lambda = \left\{ \left. x \in \mathbb{Z}^{2m+1} \right| x^T \left( \left. A \right| \left. I_m \right| -t \right) \equiv \mathbf{0} \mod q \right\},
    $$
    is constructed, where $I_m$ is the identity matrix with $m$ rows and columns. Obviously, it holds that the vector
    $$
    y = \left( \left. s \right| \left. e \right| 1 \right)^T \in \mathbb{Z}^{2m+1}
    $$
    is contained in $\Lambda$. For convenience, we set: $m=kn$
    \ \\ 
    \item[]\textbf{Step (2):} The rows of the matrix 
    \begin{equation}
    \label{eq:LWE2}
    B = \begin{pmatrix} I_m & -A^T & \mathbf{0} \\ \mathbf{0} & q I_m & \mathbf{0} \\  \mathbf{0} & t^T & 1
    \end{pmatrix}
    \end{equation}
    form a basis of the lattice $\Lambda$, provided that computing linear combinations of the rows integer valued coefficients are used. Compiling the matrix $B$ in this way is also known as Bai and Galbraithâ€™s embedding \cite{Albrecht17}. 
    \ \\
    \item[]\textbf{Step (3):} We compute $y$ by solving the following optimization problem (shortest vector problem, SVP):
    \begin{equation}
    \label{eq:LWE3}
    z = \text{argmin}_{x \in \mathbb{Z}^{2m+1} \setminus \left\{\mathbf{0}\right\}} \left\| x^T B \right\|_2.
    \end{equation}
    After that, we set:
    $$
    z^T B = y^T \Leftrightarrow y = B^T \cdot z.
    $$
    Solving an SVP is based on the fact that $s$ and $e$ are sampled from a discrete Gaussian distribution with a small standard deviation. 
\end{itemize}