
\begin{algorithm}
\caption{Compute aligned root mean squared distance via Kabsch
Algorithm}\label{alg:compute_aligned_rmsd}
\begin{algorithmic}
\Procedure{ComputeAlignedRMSD}{$\{\vec x_{l}^{\mathrm{pred}}\}, \{\vec x_{l}^{\mathrm{design}}\}$}
    \LeftCommentOne{Center lists of coordinates by subtracting centers of mass}
%    \State $\vec{\mu}^{\mathrm{pred}} \leftarrow $
%    \State $\vec{\mu}^{\mathrm{design}} \leftarrow $
    \State $\{\vec{x}_l^{\mathrm{pred}}\} \leftarrow \{\vec{x}^{\mathrm{pred}}_{l} -\frac{1}{L}\sum_{l^\prime=1}^{L} \vec{x}^{\mathrm{pred}}_{l^\prime}\}$
        \Comment {$l \in \{1, \dots, L\}$}
    \State $\{\vec{x}_l^{\mathrm{design}}\} \leftarrow \{\vec{x}^{\mathrm{design}}_{l} - \frac{1}{L}\sum_{l^\prime=1}^{L} \vec{x}^{\mathrm{design}}_{l^\prime}\}$
        \Comment {$l \in \{1, \dots, L\}$}
    
    %\LeftCommentOne{Compute }
    %\State $H \leftarrow (\vec{X}^{\mathrm{pred}})^T\vec{X}^{\mathrm{design}}$
    
    \State
    \LeftCommentOne{Compute singular value decomposition of cross-covariance matrix}
    \State $U\Sigma V^T \leftarrow \texttt{SVD}( \sum_{l} \vec{x}_l^{\mathrm{pred}}(\vec{x}_l^{\mathrm{design}})^T)$
    
    \State
    \LeftCommentOne{If $UV^T$ is not a rotation, apply a reflection along direction with least singular value}
    \State $d \leftarrow \text{sign}(\det(UV^T))$
    \State $S \leftarrow \begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & d \end{pmatrix}$
    
    \State
    \LeftCommentOne{Compute and apply optimal rotation matrix}
    \State $R \leftarrow VS U^T$
    \State $\{\vec{x}_l^{\mathrm{aligned}}\} \leftarrow \{R\vec{x}_l^{\mathrm{pred}}\}$
        \Comment {$l \in \{1, \dots, L\}$}
    
    \State
    \LeftCommentOne{Compute the square root of the mean squared distance (RMSD}
    \State $\text{RMSD} \leftarrow \sqrt{\frac{1}{L}\sum_{l=1}^{L} \|\vec{x}^{\mathrm{aligned}}_{l} - \vec{x}^{\mathrm{design}}_{l}\|^2}$
    
    \Return RMSD
\EndProcedure
\end{algorithmic}
\end{algorithm}

\Cref{alg:test_scaffold} relies on the 
Kabsch algorithm to compute the minimum aligned root mean squared distance between atomic structures.
We detail this computation in \Cref{alg:compute_aligned_rmsd}.

