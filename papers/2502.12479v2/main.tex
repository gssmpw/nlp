\documentclass{article}


\usepackage{svg} % Load the svg package
\usepackage{graphicx} % For general image handling
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{tcolorbox} % For boxed environments
\usepackage{threeparttable} % For footnotes in tables
\usepackage{caption}        % For caption control
\usepackage{booktabs}       % For better table aesthetics
\usepackage{listings} % For code snippets
\usepackage{tabularx}
\usepackage{tabularray}
\usepackage{changepage}
\usepackage{bbding}
\usepackage{diagbox}
\usepackage{setspace}
\usepackage[page,header]{appendix}
\usepackage{titling}
\setlength{\droptitle}{-1cm}



%\newcommand{\LeftComment}[1]{\Statex \hspace{-\algorithmicindent} {\# #1}}
\newcommand{\LeftComment}[1]{\Statex  {\# #1}}
\newcommand{\LeftCommentOne}[1]{\Statex \hspace{\algorithmicindent} {\# #1}}
\newcommand{\LeftCommentTwo}[1]{\Statex \hspace{\algorithmicindent}\hspace{\algorithmicindent} {\# #1}}
% Redefine for loop to exclude "do" and "end for"
\algrenewcommand\algorithmicfor{\textbf{for}}
%\algrenewcommand\algorithmicendfor{\unskip}
\algtext*{EndFor} % Remove "end for"

% Redefine if statement to exclude "then" and "end if"
\algrenewcommand\algorithmicif{\textbf{if}}
%\algrenewcommand\algorithmicendif{\unskip}
\algtext*{EndIf} % Remove "end if"
\algrenewtext{algorithmicthen}{} % Remove "then"

\algtext*{EndProcedure} % Remove "end for"

\usepackage[numbers,sort&compress]{natbib}
\bibliographystyle{unsrtnat}
\usepackage[hidelinks]{hyperref}
\usepackage{longtable}
\usepackage{lscape}
\usepackage{amsmath,amsfonts}
\usepackage{cleveref}

\usepackage{authblk} % For multiple affiliations
% Replicate ICML-style affiliation formatting:
\renewcommand\Affilfont{\footnotesize}  % Use smaller font for affiliations
\makeatletter
\renewcommand{\AB@affilsepx}{, }         % Separate multiple affiliations with a comma and space
\makeatother


\usepackage{xcolor}
\definecolor{blue}{rgb}{0,0, 0.8}
\newcommand{\BLT}[1]{\textcolor{blue}{ {\small \ (brian)} #1}}
\newcommand{\zzq}[1]{\textcolor{teal}{ {\small \ (zhuoqi)} #1}}
\newcommand{\bozhang}[1]{\textcolor{purple}{ {\small \ (bozhang)} #1}}


\usepackage{geometry}
\geometry{a4paper, margin=1in}
%\usepackage{graphicx} % Required for inserting images


\title{MotifBench: A standardized protein design benchmark for motif-scaffolding problems}
\author[1]{Zhuoqi Zheng}
\author[1,2]{Bo Zhang}
\author[3,4]{Kieran Didi}
\author[5]{Kevin K. Yang}
\author[6]{Jason Yim}
\author[7]{Joseph L. Watson}
\author[1]{Hai-Feng Chen}
\author[8,9]{Brian L. Trippe\thanks{Correspondence to: btrippe@stanford.edu}}

\affil[1]{Department of Bioinformatics and Biostatistics, Shanghai Jiao Tong University}
\affil[2]{School of Life Sciences, Tsinghua University}
\affil[3]{Department of Computer Science, Oxford University}
\affil[4]{NVIDIA}
\affil[5]{Microsoft Research}
\affil[6]{Department of Computer Science, Massachusetts Institute of Technology}
\affil[7]{Department of Biochemistry, University of Washington}
\affil[8]{Department of Statistics, Stanford University}
\affil[9]{Stanford Data Science, Stanford University}

\begin{document}
\maketitle
\vspace{-0.5cm}



\begin{abstract}
The motif-scaffolding problem is a central task in computational protein design:
Given the coordinates of atoms in a geometry chosen to confer a desired biochemical function (a motif), the task is to identify diverse protein structures (scaffolds) that include the motif and maintain its geometry.
Significant recent progress on motif-scaffolding has been made due to computational evaluation with reliable protein structure prediction and fixed-backbone sequence design methods \citep{tischer2020design,wang2022scaffolding,trippe2022diffusion,watson2022broadly,ingraham2023illuminating,young2024diffusion,song2023joint,wu2024practical,chen2023amalga,didi2023framework,alamdari2023protein,zhang2023protein,hayes2024simulating,yim2024improved,lin2024out,wang2024dplm,frank2024scalable}.
However, significant variability in evaluation strategies across publications has hindered comparability of results, challenged reproducibility, and impeded robust progress.
In response we introduce MotifBench, comprising
    (1) a precisely specified pipeline and evaluation metrics, 
    (2) a collection of 30 benchmark problems, and 
    (3) an implementation of this benchmark and leaderboard at \url{github.com/blt2114/MotifBench}.
The MotifBench test cases are more difficult compared to earlier benchmarks (e.g.\ \citep{watson2022broadly}),
and include protein design problems for which solutions are known but on which, to the best of our knowledge, state-of-the-art methods fail to identify any solution.


\end{abstract}
\begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\textwidth]{resources/overview.png} % Load the PDF
    \label{fig:overview} % Label for referencing
\end{figure}

\tableofcontents
\addtocontents{toc}{\protect\setcounter{tocdepth}{1}} % Ensure only top-level sections appear
\thispagestyle{empty}  % No page number on the title page
\clearpage             % Start a new page
\setcounter{page}{1}   % Restart page numbering here
\pagebreak
\section{The motif-scaffolding problem: task specification and evaluation metrics}\label{sec:task_specification}
\input{main/task_specification}
%
%
%
\section{The MotifBench test cases: composition and considerations
}\label{sec:benchmark_cases}
\input{main/benchmark_cases}
%
%
\section{Benchmark implementation details}
\input{main/evaluation_scripts}
%
\section{Community guidelines}
\input{main/community_guidelines}

%
\section*{Acknowledgements}
\input{main/acknowledgments}

\pagebreak

\bibliography{references}

\newpage
\appendix
\addtocontents{toc}{\protect\setcounter{tocdepth}{-1}}
\appendixpage

This appendix is organized as follows.
\Cref{sec:considerations} provides a discussion of choices incorporated into the MotifBench evaluation approach beyond those described in the main text.
\Cref{sec:kabsch_alg} provides the algorithm for computing aligned error that is part of the evaluation pipeline but which was deferred from \Cref{sec:task_specification}.
\Cref{sec:motif_vis} provides visualizations of each of the test cases and an problem specification file.
Finally, \Cref{sec:demo} provides full results of the evaluations described in \Cref{section:baseline_section}.

\section{Considerations and subjective choices in MotifBench evaluation}\label{sec:considerations}
\input{supp/considerations_and_choices}

\section{Algorithmic details of aligned error computation}\label{sec:kabsch_alg}
\input{supp/kabsch_alg}


\section{Test case visualizations and example specification}\label{sec:motif_vis}
\input{supp/benchmark_cases_info}

%\section{Other metrics and scaffold sequence variation.}
%\input{other_metrics_and_sequence_benchmark}

\section{Evaluation example complete results}\label{sec:demo}
\input{supp/rfdiffusion_baseline}


\end{document}
