\newcommand\deff[1][λ]{d_{\textup{eff}}\prt*{#1}}
\newcommand\dsp{\cZ} 	% Data space
\newcommand\tmpc{c'}	% To remove / rename
\newcommand\dd{ξ}	% density difference
\newcommand\kFT{K^{\wedge}}	% Fourier transform of K
\newcommand\kTFT{K_T^{\wedge}}	% Fourier transform of K

%\DeclareDocumentCommand\sft{O{}}{K_T^{\wedge}}	% Fourier transform of K

\newcommand\sn[1]{{\color{blue}[#1]}}	% Fourier transform of K

\DeclareDocumentCommand\als{g}{\hat{\ell}_{λ}\IfNoValueF{#1}{(#1)}} % Approx. LS
\DeclareDocumentCommand\tls{g}{\ell_{λ}\IfNoValueF{#1}{(#1)}} % Approx. LS
\NewDocumentCommand\kmat{O{n}}{K_{#1}}

% Kernels
\newcommand\rkhs{\cH} 	% RKHS
%\newcommand\supfmap{κ}
%\newcommand\supk{\supfmap²}
\newcommand\supfmap{‖\kr‖_∞^{1/2}}
\newcommand\supk{‖\kr‖_∞}


\newcommand\gk{κ^{\textup{G}}}
\newcommand\gks{κ_σ^{\textup{G}}}
\newcommand\supfmapgks{‖\gks‖_∞^{1/2}}
\newcommand\supkgks{‖\gks‖_∞}
\newcommand\supfmapgk{‖\gk‖_∞^{1/2}}
\newcommand\supkgk{‖\gk‖_∞}

\DeclarePairedDelimiter{\nLT}{\lVert}{\rVert_{L²(ℝ²)}}	

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  Notations for two sample testing                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\lat{\cT(\nX,\nY,α)} 	% Exact level α tests
\newcommand\ats{S} 	% Abstract test statistic
\newcommand\at{T_{\nX,\nY}} 	% Abstract test
\newcommand\tte[1][ρ]{R_{#1}} 	% Abstract test
\newcommand\alt[1][D,ρ]{\cP_1(\cC,#1)} 	% Abstract test

\newcommand\tsl{\hat{Ψ}}
\NewDocumentCommand{\ts}{e{^}O{X,Y}}{\tsl\IfValueT{#1}{^{#1}}\IfNoValueF{#2}{(#2)}}
\NewDocumentCommand\pts{O{σ}}{\ts^{#1}}
\NewDocumentCommand\pstsU{O{X,Y}}{\hat{U}^σ\IfNoValueF{#1}{(#1)}}
\NewDocumentCommand\pstsR{O{X,Y}}{\hat{R}^σ\IfNoValueF{#1}{(#1)}}
\NewDocumentCommand\nysts{O{X,Y}}{\hat{Ψ}_{\textup{Nys}}\IfNoValueF{#1}{(#1)}}
%\NewDocumentCommand\ipts{g}{M\IfNoValueF{#1}{_{#1}}} % indexed (w.r.t. permutation) permuted test statistic
\NewDocumentCommand\ipts{g}{\hat{Ψ}\IfNoValueF{#1}{_{#1}}} % indexed (w.r.t. permutation) permuted test statistic
\NewDocumentCommand\oipts{g}{\hat{Ψ}\IfValueT{#1}{_{(#1)}}} % ordered indexed (w.r.t. ordering) permuted test statistic

\newcommand\X{X}
\newcommand\Y{Y}
\newcommand\XY{W}
\newcommand\nX{n_X}
\newcommand\nY{n_Y}
\newcommand\dX{\hat{P}}
\newcommand\dY{\hat{Q}}

\newcommand\covP{C_P}
\newcommand\covQ{C_Q}

\newcommand\nf{\ell}	% Nb. of features 

\newcommand\np{\cP} % number of permutations
\newcommand\bs{b} % batch size
\newcommand\nb{s} % number of batches (total)
\newcommand\nbX{s_X} % number of batches (for X) (≈s_m in CTT)
\newcommand\nbY{s_Y} % number of batches (for Y) (≈s_n in CTT)
\NewDocumentCommand\bme{m}{μ_{#1}} % batch mean embedding
\NewDocumentCommand\pbme{m}{μ^σ_{#1}} % permuted batch mean embedding
%\NewDocumentCommand\pbme{m}{μ_{σ(#1)}} % permuted batch mean embedding
\NewDocumentCommand\kme{g}{μ\IfValueT{#1}{{(#1)}}} % KME
\NewDocumentCommand\kmeP{}{μ(P)} % KME of P
\NewDocumentCommand\kmeQ{}{μ(Q)} % KME of Q
\NewDocumentCommand\kmeX{}{μ(\X)} % Emp. KME of X
\NewDocumentCommand\kmeY{}{μ(\Y)} % Emp. KME of Y
\NewDocumentCommand\bkme{m}{μ\IfValueT{#1}{_{#1}}} % KME for i-th batch 
\NewDocumentCommand\bakme{m}{\tfmap\IfValueT{#1}{_{#1}}} % ME of the features for i-th batch 

\newcommand\tq[1][α]{q_{1-#1}(\X,\Y)}	% Test Quantile
\newcommand\pstsUq{q_{1-α,\hat{U}^σ}(\X,\Y)}	% Quantile of the U-stat (conditional)
\newcommand\eq{\hat{q}_{1-α}(\pts|\X,\Y)}	% Estimator of the quantile

\newcommand\thr{\oipts{b_α}}

\newcommand\ldms{Z}
\DeclareDocumentCommand\ldm{g}{z\IfNoValueF{#1}{_{#1}}}
\DeclareDocumentCommand\ldmX{g}{\tilde{x}\IfNoValueF{#1}{_{#1}}}
\DeclareDocumentCommand\ldmY{g}{\tilde{y}\IfNoValueF{#1}{_{#1}}}
\DeclareDocumentCommand\ftldmsX{}{Φ_{\tilde{X}}}
\DeclareDocumentCommand\ftldmsY{}{Φ_{\tilde{Y}}}
\DeclareDocumentCommand\ftldms{}{Φ_{Z}}

\DeclareDocumentCommand\eMMDv{}{\cE_{\MMD}}
\DeclareDocumentCommand\eMMD{O{δ}O{\nX}O{\nY}}{\cE_{\MMD}(#2,#3,#1)}
\DeclareDocumentCommand\eKME{O{δ}O{n}}{\cE_{\textup{KME}}(#2,#1)}
\DeclareDocumentCommand\eb{O{δ}O{n}}{\cE_{b}(#2,#1)}	% just the sup of both
\DeclareDocumentCommand\edb{O{δ}}{\cE_{b}(\nX,\nY,#1)}	% just the sup of both

\newcommand\Up{U_{σ}}
\newcommand\UpL{U_{σ,L}}
\newcommand\UpLz{U_{σ,L,ζ}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                               Nyström                               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\lX{\ell_X}
\newcommand\lY{\ell_Y}
%\newcommand\Kl{K_{\nf}}
\newcommand\Kl{K_{\ldms}}
%\newcommand\Pm{P_{\nf}}
\newcommand\Pm{P_{\ldms}}
\newcommand\Pmo{\Pm^⟂}
\newcommand\Pl{\Pm}
\newcommand\Plo{\Pmo}
%\newcommand\PmX{P_X}
%\newcommand\PmY{P_Y}
\newcommand\PmX{P_{\tilde{X}}}
\newcommand\PmY{P_{\tilde{Y}}}
\newcommand\PmXo{\PmX^⟂}
\newcommand\PmYo{\PmY^⟂}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Other features                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NewDocumentCommand\kr{g}{κ\IfValueT{#1}{{(#1)}}}		% Base kernel
\NewDocumentCommand\fmap{g}{ϕ\IfValueT{#1}{{(#1)}}}				% Base kernel feature map

\NewDocumentCommand\tk{g}{\tilde{κ}\IfValueT{#1}{{(#1)}}}		% Test kernel
\NewDocumentCommand\tfmap{g}{φ\IfValueT{#1}{{(#1)}}}		% Test feature map
\newcommand\fmaprf{φ_{\textup{RF}}}
\newcommand\nysfmapH{ϕ_{\textup{Nys}}}	% In H
\newcommand\nysfmap{φ_{\textup{Nys}}}	% In ℝ^m
\newcommand\nysk{\tilde{k}_{\textup{Nys}}}

