\section{Introduction}

The increasing electricity demand across the world, coupled with the efforts towards a sustainable and zero-emission energy system, are significantly transforming the energy landscape. Distributed and renewable energy sources (RESs) are at the forefront of this transformation, providing a cost-effective, environment-friendly way to generate energy. However, compared to the reliable but fossil-fuel-based traditional resources, the power produced by RESs tends to be highly variable and unpredictable due to heavy dependence on weather conditions, such as sunlight and wind~\cite{Oshnoei_2020, Saini_2023, afzal2024security, mohan2020comprehensive, Ibraheem_2023}. For the electricity grid to operate, there must be an almost perfect balance between power production and consumption~\cite{Rinaldi_2022}. The consequences of large imbalances could be serious with an impact on safety, such as blackouts in given areas or damage to connected equipment which could result in fires. %The grid balance is estimated in real-time by measuring the alternating current (AC) frequency of the grid. If the frequency is 50 Hz, the consumers and producers are in balance. Increased power demand from consumers can drag the frequency down if the production cannot keep up, while reduced power demand causes the frequency to rise if production does not decrease. 

As distributed RESs become common and constitute a larger share of the energy mix, balancing supply and demand within the power grid to maintain a reliable energy supply becomes increasingly difficult~\cite{iva_sv√§ngmassa,problem_renewable_load_demand}. One solution to counteract the balancing difficulties in the grid is to use flexible assets such as battery energy storage systems (BESSs), heat pumps, electric vehicles (EVs), and vehicle-to-grid (V2G) systems, that can either store surplus power, quickly adapt their energy consumption, or inject more energy into the grid in the event of unforeseen supply and demand~\cite{flex_report}. 

Energy communities (ECs) is an initiative led by the European Union to accelerate the transition towards a cleaner, sustainable, and resilient energy future. In energy communities, citizens collectively generate, consume, store, share, and sell power from RESs to achieve common goals such as energy independence, environmental sustainability, and financial efficiency. At the heart of these energy communities are cloud-based management platforms that centrally manage these communities and the operation of flexible assets, including controllable loads, generators, batteries, and inverters, which are physically located within individual households. To optimize community and operations, these management platforms coordinate critical decisions, such as scheduling energy consumption, determining the timing and quantity of energy generation, and managing battery storage and discharge. 

Unfortunately, as previous research has shown~\cite{novel-EC, impact-EC}, ECs are vulnerable and increase the power grid's exposure to cyber threats. One reason for the increased risk is the cloud-based community management that typically relies on public communication networks, such as the Internet. Additionally, these management platforms also typically host a web service to allow community members to connect and access a dashboard to visualize their community metrics. This functionality enables many web application and authentication vulnerabilities and in combination with the outdated, yet prevalent usage of legacy protocols, expands the attack surface. Consequently, adversaries can remotely connect to the management platform and if they can infiltrate the platform by exploiting any vulnerability, they can gain unauthorized access and control over multiple assets such as generators, batteries, and flexible loads within the managed communities. They can then manipulate the operation of assets to disturb the delicate balance between energy generation, storage, and consumption. These vulnerabilities make the ECs vulnerable to many potential attacks, which have recently been shown to be practical~\cite{security-bess} and potentially devastating for the electrical grid. The situation is critical as the quantity and capacity of flexibility in the grid is expected to significantly increase over the coming years.

%add ref to daniel's theses above

Securing ECs is essential to maintaining the integrity and availability of the electrical grid. Therefore, detection and mitigation of potential attacks exploiting the vulnerabilities is of paramount importance. However, existing detection methods are not well-suited for energy communities, as they do not consider the complex interdependencies between generation, storage, and consumption. To address this, we propose an anomaly-based intrusion detection system (IDS) specifically designed for energy communities. The IDS is proposed to be deployed within each household and connected to the local area network (LAN) on which assets like generators with inverters, batteries, and flexible loads are connected. The goal of the proposed system is to detect anomalies in power generation, storage, and consumption that may indicate an attack. By detecting such threats, the IDS aims to ensure the continued stability and security of ECs, facilitating their safe and sustainable integration into the modern smart grid. The key contributions of this work are as follows:

%\begin{itemize}
\begin{enumerate}

     \item an open-source operational dataset for an EC, including both benign and malicious scenarios. %Simulink simulation model of an energy community and operational data, encompassing both benign and malicious scenarios. 
    \item an IDS framework capable of detecting anomalies in energy communities.
    \item demonstration of real-world potential of the framework by using a federated model that enables detection while preserving privacy.

    \end{enumerate}
%\end{itemize}

The remainder of this paper is structured as follows. Section 2 provides the necessary background and an overview of the related work. It also highlights the gaps in the literature that we aim to fill. Section 3 describes our method; the simulation environment, attack scenarios, autoencoder-based intrusion detection and its formalization, and an approach to enable a privacy-friendly detection using federated learning. Section 4 presents the experimental results and evaluates the proposed system's detection performance. Section 5 provides a discussion on the results, their implications, and outlines future research directions. Finally, section 5 provides conclusions.


%%An energy community consists of interconnected energy prosumers (producers and consumers) that exchange energy and optimize its use. Ensuring the security of this system is critical to maintaining its stability, efficiency, and reliability. However, malicious actors may attempt cyber intrusions, such as \textit{False Data Injection (FDI) attacks}, which manipulate sensor readings to disrupt the system's operation.  

% We want to develop a cyber-physical IDPS that can be employed to detect and mitigate certain cyber-attacks in energy communities. In these communities, typically the cloud-based community management platform centrally manages and controls different devices/systems (flexible loads, generators, batteries, inverters, etc.) physically located in households. The communication between the manager and energy communities makes use of the public communication network (Internet). Under normal operating conditions, grid operation is optimized by controlling when to use certain loads, when and how much energy to generate, and when to charge the batteries or inject the stored power back to the grid. This balancing act is very crucial and if an attacker can control multiple generators and batteries by for example gaining full control over the community management platform, it can violate the stability of the grid. Detecting these attacks against the availability of the grid where an adversary causes unexpected power manipulations by either absorbing or injecting large amounts of electric power, is the focus of the IDPS. The proposed IDPS is placed within each energy community and connected to the local LAN on which other devices such as BMS, generator with inverter, and loads connect. In particular, the IDPS aims to detect situations where the generation of more power or its release to the grid will affect the grid balance. It can also detect unsafe battery charging and power injection.


%The IDPS uses autoencoders to monitor and analyse the energy flow and device behaviour within RECs. Autoencoders, as unsupervised learning models, excel at identifying subtle deviations from expected patterns in high-dimensional data, making them particularly suitable for detecting complex and evolving cyber-physical threats. The system is trained and evaluated using data generated from a MATLAB-based simulation model that emulates real-world REC operations under both normal and attack scenarios.

