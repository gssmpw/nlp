\begin{tcolorbox}[
breakable,
title=Gameplay AI policy component as texts,  
colframe=gray, 
colback=white,
]
\begin{lstlisting}[language=markdown]
**Prioritize Building Melds**
Focus on arranging cards in the hand into matched sets of either three or four of a kind, or sequences of three or more cards of the same suit. Discard cards that do not contribute towards completing a meld.

**Draw from Discard Pile Judiciously**
Only draw from the discard pile when the top two cards can be directly used to form a meld or significantly improve the hand. Otherwise, prefer drawing from the stock pile to maintain unpredictability.

**Reserve Key Cards**
Keep hold of high-value cards like aces and face cards only if they are part of an ongoing strategy to complete a meld or if they are necessary to win the game soon. Otherwise, discard them to minimize penalty points.

**PotentialMeldCreationValue**
A metric that assesses the potential of forming new melds after drawing two cards, either from the stock pile or discard pile. It evaluates the likely improvement in the hand's structure, considering both the draw options and the current meld opportunities.

**UnmatchedCardPenalty**
A metric that evaluates the penalty incurred from holding high-value unmatched cards. This metric helps in deciding the priority of discarding high-value cards from the hand to lower potential score penalties.

**Refined Meld Building Strategy** (Mutually inspired policy)
To refine the strategy for building melds, the AI player should incorporate the following steps: prioritize drawing from the source that maximizes 'PotentialMeldCreationValue.' When choosing cards to discard, evaluate based on 'UnmatchedCardPenalty,' preferably discarding high-penalty cards unless they significantly contribute to potential melds. Use 'MeldCompletionLikelihood' to assess laying off opportunities. Lastly, factor in 'OpponentInterferenceRisk' to prevent assisting opponents with your discards. These criteria ensure strategic decision-making based on the game state, maximizing winning potential and minimizing penalties.
\end{lstlisting}
\end{tcolorbox}

\begin{tcolorbox}[
breakable,
title=Gameplay AI policy component in code,  
colframe=gray, 
colback=white,
]
\begin{lstlisting}[]
def score(state: dict, action: str) -> float:
    # Helper function to calculate the potential meld creation value
    def calculate_potential_meld_creation_value(hand, card):
        value = 0
        # Check for potential sets (three or four of a kind)
        rank_count = sum(1 for c in hand if c['rank'] == card['rank'])
        if rank_count == 2: # possibility to make a set of three
            value += 0.3
        if rank_count == 3: # possibility to make a set of four
            value += 0.5
                    
        # Check for potential sequences
        card_ranks = {'A': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6,
                      '7': 7, '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13}
        hand_ranks = [card_ranks[c['rank']] for c in hand if c['suit'] == card['suit']]
        hand_ranks.append(card_ranks[card['rank']])
        hand_ranks.sort()
        
        # Look for consecutive cards
        for i in range(len(hand_ranks) - 2):
            if hand_ranks[i+1] == hand_ranks[i] + 1 and hand_ranks[i+2] == hand_ranks[i] + 2:
                value += 0.4
                
        return value
        
    # Helper function to calculate unmatched card penalty
    def calculate_unmatched_card_penalty(hand):
        penalty = 0
        for card in hand:
            penalty += {'A': 11, 'K': 10, 'Q': 10, 'J': 10,
                        '10': 10, '9': 9, '8': 8, '7': 7,
                        '6': 6, '5': 5, '4': 4, '3': 3, '2': 2}[card['rank']]
        return penalty

    # Extract relevant information
    current_player_index = state['common']['current_player']
    current_player = state['players'][current_player_index]
    hand = current_player['facedown_cards']['hand']
    discard_pile = state['common']['faceup_cards']['discard_pile']

    # Initialize the result score
    result_score = 0.0

    # Calculate potential meld creation value of the action
    if action == "draw":
        draw_source = state['legal_actions'][0]['args']['source']  # assuming we're provided with actions arguments
        
        # Check both stock and discard pile for card drawing
        if draw_source == "stock":
            # Assuming uncertainty based draw, hence less score boost
            result_score += 0.1  # a relatively small optimistic boost for drawing
        elif draw_source == "discard_pile":
            if discard_pile:
                top_discard_card = discard_pile[-1]
                result_score += calculate_potential_meld_creation_value(hand, top_discard_card)
            else:
                result_score += 0.05  # minor score addition when discard pile is empty

    # Evaluating penalty for unmatched cards
    unmatched_penalty = calculate_unmatched_card_penalty(hand)
    result_score -= unmatched_penalty * 0.01  # reduce score proportionally to the penalty

    # Make sure that the final score is between 0 and 1\n    result_score = max(0, min(1, result_score))

    return result_score
\end{lstlisting}
\end{tcolorbox}