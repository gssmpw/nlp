\section{Appendix}

% \begin{figure*}[!tbp]
% \centering
%     \includegraphics[width=\textwidth,valign=c]{./figures/multi_layer_ml.png}
% \caption{Money laundering groups identified in real-world digital currency transactions. From left to right, different colors indicate various layers of accounts involved in the entire money laundering process. The initial layer of nodes represents sources, while the final layer represents destinations. The larger group is formed by merging detected subgroups with similar intermediate nodes.}
% \label{fig:sim_thd}
% \end{figure*}

\begin{table}[hb]
\small
\centering
\caption{Summary of notations}
\begin{tabular*}{8cm}{r|l}
\toprule
\textbf{Notation} & \textbf{Description} \\ 
\midrule
$\mathcal{G}$ & transaction graph\\
$\mathcal{G}'$ & transaction graph with inversed direction \\
$m$ & number of hash functions used in MinHash\\
$r$ & number of rows of each band \\ 
$K$ & number of bloom filters \\ 
$S$ & the set of cross-institution transactions find with $\mathcal{G}$ \\ 
$D$ & the set of cross-institution transactions find with $\mathcal{G}'$ \\
$\mathcal{S, D}$ & list of sets $S$ and $D$ \\
$M$ & Signature matrix\\
$B$ & Banding matrix\\

\bottomrule
\end{tabular*}
% \end{spacing}
\label{tab:notations}
\vspace{-3mm}
\end{table}


% \subsection{Dataset statistics}
% \label{ssec: datasets}
% We present details of the datasets used in our experiments in Table~\ref{tab: datasets}.  We generate the dataset using AMLSim\cite{AMLSim}, which supports generating a transaction graph with a specified number of accounts (represented as $|\mathcal{V}|$) and transactions (represented as $|\mathcal{E}|$). With the graph data, we simulate two institutions by randomly dividing all accounts into two groups (represented as $\mathcal{V}_1$ and $\mathcal{V}_2$). Each group of accounts, as well as the transactions they were involved, compose the data owned by one institution. 

% \begin{table}[hbt!]
%     \centering
%     \caption{Statistics of synthetic datasets. $|\mathcal{V}|$ represents the total number of accounts, $|\mathcal{E}|$ represents the total number of transactions, and $\mathcal{|O|}$ is the number of outer accounts.}
%     \label{tab: datasets}
%     \begin{tabular}{ccccccccccc}
%         \toprule  % 顶部线
%     % 		Dataset & Nodes & Edges & Features & Classes\\
%         Dataset & \makecell{$|\mathcal{V}|$} & \makecell{$\mathcal{|E|}$} & \makecell{Number of money\\ laundering groups} & \makecell{Number of money\\ laundering accounts} & Group size  \\
%         % $|\mathcal{V}_1|$ & $|\mathcal{E}_1|$ & $|\mathcal{V}_2|$ & $|\mathcal{E}_2|$ & $|\mathcal{O}|$\\
%         \midrule
%         % \cmidrule(r){2-4}  \cmidrule(r){5-7}
%         \noalign{\smallskip} 
%          % & M=5 & M=10 & M=15 & M=5 & M=10 & M=15 \\
%         % \cmidrule(r){2-4}  \cmidrule(r){5-7}
%         \noalign{\smallskip} 
%         $\textit{Syn\_bal}$ &  \numprint{100000} & \numprint{1957005} & \numprint{100} & \numprint{9970} & 10-200 \\ 
%         % \numprint{50000} & \numprint{1653870} & \numprint{50000} & \numprint{1364455} & \numprint{1061320}\\
%         $\textit{Syn\_unb}$ & \numprint{100000} & \numprint{1959234} & \numprint{100} & \numprint{10747} & 10-200 \\ 
%         % \numprint{75000} & \numprint{1844664} &\numprint{25000} & \numprint{919211} & \numprint{804641}\\
%         % $D_3$ &  &  &  & & &  &  & &  &\\
        
%         \bottomrule \\

%         \toprule
%         Dataset & $|\mathcal{V}_1|$ & $|\mathcal{E}_1|$ & $|\mathcal{V}_2|$ & $|\mathcal{E}_2|$ & $|\mathcal{O}|$\\
%         \midrule
%         $\textit{Syn\_bal}$ & \numprint{50000} & \numprint{1653870} & \numprint{50000} & \numprint{1364455} & \numprint{1061320}\\
%         $\textit{Syn\_unb}$ & \numprint{75000} & \numprint{1844664} &\numprint{25000} & \numprint{919211} & \numprint{804641}\\

%         \bottomrule
%     \end{tabular}
% \end{table}
\subsection{Theoretical Analysis}
\label{ssec: theoretical_ayalysis}
\begin{customthm}{1}[restated]
    Suppose that $X_1, ..., X_N$ are a sequence of real values with $0\leq  X_N \leq ... \leq X_1\leq1$. Then $\forall \varepsilon>0$, there $\exists \delta$, s.t. when $r>\delta$,
    $$
    (\sum_{i=1}^N X_1^r)^{1/r} - X_1 \leq \varepsilon.
    $$
\end{customthm}


\begin{proof}
We have
$$
\begin{aligned}
&(\sum_{i=1}^N  X_1^r)^{1/r} - X_1\\
=& \left(x_1^r\left(1+\sum_{i=1}^{N-1}\left(\frac{X_i}{X_1}\right)^r\right)\right)^{1 / r} -X_1\\
=&X_1\left(1+\sum_{i=1}^{N-1}\left(\frac{X_i}{X_1}\right)^r\right)^{1 / r} - X_1\\
=&X_1 \left(\left(1+\sum_{i=1}^{N-1}\left(\frac{X_i}{X_1}\right)^r\right)^{1 / r} -1\right)
\end{aligned}
$$
To prove the inequality, we only need to prove 
$$
\left(1+\sum_{i=1}^{N-1}\left(\frac{X_i}{X_1}\right)^r\right)^{1 / r}  < \frac{\varepsilon}{X_1} + 1
$$
It is easy to prove that 
$$
\begin{aligned}
\left(1+\sum_{i=1}^{N-1}\left(\frac{X_i}{X_1}\right)^r\right)^{1 / r}
\leq & \left(1+ (N-1)\left(\frac{X_2}{X_1}\right)^r\right)^{1 / r}
\\< & 1+ (N-1)\left(\frac{X_2}{X_1}\right)^r
\end{aligned}
$$
When $r > \log_p(\frac{\varepsilon}{X_1 (N-1)})$, we have
$$
1+ (N-1)\left(\frac{X_2}{X_1}\right)^r < \frac{\varepsilon}{X_1} + 1,
$$
where $p = X2/X1$

\end{proof}


\subsection{Dataset Statistics}
\label{ssec:dataset}

\Paragraph{Alipay-ECB.}
Alipay Mobile Payment~\cite{alipay} is the world's largest mobile payment platform, allowing users to pay for a wide range of daily needs, including money transfers, online shopping, salary deposits, investments, and more. 
As of June 2020, Alipay serves over 1.3 billion users and 80 million merchants~\cite{alipay_wiki}, making it an invaluable resource for studying money laundering activities that may be concealed within its vast volume of transaction records. 
Meanwhile, E-Commerce Bank, operating entirely online, serves tens of millions of users and merchants across China, facilitating numerous financial transactions between Alipay and E-Commerce Bank daily. The AlipayECB dataset captures these transactions, with the majority of records originating from Alipay. These include transactions between Alipay users as well as between users and various bank accounts, with ESB being one of the many banks involved. 

\Paragraph{Time span.}
The AlipayECB dataset is constructed using transactions that occurred on Alipay and E-Commerce Bank (ECB) within a single day. Unlike synthetic datasets such as AMLSim~\cite{AMLSim} and AMLWorld~\cite{altman2024realistic}, where transactions within a single money laundering group can span several days~\cite{amlworld_kaggle}, money laundering transactions on digital platforms tend to occur rapidly. Funds are moved in and out quickly to minimize the risk of losses due to account monitoring and censorship. Based on this observation, we focus exclusively on transactions occurring within a single day.

\Paragraph{Data processing.}
To facilitate the experiments on the dataset, we process the data as follows:
\begin{packeditemize}
   \item \textbf{Account Segregation:} A user may link deposits or credit cards from different banks to their Alipay account. As a result, numerous transactions occur between Alipay and the user's cards (e.g., through withdrawal services). To facilitate the tracing of fund flows between different banks, we treat each card as a separate account, even if they belong to the same user.

   \item \textbf{Transaction Aggregation:} Transactions between two accounts may occur multiple times. However, as we mainly focus on a set of transactions, we consolidate these transactions into a single entry. This is different from MultiGIN~\cite{egressy2024provably}, which treats transactions between the same accounts as distinct entities.

   \item \textbf{Transaction Filtering:} Given that money laundering often involves large sums, we filter out transactions with small amounts (around ¥100 in our experiments).
\end{packeditemize}
After applying these steps, we obtain a transaction graph with 48.95 million accounts and 34.45 million transactions. Detailed statistics are presented in Table~\ref{tab:alipay_ecb_datasets}.

\begin{table}[hbt]
    \centering
    \caption{Statistics of Alipay-ECB after processing.}
    \label{tab:alipay_ecb_datasets}
    \resizebox{\linewidth}{!}{
    \begin{tabular}{ccccccc}
        \toprule
        \multicolumn{3}{c}{Accounts} & \multicolumn{4}{c}{Transactions}\\
        \cmidrule(r){1-3}  \cmidrule(r){4-7}
        Alipay & ECB & Others & Alipay $\rightarrow$ Alipay & ECB $\rightarrow$ ECB & Alipay$\rightarrow$ ECB & ECB$\rightarrow$ Alipay\\
        \midrule
        23.46M &  3.99M & 21.50M & 30.84M & 5.51M & 0.25M & 1.65M\\
        \bottomrule
    \end{tabular}
    }
\end{table}

% One challenge of data processing is account alignment between Alipay and ECB. For the same transaction between two Alipay and ECB. The transaction is recorded in both sides to compliance the KYC requirements. However, the involved accounts may recorded differently in both institutions, making the same transaction treated as two different transactions. To solve the problem, we make use of citizen 


\Paragraph{Examples of discovered subgraphs}
Figure~\ref{fig:detected_groups} presents examples of detected groups. Money laundering groups are identified when more than half of their accounts are classified as illicit. Grey groups are those in which only a small number of accounts have been reported for suspected money laundering activities. The normal group is associated with school financial collections.



% \begin{figure}[hbp]
% \centering
% \includegraphics[width=0.45\textwidth,valign=c]{./figures/alipay_results.png}
% \caption{Size of detected money laundering groups.}
% \label{fig:group_size}
% \end{figure}




\begin{table*}[!hbt]
    \centering
    \caption{Statistics of datasets. 
    $|\mathcal{V}|$ denotes the total number of accounts, $|\mathcal{E}|$ denote the total number of transactions, and $|\mathcal{V}_p|$ as well as $|\mathcal{E}_p|$, where $p\in[A,B]$, represent the number of accounts and transactions owned by $\Cli_p$. IR represents an illicit ratio of accounts.}
    \label{tab: datasets}
    % \setlength{\tabcolsep}{4pt}
    % \resizebox{\linewidth}{!}{
    \begin{tabular}{cccccccc}
        \toprule
        Dataset & $|\mathcal{V}|$ & $|\mathcal{E}|$&  $|\mathcal{V}_A|$ & $|\mathcal{E}_A|$ & $|\mathcal{V}_B|$ & $|\mathcal{E}_B|$ & IR\\
        \midrule
        $\textit{AMLSim\_bal}$ &  100K & \numprint{1957005} & 50K & \numprint{1653870} & 50K & \numprint{1364455} & 9.97\%\\
        $\textit{AMLSim\_unb}$ & 100K & \numprint{1959234} & 75K & \numprint{1844664} & 25K & \numprint{919211} & 10.75\%\\
        \midrule
        $\textit{AMLWorld\_HI}$ & \numprint{515020} & \numprint{5073772} & \numprint{257799} & \numprint{3718584} & \numprint{257221}& \numprint{ 3592358} & 0.070\%\\
        $\textit{AMLWorld\_LI}$ & \numprint{705861} & \numprint{6920656} & \numprint{352189} & \numprint{5096798} & \numprint{353672} & \numprint{4880541} & 0.014\%\\
        \midrule
        $\textit{Alipay-ECB}$ & 245M & 336M & 225M & 309M & 19M & 26M & -\\
        \bottomrule
    \end{tabular}
    % }
\end{table*}


\Paragraph{Machine Specs and code.}
The experiments on synthetic datasets were conducted on a single machine using Python 3. The experiments on Alipay-ECB were carried out in Java on a cluster of 20 machines.







\subsection{The impact of number of rows $r$}
\label{ssec:rows_r}
To further investigate the impact of $r$ on estimating similarity in Sim-CSGM, we plot the frequency histogram of repeated elements within a band, as shown in Figure~\ref{fig:sim_fix_hash}. The x-axis represents the number of repetitions, while the y-axis indicates the number of sets that share repeated elements with others. As the number of repeated sets increases, more bias is introduced into the similarity estimation. The results show that most sets differ from others (repeat = 1), but many still share repeated elements. However, the banding technique can significantly reduce the number of repeated elements.

% Although using more bands could improve the performance, the improvement is limited.

\begin{figure}[hbp]
\centering
\includegraphics[width=0.4\textwidth,valign=c]{./figures/repeat_bar.png}
\caption{
The frequency histogram of repeated elements in a band.}
\label{fig:sim_fix_hash}
\end{figure}







\subsection{Efficiency.}
\label{ssec:efficiency}
We evaluate the efficiency of our algorithm in terms of the communication costs among institutions as well as the running time.

\Paragraph{Communication costs.}
The communication costs are primarily induced by the transmission of Bloom filters between institutions. Specifically, each institution needs to transmit its Bloom filters to another institution, with each filter containing values within a band. In our experiments, the Bloom filter size is 500,000 for AMLSim and 3,000,000 for AMLWorld, corresponding to approximately 61.04 KiB and 366.21 KiB, respectively. In our experiments, we adopt 100 Bloom filters, resulting in about 13 MiB and 75 MiB of data transfer per institution.



\Paragraph{Running time.}

We report the running time of applying our methods on the two datasets in Table~\ref{tab:running_time}. The running time for each stage during the execution of the methods is presented, including discovering sets of cross-institution transactions, performing MinHash functions on all sets, inserting bands into Bloom filters, and testing the existence of elements in Bloom filters. On the two AMLSim datasets, our methods take only a few seconds. Even on the larger AMLWorld datasets, CSGM still takes only a few minutes, demonstrating its efficiency. The MinHash calculation process is the most time-consuming, while the membership testing stage is highly efficient, requiring just a few seconds.



\begin{table*}[!htbp]
    \centering
    \caption{Running time in seconds of Sim-CSGM. \textbf{Set discovery} represents the process of discovering sets of cross-institution transactions, \textbf{minhash} presents performing minhash functions to all sets, \textbf{inserting} represents inserting bands to bloom filters, and \textbf{membership testing} represents testing the existence of elements in bloom filters..}
    \label{tab:running_time}
    % \setlength{\tabcolsep}{3.5pt}
    \begin{tabular}{c|ccccc|c}
        \toprule  % 顶部线
        Dataset  & Inst. & \makecell{Set\\ Discovery} & Minhash & Inserting & \makecell{Membership\\ Testing} & Total\\
        \midrule
        \multirow{2}{*}{$\textit{AMLSim-bal}$}
        &$\Cli_A$ & 1.74\textbf{} & 3.49 & 1.80 & 0.41 & 7.44   \\
        &$\Cli_B$ & 2.26 & 7.78 & 2.10 & 0.63 & 12.77 \\
        \midrule
        \multirow{2}{*}{$\textit{AMLSim-unb}$}
        &$\Cli_A$ & 1.11 & 5.80 & 5.46 & 0.96 &  13.33 \\
        &$\Cli_B$ & 4.23 & 4.83 & 2.84 & 0.82 &  12.72   \\
        \midrule
        \multirow{2}{*}{$\textit{AMLWorld-HI}$}
        &$\Cli_A$ & 7.67 &186.45 & 10.57 & 2.93 &  207.62 \\
        &$\Cli_B$ & 1.27 & 8.70 & 6.91 & 2.56 & 19.44 \\
        \midrule
        \multirow{2}{*}{$\textit{AMLWorld-LI}$}
        &$\Cli_A$ & 7.81 &184.1 & 10.71 & 2.91 & 205.53  \\
        &$\Cli_B$ & 1.29 & 8.90 & 6.99 & 2.52 & 19.70  \\
        
        \bottomrule  % 底部线
    \end{tabular}
\end{table*}




% \begin{theorem}
%     \label{thm: bloom_filter}
%     Let $A$ be a set and $\mathcal{S}=\{S_i\}$ be a group composing of $N$ sets. Assume $\forall i,j\in[N], S_i\neq S_j$ when $i\neq j$ and $\forall i\in[N], S_i\neq A$.
%     Consider $L=[L_i|S_i\in \mathcal{S}]$ is the array of LSH values obtained by performing the banding technique of $r$ rows.
%     Denote $L_A$ as the LSH value of $A$.
%     Denote $r_i$ as a random variable which is 1 when $L_i = L_A$, and 0 otherwise. Additionally, let $BF(L)$ denote the Bloom filter that stores $L$, and $t_i$ be another random variable which is 1 when $L_A$ is present in $BF(L)$, and 0 otherwise. 
%     For any $\epsilon>0$, there exists $r=\Omega(\ln{\epsilon})$, such that $|Pr[r_i=1]-Pr[t_i=1]|\leq \epsilon$.
% \end{theorem}

% \begin{proof}
% Denote $\mathcal{L}$ is the set of $L_z$ of $S_i$'s shadow sets $S_z$.
% The distance between $Pr[t_i=1]$ and $Pr[r_i=1]$ is calculates as follow:

% \begin{equation}
% \begin{aligned}
% &|Pr[t_i=1]-Pr[r_i=1]|\\
% =&|Pr[L_i=L_A] + Pr[L_i\neq L_A]Pr[L_A\in\mathcal{L}])-Pr[r_i=1]|\\
% =&|Pr[r_i=1] + Pr[r_i=0]Pr[L_A\in\mathcal{L}]-Pr[r_i=1]|\\
% = & Pr[r_i=0]Pr[L_A\in\mathcal{L}]\\
% = & Pr[r_i=0]\epsilon\\
% \leq & \epsilon
% \end{aligned}
% \end{equation}

% \end{proof}

\subsection{Additional Algorithms}
\label{ssec: algs_prots}


\renewcommand*{\algorithmcfname}{Algorithm}
\begin{algorithm}[thb]
\caption{Cross-institution Transaction Set Discovery}
\label{alg:set_discovery}
\small
\KwIn{node $i$, directed graph $\mathcal{G = (V,E,X)}$, where $\vec{c}\in \mathcal{X}$ represents whether the transaction is an cross-institution transaction, depth $K$} 
\KwOut {Set of cross-institution transactions that scattered from $i$}
\BlankLine
Initialize set $S= \emptyset$\\
Denote $\mathcal{N}_i = \{j| (i, j)\in\mathcal{E}\}$, $\forall i \in \mathcal{V}$\\
Initialize set $\mathcal{Q}=\{i\}$\\
\For{$k=\{1,...,K\}$}{
    Initialize set $Z=\emptyset$\\
    \For{$v\in\mathcal{Q}$}{
        \For{$j\in\mathcal{N}_v$}{
            \eIf{$c_{v\rightarrow j} = 1$}{$S$.append($(v, j)$)}
             {$\mathcal{Z}$.append(j)}
        }
    }
    \eIf{$\mathcal{Z}==\emptyset$} {break}
    {$\mathcal{Q}=\mathcal{Z}$}
}    
\Return{$S$}
\end{algorithm}


\begin{figure*}[!tbp]
\centering
% \setlength\tabcolsep{1.0pt}
% \renewcommand{\arraystretch}{0}
\begin{tabular}{ccc}
     % Accuracy & Precision & Recall & F1-score\\[-0.5ex]
    \subfloat{
        \includegraphics[width=0.32\textwidth,valign=c]{./figures/group1.png}} &
    \subfloat{
        \includegraphics[width=0.33\textwidth,valign=c]{./figures/group2.png}} &
    \subfloat{
        \includegraphics[width=0.33\textwidth,valign=c]{./figures/group97.png}} \\
    \multicolumn{3}{c}{\textbf{(a) Money laundering groups}}\\
    \subfloat{
        \includegraphics[width=0.32\textwidth,valign=c]{./figures/group75-grey.png}}&
    \subfloat{
        \includegraphics[width=0.33
        \textwidth,valign=c]{./figures/group93-grey.png}}&
    \subfloat{
        \includegraphics[width=0.32\textwidth,valign=c]{./figures/group2-no.png}} \\
    \multicolumn{2}{c}{\textbf{(b) Grey groups}} & \textbf{(c) Normal groups}
        
\end{tabular}
\caption{Examples of money laundering groups detected by CSGM, with colors indicating different institutions. The blue nodes represent accounts from Alipay and the red nodes represent accounts from ECB.}
\label{fig:detected_groups}
\end{figure*}

% \begin{algorithm}[htb]
% \caption{Distributed Scatter-Gather Discovery}
% \label{alg: naive_distribute_MLSD}
% \small
% \KwIn{Institutions $\Cli_A$ and $\Cli_B$, each holds a subgraph $\mathcal{G}_A$ and $\mathcal{G}_B$ and the corresponding transformed subgraph $\mathcal{G}'_A$ and $\mathcal{G}'_B$, depth $K$, threshold $\tau$} 
% \KwOut {Set of nodes involved in ML activities}
% \BlankLine

% \textit{// Discover sets  of nodes involved in cross-institution transactions sourced from each account}\\
% \For{$p=\{A,B\}$}{
%     \For{$i \in \mathcal{V}_p$}{
%         $S_i \leftarrow \Cli_p$ run Algorithm~\ref{alg:set_discovery} with inputs $\{i, \mathcal{G}_p, K\}$\\
%         $R_i \leftarrow \Cli_p$ run Algorithm~\ref{alg:set_discovery} with inputs $\{i, \mathcal{G}'_p, K\}$
%     }
%     $\mathcal{S}_p\leftarrow [S_i|\forall i \in \mathcal{V}_p]$, $\mathcal{D}_p\leftarrow [R_i|\forall i \in \mathcal{V}_p]$\\
%     $\Cli_p$ sends $\mathcal{S}_p$ and $\mathcal{D}_p$ to another institution.
% }

% \For{$p=\{A,B\}$}{
%     \textit{// Discover senders and receivers involved in ML activities}\\
%     Initialize set $S_{ML}^p= \emptyset$\\
%     % Initialize set $S_{dst}^l= \emptyset$\\
%     \For{$(\mathcal{S},\mathcal{D})\in \operatorname{ZIP}(\{\mathcal{S}_p, \mathcal{D}_p\}, \{\mathcal{D}_q,\mathcal{S}_q\})$}{
%         Initialize set $W^p= \emptyset$\\
%         \For{$S_i \in \mathcal{S}$}{
%             \For{$R_j \in \mathcal{D}$}{
%                 $s_{ij}\leftarrow |S_i \cap R_j|/|S_i \cup R_j|$\\
%                 \If{$s_{ij}\geq \tau$}{$W^p$.append($i$)}
%             }
%         }

%     \textit{// Discover intermediate accounts involved in ML activities}\\
%     \For{$v\in W_p$}{
%         \uIf{$\mathcal{S}==\mathcal{S}_p$}
%         {$S_{ML} \leftarrow \Cli_p$ tracing flows sourced from $i$ on $\mathcal{G}_p$ }
%         \ElseIf{$\mathcal{S}==\mathcal{D}_p$}
%         {$S_{ML} \leftarrow \Cli_p$ tracing flows sourced from $i$ on $\mathcal{G}'_p$ }

%         $S_{ML}^p$.append($S_{ML}$)
%     }
%     % \For{$j\in\mathcal{S}_l^{dst}$}{
%     %     $S_{ML} \rightarrow \Cli_l$ tracing flows sourced from $j$ on $\mathcal{G}'_l$ \\
%     %     $S_{ML}^l$.append($S_{ML}$)
%     % }
%     }
    
%     % \For{$S_j \in \mathcal{S}_l^{inv}$}{
%     %     \For{$S_i \in \mathcal{S}_{3-l}$}{
%     %         $s_{ji}\leftarrow|S_i \cap S_j|/|S_i \cup S_j|$\\
%     %         \If{$s_{ji}\leq \tau$}{$S_{dst}^l$.append($j$)}
%     %     }
%     % }
% }

% \Return{$S_{ML}^1$, $S_{ML}^2$}
% \end{algorithm}


% \begin{algorithm*}[htb]
% \caption{Optimized Distributed Scatter-Gather Discovery}
% \label{alg: distribute_MLSD}
% \begin{multicols}{2}
% \small
% \KwIn{institutions $\Cli_A$ and $\Cli_B$, each holds a subgraph $\mathcal{G}_1$ and $\mathcal{G}_2$ and the corresponding transformed subgraph $\mathcal{G}'_1$ and $\mathcal{G}'_2$, depth $K$, threshold $\tau$, minhash functions $H_m, m\in [m]$, band size $r$, $\operatorname{IsSimilarSet}$ (Algorithm~\ref{alg: IsMoneyLaunderingProb} or Algorithm~\ref{alg: IsMoneyLaunderingSim})} 
% \KwOut {Set of nodes involved in ML activities}
% \BlankLine
% \For{$p=\{A,B\}$}{
%     \textit{// Discover sets  of nodes involved in cross-institution transactions sourced from each account}\\
%     \For{$i \in \mathcal{V}_p$}{
%         $S_i \leftarrow \Cli_p$ run Algorithm~\ref{alg:set_discovery} with inputs $\{i, \mathcal{G}_p, K\}$\\
%         $R_i \leftarrow \Cli_p$ run Algorithm~\ref{alg:set_discovery} with inputs $\{i, \mathcal{G}'_p, K\}$
%     }
%     $\mathcal{S}_p\leftarrow \{S_i|\forall i \in \mathcal{V}_p\}$, $\mathcal{D}_p\leftarrow \{R_i|\forall i \in \mathcal{V}_p\}$\\
%     \tikzmk{A}
%     \textit{// Signature matrix} \\
%     \For{$t \in \{1,...,m\}$}{
%         \For{$i \in \mathcal{V}_p$}{
%             $M_{S}^p[t,i]\leftarrow H_t(S_i)$, 
%             $M_{D}^p[t,i]\leftarrow H_t(D_i)$\\
%         }
%     }
%     \textit{// Banding and building Bloom filters} \\
%     \For{$k \in \{1,...,m/r\}$}{
%         $B_{S}^p[k] \leftarrow \operatorname{BANDING}(M_{S}^p[(k-1)r: kr])$\\
%         $B_{D}^p[k] \leftarrow \operatorname{BANDING}(M_{D}^p[(k-1)r: kr])$\\
%         $BF_{S,k}^p \leftarrow $ insert $B_{S}^p[k]$ into a Bloom filter\\
%         $BF_{D,k}^p \leftarrow $ insert $B_{D}^p[k]$ into a Bloom filter
%     }
%     $BF_S^p \leftarrow \{BF_{S,k}^p\}_{k=1}^{m/r}$,
%     $BF_D^p \leftarrow \{BF_{D,k}^p\}_{k=1}^{m/r}$\\
%     $\Cli_p$ sends all Bloom filters $BF_S^p$, $BF_D^p$ to $\Cli_q$\\
%     \tikzmk{B}
%     \boxit{pink}
% }
% \For{$p=\{A,B\}$}{
%     \textit{// Discover senders and receivers involved in ML activities}\\
%     Initialize set $S_{ML}^p= \emptyset$\\
%     \tikzmk{A}    
%     \For{$(\mathcal{S},BF)\in \operatorname{ZIP}(\{\mathcal{S}_p, \mathcal{D}_p\}, \{BF_S^{q}, BF_D^{q} \})$}{
%         Initialize set $W^p= \emptyset$\\
%         \For{$S_i \in \mathcal{S}$}{
%             $h\leftarrow \operatorname{IsSimilarSet}(S_i, BF)$\\
%             \If{$h==1$}{$W^p$.append($i$)}
%         }
%         \tikzmk{B}
%     \boxitt{pink}
%         \textit{// Discover intermediate accounts involved in ML activities}\\
%         \For{$v\in W_p$}{
%             \uIf{$\mathcal{S}==\mathcal{S}_p$}
%             {$S_{ML} \leftarrow \Cli_p$ tracing accounts sourced from $i$ on $\mathcal{G}_p$ }
%             \ElseIf{$\mathcal{S}==\mathcal{D}_p$}
%             {$S_{ML} \leftarrow \Cli_p$ tracing accounts sourced from $i$ on $\mathcal{G}'_p$ }
    
%             $S_{ML}^p$.append($S_{ML}$)
%         }
%     }

% }
% \Return{$S_{ML}^A$, $S_{ML}^B$}

% \end{multicols}
% \end{algorithm*}
