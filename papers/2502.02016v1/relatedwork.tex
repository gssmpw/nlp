\section{Related Work}
Modeling and generating stable materials with data-driven approaches has been applied to discovering new functional materials \citep{peng2022human}. One line of approaches indirectly models crystal space by transforming crystals into human-designed representations \citep{REN2021,hoffmann2019data,noh2019inverse, court20203,yang2023scalable}, though the encoding and decoding process often leads to physical geometry loss 
%(\rebuttal{detailed discussion in \cref{appd:detailed_related_works}}). 
In contrast, another line of research directly models crystals in the sample space, drawing inspiration from the success of Diffusion models~\citep{ho2020denoising,song2020score,song2019generative}. For instance, CD-VAE \citep{xie2021crystal} and SyMat \citep{luo2024towards} employ score-matching \citep{song2019generative} to learn scores for generating stable materials, while their modeled distribution lacks geometric invariance~\citep{zhang2023artificial}. DiffCSP~\citep{jiao2023crystal} addresses this by transforming Cartesian atom coordinates into fractional coordinates, introducing the periodic E(3) equivariance of crystals, and designing an equivariant diffusion crystal generation model based on periodic diffusion \citep{jing2022torsional}. More recently, \citet{flowmm} applies Riemannian Flow Matching \citep{riemannianfm} to crystal generation tasks offering improved sampling efficiency, while at the expense of quality \footnote{For a more detailed discussion of related work, please refer to \cref{appd:detailed_related_works}.}. However, we argue that these methods struggle to balance sampling quality and efficiency due to insufficient guidance during each transition from the noise prior to the data distribution. This issue is particularly pronounced for crystals, where thermodynamically stable materials constitute only a small fraction of the search space~\citep{flowmm}. For instance, early generation states $x_{t-1}$ with low confidence should be retained less than later states to achieve the next state $x_{t}$. 


In this work, we propose to use BFN~\citep{bfn} to model crystals in a principally different way. BFN provides a framework to accurately update each generation state according to its entropy/confidence, the effectiveness of which has been proved in \citet{song2023unified}. 
However, there are no established explorations on the challenging topic of non-Euclidean BFN which is essential to many real-world applications \cite{jing2022torsional, AlphaFold2021}. 
To address the above issues, in this paper, we build a non-Euclidean Bayesian flow from scratch, identifying and tackling the non-additive accuracy via introducing a novel entropy conditioning mechanism.
 
% }

\input{preliminaries}
\input{method}

\input{experiment}