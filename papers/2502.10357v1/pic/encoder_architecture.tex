\definecolor{DarkGray}{HTML}{68904d}
\definecolor{Orange}{HTML}{ffae42}
\begin{figure}[ht]
\small
\centering
\begin{tikzpicture}[
    box/.style={rectangle,draw,fill=DarkGray!20,node distance=1cm,text width=8em,text centered,rounded corners,minimum height=1.5em,thick},
    box2/.style={rectangle,draw,fill=DarkGray!20,node distance=1cm,text width=1em,text centered,rounded corners,minimum height=0.5em,thick},
    % arrow/.style={draw,-latex',thick},
  ]
  \tikzset{arrow/.style={-latex, thick}}
  \node [box] (ffne) {FCNN};

  \node [box2,above=0.5 of ffne] (tok2) {c$_2$};
  \node [box2,left=0.25 of tok2] (tok1) {c$_1$};
  \node [box2,right=0.25 of tok2] (tok3) {c$_3$};
  % \node [above=0.2 of tok2]{Encoder output};
  \node [box,above=0.5 of tok2] (linear){Linear classifier};
  \node [box,above=0.25 of linear] (softmax){Softmax};
  \node [above=0.3 of softmax] (output) {\texttt{-1}};

  \path[draw,thick] (linear) -- (softmax);
  \path[draw,thick] (softmax) -- (output);
  \path[draw,thick] (tok1.south) -- (ffne.north -| tok1.north);
  \path[draw,thick] (tok2.south) -- (ffne);
  \path[draw,thick] (tok3.south) -- (ffne.north -| tok3.north);

  \node [box,below=0.23 of ffne,fill=Orange] (selfatt){Self-attention};  
  \node [label={[rotate=90]160:$\times n$ },rectangle,draw,dashed,inner sep=0.7em,fit=(selfatt) (ffne)] (encoder1) {};

  \node [box2,below=0.4 of selfatt] (se){x$_2$};
  \node [box2,left=0.25 of se] (se2){x$_1$};
  \node [box2,right=0.25 of se] (se3){x$_3$};
  \node [box,below=0.23 of se] (embed) {Embedding};
  \node [below=0.3 of embed] (inp2) {\texttt{+ 2}};
  \node [right=0.25 of inp2] (inp3) {\texttt{+ 5}};
  \node [left=0.25 of inp2] (inp1) {\texttt{- 1}};
  \path[draw,thick] (inp2) -- (embed);
  \path[draw,thick] (inp3) -- (embed.south -| inp3);
  \path[draw,thick] (inp1) -- (embed.south -| inp1);
  \node [below=0.1 of inp2]{\textbf{Encoder}};

  % \coordinate[above right =0.2 and 0.7 of tok3](conn);
  \coordinate[above =0.1 of tok2](conn);
  \path[draw,thick] (tok1) |- (conn);
  \path[draw,thick] (tok2) |- (linear.south);
  \path[draw,thick] (tok3) |- (conn);

  \path [draw,thick] (ffne.north -| tok1) -- (tok1);
  \path [draw,thick] (ffne) -- (tok2);
  \path [draw,thick] (ffne.north -| tok3) -- (tok3);
  \path [draw,thick] (selfatt) -- (ffne);
  \path [draw,thick] (se) -- (selfatt);
  \path [draw,thick] (se2) -- (selfatt.south -| se2);
  \path [draw,thick] (se3) -- (selfatt.south -| se3);
  \path[draw,thick] (embed.north -| se2) -- (se2);
  \path[draw,thick] (embed) -- (se);
  \path[draw,thick] (embed.north -| se3) -- (se3);

  \node[draw,text width=5cm] at (-5.2,0) {Embedding dimension\\
  \begin{itemize}[leftmargin=*, itemsep=1pt, topsep=1pt, parsep=1pt]
  \item Encoder: $d_e=256$ \\
  \end{itemize}
  Attention heads: $8$

  Fully connected neural network (FCNN):\\ 
  \begin{itemize}[leftmargin=*, itemsep=1pt, topsep=1pt, parsep=1pt]
  \item 1 hidden layer \\
  \item $4d_e$ neurons \\
  \end{itemize}
  Encoder Transformer layer:\\
  \begin{itemize}[leftmargin=*, itemsep=1pt, topsep=1pt, parsep=1pt]
      \item Iterated: $n = 4$ times
  \end{itemize}
  };
\end{tikzpicture}
\vspace{-0.1cm}
\caption{We implement an encoder only transformer architecture using Int2Int.}\label{fig:archi}
%\vspace{-0.1cm}
\end{figure}
