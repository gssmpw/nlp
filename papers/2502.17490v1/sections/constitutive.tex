\section{Constitutive framework for finite strain inelasticity}
\label{sec:constitutive}
%
In this section, we briefly outline the underlying constitutive framework for general inelastic materials at finite strains, which are modeled using the multiplicative decomposition of the deformation gradient.
For this, we introduce two fundamental scalar-valued quantities: 
The Helmholtz free energy, $\psi$, as well as a dual potential, $\omega$.
All constitutively dependent quantities can be derived from these thermodynamic potentials.
This dual potential approach is certainly not the only method for modeling inelastic behavior. We will elucidate its close relationship to Generalized Standard Materials \cite{halphen1975}, another well-established framework for characterizing inelasticity, in Section~\ref{sec:GSM}.\newline

\textbf{Kinematics.} We employ the multiplicative decomposition of the deformation gradient, $\bm{F}=\bm{F}_e\bm{F}_i$, into an elastic part, $\bm{F}_e$, and an inelastic part, $\bm{F}_i$, cf. \cite{Eckart1948,Kroener1959,sidoroff1974,rodriguez1994}.
Both determinants of the individual parts are greater than zero.
Conceptually, we introduce an intermediate configuration, relative to which the elastic response is characterized.
Unfortunately, the multiplicative decomposition is non-unique, i.e.\ we may superimpose any rotation $\bm{F}=\bm{F}_e\bm{Q}^{\dagger^T}\bm{Q}^\dagger\bm{F}_i=:\bm{F}_e^\dagger\bm{F}_i^\dagger$ where $\bm{Q}^\dagger \in \mathrm{SO}(3)$ with $\mathrm{SO}(3)$ denoting the special orthogonal group.
By employing the singular value decomposition, we recognize that $\bm{F}_i$ and $\bm{F}_i^\dagger$ share the same singular values, and thus, the same stretch tensor $\bm{U}_i$ resulting from the polar decomposition $\bm{F}_i=\bm{R}_i\bm{U}_i$ with $\bm{R}_i \in \mathrm{SO}(3)$.
Thus, we find $\bm{U}_i$ to be unique, and further, $\bm{F}_i^\dagger=\bm{R}_i^\dagger\bm{U}_i$ where $\bm{R}_i^\dagger=\bm{Q}^\dagger\bm{R}_i$.
Lastly, we introduce an appropriate stretch measure of the elastic stretches $\bm{C}_e = \bm{F}_e^T\bm{F}_e = \bm{Q}^\dagger\bm{F}_e^{\dagger^T}\bm{F}_e^\dagger\bm{Q}^{\dagger^T}$, which however, is non-unique.\newline

\textbf{Clausius-Planck inequality.} Any constitutive framework for solids must satisfy the Clausius-Planck inequality $\mathcal{D} := -\dot{\psi} + 1/2\, \bm{S}:\dot{\bm{C}} \geq 0$ where $\bm{S}$ denotes the second Piola-Kirchhoff stress, while $\bm{C}=\bm{F}^T\bm{F}$ refers to the right Cauchy-Green tensor.
For the time being, we assume the Helmholtz free energy to be a scalar-valued isotropic function \cite{spencer1971,zheng1994} depending solely on $\bm{C}_e$, i.e. $\psi = \hat{\psi}(\bm{C}_e)$.
Hence, we obtain the following, cf. \cite{dettmer2004}
%
\begin{equation}
\mathcal{D} =    \left(\bm{S} - 2\,\bm{F}_i^{-1}\,\frac{\partial\psi}{\partial\bm{C}_e}\,\bm{F}_i^{-T} \right) : \frac{1}{2}\,\dot{\bm{C}} + \underbrace{2\,\bm{C}_e\,\frac{\partial\psi}{\partial\bm{C}_e}}_{=: \bm{\Sigma}} : \underbrace{\dot{\bm{F}}_i\bm{F}_i^{-1}}_{=: \bm{L}_i} \geq 0
\label{eq:dissipation}
\end{equation}
%
where we introduce the elastic Mandel-like stress $\bm{\Sigma}$, which is symmetric since $\psi$ is an isotropic function of $\bm{C}_e$, cf. \cite{svendsen2001}\footnote{In the case of initial anisotropy, $\psi$ is usually assumed to be an isotropic function of $\bm{C}_e$ and a structural tensor $\bm{H}$. Note that in this case $\bm{\Sigma}$ is no longer symmetric.}.
Noteworthy, since $\bm{\Sigma}$ solely depends on $\bm{C}_e$, the elastic Mandel-like stress is also non-unique, i.e. $\bm{\Sigma}=\bm{Q}^{\dagger}\bm{\Sigma}^\dagger\bm{Q}^{\dagger^T}$.
Following the arguments of \cite{coleman1961,coleman1963,coleman1967}, we assume the term in brackets in Inequality~\eqref{eq:dissipation} to be zero, revealing the state law for $\bm{S}$.
Consequently, as $\bm{\Sigma}$ is symmetric, we can reduce the dissipation inequality to
%
\begin{equation}
    \mathcal{D}_{red} := \bm{\Sigma} : \bm{D}_i \geq 0
    \label{eq:dissipation_red}
\end{equation}
%
where $\bm{D}_i := \mathrm{sym}(\bm{L}_i)$ is the symmetric part of $\bm{L}_i$.
To satisfy the reduced dissipation inequality for arbitrary processes, we will introduce a dual potential, $\omega=\hat{\omega}(\bm{\Sigma})$, which is assumed to be a scalar-valued isotropic function in order to be independent of the superimposed rotation $\bm{Q}^\dagger$.\newline

\textbf{Co-rotated intermediate configuration.} We have observed that the relevant constitutive quantities, such as $\bm{C}_e$ and $\bm{\Sigma}$, suffer from an inherent rotational non-uniqueness.
This poses challenges in computing these quantities and derivatives with respect to those, for instance $\frac{\partial\psi}{\partial\bm{C}_e}$.
To address this issue in our numerical implementation, we adopt the approach suggested by \cite{holthusen2023} and introduce a co-rotated intermediate configuration.
In short, this approach pulls all non-unique quantities back by either $\bm{R}_i$ or $\bm{R}_i^\dagger$, i.e. $\bar{(\bullet)}:=\bm{R}_i^T\,(\bullet)\,\bm{R}_i = \bm{R}_i^{\dagger^T}\,(\bullet)^\dagger\,\bm{R}_i^\dagger$.
Consequently, we obtain the following unique quantities
%
\begin{equation}
    \label{tb_eq:10}
    \bar{\bm{C}}_e = \bm{U}_i^{-1}\bm{C}\bm{U}_i^{-1}, \quad \bm{S} = 2\,\bm{U}_i^{-1}\,\frac{\partial\psi}{\partial\bar{\bm{C}}_e}\,\bm{U}_i^{-1}, \quad \bar{\bm{\Sigma}} = 2\,\bar{\bm{C}}_e\,\frac{\partial\psi}{\partial\bar{\bm{C}}_e}, \quad \bar{\bm{D}}_i = \mathrm{sym}\left(\dot{\bm{U}}_i\,\bm{U}_i^{-1} \right).
\end{equation}
%
Noteworthy, the co-rotated pullback preserves both the symmetry as well as the eigenvalues, which is considered an advantage.\newline

\textbf{Potential-based evolution equation.} It remains to introduce an evolution equation for $\bar{\bm{D}}_i$ in a thermodynamic consistent way such that Inequality~\eqref{eq:dissipation_red} is satisfied for arbitrary processes.
Therefore, we postulate the existence of a pseudo potential \cite{kerstin1969}, which we may identify as the dual potential resulting from the Legendre-Fenchel transformation of the `classical' dissipation potential (see Section~\ref{sec:GSM}) known from Generalized Standard Materials \cite{halphen1975}, viz.\
%
\begin{equation}
    \bar{\bm{D}}_i = \frac{\partial \omega\left(\bar{\bm{\Sigma}}\right)}{\partial\bar{\bm{\Sigma}}}.
\label{eq:EvolutionEquation}
\end{equation}
%
According to \citet{germain1983}, the dissipation inequality is naturally fulfilled if $\omega$ is \textit{convex}, \textit{zero-valued}, and \textit{non-negative} with respect to $\bar{\bm{\Sigma}}$ \cite{holthusen2025growth}\footnote{We may understand the evolution equation as a subderivative $\bar{\bm{D}}_i \in \partial_{\bar{\bm{\Sigma}}}\omega\left(\bar{\bm{\Sigma}}\right)$ in case of non-smooth potentials, where $\partial_{\bar{\bm{\Sigma}}}\omega\left(\bar{\bm{\Sigma}}\right)$ denotes the subderivative with respect to $\bar{\bm{\Sigma}}$, see \cite{germain1998}.}.\newline

\textbf{Invariant representation.} As discussed above, the dual potential is assumed to be an isotropic function of $\bar{\bm{\Sigma}}$, and can, thus, be expressed in terms of its invariants.
Here, we choose the common stress invariants $I_1^{\bar{\bm{\Sigma}}}:=\mathrm{tr}(\bar{\bm{\Sigma}})$, $J_2^{\bar{\bm{\Sigma}}}:=1/2\,\mathrm{tr}(\mathrm{dev}(\bar{\bm{\Sigma}})^2)$, and $J_3^{\bar{\bm{\Sigma}}}:=1/3\,\mathrm{tr}(\mathrm{dev}(\bar{\bm{\Sigma}})^3)$.
With these invariants at hand, the evolution equation reduces to
%
\begin{equation}
    \bar{\bm{D}}_i = \frac{\partial\omega^*}{\partial\bar{\bm{\Sigma}}} = \frac{\partial\omega^*}{\partial I_1^{\bar{\bm{\Sigma}}}}\,\bm{I} + \frac{\partial\omega^*}{\partial J_2^{\bar{\bm{\Sigma}}}}\,\mathrm{dev}\left(\bar{\bm{\Sigma}}\right) + \frac{\partial\omega^*}{\partial J_3^{\bar{\bm{\Sigma}}}}\,\mathrm{dev}\left(\mathrm{dev}\left(\bar{\bm{\Sigma}}\right)^2\right)
\label{eq:EvolutionEquationInvars}
\end{equation}
%
where $\omega^*=\hat{\omega}^*\left(I_1^{\bar{\bm{\Sigma}}},\sqrt{J_2^{\bar{\bm{\Sigma}}}},\sqrt[3]{J_3^{\bar{\bm{\Sigma}}}}\right)$.
The square and cubic roots are calculated to ensure that all invariants share the same unit.
If we plug \eqref{eq:EvolutionEquationInvars} into the co-rotated version of Equation~\eqref{eq:dissipation_red}
%
\begin{equation}
    %\mathcal{D}_{red} := \frac{\partial\omega^*}{\partial I_1^{\bar{\bm{\Sigma}}}}\,I_1^{\bar{\bm{\Sigma}}} + \frac{\partial\omega^*}{\partial \sqrt{J_2^{\bar{\bm{\Sigma}}}}}\,\sqrt{J_2^{\bar{\bm{\Sigma}}}} + \frac{\partial\omega^*}{\partial \sqrt[3]{J_3^{\bar{\bm{\Sigma}}}}}\,\sqrt[3]{J_3^{\bar{\bm{\Sigma}}}} \geq 0,
    \mathcal{D}_{red} = \nabla\omega^*(\mathbf{z}) \cdot \mathbf{z} \geq 0, \quad \mathbf{z} = \begin{pmatrix}
        I_1^{\bar{\bm{\Sigma}}} \\
        \sqrt{J_2^{\bar{\bm{\Sigma}}}} \\
        \sqrt[3]{J_3^{\bar{\bm{\Sigma}}}}
    \end{pmatrix}
    \label{eq:reduced_dissipation_vector}
\end{equation}
%
we observe that the inequality is satisfied if $\omega^*$ is convex, zero-valued, and non-negative with respect to its arguments; however, this does not guarantee its convexity with respect to $\bar{\bm{\Sigma}}$, cf. \cite{collins2002}.
The reason for this lies in the indefinite Hessian of $J_3^{\bar{\bm{\Sigma}}}$ with respect to the Mandel-like stress.
Nevertheless, non-convex yield surfaces, which are typically modelled as a potential subtracted by a threshold such as the yield stress, are not only of significant practical relevance \cite{gluege2017,matzenmiller1995,baghous2022} but also amenable to numerical treatment \cite{sheng2011,pedroso2008}.
As $\omega^*$ includes the special case of being convex with respect to $\bar{\bm{\Sigma}}$, we consider this framework advantageous. 
%
%=================================
\subsection{Relation to Generalized Standard Materials for solids}
\label{sec:GSM}
In the following, we will explain the intrinsic relationship between the present modeling framework for iCANNs and the classical framework of Generalized Standard Materials, the latter of which is well-known in the literature (see e.g.\ \cite{halphen1975,germain1983,flaschel2023}). We start again with the Helmholtz free energy and assume, for the same reasons as explained above, that it is a scalar-valued isotropic function of quantities in the co-rotated intermediate configuration. Specifically, we assume a dependence of $\psi$ on $\bar{\bm{C}}_e$ only, i.e.\ $\psi = \hat{\psi}(\bar{\bm{C}}_e)$. More general cases in which $\psi$ additionally depends on further internal state variables or structural tensors are, of course, possible. However, since this does not lead to additional insights in the presentation that follows, we will not consider this case for simplicity.

Exploiting again the Clausius-Planck inequality and the chain rule of differentiation, we may arrive at
\begin{equation}
\label{tb_eq:1}
\mathcal{D} = -\dot{\psi} + \frac{1}{2}\, \bm{S}:\dot{\bm{C}} \geq 0 \qquad \Rightarrow \qquad \mathcal{D} = -2\,\frac{\partial \psi}{\partial \bar{\bm{C}}_e} : \frac{1}{2}\,\dot{\bar{\bm{C}}}_e + \bm{S}:\frac{1}{2}\,\dot{\bm{C}} \geq 0.
\end{equation}
Considering $\bar{\bm{C}}_e = \bm{U}_i^{-1}\,\bm{C}\,\bm{U}_i^{-1}$, the relation $\dot{\bm{C}} = \dot{\bm{U}}_i\,\bar{\bm{C}}_e\,\bm{U}_i + \bm{U}_i\,\dot{\bar{\bm{C}}}_e\,\bm{U}_i + \bm{U}_i\,\bar{\bm{C}}_e\,\dot{\bm{U}}_i$, and well-known properties of the scalar product of two second-order tensors, Inequality~\eqref{tb_eq:1} can directly be rewritten as
\begin{equation}
\label{tb_eq:2}
\mathcal{D} = \left(\bar{\bm{S}} - 2\,\frac{\partial \psi}{\partial \bar{\bm{C}}_e}\right):\frac{1}{2}\,\dot{\bar{\bm{C}}}_e + \bar{\bm{\Sigma}}:\bar{\bm{L}}_i \geq 0.
\end{equation}
Here, $\bar{\bm{S}} := \bm{U}_i\,\bm{S}\,\bm{U}_i$ is the second Piolaâ€“Kirchhoff stress tensor relative to the co-rotated intermediate configuration and $\bar{\bm{\Sigma}} = \bar{\bm{C}}_e\,\bar{\bm{S}}$ denotes the (up to this point generally unsymmetric) Mandel-like stress tensor in the very same configuration. With $\bar{\bm{L}}_i = \mathrm{sym}(\bar{\bm{L}}_i) + \mathrm{skew}(\bar{\bm{L}}_i) = \bar{\bm{D}}_i + \bar{\bm{W}}_i$, Expression~\eqref{tb_eq:2} is finally rewritten as
\begin{equation}
\label{tb_eq:3}
\mathcal{D} = \bar{\bm{S}}^{\,\mathrm{dis}}:\frac{1}{2}\,\dot{\bar{\bm{C}}}_e + \mathrm{sym}(\bar{\bm{\Sigma}}):\bar{\bm{D}}_i + \mathrm{skew}(\bar{\bm{\Sigma}}):\bar{\bm{W}}_i \geq 0
\end{equation}
where $\bar{\bm{S}}^{\,\mathrm{dis}} := \left(\bar{\bm{S}} - 2\,\frac{\partial \psi}{\partial \bar{\bm{C}}_e}\right)$ can be considered the irreversible or dissipative part of the stress $\bar{\bm{S}}$.

To fulfill dissipation inequality~\eqref{tb_eq:3}, it is now customary in the framework of Generalized Standard Materials to assume a scalar-valued dissipation potential\footnote{As in case of the Helmholtz free energy $\psi$, we may directly formulate the dissipation potential $\Omega$ as a scalar-valued isotropic function of quantities in the co-rotated intermediate configuration, in order to avoid any ambiguities due to arbitrary rotations of the intermediate configuration.} $\Omega = \hat{\Omega}\left(\dot{\bar{\bm{C}}}_e,\bar{\bm{D}}_i,\bar{\bm{W}}_i\right)$, expressed in terms of the strain-like rate quantities $\dot{\bar{\bm{C}}}_e$, $\bar{\bm{D}}_i$, and $\bar{\bm{W}}_i$, which is convex, non-negative, and zero-valued at the origin, i.e.\ $\hat{\Omega}(\bm{0},\bm{0},\bm{0}) = 0$. This potential is conveniently used to derive complementary laws for the thermodynamic conjugate forces, i.e.\footnote{In case of a non-smooth dissipation potential $\Omega$, the partial derivatives in \eqref{tb_eq:4} and the following should be understood as subderivatives.}:
\begin{equation}
\label{tb_eq:4}
\bar{\bm{S}}^{\,\mathrm{dis}} = \frac{\partial \Omega}{\partial \dot{\bar{\bm{C}}}_e}, \qquad \mathrm{sym}(\bar{\bm{\Sigma}}) = \frac{\partial \Omega}{\partial \bar{\bm{D}}_i}, \qquad \mathrm{skew}(\bar{\bm{\Sigma}}) = \frac{\partial \Omega}{\partial \bar{\bm{W}}_i}.
\end{equation}
As can be shown, with the above definitions, thermodynamic consistency of the formulation is naturally ensured.\newline

\textbf{Strain-rate independent dissipation potential.} Further consequences for the dissipation potential arise when dealing with solid materials, for which it is usually assumed that purely elastic, but otherwise arbitrary deformations ($\dot{\bar{\bm{C}}}_e \ne \bm{0}$, $\bar{\bm{D}}_i = \bar{\bm{W}}_i = \bm{0}$) do not cause any dissipation. In this case, it can be inferred from Inequality \eqref{tb_eq:3} that
\begin{equation}
\label{tb_eq:5}
\mathcal{D} = \bar{\bm{S}}^{\,\mathrm{dis}}:\frac{1}{2}\,\dot{\bar{\bm{C}}}_e = 0 \qquad \Rightarrow \qquad \bar{\bm{S}}^{\,\mathrm{dis}} = \frac{\partial \hat{\Omega}}{\partial \dot{\bar{\bm{C}}}_e} = \bm{0}.
\end{equation}
In other words, it can be concluded that the dissipation potential cannot be a function of the elastic strain rate $\dot{\bar{\bm{C}}}_e$ in this case\footnote{This does by no means preclude any strain-rate-dependent behavior of the material model, as the rate dependency can be reflected in the evolution of the internal state variables.}. Furthermore, as the second Piola-Kirchoff stress tensor relative to the intermediate configuration becomes $\bar{\bm{S}} = 2\,\frac{\partial \psi}{\partial \bar{\bm{C}}_e}$, this immediately leads to a symmetric Mandel-like stress tensor $\bar{\bm{\Sigma}} = \bar{\bm{C}}_e\,\bar{\bm{S}} =  2\,\bar{\bm{C}}_e\,\frac{\partial\psi}{\partial\bar{\bm{C}}_e}$ (see also \eqref{tb_eq:10}$_3$), i.e.\ $ \mathrm{sym}(\bar{\bm{\Sigma}}) = \bar{\bm{\Sigma}}$ and $\mathrm{skew}(\bar{\bm{\Sigma}}) = \bm{0}$. The Clausius-Planck inequality therefore reduces to 
\begin{equation}
\label{tb_eq:6}
\mathcal{D}_{red} = \bar{\bm{\Sigma}}:\bar{\bm{D}}_i\geq 0,
\end{equation}
such that the dissipation potential needs to be a function of $\bar{\bm{D}}_i$ only, i.e.\ $\Omega = \hat{\Omega}(\bar{\bm{D}}_i)$ with $\hat{\Omega}(\bm{0}) = 0$. The complementary law for $\bar{\bm{\Sigma}}$ is then obtained as
\begin{equation}
\label{tb_eq:11}
\bar{\bm{\Sigma}} = \frac{\partial \Omega}{\partial \bar{\bm{D}}_i}.
\end{equation}

\textbf{Dual dissipation potential in terms of stress-like quantities.}
Finally, by means of a Legendre-Fenchel transformation of $\Omega$, a dual dissipation potential $\omega$ in terms of the stress-like quantity $\bar{\bm{\Sigma}}$ can be derived:
\begin{equation}
\label{tb_eq:8}
    \omega = \hat{\omega}(\bar{\bm{\Sigma}}) = \sup_{\bar{\bm{D}}_i}\left(\bar{\bm{\Sigma}} : \bar{\bm{D}}_i - \hat{\Omega}\!\left(\bar{\bm{D}}_i\right)\right).
\end{equation}
The latter potential is also convex, non-negative, and zero-valued at the origin, i.e.\ $\hat{\omega}(\bm{0}) = 0$. It can be employed to define a thermodynamically consistent evolution equation (or complementary law) for the strain-like internal state variable $\bar{\bm{D}}_i$ via
\begin{equation}
\label{tb_eq:11}
    \bar{\bm{D}}_i = \frac{\partial \omega}{\partial \bar{\bm{\Sigma}}}.
\end{equation}

\textbf{Relation to iCANN framework.} The above shows that iCANNs perfectly fit into the framework of Generalized Standard Materials. The only difference to the more classical approach is that, in the iCANN modeling framework presented here, the dual dissipation potential \eqref{tb_eq:8} in terms of the stress-like variable $\bar{\bm{\Sigma}}$ is constructed and identified \emph{directly}. However, this alternative procedure is by no means unusual or disadvantageous, and has been proposed as an equally valid approach by other authors in the past (among many others, \cite{LemaitreChaboche1994,Chaboche1997,LeuschnerFritzenEtAl2015,HoltzmanChrysochoosEtAl2018}). One potential can always be constructed from the other, owing to the remarkable duality of the Legendre-Fenchel transformation. 