\begin{tikzpicture}[node distance=0.8cm]
% inputs
\node (input1) at (0,0) [draw, circle, fill=white, minimum size=1.5cm] {$I_1^{\bar{\bm{\Sigma}}}$};
\node (input2) [draw, circle, fill=white, below=of input1, minimum size=1.5cm] {\hspace{-1mm}$\sqrt{J_2^{\bar{\bm{\Sigma}}}}$};
\node (input3) [draw, circle, fill=white, below=of input2, minimum size=1.5cm] {\hspace{-1mm}$\sqrt[3]{J_3^{\bar{\bm{\Sigma}}}}$};
% first hidden layer
\node (hidden2_2) [draw, circle, right = 2.1cm of $(input1)!0.5!(input2)$, minimum size = 1.5cm, fill = rwtho2 ] {$f_{1,a}^{\tightI}$};
\node (hidden2_3) [draw, circle, right = 2.1cm of $(input2)!0.5!(input3)$, minimum size = 1.5cm, fill = rwtho2 ] {$f_{b,1}^{\tightI}$};
\node (hidden2_1) [draw, circle, above =     of hidden2_2, minimum size = 1.5cm, fill = rwtho2 ] {$f_{1,1}^{\tightI}$};
\node (hidden2_4) [draw, circle, below =     of hidden2_3, minimum size = 1.5cm, fill = rwtho2 ] {$f_{b,c}^{\tightI}$};
\node (dots2_1) at ($(hidden2_1)!0.5!(hidden2_2)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho2}{\tikzvdots}};
\node (dots2_2) at ($(hidden2_2)!0.5!(hidden2_3)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho2}{\tikzvdots}};
\node (dots2_3) at ($(hidden2_3)!0.5!(hidden2_4)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho2}{\tikzvdots}};
% second hidden layer
\node (hidden3_1) [draw, circle, right = 1.1cm of hidden2_1, minimum size = 1.5cm, fill = rwtho3 ] {$f_{1,1}^{\tightII}$};
\node (hidden3_2) [draw, circle, right = 1.1cm of hidden2_2, minimum size = 1.5cm, fill = rwtho3 ] {$f_{1,d}^{\tightII}$};
\node (hidden3_3) [draw, circle, right = 1.1cm of hidden2_3, minimum size = 1.5cm, fill = rwtho3 ] {$f_{e,1}^{\tightII}$};
\node (hidden3_4) [draw, circle, right = 1.1cm of hidden2_4, minimum size = 1.5cm, fill = rwtho3 ] {$f_{e,f}^{\tightII}$};
\node (dots3_1) at ($(hidden3_1)!0.5!(hidden3_2)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho3}{\tikzvdots}};
\node (dots3_2) at ($(hidden3_2)!0.5!(hidden3_3)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho3}{\tikzvdots}};
\node (dots3_3) at ($(hidden3_3)!0.5!(hidden3_4)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho3}{\tikzvdots}};
% K-th hidden layer
\node (hiddenk_1) [draw, circle, right = 2.8cm of hidden3_1, minimum size = 1.5cm, fill = rwtho4 ] {$f_{1,1}^{K}$};
\node (hiddenk_2) [draw, circle, right = 2.8cm of hidden3_2, minimum size = 1.5cm, fill = rwtho4 ] {$f_{1,i}^{K}$};
\node (hiddenk_3) [draw, circle, right = 2.8cm of hidden3_3, minimum size = 1.5cm, fill = rwtho4 ] {$f_{j,1}^{K}$};
\node (hiddenk_4) [draw, circle, right = 2.8cm of hidden3_4, minimum size = 1.5cm, fill = rwtho4 ] {$f_{j,l}^{K}$};
\node (dotsk_1) at ($(hiddenk_1)!0.5!(hiddenk_2)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
\node (dotsk_2) at ($(hiddenk_2)!0.5!(hiddenk_3)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
\node (dotsk_3) at ($(hiddenk_3)!0.5!(hiddenk_4)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
% K+1 hidden layer
\node (hiddenk1_1) [draw, dashed, circle, right = 1.1cm of hiddenk_1, minimum size = 1.5cm, fill = rwtho4 ] {$f^{K+1}$};
\node (hiddenk1_2) [draw, dashed, circle, right = 1.1cm of hiddenk_2, minimum size = 1.5cm, fill = rwtho4 ] {$f^{K+1}$};
\node (hiddenk1_3) [draw, dashed, circle, right = 1.1cm of hiddenk_3, minimum size = 1.5cm, fill = rwtho4 ] {$f^{K+1}$};
\node (hiddenk1_4) [draw, dashed, circle, right = 1.1cm of hiddenk_4, minimum size = 1.5cm, fill = rwtho4 ] {$f^{K+1}$};
\node (dotsk1_1) at ($(hiddenk1_1)!0.5!(hiddenk1_2)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
\node (dotsk1_2) at ($(hiddenk1_2)!0.5!(hiddenk1_3)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
\node (dotsk1_3) at ($(hiddenk1_3)!0.5!(hiddenk1_4)$) [circle, minimum size = 0.1cm ] {\textcolor{rwtho4}{\tikzvdots}};
% output
\node (output) [draw, circle, right = 2cm of $(hiddenk1_2)!0.5!(hiddenk1_3)$, minimum size = 1cm, fill = rwtho5 ] {$\omega^*$};
% bias third hidden layer
\node (bias3_1) [draw, circle, above = 1.2cm of $(hidden2_1)!0.5!(hidden3_1)$, minimum size = 1.5cm, fill = rwth6 ] {$\mathbf{b}_1^{\tightII}$};
\node (bias3_2) [draw, circle, below = 1.2cm of $(hidden2_4)!0.5!(hidden3_4)$, minimum size = 1.5cm, fill = rwth6 ] {$\mathbf{b}_e^{\tightII}$};
% bias K-th hidden layer
\node (biask_1) [draw, circle, above = 1.2cm of $(hidden3_1)!0.7!(hiddenk_1)$, minimum size = 1.5cm, fill = rwth6 ] {$\mathbf{b}_1^{K}$};
\node (biask_2) [draw, circle, below = 1.2cm of $(hidden3_4)!0.7!(hiddenk_4)$, minimum size = 1.5cm, fill = rwth6 ] {$\mathbf{b}_j^{K}$};
% connect 0 to 1
\foreach \i in {1,...,3} {
	\foreach \j in {1,...,4} {
    		\draw[-] (input\i.east) to (hidden2_\j.west);
    	}
}
% connect 1 to 2
\foreach \i in {1,...,4} {
	\foreach \j in {1,...,4} {
    		\draw[-] (hidden2_\i.east) to (hidden3_\j.west);
    	}
}
% connect 2 to K
\foreach \i in {1,...,4} {
	\foreach \j in {1,...,4} {
    		\draw[-] (hidden3_\i.east) to (hiddenk_\j.west);
    	}
}
% connect K to K+1
\foreach \i in {1,...,4} {
    \draw[-,dashed] (hiddenk_\i.east) to (hiddenk1_\i.west);
}
% connect K+1 to output
\foreach \i in {1,...,4} {
    \draw[-] (hiddenk1_\i.east) to (output.west);
}
% biases
\foreach \i in {1,...,2} {
    \draw[-] (bias3_1.south) to (hidden3_\i.north west);
    \draw[-] (biask_1.south) to (hiddenk_\i.north west);
}
\foreach \i in {3,...,4} {
    \draw[-] (bias3_2.north) to (hidden3_\i.south west);
    \draw[-] (biask_2.north) to (hiddenk_\i.south west);
}
% rectangle
\node (rec) [draw=white, fill=white, minimum width=1cm, minimum height=7.1cm, anchor=center] at ($(hidden3_2)!0.5!(hiddenk_2) + (0,-1.2)$) {};
\node (hdots) at (rec) [circle, minimum size = 0.1cm, rotate=90 ] {\textcolor{rwtho5}{\tikzvdots}}; 
% weights
\node (w01) [draw=white, fill=white, rounded corners=0.3cm] at ($(hdots)+(-6.2,0)$) {$\mathbf{W}_0^{\tightI}$};
\node (w12) [draw=white, fill=white, rounded corners=0.3cm] at ($(hdots)+(-3.5,0)$) {$\mathbf{W}_{\tightI}^{\tightII}$};
\node (w3K) [draw=white, fill=white, rounded corners=0.3cm] at ($(hdots)+(-1.1,0)$) {$\mathbf{W}_{\tightII}^{K}$};
\node (wo) [draw=white, fill=white, rounded corners=0.3cm] at ($(hdots)+(+5.9,0)$) {$\mathbf{w}_{\omega^*}$};
\end{tikzpicture}