\section{Acyclic Matching}\label{sec:acyclic}

In this section we consider the {\AcyclicM} problem.
Chaudhary and Zehavi~\cite{wg/ChaudharyZ23a} recently gave an $\sO(6^{\tw})$ algorithm for this problem,
where $\tw$ denotes the treewidth of the input graph.
We first notice that, with some slightly more careful analysis of its running time,
the algorithm in fact runs in time $\sO(5^{\tw})$.
Our main contribution however is to show in \cref{subsec:acyclic:lb} that this is optimal under the pw-SETH,
even for the more restricted parameterization by pathwidth.
Lastly, in \cref{subsec:acyclic:cw} we employ the rank-based approach introduced by
Bodlaender, Cygan, Kratsch, and Nederlof~\cite{iandc/BodlaenderCKN15}
and adapted to the parameterization by clique-width by
Bergougnoux and Kant\'e~\cite{tcs/BergougnouxK19}
to develop a $2^{\bO(\cw)} n^{\bO(1)}$ algorithm for {\AcyclicM} parameterized by the clique-width $\cw$
of the input graph.


\begin{theoremrep}[\appsymb]\label{thm:acyclic:tw_algo}
    Given a graph $G$ along with a nice tree decomposition of $G$ of width $\tw$,
    there is an algorithm that computes the size of the maximum acyclic matching in $G$
    in time $\sO(5^{\tw})$.
    The algorithm is randomized, cannot give false positives,
    and may give false negatives with probability at most $1/3$.
\end{theoremrep}

\begin{proof}
    The algorithm is identical to the one of Chaudhary and Zehavi~\cite{wg/ChaudharyZ23a},
    with the only difference being that we analyze its running time slightly more carefully.
    We refer to~\cite[Section~6]{arxiv/ChaudharyZ23} for the full exposition of the algorithm.
    In the following we only sketch the main ideas and argue about the claimed running time.

    This is a standard DP algorithm over the nodes of the tree decomposition.
    In order to deal with the acyclicity constraint, the authors employ the Cut \& Count technique~\cite{talg/CyganNPPRW22},
    while fast subset convolution is used to speed up the computation in the Join nodes of the tree decomposition (see~\cite[Chapter~11]{books/CyganFKLMPPS15}).
    Observe that the $\sO(6^{\tw})$ running time claimed in~\cite{wg/ChaudharyZ23a} is solely due to the Join nodes,
    as for any other type of node $\sO(5^{\tw})$ time suffices to populate all the entries of the corresponding table.

    The key observation is that computing all entries of the table of a Join node can be done in time $\sO(5^{\tw})$.
    Following the same notation, let $\mathcal{B}_x$ denote a bag of a Join node $x$ of the tree decomposition.
    We aim to populate the table $\mathcal{A}_x[a,b,c,d,w,s]$, where $a,c \in [0,n]$, $b \in [0,n-1]$,
    $w \in [0,12n^2]$,
    and $d$ and $s$ are colorings such that $d \colon \mathcal{B}_x \to \{0,1,2\}$ and $s \colon \mathcal{B}_x \to \{0,l,r\}$
    with $d(v) = 0 \iff s(v) = 0$ for all $v \in \mathcal{B}_x$; we call such colorings $d$ and $s$ \emph{compatible}.
    Notice that the table $\mathcal{A}_x$ has $\sO(5^{\tw})$ entries.

    The authors prove that for fixed values of $a,b,c,w,s$,
    and for all colorings $d$ such that $d^{-1}(0) = R \subseteq \mathcal{B}_x$,
    one can compute the entries $\mathcal{A}_x [a,b,c,d,w,s]$ in time $2^{|\mathcal{B}_x \setminus R|} n^{\bO(1)}$.
    Consequently, summing over all subsets $R \subseteq \mathcal{B}_x$ and noticing that
    $\sum_{R \subseteq \mathcal{B}_x} 2^{|\mathcal{B}_x \setminus R|} = 3^{|\mathcal{B}_x|} \le 3^{\tw+1}$
    implies that for fixed values of $a,b,c,w,s$, the total time to compute the entries
    $\mathcal{A}_x [a,b,c,d,w,s]$ for \emph{all} colorings $d$ is $\sO(3^{\tw})$.
    Since $a,c \in [0,n]$, $b \in [0,n-1]$, $w \in [0,12n^2]$, and for every $d$ there are at most $2^{\tw}$
    compatible colorings $s$, it follows that there are $\sO(2^{\tw})$ ways to fix our parameters,
    resulting in a total time of $\sO(6^{\tw})$ to compute all entries of the table $\mathcal{A}_x$.
    Notice however that for a coloring $d$ where $d^{-1}(0) = R \subseteq \mathcal{B}_x$,
    it holds that there are at most $2^{|\mathcal{B}_x \setminus R|}$ compatible colorings $s$.
    Since $\sum_{R \subseteq \mathcal{B}_x} 2^{|\mathcal{B}_x \setminus R|} \cdot 2^{|\mathcal{B}_x \setminus R|} =
    5^{|\mathcal{B}_x|} \le 5^{\tw+1}$
    it holds that for fixed values of $a,b,c,w$,
    the total time to compute the entries of $\mathcal{A}_x [a,b,c,d,w,s]$
    for \emph{all compatible} colorings $d$ and $s$ is $\sO(5^{\tw})$,
    and thus the total time to compute all entries of the table $\mathcal{A}_x$ is $\sO(5^{\tw})$.
\end{proof}


\input{Sections/acyclic_lb}

\input{Sections/acyclic_cw}