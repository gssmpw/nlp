\proofsubparagraph{Relabeling, $H = \rho_{i \to j}(H')$.}
For each pair of pairwise different $i,j \in [\cw]$,
we define a function $g_{i \to j} \colon \{0,1,2\}^{\cw} \to \{0,1,2\}^{\cw}$.
In particular, for $\sigma' \in \{0,1,2\}^{\cw}$ we set $g_{i \to j}(\sigma') = \sigma$
such that $\sigma(w) = \sigma'(w)$ for all $w \in [\cw] \setminus \{i,j\}$,
$\sigma(i) = 0$, and
\[
    \sigma(j) =
        \begin{cases}
            \max \{ \sigma'(i), \, \sigma'(j) \}    &\text{if $0 \in \{\sigma'(i), \, \sigma'(j)\}$,}\\
            1                                       &\text{if $\sigma'(i) = \sigma'(j) = 1$}.
        \end{cases}
\]
For a fixed size $k \in [0,n]$ and signature $\sigma \in \{0,1,2\}^{\cw}$ we set the value of $\DPt_H[k,\sigma]$ to be
\begin{equation}\label{eq:DPH-relabel}
    \DPt_H[k,\sigma] = \sum_{\sigma' \in g^{-1}_{i \to j} (\sigma)} \DPt_{H'}[k,\sigma'].
\end{equation}
If $g^{-1}_{i \to j}(\sigma) = \varnothing$ we set $\DPt_H[k,\sigma] = 0$.
Notice that computing $g^{-1}_{i \to j}(\sigma)$ requires $\bO(\cw)$ time,
thus by \cref{eq:DPH-relabel} we can fill the table $\DPt_H[\cdot,\cdot]$ in time $\sO(3^{\cw})$.

\begin{lemmarep}[\appsymb]\label{lemma:induced:cw:relabel-correctness}
    Let $H = \rho_{i \to j}(H')$.
    Assume that for all $k \in [0,n]$ and $\sigma \in \{0,1,2\}^{\cw}$,
    $\DPt_{H'}[k,\sigma]$ is equal to the number of partial matchings $S$ of $H'$ such that $|S|=k$ and $\sgn_{H'}(S) = \sigma$.
    Then, $\DPt_H[k,\sigma]$ is equal to the number of partial matchings $S$ of $H$ such that $|S|=k$ and $\sgn_H(S) = \sigma$.
\end{lemmarep}

\begin{proof}

    We show that the function $g_{i \to j}$ describes precisely the effect of the operation $\rho_{i \to j}$
    on the signature of a partial matching $S$.

    \begin{claim}\label{claim:induced:cw:relabel-correctness}
        Let $S \subseteq V(H')$ such that $\sgn_{H'}(S) = \sigma'$.
        Then, $\sgn_{H}(S) = \sigma$ if and only if $g_{i \to j}(\sigma') = \sigma$.
    \end{claim}


    \begin{claimproof}
        First, notice that the labels of all vertices with label different than~$i$ remain the same between $H'$ and $H$,
        therefore it holds that $\lab_H(v) = \lab_{H'}(v)$ for all $v \in V(H') \setminus \lab^{-1}_{H'}(i)$.
        This implies that $S \cap \lab^{-1}_H (w) = S \cap \lab^{-1}_{H'} (w)$ for all $w \in [\cw] \setminus \{i,j\}$.
        Furthermore, notice that no new edge is added in $H$, consequently it holds that $\deg_{H[S]}(v) = \deg_{H'[S]}(v)$ for all $v \in V(H)$.
        This implies that $\sgn_{H,w}(S) = \sgn_{H',w}(S)$ for all $w \in [\cw] \setminus \{i,j\}$.
        Moreover, since $H$ is obtained from $H'$ by relabeling all vertices of label~$i$ to label~$j$,
        it holds that $\lab^{-1}_H(j) = \lab^{-1}_{H'}(i) \cup \lab^{-1}_{H'}(j)$ and $\lab^{-1}_H(i) = \varnothing$,
        thus $\sgn_{H,i}(S) = 0$.
        In that case, $\sgn_{H}(S)$ and $f_{i,j}(\sigma')$ agree on all labels $w \in [\cw] \setminus \{j\}$.
        It remains to argue for label~$j$.

        Assume first that $0 \in \{\sigma'(i), \, \sigma'(j)\}$.
        In that case, it holds that either $S \cap \lab^{-1}_{H'}(i) = \varnothing$ or $S \cap \lab^{-1}_{H'}(j) = \varnothing$.
        Assume that $S \cap \lab^{-1}_{H'}(i) = \varnothing$, that is, $\sgn_{H',i}(S) = 0$,
        which implies that $S \cap \lab^{-1}_{H}(j) = S \cap \lab^{-1}_{H'}(j)$,
        thus $\sgn_{H,j}(S) = \sgn_{H',j}(S) = \max \{\sgn_{H',j}(S), \, \sgn_{H',i}(S)\}$.
        In a similar way, when $S \cap \lab^{-1}_{H'}(i) = \varnothing$ we get that $\sgn_{H',j}(S) = 0$
        and $\sgn_{H,j}(S) = \sgn_{H',i}(S) = \max \{\sgn_{H',i}(S), \, \sgn_{H',j}(S)\}$.
        Thus, in this case we have that $\sgn_{H}(S) = f_{i,j}(\sigma')$.

        Next, assume that $\sigma'(i) = \sigma'(j) = 1$.
        Then, it holds that for all $v_1 \in S \cap \lab^{-1}_{H'}(i)$ and $v_2 \in S \cap \lab^{-1}_{H'}(j)$
        we have that $\deg_{H'[S]} (v_1) = \deg_{H'[S]} (v_2) = 1$.
        Since $\lab^{-1}_H(j) = \lab^{-1}_{H'}(i) \cup \lab^{-1}_{H'}(j)$ and
        for all $v \in V(H)$ it holds that $\deg_{H[S]}(v) = \deg_{H'[S]}(v)$,
        it follows that $\sgn_{H,j}(S) = 1$.
        Again we have that $\sgn_{H}(S) = f_{i,j}(\sigma')$.

        Lastly, assume that $0 \notin \{\sigma'(i), \, \sigma'(j)\}$ and either $\sigma'(i) \neq 1$ or $\sigma'(j) \neq 1$.
        Assume without loss of generality that $\sigma'(i) = 2$ and $\sigma'(j) \in \{1,2\}$.
        In that case, it holds that $S \cap \lab^{-1}_{H'}(i) = \{v\}$ with $\deg_{H'[S]}(v) = 0$
        as well as $S \cap \lab^{-1}_{H'}(i) \neq \varnothing$.
        Consequently it holds that $S \cap \lab^{-1}_H(j)$ contains at least $2$ vertices $v_1,v_2$, with $\deg_{H[S]}(v_1) = 0$,
        thus $\sgn_{H,j}(S)$ is undefined, as is the case for $f_{i,j}(\sigma')$.
    \end{claimproof}

    Consequently, the number of partial matchings of $H$ of size $k$ and signature $\sigma$
    is exactly equal to the sum of the number of partial matchings of $H'$ of size $k$ and signature $\sigma'$
    over all $\sigma' \in g^{-1}_{i \to j}(\sigma)$.
    The statement now follows by the hypothesis for $\DPt_{H'}[\cdot,\cdot]$ and \cref{eq:DPH-relabel}.
\end{proof}

