\section{ACC Problem Formulation}
\label{sec:ACC-Problem}

In this section, we consider the Adaptive Cruise Control (ACC) problem, which is more realistic than the SACC problem introduced in Sec. \ref{subsec:SACC-problem} and was investigated in case study in \cite{ames2016control}, \cite{xiao2021adaptive}.
\subsection{Vehicle Dynamics}
We consider a nonlinear vehicle dynamics in the form
\begin{small}
\begin{equation}
\label{eq:ACC-dynamics}
\underbrace{\begin{bmatrix}
\dot{z}(t) \\
\dot{v}(t) 
\end{bmatrix}}_{\dot{\boldsymbol{x}}(t)}  
=\underbrace{\begin{bmatrix}
 v_{p}-v(t) \\
 -\frac{1}{M}F_{r}(v(t))
\end{bmatrix}}_{f(\boldsymbol{x}(t))} 
+ \underbrace{\begin{bmatrix}
  0 \\
  \frac{1}{M} 
\end{bmatrix}}_{g(\boldsymbol{x}(t))}u(t)
\end{equation}
\end{small}
where $M$ denotes the mass of the ego vehicle and $v_{p}>0$ denotes the velocity of the lead vehicle. $z(t)$ denotes the distance between two vehicles and $F_{r}(v(t))=f_{0}sgn(v(t))+f_{1}v(t)+f_{2}v^{2}(t)$ denotes the resistance force as in \cite{Khalil:1173048}, where $f_{0},f_{1},f_{2}$ are positive scalars determined empirically and $v(t)>0$ denotes the velocity of the ego vehicle. The first term in $F_{r}(t)$ denotes the Coulomb friction force, the second term denotes the viscous friction force and the last term denotes the aerodynamic drag.
\subsection{Vehicle Limitations}
Vehicle limitations include vehicle constraints on safe distance, speed and acceleration.

\textbf{Safe distance constraint:} The distance is considered safe if $z(t)\ge l_{p}$ is satisfied $\forall t \in [0,T]$, where $l_{p}$ denotes the minimum distance two vehicles should maintain.

\textbf{Speed constraint:} The ego vehicle should achieve a desired speed  $v_{d}>0.$

\textbf{Acceleration constraint:} The ego vehicle should minimize the following cost
\begin{small}
\begin{equation}
\label{eq:minimal-u}
\min_{u(t)} \int_{0}^{T}(\frac{u(t)-F_{r}(v(t))}{M})^{2}dt 
\end{equation}
\end{small}
when the acceleration is constrained in the form 
\begin{equation}
\label{eq:constraint-u}
-c_{d}(t)Mg\le u(t) \le c_{a}(t)Mg, \forall t \in [0,T], 
\end{equation}
where $g$ denotes the gravity constant, $c_{d}(t)>0$ and $c_{a}(t)>0$ are deceleration and acceleration coefficients respectively.
\begin{problem}
\label{prob:ACC-prob}
Determine the optimal controller for the ego vehicle governed by dynamics \eqref{eq:ACC-dynamics} while subject to the vehicle constraints on safe distance, speed and acceleration. 
\end{problem}

To satisfy the constraint on speed, we define a CLF $V(\boldsymbol{x}(t)) \coloneqq(v(t)-v_{d})^{2}$ with $c_{1}=c_{2}=1$ to stabilize $v(t)$ to $v_{d}$ and formulate the relaxed constraint in \eqref{eq:clf} as
\begin{equation}
\label{eq:ACC-clf}
L_{f}V(\boldsymbol{x}(t))+L_{g}V(\boldsymbol{x}(t))u(t)+c_{3}V(\boldsymbol{x}(t))\le \delta(t), 
\end{equation}
where $\delta(t)$ is a relaxation that makes \eqref{eq:ACC-clf} a soft constraint.

To satisfy the constraints on safety distance and acceleration, we will define a continuous function $b(\boldsymbol{x}(t))=z(t)-l_{p}$ as AVCBF or PACBF to guarantee $b(\boldsymbol{x}(t))\ge 0$ and constraint \eqref{eq:constraint-u}, then formulate all constraints into QP to get the optimal controller.