
% While instance segmentation is a fundamental task in various computer vision applications~\cite{he2017mask,cheng2022masked,jain2023oneformer}, acquiring dense annotations for supervised learning is very expensive and time-consuming. Accordingly, researchers have explored semi-supervised methods~\cite{sohn2020simple,bellver2019budget,radosavovic2018data,yang2022bias} to reduce annotation efforts by leveraging unlabeled images along with a small amount of labeled data. These methods typically generate pseudo-labels for the unlabeled images using models trained on the labeled data and utilize these pseudo-labels during training on the entire dataset. 

% Although semi-supervised methods reduce annotation costs, they can only detect and segment objects that belong to the pre-defined classes in the labeled dataset, similar to supervised learning approaches. To overcome this limitation, researchers have recently investigated open-world instance segmentation methods~\cite{wang2022open,kalluri2023open} that can detect and segment any objects regardless of class while being trained on a labeled dataset with limited categories. However, these methods predict class-agnostic instance masks without class information.

\section{Introduction}
\label{sec:intro}
While supervised instance segmentation methods~\cite{he2017mask,cheng2022masked,jain2023oneformer} have achieved impressive performance, they require large-scale datasets with expensive human annotations. To reduce annotation costs, researchers have investigated semi-supervised learning (SSL) methods~\cite{bellver2019budget,yang2022bias, Berrada2024Guided} that utilize unlabeled images along with small-scale labeled data, as well as weakly-supervised methods~\cite{Lan2021DiscoBox} relying on weak annotations. However, all these methods rely on the closed-world assumption and can recognize only the objects belonging to the classes (\ie known classes) in the labeled dataset.

% Hence, researchers have explored novel class discovery in instance segmentation, which aims to predict instance masks and classes for both novel categories (\eg $\text{unknown}_1$ and $\text{unknown}_2$) and known classes (\eg person and car). Weng \etal proposed to generate class-agnostic masks of novel objects using a pre-trained Mask R-CNN model~\cite{he2017mask} and cluster them with hyperbolic $k$-means clustering~\cite{weng2021unsupervised}. Fomenko \etal presented a method that trains a classification head for novel classes alongside the head for known classes during training to avoid clustering during inference. We also investigate a framework that does not require clustering during inference. We first train a network for generalized class discovery and then optimize an instance segmentation network using both the labeled dataset and unlabeled images with discovered pseudo-labels, as described in~\fref{fig:teaser}.

To address this limitation, researchers have introduced novel category discovery (NCD)~\cite{han2019learning}. Unlike SSL, where the unlabeled images contain only known classes, NCD assumes that the unlabeled data include novel categories. Recently, generalized (novel) category discovery (GCD)~\cite{vaze2022generalized, cao2021open} was introduced, further relaxing the assumptions on the unlabeled data. It assumes that the unlabeled data may contain both known and novel classes, making the problem more challenging and realistic. Given labeled and unlabeled data, GCD aims to train a model capable of recognizing both the known classes (\eg person and car) in the labeled data and the novel categories (\eg unknown$_1$ and unknown$_2$) discovered from the unlabeled data.


% In detail, because the real world contains numerous objects with long-tailed distributions, we focus on enhancing generalized class discovery in instance segmentation for large-scale and long-tailed datasets. Specifically, we propose an instance-wise temperature assignment method to emphasize group-wise discrimination while relaxing instance-wise discrimination for samples belonging to head classes and vice versa. This method improves the separability of representations between different classes in long-tailed datasets. During training the instance segmentation network, we propose to utilize class-wise reliability criteria to apply varying criteria depending on head or tail classes. Additionally, we dynamically adjust the class-wise reliability criteria throughout training to utilize diverse samples in the early stages while focusing on reliable pseudo-labels in later stages. Lastly, we introduce an efficient soft attention module to encode object-specific representations for target instances while suppressing those from background or adjacent objects.

Most previous works have investigated GCD for curated and balanced image classification datasets~\cite{vaze2022generalized, An2023Generalized, Zhang2023PromptCAL, Pu2023Dynamic, wen2023parametric}. Recently, researchers have explored GCD for image classification on imbalanced datasets~\cite{Bai2023Towards, li2023imbagcd, li2023generalized}, semantic segmentation~\cite{zhao2022novel}, 3D point cloud semantic segmentation~\cite{riz2023novel}, and instance segmentation~\cite{fomenko2022learning, weng2021unsupervised}. Most of these works leverage semi-supervised contrastive learning and pseudo-label generation regardless of tasks. 

% In more detail, we first pre-train an open-world instance segmentation model using human annotations. We then apply the pre-trained model to unlabeled images to obtain class-agnostic masks. The masks are trimmed to generate new images of objects encompassing a broad range of classes and exhibiting a long-tail distribution. Then, the cropped object images are clustered by the proposed long-tail generalized class discovery model for large-scale datasets. To efficiently make the discovery model more robust to long-tail distribution, we introduce a novel adaptive temperature assignment for representation losses, aiming to enhance the separation of long-tail classes. Furthermore, a novel soft-attention module is proposed to make the discovery model focus on foreground features. Lastly, we train a novel segmentation model using both human annotated data and unlabeled images with pseudo-labels. To rely on accurate pseudo-labels while minimizing dependence on incorrect labels, we introduce a novel dynamic learning approach.

%  and class-wise reliability criteria for pseudo-labels


In this work, we also investigate GCD in instance segmentation. It is worth noting that because the real world contains numerous objects with long-tailed distributions, the instance distribution for each class in instance segmentation datasets is inherently imbalanced. For example, a `car' appears more frequently than an `ashtray'. (1) To address this imbalanced distribution, we propose an instance-wise temperature assignment method for contrastive learning. While typical contrastive learning losses treat samples from head and tail classes equally, we aim to emphasize group-wise discrimination for head class samples while focusing on instance-wise discrimination for tail class samples, inspired by~\cite{kukleva2023temperature}. (2) Although relying on reliable pseudo-labels is important~\cite{yang2022st++}, applying fixed and global reliability criteria to imbalanced data tends to exclude most pseudo-labels for tail classes. Therefore, we propose to utilize class-wise reliability criteria to apply varying thresholds for head and tail classes. Additionally, we dynamically adjust the reliability criteria throughout training to leverage diverse samples in the early stages while focusing on reliable pseudo-labels in later stages. (3) Finally, we introduce an efficient soft attention module based on spatial pooling and depth reduction to effectively encode representations for target instances while suppressing those from background or adjacent objects.


% check later 0815
% \textcolor{red}{\fref{fig:teaser}}

The contributions of this paper are as follows: (1) We propose an instance-wise temperature assignment method for semi-supervised contrastive learning in GCD to enhance the separability of classes in long-tailed distributions. (2) We introduce a reliability-based dynamic learning method for training with pseudo-labels to apply different reliability criteria to each class based on its tailness. Additionally, we adjust these criteria during training to rely on strictly reliable pseudo-labels in the later stages while using diverse data in the early stages. (3) We propose an efficient soft attention module for encoding object-specific representations for GCD. (4) We validate the effectiveness of the proposed method by discovering novel classes and training an instance segmentation network using labeled and unlabeled data.


% The contributions of this paper are summarized as follows: (1) We propose a novel framework for generalized class discovery in instance segmentation, focusing on large-scale and long-tailed datasets. (2) To enhance the separability of classes in long-tailed distributions, we propose the instance-wise temperature assignment method for representation learning of the generalized class discovery model. We also introduce an efficient soft attention module to encode object-specific representations in the discovery model. (3) We propose a reliability-based dynamic learning method to apply different reliability criteria to each class depending on its tailness. Additionally, we adjust the criteria during training to rely on strictly reliable pseudo-labels in the later stages while using diverse data in the early stages. (4) We demonstrate the effectiveness of the proposed method by training an instance segmentation network using large-scale and long-tailed datasets.

% \input{sections/fig_teaser}

