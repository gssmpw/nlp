\newcommand\function{\sffamily\maybecolor{dkblue}function}
\definecolor{dkblue}{rgb}{0.0, 0.0, 0.55}
\makeatletter
\lstdefinelanguage{fstar}{%
  captionpos=b,    
  basicstyle=\small,
  morekeywords=[1]{type,and,val,fun,let,in,ref,uref,mref,try,if,then,else,match,with,open,as,module,rec,begin,end,assume,private,when,forall,assert,by_tactic,logic,array,pattern,effect,requires,ensures,decreases,modifies, abstract,total, reifiable, reflectable, new, new_effect, effect_actions, noeq, sub_effect, by, synth,splice,class},
  morekeywords=[2]{WP, Post, Pre, Pure , PURE, DIV, STATE, EXN, ALL, TotST, M, GHOST, Ghost, GTot, Lemma, Tot, Div, DIV, Memo, READER, STATE_m, Effect, STEXN, RANDOM, ST, St, MST, S_MST, MSTExn, TAC, Tac, TacH},
  morekeywords=[3]{},
  morekeywords=[4]{},
  morestring=[b]",
  sensitive=true,%
  numbersep=4pt,
%  numbers=left,
  columns=[l]fullflexible,
  texcl=true,
  mathescape=true,
%  xleftmargin=10pt,
  identifierstyle={\sffamily},
  keywordstyle=[1]{\color{dkblue}},
  keywordstyle=[2]{\color{dkblue}},
  keywordstyle=[3]{\maybecolor{dkred}},
  keywordstyle=[4]{\rmfamily\itshape},
% Here is the range marker stuff
  rangeprefix=(*---\ ,
  includerangemarker=false,
  stringstyle=\ttfamily,
  %lineskip=-2pt,
  showspaces=false,
  morecomment=[n]{(*}{*)},
  commentstyle={\itshape\maybecolor{dkred}},
  literate={->}{$\rightarrow$}{1}
           {_'a}{${}_\alpha$}{1}
           {_\{'a+1\}}{${}_{\alpha+1}$}{2}
           {_\{i\}}{${}_{\mathsf{i}}$}{2}
           {_\{i+1\}}{${}_{\mathsf{i}+1}$}{2}
           {__}{\_}{1}
           {True}{$\top$}{1}
           {False}{$\bot$}{1}
           {exists}{$\exists$}{1}
           {forall}{$\forall$}{1}
           {fun}{$\lambda$}{1}
           {func}{func}{1}
           {~}{$\neg$}{1}           
           {~>}{$\leadsto$}{1}
           {`}{\`{}}{1}
           {'a}{$\alpha$}{1}
           {'b}{$\beta$}{1}
           {'c}{$\gamma$}{1}
           {phi}{$\phi$}{1}
           {tau}{$\tau$}{1}
           {tauto}{tauto}{6}
           {psi}{$\psi$}{1}
           {xi}{$\xi$}{1}
           {VC_e}{VC$_e$}{1}
           {Gamma}{$\Gamma$}{1}
           {theta}{$\theta$}{1}
           {_0}{$_0$}{1}
           {_1}{$_1$}{1}
           {_2}{$_2$}{1}
           {_3}{$_3$}{1}
           {_4}{$_4$}{1}
           {STATE0}{$\mathsf{ST}^\prime$}{1}
           {/\\}{$\wedge$}{1}
           {\\/}{$\vee$}{1}
           {>=}{$\geq$}{2}
           {<=}{$\leq$}{2}
           {<==>}{$\Longleftrightarrow$}{3}
           {==>}{$\Longrightarrow$}{3}
           {|->}{$\mapsto$}{3}
           {|>}{$\mapsto$}{2}
           {-~-}{$\bowtie$}{2}
           {.+}{$\odot$}{1}
           {pulseup}{$\uparrow$}{1}
           {pulsedown}{$\downarrow$}{1}
           %% {dot}{$\bullet \ $}{3}
           %% {nat}{$\mathbb{N}$}{3}
           %% {emp}{$\emptyset$}{3}
     {<>}{$\neq$}{1}
     {<*>}{$\bullet \ $}{3}
     {--}{-}{1}   % Added due to         - not displaying properly.  Weird. ... but may make arrows look bad  {...}{$\ldots$}{3}
     {<<}{$\prec\ $}{1}
           ,
  breaklines=false}
\makeatother

