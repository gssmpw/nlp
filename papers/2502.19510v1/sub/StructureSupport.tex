%%%%%%%%%%%%%%%%%%
\FloatBarrier
\subsection{Optimization of  the distribution of the structural supports of a water tank} \label{sec.StructureSupport}
%%%%%%%%%%%%%%%%%%

\noindent In this section, we slip into structural mechanics, where
we implement the techniques developed in \cref{sec.optbcconduc,sec.TopologicalSensitivity,sec.Elasticity} to optimize the supporting regions of a water tank.
As illustrated in \cref{fig.BoundaryOptimization.StructureSupport.WaterTank}, the structure features a cylindrical body and a domed upper part equipped with an access hatch. In the context of use, it is elevated on supporting legs which are anchored to a solid base plate, thus supporting the structure against gravity loads. Our goal is to optimize the distribution of these supporting regions on the boundary of the tank so as to minimize its total displacement. 

\begin{figure}[!ht]
    \centering
          \begin{tabular}{cc}
\begin{minipage}{0.5\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/setwtank}
\put(0,-35){\fcolorbox{black}{white}{a}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.4\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_Setup}
\put(2,5){\fcolorbox{black}{white}{b}}
\end{overpic}
\end{minipage}
\end{tabular}      
    \caption{\it (a) Sketch of the physical setting and (b) Tetrahedral mesh $\mathcal{T}$ of the initial guess in the optimal design example of supports on the surface of a water tank considered in \cref{sec.StructureSupport}.}
    \label{fig.BoundaryOptimization.StructureSupport.WaterTank}
\end{figure}
%
%

%%%%%%%%%%%%
\subsubsection{Description of the optimization problem}
%%%%%%%%%%%%

\noindent The water tank is represented by a bounded domain $\Omega \subset \mathbb{R}^3$, where the boundary $\partial \Omega$ is decomposed into three disjoint regions, as: 
$$ \partial \Omega = \overline{\Gamma_D} \cup \overline{\Gamma_F} \cup \overline{\Gamma},$$
where:
\begin{itemize}
    \item The region $\Gamma_D$, with boundary $\Sigma_D := \partial\Gamma_D$, is that where the water tank is fixed;
        \item The region $\Gamma_F$ is the upper part of the tank; it is traction-free and non optimizable (it cannot be riveted, as it serves as the lid of the tank);
    \item The remaining region $\Gamma$ is traction-free.
\end{itemize}

The water tank $\Omega$ is subject to body forces $f : \R^3 \to \R^3$ representing gravity. 
Its displacement $u_{\Gamma_D}$ in these circumstances is the unique solution in $H^1(\Omega)^3$ to the linearized elasticity system:
\begin{equation} \label{eq.BoundaryOptimization.StructureSupport.Elasticity}
\left\{
\begin{array}{cl}
    -\dv (Ae(u_{\Gamma_D})) = f & \text{in } \Omega, \\
    Ae(u_{\Gamma_D}) n= 0 & \text{on } \Gamma \cup \Gamma_F,\\
    u_{\Gamma_D} = 0 & \text{on } \Gamma_D.
\end{array}
\right.
\end{equation}

In this setting, we wish to minimize the mean displacement of the structure under the effect of gravity, 
while utilizing a reasonably low amount of supports, i.e. we consider the problem: 
\begin{equation} \label{eq.BoundaryOptimization.StructureSupport.Problem}
    \min_{\Gamma_D \subset \partial \Omega} J(\Gamma_D) + \ell \Area(\Gamma_D) + m \Cont(\Gamma_D), \text{ where } J(\Gamma_D) = \dfrac{1}{2 \Vol(\Omega)} \int_{\Omega} |u_{\Gamma_D}|^2 ,
\end{equation}
and $\ell$ and $m$ are fixed penalization parameters for the area and contour length of $\Gamma_D$, respectively.

%%%%%%%%%%%%
\subsubsection{Shape derivative of the functional $J(\Gamma_D)$}
%%%%%%%%%%%%

\noindent Like in the situation addressed in the previous \cref{sec.CathodeAnode}, 
the weak singularity of the state function $u_{\Gamma_D}$ in \cref{eq.BoundaryOptimization.StructureSupport.Elasticity} near the transition region $\Sigma_D$ between homogeneous Dirichlet and homogeneous Neumann boundary conditions makes it difficult to compute the shape derivative of the functional $J(\Gamma_D)$. 
We therefore replace the function $J(\Gamma_D)$ in \cref{eq.BoundaryOptimization.StructureSupport.Problem} by that $J_\e(\Gamma_D)$ defined by:
\begin{equation} \label{eq.BoundaryOptimization.StructureSupport.ApproxProblem}
J_\e(\Gamma_D) = \dfrac{1}{2\Vol(\Omega)} \int_{\Omega} |u_{\Gamma_D,\e}|^2 \: \mathrm{d}x,
\end{equation}
where $u_{\Gamma_D,\e} \in H^1(\Omega)^3$ is the unique solution to the following approximate boundary value problem:
\begin{equation*}
    \begin{aligned}
        \left\{ 
        \begin{array}{cl}
        -\dv  (Ae(u_{\Gamma_D,\e})) = f& \mathrm{in} \ \Omega,\\
        Ae(u_{\Gamma_D,\e})n + h_{\Gamma_D, \e} u_{\Gamma_D,\e} = 0 & \mathrm{on} \ \partial \Omega .
        \end{array}
        \right.
    \end{aligned}
    \end{equation*}
Like in the previous investigations, the function $h_{\Gamma_D, \e} : \partial \Omega \rightarrow \mathbb{R}$ is defined by:
\begin{equation*}
    \forall x \in \partial \Omega, \quad  h_{\Gamma_D, \e}(x) = h\left( \dfrac{d^{\partial \Omega}_{\Gamma_D} (x) }{\e} \right),
\end{equation*}
where $d^{\partial \Omega}_{\Gamma_D}$ is the geodesic signed distance function to $\Gamma_D$ (see \cref{sec.distmanifold}) 
and the transition profile $h \in C^\infty(\mathbb{R})$ satisfies \cref{eq.ShapeDerivatives.BumpFunction}.
 
The shape derivative of $J_\e(\Gamma_D)$ is supplied by the next proposition, whose proof is omitted for brevity.

\begin{proposition} \label{theorem.BoundaryOptimization.StructureSupport.ShapeDerivative}
    The functional $J_\e(\Gamma_D)$ in \cref{eq.BoundaryOptimization.StructureSupport.ApproxProblem} is shape differentiable and its shape derivative reads, for an arbitrary tangential deformation $\theta$ (i.e. such that $\theta \cdot n = 0$):
    \begin{equation*}
    J_\e'(\Gamma_D)(\theta)  =  -\frac{1}{\e^2} \int_{\partial \Omega} h'\left(\frac{d^{\partial \Omega}_{\Gamma_D}(x)}{\e}\right) \: \theta(\pi_{\Sigma_D}(x)) \cdot n_{\Sigma_D} (\pi_{\Sigma_D}(x)) \: u_{\Gamma_D,\e}(x) \cdot p_{\Gamma_D,\e}(x) \: \d s(x)
    ,     \end{equation*}
    where the adjoint state $p_{\Gamma_D,\e} \in H^1(\Omega)^3$ is characterized by the following boundary value problem:
    \begin{equation*}
        \left\{ 
        \begin{array}{cl}
        -\dv (Ae(p_{\Gamma_D,\e})) = -\dfrac{u_{\Gamma_D,\e}}{\Vol(\Omega)} & \mathrm{in }\: \Omega,\\
        Ae(p_{\Gamma_D,\e})n + h_{\Gamma_D, \e} p_{\Gamma_D,\e} = 0 & \mathrm{on } \: \partial \Omega .
        \end{array}
        \right.
    \end{equation*}
\end{proposition}

%%%%%%%%%%%%
\subsubsection{Topological derivative of the functional $J(\Gamma_D)$}
%%%%%%%%%%%%

\noindent The sensitivity of the objective function $J(\Gamma_D)$ in \cref{eq.BoundaryOptimization.StructureSupport.ApproxProblem}Â with respect to the addition to $\Gamma_D$ of a small surface disk $\omega_{x_0,\e}$ centered at $x_0 \in \Gamma$ is given by the following result, which directly follows from the study conducted in \cref{sec.qoielas}.

\begin{proposition}
Let $\Gamma_D$ be a region of the smooth boundary $\partial \Omega$ and let $x_0 \in \Gamma$ be given. Then,
the perturbed criterion $J(({\Gamma_D})_{x_0, \e})$, accounting for the addition of the surface disk $\omega_{x_0,\e} \subset \Gamma$ to $\Gamma_D$, has the following asymptotic expansion:
    \begin{equation*}
        J(({\Gamma_D})_{x_0, \e}) = J(\Gamma_D)  +   \frac{1}{\lvert \log \e \lvert }\frac{\pi \mu}{1-\overline\nu} u_{\Gamma_D}(x_0) \cdot p_{\Gamma_D}(x_0)   + \o\left(\dfrac{1}{|\log \e|}\right)  \text{ if } d = 2,\\
    \end{equation*}
    and 
        \begin{equation*}
        J(({\Gamma_D})_{x_0, \e}) = J(\Gamma_D)  +  \e \: M u_{\Gamma_D}(x_0) \cdot p_{\Gamma_D}(x_0)   + \o(\e) \: \text{ if } d = 3.
    \end{equation*}
Here, the polarization tensor $M$ is defined by \cref{eq.defMelas} and the adjoint state $p_{\Gamma_D} \in H^1(\Omega)^3$ is characterized by the following boundary value problem:
\begin{equation*}
\left\{
\begin{array}{cl}
    -\dv (Ae(p_{\Gamma_D})) = -\frac{u_{\Gamma_D}}{\Vol(\Omega)} & \text{in } \Omega, \\
    Ae(p_{\Gamma_D}) n= 0 & \text{on } \Gamma \cup \Gamma_F,\\
    p_{\Gamma_D} = 0 & \text{on } \Gamma_D.
\end{array}
\right.
\end{equation*}
\end{proposition}\par\medskip
 
%%%%%%%%%%%%
\subsubsection{Description of the numerical experiments and results}
%%%%%%%%%%%%

\noindent The initial configuration is supplied by a tetrahedral mesh $\mathcal{T}^0$ of the water tank $\Omega$, consisting of $17,000$ vertices and $81,000$ tetrahedra, which is displayed in \cref{fig.BoundaryOptimization.StructureSupport.WaterTank} (b). 
The initial region $\Gamma_D^0$ is a disk with unit radius, located on the bottom of the water tank. 

The parameters of the constituent elastic material of $\Omega$ are $\lambda = 0.5769$, $\mu = 0.3846$ (corresponding to a Young's modulus $E=1$ and Poisson's ratio $\nu=0.3$) and the gravity force $f$ equals $f=(0,0,-0.1)$. The minimum (resp. maximum) size of an element in the mesh is $\hmin = 0.05$ (resp. $\hmax=0.5$) and the regularization parameter $\e$ featured in the approximate functional \cref{eq.BoundaryOptimization.StructureSupport.ApproxProblem} equals $1e^{-6}$. The penalization parameter $\ell$ for the area of $\Gamma_D$ equals $1e^{-5}$, and we conduct two experiments in this context, associated to different penalization parameters $m$ for the length of the contour $\Sigma_D$.
Each resolution starts with 5 iterations, during which the topological derivative of $J(\Gamma_D)$ is used to add new small regions to $\Gamma_D$, followed by 45 iterations of geometric optimization, during which the newly created regions evolve by deformation of their boundaries. We then carry out one application of topological derivative every 10 iterations until reaching $n=100$, at which point only geometric optimization updates are used.\par\medskip

In the first experiment, no penalization on the contour length of $\Gamma_D$ is imposed: $m=0$. The results are depicted on \cref{fig.StructureSupport.Results_1} and the total simulation takes approximately 3 hours. The algorithm clearly prioritizes the ``ribs'' around the flat indentations for the placement of supporting regions. During the initial iterations, based on the topological derivative of $J(\Gamma_D)$, supports are immediately positioned near these ribs, and the subsequent geometric updates focus on covering most of these areas. The bottom region of the tank remains essentially unchanged, highlighting its essential role in minimizing the displacement of the water tank.

Our second experiment features a penalization of the contour $\Cont(\Gamma_D)$ of the support region with the parameter $m=1e^{-5}$. The results are depicted on \cref{fig.StructureSupport.Results_2}; the complete simulation requires about 2 hours. Similar trends are observed, while the optimized design is more regular. In this final design, all the supporting areas are concentrated near the ribs of the water tank or its bottom, in good agreement with observations made in previous contributions to the analysis of this problem \cite{dayyani2015mechanics,yokozeki2006mechanical}. This demonstrates that corrugated structures exhibit high resistance to loads applied perpendicular to the direction of the ribs. The smooth minimization of the objective by the algorithm further reinforces the validity of our results, confirming the effectiveness and reliability of our approach.

\begin{figure}[ht]
    \centering
    \begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_5}
\put(2,5){\fcolorbox{black}{white}{$n=5$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_20}
\put(2,5){\fcolorbox{black}{white}{$n=20$}}
\end{overpic}
\end{minipage}
\end{tabular}     \par\bigskip 
    \begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_40}
\put(2,5){\fcolorbox{black}{white}{$n=40$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_80}
\put(2,5){\fcolorbox{black}{white}{$n=80$}}
\end{overpic}
\end{minipage}
\end{tabular}
\begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_120}
\put(2,5){\fcolorbox{black}{white}{$n=120$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_165}
\put(2,5){\fcolorbox{black}{white}{$n=165$}}
\end{overpic}
\end{minipage}
\end{tabular}      
\caption{\it A few intermediate shapes produced during the first experiment of the optimization of the support regions (in pink) of the water tank considered in \cref{sec.StructureSupport}; the blue region is not subject to optimization.}
    \label{fig.StructureSupport.Results_1}
\end{figure}

\begin{figure}[ht]
    \centering
     \begin{tabular}{cc}
\begin{minipage}{0.5\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_1_Bottom}
\put(2,5){\fcolorbox{black}{white}{a}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.4\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_Obj_1}
\put(2,5){\fcolorbox{black}{white}{b}}
\end{overpic}
\end{minipage}
\end{tabular}     
    \caption{\it (a) Final design in the first experiment of the optimization of the supporting region of the water tank considered in \cref{sec.StructureSupport}; (b) Associated convergence history.}
\end{figure}

\begin{figure}[ht]
    \centering
    \begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_20}
\put(2,5){\fcolorbox{black}{white}{$n=20$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_40}
\put(2,5){\fcolorbox{black}{white}{$n=40$}}
\end{overpic}
\end{minipage}
\end{tabular}     \par\bigskip 
    \begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_80}
\put(2,5){\fcolorbox{black}{white}{$n=80$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_120}
\put(2,5){\fcolorbox{black}{white}{$n=120$}}
\end{overpic}
\end{minipage}
\end{tabular}
\begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_160}
\put(2,5){\fcolorbox{black}{white}{$n=160$}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_200}
\put(2,5){\fcolorbox{black}{white}{$n=200$}}
\end{overpic}
\end{minipage}
\end{tabular}
\caption{\it A few intermediate shapes produced during the second experiment of the optimization of the support regions (in pink) of the water tank considered in \cref{sec.StructureSupport}; the blue region is not subject to optimization.}
\label{fig.StructureSupport.Results_2}
\end{figure}


\begin{figure}[ht]
    \centering
        \begin{tabular}{cc}
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_265}
\put(2,5){\fcolorbox{black}{white}{a}}
\end{overpic}
\end{minipage} & 
\begin{minipage}{0.45\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_Bottom}
\put(2,5){\fcolorbox{black}{white}{b}}
\end{overpic}
\end{minipage}
\end{tabular}     \par\bigskip 
\begin{minipage}{0.6\textwidth}
\begin{overpic}[width=1.0\textwidth]{figures/WaterTank_2_Obj}
\put(2,5){\fcolorbox{black}{white}{c}}
\end{overpic}
\end{minipage}
    \caption{\it (a) Final design in the second experiment of the optimization of the support regions of the water tank considered in \cref{sec.StructureSupport}; (b) Bottom view of the optimized shape; (c) Associated convergence history.}
\end{figure}
