\subsection{Powerformer}
\label{sm:experiments_powerformer_results}

We present the full \emph{Powerformer} results on all the evaluated masks: \fpl, \fspl, \fbwo, and \fbwt.
Architecture details can be found in Appendix~\ref{sm:powerformer_architecture}, while Appendices~\ref{sm:exp_details} and \ref{sm:experiments_powerformer} outline the experimental details.



\subsubsection{Weight Power-Law Mask}
\label{sm:experiments_powerformer_simpowerLaw}
Table~\ref{tab:powerformer_powerLaw_results} presents the aggregate MSE and MAE results for weight power-law mask (\fpl) with varying time decays ($\alpha$), forecasting lengths, and input sequence lengths.
The 512 input sequence generally outperforms the shorter 336 input length.
As expected, the best performing $\alpha$ varies between datasets, but it also varies as a function of forecast length and input sequence length.
Given that some of the best-performing decay lengths are $\alpha=1$ with further experiments one may improve upon these values.
However, our \fspl{} mask includes faster-decaying weights, as shown in Fig.~\ref{fig:maskPL}.

We compare all datasets' attention score and weight distributions both with MHA and WCMHA in Figs~\ref{fig:powerformer_etth1_96_powerLaw_attn_full}-\ref{fig:powerformer_traffic_720_powerLaw_attn_full}.
We observe similar bimodal distributions for all datasets and note wider \weightCL{} distributions for ETTm1, ETTm2, and Weather.


\begingroup
%\setlength{\tabcolsep}{10pt} % Default value: 6pt
\renewcommand{\arraystretch}{0.62} % Default value: 1
\begin{table*}[!ht]
    \centering
    \caption{We compare \emph{Powerformer's} performance with the weight power law mask \fpl{} on standard time-series datasets for varying decay lengths. The best results are bolded and second best are underlined.}
    \label{tab:powerformer_powerLaw_results}
    \vskip 0.1in
    \resizebox{0.97\textwidth}{!}{
    \begin{tabular}{c|c|c|cc|cc|cc|cc|cc}
    	\toprule
    	\multicolumn{3}{c|}{Delay}  & \multicolumn{2}{c|}{0.1} & \multicolumn{2}{c|}{0.25} & \multicolumn{2}{c|}{0.5} & \multicolumn{2}{c|}{0.75} & \multicolumn{2}{c}{1} \\
    	\midrule
    	\multicolumn{3}{c|}{Metric} & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTh1}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \underline{0.377} & \textbf{0.401} &  \underline{0.377} & \textbf{0.401} &  \underline{0.377} & \textbf{0.401} &  \textbf{0.376} & \textbf{0.401} &  \textbf{0.376} & \textbf{0.401} \\
    		 & & 192 &  \textbf{0.413} & \textbf{0.421} &  \textbf{0.413} & \textbf{0.421} &  \textbf{0.413} & \textbf{0.421} &  \textbf{0.413} & \textbf{0.421} &  \underline{0.414} & \textbf{0.421} \\
    		 & & 336 &  \textbf{0.424} & \textbf{0.430} &  \underline{0.425} & \textbf{0.430} &  \underline{0.425} & \textbf{0.430} &  \underline{0.425} & \textbf{0.430} &  \underline{0.425} & \textbf{0.430} \\
    		 & & 720 &  \textbf{0.437} & \textbf{0.455} &  \textbf{0.437} & \textbf{0.455} &  \textbf{0.437} & \textbf{0.455} &  \textbf{0.437} & \underline{0.456} &  \underline{0.438} & \underline{0.456} \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \textbf{0.369} & \textbf{0.399} &  \textbf{0.369} & \textbf{0.399} &  \underline{0.370} & \textbf{0.399} &  \underline{0.370} & \textbf{0.399} &  \underline{0.370} & \textbf{0.399} \\
    		 & & 192 &  0.404 & \underline{0.420} &  0.404 & \underline{0.420} &  \textbf{0.402} & \textbf{0.418} &  \underline{0.403} & \textbf{0.418} &  \underline{0.403} & \textbf{0.418} \\
    		 & & 336 &  \textbf{0.414} & \textbf{0.428} &  \textbf{0.414} & \textbf{0.428} &  \underline{0.415} & \underline{0.429} &  \underline{0.415} & 0.430 &  0.416 & 0.431 \\
    		 & & 720 &  \textbf{0.440} & \textbf{0.460} &  \textbf{0.440} & \textbf{0.460} &  \textbf{0.440} & \textbf{0.460} &  \underline{0.443} & \underline{0.462} &  \underline{0.443} & \textbf{0.460} \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTh2}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \textbf{0.274} & \textbf{0.335} &  \textbf{0.274} & \underline{0.336} &  \underline{0.275} & \underline{0.336} &  \underline{0.275} & \textbf{0.335} &  \underline{0.275} & \textbf{0.335} \\
    		 & & 192 &  0.341 & \underline{0.381} &  \textbf{0.338} & \textbf{0.379} &  \underline{0.340} & \textbf{0.379} &  \underline{0.340} & \textbf{0.379} &  0.341 & \textbf{0.379} \\
    		 & & 336 &  \textbf{0.325} & \textbf{0.379} &  \underline{0.326} & \underline{0.380} &  0.331 & 0.384 &  0.333 & 0.383 &  0.334 & 0.383 \\
    		 & & 720 &  \underline{0.377} & \underline{0.420} &  \textbf{0.376} & \textbf{0.419} &  0.381 & 0.423 &  0.381 & 0.422 &  0.381 & 0.422 \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \textbf{0.274} & \textbf{0.337} &  \textbf{0.274} & \textbf{0.337} &  \textbf{0.274} & \textbf{0.337} &  \underline{0.275} & \textbf{0.337} &  \underline{0.275} & \underline{0.338} \\
    		 & & 192 &  \textbf{0.340} & \textbf{0.381} &  \textbf{0.340} & \textbf{0.381} &  \underline{0.341} & \underline{0.382} &  0.342 & \underline{0.382} &  0.342 & \underline{0.382} \\
    		 & & 336 &  \textbf{0.330} & \textbf{0.387} &  \underline{0.331} & \textbf{0.387} &  0.333 & \underline{0.388} &  0.334 & \underline{0.388} &  0.334 & \underline{0.388} \\
    		 & & 720 &  \textbf{0.383} & \underline{0.426} &  \underline{0.384} & \underline{0.426} &  \textbf{0.383} & \underline{0.426} &  \underline{0.384} & \underline{0.426} &  \textbf{0.383} & \textbf{0.425} \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTm1}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \underline{0.292} & \underline{0.343} &  \textbf{0.290} & \textbf{0.342} &  \underline{0.292} & \underline{0.343} &  0.293 & 0.344 &  \underline{0.292} & 0.345 \\
    		 & & 192 &  0.333 & 0.371 &  0.334 & 0.372 &  \underline{0.332} & 0.371 &  \underline{0.332} & \underline{0.370} &  \textbf{0.330} & \textbf{0.369} \\
    		 & & 336 &  0.362 & 0.392 &  \underline{0.361} & 0.391 &  0.362 & \underline{0.390} &  \textbf{0.359} & \textbf{0.389} &  0.362 & \textbf{0.389} \\
    		 & & 720 &  \underline{0.413} & 0.423 &  \underline{0.413} & \underline{0.422} &  \underline{0.413} & \textbf{0.421} &  \underline{0.413} & \textbf{0.421} &  \textbf{0.412} & 0.423 \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \underline{0.291} & \textbf{0.345} &  \textbf{0.290} & \textbf{0.345} &  \textbf{0.290} & \textbf{0.345} &  \underline{0.291} & \underline{0.346} &  0.292 & \underline{0.346} \\
    		 & & 192 &  0.331 & \underline{0.370} &  \underline{0.330} & \underline{0.370} &  \textbf{0.329} & \textbf{0.368} &  0.332 & \underline{0.370} &  0.332 & 0.372 \\
    		 & & 336 &  \underline{0.362} & \underline{0.391} &  \underline{0.362} & \textbf{0.390} &  \textbf{0.361} & 0.392 &  \underline{0.362} & \textbf{0.390} &  0.363 & \underline{0.391} \\
    		 & & 720 &  0.417 & 0.428 &  \textbf{0.415} & \underline{0.425} &  0.417 & \textbf{0.423} &  0.420 & 0.426 &  \underline{0.416} & 0.430 \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTm2}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \textbf{0.162} & \textbf{0.252} &  0.165 & 0.255 &  \underline{0.163} & \underline{0.253} &  0.164 & 0.254 &  0.164 & 0.254 \\
    		 & & 192 &  \textbf{0.222} & \textbf{0.292} &  \textbf{0.222} & \underline{0.293} &  \textbf{0.222} & \underline{0.293} &  \textbf{0.222} & \underline{0.293} &  \textbf{0.222} & \underline{0.293} \\
    		 & & 336 &  \textbf{0.277} & \textbf{0.329} &  \textbf{0.277} & \textbf{0.329} &  \textbf{0.277} & \textbf{0.329} &  \textbf{0.277} & \textbf{0.329} &  \underline{0.278} & \underline{0.330} \\
    		 & & 720 &  0.363 & \underline{0.381} &  0.363 & \underline{0.381} &  \underline{0.362} & 0.382 &  \textbf{0.359} & \textbf{0.380} &  \textbf{0.359} & 0.384 \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \underline{0.165} & \textbf{0.255} &  \underline{0.165} & \textbf{0.255} &  \underline{0.165} & \underline{0.256} &  \underline{0.165} & 0.257 &  \textbf{0.164} & \textbf{0.255} \\
    		 & & 192 &  \underline{0.222} & \underline{0.295} &  0.224 & 0.297 &  0.224 & 0.296 &  0.223 & 0.296 &  \textbf{0.221} & \textbf{0.294} \\
    		 & & 336 &  0.274 & \underline{0.329} &  0.274 & \underline{0.329} &  0.274 & \underline{0.329} &  \textbf{0.272} & \textbf{0.327} &  \underline{0.273} & \textbf{0.327} \\
    		 & & 720 &  \underline{0.358} & 0.383 &  \underline{0.358} & 0.383 &  \underline{0.358} & \underline{0.382} &  \underline{0.358} & 0.383 &  \textbf{0.356} & \textbf{0.381} \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Weather}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \textbf{0.151} & \underline{0.201} &  \textbf{0.151} & \underline{0.201} &  \textbf{0.151} & \textbf{0.200} &  \underline{0.152} & \textbf{0.200} &  0.154 & 0.202 \\
    		 & & 192 &  \textbf{0.196} & 0.243 &  \textbf{0.196} & \underline{0.242} &  \textbf{0.196} & \textbf{0.241} &  \textbf{0.196} & \textbf{0.241} &  \underline{0.197} & \underline{0.242} \\
    		 & & 336 &  \underline{0.248} & 0.283 &  \textbf{0.247} & 0.283 &  \textbf{0.247} & \textbf{0.281} &  \textbf{0.247} & \underline{0.282} &  \textbf{0.247} & \textbf{0.281} \\
    		 & & 720 &  \underline{0.318} & \underline{0.334} &  \underline{0.318} & \underline{0.334} &  \underline{0.318} & \underline{0.334} &  \textbf{0.317} & \textbf{0.333} &  \textbf{0.317} & \textbf{0.333} \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \underline{0.148} & \underline{0.198} &  \textbf{0.147} & \textbf{0.197} &  \textbf{0.147} & 0.199 &  \underline{0.148} & 0.199 &  \underline{0.148} & 0.199 \\
    		 & & 192 &  \underline{0.193} & \underline{0.241} &  \underline{0.193} & \underline{0.241} &  \underline{0.193} & \underline{0.241} &  \textbf{0.191} & \textbf{0.239} &  \underline{0.193} & \underline{0.241} \\
    		 & & 336 &  \textbf{0.243} & 0.281 &  \underline{0.244} & 0.281 &  \textbf{0.243} & \underline{0.280} &  \textbf{0.243} & \textbf{0.279} &  \underline{0.244} & \underline{0.280} \\
    		 & & 720 &  \textbf{0.311} & \underline{0.330} &  \textbf{0.311} & \underline{0.330} &  0.314 & 0.331 &  \underline{0.312} & \underline{0.330} &  \textbf{0.311} & \textbf{0.329} \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Electricity}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \underline{0.131} & \textbf{0.224} &  \underline{0.131} & \textbf{0.224} &  \textbf{0.130} & \textbf{0.224} &  \underline{0.131} & \textbf{0.224} &  \underline{0.131} & \textbf{0.224} \\
    		 & & 192 &  \textbf{0.147} & \underline{0.241} &  \textbf{0.147} & \textbf{0.240} &  \textbf{0.147} & \textbf{0.240} &  \textbf{0.147} & \underline{0.241} &  \underline{0.148} & \underline{0.241} \\
    		 & & 336 &  \textbf{0.164} & 0.259 &  \textbf{0.164} & \textbf{0.257} &  \textbf{0.164} & 0.259 &  \textbf{0.164} & \underline{0.258} &  \textbf{0.164} & 0.259 \\
    		 & & 720 &  \textbf{0.201} & \textbf{0.291} &  \textbf{0.201} & \underline{0.292} &  \underline{0.202} & \underline{0.292} &  \textbf{0.201} & \textbf{0.291} &  \underline{0.202} & 0.293 \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \underline{0.130} & \underline{0.224} &  \textbf{0.129} & \underline{0.224} &  \textbf{0.129} & \underline{0.224} &  \textbf{0.129} & \textbf{0.223} &  \textbf{0.129} & \textbf{0.223} \\
    		 & & 192 &  \underline{0.147} & \underline{0.241} &  \textbf{0.146} & \underline{0.241} &  \underline{0.147} & \textbf{0.240} &  \textbf{0.146} & \textbf{0.240} &  \underline{0.147} & \underline{0.241} \\
    		 & & 336 &  \underline{0.163} & \underline{0.258} &  \textbf{0.162} & \textbf{0.257} &  \textbf{0.162} & \underline{0.258} &  \textbf{0.162} & \textbf{0.257} &  \textbf{0.162} & \underline{0.258} \\
    		 & & 720 &  \underline{0.199} & \underline{0.290} &  \textbf{0.198} & \underline{0.290} &  \textbf{0.198} & \underline{0.290} &  \textbf{0.198} & \textbf{0.289} &  \textbf{0.198} & \underline{0.290} \\
    	\midrule
    	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Traffic}}}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
    		 & 96 &  \underline{0.371} & \textbf{0.253} &  \textbf{0.370} & \textbf{0.253} &  0.372 & \underline{0.254} &  0.372 & \underline{0.254} &  0.373 & 0.255 \\
    		 & & 192 &  \textbf{0.388} & \textbf{0.260} &  \textbf{0.388} & \textbf{0.260} &  \underline{0.390} & \underline{0.261} &  \underline{0.390} & \underline{0.261} &  \underline{0.390} & \underline{0.261} \\
    		 & & 336 &  \textbf{0.400} & \underline{0.267} &  \textbf{0.400} & \textbf{0.266} &  0.404 & 0.269 &  \underline{0.402} & 0.268 &  0.403 & 0.268 \\
    		 & & 720 &  \underline{0.435} & \underline{0.287} &  \textbf{0.434} & \textbf{0.286} &  \underline{0.435} & \textbf{0.286} &  \textbf{0.434} & \textbf{0.286} &  \textbf{0.434} & \textbf{0.286} \\ \cmidrule{2-13}
    	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
    		 & 96 &  \textbf{0.365} & \textbf{0.252} &  \textbf{0.365} & \textbf{0.252} &  \underline{0.367} & \underline{0.253} &  \underline{0.367} & \underline{0.253} &  0.394 & 0.282 \\
    		 & & 192 &  \textbf{0.382} & \textbf{0.258} &  0.391 & 0.269 &  \underline{0.383} & \underline{0.259} &  \textbf{0.382} & 0.260 &  0.407 & 0.286 \\
    		 & & 336 &  0.393 & \textbf{0.265} &  \textbf{0.391} & \textbf{0.265} &  \underline{0.392} & \textbf{0.265} &  0.393 & \textbf{0.265} &  0.394 & \textbf{0.265} \\
    		 & & 720 &  0.435 & 0.289 &  0.432 & 0.288 &  0.432 & \underline{0.287} &  \underline{0.431} & \underline{0.287} &  \textbf{0.430} & \textbf{0.286} \\
    	\bottomrule
    \end{tabular}}
\end{table*}
\endgroup



\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh1_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTh1 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_etth1_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh1_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTh1 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_etth1_720_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh2_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTh2 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_etth2_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh2_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTh2 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_etth2_720_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm1_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTm1 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm1_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm1_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTm1 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm1_720_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm2_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTm2 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm2_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm2_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the ETTm2 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm2_720_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Weather_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Weather dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_weather_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Weather_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Weather dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_weather_720_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Electricity_powerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Electricity dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_electricity_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Electricity_powerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Electricity dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_electricity_720_powerLaw_attn_full}
\end{figure*}


\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Traffic_powerLaw/Powerformer_scores_sq336_pl96.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Traffic dataset with a forecast and input length of 96 and 336, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_traffic_96_powerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Traffic_powerLaw/Powerformer_scores_sq336_pl720.pdf}
    \caption{We present the \emph{Powerformer} attention score (inset) and weight distributions on the Traffic dataset with a forecast and input length of 720 and 336, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fpl{} results before applying \maskCL, and the solid lines represent WCMHA with \fpl{} results after applying \maskCL.}
    \label{fig:powerformer_traffic_720_powerLaw_attn_full}
\end{figure*}







\subsubsection{Similarity Power-Law Mask}
\label{sm:experiments_powerformer_simPowerLaw}

Table~\ref{tab:powerformer_simPowerLaw_results} presents the aggregate MSE and MAE results for the similarity power-law mask (\fspl) with varying time decays ($\alpha$), forecast lengths, and input sequence lengths.
The 512 input sequence generally outperforms the shorter 336 input length.
Compared to \fpl, there are more instances in which a 336 input sequence length outperforms.
This is likely due to the much faster decay of \fspl{} compared to \fpl.
As expected, the best performing $\alpha$ varies between datasets.
However, there is much less variation as a function of forecast length and input sequence length when compared to \fpl.

We compare all datasets' attention score and weight distributions for weighted causal attention in Figs~\ref{fig:powerformer_etth1_96_simPowerLaw_attn_full}-\ref{fig:powerformer_traffic_720_simPowerLaw_attn_full}.
Due to the faster decay of \fspl{} we observe stronger bimodal distributions for all datasets than for \fpl, with wider \weightCL{} distributions for ETTm1, ETTm2, and Weather.

\begingroup
%\setlength{\tabcolsep}{10pt} % Default value: 6pt
\renewcommand{\arraystretch}{0.62} % Default value: 1

\begin{table*}[!ht]
\centering
    \caption{We compare \emph{Powerformer's} performance with the similarity power-law mask \fspl{} on standard time-series datasets for varying decay lengths. The best results are bolded and the second best are underlined.}
    \label{tab:powerformer_simPowerLaw_results}
    \vskip 0.1in
    \resizebox{0.85\textwidth}{!}{
    \begin{tabular}{c|c|c|cc|cc|cc|cc}
	\toprule
	\multicolumn{3}{c|}{Delay}  & \multicolumn{2}{c|}{0.1} & \multicolumn{2}{c|}{0.5} & \multicolumn{2}{c|}{1} & \multicolumn{2}{c}{2} \\
	\midrule
	\multicolumn{3}{c|}{Metric} & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTh1}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.377} & \textbf{0.401} &  \underline{0.378} & \underline{0.402} &  \underline{0.378} & \underline{0.402} &  0.379 & 0.403 \\
		 & & 192 &  \textbf{0.413} & \textbf{0.421} &  \underline{0.414} & \textbf{0.421} &  0.415 & \underline{0.422} &  0.415 & \underline{0.422} \\
		 & & 336 &  \textbf{0.424} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} \\
		 & & 720 &  \textbf{0.439} & \textbf{0.457} &  \underline{0.440} & \textbf{0.457} &  0.443 & \underline{0.458} &  0.443 & \underline{0.458} \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.370} & \textbf{0.400} &  \underline{0.371} & \textbf{0.400} &  \underline{0.371} & \textbf{0.400} &  \underline{0.371} & \textbf{0.400} \\
		 & & 192 &  \textbf{0.404} & \textbf{0.420} &  \underline{0.405} & \textbf{0.420} &  \underline{0.405} & \underline{0.421} &  \underline{0.405} & \textbf{0.420} \\
		 & & 336 &  0.418 & 0.433 &  \underline{0.417} & \underline{0.429} &  \textbf{0.415} & \textbf{0.428} &  \textbf{0.415} & \textbf{0.428} \\
		 & & 720 &  \textbf{0.439} & \textbf{0.459} &  \underline{0.441} & \underline{0.460} &  0.442 & 0.461 &  0.442 & 0.461 \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTh2}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.274} & \textbf{0.336} &  \underline{0.275} & \textbf{0.336} &  \underline{0.275} & \textbf{0.336} &  \underline{0.275} & \textbf{0.336} \\
		 & & 192 &  \textbf{0.338} & \textbf{0.379} &  \underline{0.340} & \textbf{0.379} &  \textbf{0.338} & \textbf{0.379} &  \textbf{0.338} & \textbf{0.379} \\
		 & & 336 &  \underline{0.330} & \textbf{0.384} &  0.333 & \underline{0.385} &  \textbf{0.329} & \underline{0.385} &  \textbf{0.329} & \underline{0.385} \\
		 & & 720 &  \underline{0.380} & \textbf{0.422} &  0.381 & \textbf{0.422} &  \textbf{0.379} & \textbf{0.422} &  \textbf{0.379} & \textbf{0.422} \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.274} & \textbf{0.337} &  0.276 & \underline{0.338} &  \underline{0.275} & \underline{0.338} &  \underline{0.275} & \underline{0.338} \\
		 & & 192 &  \textbf{0.340} & \textbf{0.381} &  0.342 & \underline{0.382} &  \underline{0.341} & \textbf{0.381} &  \underline{0.341} & \textbf{0.381} \\
		 & & 336 &  0.332 & 0.388 &  0.333 & \underline{0.387} &  \underline{0.331} & \underline{0.387} &  \textbf{0.330} & \textbf{0.386} \\
		 & & 720 &  0.386 & \underline{0.428} &  \underline{0.381} & \textbf{0.424} &  \underline{0.381} & \textbf{0.424} &  \textbf{0.380} & \textbf{0.424} \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTm1}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  0.295 & 0.345 &  \textbf{0.292} & \textbf{0.343} &  \underline{0.293} & \underline{0.344} &  0.294 & 0.345 \\
		 & & 192 &  0.336 & 0.372 &  \textbf{0.329} & \textbf{0.369} &  \underline{0.333} & \underline{0.371} &  0.337 & 0.373 \\
		 & & 336 &  0.363 & \underline{0.392} &  \textbf{0.360} & \textbf{0.390} &  0.363 & 0.393 &  \underline{0.362} & \underline{0.392} \\
		 & & 720 &  \underline{0.413} & \textbf{0.423} &  0.419 & 0.425 &  0.425 & 0.427 &  \textbf{0.412} & \underline{0.424} \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \underline{0.291} & \textbf{0.345} &  \textbf{0.289} & \textbf{0.345} &  0.293 & \underline{0.346} &  \underline{0.291} & \textbf{0.345} \\
		 & & 192 &  \textbf{0.333} & \textbf{0.372} &  \underline{0.334} & \underline{0.374} &  \underline{0.334} & \underline{0.374} &  \textbf{0.333} & \underline{0.374} \\
		 & & 336 &  \textbf{0.362} & \textbf{0.391} &  \underline{0.365} & \textbf{0.391} &  \textbf{0.362} & \underline{0.396} &  \textbf{0.362} & \underline{0.396} \\
		 & & 720 &  \textbf{0.419} & 0.427 &  0.426 & \underline{0.418} &  \underline{0.425} & \underline{0.418} &  \underline{0.425} & \textbf{0.417} \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{ETTm2}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.163} & \textbf{0.253} &  \underline{0.164} & \underline{0.254} &  0.165 & 0.256 &  0.165 & \underline{0.254} \\
		 & & 192 &  \textbf{0.222} & \textbf{0.293} &  \textbf{0.222} & \underline{0.294} &  \underline{0.223} & \underline{0.294} &  \underline{0.223} & \underline{0.294} \\
		 & & 336 &  \textbf{0.277} & \textbf{0.329} &  \underline{0.278} & \underline{0.330} &  0.279 & \underline{0.330} &  \underline{0.278} & \textbf{0.329} \\
		 & & 720 &  0.363 & \underline{0.381} &  \textbf{0.358} & 0.383 &  \textbf{0.358} & \textbf{0.380} &  \underline{0.361} & 0.384 \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.164} & \textbf{0.255} &  \textbf{0.164} & \textbf{0.255} &  \underline{0.165} & \underline{0.256} &  \underline{0.165} & \underline{0.256} \\
		 & & 192 &  \textbf{0.222} & \textbf{0.295} &  \underline{0.223} & \underline{0.296} &  0.224 & \underline{0.296} &  0.224 & \underline{0.296} \\
		 & & 336 &  \textbf{0.274} & \textbf{0.329} &  \underline{0.275} & \textbf{0.329} &  \underline{0.275} & \textbf{0.329} &  \underline{0.275} & \textbf{0.329} \\
		 & & 720 &  \underline{0.354} & \textbf{0.379} &  \underline{0.354} & \underline{0.380} &  \textbf{0.353} & \underline{0.380} &  \textbf{0.353} & \textbf{0.379} \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Weather}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.151} & \textbf{0.199} &  \underline{0.154} & \underline{0.202} &  \underline{0.154} & \underline{0.202} &  0.156 & 0.204 \\
		 & & 192 &  \textbf{0.195} & \underline{0.243} &  \underline{0.197} & \textbf{0.242} &  0.198 & 0.244 &  0.199 & 0.244 \\
		 & & 336 &  \textbf{0.247} & \underline{0.283} &  \underline{0.248} & \textbf{0.282} &  0.249 & \textbf{0.282} &  \underline{0.248} & \underline{0.283} \\
		 & & 720 &  \underline{0.318} & \underline{0.334} &  \textbf{0.317} & \textbf{0.332} &  0.319 & 0.335 &  0.319 & \underline{0.334} \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.149} & \textbf{0.199} &  \underline{0.150} & \underline{0.200} &  0.152 & 0.202 &  0.154 & 0.204 \\
		 & & 192 &  \textbf{0.192} & \textbf{0.240} &  \underline{0.194} & \underline{0.242} &  0.196 & 0.244 &  0.198 & 0.244 \\
		 & & 336 &  \textbf{0.243} & \textbf{0.280} &  \underline{0.244} & \textbf{0.280} &  0.246 & 0.283 &  0.246 & \underline{0.281} \\
		 & & 720 &  \textbf{0.310} & \textbf{0.329} &  \underline{0.311} & \underline{0.330} &  0.312 & 0.331 &  0.313 & 0.331 \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Electricity}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.131} & \textbf{0.224} &  \textbf{0.131} & \underline{0.225} &  \textbf{0.131} & \underline{0.225} &  \textbf{0.131} & \underline{0.225} \\
		 & & 192 &  \underline{0.147} & \textbf{0.240} &  0.148 & \underline{0.242} &  \textbf{0.146} & \textbf{0.240} &  \textbf{0.146} & \textbf{0.240} \\
		 & & 336 &  0.164 & \textbf{0.258} &  \underline{0.163} & \textbf{0.258} &  \textbf{0.162} & \textbf{0.258} &  \underline{0.163} & \textbf{0.258} \\
		 & & 720 &  \textbf{0.201} & \textbf{0.291} &  \underline{0.202} & \underline{0.292} &  \underline{0.202} & 0.293 &  0.204 & 0.295 \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.129} & \textbf{0.224} &  \underline{0.130} & \textbf{0.224} &  \textbf{0.129} & \textbf{0.224} &  \textbf{0.129} & \textbf{0.224} \\
		 & & 192 &  \underline{0.146} & \textbf{0.240} &  0.147 & \underline{0.241} &  \textbf{0.145} & \textbf{0.240} &  \textbf{0.145} & \textbf{0.240} \\
		 & & 336 &  \textbf{0.162} & \textbf{0.257} &  \underline{0.163} & \underline{0.259} &  \underline{0.163} & \underline{0.259} &  \underline{0.163} & \underline{0.259} \\
		 & & 720 &  \textbf{0.198} & \textbf{0.290} &  \underline{0.199} & \underline{0.291} &  0.205 & 0.295 &  0.207 & 0.296 \\
	\midrule
	\multirow{8}{*}{\rotatebox[origin=c]{90}{\text{Traffic}}}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{336}}}
		 & 96 &  \textbf{0.372} & \textbf{0.254} &  \underline{0.374} & 0.256 &  0.375 & \underline{0.255} &  0.376 & \underline{0.255} \\
		 & & 192 &  \textbf{0.390} & \textbf{0.261} &  \underline{0.391} & \underline{0.262} &  \underline{0.391} & \underline{0.262} &  0.392 & \underline{0.262} \\
		 & & 336 &  \textbf{0.402} & \textbf{0.268} &  \underline{0.403} & \underline{0.269} &  \underline{0.403} & \textbf{0.268} &  0.404 & \underline{0.269} \\
		 & & 720 &  \textbf{0.435} & \textbf{0.286} &  \underline{0.436} & \underline{0.287} &  \textbf{0.435} & \underline{0.287} &  \underline{0.436} & \underline{0.287} \\ \cmidrule{2-11}
	& \multirow{4}{*}{\rotatebox[origin=c]{90}{\text{512}}}
		 & 96 &  \textbf{0.368} & \textbf{0.254} &  \underline{0.394} & \underline{0.281} &  \underline{0.394} & \underline{0.281} &  0.395 & 0.282 \\
		 & & 192 &  \textbf{0.383} & \textbf{0.260} &  \underline{0.407} & \underline{0.286} &  \underline{0.407} & \underline{0.286} &  \underline{0.407} & 0.287 \\
		 & & 336 &  \textbf{0.393} & \textbf{0.266} &  \underline{0.395} & \textbf{0.266} &  \underline{0.395} & \textbf{0.266} &  \underline{0.395} & \textbf{0.266} \\
		 & & 720 &  \underline{0.432} & \underline{0.288} &  0.433 & \underline{0.288} &  0.434 & \underline{0.288} &  \textbf{0.431} & \textbf{0.287} \\
	\bottomrule
	\end{tabular}}
\end{table*}
\endgroup



\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh1_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTh1 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_etth1_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh1_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTh1 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_etth1_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh2_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTh2 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_etth2_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTh2_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTh2 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_etth2_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm1_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTm1 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm1_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm1_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTm1 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm1_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm2_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTm2 dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm2_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_ETTm2_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the ETTm2 dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_ettm2_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Weather_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Weather dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_weather_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Weather_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Weather dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_weather_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Electricity_simPowerLaw/Powerformer_scores_sq512_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Electricity dataset with a forecast and input length of 96 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_electricity_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Electricity_simPowerLaw/Powerformer_scores_sq512_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Electricity dataset with a forecast and input length of 720 and 512, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_electricity_720_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Traffic_simPowerLaw/Powerformer_scores_sq336_pl96.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Traffic dataset with a forecast and input length of 96 and 336, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_traffic_96_simPowerLaw_attn_full}
\end{figure*}

\begin{figure*}[!ht]
    \centering
    \includegraphics[width=0.98\textwidth]{figures/Powerformer_Traffic_simPowerLaw/Powerformer_scores_sq336_pl720.pdf}
    \caption{We present \emph{Powerformer's} attention score and weight distributions on the Traffic dataset with a forecast and input length of 720 and 336, respectively. The dotted line represents the reference MHA results, the dashed-dotted line represents WCMHA with \fspl{} results before applying \maskCL, and the solid lines represent WCMHA with \fspl{} results after applying \maskCL.}
    \label{fig:powerformer_traffic_720_simPowerLaw_attn_full}
\end{figure*}








\subsubsection{Butterworth Filter: Order 1}
\label{sm:experiments_powerformer_butter1}

Here we evaluate the Butterworth order 1 mask (\fbwo{}) on the ETT and Weather datasets with a 336 look-back window.
The \fbwo{} decay is not as steep as \fpl{} but has a more gradual decay than \fbwt, as shown in Figs.~\ref{fig:maskBF} and \ref{fig:maskPL}.
This mask offers a middle ground between the step function like \fbwt{} and the faster decaying \fpl.
Table~\ref{tab:powerformer_butter1_results} presents the results for \emph{Powerformer} with WCMHA and \fbwo.
We observe that \fbwo{} underperforms  \fpl, \fspl{} and \fbwt.
The poor performance further supports our hypothesis that the functional form of $f(t)$ is important when imposing a locality bias.


\begin{table*}[h]
    \centering
    \caption{We compare \emph{Powerformer's} performance with WCMHA and the order 1 Butterworth Filter mask \fbwo{} on standard time-series datasets for varying decay lengths. The best results are bolded and second best are underlined.}
    \label{tab:powerformer_butter1_results}
    \vskip 0.1in
    \begin{tabular}{c|c|cc|cc|cc|cc|cc}
	\toprule
	\multicolumn{2}{c|}{Delay}  & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{5} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{15} & \multicolumn{2}{c}{20} \\
	\midrule
	\multicolumn{2}{c|}{Metric} & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE \\
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTh1}}}
         & 96 &  \underline{0.378} & \underline{0.402} &  \textbf{0.377} & \underline{0.402} &  \textbf{0.377} & \underline{0.402} &  \textbf{0.377} & \textbf{0.401} &  \textbf{0.377} & \textbf{0.401} \\
	   & 192 &  \underline{0.415} & \underline{0.422} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} \\
		 & 336 &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \textbf{0.424} & \textbf{0.429} \\
		 & 720 &  0.442 & 0.459 &  \textbf{0.439} & \underline{0.458} &  \textbf{0.439} & \textbf{0.457} &  \underline{0.440} & \underline{0.458} &  \textbf{0.439} & \underline{0.458} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTh2}}}
		 & 96 &  \underline{0.275} & \textbf{0.336} &  \underline{0.275} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} \\
		 & 192 &  \textbf{0.338} & \textbf{0.379} &  \textbf{0.338} & \textbf{0.379} &  \underline{0.339} & \textbf{0.379} &  \underline{0.339} & \textbf{0.379} &  \underline{0.339} & \textbf{0.379} \\
		 & 336 &  \underline{0.331} & \underline{0.386} &  \underline{0.331} & \underline{0.386} &  \underline{0.331} & \textbf{0.385} &  \underline{0.331} & \textbf{0.385} &  \textbf{0.330} & \textbf{0.385} \\
		 & 720 &  \textbf{0.380} & \underline{0.422} &  \textbf{0.380} & \textbf{0.421} &  \underline{0.382} & \underline{0.422} &  \underline{0.382} & 0.424 &  \textbf{0.380} & \underline{0.422} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTm1}}}
		 & 96 &  \textbf{0.291} & \textbf{0.343} &  \underline{0.293} & \textbf{0.343} &  0.296 & \textbf{0.343} &  0.295 & \underline{0.345} &  0.296 & 0.346 \\
		 & 192 &  \textbf{0.329} & \textbf{0.369} &  \underline{0.333} & \underline{0.371} &  0.337 & 0.372 &  0.338 & 0.373 &  0.336 & 0.373 \\
		 & 336 &  \underline{0.360} & \textbf{0.389} &  \textbf{0.359} & \underline{0.390} &  0.369 & 0.396 &  0.363 & 0.393 &  0.365 & 0.393 \\
		 & 720 &  \textbf{0.414} & 0.426 &  0.425 & 0.429 &  0.418 & \underline{0.425} &  0.417 & \textbf{0.424} &  \underline{0.416} & \underline{0.425} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTm2}}}
		 & 96 &  \underline{0.164} & \textbf{0.254} &  \textbf{0.163} & \textbf{0.254} &  0.165 & \underline{0.255} &  0.166 & 0.256 &  0.166 & \underline{0.255} \\
		 & 192 &  \underline{0.223} & \underline{0.294} &  \underline{0.223} & \underline{0.294} &  \textbf{0.222} & \textbf{0.293} &  \textbf{0.222} & \textbf{0.293} &  \textbf{0.222} & \textbf{0.293} \\
		 & 336 &  0.279 & 0.330 &  0.278 & 0.330 &  \textbf{0.275} & \textbf{0.327} &  \underline{0.277} & 0.331 &  \underline{0.277} & \underline{0.329} \\
		 & 720 &  0.358 & \underline{0.381} &  \underline{0.353} & \underline{0.381} &  \textbf{0.351} & \underline{0.381} &  0.359 & \textbf{0.380} &  0.359 & \textbf{0.380} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{Weather}}}
		 & 96 &  0.155 & 0.204 &  0.154 & \underline{0.203} &  \underline{0.153} & \textbf{0.202} &  \underline{0.153} & \underline{0.203} &  \textbf{0.152} & \textbf{0.202} \\
		 & 192 &  0.199 & \textbf{0.244} &  \underline{0.198} & \textbf{0.244} &  \underline{0.198} & \textbf{0.244} &  \underline{0.198} & \underline{0.245} &  \textbf{0.197} & \underline{0.245} \\
		 & 336 &  \underline{0.250} & \underline{0.283} &  \textbf{0.248} & \textbf{0.282} &  \underline{0.250} & 0.284 &  \textbf{0.248} & \underline{0.283} &  \textbf{0.248} & \underline{0.283} \\
		 & 720 &  \underline{0.320} & \underline{0.334} &  \textbf{0.319} & \textbf{0.333} &  0.325 & 0.338 &  0.322 & 0.336 &  \textbf{0.319} & 0.335 \\
        \bottomrule
    \end{tabular}
\end{table*}






\subsubsection{Butterworth Filter: Order 2}
\label{sm:experiments_powerformer_butter2}


Here we evaluate the Butterworth order 2 mask (\fbwt) on the ETT and Weather datasets with a 336 look-back window.
The \fbwt{} decay is analogous to the step function, but has a smooth decay to 0 at the end of the window, as shown in Figs.~\ref{fig:maskBF}.
We use \fbwt{} as an improved step function to avoid the sharp cutoff.
Table~\ref{tab:powerformer_butter2_results} presents the results for \emph{Powerformer} with WCMHA and \fbwt.
We observe that \fbwt{} underperforms \fpl{} and \fspl, but outperforms \fbwo.
The poor performance further supports our hypothesis that the functional form of $f(t)$ is important when imposing a locality bias.

\begin{table*}[!ht]
    \centering
    \caption{We compare \emph{Powerformer's} performance with WCMHA and the Butterworth filter mask \fbwt{} on standard time-series datasets for varying decay lengths. The best results are bolded and second best are underlined.}
    \label{tab:powerformer_butter2_results}
    \vskip 0.1in
    \begin{tabular}{c|c|cc|cc|cc|cc|cc}
	\toprule
	\multicolumn{2}{c|}{Delay}  & \multicolumn{2}{c|}{2} & \multicolumn{2}{c|}{5} & \multicolumn{2}{c|}{10} & \multicolumn{2}{c|}{15} & \multicolumn{2}{c}{20} \\
	\midrule
	\multicolumn{2}{c|}{Metric} & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE & MSE & MAE \\
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTh1}}}
		 & 96 &  \underline{0.378} & \underline{0.402} &  \textbf{0.377} & \underline{0.402} &  \textbf{0.377} & \textbf{0.401} &  \textbf{0.377} & \textbf{0.401} &  \textbf{0.377} & \textbf{0.401} \\
		 & 192 &  \textbf{0.414} & \underline{0.422} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} &  \textbf{0.414} & \textbf{0.421} \\
		 & 336 &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \underline{0.425} & \textbf{0.429} &  \textbf{0.424} & \textbf{0.429} &  \textbf{0.424} & \textbf{0.429} \\
		 & 720 &  \underline{0.442} & 0.459 &  \textbf{0.439} & \textbf{0.457} &  \textbf{0.439} & \textbf{0.457} &  \textbf{0.439} & \underline{0.458} &  \textbf{0.439} & \underline{0.458} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTh2}}}
		 & 96 &  \underline{0.275} & \textbf{0.336} &  \underline{0.275} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} &  \textbf{0.274} & \textbf{0.336} \\
		 & 192 &  \textbf{0.338} & \textbf{0.379} &  \textbf{0.338} & \textbf{0.379} &  \textbf{0.338} & \textbf{0.379} &  \underline{0.339} & \textbf{0.379} &  \underline{0.339} & \textbf{0.379} \\
		 & 336 &  \underline{0.331} & 0.386 &  \underline{0.331} & 0.386 &  \underline{0.331} & \underline{0.385} &  \textbf{0.330} & \underline{0.385} &  \textbf{0.330} & \textbf{0.384} \\
		 & 720 &  \textbf{0.380} & \underline{0.422} &  \textbf{0.380} & \textbf{0.421} &  \underline{0.381} & \textbf{0.421} &  \underline{0.381} & 0.423 &  \textbf{0.380} & \underline{0.422} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTm1}}}
		 & 96 &  \textbf{0.290} & \textbf{0.343} &  \underline{0.293} & \underline{0.344} &  0.295 & 0.345 &  0.295 & 0.346 &  0.297 & \underline{0.344} \\
		 & 192 &  \textbf{0.329} & \textbf{0.370} &  \underline{0.333} & \underline{0.371} &  0.339 & 0.373 &  0.337 & 0.373 &  0.336 & 0.373 \\
		 & 336 &  \textbf{0.361} & \underline{0.391} &  \textbf{0.361} & \underline{0.391} &  \underline{0.362} & 0.393 &  0.365 & 0.395 &  0.363 & \textbf{0.390} \\
		 & 720 &  \textbf{0.413} & 0.425 &  0.422 & 0.428 &  \underline{0.415} & 0.423 &  0.417 & \underline{0.422} &  \textbf{0.413} & \textbf{0.421} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{ETTm2}}}
		 & 96 &  \underline{0.164} & \underline{0.254} &  \underline{0.164} & \underline{0.254} &  0.165 & \textbf{0.253} &  \textbf{0.163} & \textbf{0.253} &  0.165 & 0.255 \\
		 & 192 &  \underline{0.223} & \underline{0.294} &  \underline{0.223} & \underline{0.294} &  \textbf{0.222} & \textbf{0.293} &  \textbf{0.222} & \textbf{0.293} &  \textbf{0.222} & \textbf{0.293} \\
		 & 336 &  0.279 & \underline{0.330} &  0.278 & \underline{0.330} &  \textbf{0.276} & 0.331 &  \textbf{0.276} & \textbf{0.329} &  \underline{0.277} & \textbf{0.329} \\
		 & 720 &  0.358 & \underline{0.381} &  \underline{0.354} & \underline{0.381} &  \textbf{0.353} & 0.382 &  0.359 & \textbf{0.380} &  0.360 & \textbf{0.380} \\ 
	\midrule
	\multirow{4}{*}{\rotatebox[origin=c]{90}{\text{Weather}}}
		 & 96 &  0.156 & 0.204 &  0.154 & \underline{0.203} &  0.154 & \underline{0.203} &  \underline{0.153} & \textbf{0.202} &  \textbf{0.152} & \underline{0.203} \\
		 & 192 &  0.199 & \textbf{0.244} &  0.198 & \textbf{0.244} &  0.198 & \textbf{0.244} &  \underline{0.197} & \textbf{0.244} &  \textbf{0.196} & \textbf{0.244} \\
		 & 336 &  0.250 & \underline{0.283} &  \textbf{0.248} & \textbf{0.282} &  \underline{0.249} & 0.284 &  \textbf{0.248} & \underline{0.283} &  \textbf{0.248} & 0.284 \\
		 & 720 &  0.320 & \textbf{0.334} &  \textbf{0.318} & \textbf{0.334} &  0.326 & 0.339 &  0.321 & 0.336 &  \underline{0.319} & \underline{0.335} \\ 
	\bottomrule
	\end{tabular}
\end{table*}






