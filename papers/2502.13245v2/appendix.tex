\clearpage
\appendix

\section{Additional Data}~\label{apdx}

We provide data on early stopping metrics for four additional datasets in Figures~\ref{fig:bigann_earlystop}, \ref{fig:deep_earlystop}, \ref{fig:wikipedia_earlystop}, and~\ref{fig:ssnpp_earlystop}.

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/dist_histograms/visited/bigann_test_legend.pdf} \\
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited/Step20/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1/Step20/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10/Step20/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio/Step20/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited_filtered/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1_filtered/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10_filtered/bigann-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio_filtered/bigann-1M.pdf}
	\end{subfigure}
	\caption{Early stopping metrics for BIGANN-1M, taken at step 20 of a beam search with beam 100. The top row shows all results, while the bottom row shows only results for beam searches that have not yet found a candidate within the radius.}
	\label{fig:bigann_earlystop}
\end{figure*}

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/dist_histograms/visited/bigann_test_legend.pdf} \\
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited/Step20/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1/Step20/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10/Step20/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio/Step20/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited_filtered/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1_filtered/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10_filtered/deep-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio_filtered/deep-1M.pdf}
	\end{subfigure}
	\caption{Early stopping metrics for DEEP-1M, taken at step 20 of a beam search with beam 100. The top row shows all results, while the bottom row shows only results for beam searches that have not yet found a candidate within the radius.}
	\label{fig:deep_earlystop}
\end{figure*}

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/dist_histograms/visited/bigann_test_legend.pdf} \\
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited/Step20/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1/Step20/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10/Step20/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio/Step20/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited_filtered/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1_filtered/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10_filtered/wikipedia-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio_filtered/wikipedia-1M.pdf}
	\end{subfigure}
	\caption{Early stopping metrics for Wikipedia-1M, taken at step 20 of a beam search with beam 100. The top row shows all results, while the bottom row shows only results for beam searches that have not yet found a candidate within the radius.}
	\label{fig:wikipedia_earlystop}
\end{figure*}

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/dist_histograms/visited/bigann_test_legend.pdf} \\
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited/Step20/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1/Step20/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10/Step20/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio/Step20/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/visited_filtered/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top1_filtered/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/top10_filtered/ssnpp-1M.pdf}
	\end{subfigure}
	\begin{subfigure}{.24\textwidth}
		\includegraphics[scale=.23]{figures/dist_histograms/ratio_filtered/ssnpp-1M.pdf}
	\end{subfigure}
	\caption{Early stopping metrics for SSNPP-1M, taken at step 20 of a beam search with beam 100. The top row shows all results, while the bottom row shows only results for beam searches that have not yet found a candidate within the radius.}
	\label{fig:ssnpp_earlystop}
\end{figure*}

In Figure~\ref{fig:ppgraphearlystoppinggreedy} and Figure~\ref{fig:ppgraphearlystoppingdoubling}, we examine the impact of early stopping on each dataset at the 1 million scale, measuring improvement over both greedy search and doubling search.

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/legends/nine_datasets_legend.pdf}
	\includegraphics[scale=.35]{figures/legends/greedy_legend.pdf} \\
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/BIGANN-1M_greedy_ap.pdf}
		\caption{BIGANN-1M}\label{fig:bigannpp_greedy}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/DEEP-1M_greedy_ap.pdf}
		\caption{DEEP-1M}\label{fig:deeppp_greedy}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/MSTuring-1M_greedy_ap.pdf}
		\caption{MSTuring-1M}\label{fig:msturingpp_greedy}
	\end{subfigure}\hfil
	\begin{subfigure}{.3\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/GIST-1M_greedy_ap.pdf}
		\caption{GIST-1M}\label{fig:gistpp_greedy}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/SSNPP-1M_greedy_ap.pdf}
		\caption{SSNPP-1M}\label{fig:ssnpppp_greedy}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/OpenAI-1M_greedy_ap.pdf}
		\caption{OpenAI-1M}\label{fig:openaipp_greedy}
	\end{subfigure}\hfil
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/Text2Image-1M_greedy_ap.pdf}
		\caption{Text2Image-1M}\label{fig:t2ipp_greedy}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/Wikipedia-1M_greedy_ap.pdf}
		\caption{Wikipedia-1M}\label{fig:wikipp_greedy}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/greedy_earlystopping/MSMARCO-1M_greedy_ap.pdf}
		\caption{MSMARCO-1M}\label{fig:msmarcopp_greedy}
	\end{subfigure}
	\caption{Average precision vs QPS for all nine datasets using greedy search, comparing use of early stopping versus without early stopping.}
	\label{fig:ppgraphearlystoppinggreedy}
\end{figure*}

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/legends/nine_datasets_legend.pdf}
	\includegraphics[scale=.35]{figures/legends/doubling_legend.pdf} \\
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/BIGANN-1M_doubling_ap.pdf}
		\caption{BIGANN-1M}\label{fig:bigannap_doubling}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/DEEP-1M_doubling_ap.pdf}
		\caption{DEEP-1M}\label{fig:deepap_doubling}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/MSTuring-1M_doubling_ap.pdf}
		\caption{MSTuring-1M}\label{fig:msturingap_doubling}
	\end{subfigure}\hfil
	\begin{subfigure}{.3\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/GIST-1M_doubling_ap.pdf}
		\caption{GIST-1M}\label{fig:gistap_doubling}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/SSNPP-1M_doubling_ap.pdf}
		\caption{SSNPP-1M}\label{fig:ssnppap_doubling}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/OpenAI-1M_doubling_ap.pdf}
		\caption{OpenAI-1M}\label{fig:openaiap_doubling}
	\end{subfigure}\hfil
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/Text2Image-1M_doubling_ap.pdf}
		\caption{Text2Image-1M}\label{fig:t2iap_doubling}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/Wikipedia-1M_doubling_ap.pdf}
		\caption{Wikipedia-1M}\label{fig:wikiap_doubling}
	\end{subfigure}
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/doubling_earlystopping/MSMARCO-1M_doubling_ap.pdf}
		\caption{MSMARCO-1M}\label{fig:msmarcoap_doubling}
	\end{subfigure}
	\caption{Average precision vs QPS for all nine datasets using doubling search, comparing use of early stopping versus without early stopping.}
	\label{fig:ppgraphearlystoppingdoubling}
\end{figure*}


In Figure~\ref{fig:wikipediasizescaling} we present further study on size scaling using the Wikipedia dataset at the 1M and 10M scale.

\begin{figure*}
	\centering
	\includegraphics[scale=.35]{figures/legends/threealg_twocol_legend.pdf} \\
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/qps_recall/Wikipedia-1M_ap.pdf}
		\caption{Wikipedia-1M}\label{fig:wikipedia1MAP}
	\end{subfigure} 
	\begin{subfigure}{.33\textwidth}
		\includegraphics[scale=.33]{figures/qps_recall/Wikipedia-10M_ap.pdf}
		\caption{Wikipedia-10M}\label{fig:wikipedia10Map}
	\end{subfigure}
	\caption{Average precision vs QPS for Wikipedia-1M and 10M, from left to right.}
	\label{fig:wikipediasizescaling}
\end{figure*}





