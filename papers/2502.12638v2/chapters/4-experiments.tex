\vspace{-1mm}
\section{Experiment}\label{sec:exp}
\vspace{-1mm}
In this section, we evaluate NExT-Mol's performance on \textit{de novo} 3D molecule generation and conditional 3D molecule generation. Further, we report results of 3D conformer prediction, the critical second step in our two-step generation process. Finally, we present ablation studies to demonstrate the effectiveness of each component of NExT-Mol.

\subsection{Experimental Settings}
\begin{wraptable}[6]{r}[-3pt]{.5\textwidth}
\small
\centering
\vspace{-5mm}
\caption{Datasets for each task.}\label{tab:dataset}
\vspace{-2mm}
\setlength{\tabcolsep}{3pt}
\resizebox{0.5\textwidth}{!}{
\begin{tabular}{ll} \toprule
\textbf{Task}          & \textbf{Dataset}     \\\midrule
\textit{De novo} 3D Mol Gen     & GEOM-DRUGS, QM9-2014   \\
Conditional 3D Mol Gen & QM9-2014               \\
3D Conformer Pred      & GEOM-DRUGS, GEOM-QM9 \\
\bottomrule
\end{tabular}}
\end{wraptable}
\textbf{Datasets.} As Table~\ref{tab:dataset} shows, we evaluate on the popular GEOM-DRUGS~\citep{GEOM}, GEOM-QM9~\citep{GEOM}, and QM9-2014~\citep{QM9} datasets. Among them, we focus on GEOM-DRUGS, which is the most pharmaceutically relevant and largest one.
% Note that, GEOM-QM9 and QM9-2014 are different datasets due to their distinct 3D conformers. 
Due to different tasks incorporating different dataset splits, we separately fine-tune NExT-Mol for each task without sharing weights.

% For dataset split and other settings, we follow~\citep{EDM, JODO} for the \textit{de novo} and conditional 3D molecule genration, and follow~\citep{torsion, MCF} for the 3D conformer prediction task.

\begin{table}[t]
    \small
    \centering
    \caption{Performances for \textit{de novo} 3D molecule generation. * denotes our reproduced results using their source codes. Other
 baseline results are borrowed from~\citep{JODO}.
 2D-Metric evaluates the directly predicted 2D molecular graphs, whereas the 3D-Metric evaluates the predicted 3D coordinates or the 2D molecular graphs reconstructed from the 3D coordinates.}\label{tab:denovo}
    \begin{subtable}[t]{\textwidth}
        \centering
        \small
        \setlength{\tabcolsep}{3.5pt}
        \vspace{-2mm}
        \caption{Performances on the GEOM-DRUGS dataset.}
        \vspace{-1mm}
        \input{tables/3-a-3D-Molecule-Generation-DRUGS.tex}
    \end{subtable}
    \begin{subtable}[t]{\textwidth}
        \centering
        \small
        % \vspace{mm}
        \caption{Performances on the QM9-2014 dataset.}
        \vspace{-1mm}
        \setlength{\tabcolsep}{3pt}
        \input{tables/3-b-3D-Molecule-Generation-QM9.tex}
    \end{subtable}
    \vspace{-3mm}
\end{table}


\begin{table}[t]
    \centering
    \small
    \caption{Performance of conditional 3D molecule generation on the QM9-2014 dataset. We report MAE $\downarrow$ between the desired properties and the predicted properties of the generated samples. Baseline results are from \citep{JODO}. We \textbf{bold} the best performance.}
    \label{tab:conditional}
    \vspace{-3mm}
    \setlength{\tabcolsep}{4pt}
    \input{tables/4-Conditional-3D-Molecule-Generation.tex}
    \vspace{-3mm}
\end{table}

\begin{table}[t]
    \small
    \centering
    \caption{3D conformer prediction results. Baseline results are from \citep{torsion,ParticleGuidance,MCF}. * denotes reproduction using their codes. -R$\leftarrow$Recall and -P$\leftarrow$Precision.}\label{tab:conformer}
    \begin{subtable}[t]{\textwidth}
        \small
        \centering
        \vspace{-2mm}
        \caption{Performances on the GEOM-DRUGS dataset. TD \textit{w/} PG denotes torsional diffusion with particle guidance.}
        \vspace{-1mm}
        \setlength{\tabcolsep}{4pt}
        \input{tables/1-a-3D-Conformer-Prediction-DRUGS.tex}
        \vspace{0mm}
    \end{subtable}
    \begin{subtable}[t]{\textwidth}
        \centering
        \small
        \caption{Performances on the GEOM-QM9 dataset.}
        \vspace{-2mm}
        \setlength{\tabcolsep}{4pt}
        \input{tables/1-b-3D-Conformer-Prediction-QM9.tex}
    \end{subtable}
    \vspace{-3mm}
\end{table}

\textbf{Baselines.} For \textit{de novo} and conditional 3D molecule genration, we use baselines of CDGS~\citep{CDGS}, JODO~\citep{JODO}, MiDi~\citep{MiDi}, G-SchNet~\citep{GSchNet}, G-SphereNet~\citep{GSphereNet}, 
% E-NF~\citep{ENF}, 
EDM~\citep{EDM}, MDM~\citep{MDM}, GeoLDM~\citep{GeoLDM}, EEGSDE~\citep{EEGSDE}, EQGAT-diff~\citep{EQGATDiff}, MolGPT~\citep{MolGPT}, and MolGen~\citep{MolGen}. For 3D conformer prediction, we use baselines of 
% RDKit~\citep{rdkit}, 
OMEGA~\citep{OMEGA}, GeoMol~\citep{GeoMol}, GeoDiff~\citep{GeoDiff}, Torsional Diffusion~\citep{torsion}, Particle Guidance~\citep{ParticleGuidance}, and MCF~\citep{MCF}. More details on experimental settings are in Appendix~\ref{app:expdetail}.

\textbf{NExT-Mol.} Throughout the section, NExT-Mol fine-tunes the pretrained 960M MoLlama for 1D molecule generation. We have trained two versions of DMT: DMT-B of 55 million parameters and DMT-L of 150 million. For the \textit{de novo} and conditional 3D generation molecule tasks (\cf Section~\ref{sec:denovo} and Section~\ref{sec:cond}), NExT-Mol uses DMT-B. DMT uses 100 sampling steps by default.

\vspace{-1mm}
\subsection{\textit{De Novo} 3D Molecule Generation}\label{sec:denovo}
\vspace{-1mm}
\textbf{Experimental Setting.} Generating a complete 3D molecule involves generating the 2D molecular graph and the corresponding 3D conformer. Therefore, we evaluate both the predicted 2D molecular graphs (\ie 2D-Metric), and the predicted 3D coordinates (\ie 3D-Metric), following~\citep{EDM,JODO}. 2D-Metrics can be roughly grouped into three types: (1) stability and validity: atom stability, molecule stability, and validity \& completeness (V\&C); (2) diversity: validity \& uniqueness (V\&U), and validity \& uniqueness \& novelty (V\&U\&N); and (3) distribution similarity between the generated molecules and the test set: similarity to nearest neighbor (SNN), fragment similarity (Frag), scaffold similarity (Scaf), and Fr√©chet ChemNet Distance (FCD)~\citep{moses}. For 3D-Metrics, we follow~\citep{EDM} to evaluate the predicted 3D molecules by assessing atom stability, and FCD of the 2D molecular graphs reconstructed from predicted 3D coordinates. Additionally, 3D-Metrics includes the maximum mean discrepancy (MMD)~\citep{gretton2012kernel} for bond lengths, bond angles, and dihedral angles to evaluate geometric similarity to the test set. Training set performance is also reported for reference. The experimental results are presented in Table~\ref{tab:denovo}. We can observe that:

\textbf{Obs. 1: NExT-Mol Demonstrates Leading Performances for 3D Molecule Generation.} It achieves the best performance across all metrics on GEOM-DRUGS, and achieves the best performance in 13 out of 14 metrics on QM9-2014. Although CDGS shows a higher novelty score on QM9-2014, it significantly underperforms NExT-Mol for other metrics. This observation shows that NExT-Mol is highly effective at generating chemically valid and diverse 3D molecular structures. Its strong performance on both large (\ie GEOM-DRUGS) and small (\ie QM9-2014) molecules highlights its robustness and potential as a foundation model for various tasks.


\textbf{Obs. 2: NExT-Mol is Powerful in Capturing 1D/2D Molecular Characteristics}, including SNN, Frag, Scaf, and FCD. Notably, it improves the FCD from 0.655 to 0.334 on GEOM-DRUGS, acheving a 49\% relative improvement. This good performance is attributed to MoLlama's extensive pretraining,
% and the 100\% valid SELFIES representations
which lays a strong foundation for the subsequent 3D conformer prediction.

% For the 3D geometry, NExT-Mol also demonstrates the lowest FCD and closest alignment of substructure geometries compared to the training data.

\begin{table}[t]
    \centering
    \small
    % \vspace{-1mm}
    \caption{Incorporating MoLlama's 1D representations to improve DMT's 3D conformer prediction.}
    \vspace{-3mm}
    \label{tab:1d_improve_3d}
    \setlength{\tabcolsep}{4pt}
    \input{tables/2-1D-Improve-3D.tex}
    \vspace{-4mm}
\end{table}


\begin{table}[t]
\centering
\begin{minipage}[t!]{0.5\textwidth}
\small
\centering
% \vspace{-4mm}
\caption{3D conformer prediction performance on GEOM-DRUGS's test subsets, split by scaffold frequency in the training set. 68 low-quality samples are filtered following~\citep{torsion}.
}\label{tab:scaffold}
\vspace{-2mm}
\setlength{\tabcolsep}{3pt}
\begin{tabular}{lc|lccc} \toprule
Test subset                                                 & \#Mol                & Method   & AMR-R               & AMR-P               \\\midrule
\multirow{2}{*}{unseen scaffold}                      & \multirow{2}{*}{348} & DMT-B    & 0.450              & 0.785              \\
&                      & +MoLlama & \textbf{0.422}     & \textbf{0.755}     \\\midrule
\multirow{2}{*}{scaf. freq. $\geq$1}  & \multirow{2}{*}{584} & DMT-B    & 0.364              & 0.549              \\
&                      & +MoLlama & \textbf{0.359}     & \textbf{0.548}     \\\midrule
\multirow{2}{*}{scaf. freq. $\geq$10} & \multirow{2}{*}{285} & DMT-B    & 0.348              & 0.515              \\
&                      & +MoLlama & \textbf{0.347}     & \textbf{0.513}     \\ \bottomrule
\end{tabular}
\end{minipage}
\hfill
\begin{minipage}[t!]{0.45\textwidth}
\centering
\renewcommand{\arraystretch}{0} % General space between rows (1 standard)
\setlength{\tabcolsep}{-8pt}
\begin{tabular}{ccc}
\begin{subfigure}[t]{1.0\linewidth}
\centering
\includegraphics[trim={0cm 2.8cm 0cm 1.8cm},clip,width=0.33\linewidth]{figures/vis/522_gt_3.png}\hfill
\includegraphics[trim={0cm 2.8cm 0cm 1.8cm},clip,width=0.33\linewidth]{figures/vis/522_dmt.png}\hfill
\includegraphics[trim={0cm 2.8cm 0cm 1.8cm},clip,width=0.33\linewidth]{figures/vis/522_dmt_llama.png}
\caption{Case 1. L to R: GT, DMT, DMT+MoLlama.}
\vspace{-1mm}
\end{subfigure}\\
\begin{subfigure}[t]{1.0\linewidth}
\centering
\includegraphics[trim={0cm 2.8cm 0cm 1.8cm},clip,width=0.3\linewidth]{figures/vis/996_gt_1.png}\hfill
\includegraphics[trim={0cm 2.8cm 0cm 1.5cm},clip,width=0.3\linewidth]{figures/vis/996_dmt.png}\hfill
\includegraphics[trim={0cm 2.8cm 0cm 1.8cm},clip,width=0.3\linewidth]{figures/vis/996_dmt_llama.png}
\caption{Case 2. L to R: GT, DMT, DMT+MoLlama.}
\end{subfigure}
\end{tabular}
% \vspace{-3mm}
\captionof{figure}{Visualization of 3D conformers. We select the predicted conformers with the least RMSD to the ground truth (GT).}
\label{fig:scaffold}
\end{minipage}
\vspace{-4mm}
\end{table}

% \begin{figure*}[t]
%     \begin{minipage}[t]{0.60\textwidth}
%         \small
%         \centering
%         \captionof{table}{\revision{3D conformer prediction performance on GEOM-DRUGS's test subsets, splitted by scaffold frequency in the training set. 68 low-quality samples are filtered following~\citep{torsion}.
%         }\label{tab:scaffold}}
%         \revision{
%         \setlength{\tabcolsep}{3pt}
%         \begin{tabular}{lc|lccc} \toprule
%         Test subset                                                 & \#Mol                & Method   & AMR-R               & AMR-P               \\\midrule
%         \multirow{2}{*}{unseen scaffold}                      & \multirow{2}{*}{348} & DMT-B    & 0.450              & 0.785              \\
%         &                      & +MoLlama & \textbf{0.422}     & \textbf{0.755}     \\\midrule
%         \multirow{2}{*}{scaf. freq. $\geq$1}  & \multirow{2}{*}{584} & DMT-B    & 0.364              & 0.549              \\
%         &                      & +MoLlama & \textbf{0.359}     & \textbf{0.548}     \\\midrule
%         \multirow{2}{*}{scaf. freq. $\geq$10} & \multirow{2}{*}{285} & DMT-B    & 0.348              & 0.515              \\
%         &                      & +MoLlama & \textbf{0.347}     & \textbf{0.513}     \\ \bottomrule
%         \end{tabular}}
%     \end{minipage}
%     \hfill
%     \begin{minipage}[t]{0.35\textwidth}
%     \centering
%     \begin{figure}[H]
%         \centering
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_DMT.png}
%             \caption{\revision{DMT-B RMSD=0.9051}}
%         \end{subfigure}
%         \hfill
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_DMT.png}
%             \caption{\revision{DMT-B RMSD=0.9051}}
%         \end{subfigure}
        
%         \vspace{2mm}
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_DMT+MoLlama.png}
%             \caption{\revision{+MoLlama RMSD=0.0539}}
%         \end{subfigure}
%         \hfill
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_DMT+MoLlama.png}
%             \caption{\revision{+MoLlama RMSD=0.0539}}
%         \end{subfigure}

%         \vspace{2mm}
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_gt.png}
%             \caption{\revision{Ground truth}}
%         \end{subfigure}
%         \hfill
%         \begin{subfigure}[b]{0.45\textwidth}
%             \centering
%             \includegraphics[width=0.5\textwidth, trim={0.1\textwidth} {0.1\textwidth} {0.1\textwidth} {0.1\textwidth},clip]{figures/scaffold/499_gt.png}
%             \caption{\revision{Ground truth}}
%         \end{subfigure}
%         \caption{\revision{caption}}
%         \label{fig:scaffold}
%     \end{figure}
%     \end{minipage}
% \end{figure*}




\begin{table}[t]
\centering
\small
\caption{Enhancing 3D molecule generation with MoLlama representations on GEOM-DRUGS.}\label{tab:mollama_3dgen}
\vspace{-2mm}
\setlength{\tabcolsep}{3.5pt}
\begin{tabular}{llcccccccc}
\toprule
Method & 3D Pred. & FCD $\downarrow$ & AtomStable  & \multicolumn{2}{c}{Bond   length$\downarrow$} & \multicolumn{2}{c}{Bond angle$\downarrow$} & \multicolumn{2}{c}{Dihedral   angle$\downarrow$} \\ \midrule
\multirow{2}{*}{NExT-Mol} & DMT-B     & 14.69 & 0.848                      & \multicolumn{2}{c}{2.05E-02}                  & \multicolumn{2}{c}{8.18E-03}               & \multicolumn{2}{c}{2.31E-04}                     \\
& +MoLLama  & \textbf{14.32} & \textbf{0.852}    & \multicolumn{2}{c}{\textbf{1.48E-02}}         & \multicolumn{2}{c}{\textbf{8.08E-03}}      & \multicolumn{2}{c}{\textbf{1.81E-04}}           \\ \bottomrule
\end{tabular}
\vspace{-2mm}
\end{table}



\begin{table}[h!]
\centering
\small
\vspace{-1mm}
\caption{Ablating randomized SELFIES augmentations for 1D molecule generation on QM9-2014.}\label{tab:random_selfies}
\vspace{-3mm}
\setlength{\tabcolsep}{3pt}
\begin{tabular}{lccccccccc} \toprule
2D metrics                      & FCD$\downarrow$ & AtomStable     & MolStable      & V\&C           & V\&U           & V\&U\&N        & SNN            & Frag           & Scaf            \\\midrule
MoLlama                         & \textbf{0.070} & \textbf{1.000} & \textbf{0.989} & \textbf{1.000} & \textbf{0.967} & \textbf{0.802} & \textbf{0.530} & \textbf{0.992} & \textbf{0.945}   \\
\textit{w/o} randomized aug. & 0.074 & \textbf{1.000} & 0.988          & \textbf{1.000} & 0.948          & 0.395          & 0.491          & 0.989          & 0.939                    \\\bottomrule
\end{tabular}
\vspace{-4mm}
\end{table}


\subsection{Conditional 3D Molecule Generation with Quantum Chemical Properties}\label{sec:cond}
\textbf{Adatping NExT-Mol for Conditional Generation.} We employ NExT-Mol for conditional 3D molecule generation targeting quantum chemistry properties. To adapt NExT-Mol to incorporate numerical conditions, the desired property values are encoded into vector embeddings using MLPs. These embeddings are prepended to the SELFIES sequences during MoLlama fine-tuning, serving as a soft-prompt to condition its output~\citep{PrefixTuning}, and are also fed into the DMT through the condition MLP module (\cf Figure~\ref{fig:dmt}). See Appendix~\ref{app:condition} for details of this methodology.

\textbf{Remark.} Quantum chemical properties (\eg HOMO-LUMO gap) often vary across a molecule's different 3D conformers. As a result, the 1D molecules generated by MoLlama alone cannot achieve errors lower than the average across a molecule's different conformers. To address this, we condition DMT on the desired property value when predicting the 3D conformer, enabling DMT to find the conformer that best matches the target property.
% ÂèØ‰ª•ËÅä‰∏ÄËÅä MoLlama capture mean error ÁöÑËÉΩÂäõ„ÄÇÈÄöËøáÂºïÁî®‰∏Ä‰∫õpredictive chemistry ÁöÑËÆ∫Êñá

\textbf{Experimental Settings.} Following~\citep{EDM,JODO}, we focus on six properties of heat capacity $C_v$, dipole moment $\mu$, polarizability $\alpha$, highest occupied molecular orbital energy $\epsilon_{\text{HOMO}}$, lowest unoccupied molecular orbital energy $\epsilon_{\text{LUMO}}$, and HOMO-LUMO gap $\Delta \epsilon$. For evaluation, we report the mean absolute error (MAE) between the desired property values and the predicted values of the generated molecules, using a property classifier network $\phi_c$~\citep{EDM}. QM9-2014's training set is split into two halves: $D_a$ and $D_b$, each containing 50k molecules. $\phi_c$ is trained on $D_a$ and NExT-Mol is trained on $D_b$. We report $\phi_c$'s performance on $D_b$ as the performance's lower-bound (L-Bound). Table~\ref{tab:conditional} shows the results.

\textbf{Obs. 3: NExT-Mol Outperforms Baselines for Conditional 3D Molecule Generation.} NExT-Mol's improvements are consistent and significant, with an average relative gain of 13\% on MAE, demonstrating its ability to effectively capture quantum chemical properties. This good performance is partially attributed to DMT, which finds the 3D conformer that best aligns the desired property.

% \textbf{Discussion.} NExT-Mol uses MoLlama, a language model, for conditional design targeting quantum chemical properties. This may be controversial because some quantum properties (\eg HOMO-LUMO gap) depend on the 3D conformer. Therefore, a method that does not explicitly incorporate 3D conformer information cannot achieve errors smaller than the mean error of a molecule's different conformers. Our stands here are two-fold: (1) After MoLlama, NExT-Mol leverages DMT to predict the generated molecule sequence's 3D conformer, conditioned on the desired property value. Therefore, DMT can potentially find the conformer that minimizes the error smaller than the mean error.

\subsection{3D Molecular Conformer Prediction}
\vspace{-2mm}
\textbf{Experimental Setting.} Our setting follows \citep{torsion}. Evaluation metrics include Average Minimum RMSD (AMR), which measures the distance between a predicted conformer and a ground truth, and Coverage (COV), which measures the proportion of predicted conformers that are sufficiently close to a ground truth. Due to a 2D molecule can have multiple ground truth and predicted conformers, we report both precision (comparing a prediction to its most similar ground truth) and recall (comparing a ground truth to its most similar prediction) for AMR and Coverage. For DMT-B, we report performance with the predictor-corrector sampler (PC samp.; \cite{score-sde}), comparing with the particle guidance sampler (TD w/ PG).

% Base on the evaluation results, we analyze the performance of our proposed DMT models on the 3D molecular conformer prediction task, investigate the impact of 1D representation learning on improving the 3D conformer prediction performance, and have the following observations:

\textbf{Obs. 4: DMT Demonstrates Leading Performance for 3D Conformer Prediction.} Table~\ref{tab:conformer} compares DMT and baselines for 3D conformer prediction. We can observe that DMT-B outperforms MCF-B, and DMT-L surpasses MCF-L, even though DMT-L is only 60\% of the size of MCF-L. This improvement demonstrates that DMT can better utilize 2D molecular graph structures than MCF.
% , leading to better performance with fewer parameters.
Further, DMT-L improves upon DMT-B, demonstrating DMT's scalability. Both the improvements above are attributed to DMT's meticulously designed architecture, combining the power of scalability while effectively leveraging the full information of 2D molecular graphs.

% The results on the GEOM-QM9 dataset, which contains smaller molecules, show even stronger performance from all models
% Once again, our DMT models, both the smaller DMT-B and the larger DMT-L, surpass the baselines across the board in recall and precision metrics
% This indicates the DMT architecture is highly effective at predicting accurate 3D conformers for molecular structures of varying sizes.

\textbf{Obs. 5: MoLlama's 1D Representation Improves DMT's 3D Conformer Prediction.} As Table~\ref{tab:1d_improve_3d} shows, MoLlama enhances DMT on GEOM-DRUGS. Table~\ref{tab:app_integrate} shows integrating MoLlama into DMT also improves performance on GEOM-QM9.
This observation demonstrates the potential to leverage the abundant 1D molecule sequences to improve 3D generation and design tasks, mitigating their data scarcity issue. Further, this observation highlights MoLlama's value to generate expressive molecule representations for 3D tasks, beyond its 1D molecule generation ability. Although MoLlama is pretrained only on 1D molecules, we hypothesize that large-scale pretraining helps it develop chemical heuristics useful for 3D prediction.

% therefore~\citep{jablonka2024leveraging}
\subsection{Analysis and Ablation Studies}
\vspace{-1mm}
\textbf{MoLlama's 1D Representation Improves 3D Prediction for Unseen Scaffolds.} Scaffold split is widely used to evaluate a molecular model's generalization ability to unseen structures~\citep{pretrain_gnn}. We divide GEOM-DRUGS's test set into subsets based on the test molecule's scaffold frequency in the training set. As Table~\ref{tab:scaffold} shows, DMT-B's performance drops significantly for molecules with unseen scaffolds: AMR-R and AMR-P increase by 0.086 and 0.236, respectively, compared to molecules with scaffold frequency $\geq 1$. However, incorporating MoLlama mitigates this issue, reducing AMR-R and AMR-P by 0.028 and 0.030, respectively. This improvement stems 
from MoLlama's exposure to diverse scaffolds during pretraining on a large molecular dataset, enabling better generalization for transfer learning. Figure~\ref{fig:scaffold} highlights cases where MoLlama significantly enhances conformer prediction, particularly by improving torsion angle predictions.



\textbf{Enhancing 3D Molecule Generation with MoLlama Representations.} NExT-Mol uses DMT-B without MoLlama for conformer prediction by default for \textit{de novo} 3D molecule generation. Here we show that enhancing DMT-B with MoLlama further improves its performance on 3D-metrics. Table~\ref{tab:mollama_3dgen} shows significant gains in geometric measures (\ie bond lengths, angles, and dihedral angles), highlighting MoLlama's ability to enhance DMT's 3D geometry prediction.


\textbf{Random SELFIES Augmentation.} As Table~\ref{tab:random_selfies} shows, using randomized SELFIES augmentation significantly improves the novelty (\ie V\&U\&N) of the generated samples. It also improves other metrics, like SNN and FCD, highlighting its importance for 1D molecule generation.



