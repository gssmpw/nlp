\begin{algorithmic}

    \State $\mathcal{R} \gets \emptyset$
    \For{$P \gets P_{a,b} \in \longset{P_{a,b}}{a, b \in S, a \neq b} $}
        \For{$R \in \mathcal{R}$}
            \If{$R$ and $P$ have more than two crossing vertices}
            \State $c_1, c_2 \dots c_q$ \Comment{Crossing vertices of $P$ and $R$}
            \State $P' \gets P[a \dots c_1] + R[c_1 \dots c_q] + P[c_q \dots b]$
            \State $P \gets P'$
            \EndIf
        \EndFor
        \State $\mathcal{R} \gets \mathcal{R} \cup \set{P}$
    \EndFor
\end{algorithmic}