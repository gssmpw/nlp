\section{Upper bound}\label{sec:upperbound}
In this section we prove
\cref{lem:marginbound}, which is used in a
union bound over suitable $ \gamma_{0},\gamma_{1} $ and $ \tau_{0} $
and $ \tau_{1},$ giving the margin bound in~\cref{thm:mainintro} for all $ f\in\dlh $ and margins $ 0<\gamma\leq1.$
 \begin{lemma}\label{lem:marginbound}
    For a hypothesis class $ \cH \subseteq \{  -1,1\}^{\cX} $, margin thresholds  $ 0<\gamma_{0}\leq \gamma_{1}\leq 1 $, error thresholds $ 0\leq\tau_{0}\leq \tau_{1} $, failure parameter $0<\delta<1 $, we have that
    \begin{align*}
        &\p_{\rS\sim\cD^{m}}\negmedspace\left[
        \exists \gamma \negmedspace\in\negmedspace \left[\gamma_{0},\gamma_{1}\right]
        ,\exists f\negmedspace\in\negmedspace \dlh\negmedspace: 
        \ls_{\rS}^{\gamma}(f)\negmedspace\in \negmedspace[\tau_{0},\tau_{1}] 
        ,\ls_{\cD}(f) \geq \tau_{1} 
        + \cc\left(\negmedspace\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
        +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\negmedspace\right)
        \negmedspace\right] 
        \\
        &\leq\delta \cdot \sup_{X\in \cX^{2m}}   \cN_{\infty}(X,\dlh_{\left\lceil2\gamma_{1}\right\rceil},\frac{\gamma_{0}}{2}) .
    \end{align*}
    % where $   \cN_{\infty}(X,\dlh,\frac{\gamma_{0}}{6})$ is the smallest cover of $ \dlh $ on $ X $, i.e. for all $ f\in\dlh $,
    % \begin{align}
    %     \min_{f'\in\cN_{\infty}(X,\dlh,\frac{\gamma}{6})  }\max_{x\in X}  \left| f(x)-f'(x) \right| \leq \frac{\gamma}{6}. 
    % \end{align}
    % and $   \cN_{\infty}(X,\dlh,\frac{\gamma_{0}}{6})$ is the smallest set with this guarantee. 
 \end{lemma}

 \begin{proof}
    We first notice that if $ \tau_{1}>1 $ then we are done by $
    \ls_{\cD}(f)\leq 1,$ thus we assume for the remaining of the proof
    that $ \tau_{1}\leq 1.$ For ease of notation, let $
    \beta=\left(\sqrt{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta}
          \right)}/m} +2\ln{\left(\frac{e}{\delta} \right)}/m\right)$ in the following.   
    We start by showing that
    \begin{align}\label{eq:marginbound-1}
        &\p_{\rS\sim\cD^{m} }\left[
        \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],
         \exists f \in \dlh: 
         \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\cD}(f) \geq \tau+64\beta\right] 
        \\
        &\leq 2
        \p_{\rS,\rS'\sim\cD^{m}}\left[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh: \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\rS'}(f) \geq \tau_{1} + 32\beta\right]\nonumber.
    \end{align}
    To this end, we first notice that if $ f\in \dlh $ is such that $ \ls_{\cD}(f)> \frac{2\ln{\left(\frac{e}{\delta} \right)}}{m} $, then 
   by Chernoff, we have that 
   \begin{align*}
    \p_{\rS'}\left[\ls_{\rS'}(f)\leq \left(1-\sqrt{\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m\ls_{\cD}(f)}}\right)\ls_{\cD}(f)\right]\nonumber
    \leq
     \exp{\left(-\frac{2\ln{\left(\frac{e}{\delta} \right)}}{2} \right)}\nonumber
     \leq  \frac{\delta}{e}.\nonumber
   \end{align*}
   This implies that with probability at least $ 1-\frac{\delta}{e}$ over $ \rS' $ , we have 
   \begin{align}
    \ls_{\rS'}(f)\geq \ls_{\cD}(f)-\sqrt{\frac{\ls_{\cD}(f)\cdot 2\ln{\left(\frac{e}{\delta} \right)}}{m}}.\nonumber
   \end{align} 
   Now,  for $ a>0,$  $ x-\sqrt{ax} $ is increasing for $ x\geq a/4,$ since it has derivative $ 1-\frac{a}{2\sqrt{ax}}$. Thus, for  $\ls_{\cD}(f) \geq\tau_{1}+64\beta =\tau_{1} +\cc\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right) \geq \frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}$, we have by the above with $ a=\frac{2\ln{\left(e/\delta \right)}}{m},$ that with probability at least $ 1-\frac{\delta}{e}$ over $ \rS',$  we have
   
   \begin{align}\label{eq:marginbound-2}
    &\ls_{\rS'}(f)\geq \ls_{\cD}(f)-\sqrt{\frac{\ls_{\cD}(f)\cdot 2\ln{\left(\frac{e}{\delta} \right)}}{m}}
    \\
    &\geq \tau_{1} 
    +\cc\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right) 
    -\sqrt{
        \frac{
        \left(
        \tau_{1} 
        +\cc\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
        +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right)\right)\cdot 2\ln{\left(\frac{e}{\delta} \right)}}{m}},
        \nonumber
   \end{align} 
where the square root term can be upper bounded using $ a+\sqrt{ab}+b\leq2(a+b)  $ and $ \sqrt{a+b} \leq \sqrt{a}+\sqrt{b}$ for $ a,b>0,$ as follows
   \begin{align}
    &\sqrt{
        \frac{
        \left(
        \tau_{1} 
        +\cc\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
        +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right)\negmedspace\right)\cdot 2\ln{\left(\frac{e}{\delta} \right)}}{m}}
        \leq 
    \sqrt{
        \frac{\cc
        \left(
        \tau_{1} 
        +\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
        +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\negmedspace\right)\cdot 2\ln{\left(\frac{e}{\delta} \right)}}{m}}\nonumber
    \\
    &\leq\sqrt{
        \frac{2\cdot \cc
        \left(
        \tau_{1} 
        +
        \frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right)\cdot 2\ln{\left(\frac{e}{\delta} \right)}
        }{m}}\nonumber
        \leq\sqrt{2\cdot64}\left(
          \sqrt{ 
            \frac{
            \tau_{1}\cdot2 
            \ln{\left(\frac{e}{\delta} \right)}
            }{m}}
            +
            \frac{2\ln{\left(\frac{e}{\delta}\right)}
            }{m}\right)\nonumber.
   \end{align}
   Now using the above upper bound combined with \cref{eq:marginbound-2} we conclude that
   \begin{align}\label{eq:marginbound1}
    &\ls_{\rS'}(f)
        \geq
        \tau_{1} 
        +\left(\cc-\sqrt{2\cdot\cc}\right)\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} +\left(\cc-\sqrt{2\cdot\cc}\right)\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}
        \\
        &\geq \tau_{1}
        +
        32
        \left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} +\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right)=\tau+32\beta \nonumber,
   \end{align} 
where the last equality uses that $ \beta=\left(\sqrt{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}/m} +2\ln{\left(\frac{e}{\delta} \right)}/m\right)$.
   Thus, we conclude by the above and the law of total probability that 
\begin{align}\label{eq:marginbound16}
    &\p_{\rS,\rS'\sim\cD^{m}}\left[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh: \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\rS'}(f) \geq \tau_{1} + 32\beta\right]
    \\
    &=
    \p_{\rS,\rS'\sim\cD^{m}} \Bigg[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right], \exists f\in \dlh: \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\rS'}(f) \geq \tau_{1} 
     +32\beta\nonumber
    \\
    &\mid \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f \in \dlh: \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\cD}(f) \geq \tau_{1}  +\cc\beta\Bigg]\nonumber 
    \\
    &\cdot
    \p_{\rS}\left[
        \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],
        \exists f \in \dlh:
     \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\cD}(f) \geq \tau_{1} +\cc\beta\right] \nonumber
    \\
    &\geq
     \left(1-\frac{\delta}{e}\right) \p_{\rS}\left[
    \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],
     \exists f \in \dlh: 
     \ls_{\rS}^{\gamma}(f)\in [\tau_{0},\tau_{1}] ,\ls_{\cD}(f) \geq \tau_{1} +\cc\beta\right] 
     \nonumber
   \end{align}
where the second to last inequality follows by the law of total probability and the last inequality by \cref{eq:marginbound1}, 
whereby we have shown \cref{eq:marginbound-1}.

We now bound the probability of the expression on the second line of
\cref{eq:marginbound-1}  by
\[
   \sup_{X\in \cX^{2m}}
   \cN_{\infty}(X,\dlh_{\left\lceil2\gamma_{1}\right\rceil},\frac{\gamma_{0}}{6})\frac{\delta}{e},
 \]
 which would conclude the proof.

Now consider any $ \gamma $ such that $\gamma_{0}\leq \gamma\leq \gamma_{1}.$ We now recall that for a function $ f $, we defined $ f_{\left\lceil2\gamma_{1}\right\rceil} $ as follows:
\begin{align*}
    f_{\left\lceil2\gamma_{1}\right\rceil}(x)=\begin{cases}
        2\gamma_{1} &\text{ if }f(x)> 2\gamma_{1}
        \\
        -2\gamma_{1} &\text{ if } f(x)<- 2\gamma_{1}
        \\
        f(x) &\text{ else }.
    \end{cases}
\end{align*}
Thus,  $ f_{\left\lceil2\gamma_{1}\right\rceil}(x) $ has the same sign as $ f(x) $  and is equal to $ f(x), $ when $ |f(x)|\leq 2\gamma_{1}.$  Using the above observations we conclude by $ y\in\{  -1,1\}  $ and $ \gamma\leq \gamma_{1} $   that $ \ind\{   f(x)y\leq \gamma \}=\ind\{   f_{\left\lceil2\gamma_{1}\right\rceil}(x)y\leq \gamma\}$  and   $ \ind\{   f(x)y\leq 0 \}=\ind\{   f_{\left\lceil2\gamma_{1}\right\rceil}(x)y\leq 0 \}$. Thus, we get that
\begin{align}\label{eq:marginbound19}
    &\p_{\rS,\rS'\sim\cD^{m}}\left[ \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh :  \ls_{\rS}^{\gamma}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}(f) \geq 
    \tau_{1} 
        + 32\beta\right]
        \\
        &=\p_{\rS,\rS'\sim\cD^{m}}\left[ \exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} :  \ls_{\rS}^{\gamma}\left(f\right)
        \leq \tau_{1}, \ls_{\rS'}(f) \geq 
        \tau_{1} 
            + 32\beta\right]. \nonumber
\end{align}

By $ \rS $ and $ \rS' $ being i.i.d., we may see $ \rS $ and $ \rS' $ as being drawn in the following way: First, we draw $ \bar{\rS}\sim \cD^{2m} $ and then let $ \rS $ be created by drawing $ m $ times without replacement from $ \bar{\rS} $ and $ \rS'=\bar{\rS}\backslash\rS $.  We denote this way of drawing $ \rS $ and $ \rS' $ from $ \bar{\rS} $ as  $ \rS,\rS'\sim \bar{\rS} $. We then have that,
   \begin{align}\label{eq:marginbound14}
    &\p_{\rS,\rS'\sim\cD^{m}}\left[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} :  \ls_{\rS}^{\gamma}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}(f) \geq 
    \tau_{1} 
        + 32\beta\right]
    \\
    &\leq
    \p_{\bar{\rS}\sim \cD^{2m}}\Bigg[\p_{\rS,\rS'\sim\bar{\rS}}\Bigg[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} :  \ls_{\rS}^{\gamma}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}(f) \geq 
    \tau_{1} 
        + 32\beta\Bigg]\Bigg]\nonumber
    \\
    &\leq
    \sup_{Z\in (\cX\times\{  -1,1\}) ^{2m}}
    \p_{\rS,\rS'\sim Z}\bigg[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} :  \ls_{\rS}^{\gamma}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}(f) \geq 
    \tau_{1} 
        + 32\beta\bigg].\nonumber
   \end{align}
   Let now $ Z=(X,Y)\in (\cX\times\{  -1,1\}) ^{2m} $ and $ \Net $ be a $ \frac{\gamma_{0}}{2} $-cover for $ \dlh_{\left\lceil2\gamma_{1}\right\rceil} $ on $ X $   with respect to $ \infty $-norm of minimal size. That is, for any $ f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} $, we have
   \begin{align*}
    \min_{f'\in \Net}\max_{x\in X}  \left| f(x)-f'(x) \right| \leq \frac{\gamma_{0}}{2}.
   \end{align*}  
   and any other cover satisfying the above has size at least $|\Net|$. 
   We notice that this implies that if $ \gamma $ is such that $
   \gamma_{0}\leq\gamma\leq\gamma_{1} $ and $ f\in
   \dlh_{\left\lceil2\gamma_{1}\right\rceil} $, then for the function
   $f'$ closest to $ f $ in $N$, i.e.\ $f'=\text{argmin}_{f'\in\Net
   }\max_{x\in X}  \left| f(x)-f'(x) \right|,$ with ties broken
   arbitrarily, it holds for any $ (x,y)\in Z$ with $ f(x)y\leq0 $ that$ f'(x)y=f(x)y+(f'(x)-f(x))y\leq0+\frac{\gamma_{0}}{2} \leq \frac{\gamma_{0}}{2}$. 
   Similarly for any $ (x,y)\in Z $ such that $ f(x)y> \gamma $, we have $ f'(x)y=f(x)y+(f'(x)-f(x))y>\gamma-\frac{\gamma_{0}}{2} >\frac{\gamma_{0}}{2}$, where the last inequality follows from $ \gamma\geq \gamma_{0}$. 
   Thus, we conclude that for any $ \gamma $ such that $
   \gamma_{0}\leq \gamma\leq\gamma_{1} $ and $
   f\in\dlh_{\left\lceil2\gamma_{1}\right\rceil} $, there exists $
   f'\in \Net$ such that   $\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f')\geq \ls_{\rS'}(f)$ and that $ \ls_{\rS}^{\gamma}\left(f\right)\geq \ls_{\rS}^{\frac{\gamma_{0}}{2}}\left(f'\right) $.  
   By the above and the union bound, we conclude that
   \begin{align}\nonumber
    &\p_{\rS,\rS'\sim Z}\bigg[\exists \gamma \in \left[\gamma_{0},\gamma_{1}\right],\exists f\in \dlh_{\left\lceil2\gamma_{1}\right\rceil} :  \ls_{\rS}^{\gamma}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}(f) \geq 
    \tau_{1} 
        + 32\beta\bigg]
    \\
    &\leq
    \p_{\rS,\rS'\sim Z}\bigg[\exists f\in N :  \ls_{\rS}^{\frac{\gamma_{0}}{2}}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f) \geq 
    \tau_{1} 
        + 32\beta\bigg]\nonumber
    \\
    &\leq
    \sum_{f\in \Net}
    \p_{\rS,\rS'\sim Z}\bigg[  \ls_{\rS}^{\frac{\gamma_{0}}{2}}\left(f\right)
    \leq \tau_{1}, \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f) \geq 
    \tau_{1} 
        + 32\beta\bigg]. \label{eq:marginbound13}
   \end{align}
   We now show that for each $ f\in \Net $, each term/probability in the sum is at most $ \frac{\delta}{e}, $ so the sum is at most $ \cN_{\infty}(X,\dlh_{\left\lceil2\gamma_{1}\right\rceil},\frac{\gamma_{0}}{2}) \frac{\delta}{e} $. Which implies by \cref{eq:marginbound14}, that \cref{eq:marginbound19} is bounded by $\sup_{X\in \cX^{2m}}   \cN_{\infty}(X,\dlh_{\left\lceil2\gamma_{1}\right\rceil},\frac{\gamma_{0}}{2}) \frac{\delta}{e} $ as claimed below \cref{eq:marginbound16} and would conclude the proof. To the end of showing the above let  $ f\in \Net $ for now.

   Recall that $ \beta=\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right).$ Let $ 2\mu $  denote the fraction of points in $ Z $ where $ f $ has less than  $ \gamma_{0}/2 $-margin, i.e.,    
$$ 2\mu= \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)+\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)= \left| \{ (x,y)\in Z: f(x)y\leq \frac{\gamma_0}{2} \} \right| /m. $$
We notice that $ \mu $ is the expectation of  $  \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)$ and that for the probability in \cref{eq:marginbound13} to be nonzero, it must be the case that $ \mu \geq 32\frac{\ln{\left(\frac{e}{\delta} \right)}}{m} $. Thus, we assume this is the case.
We notice that if $ \mu > \frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}$, we have by Chernoff (which due to \cite{withreplacementchernoff}[see section 6] also holds when sampling without replacement) that  
\begin{align*}
    \p_{\rS,\rS'\sim Z}\left[\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)\leq \left(1-\sqrt{\frac{2\ln{\left(\frac{e}{\delta} \right)}}{\mu m}}\right)\mu \right]
    \leq  \exp{\left(-\frac{2\ln{\left(\frac{e}{\delta} \right)}\mu m}{2\mu m} \right)}\leq  \frac{\delta}{e}
\end{align*}
Thus, with probability at least $ 1-\frac{\delta}{e} $ over $ \rS,\rS' $, we have by definition of $ \mu $ that
\begin{align}\label{eq:marginbound7}
    &\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
    \geq 
    \mu-\sqrt{\frac{\mu 2 \ln{\left(\frac{e}{\delta} \right)}}{m}}
    =
    \frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)+\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
\sqrt{\frac{\left(
    \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)+\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
    \right)\ln{\left(\frac{e}{\delta} \right)}}{m}}
    \\
    &\geq
    \frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)+\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
\sqrt{\frac{
    \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
    \ln{\left(\frac{e}{\delta} \right)}}{m}}
    -
\sqrt{\frac{
    \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
    \ln{\left(\frac{e}{\delta} \right)}}{m}}
    \tag{by $ \sqrt{a+b}\leq \sqrt{a}+\sqrt{b} $ }
    \\
    &\Rightarrow
    \frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)}{2}+
\sqrt{\frac{
    \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
    \ln{\left(\frac{e}{\delta} \right)}}{m}}
\geq
\frac{\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
\sqrt{\frac{
    \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
    \ln{\left(\frac{e}{\delta} \right)}}{m}}.
    \tag{by rearrangement}
\end{align}
Recall that $ \beta=\left(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\right).$ We now show
that if $
\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)\geq \tau_{1}+32\beta=\tau_{1} 
+ 32\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) $ and $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\leq  \tau_{1}$ then we have
\begin{align}\label{eq:marginbound17}
  \frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)}{2}+
        \sqrt{\frac{
            \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
            \ln{\left(\frac{e}{\delta} \right)}}{m}} < 
    \frac{\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
    \sqrt{\frac{
       \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
        \ln{\left(\frac{e}{\delta} \right)}}{m}}.
        \end{align}
This implies that the event $
\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)\geq\tau_{1}+32\beta$ and $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\leq  \tau_{1}$ is in the complement of the event $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\geq 
\mu-\sqrt{\frac{\mu 2 \ln{\left(\frac{e}{\delta} \right)}}{m}}$, which
we just argued happens with probability at least $ 1-\frac{\delta}{e}
$ over $ \rS ,\rS'$. Thus we now show that $
\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)\geq \tau_{1} 
+ 32\beta $ and $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\leq  \tau_{1}$  implies \cref{eq:marginbound17}, which would
establish that each term in \cref{eq:marginbound13} is no more than $
\frac{\delta}{e} $ and thereby conclude the proof.

If $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\leq  \tau_{1}$,
then by $ \sqrt{a+b}\leq \sqrt{a}+\sqrt{b} $, we have that 

\begin{align}\label{eq:marginbound5}
    &\frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)}{2}+
    \sqrt{\frac{
        \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
        \ln{\left(\frac{e}{\delta} \right)}}{m}}
        \leq 
        \frac{\tau_1}{2}
        + 
        \sqrt{\frac{\tau_{1}\ln{\left(\frac{e}{\delta} \right)}}{m}}
\end{align}
Now if
$
\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)\geq \tau_1 + 32 \beta = \geq \tau_{1} 
+ 32\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) $  
and using that we argued earlier that $ x-\sqrt{ax} $ is increasing for $ x\geq \frac{a}{4} $, we get that 
\begin{align}\label{eq:marginbound6}
&\frac{\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
\sqrt{\frac{
    \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
    \ln{\left(\frac{e}{\delta} \right)}}{m}} 
\\
&\geq
\frac{\tau_1}{2}
+ 16\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) 
-
\sqrt{\frac{\left(\tau_{1}
+ 32\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) 
    \right)\ln{\left(\frac{e}{\delta} \right)}}{m}}.\nonumber
\end{align}
Now upper bounding the second term using by $  a+\sqrt{ab}+b\leq 2(a+b)$ and $ \sqrt{a+b}\leq \sqrt{a}+\sqrt{b},$ 
\begin{align*}
&
\sqrt{\frac{\left(
\tau_{1}
+ 32\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) 
    \right)\ln{\left(\frac{e}{\delta} \right)}}{m}}
\leq
\sqrt{\frac{32\left(
\tau_{1}
+ \sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m} 
    \right)\ln{\left(\frac{e}{\delta} \right)}}{m}}
\\
&\leq
\sqrt{\frac{64\left(
\tau_{1}
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m} 
    \right)\ln{\left(\frac{e}{\delta} \right)}}{m}}
\leq\sqrt{64}
\sqrt{\frac{
\tau_{1}\ln{\left(\frac{e}{\delta} \right)}}{m}}
+\sqrt{128}
\frac{ 
    \ln{\left(\frac{e}{\delta} \right)}}{m},
\end{align*}
we conclude from \cref{eq:marginbound6} that 
\begin{align}\label{eq:marginbound8}
    \frac{\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
    \sqrt{\frac{
        \ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)
        \ln{\left(\frac{e}{\delta} \right)}}{m}}  \geq \frac{\tau_{1}}{2}+(16\sqrt{2}-\sqrt{64})\sqrt{\frac{\tau_{1}\cdot \ln{\left(\frac{e}{\delta} \right)}}{m}} 
        +(32-\sqrt{128})\frac{\ln{\left(\frac{e}{\delta} \right)}}{m}.
\end{align}
Thus, combining \cref{eq:marginbound5} and \cref{eq:marginbound8} and using that $ 16\sqrt{2}-\sqrt{64} \geq 14$ and $ 32-\sqrt{128}\geq 20,$ we conclude that if $
\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)\geq\tau_{1}+32\beta= \tau_{1} 
+ 32\Big(\sqrt{\frac{\tau_{1}\cdot 2 \ln{\left(\frac{e}{\delta} \right)}}{m}} 
+\frac{2\ln{\left(\frac{e}{\delta} \right)}}{m}\Big) $ and $ \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
\leq  \tau_{1}$, then it implies that 
\begin{align*}
    \frac{\ls_{\rS'}^{\frac{\gamma_{0}}{2}}(f)}{2}-
    \sqrt{\frac{
       \ls_{\rS'}^{\frac{\gamma_{0}}{2}}
        (f)\ln{\left(\frac{e}{\delta} \right)}}{m}} 
        >
        \frac{\ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)}{2}+
        \sqrt{\frac{
            \ls_{\rS}^{\frac{\gamma_{0}}{2}}(f)
            \ln{\left(\frac{e}{\delta} \right)}}{m}},
        \end{align*}
which as argued earlier concludes the proof.
\end{proof}