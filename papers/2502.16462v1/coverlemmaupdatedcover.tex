\section{Bound on infinity cover}\label{sec:cover}

In this section, we prove \cref{lem:coverfinal}, where from \cref{cor:coverfinal} follows and gives us the covering bound needed as described in the proof sketch. To this end recall that we for a function class $ \cF $ and a point set $ X=\{ x_{1},\ldots ,x_{m} \}  \subset\cX$ of size $ m $ and precision $ \gamma $ define $ \cN_{\infty}(X,\cF,\gamma) $ to be the minimal size of a $ \gamma $-cover in infinity norm of $ \cF $ on $ X,$ i.e. the smallest size of a set of functions $ \Net $ satisfying $ \min_{f'\in \Net}\max_{x\in X} |f(x)-f'(x)|\leq \gamma .$ Furthermore, we will use $ \Ln(x)=\ln(\max(x,e)) $ for the truncated natural logarithm. We now state \cref{lem:coverfinal} and \cref{cor:coverfinal}, and show how \cref{lem:coverfinal} implies \cref{cor:coverfinal}.

\begin{lemma}\label{lem:coverfinal}
    There exist universal constants $ c'\geq c>0 $ and $ c'\geq 1 $  such that: For a point set $ X=\{ x_{1},\ldots,x_{m} \} \subseteq \cX $ of size $ m $, $ \cH \subseteq \{-1,1\}^{\cX}$ a hypothesis class of VC-dimension $ d $, $ 0<\eps<1 $,     $ 0<\alpha<\frac{1}{2} $  and $ 0<\gamma\leq 1 $  such that $ \gamma^{2}\geq  \frac{cd}{\alpha^{2}\eps^{2}m}$, we have 
   \begin{align}
       \ln(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil} ,\alpha \gamma)) \leq
       \frac{c'd}{\alpha^{2}\eps^{2}\gamma^{2}} \Ln^{1+\eps}{\left(  \frac{8\alpha m\eps^{2} \gamma^{2}}{cd} \right)}.
   \end{align}   
\end{lemma}

\begin{corollary}\label{cor:coverfinal}
    There exist universal constants $ c'\geq c>0 $ and $ c'\geq 1 $  such that: For a point set $ X=\{ x_{1},\ldots,x_{m} \} \subseteq \cX $ of size $ m $, $ \cH \subseteq \{-1,1\}^{\cX}$ a hypothesis class of VC-dimension $ d $,     $ 0<\alpha<\frac{1}{2} $  and $ 0<\gamma\leq 1 $  such that $ \gamma^{2}\geq \frac{4cd\Ln^{2}(\Ln{ ( \frac{8\alpha m \gamma^{2}}{cd}) }) }{\alpha^{2}m}$, we have 
   \begin{align}
    \ln(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil} ,\alpha \gamma)) \leq \frac{c'd}{\alpha^{2}\gamma^{2}}\Ln^{2}(\Ln{(  \frac{8\alpha m \gamma^{2}}{cd})}) \Ln{\left(  \frac{8\alpha m\gamma^{2}}{cd} \right)}=\frac{c'd}{\alpha^{2}\gamma^{2}}\func\left( \frac{8\alpha m \gamma^{2}}{cd}\right)
   \end{align}
   where $ \func(x)=\Ln^{2}(\Ln(x))\Ln(x).$     
\end{corollary}

\begin{proof}[Proof of \cref{cor:coverfinal}]
    Let $ c',c $ be the constants from \cref{lem:coverfinal}, and furthermore consider  $ \gamma^{2}\geq \frac{4cd\Ln^{2}(\Ln{ ( \frac{8\alpha m \gamma^{2}}{cd}) }) }{\alpha^{2}m}.$ To the end of invoking \cref{lem:coverfinal}, notice that for $ \eps=1/(2\Ln(\Ln{(  \frac{8\alpha m \gamma^{2}}{cd})}) )\leq 1/2,$ we have that $\frac{cd}{\alpha^{2}\eps^{2}m}\leq \frac{4cd\Ln^{2}(\Ln{ ( \frac{8\alpha m \gamma^{2}}{cd}) }) }{\alpha^{2}m}\leq \gamma^{2},$ and we thus may invoke \cref{lem:coverfinal} with this $ \eps.$   We notice that for this $ \eps $ we have that 
    \begin{align*}
        \Ln^{\eps}{\left(  \frac{8\alpha m\eps^{2} \gamma^{2}}{cd} \right)}= \exp{\left(\eps\ln{\left( \Ln{\left(  \frac{8\alpha m\eps^{2} \gamma^{2}}{cd} \right)}\right)} \right)} \leq  e, 
    \end{align*}
    where we in the inequality used the value of $ \eps $ and that    $ \Ln{(  \frac{8\alpha m\eps^{2} \gamma^{2}}{cd} )}\leq\Ln{(  \frac{8\alpha m \gamma^{2}}{cd} )}.$   
    Thus we conclude that
    \begin{align}
        \ln(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil} ,\alpha \gamma)) \leq
        \frac{c'd}{\alpha^{2}\eps^{2}\gamma^{2}} \Ln^{1+\eps}{\left(  \frac{8\alpha m\eps^{2}  \gamma^{2}}{cd} \right)}
        \\ \leq \frac{4ec'd}{\alpha^{2}\gamma^{2}}\Ln^{2}(\Ln{(  \frac{8\alpha m \gamma^{2}}{cd})}) \Ln{\left(  \frac{8\alpha m\gamma^{2}}{cd} \right)}.
    \end{align}
    whereby \cref{cor:coverfinal} follows from redefining $ c' $ to be $ 4ec'.$     
\end{proof}



We now move on to prove \cref{lem:coverfinal}. To prove \cref{lem:coverfinal}, we need the following two lemmas. The first lemma bounds the infinity cover of $ \dlh_{\left\lceil\gamma \right\rceil} $ in terms of the fat shattering dimension of $ \dlh_{\left\lceil\gamma \right\rceil} $.


\begin{lemma}\label{lem:covering}
    There exists universal constants  $ \check{C}\geq 1$ and $\check{c}>0 $ such that: For $ X =\{  x_{1},\ldots,x_{m}\} \subseteq \cX$ a point set of size $ m $, $ \cH \subseteq \{-1,1\}^{\cX}$ a hypothesis class,  $ 0<\eps<1 $, $ 0<\alpha<\frac{1}{2} $  and $ 0<\gamma\leq 1 $ if $\fat_{\check{c} \alpha\eps  \gamma}(\dlh_{\left\lceil\gamma\right\rceil})\leq m $, then we have, for $ d= \fat_{\check{c} \alpha\eps  \gamma}(\dlh_{\left\lceil\gamma\right\rceil}),$   that 
    \begin{align}
        \ln(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil} ,\alpha \gamma)) \leq\check{C} 
        d 
        \ln^{1+\eps}\left(\frac{2m}{d  \alpha}\right).
    \end{align}   
\end{lemma}
We also postpone the proof of \cref{lem:covering} and give it after the proof of \cref{lem:coverfinal}. The next lemma gives a bound on the fat shattering dimension of $ \dlh_{\left\lceil\gamma \right\rceil} $, in terms of $ \gamma $ and the VC-dimension of the hypothesis class $ \cH $. 

\begin{lemma}\label{lem:fathelper}
    There exists a universal constant $ C\geq 1 $ such that: For $1\geq \gamma >0  ,$ $ \beta>0,$ and $ \cH \subseteq \{-1,1\}^{\cX}$ a hypothesis class with VC dimension $ d $, we have that  $\fat_{\beta} (\dlh_{\left\lceil\gamma\right\rceil})\leq \frac{Cd}{\beta^{2}} $ 
\end{lemma}
We postpone the proof of \cref{lem:fathelper} for now and give the proof of \cref{lem:coverfinal} by combining \cref{lem:covering} and \cref{lem:fathelper}.

\begin{proof}[Proof of \cref{lem:coverfinal}]
    In what follows let, $ \check{C}\geq1 $ and $ \check{c} >0$ be the universal constants from \cref{lem:covering}, and $ C \geq1$ be the universal constant from \cref{lem:fathelper}. Furthermore, let $ c $ denote the universal constant $ c=\frac{16C}{\check{c}^{2}} $ and $ c'=\frac{16\check{C}C}{\check{c}^{2}} $  in \cref{lem:coverfinal}. Since $ \check{C}\geq 1$ we have $ c'\geq c.$

   By \cref{lem:fathelper}, we have that $ d'=\fat_{\check{c}\alpha\eps\gamma}(\dlh_{\left\lceil\gamma\right\rceil}) $ is upper bounded by $ \frac{4Cd}{\check{c}^2\alpha^2\eps^2\gamma^2}$.
   Thus, we have that $  d'=\fat_{\check{c}\alpha\eps\gamma}(\dlh_{\left\lceil\gamma\right\rceil})\leq m$, by the assumption $ \gamma^{2}\geq  \frac{cd}{\alpha^{2}\eps^{2}m}$ and $ c=\frac{16C}{\check{c}^{2}},$ and we may invoke \cref{lem:covering} to obtain 
   
   \begin{align*}
       \ln(\cN_{\infty}(X, \dlh_{\left\lceil\gamma\right\rceil}, \alpha \gamma)) \leq
       \check{C} 
       d'
       \ln^{1+\eps}\left(\frac{2m}{d' \alpha}\right).
   \end{align*}
   Next, we analyze the term $d' \ln^{1+\eps}\left(\frac{2m}{d' \alpha}\right)$. 
   We now notice that the function $ x\ln^{1+\eps}{\left(\frac{a}{x} \right)} $  has derivative  $\ln^{\eps}{\left(\frac{a}{x} \right)} \left(\ln{\left(\frac{a}{x} \right)}-1-\eps \right)$, thus the derivative is positive for $ \ln{\left(\frac{a}{x} \right)}\geq 1+\eps $ or equivalently $ \frac{ a }{\exp{\left(1+\eps \right)}}\geq x $, whereby we conclude that $ x\ln^{1+\eps}{\left(\frac{a}{x} \right)} $ is increasing for $ \frac{ a }{\exp{\left(1+\eps \right)}}\geq x $. Now using this with $ a=\frac{2m}{\alpha}\geq \frac{64Cd}{\check{c}^2\alpha^2\eps^2\gamma^2} $, where we used that $ \gamma^{2}\geq  \frac{cd}{\alpha^{2}\eps^{2}m}$, $ c=\frac{16C}{\check{c}^{2}} $   and   $ \alpha < \frac{1}{2} $, and having the upper bound on $ d'=\fat_{\check{c}\alpha\eps\gamma}(\dlh_{\left\lceil\gamma\right\rceil}) $ of $ \frac{4Cd}{\check{c}^2\alpha^2\eps^2\gamma^2} \leq \frac{\frac{32Cd}{\check{c}^2\alpha^2\eps^2\gamma^2}}{ \exp{\left(1+\eps \right)} } $, since $  \frac{32}{\exp{\left(1+\eps \right)}}\geq 4  $, we conclude that $ d'=\fat_{\check{c}\alpha\eps\gamma}(\dlh_{\left\lceil\gamma\right\rceil})\leq \frac{4Cd}{\check{c}^2\alpha^2\eps^2\gamma^2}\leq \frac{a}{ \exp{\left(1+\eps \right)} }.$ This then implies by the above argued monotonicity of $ x\ln^{1+\eps}{\left(\frac{a}{x} \right)}, $ with $ a=\frac{2m}{\alpha} $  that 
   \begin{align*}
       \check{C} 
       d'
       \ln^{1+\eps}{\left(\frac{2m}{d'\alpha} \right)}
       \leq
       \check{C}\frac{4Cd}{\check{c}^2\alpha^2\eps^2\gamma^2} \ln^{1+\eps}{\left(\frac{2m}{\alpha }  \frac{\check{c}^2\alpha^2\eps^2\gamma^2}{4Cd} \right)}
       \leq
       \frac{c'd}{\alpha^2\eps^{2}\gamma^{2}} \ln^{1+\eps}{\left(  \frac{8\alpha m\eps^{2}\gamma^{2}}{cd} \right)},
   \end{align*}
   where the last equivalently follows from $ c=\frac{16C}{\check{c}^{2}} $ and $ c'=\frac{16\check{C}C}{\check{c}^{2}} $ (we notice that if $ c' $ is not at least $1$, we could set it equal to $ 1 $ and still have an upper bound)
   which concludes the proof. 
\end{proof}

With the proof of \cref{lem:coverfinal} done, we now provide the proof of \cref{lem:fathelper}. The last part of the proof of \cref{lem:fathelper}, which lower and upper bounds the Rademacher complexity, uses an idea similar to \cite{larsen2022optimalweakstronglearning} [Lemma 9].

\begin{proof}[Proof of \cref{lem:fathelper}]
    First if $ \beta>\gamma,$ then by hypotheses in $ \dlh_{\left\lceil\gamma \right\rceil} $ attaining values in $ [-\gamma,\gamma],$ it follows that $ \fat_{\beta}(\dlh_{\left\lceil\gamma \right\rceil} )=0,$ since no hypothesis in $ \dlh_{\left\lceil\gamma \right\rceil} $ can be above $ r_{1}+\beta $  or below $r_{1}-\beta  $ for any $ r_{1}\in\mathbb{R}.$ As $ \frac{Cd}{\beta}>0 $ this proves the case $ \beta>\gamma,$ thus, we consider for now the case that $ 0<\beta\leq \gamma. $      
    Let $ x_1,\ldots,x_{d'} $ and $ r\in [\beta-\gamma,\gamma-\beta]^{d'} $ be $ \beta $-shattered by $ \dlh_{\left\lceil\gamma\right\rceil} $. We note that we may assume that $ r $ is in  $ [\beta-\gamma,\gamma-\beta]^{d'}, $ as $ [-\gamma,\gamma] $  contains the image of $ \dlh_{\left\lceil\gamma \right\rceil} $. If an entry of $ r_{i} $ is outside the interval $ [\beta-\gamma,\gamma-\beta]^{d'} $, it must either be the case that no function in $ \dlh_{\left\lceil\gamma \right\rceil} $ can be $ \beta $ below or above  $ r_{i} $, depending on $ r_{i} $ being positive or negative. Now by $ x_1,\ldots,x_{d'} $ and $ r\in [\beta-\gamma,\gamma-\beta]^{d'} $ being $ \beta $-shattered by $ \dlh_{\left\lceil\gamma\right\rceil} $, we have that for any $ b\in \left\{ -1,1 \right\}^{d'}  $, that there exists $ \cffs\in\cff  $  such that  
    \begin{align}
      \cffs(x_i)&\leq r_{i}-\beta  \quad \text{ if  } b_{i}=-1
      \\
      \cffs(x_i)&\geq r_{i}+\beta  \quad \text{ if  } b_{i}=1.
    \end{align}
    We now recall that $ \cffs\in \cff $ is generated by a function $ f\in \dlh $ in the following way
    \begin{align*}
            f_{\left\lceil\gamma\right\rceil}(x)=\begin{cases}
                \gamma &\text{ if }f(x)> \gamma
                \\
                -\gamma &\text{ if } f(x)<- \gamma
                \\
                f(x) &\text{ else },
            \end{cases}
    \end{align*} 
    i.e.\ $ f $ always being below $ \cffs $ if $ \cffs $ is less strictly less than $ \gamma $  and $ f $ always being above $ \cffs $ if $ \cffs $ is strictly larger than $ -\gamma $.    
    This implies that the function $ f\in \dlh $ generating $ \cffs $   also satisfies:  
    \begin{align}\label{eq:fathelper1}
        f(x_i)&\leq r_{i} -\beta \quad \text{ if  } b_{i}=-1
        \\
        f(x_i)&\geq r_{i}+\beta  \quad \text{ if  } b_{i}=1,\nonumber
      \end{align}
      as $ r_{i}\in \left[\beta-\gamma,\gamma  -\beta\right] $, we have, if $ b_{i}=-1 $, that  $  \gamma > r_{i}-\beta \geq f_{\left\lceil\gamma\right\rceil}(x_{i}) \geq f(x_{i}) $, and if $ b_{i}=1 $, then $-\gamma< r_{i}+\beta \leq f_{\left\lceil\gamma\right\rceil}(x_{i})\leq f(x_{i}).$ Thus, we conclude that $ \dlh $ also $ \beta$-shatters  $ x_{1},\ldots,x_{d'} $ and $ r_{1},\ldots,x_{d'} $. We now notice that \cref{eq:fathelper1} implies that for all $ b\in \{  -1,1\}^{d'}  ,$ there exists $ f\in \dlh $ such that:

      \begin{align*}
        b_{i}(f(x_{i})-r_{i})\geq \beta.
      \end{align*}
      Using this, and adding $\e_{\sigma\sim \{-1,1  \}^{d'}}\left[ \sum_{i=1}^{d'}  \sigma_{i}(-r_{i})\right]  =0 $ we have the following lower bound on the Rademacher complexity of $ \dlh $ on $ x_{1},\ldots,x_{d'} $:
      \begin{align*}
       \e_{\sigma\sim \{  -1,1\}^{d'} }\left[\frac{1}{d'}\sup_{f\in \dlh} \sum_{i=1}^{d'}  \sigma_{i}f(x_{i})\right]
       =\e_{\sigma\sim \{  -1,1\}^{d'} }\left[\frac{1}{d'}\sup_{f\in \dlh} \sum_{i=1}^{d'}  \sigma_{i} (f(x_{i})-r_{i}) \right]
       \geq \beta.
      \end{align*}

      Furthermore, since $ f\in \dlh $ is a convex combination of hypotheses in $ \cH $, the Rademacher complexity of $ \dlh $ is the same as that of $ \cH $. Due to \cite{dudley} [See, for instance, \cite{rademacherboundlecturenotes}, Theorem 7.2], we have that since $ \cH $ has VC dimension $ d $, the   Rademacher complexity of $ \cH $  is at most $ \sqrt{\frac{Cd}{d'}} $, where $ C\geq 1 $ is a universal constant. Thus, we conclude:
            \begin{align*}
        \e_{\sigma\sim \{  -1,1\}^{d'} }\left[\sup_{f\in \dlh} \sum_{i=1}^{d'}  \sigma_{i}f(x_{i})\right]
        \leq
        \e_{\sigma\sim \{  -1,1\}^{d'} }\left[\sup_{h\in \cH} \sum_{i=1}^{d'}  \sigma_{i}h(x_{i})\right]
        \leq \sqrt{\frac{Cd}{d'}},
      \end{align*}
      which implies that $ d'\leq \frac{Cd}{\beta^{2}} $, as claimed and concludes the proof          
\end{proof}




To prove \cref{lem:covering}, we need the following lemma due to \cite{RudelsonVershynin}. \cite{RudelsonVershynin} bounds the size of a maximal $ \alpha$-packing, which upper bounds the size of a minimal $ \alpha $-cover, since an $ \alpha $-packing is also an $ \alpha $-cover.

\begin{theorem}[\cite{RudelsonVershynin} Theorem 4.4]\label{thm:infinitycoverrundelsonvershynin}
    There exist universal constants $ \check{C}\geq 1$ and $ \check{c} >0$ such that:  For a point set $ X=\{ x_{1},\ldots,x_{m} \}\subseteq \cX  $ of size $ m $ and a function class $ \cF $ defined on $ \cX$, if $ \forall f \in  \cF $, we have that $\sum_{x\in X} |f(x)|/m\leq 1,$ then for $ 0<\eps<1 $, $ 0<\alpha<\frac{1}{2} $, and $ d=\fat_{\check{c}\alpha\eps}( \cF) $ 
    \begin{align*}
     \ln{\left( \cN_{\infty}(X, \cF ,\alpha)   \right)} \leq \check{C}d\ln{\left(\frac{2m}{d\alpha} \right)}\ln^{\eps}{\left(\frac{2m}{d} \right)}.
    \end{align*}        
    
\end{theorem}
We now give the proof of \cref{lem:covering}.

\begin{proof}[Proof of \cref{lem:covering}]
Let $ 0 <\eps<1 $. We consider the function class $ \dlh_{\left\lceil\gamma\right\rceil}/\gamma=\{ f:f=f'/\gamma \text{ for } f'\in \dlh_{\left\lceil\gamma \right\rceil} \} $. 
We note that any function $ f\in \dlh_{\left\lceil\gamma\right\rceil}/\gamma $ is bounded in absolute value by $ 1 $, since any $ f\in \dlh_{\left\lceil\gamma \right\rceil} $ is bounded in absolute value by $ \gamma $.  Thus, we conclude that for $ f\in \dlh_{\left\lceil\gamma\right\rceil}/\gamma $
    \begin{align*}
     \sum_{x\in X}\frac{|f(x)|}{m}\leq 1.
    \end{align*}
    We now invoke \cref{thm:infinitycoverrundelsonvershynin} (using the notation $ d'=\fat_{\check{c}\cdot\eps\cdot \alpha}(\dlh_{\left\lceil\gamma\right\rceil}/\gamma)  $)  to obtain that there exist universal constants $ \check{C} \geq 1$ and $ \check{c}>0$  such that 
    \begin{align*}
        \ln\left( \cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil}/\gamma ,\alpha)   \right)
        &\leq
        \check{C} 
        d'
        \ln\left(\frac{2m}{d'  \alpha}\right)
        \cdot 
        \ln^{\eps}{\left(\frac{2m}{d } \right)}
        \\
        &\leq 
        \check{C} 
        d'
        \ln^{1+\eps}\left(\frac{2m}{d'  \alpha}\right).
        \tag{by $ \alpha<\frac{1}{2} $ }
    \end{align*}
    Now since $  \fat_{\check{c}\cdot\eps\cdot \alpha}\left(\dlh_{\left\lceil\gamma\right\rceil}/\gamma\right)=\fat_{\check{c}\cdot\eps\cdot \alpha\cdot \gamma}(\dlh_{\left\lceil\gamma\right\rceil})$ (so $d'=d= \fat_{\check{c}\cdot\eps\cdot \alpha\cdot \gamma}(\dlh_{\left\lceil\gamma\right\rceil})$ ), we obtain 
    \begin{align*}
        \ln\left( \cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil}/\gamma ,\alpha)    \right)\leq
        \check{C} 
        d
        \ln^{1+\eps}\left(\frac{2m}{d  \alpha}\right).
    \end{align*}
    Furthermore, we note that for any $ f\in \dlh_{\left\lceil\gamma \right\rceil} $ and $ f'\in \Net,$ where $ \Net $ is a minimal (in terms of size) $ \alpha $-cover of $ \dlh_{\left\lceil\gamma \right\rceil}  $ on $ X $ in infinity norm,  such that $ f' $ is $ \alpha $-close to $ \frac{f}{\gamma} \in\dlh_{\left\lceil\gamma\right\rceil}/\gamma$, it holds that 
    \begin{align}
     \max_{x\in X} \left| \frac{f(x)}{\gamma}-f'(x) \right| \leq \alpha
     \Rightarrow
     \max_{x\in X} \left|f-\gamma f'(x) \right| \leq \alpha\gamma.
    \end{align}
Thus, we conclude that $ \{ \gamma \cdot f' \}_{f'\in \Net } $, forms an $ \alpha \gamma $  cover of $ \dlh_{\left\lceil\gamma \right\rceil} $. Consequently, we have
    \begin{align}
        \ln\left(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil} ,\alpha \gamma)\right)\leq\ln\left(\cN_{\infty}(X,\dlh_{\left\lceil\gamma\right\rceil}/\gamma ,\alpha)\right) \leq
        \check{C} 
        d
        \ln^{1+\eps}\left(\frac{2m}{d  \alpha}\right)
    \end{align}
which concludes the proof. 
\end{proof}
