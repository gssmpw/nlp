\clearpage
\newpage

\section{Hard-coded prompt templates}
\label{sec:hard_coded_prompts}
Figure~\ref{fig:planner_conv1} shows the hard-coded category-wise prompt templates that are used to initiate the Planner agent when Auto-prompter is not present or it fails to generate a prompt.
% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.7\linewidth]{figures/appendix/prompt_1.pdf}
%     \label{fig:planner_conv2}
% \end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/prompt_1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/prompt_2.pdf}
    \caption{Initial Executor Agent prompts for use in \textit{Planner-Executor} Framework; variations by category}
    \label{fig:planner_conv1}
\end{figure}

% \clearpage
% \newpage
\newpage
\section{Impact of Planner}
\label{sec:impact_planner}
In that section, we select the challenge \textit{ezmae} with Claude 3.5 Sonnet to analyze the impact of using a planner, showcasing a detailed example of the benefits it brings to the solution process.

% Figure~\ref{fig:woplanner5} and Figure~\ref{fig:wplanner5} compare the trajectories of the \textit{ezMaze} challenge with and without the Planner. 
\subsection{Without planner}
Figure~\ref{fig:woplanner5} shows a snapshot of the \textit{ezmaze} challenge trajectory, shows the executor directly follows the Auto-prompter generated prompt without using the planner.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/woplanner1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/woplanner2.pdf}
    \label{fig:woplanner1}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/woplanner3.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/woplanner4.pdf}
    \caption{Demonstration of failed solution without planner}
    \label{fig:woplanner5}
\end{figure}

\subsection{With planner}
Figure~\ref{fig:wplanner5} shows the trajectory for the \textit{ezmaze} challenge shows that the planner used a hard-coded prompt, while the Autoprompter did not generate the prompt.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner2.pdf}
    \label{fig:wplanner1}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner3.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner4.pdf}
    \label{fig:wplanner3}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner5.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/planner/wplanner6.pdf}
    \caption{Demonstration of successful solution with planner}
    \label{fig:wplanner5}
\end{figure}

% \begin{figure*}
%     \centering
%     \includegraphics[width=17cm]{figures/appendix/appendix_w_o_planner.pdf}
%     \caption{A snapshot of the EzMaze challenge trajectory shows the executor directly following the Autoprompter's generated prompt without using the planner}
%     \label{fig:ezmaze_w_o_planner}
% \end{figure*}

% \begin{figure*}
%     \centering
%     \includegraphics[width=15cm]{figures/appendix/appendix_w_planner.pdf}
%     \caption{A snapshot of the trajectory for the EzMaze challenge shows that the planner used a hardcoded prompt, while the Autoprompter did not generate the prompt for this challenge}
%     \label{fig:ezmaze_w_planner}
% \end{figure*}

% \clearpage
% \newpage
\section{Comparison of different LLMs}
\label{sec:compare_llms}
We selected the challenge \textit{target\_practice} to illustrate the behaviors of different models tested in this section, highlighting their successes and failures by comparing their solution processes.
\subsection{Claude 3.5 Sonnet successful case}
Figure~\ref{fig:claude} demonstrates Claude 3.5 Sonnet with default setting to successfully solve challenge \texttt{target\_practice}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/claude1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/claude2.pdf}
    \caption{Demonstration of successful solution with Claude 3.5 Sonnet}
    \label{fig:claude}
\end{figure}

\subsection{GPT-4o successful case}
Figure~\ref{fig:4o} demonstrates GPT-4o with default setting to successfully solve challenge \texttt{target\_practice}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/4o1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/4o2.pdf}
    \caption{Demonstration of successful solution with GPT-4o}
    \label{fig:4o}
\end{figure}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/4o3.pdf}
%     \caption{Demonstration of using GPT-4o with default setting to successfully solve challenge \texttt{target\_practice}.}
%     \label{fig:4o3}
% \end{figure}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/turbo1.pdf}
%     \label{fig:turbo1}
% \end{figure}

\subsection{GPT-4 Turbo failed case}
Figure~\ref{fig:turbo} demonstrates GPT-4 Turbo with default setting to try solving challenge \textit{target\_practice}, however the executors do not find the flag and decide to giveup.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/turbo1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/turbo2.pdf}
    \caption{Demonstration of failed solution with GPT-4 Turbo}
    \label{fig:turbo}
\end{figure}

% \begin{figure}[H]
%     \centering
    
%     \label{fig:llama1}
% \end{figure}

\subsection{LLaMa 3.1 405B failed case}
Figure~\ref{fig:llama} demonstrates LLaMa 3.1 405B with default setting to try solving challenge \textit{target\_practice}, however the executors do not find the flag and decide to giveup.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/llama1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/llama2.pdf}
    \caption{Demonstration of failed solution with LLaMa 3.1 405B}
    \label{fig:llama}
\end{figure}

\subsection{Gemini 1.5 Flash failed case}
Figure~\ref{fig:gemini} demonstrates Gemini 1.5 Flash with default setting to try solving challenge \textit{target\_practice}, however the executors do not finish the task and do not provide a summary.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/gemini1.pdf}
    \includegraphics[width=0.49\linewidth]{figures/appendix/comparison/gemini2.pdf}
    \caption{Demonstration of failed solution with Gemini 1.5 Flash}
    \label{fig:gemini}
\end{figure}

% \clearpage
% \newpage
\section{Failure demonstration}
\label{sec:failure_demo}
That section contains examples of the failures discussed in Section~\ref{sec:other_failure}. For each type of failure identified, we provided a representative example from the experiment to illustrate the nature of the issue in detail. By analyzing these examples, we aim to provide a comprehensive understanding of the failure types and their impact on the overall system performance.

\subsection{Calling non-existent function}
Figure~\ref{fig:run_unexistent_tool} shows the model tries to call a function \textit{decode} that is not provided in D-CIPHER's tool set on challenge \textit{babycrypto}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{figures/appendix/call_unexistent_tool.pdf}
    \caption{Calling non-existent functions}
    \label{fig:run_unexistent_tool}
\end{figure}

\subsection{Call command line tools before installation}
Figure~\ref{fig:call_uninstalled_cmd} shows the model tries to call ndisasm tool before install nasm package on challenge \textit{realism}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{figures/appendix/call_uninstalled_cmd.pdf}
    \caption{Call command line tools before installation}
    \label{fig:call_uninstalled_cmd}
\end{figure}

\subsection{Running non-existent commands}
Figure~\ref{fig:run_unexistent_cmd} shows the model tries to use radar2 to analyze a binary program with command pd and px, but run these commands by mistake before entering radar2 interface on challenge \textit{a\_walk\_through\_x86\_part\_1}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{figures/appendix/call_unexistent_cmd.pdf}
    \caption{Running non-existent commands}
    \label{fig:run_unexistent_cmd}
\end{figure}


% \begin{figure}[H]
%     \centering
%     \includegraphics[width=\linewidth]{figures/appendix/failed_function_call.pdf}
%     \caption{Failed to generate function call on challenge \textit{thoroughlyStripped}, the model generated a wrong function calling structure.}
%     \label{fig:fail_function_call}
% \end{figure}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=\linewidth]{figures/appendix/fail_connection.pdf}
%     \caption{Hallucination on server information on challenge \textit{pwnvoltex}, the challenge does not require any challenge server access but the planner provides nonexisted server information for executors to take action due to its hallucination from misleading local challenge files.}
%     \label{fig:fail_connection}
% \end{figure}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=\linewidth]{figures/appendix/failed_autoprompting.pdf}
%     \caption{Auto prompting Agent fail to generate on challenge \textit{adversarial}, the autoprompter runs prompts to obtain extra information but due to the mistakes in command generation the autoprompter does not get enough information to generate a prompt}
%     \label{fig:fail_autoprompting}
% \end{figure}

\subsection{Reverse error}
Figure~\ref{fig:fail_reverse} shows model tries to extract a function called \textit{\_Z1AIPhEvT\_} from decompiler, which is a weak symbol. In this challenge, the weak symbol may be overridden by a strong symbol, causing the decompiler to fail to locate the function on challenge \textit{arevenge}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\linewidth]{figures/appendix/reverse_failure.pdf}
    \caption{Reverse error}
    \label{fig:fail_reverse}
\end{figure}

\subsection{Lack of tool support}
Figure~\ref{fig:unsupported_tool} shows agent fails to complete the \textit{baby\_boi} challenge with GPT-4o due to the use of an unsupported tool.
\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{figures/appendix/unsupported_tool.pdf}
    \caption{Lack of tool support}
    \label{fig:unsupported_tool}
\end{figure}

% \clearpage
% \newpage

\section{Cost statistics}
\label{sec:appendix_cost}
This section presents a category-wise comparison of the average costs incurred by EnIGMA and D-CIPHER, including both the costs for successful solutions and the overall costs for all solutions, as a supplement to Section~\ref{sec:cost_analysis}.
\input{figures/overall_cost_compared_enigma}

\input{figures/success_cost_compared_enigma}

\begin{figure}[H]
    \centering
    \vspace{-4mm}
    \includegraphics[width=0.94\linewidth]{figures/cost_comparison.pdf}
    \label{fig:cost_compare_bar}
    \caption{Comparison of average cost of solved challenges and overall average cost of D-CIPHER and EnIGMA on NYU CTF Bench.}
    % \vspace{-6mm}
\end{figure}

\section{Failure statistics}
\label{sec:appendix_failure}
This section provides a category-wise comparison of failure statistics across all five models, focusing on three types of failures: Max Rounds, Max Cost, and Give Up. The experiment using D-CIPHER with the default setup on the NYU CTF Bench serves as a supplement to Section~\ref{sec:analysis}.

\input{figures/common_failure}

\input{figures/give_up_analysis}