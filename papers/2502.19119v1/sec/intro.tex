\section{Introduction}\label{sec:intro}

Retrosynthesis is a fundamental technique in organic chemistry that involves designing synthetic routes for a target molecule by working backwards from the desired product to commercially available starting materials. It is of great importance as it allows chemists to discover novel reactions for scarce or even brand-new molecules, optimize existing synthesis pathways, and circumvent processes that are costly, risky, and time-consuming~\citep{subbaraman2011flawed,struble2020current}.

Despite the critical role of retrosynthesis in organic chemistry, developing machine learning (ML) models for retrosynthesis presents significant challenges. Chief among these is the necessity for extensive chemical reaction datasets~\citep{zhang2024retrosynthesis}, the compilation of which entails considerable expense. This expense arises from the requirement for specialized equipment, skilled labor, and material resources, as well as the conversion of unstructured records into structured data. While a limited number of chemical reaction datasets are available open source~\citep{lowe2012extraction,Lowe2017}, the majority are proprietary, maintained by commercial entities~\citep{goodman2009computer,lawson2014making,mayfield2017pistachio}. Furthermore, companies may develop new chemical reactions crucial for advancing key fields (\eg, materials~\citep{bozbag2012synthesis,fayette2014chemical}, drugs~\citep{blakemore2018organic}, and energy solutions~\citep{binder2009simple,poizot2011clean}), but are often hesitant to share this data. This proprietary stance is primarily due to two reasons. On the one hand, reaction data is often sensitive and confidential, as it may reveal proprietary or classified information that belongs to a specific entity or organization~\citep{shimizu2015privacy,simm2021splitting}. For example, a pharmaceutical company may want to protect its findings that leads to the synthesis of a new drug, or a government agency may want to safeguard its reaction data that relates to their future development. On the other hand, reaction data is often valuable and competitive~\citep{muetterties1977molecular,schooler2011unpublished}, which may confer an advantage or disadvantage to a certain entity or organization. For instance, a rival company may want to gain insight into the developed reactions of its competitors to gain an edge in the market, or a hostile state may want to access the frequently used reactions of its adversary to prepare for competitions in advance. 







As aforementioned, only a limited number of retrosynthesis datasets are available openly, and sharing chemical reaction data with external parties might expose sensitive information (products, processes, intellectual property, \etc.), which may cause compromised interests and unfair competition. This often leads to the emergence of ``data islands'' where data collected in different organizations remains siloed and inaccessible to the broader research community. Such fragmentation impedes progress significantly, as the collective benefit of shared insights is lost, slowing the pace of scientific discovery and application. Therefore, there is a pressing need to develop frameworks for privacy-preserving retrosynthesis learning that enable the sharing of valuable knowledge without compromising proprietary information. Developing such frameworks would facilitate a collaborative environment conducive to the advancement of retrosynthesis while addressing both privacy and competitive concerns. Despite its clear benefits for the scientific community and societal good, this area remains surprisingly under-explored in the existing literature. From an ML perspective, the current standard training paradigm for data-driven retrosynthesis models is to use one global model trained on a large dataset, \ie, learning with centralized data~\citep{coley2017computer,baylon2019enhancing,yan2020retroxpert,sun2021towards,wan2022retroformer,fang2023single}. Nonetheless, this straightforward training regime has two major flaws. Firstly, its performance is limited by the availability, amount, and diversity of annotated reaction data which might be sensitive or proprietary. Secondly, one single global model may not capture the specific characteristics or preferences of each chemical entity, leading to suboptimal prediction performance~\citep{zhang2021personalized,huang2021personalized}. 




To address these challenges, we propose CKIF (\underline{c}hemical \underline{k}nowledge-\underline{i}nformed \underline{f}ramework), a privacy-preserving learning framework that enables collaborative learning among chemical entities without sharing raw reaction data. During the learning process, CKIF maintains data anonymity and only the model parameters are communicated. In terms of data heterogeneity (\eg, different data distributions caused by research focuses and industrial interests), CKIF further investigates the distributed learning paradigm from a client-centric perspective~\citep{wang2019federated,huang2021personalized} and thus learns a personalized model for each client. This necessitates the assessment of a model's effectiveness for different clients, as such evaluations can provide dependable guidance to obtain personalized models. In response, CKIF is equipped with a \underline{c}hemical \underline{k}nowledge-\underline{i}nformed \underline{w}eighting (CKIW) strategy that harnesses symbolic knowledge representations â€”-- specifically, molecule fingerprints like extended-connectivity fingerprint (ECFP)~\citep{rogers2010extended} and molecular access system (MACCS) keys~\citep{durant2002reoptimization}. This strategy adaptively adjusts weights during model aggregation to better align the model with the specific preferences of each chemical entity. Experiments on a variety of reaction datasets demonstrate that CKIF outperforms locally trained models, and even models trained on centralized data. In a nutshell, CKIF ensures data privacy and enhances efficiency by distributing computations across multiple clients. It also supports the training of personalized models for each client and leverages reaction data from diverse clients for scalable model training. These benefits make CKIF a feasible and cost-effective approach to advancing retrosynthesis research in a privacy-aware setting.


 


