\begin{abstract}
%Traditional Fourier-based PDE solvers only work with periodic BCs, and encounter Gibbs phenomena when attempting to model discontinuities. This problem affects all Fourier-based neural operators and must be addressed by each such architecture. The Fourier Neural Operator \cite{li2020FNO} attempts to address this problem with their "bias term" \(Wv(x)\) that operates along-side their Fourier convolution layers. But later work has shown that this solution is imperfect and that the FNO still struggles with discontinuities (e.g. shock waves) \cite{lu2022FNOvsDeepONet}. In this paper we propose another approach based on spatially weighted mixture of experts (an ensemble method), and apply it to a similar "MOR Physics" neural operator \cite{patel2018MOR_Operator} to address the problem of non-periodic boundary conditions and discontinuities. Additionally, we leverage integration with a traditional PDE solver and the ensemble method's natural Uncertainty Quantification to handle the limited Naiver-Stokes DNS data in our dataset.
While Fourier-based neural operators are best suited to learning mappings between functions on periodic domains, several works have introduced techniques for incorporating non trivial boundary conditions. However, all previously introduced methods have restrictions that limit their applicability. In this work, we introduce an alternative approach to imposing boundary conditions inspired by volume penalization from numerical methods and Mixture of Experts (MoE) from machine learning. By introducing competing experts, the approach additionally allows for model selection. To demonstrate the method, we combine a spatially conditioned MoE with the Fourier based, Modal Operator Regression for Physics (MOR-Physics) neural operator and recover a nonlinear operator on a disk and quarter disk. Next, we extract a large eddy simulation (LES) model from direct numerical simulation of channel flow and show the domain decomposition provided by our approach. Finally, we train our LES model with Bayesian variational inference and obtain posterior predictive samples of flow far past the DNS simulation time horizon.\end{abstract}
