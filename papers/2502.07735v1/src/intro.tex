\section{Introduction}
\label{sec:intro}
Generative Flow Networks (GFlowNets, \citealp{bengio2021flow}) are models that aim to sample discrete objects from distributions known up to proportionality constant. They operate by constructing an object through a sequence of stochastic transitions defined
by a forward policy. GFlowNets have been successfully applied in various areas, starting from molecule generation \cite{bengio2021flow} and biological sequence design \cite{jain2022biological} to combinatorial optimization \cite{zhang2023solving} and fine-tuning of diffusion models \cite{uehara2024understanding}. The detailed theoretical foundations of GFlowNets in discrete environments were developed in \cite{bengio2023gflownet}. While the majority of GFlowNet literature consider the discrete setting, it is possible to apply the methodology of continuous GFlowNets \cite{lahlou2023theory} to sampling problems on more general spaces. 
\par 
The main idea behind the generation process in GFlowNets lies in sampling trajectories in the appropriately constructed directed acyclic graph environment instead of working directly in the object space. A standard intuition behind this process is a sequence of actions applied in order to construct a composite object from "blocks". One of the limitations of this setting is that it requires acyclicity. While this limitation can be naturally interpreted in, e.g., molecular generation setting, it can potentially restrict the applicability of GFlowNets in other scenarios, e.g. in standard RL environments or for sampling objects with intrinsic symmetries which are better modeled in a non-acyclic environment, like a Cayley graph of Rubickâ€™s cube. To the best of our knowledge, methodological aspects of working with non-acyclic graphs in GFlowNets were previously considered only in the recent work  \cite{brunswic2024theory}. The latter paper, similarly to \cite{lahlou2023theory}, uses the machinery of measurable spaces and measure theory, which is harder to build new extensions and methodology upon. We believe that simplicity is a key merit of the theory behind discrete GFlowNets~\cite{bengio2023gflownet} when compared to their general state counterparts. Thus, the main aim of our paper is to revisit the theory of non-acyclic GFlowNets with a discrete state space, simplifying the constructions of \cite{brunswic2024theory} and providing additional theoretical and methodological insights into training GFlowNets in this setting. The main contributions of the paper can be summarized as follows:
\vspace{-0.3cm}
\begin{enumerate}[itemsep=-2.2pt,leftmargin=12pt]%[noitemsep, nolistsep]
    \item We present a simple and intuitive way to build a theory of non-acyclic GFlowNets in discrete environments from scratch. In addition to simplicity, our construction introduces and clarifies a number of key points regarding similarities and dissimilarities between acyclic and non-acyclic discrete GFlowNets that were not explored in \cite{brunswic2024theory}, in particular regarding the nature of flows and importance of backward policies.
    \item We show that when the backward policy is fixed, the loss stability introduced by \cite{brunswic2024theory} does not impact the result of the optimization procedure. The latter becomes important only when the backward policy is also being trained. 
    \item When backward policy is trained, we show that learning a non-acyclic GFlowNet with the smallest expected trajectory length is equivalent to learning a non-acyclic GFlowNet with the smallest total flow. In addition, we propose state flow regularization as a way to approach the arising optimization problem.
    \item We empirically show that the scale in which flow error is computed in the loss plays a crucial role in its stability. However, we also show that using an unstable loss with the proposed state flow regularization can lead to better sampling quality.
    \item Finally, we generalize the key theoretical result of \cite{tiapkin2024generative} on the equivalence between GFlowNets and entropy-regularized RL to the non-acyclic setting.
\end{enumerate}


