 
\documentclass[12pt, a4paper]{article}

\usepackage[margin=2.4cm]{geometry}  % page formatting
\usepackage{amssymb, amsfonts, amsmath, amsthm, amsxtra}  % maths tools
\usepackage{thmtools, thm-restate}  % improved thm declarations, restate theorems
\usepackage{graphics, graphicx}  % pictures
\usepackage{old-arrows}  % old arrows (longer)
\usepackage{tabularx}  % width of columns
\usepackage{enumerate}  % list customization
\usepackage{authblk}  % authors formatting
\usepackage{hyperref}  % links coloring
\usepackage{xcolor}  % define colors

% ---- colors ---- %

\definecolor{exodus}{RGB}{104, 109, 224}  % blue/purple
\definecolor{asbestos}{RGB}{127, 140, 141}  % light grey
\definecolor{crimson}{RGB}{162, 0, 37}
\definecolor{lightcyan}{RGB}{0, 172, 193}
\definecolor{lightpurple}{RGB}{126, 87, 194}

\hypersetup{
	colorlinks=true,
	citecolor=lightcyan,
	linkcolor=lightpurple,
	urlcolor=lightpurple
}

% ---- variables ---- %

\def\FIGcarpet{1.05}  % fig:carpet
\def\FIGleaf{1.05}  % fig:leaf
\def\FIGSgluing{1.05}  % fig:S7-gluing
\def\FIGSrelaxed{1.05}  % fig:S7-relaxed
\def\FIGEgenstructure{0.93}  % fig:E-gen-structure
\def\FIGSDmfail{1.05}  % fig:SDm-fail

% to manage qed symbols
\def\arxiv{1}

% ---- Shortcuts ---- %

\newcommand{\cc}[1]{\mathcal{#1}}  % calligraphic
\newcommand{\cb}[1]{\mathbb{#1}}  % doubled (IN, IR, ...)
\newcommand{\cbf}[1]{\mathbf{#1}}  % bold
\newcommand{\cf}[1]{\mathfrak{#1}}  % fraktur
\newcommand{\csf}[1]{\textsf{#1}}  % sans serif
\newcommand{\csmc}[1]{\textsc{#1}}  % small caps
\newcommand{\ctt}[1]{\texttt{#1}}  % text tt
\newcommand{\nf}[1]{{\normalfont #1}}  % normal font

\newcommand{\mtt}[2]{\texorpdfstring{#1}{#2}}  % maths in title (#1 latex, #2 pdf)

% ---- Maths macros ---- %

\newcommand{\NP}{\mathbf{NP}}  % NP (for complexity)
\newcommand{\st}{:}  % such that (could be \st)

% == Set systems

\newcommand{\U}{S}  % universe
\newcommand{\pow}[1]{\mathbf{2}^{#1}}  % powerset
\newcommand{\card}[1]{\vert #1 \vert}  % cardinal of a set

% == Lattices 

\newcommand{\SDj}{\mathrm{SD}_j}  % SDjoin
\newcommand{\SDm}{\mathrm{SD}_m}  % SDmeet
\newcommand{\SD}{\mathrm{SD}}  % SD

\DeclareMathOperator{\ftr}{\uparrow\!}  % filter
\DeclareMathOperator{\idl}{\downarrow\!}  % ideal
\DeclareMathOperator{\upp}{\uparrow}  % up-perspective
\DeclareMathOperator{\downp}{\downarrow}  % down-perspective
\DeclareMathOperator{\dpp}{\updownarrow}  % double-perspective
\DeclareMathOperator{\mt}{\land}  % meet
\DeclareMathOperator{\jn}{\lor}  % join

% == Closure operators, closure systems

\newcommand{\cl}{\phi}  % closure operator
\newcommand{\cs}{\cc{C}} % closure system
\newcommand{\gen}{\mathrm{gen}}  % generators

% == Implicational bases

\newcommand{\imp}{\rightarrow}  % implication arrow
\newcommand{\is}{\Sigma}  % implicational base

% ---- environments ---- %

\declaretheorem[name=Theorem, style=plain]{rsttheorem}
\declaretheorem[name=Theorem, style=plain]{theorem}
\declaretheorem[name=Lemma, style=plain]{lemma}
\declaretheorem[name=Corollary, style=plain]{corollary}
\declaretheorem[name=Proposition, style=plain]{proposition}
\declaretheorem[name=Definition, style=definition]{definition}
\declaretheorem[name=Example, style=definition]{example}
\declaretheorem[name=Remark, style=remark]{remark}
\declaretheorem[name=Claim, style=remark]{claim}
\declaretheorem[name=Question, style=plain]{rstquestion}

% ---- writing/debug ---- %

\newcommand{\ka}[1]{\textcolor{magenta}{KA: \em #1}} 
\newcommand{\sv}[1]{\textcolor{blue!70!white}{Simon: \em #1}}

% ---- Hide Proofs ---- %
% \usepackage{environ}
% \NewEnviron{killcontents}{}
% \let\proof\killcontents
% \let\endproof\endkillcontents

%\titleformat{\paragraph}[runin]{\it}{}{}{}




% ---- document ---- %

\title{The $E$-base of finite semidistributive lattices%
\footnote{Version submitted to \href{https://concepts2025.conference.ubbcluj.ro/}{CONCEPTS 2025}. The extended version will include more insights on Question \ref{ques:E-valid} such as classes of lattices where $E$-base is not valid.
It will also feature computational results regarding the $E$-relation.}}

\author[1]{Kira Adaricheva}
\author[2]{Simon Vilmin}

\affil[1]{Department of Mathematics, Hofstra University, Hempstead, NY 11549, USA.}
\affil[2]{Aix-Marseille Universit√©, CNRS, LIS, Marseille, France.}

\begin{document}
\maketitle


\begin{abstract}
Implicational bases (IBs) are a well-known representation of closure spaces and their closure lattices.
This representation is not unique, though, and a closure space usually admits multiple IBs.
Among these, the canonical base, the canonical direct base as well as the $D$-base aroused significant attention due to their structural and algorithmic properties.
Recently, a new base has emerged from the study of free lattices: the $E$-base.
It is a refinement of the $D$-base that, unlike the aforementioned IBs, does not always accurately represent its associated closure space.
This leads to an intriguing question: for which classes of (closure) lattices do closure spaces have a valid $E$-base?
Lower bounded lattices are known to form such a class.
In this paper, we prove that for semidistributive lattices, the $E$-base is both valid and minimum.

\ifx\arxiv\undefined
\keywords{Implicational bases \and closure spaces \and $E$-base \and semidistributive lattices}
\else
\vspace{.5em}
\noindent \textbf{Keywords:} Implicational bases, closure spaces, $E$-base, semidistributive lattices
\fi
\end{abstract}


\section{Introduction}

Implicational bases (IBs) are a well-known representation of finite closure spaces and their closure lattices. 
Indeed, implications go by many names in a broad range of fields, e.g.\ attribute implications in Formal Concept Analysis \cite{ganter2012formal}, functional dependencies in database theory \cite{maier1980minimum,mannila1992design}, Horn clauses in propositional logic \cite{crama2011boolean}, or join-covers in lattice theory \cite{freese1995free,gratzer2011lattice}.
Since a closure space admits several IBs in general, a rich development of implications, summarized in two surveys \cite{bertet2018lattices,wild2017joy}, emerged from this variety of perspectives.
Moreover, recent contributions \cite{adaricheva2024computing,berczi2024hypergraph,bichoupan2023independence} show that IBs are still an active topic of research.
Among possible IBs, two have attracted interest due to their structural and algorithmical properties.
First, the canonical (or Duquenne-Guigues) base \cite{guigues1986familles,wild1994theory,day1992lattice}, has a minimum number of implications and is reflected in any other (minimum) IB by means of pseudo-closed sets.
Second, the canonical direct base, surveyed in \cite{bertet2010multiple}, is the smallest (unit) IB enjoying directness, being the property of computing closures with only one pass over the implications.

Translating the language of join-covers in (free) lattices \cite{freese1995free} into implications, Adaricheva et al.~\cite{adaricheva2013ordered} recently introduced two new specimens in the zoo of IBs: the $D$-base and the $E$-base.
These bases find their origin in lattice theory where special relations between join-irreducible elements were developed to tackle notoriously hard problems.
The history begins at the cross-section of P.~Whitman's conjecture\footnote{He asked his question in the same paper where he solved the fundamental problem of G. Birkhoff \cite{birkhoff1935structure} about representing lattices by equivalence relations.} related to lattices of partitions \cite{whitman1946lattices} and B.~J\'onsson's conjecture about the structure of finite sublattices of free lattices \cite{jonsson1962finite}.
On their way to solve the first problem, Pudl\`ak and T\r{u}ma used a special binary relation on join-irreducible elements, called the $C$-relation \cite{pudlak1974yeast}.
Only a few years later, they solved Whitman's problem in a celebrated paper \cite{pudlak1980every}.
While working on J\'onsson's conjecture, Day~\cite{day1979characterizations} used the $C$-relation, which became the $D$-relation when the solution to the problem---brought by Nation in his famous paper \cite{nation1982finite}---was incorporated to the monograph on free lattices of Freese, Nation and Je\v{z}ek~\cite{freese1995free}.
There, the authors highlighted the connection between the $D$-relation and the so-called minimal join-covers that will later become the $D$-base.
In investigating lattices without $D$-cycles (cycles in the $D$-relation), they also unveiled an important subset of minimal join-covers along with a subset of the $D$-relation, which they called the $E$-relation. 
This subset of join-covers will become what is now known as the $E$-base.

The $D$-base is a subset of the canonical direct base that still enjoys directness as long as implications are suitably ordered.
It already proved its efficiency in a handful of data analysis applications \cite{adaricheva2015measuring,adaricheva2017discovery,adaricheva2023importance,nation2021combining} and its algorithmic aspects have been addressed in a recent paper~\cite{adaricheva2024computing}.
The $E$-base on the other hand is a refinement of the $D$-base obtained by retaining implications satisfying a minimality criterion within the closure lattice.
Borrowing tools from free lattices \cite{freese1995free}, especially the $D$-relation, Adaricheva et al.~\cite{adaricheva2013ordered} show that in closure spaces without $D$-cycles, the $E$-base is a valid IB. 
Furthermore, the main property of the $D$-base, its feature of directness, is still retained in the $E$-base of such spaces. 
Even more importantly, the number of implications in the (aggregated) $E$-base is the same as in the canonical base, making it minimum.
Yet, unlike the $D$-base and other mentioned IBs, the $E$-base does not always encode faithfully its closure space.
This prompts the next stimulating question, which constitutes the main motivation of our paper:

\begin{rstquestion}[restate=QUESE-valid, label=ques:E-valid]
For what classes of (closure) lattices do closure spaces have valid $E$-base?
\end{rstquestion}

For such classes, the $E$-base could be a base of choice given that it is shorter than the $D$-base and may still possess the advantages the $D$-base has over other existing bases. 
Surprisingly, a seemingly unrelated result of Wild \cite[Theorem 11]{wild1994theory} yields as a direct corollary that the $E$-base is also valid in closure lattices of binary matroids. 
With lattices without $D$-cycles, these are to our knowledge the only (major) classes of lattices whose associated closure spaces have valid $E$-base.

In this contribution, we investigate closure spaces with semidistributive closure lattices, that is, closure lattices satisfying both meet and join-semidistributive laws $\SDm$ and $\SDj$ (resp.).
These laws are intimately connected with classes of lattices involved into Whitman's and J\'onsson's conjectures.
Our main result is the next theorem.


\begin{rsttheorem}[restate=THMEvalidSD, label=thm:E-valid-SD]
The (aggregated) $E$-base of a standard closure space with a semidistributive closure lattice is valid and minimum.
\end{rsttheorem}

Remark that the $E$-base might not be valid in a closure lattice enjoying only one law, $\SDj$ or $\SDm$ (see Examples \ref{ex:leaf} and \ref{ex:SDm-fail}). 
Since $\SD$ lattices do have $D$-cycles, we cannot leverage from the approach used in \cite{freese1995free,adaricheva2013ordered} to prove Theorem \ref{thm:E-valid-SD}.
Instead, we show how the $E$-base relates to the pseudo-closed sets of the canonical base \cite{guigues1986familles} using the properties of semidistributivity.


\paragraph{Organization of the paper.} In Section \ref{sec:preliminaries} we give necessary definitions and properties regarding closure spaces, lattices and implications.
In Section \ref{sec:E-base}, we introduce the $E$-base.
We provide examples to illustrate how it can fail being a valid IB of its associated closure Moreover, we put the light on its relationships with other IBs, especially the canonical base.
Section \ref{sec:proof} is devoted to the proof of Theorem \ref{thm:E-valid-SD}.
We conclude the paper in Section \ref{sec:conclusion} with a question for future works.

\section{Preliminaries} \label{sec:preliminaries}

All the objects we consider in this paper are finite.
We assume basic familiarity with lattices and closure systems and redirect the reader to \cite{gratzer2011lattice} for an introduction to the topic.
If $\U$ is a set, $\pow{\U}$ denotes its powerset.
Whenever a singleton set $\{X\}$ or $\{x\}$ is used, we may withdraw brackets and use $X$ and $x$ to simplify notations.
Sometimes, mostly in examples, we write a set as the concatenation of its elements, e.g.\ $abc$ instead of $\{a, b, c\}$.

\paragraph{Closure spaces.}
A \emph{closure operator} over $\U$ is a map $\cl \colon \pow{\U} \to \pow{\U}$ that satisfies the following properties for all $X, Y \subseteq \U$: (1) $X \subseteq \cl(X)$, (2) $\cl(\cl(X)) = X$ and (3) $\cl(X) \subseteq \cl(Y)$ if $X \subseteq Y$.
The pair $(\U, \cl)$ is a \emph{closure space}.
Let $\cs$ denote the fixpoints of $\cl$, i.e.\ $\cs = \{C \st C \subseteq \U, \cl(C) = C\}$.
The members of $\cs$ are called \emph{closed sets}.
The pair $(\U, \cs)$ is a \emph{closure system}, that is $\U \in \cs$ and $C_1 \cap C_2 \in \cs$ whenever $C_1, C_2 \in \cs$.
Note that $\cl(X) = \min_{\subseteq}\{C \st C \in \cs, X \subseteq C\} = \bigcap \{C \st C \in \cs, X \subseteq C\}$ for all $X \subseteq \U$.
The closure space $(\U, \cl)$ is \emph{standard} if $\cl(x) \setminus \{x\}$ is closed for every $x \in \U$.

\begin{remark}
Unless otherwise stated, we assume that all closure spaces are standard.
\end{remark}

Let $C \in \cs$.
A \emph{spanning set} of $C$ is any subset $X$ of $\U$ such that $\cl(X) = C$.
We say that $X$ \emph{spans} $C$. 
For $x \in \U$, a \emph{(non-trivial) generator} of $x$ is a subset $Y$ of $\U$ such that $x \notin Y$ but $x \in \cl(Y)$.
We say that $Y$ \emph{generates} $x$.
The family of inclusion-wise minimal generators of $x$ is denoted $\gen(x)$.

Let $(\U, \cl)$ be a closure space.
The \emph{binary part} of $(\U, \cl)$ is the closure space $(\U, \cl^b)$ defined for all $X \subseteq \U$ by:
%
\[ 
\cl^b(X) = \bigcup_{x \in X} \cl(x)
\]
%
Observe that any closed set of $\cs$ is also closed for $\cl^b$, or equivalently, $\cl^b(X) \subseteq \cl(X)$ for all $X \subseteq \U$.
Given $X, Y \subseteq \U$, $X$ is a \emph{$\cl^b$-refinement} of $Y$ if $\cl^b(X) \subseteq \cl^b(Y)$. 
If $\cl^b(X) \subset \cl^b(Y)$, $X$ is a \emph{proper} $\cl^b$-refinement of $Y$.
Let $C \in \cs$.
A $\cl^b$-minimal spanning set of $C$ is a spanning set $A$ of $C$ such that for any proper $\cl^b$-refinement $B$ of $A$, $B$ does not span $C$.
Since $B \subseteq A$ entails $\cl^b(B) \subseteq \cl^b(A)$, a $\cl^b$-minimal spanning set of $C$ is also a minimal spanning set of $C$.
Let $x \in \U$.
A \emph{(non-trivial) $\cl^b$-generator} $A$ of $x$ is a set $A$ such that $x \in \cl(A)$ but $x \notin \cl^b(A)$.
In particular, a $\cl^b$-generator $A$ of $x$ is a \emph{$D$-generator} of $x$ if it is $\cl^b$-minimal for this property, that is, $x \notin \cl(B)$ for any proper $\cl^b$-refinement $B$ of $A$.
The collection of $D$-generators of $x$ is denoted $\gen_D(x)$.
Observe that a $\cl^b$-generator of $x$ which is at the same time a $\cl^b$-minimal spanning set of its closed set needs not be a $D$-generator of $x$.
A set $Q \subseteq \U$ is \emph{quasi-closed} w.r.t.~$\cl$ if for $X \subseteq Q$, $\cl(X) \subset \cl(Q)$ entails $\cl(X) \subseteq Q$.
Remark that if $\cl(Q) \neq \cl(x)$ for any $x \in \U$, then $Q$ is $\cl^b$-closed.
Indeed, for $x \in Q$, $\cl^b(x) = \cl(x) \subset \cl(Q)$ holds by assumption, so that $\cl^b(x) \subseteq Q$ follows.
If $P \subseteq \U$ is not closed and an inclusion-wise minimal quasi-closed set among the spanning sets of $\cl(P)$, it is \emph{pseudo-closed}.
The closed set $\cl(P)$ is \emph{essential}.


\paragraph{Closure lattices.}
Let $(\U, \cl)$ be a closure space.
The poset $(\cs, \subseteq)$ is a \emph{(closure) lattice} where $C_1 \mt C_2 = C_1 \cap C_2$ and $C_1 \jn C_2 = \cl(C_1 \cup C_2)$.
It is well-known that each lattice is isomorphic to a closure lattice.
In $(\cs, \subseteq)$, a \emph{predecessor} of $C \in \cs$ is a closed set $C_*$ such that $C_* \subset C$ and for every closed set $C'$, $C_* \subset C' \subseteq C$ means $C' = C$.
The \emph{successors} of $C$ are defined dually.
We write $C_* \prec C$ to denote that $C_*$ is a predecessor of $C$ and $C^* \succ C$ to denote that $C^*$ is a successor of $C$. 
For $\cs' \subseteq \cs$, the \emph{ideal} $\idl \cs'$ of $\cs'$ in $(\cs, \subseteq)$ is given by $\idl \cs' = \{C \st C \in \cs, C \subseteq C' \text{ for some } C' \in \cs'\}$.
The \emph{filter} $\ftr \cs'$ of $\cs'$ is defined dually.

We define irreducible closed sets.
A closed set $J$ is \emph{join-irreducible}, \emph{ji} for short, if $J \neq \emptyset$ and for every $C_1, C_2 \in \cs$, $J = C_1 \jn C_2$ implies $J = C_1$ or $J = C_2$.
Equivalently, $J$ is ji iff it has a unique predecessor $J_*$.
Since $(\cs, \subseteq)$ is assumed standard, $J$ is ji if and only if $J = \cl(x)$ for some $x \in \U$.
As $\cl(x) \neq \cl(y)$ for $x \neq y$, $\cl$ is a bijection between $\U$ and the ji's of $(\cs, \subseteq)$.
Thus, for simplicity, we will identify $x$ with its closure $\cl(x)$ and say that $x$ is ji in $\cs$ with predecessor $x_*$.
A closed set $M$ is \emph{meet-irreducible}, \emph{mi} for short, if $M \neq \U$ and $M = C_1 \cap C_2$ implies $M = C_1$ or $M = C_2$ for any $C_1, C_2 \in \cs$.
Similarly to ji's, $M$ is mi if and only if it has a unique successor $M^*$.
An \emph{atom} of $(\cs, \subseteq)$ is a successor of $\emptyset$ ($\emptyset \in \cs$ since $(\U, \cl)$ is standard).
Dually, a \emph{coatom} is a predecessor of $\U$ in $(\cs, \subseteq)$.
Atoms are ji singletons, while coatoms are mi.

We move to arrow relations \cite{ganter2012formal}.
Let $J, M \in \cs$.
We write $J \upp M$ if $M$ is an inclusion-wise maximal closed set not containing $J$ as a subset, that is $J \nsubseteq M$ but $J \subseteq M'$ for every $M' \in \cs$ such that $M \subset M'$.
Note that $J \upp M$ implies that $M$ is mi.
Dually we write $J \downp M$ if $J \nsubseteq M$ but $J' \subseteq M$ for every $J' \subset J$ in $\cs$.
Similarly, $J \downp M$ entails that $J$ is join-irreducible. 
We write $J \dpp M$ if $J \upp M$ and $J \downp M$.
If $J$ is ji, we may write $x \upp M$, $x \downp M$ and $x \dpp M$ where $x$ is the unique element of $\U$ such that $J = \cl(x)$.
We turn our attention to prime and coprime elements \cite{markowsky1992primes}\footnote{The definition of primes and coprimes is switched w.r.t.~\cite{markowsky1992primes}.
In our context it is more natural to consider elements of $\U$ as primes rather than coprimes, since we will mostly use this aspect of primality.}.
A closed set $C$ is \emph{prime} in $(\cs, \subseteq)$ if for every $C_1, C_2 \in \cs$, $C \subseteq C_1 \jn C_2$ implies $C \subseteq C_1$ or $C \subseteq C_2$.
Prime elements must be ji, hence we say $x \in \U$ is prime if $\cl(x)$ is.
Equivalently, $x$ is prime if and only if there exists a unique mi $M$ such that $x \upp M$, in particular $x \dpp M$ must hold.
Moreover, $x$ is prime if and only if it admits only singleton minimal generators, i.e.~$\gen(x)$ contains only singleton sets.
Dually, a closed set $M$ is \emph{coprime} if for all $C_1, C_2 \in \cs$, $C_1 \cap C_2 \subseteq M$ implies $C_1 \subseteq M$ or $C_2 \subseteq M$. 
A coprime $M$ must be mi and there is a unique $J$ such that $M \downp J$, in particular it holds $J \dpp M$.
If $J$ is prime, the unique $M$ such that $J \dpp M$ is coprime.
Thus, $\dpp$ defines a bijection between prime and coprime closed sets.

A lattice $(\cs, \subseteq)$ is \emph{join-semidistributive} ($\SDj$) if for all $C_1, C_2, C_3 \in \cs$, 
$C_1 \jn C_2 = C_1 \jn C_3$ entails $C_1 \jn C_2 = C_1 \jn (C_2 \mt C_3)$.
\emph{Meet-semidistributivity} ($\SDm$) is defined dually by flipping $\mt$ and $\jn$ operations.
The lattice $(\cs, \subseteq)$ is \emph{semidistributive} ($\SD$) if it is both meet and join-semidistributive.
We now recall useful properties regarding semidistributivity.

\begin{theorem}[Theorem 2.1, Corollary 2.2 in \cite{jonsson1962finite}, Corollary 1 in \cite{gorbunov1978canonical}] \label{thm:SDj-canonical}
The lattice of a (finite) closure space $(\U, \cl)$ is $\SDj$ if and only if each closed set $C$ has a unique $\cl^b$-minimal spanning set.
\end{theorem}

In the rest of the paper, we call this unique $\cl^b$-minimal spanning set the \emph{canonical spanning set} of $C$.

\begin{proposition}[Proposition 49 in \cite{adaricheva2014implicational}] \label{prop:SDj-UC}
In a closure space with $\SDj$ lattice, each essential closed set is spanned by a unique pseudo-closed set.
\end{proposition}

In particular, this pseudo-closed subsumes the canonical representation of its closure.

\begin{theorem}[Corollary 2.55, Theorem 2.56 in \cite{freese1995free}] \label{thm:SD-arrows}
Let $(\U, \cl)$ be a closure space with lattice $(\cs, \subseteq)$.
\begin{enumerate}[(1)]
    \item $(\cs, \subseteq)$ is $\SDj$ if and only if for every meet-irreducible $M$ there exists a unique $x \in \U$ such that $x \dpp M$.
    \item $(\cs, \subseteq)$ is $\SDm$ if and only if for every $x \in \U$, there exists a unique meet-irreducible $M$ such that $x \dpp M$.
    \item $(\cs, \subseteq)$ is $\SD$ if and only if $\dpp$ is bijection between $\U$ and meet-irreducible closed sets.
\end{enumerate}
\end{theorem}

\begin{theorem}[Theorem 1 in \cite{gorbunov1978canonical}] \label{thm:coatoms-SDj}
Let $(\U, \cl)$ be a (finite) closure space with $\SDj$ lattice $(\cs, \subseteq)$.
Let $M_1, \dots M_k$ be the coatoms of $(\cs, \subseteq)$.
Then, for all $1 \leq i \leq k$, $M_i$ is coprime and $A = \{a_1, \dots, a_k\}$, where $a_i$ is the unique (prime) $a_i$ such that $a_i \dpp M_i$, is the canonical spanning set of $\U$.
\end{theorem}

Observe that the last statement is proved in the more general case of complete strongly atomic lattices with the continuity condition.

\paragraph{Implicational bases (IBs).} 
We refer to \cite{bertet2018lattices,wild2017joy} for a more detailed introduction to the topic.
An \emph{implication} over $\U$ is a statement $A \imp X$, with $A, X \subseteq \U$.
In $A \imp X$, $A$ is the \emph{premise} and $X$ the $\emph{conclusion}$.
An implication $A \imp x$, $x \in \U$, is a \emph{(right) unit implication}.
If both $A$ and $X$ are singletons, the implication is \emph{binary}.
An \emph{implicational base} (IB) is a pair $(\U, \is)$ where $\is$ is a set of implications over $\U$.
An IB is unit (resp.~binary) if all its implications are unit (resp.~binary).
The \emph{aggregation} or \emph{aggregated form} of a unit IB $(\U, \is)$ is obtained by replacing all implications with the same premise by a single implication with unified conclusions.

An IB induces a closure space $(\U, \cl)$ where a subset $C$ of $\U$ is closed if and only if $A \subseteq C$ implies $X \subseteq C$ for all $A \imp X \in \is$.
Dually, each closure space $(\U, \cl)$---each lattice $(\cs, \subseteq)$---can be represented by several \emph{equivalent} IBs.
An implication $A \imp X$ holds in $(\U, \cl)$ if and only if $X \subseteq \cl(A)$.
In particular, the binary part of $(\U, \cl)$ can be represented by the binary IB $(\U, \is^b)$ gathering all valid (non-trivial) binary implications, that is $\is^b = \{a \imp x \st x \in \cl(a), x \neq a\}$.
An IB $(\U, \is)$ is \emph{valid} for $(\U, \cl)$ if the closure space associated to $(\U, \is)$ is indeed $(\U, \cl)$.
Among the possible IBs of $(\U, \cl)$, and besides the $E$-base, we will mention three:
\begin{itemize}
\item the \emph{canonical} or \emph{Duquenne-Guigues base} $(\U, \is_{DG})$ \cite{guigues1986familles}.
It is defined from pseudo-closed sets as follows: 
%
\[ \is_{DG} = \{P \imp \cl(P) \setminus P \st P \text{ is pseudo-closed}\}. \]
This IB is \emph{minimum}, it has the least number of implications among all other IBs.
The following theorem is well-known and will be useful in the next sections.
%
\begin{theorem}[e.g.~Theorem 5 in \cite{wild1994theory}] \label{thm:canonical}
Let $(\U, \cl)$ be a closure space and let $(\U, \is)$ be an IB for $(\U, \cl)$. 
Then, for any pseudo-closed set $P$ of $(\U, \cl)$, $\is$ contains an implication $A \imp B$ such that $A \subseteq P$ and $\cl(A) = \cl(P)$.
\end{theorem}

\item the \emph{canonical direct base} $(\U, \is_{cd})$ \cite{bertet2010multiple}.
It relies on minimal generators of each element of $\U$.
More precisely, 
%
\[ \is_{cd} = \{A \imp x \st x \in \U, A \in \gen(x)\}.\]

\item the \emph{$D$-base} $(\U, \is_D)$ \cite{adaricheva2013ordered}.
It is defined from $D$-generators and binary implications representing the binary part of $(\U, \cl)$: 
%
\[ \is_D = \is^b \cup \{A \imp x \st x \in \U, A \in \gen_D(x)\}. \]
%
Remark that $\is_D \subseteq \is_{cd}$.
\end{itemize}

\section{The \mtt{$E$}{E}-base and some of its properties} \label{sec:E-base}

In this section, we first introduce the $E$-base in the line of seminal works on these objects \cite{adaricheva2013ordered,freese1995free}.
Then, we exhibit further properties of the $E$-base and connect it with other IBs, especially the canonical base.

We start with the definitions of $E$-generators and $E$-base of a given closure space $(\U, \cl)$.
These definitions translate those of \cite{adaricheva2013ordered,freese1995free} within our terms.

\begin{definition}[$E$-generator] \label{def:E-generator}
Let $(\U, \cl)$ be a closure space and let $x \in \U$.
A subset $A$ of $\U$ is a \emph{$E$-generator} of $x$ if $A$ is a $D$-generator of $x$ and $\cl(A)$ is inclusion-wise minimal in $\{\cl(B) \st B \in \gen_D(x)\}$.
We denote by $\gen_E(x)$ the family of $E$-generators of $x$. We have
%
\[
\gen_E(x) = \{A \st A \in \gen_D(x) \text{ and } \cl(A) \in \min_{\subseteq}\{\cl(B) \st B \in \gen_D(x)\}\}.
\]
%
\end{definition}

In general $\gen_E(x)$ may be empty, much as $\gen_D(x)$.
In fact, this will happen precisely if $x$ is prime in $(\cs, \subseteq)$.
Moreover, as pointed out in \cite{wild2017joy}, $E$-generators share common points with critical generators of convex geometries \cite{korte2012greedoids}.
Convex geometries form a well-known class of closure spaces.
For a convex geometry, a critical generator of some $x$ is a minimal generator $A$ of $x$ whose closure is minimal among the closures of other minimal generators of $x$.
Thus, $E$-generators and critical circuits both asks for minimality in the closure lattice.
Yet, the two objects differ in that $E$-generators rely on $\cl^b$ while critical generators do not.

\begin{definition}[$E$-base] \label{def:E-base}
The \emph{$E$-base} of a closure space $(\U, \cl)$ is the IB $(\U, \is_E)$ where
%
\[ 
\is_E = \is^b \cup \{A \imp x \st x \in \U, A \in \gen_E(x)\}.
\]
%
\end{definition}

By definition, the $E$-base is a subset of the $D$-base.
Henceforth, it is also a subset of the canonical direct base.
Intuitively, the $E$-base is obtained from the $D$-base by ruling out implications spanning closed sets ``too high'' in the closure lattice with respect to a fixed element $x$.
More formally, one obtains the $E$-base from the $D$-base by repeatedly applying the following operation: if $A_1 \imp x, A_2 \imp x$ lie in the non-binary part of $\is_D$ and $\cl(A_1) \subset \cl(A_2)$, then remove $A_2 \imp x$.
%
\begin{example}[see Figure 5.5, p.~111 in \cite{freese1995free}] \label{ex:carpet}
Let $\U = \{a, b, c, d, e, f, g\}$ and consider the closure space $(\U, \cl)$ associated to the lattice of Figure \ref{fig:carpet}.
This lattice is semidistributive.
We build the $E$-base by identifying, for each $x$, $\gen(x)$, $\gen_D(x)$ and finally $\gen_E(x)$. 
\begin{itemize}
    \item $\gen(a) = \{c, e, f, g\}$. 
    Since $\gen_D(x)$ takes into account only non-singleton minimal generators, we have $\gen_D(a) = \emptyset$ and hence $\gen_E(a) = \emptyset$ as well ($a$ is prime). 
    
    \item $\gen(b) = \{d\}$.
    As for $b$, we have $\gen_E(b) = \emptyset$ ($b$ is prime too).
    
    \item $\gen(c) = \{ad, e, f, g\}$.
    Since $ad$ is the unique non-singleton minimal generator of $c$, it must be at the same time a $D$-generator and a $E$-generator for it is $\cl^b$-minimal and minimal with respect to $\cl$.
    Thus, $\gen_E(c) = \{ad\}$.
    
    \item $\gen(d) = \{be, bg\}$.
    We have $\cl^b(bg) = abc\!f\!g$ and $\cl^b(be) = abce$.
    Thus both are $\cl^b$-minimal and $\gen_D(d) = \{be, bg\}$.
    Now to identify $\gen_E(d)$ we need to compare the closures of the $D$-generators of $d$
    We have $\cl(bg) = abcd\!f\!g \subset \U = \cl(be)$. 
    Ruling out $be$, we get $\gen_E(d) = \{bg\}$.
    % \ka{The closure of $be$ is the top, while the closure of $bg$ is smaller element $abcdfg$, therefore, $bg\to d$ is in the $E$-base.}
    
    \item $\gen(e) = \emptyset$ so that $\gen_E(e) = \emptyset$. 
    
    \item $\gen(f) = \{bc, be, cd, ad, de, g\}$.
    Among them, we have $\cl^b(bc) = abc \subset abce = \cl^b(be)$ and $\cl^b(ad) = abd \subset abcd = \cl^b(cd) \subset abcde = \cl^b(de)$.
    Keeping only the $\cl^b$-minimal generators leads to $\gen_D(f) = \{ad, bc\}$.
    We have $\cl(bc) = abc\!f \subset abcdf = \cl(ad)$ which leads to withdraw $ad$.
    We thus have $\gen_E(f) = \{bc\}$.
    
    \item $\gen(g) = \{be, de, e\!f\}$.
    We have $\cl^b(be) = abce \subset abcde =\cl^b(de)$. 
    On the other hand $\cl^b(e\!f) = ace\!f$.
    We obtain $\gen_D(g) = \{be, e\!f\}$.
    Now $\cl(e\!f) = ace\!f\!g \subset abcde\!f\!g = \cl(be)$.
    Henceforth, $\gen_E(g) = \{e\!f\}$.
\end{itemize}
Putting all the parts together, we can build the $E$-base $(\U, \is_E)$ of $(\U, \cl)$.
For readability we aggregate the binary implications:
%
\[ 
\is_E = \left\{ 
\begin{array}{lll}
g \imp ac\!f, & f \imp ac, & e \imp ac, \\
d \imp b, & c \imp a & 
\end{array}\right\} \cup \left\{
\begin{array}{ll}
ad \imp c, & bg \imp d \\
bc \imp f, & e\!f \imp g
\end{array}\right\}.
\] 
%
\begin{figure}[ht!]
    \centering
    \includegraphics[scale=\FIGcarpet]{figures/carpet.pdf}
    \caption{The closure lattice of Example \ref{ex:carpet}. It is semidistributive.}
    \label{fig:carpet}
\end{figure}

\end{example}
%
Unlike the $D$-base though, and as mentioned in the introduction, the $E$-base of a closure space does not always constitute a valid IB.
We give below three increasingly demanding examples that illustrate how the $E$-base can fail to describe a closure space by comparing it to the canonical base. 

\begin{example}[Example 27 in \cite{adaricheva2013ordered}] \label{ex:leaf}
Let $\U = \{a, b, c, d\}$ and consider the closure space $(\U, \cl)$ whose closure lattice is given in Figure \ref{fig:leaf}.
It is $\SDj$ but not $\SDm$.
We have $\is_{DG} = \{ad \imp bc, ac \imp b, bd \imp c\}$.
This coincides with the (aggregated) $D$-base.
The $E$-base is $(\U, \is_E)$ with $\is_E = \{ac \imp b, bd \imp c\}$. 
The implication $ad \imp bc$ does not belong to the (aggregated) $E$-base of $(\U, \cl)$.
Indeed, for $ad \imp c$, we have $bd \imp c$ with $\cl(bd) = bcd \subset abcd = \cl(ad)$.
Similarly for $ad \imp b$, we have $ac \imp b$ in $\is$ with $\cl(ac) = abc \subset abcd = \cl(abcd)$.
It follows that no implication of the $E$-base describes the essential closed set $abcd$.
Since essential sets must be described by any IB, the $E$-base is not valid.
%
\begin{figure}[ht!]
    \centering
    \includegraphics[scale=\FIGleaf]{figures/leaf.pdf}
    \caption{The $\SDj$ closure lattice of Example \ref{ex:leaf}. Black dots are the essential sets: $abc$, $bcd$ and $abcd$. 
    Among them, two are described by the $E$-base. 
    They are highlighted in green.
    The essential set $abcd$, highlighted in red, is not the closure of any $E$-generators.}
    \label{fig:leaf}
\end{figure}
%
\end{example}

The previous example suggests that the $E$-base of a closure space may not be valid because it fails to describe an essential set.
Yet, the next example shows that describing all essential sets is not sufficient for the $E$-base to be valid. 

\begin{example} \label{ex:S7-gluing}
Let $\U = \{a, b, c, d, e\}$ and consider the closure space $(\U, \cl)$ corresponding to the closure lattice of Figure \ref{fig:S7-gluing}.
Its canonical base $(\U, \is_{DG})$ is given by:
%
\[ 
\is_{DG} = \{d \imp c, e \imp c\} \cup \{ac \imp b, bc \imp a, cde \imp ab, abce \imp d\}. 
\]
%
On the other hand, the $E$-base $(\U, \is_E)$ is defined with 
\[ 
\is_E = \{d \imp c, e \imp c\} \cup \{ac \imp b, bc \imp a, ae \imp d, be \imp d\}.
\]
%
\begin{figure}[ht!]
\centering
\includegraphics[scale=\FIGSgluing]{figures/S7-gluing.pdf}
\caption{The closure lattice of Example \ref{ex:S7-gluing}. 
The black dots are the essential sets: $abc$, $cd$, $ce$ and $abcde$.
All are described by the $E$-base. 
Yet, one of the pseudo-closed set spanning $abcde$ does not contain any $E$-generator.
This is shown in the box on the right picturing the spanning sets of $abcde$.
The pseudo-closed set $abce$ subsumes $E$-generators $ae$ and $be$, while $cde$ subsumes none.}%\ka{There might me a green line connecting $cde$ and $de$.}}

\label{fig:S7-gluing}
\end{figure}
%
The essential sets are $cd$, $ce$, $abc$, and $abcde$.
They are all described by the $E$-base.
The pseudo-closed set $cde$ does not contain any $E$-generator as shown in the box of Figure \ref{fig:S7-gluing}.
Henceforth, $(\U, \is_E)$ is not valid.
In fact, $cde$ is even closed w.r.t.~$(\U, \is_E)$.
\end{example}

In the last example, the $E$-base fails to describe the closure space because one of the pseudo-closed sets is not subsumed by any $E$-generator spanning the same essential set.
However, even if the $E$-base satisfies this condition, it does not need to be valid.

\begin{example} \label{ex:S7-relaxed}
Consider the closure space $(\U, \cl)$ associated to the lattice of Figure \ref{fig:S7-relaxed}.
We have $\U = \{a, b, c, d, e, f\}$.
The canonical base $(\U, \is_{DG})$ has:
%
\[ 
\is_{DG} = \{d \imp c, f \imp ec, e \imp c\} \cup \{ac \imp bd, bc \imp ad, cde \imp ab\!f\}.
\]
%
The (aggregated) $E$-base $(\U, \is_E)$ has:
%
\[ 
\is_{E} = \{d \imp c, f \imp ec, e \imp c\} \cup \{ac \imp bd, bc \imp ad, ae \imp f, be \imp f, de \imp f\}.
\]
%
In this case, the pseudo-closed set $cde$ indeed includes the $E$-generator $cd$ subsuming the same essential set $abcdef$.
However, the closure of $cd$ in $\is_E$ does not reach $a$ and $b$.
This is because $\cl(ac) = abcd \subset abcdef$ and similarly $\cl(bc) = abcd \subset abcdef$.
Thus $cd$ cannot be a $E$-generator of $a$ and $b$ and the $E$-base is not valid despite faithfully capturing pseudo-closed sets.
%
\begin{figure}[ht!]
    \centering
    \includegraphics[scale=\FIGSrelaxed]{figures/S7-relaxed.pdf}%
    \caption{The closure lattice of Example \ref{ex:S7-relaxed}.
    Black dots represent essential sets.}
    \label{fig:S7-relaxed}
\end{figure}
%
\end{example}

Understanding what closure spaces have valid $E$-base is an intriguing problem, and constitutes the main motivation for our contribution.
Before investigating this question, we give a characterization of $E$-generators in Lemma \ref{lem:E-generator}.
It comes from the observation that if $A \in \gen_E(x)$, any closed set $C \subset \cl(A)$ generating $x$ can only contain singleton minimal generators of $x$.
This makes $x$ prime in the lattice $(\idl C, \subseteq)$.

\begin{lemma} \label{lem:E-generator}
Let $(\U, \cl)$ be a closure space with lattice $(\cs, \subseteq)$ and let $x \in \U$.
A subset $A$ of $\U$ is a $E$-generator of $x$ if and only if the following conditions hold:
\begin{enumerate}[(1)]
    \item $A$ is a $\cl^b$-minimal spanning set of $\cl(A)$
    \item $A$ is a non-trivial $\cl^b$-generator of $x$
    \item for every $C \in \cs$ such that $C \subset \cl(A)$, $x \in C$ implies that $x$ is prime in $(\idl C, \subseteq)$.
\end{enumerate}
\end{lemma}

\begin{proof}
We start with the only if part.
Let $A \in \gen_E(x)$.
By definition, $A \in \gen_D(x)$ so that conditions (1) and (2) readily holds.
We prove that condition (3) is satisfied.
Let $C \in \cs$ be such that $C \subset \cl(A)$ and $x \in C$.
Assume for contradiction $x$ is not prime in $(\idl C, \subseteq)$.
Then, there exists two closed sets $C_1, C_2 \subset C$ such that $x \notin C_1, C_2$ but $x \in C_1 \jn C_2 = \cl(C_1 \cup C_2)$. 
It follows that $C_1 \cup C_2$ contains a minimal generator $B$ of $x$.
As $C_1, C_2 \in \cs$, we $C_1 \cup C_2$ is $\cl^b$-closed.
Henceforth, $\card{B} \geq 2$ must hold.
Moreover $B$ can be chosen $\cl^b$-minimal, in which case $B$ will be a $D$-generator of $x$.
But then, $\cl(B) \subseteq C \subset \cl(A)$, which contradicts $A$ being a $E$-generator of $x$.
Therefore, all conditions (1), (2) and (3) are satisfied.

We move to the if part.
Assume all three conditions hold.
We prove that $A \in \gen_E(x)$.
First, let us show that $A \in \gen_D(x)$.
Let $B$ be any proper $\cl^b$-refinement of $A$.
By condition (1), $\cl(B) \subset \cl(A)$ must hold.
From condition (2), $x \in \cl(A)$ but $x \notin \cl^b(A)$.
As $B$ $\cl^b$-refines $A$, we deduce $x \notin B$.
On the other hand, $x \in \cl(B)$ would imply that $x$ is prime in $(\idl \cl(B), \subseteq)$ by condition (3).
Since $x \notin B$, this would lead to $x \in \cl^b(B)$, a contradiction.
We deduce that $x \notin \cl(B)$.
This concludes the proof that $A \in \gen_D(x)$.
It remains to show that $A \in \gen_E(x)$.
Let $B$ be any $D$-generator of $x$ distinct from $A$.
Since having $\cl(B) \subset \cl(A)$ would contradict condition (3), we conclude that $\cl(B) \not\subset \cl(A)$.
In other words, $\cl(A)$ is minimal in $\{\cl(B) \st B \in \gen_D(x)\}$ and $A \in \gen_E(x)$ holds as required.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

\begin{remark}
Recall from the preliminaries that conditions (1) and (2) in Lemma \ref{lem:pseudo-E} are not equivalent to be a $D$-generator.
While a $D$-generator $A$ of $x$ satisfies these conditions it also needs to be $\cl^b$-minimal in the sense that no proper $\cl^b$-refinement of $A$ generates $x$ too. 
\end{remark}

Condition (3) in the last lemma is equivalent to the condition (3') below:
\begin{itemize}
    \item[(3')] for every $C \in \cs$ such that $C \prec \cl(A)$, $x \in C$ implies that $x$ is prime in $(\idl C, \subseteq)$.
\end{itemize}

In words, Lemma \ref{lem:E-generator} describes, by means of $\cl^b$-minimal spanning sets, the inclusion-wise minimal closed sets above which $x$ stops being prime, i.e.\ when it starts admitting non-singleton minimal generators.
This is formally stated in the subsequent corollary.

\begin{corollary} \label{cor:E-spanned}
Let $(\U, \cl)$ be a closure space with lattice $(\cs, \subseteq)$ and let $x \in \U$.
The family $\{C \st C \in \cs \text{ and } x \text{ is not prime in } (\idl C, \subseteq)\}$ is a filter of $(\cs, \subseteq)$ whose inclusion-minimal members are precisely the closed sets of the $E$-generators of $x$:
%
\[ 
\{\cl(A) \st A \in \gen_E(x)\} = \min_{\subseteq}\{C \st C \in \cs \text{ and } x \text{ is not prime in } (\idl C, \subseteq)\}. \qed
\]
%
\end{corollary}

Lemma \ref{lem:E-generator} also stresses on the fact that any $\cl^b$-minimal spanning set $A$ of the closure of some $E$-generator of $x$ is also a $E$-generator of $x$, as long as $x \notin \cl^b(A)$.

\begin{corollary} \label{cor:E-min-span-set}
Let $(\U, \cs)$ be a closure space and let $x \in \U$.
If $C \in \{\cl(B) \st B \in \gen_E(x)\}$, then any $\cl^b$-minimal spanning set $A$ of $C$ satisfying $x \notin \cl^b(A)$ is a $E$-generator of $x$.
\end{corollary}

\begin{proof}
Since $x \in \cl(A) = C$, $A$ and $x$ readily satisfy conditions (1) and (2) of Lemma \ref{lem:E-generator} by assumption.
Condition (3) follows from $\cl(A) = \cl(B)$ and $B \in \gen_E(x)$.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

\begin{figure}[ht!]
    \centering
    \includegraphics[scale=\FIGEgenstructure]{figures/E-gen-structure.pdf}
    \caption{The $E$-generators of $x$ in a closure space $(\U, \cl)$. On the left, the lattice $(\cs, \subseteq)$ associated with $(\U, \cl)$ is partitioned according to Corollary \ref{cor:E-spanned}, i.e.~according to the filter of closed sets above which $x$ is not prime. The minimal members of this filter are the closure of the $E$-generators of $x$.
    %
    The box on the right illustrates Corollary \ref{cor:E-min-span-set}: within the spanning sets of $C = \cl(A)$ for some $A \in \gen_E(x)$, the $E$-generators of $x$ are the $\cl^b$-minimal spanning sets $B$ of $C$ s.t.\ $x \notin \cl^b(B)$.}
    \label{fig:E-gen-structure}
\end{figure}

The situation is pictured in Figure \ref{fig:E-gen-structure}.
Following Lemma \ref{lem:E-generator} and Corollary \ref{cor:E-spanned}, for a closed set $C$ and $x \in C$, we say that $x$ is \emph{almost prime} in $(\idl C, \subseteq)$ if $x$ is not prime in $(\idl C, \subseteq)$ but prime in $(\idl C_*, \subseteq)$ for every $C_* \prec C$ such that $x \in C_*$.
We thus obtain a new definition of the $E$-base of a closure space.

\begin{definition}[$E$-base] \label{def:E-base-prime}
Let $(\U, \cl)$ be a closure space with lattice $(\cs, \subseteq)$.
The $E$-base of $(\U, \cl)$ is the IB $(\U, \is_E)$ where 
%
\[
\begin{split}
\is_E = & \is^b \cup \{A \imp x \st x \in \U,  A \text{ is a $\cl^b$-minimal spanning set of $\cl(A)$} \\
        & \quad\quad \text{s.t.\ } x \notin \cl^b(A) \text{ and $x$ is almost prime in } (\idl \cl(A), \subseteq)\}.
\end{split}
\] 
%
\end{definition}

To conclude the section, we show that $E$-generators and their closure relate to any IB representing the closure space.
To do so, we highlight the relationships between $E$-generators and quasi-closed sets.
The next lemma can be seen as the analogue for $E$-generators in any closure space of the Expansion 16 of Wild \cite{wild2017joy} dedicated to critical generators in convex geometries.

\begin{lemma} \label{lem:E-QC}
Let $(\U, \cl)$ be a closure space with lattice $(\cs, \subseteq)$.
Let $C \in \cs$, $x \in C$, and $Q = C \setminus \{y \st x \in \cl^b(y)\}$.
Then $Q$ is a quasi-closed set spanning $C$ if and only if $C = \cl(A)$ for some $A \in \gen_E(x)$.
\end{lemma}

\begin{proof}
We start with the only if part.
Assume $Q = C \setminus \{y \st x \in \cl^b(y)\}$ spans $C$ and is quasi-closed.
Note that since $Q$ spans $C$, $C \neq \cl(z)$ for any $z \in \U$.
We show that $C = \cl(A)$ for some $A \in \gen_E(x)$. 
Let $A$ be a $\cl^b$-minimal spanning set of $C$ included in $Q$.
Since $Q$ is quasi-closed, $\cl^b(z) \subseteq Q$ for each $z \in Q$ as $C \neq \cl(z)$.
Henceforth, such a $A$ must exist.
We prove $A$ is a $E$-generator of $x$.
Conditions (1) and (2) of Lemma \ref{lem:E-generator} are already satisfied by definition of $A$, $Q$ and $C$.
We argue that condition (3) also holds.
Let $C' \in \cs$ be such that $x \in C'$ and $C' \subset C$.
To prove that $x$ is prime in $(\idl C', \subseteq)$, we need only prove that $C'$ does not include any  non-singleton minimal generator of $x$.
This amounts to show that $C' \setminus \{y \st x \in \cl^b(y)\}$ contains no minimal generator $x$.
We have $C' \setminus \{y \st x \in \cl^b(y)\} \subseteq C \setminus \{y \st x \in \cl^b(y)\} = Q$.
Moreover $C' \subset C$ so that $\cl(C' \setminus \{y \st x \in \cl^b(y)\}) \subseteq C' \subset C$.
Since $Q$ is quasi-closed, we deduce $\cl(C' \setminus \{y \st x \in \cl^b(y)\}) \subseteq Q$.
As $x \notin Q$, we obtain that $C'$ contains no non-singleton minimal generator of $x$.
Therefore $x$ is indeed prime in $(\idl C', \subseteq)$ for any closed set $C' \subset C$ containing $x$.
Condition (3) of Lemma \ref{lem:E-generator} is satisfied, and $A \in \gen_E(x)$ holds as required. 
This ends this part of the proof.


We move to the if part.
Assume $C = \cl(A)$ for some $E$-generator $A$ of $x$.
Let $Q = C \setminus \{y \st x \in \cl^b(y)\}$.
We argue that $Q$ is a quasi-closed set spanning $C$.
Since $A \subseteq Q$, $\cl(Q) = C$ readily holds.
We show that $Q$ is quasi-closed.
Let $X \subseteq Q$ such that $\cl(X) \subset C$. 
We prove that $\cl(X) \subseteq Q$.
Assume for contradiction $\cl(X) \nsubseteq Q$.
Then, there exists $y \in C \setminus Q$ such that $y \in \cl(X)$.
Since $x \in \cl^b(y) = \cl(y)$, we have $x \in \cl(X)$.
Henceforth, $x \in \cl(X)$ and $X$ includes a minimal generator $B$ of $x$.
By definition $B$ is not a singleton.
We deduce that $x$ is not prime in $(\idl \cl(X), \subseteq)$.
Thus condition (3) of Lemma \ref{lem:E-generator} fails, which contradicts $A$ being a $E$-generator of $x$.
Hence $\cl(X) \subseteq Q$ holds, and $Q$ is quasi-closed.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

As a consequence, the closure of any $E$-generator must be essential.
On the other hand, not all essential need be generated by some $E$-generator, as shown by Example \ref{ex:leaf}.
We can now give a theorem that relates $E$-generators, hence the $E$-base, to the canonical base.

\begin{theorem} \label{thm:E-DG}
Let $(\U, \cl)$ be a closure space with canonical base $(\U, \is_{DG})$ and let $x \in \U$.
For all $C \in \{\cl(A) \st A \in \gen_E(x)\}$ there exists an implication $P \imp C \setminus P$ in $\is_{DG}$ and a $E$-generator $A$ of $x$ such that $A \subseteq P$ and $\cl(A) = \cl(P) = C$.
\end{theorem}

\begin{proof}
Let $C \in \{\cl(A) \st A \in \gen_E(x)\}$.
By Lemma \ref{lem:E-QC}, $Q = C \setminus \{y \st x \in \cl^b(y)\}$ is quasi-closed and spans $C$.
Let $P$ be a pseudo-closed set spanning $C$ such that $P \subseteq Q$.
As $P$ spans $C$ and $P$ is quasi-closed, it is $\cl^b$-closed.
Therefore, it contains a $\cl^b$-minimal spanning set $A$ of $C$. 
By Corollary \ref{cor:E-min-span-set}, $A$ is a $E$-generator of $x$.
This concludes the proof.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

Using Theorem \ref{thm:canonical} and Theorem \ref{thm:E-DG}, we obtain the following straightforward corollary connecting the $E$-base with other IBs.

\begin{corollary} \label{cor:E-IB}
Let $(\U, \cl)$ be a closure space and let $(\U, \is)$ be an IB for $(\U, \cl)$.
For all $x \in \U$ and all $C \in \{\cl(B) \st B \in \gen_E(x)\}$, there exists an implication $A \imp Y$ in $\is$ such that $x \notin A$ and $\cl(A) = C$.
\qed
\end{corollary}


\section{Closure spaces with semidistributive lattices} \label{sec:proof}

This section is devoted to Theorem \ref{thm:E-valid-SD}.
The next lemma is a key ingredient of our proof.

\begin{lemma} \label{lem:pseudo-E}
Let $(\U, \cl)$ be a closure space with $\SD$ lattice $(\cs, \subseteq)$.
Let $E$ be a non-ji essential set of $(\U, \cl)$ with associated pseudo-closed set $P$ and canonical spanning set $A$.
For each $C \prec E$ in $(\cs, \subseteq)$ and each $x$ in the canonical spanning set of $C$, $x \notin P$ implies that $A \imp x$ belongs to the $E$-base of $(\U, \cl)$.
\end{lemma}

\begin{proof}
Let $(\U, \cl)$ be a closure space with SD closure lattice $(\cs, \subseteq)$.
As a preliminary step, note that since $(\cs, \subseteq)$ is semidistributive, so is $(\idl C, \subseteq)$.
Moreover, $X \subseteq C$ is essential (resp.~quasi-closed, pseudo-closed) in $(\cs, \subseteq)$ if and only if it is in $(\idl C, \subseteq)$.
Therefore, in order to prove our lemma, it is sufficient to prove it for $E = \U$.

Suppose that $\U$ is essential and let $P$ be the pseudo-closed set spanning $\U$.
Let $A = \{a_1, \dots, a_k\}$ be the canonical spanning set of $\U$, and let $M_1, \dots, M_k$ be the corresponding coatoms given by Theorem \ref{thm:coatoms-SDj}.
Remark that since $P$ spans $\U$, and as $\U \neq \cl(z)$ for $z \in \U$ by assumption, $P$ is $\cl^b$-closed.
In particular, $A \subseteq P$.
For each $1 \leq i \leq k$, we define
%
\[ F_i = P \cap M_i. \]
%
We begin with a series of claims, the first of which is a useful property of the $F_i$'s.

\begin{claim} \label{claim:F-incomp}
For each $i$, $A \setminus \{a_i\} \subseteq F_i$ and $a_i \notin F_i$.
Thus, $F_j \nsubseteq F_i$ for each $i \neq j$.
\end{claim}

\begin{proof}
First, $A$ is a minimal spanning set of $\U$, so that $a_i \notin \cl(A \setminus \{a_i\})$.
Hence, $A \setminus \{a_i\} \subseteq \cl(A \setminus \{a_i\}) \subseteq M_i$ since $M_i$ is closed and it is the unique mi such that $a_i \upp M_i$ due to the primality of $a_i$.
Thanks to $A \subseteq P$, we readily have $A \setminus \{a_i\} \subseteq P$.
Thus, $A \setminus \{a_i\} \subseteq M_i \cap P = F_i$.
The fact that $a_i \notin F_i$ follows from $a_i \notin M_i$.
\renewcommand{\qed}{$\blacksquare$}
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

\begin{claim} \label{claim:F-cap-M}
For each $i \neq j$, $F_i \cap (M_i \cap M_j) = F_j \cap (M_i \cap M_j)$.
\end{claim}

\begin{proof}
This follows from $F_i \cap (M_i \cap M_j) = P \cap M_i \cap (M_i \cap M_j) = P \cap M_j \cap (M_i \cap M_j) = F_j \cap (M_i \cap M_j)$.
\renewcommand{\qed}{$\blacksquare$}
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

\begin{claim} \label{claim:MiMj-below-P}
For each $i \neq j$, $F_i \cap F_j = M_i \cap M_j \subseteq P$.
\end{claim}

\begin{proof}
By definition of $F_i, F_j$, we have $F_i \cap F_j \subseteq M_i \cap M_j$.
We show that the other inclusion also holds.
Assume for contradiction $F_i \cap F_j \subset M_i \cap M_j$.
Since $P$ is quasi-closed, $F_i$ and $F_j$ are closed.
Hence, $F_i \cap F_j$ is closed.
Let $x$ be an element of $M_i \cap M_j$ such that $F_i \cap F_j \downp x$.
Such an element must exist by assumption.
By Claim \ref{claim:F-cap-M}, we deduce $F_i \downp x$, $F_j \downp x$.
But then, there exists inclusion-wise maximal $C_i, C_j \in \cs$ such that $F_i \subseteq C_i \subseteq M_i$, $F_j \subseteq C_j \subseteq M_j$, and $C_i, C_j \downp x$.
Hence, we have $x \dpp C_i, C_j$.
However, by Claim \ref{claim:F-incomp} we have $a_i \in C_j \setminus C_i$ and $a_j \in C_i \setminus C_j$ as $F_i \subseteq C_i \subseteq M_i$ and $F_j \subseteq C_j \subseteq M_j$.
Thus, $C_i$ and $C_j$ are incomparable, and $C_i, C_j \dpp x$ contradicts $(\cs, \subseteq)$ being SDm due to Theorem \ref{thm:SD-arrows}.
Hence, such a $x$ cannot exist, and $F_i \cap F_j = M_i \cap M_j$.
Since $F_i \cap F_j \subseteq P$, we deduce that $M_i \cap M_j \subseteq P$ holds true.
\renewcommand{\qed}{$\blacksquare$}
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

We go back to the proof of the lemma.
Recall that $A$ is the canonical spanning set of $\U$.
Since $P$ is pseudo-closed and spans $\U$, $P \subset \U$ must be true.
Moreover, $\U$ is not ji and $(\U, \cl)$ is standard by assumption so that $\U = \bigcup_{i = 1}^k M_i$.
Therefore, there exists $i$ such that $F_i \subset M_i$, that is $M_i \nsubseteq P$.
Since $P$ is quasi-closed, $M_i \nsubseteq P$ implies that $A_i \nsubseteq P$ where $A_i$ is the canonical spanning set of $M_i$.
Let $x \in A_i \setminus P$.
We show that $A$ and $x$ satisfy the conditions of Lemma \ref{lem:E-generator}.
Condition (1) is readily fulfilled by $A$.
Condition (2) follows from the fact that $x \in \cl(A) = \U$, $x \notin A$ as $A \subseteq P$ and $x \notin P$, and $\cl^b(A) \subseteq P$ since $P$ is quasi-closed.
It remains to show condition (3') holds.
First, by Claim \ref{claim:MiMj-below-P}, $x \notin M_j$ for $j \neq i$.
Thus, we need only show $x$ is prime in $(\idl M_i, \subseteq)$.
But since $x$ belongs to the canonical spanning set of $M_i$, it follows from Theorem \ref{thm:coatoms-SDj} that $x$ is prime in $(\idl M_i, \subseteq)$.
Henceforth, condition (3') holds. 
Since $A$, $x$ fulfill all the conditions of Lemma \ref{lem:E-generator}, we deduce that $A \imp x$ belongs to the $E$-base of $(\U, \cl)$, concluding the proof.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

We proceed to the proof of Theorem \ref{thm:E-valid-SD} that we first restate.

\THMEvalidSD*

\begin{proof}
Let $(\U, \cs)$ be a standard closure space with SD lattice $(\cs, \subseteq)$.
Let $(\U, \is_E)$ be its $E$-base.
We need to show that for every $X \subseteq \U$, $\cl(X) = \is_E(X)$ where $\is_E(\cdot)$ is the closure operator induced by $(\U, \is_E)$.
By definition of the $E$-base, $\is_E(X) \subseteq \cl(X)$ for every $X \subseteq \U$.

We prove the Theorem using induction on closed sets ordered by inclusion. 
As the space is standard, it readily holds for $\emptyset$ and all atoms of $(\cs, \subseteq)$.
Let $C \in \cs$ and assume that for every $X \subseteq C$ such that $\cl(X) \subset C$, we have $\cl(X) = \is_E(X)$.
We argue that for every $Y \subseteq C$ such that $\cl(Y) = C$, we have $\is_E(Y) = C$.
If $Y = C$ then $\is_E(Y) = C$ readily holds since $\is_E(Y) \subseteq \cl(Y)$.
Thus, we can assume that $Y \subset C$.
We distinguish three cases:
%
\begin{enumerate}[(1)]
\item $C$ is not essential (hence not join-irreducible).
Since $C$ is not essential, $Y$ is not quasi-closed.
Therefore, there exists $X \subseteq Y$ such that $\cl(X) \subset \cl(Y)$ and $\cl(X) \nsubseteq Y$.
However, by inductive hypothesis, $\cl(X) = \is_E(X)$ and hence $\is_E(X) \nsubseteq Y$ so that $Y \subset \is_E(Y)$. 
Since this holds for every proper subset $Y$ of $C$ spanning $C$ and as $\is_E(Y) \subseteq \cl(Y)$ for all such $Y$'s, we deduce that $\is_E(Y) = \cl(Y) = C$ as required.

\item $C$ is join-irreducible.
Since the system is standard, we thus have that $C = \cl(x)$ for a unique $x \in \U$.
Moreover, $Y$ contains $x$ since $\{x\}$ is the unique minimal spanning set of $C$.
By definition $\is_E$ contains an implication $x \imp y$ for each $y$ such that $y \in \cl(x)$.
we deduce that $\cl(Y) = \is_E(Y) = C$ holds true.

\item $C$ is essential but not join-irreducible.
As all non-trivial binary implications of $(\U, \cl)$ belongs to $\is_E$, we have that $\is_E(Y)$ contains $A$, the canonical spanning set of $C$.
To show that $\is_E(Y) = C$, we prove that for each of the predecessors $C_i$, \dots, $C_k$ of $C$, the canonical spanning set $A_i$ of $C_i$ is included in $\is_E(Y)$.
On this purpose, we first argue that $\is_E(Y)$ is quasi-closed with respect to $\cl$.
Let $X \subseteq \is_E(Y)$ such that $\cl(X) \subset \cl(\is_E(Y)) = \cl(Y) = C$.
By inductive hypothesis, $\is_E(X) = \cl(X)$ so that $\cl(X) = \is_E(X) \subseteq \is_E(\is_E(Y)) = \is_E(Y)$.
Therefore, $\is_E(Y)$ is quasi-closed and in particular $P \subseteq \is_E(Y)$ with $P$ the unique pseudo-closed set spanning $C$ obtained from Proposition \ref{prop:SDj-UC}.
Now, let $C_i$ be a predecessor of $C$ and consider its canonical spanning set $A_i$.
Let $x \in A_i$.
If $x \in P$, then $x \in \is_E(Y)$ by previous argument.
If $x \notin P$, then by Lemma \ref{lem:pseudo-E} we have $A \imp x \in \is_E$.
Because $A \subseteq P \subseteq \is_E(Y)$, we deduce that $x \in \is_E(Y)$.
Therefore $A_i \subseteq \is_E(Y)$ for each $1 \leq i \leq k$.

Now, $\cl(A_i) = C_i \subset C$ for each $1 \leq i \leq k$.
By inductive hypothesis, $\is_E(X) = \cl(X)$ for each $X \subseteq C$ such that $\cl(X) \subset C$.
Henceforth, $C_i = \is_E(A_i) \subseteq \is_E(Y)$.
As $C$ is not join-irreducible and $(\U, \cl)$ is standard, we have $C = \bigcup_{i = 1}^{k} C_i \subseteq \is_E(Y) \subseteq \cl(Y) = C$.
We deduce that $\is_E(Y) = C$ for every subset $Y$ of $C$ such that $\cl(Y) = C$.
\end{enumerate}
%
In all three cases, we have that $\is_E(Y) = \cl(Y)$ for every $Y \subseteq C$ such that $\cl(Y) = C$.
We deduce using induction that the $E$-base is valid.

It remains to show that in its aggregated form $(\U, \is_E)$ is minimum.
On this purpose, we identify a bijection between $\is_E$ and $\is_{DG}$.
Observe first that they have the same binary part by definition.
Hence, we need only produce a bijection between their non-binary parts.
By Lemma \ref{lem:E-QC}, the closure of a $E$-generator is essential.
By Lemma \ref{lem:pseudo-E}, the canonical spanning set of each non-ji essential set is a $E$-generator.
Since $(\cs, \subseteq)$ is SD, we deduce by Theorem \ref{thm:SDj-canonical} that there is a bijection between $E$-generators and non-ji essential sets.
Again by semidistributivity of $(\cs, \subseteq)$, there is a bijection between essential sets and pseudo closed sets by virtue of Proposition \ref{prop:SDj-UC}.
We get a bijection between $E$-generators and non-singleton pseudo-closed sets.
Hence, once aggregated, $(\U, \is_E)$ is minimum by Theorem \ref{thm:canonical}.
\ifx\arxiv\undefined
\qed
\fi
\end{proof}

We remark that both $\SDj$ and $\SDm$ properties are important.
Indeed, in general, neither $\SDm$ lattices nor $\SDj$ lattices have valid $E$-base.
The lattice of Example \ref{ex:leaf} is $\SDj$ but not $\SDm$ and the $E$-base of the corresponding closure space is not valid.
Below, we give an example of a closure space whose lattice is $\SDm$ and its $E$-base not valid.

\begin{example} \label{ex:SDm-fail}
Let $(\U, \cl)$ be the closure space of the $\SDm$ lattice of Figure \ref{fig:SDm-fail}.
We have:
\begin{itemize}
    \item $\is_{DG} = \{e \imp ac, f \imp ad, ab \imp cde\!f, acde \imp f, acd\!f \imp e\}$
    \item $\is_E = \{e \imp ac, f \imp ad, ab \imp cd, de \imp f, c\!f \imp e\}$ (aggregated form).
\end{itemize}
The $E$-base $(\U, \is_E)$ is not valid since $ab$ does not generate $e\!f$.
This example illustrates the importance of $\SDj$ in Lemma \ref{lem:pseudo-E}.
Indeed, $acde\!f$ is a predecessor of the essential set $abcde\!f$ which has no canonical representation.
Its minimal spanning sets are $de$, $c\!f$ and $e\!f$ but none of them comprises only prime elements of  $(\idl acde\!f, \subseteq)$, which are $a$, $c$ and $d$.
Thus, the $E$-generator and pseudo-closed set $ab$ does not reach any spanning set of $acdef$ in $\is_E$.
%
\begin{figure}[ht!]
    \centering
    \includegraphics[scale=\FIGSDmfail]{figures/SDm-fail.pdf}
    \caption{The closure lattice of Example \ref{ex:SDm-fail}. Black dots are essential sets.
    The lattice is $\SDm$ yet the $E$-base is not valid.}
    \label{fig:SDm-fail}
\end{figure}
\end{example}

\section{Conclusion} \label{sec:conclusion}

In this paper, we proved that every closure space with $\SD$ lattice has a valid $E$-base.
When such space does not have $D$-cycles the result was established in \cite{adaricheva2013ordered}.
Therefore, the new cases for which $E$-base is valid are closure spaces that are $\SD$ and possess $D$-cycles. 

To conclude, we formulate an open question related to the $E$-base of any closure space with $\SD$ lattice and $D$-cycles.
A $D$-cycle in $(\U, \cl)$ is a sequence $x_0, x_1, \dots, x_n = x_0$ of elements from $S$ such that, for each $1 \leq k \leq n$ there exists $A_k \in \gen_D(x_k)$ with $x_{k-1}\in A_k$. 
In Example \ref{ex:carpet}, we have $D$-cycle: $x_0=c, x_1=f, x_2=g, x_3=d, x_4=x_0=c$. 
The non-binary implications in the $E$-base have exactly these elements and their $D$-generators $A_k$. 
Other examples confirm this observation, which brings us to the following question.

\begin{rstquestion}
Does the $E$-base of a closure space with $\SD$ lattice and $D$-cycles always include implications $A_k\to x_k$, where some $x_{k-1}\in A_k$ and $x_{k-1}, x_k$ are consecutive members of some $D$-cycle?
\end{rstquestion}

\bibliographystyle{alpha}
\bibliography{biblio}

\end{document}


