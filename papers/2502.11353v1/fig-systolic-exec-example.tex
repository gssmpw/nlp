\begin{figure*}[tp]
  \centering
  \begin{subfigure}{\textwidth}
      \includegraphics[width=\textwidth]{mssortk-systolic-exec-example.svg.pdf}
      \caption{Systolic Execution of \TT{mssortk} Instruction.}
      \label{fig:mssortk-systolic-exec}
  \end{subfigure}
  \hfill
  \vspace{0.01cm}
  \begin{subfigure}{\textwidth}
      \includegraphics[width=\textwidth]{mszipk-systolic-exec-example.svg.pdf}
      \caption{Systolic Execution of \TT{mszipk} Instruction.}
      \label{fig:mszipk-systolic-exec}
  \end{subfigure}
  \caption[Cycle-by-Cycle Systolic Execution of \TT{mssortk} in a 3$\times$3 Systolic Array for Two Unsorted Lists of Keys]{
    Cycle-by-Cycle Systolic Execution of \TT{mssortk} in a 3$\times$3 Systolic Array for Two Unsorted Lists of Keys --
    PE states: F~=~forward, X~=~switch, C~=~combine;
    W\_IC~=~west input counter;
    N\_IC~=~north input counter;
    E\_OC~=~east output counter;
    S\_OC~=~south output counter;
    d~=~duplicate key that is excluded;
    x~=~unmergeable key;
    Counters in red indicate they are being updated.
    PEs in gray are inactive.
    PEs in blue are merging keys.
    PEs in purple are compressing valid output keys.
    Keys in red come from the north input.
    Keys in green come from the west input.
    Keys in west and east sides are ordered from bottom to top.
    Keys in north and south sides are ordered from left to right.
  }
  \label{fig:systolic-exec}
  \vspace{-0.1cm}
\end{figure*}
