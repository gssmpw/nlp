\section{Related Work}
\label{sec:earlycrow-related-work}

\begin{figure*}[!t]
\centering
\includegraphics[width=16cm,height=6cm]{chapter5/figures/heatmap_apt.pdf}
\caption{Heatmap for \earlycrow-HTTPS.}\label{fig:heat_mao}
\end{figure*}


There is very limited previous work on detecting APTs at the network level. 
%
Detecting \cc\ in general is the closest area.
%
In our approach we test several features from the literature which can be relevant for APTs, including URLs and UA features ____, traffic exchange bytes ____, HTTP content types ____, and GET and POST ratio ____. Besides directly using such features, \earlycrow\ pivots them into host, destination and URL profiles, and combines them in contextual summaries. 
%

Some previous works focus on detecting APTs in addition to other kinds of malicious communications ____. 
%
Oprea et al. ____ propose a belief propagation (BP) algorithm to detect early-stage infection of APTs. 
%
They model enterprise communication using a bipartite graph with two vertices, hosts, and domains based on simulated attacks.
%
Once the detector identifies a malicious remote host or domain based on several features, BP identifies communities of malicious domains with similar features that are part of the same attack campaign. 
%
Domain scores are calculated as a supervised linear regression weighted sum of features.
%
As discussed in Section~\ref{sec:EarlyCrowevaluation}, APTs tend to infect a lower number of hosts than botnets. 
%
Therefore, \earlycrow\ considers other features based on different TTPs discussed in Section \ref{sec:EarlyCrow_threat_model}. 
%
\earlycrow\ is closer to \made____, which instead uses web proxy logs at the edge of an enterprise network to detect malicious \cc\ communications, including APTs. 
%
\made\ leverages features related to the communication, HTTP request, response and its content, URL, and UAs.
%
These are used by a random forest classifier to assign a risk score for each connection. 
%
As discussed in Section \ref{sec:EarlyCrowevaluation}, \made\ is not as effective on HTTPS traffic, which is nowadays harder to intercept and decrypt due to technical and legal requirements. 
%
In addition, \earlycrow\ considers five other TTPs besides the \textit{Web Application Protocol} TPP at the heart of \made. 



ExeceScent____ detects \cc\ domains by clustering incoming requests into five templates, including median URL path, URL query component, User-Agent, other headers, and destination network. 
%
These templates are used to estimate similarity scores to predefined Control Protocol Templates (CPT) centroids. 
%
However, this is open to evasion if an adversary copies the UA of the victim machine from the Windows Registry ____. 
%
In addition, it is not possible to extract most HTTP header features when HTTPS is in use, which hinders the generalization process and may result in mixing APTs with legitimate in many clusters. 
%
A related approach____ adopts similar features, only using histogram bins which also can be evaded using HTTPS. 
%
%
BAYWATCH ____ is a filtering system to detect the beaconing of infected hosts. 
%
Universal and local whitelists are filtered, and then beaconing can be detected using the Discrete Fourier Transform (DFT) and Gaussian Mixture Model (GMM), awarding a high Agglomerative Hierarchical Clustering (ACF) score for strong periodicity.
%
BAYWATCH filters URLs and domains that are likely to be legitimate. 
%
Unprocessed connections with all previous features are sent to a random forest for classification.
%
BAYWATCH can be computationally expensive for only beaconing behaviour, and many APTs also have non-beaconing connections. 
%
\earlycrow\ detects malicious connections regardless of their pattern.
%
Finally, Kitsune ____ adopts an ensemble of autoencoders, proving the efficiency of unsupervised deep learning to detect classic attacks such as ARP poisoning and SYN DoS, which are rarely used by APTs. 
%
In this paper, we avoid using deep learning because of the scarce dataset representing various APTs TTPs, which is essential for deep learning models. 


%-------------------------------------------------------------------------------