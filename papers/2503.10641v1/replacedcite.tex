\section{Related Work}
\label{section:related}
\textbf{Control Barrier Function.} 
Control barrier functions (CBF) ____ aim to ensure control safety in dynamical systems by imposing value-landscapes to render the safe set forward invariant. 
The key point is to enforce the derivative of the CBF to satisfy Lyapunov conditions____.
Traditional CBFs are manually designed based on domain-specific knowledge of the system, making them unsuitable for systems with complex dynamics or high uncertainty____.
% In ____, the authors apply the pre-defined CBFs on adaptive cruise control by solving Quadratic Programs to present safety considerations.
% % They derive the CBFs beforehand based on system dynamics as well as constraint specifications.
% ____ proposes new classes of CBFs to simplify the process of constructing CBF candidates,
% and perform evaluations in simple simulation tasks.
% Nevertheless, it remains challenging to construct valid CBFs for systems with complex or uncertain dynamics.

% \textbf{Learning-based CBFs.}
Learning-based methods have been introduced to construct data-driven CBF candidates____}
from data.
% using linear functions____, support vector machines____, and neural networks____.
% They provide an alternative to the manually-designed CBFs especially for the systems with complex or uncertain dynamics.
% In recent, learning-based CBFs have been extended to handle challenging safety-critical tasks such as robot manipulations____, obstacle avoidance____, [find one more], and multi-agent control____ etc.
Online algorithms learn CBFs by interacting with, or sampling from, the controlled system.
In ____, the authors learn barrier certificates to derive the safe region of an unknown control-affine system. 
They propose an adaptive sampling algorithm to iteratively refine the CBF candidate on the states that have high uncertainty.
% The algorithm stops when the safe region can be no longer expanded.
% ____ proposes to estimate model uncertainty for an unknown dynamical system using CBFs, in order to estimate both uncertainties due to parametric errors and unmodeled dynamics.  
% They use an episodic learning approach which alternates between collecting data using a QP-based controller synthesized by the CBF, and improving the CBF estimates.
____ studies the multi-agent control problem. They jointly learn the barrier certificates alongside the multi-agent control policy, while regulating the policy based on CBF.
____ develops a model-based approach to learn control Lyapunov barrier functions based on stability and safety specifications.
The training state are sampled uniformly from the state space.
% This idea of certifying policy safety with learned CBFs is frequently adopted by many safe reinforcement learning methods____.
Offline algorithms learn CBFs without new data during the learning.
____ proposes an incremental learning of a set of linear parametric CBFs from human demonstrations.
% in order to capture the state constraint for the motion trajectory.
In ____, the authors present an approach to synthesize local valid CBFs for control-affine systems with known but nonlinear dynamics.
The expert demonstrations contain only safe trajectories collected with a fixed nominal controller.
% ____ adopts the modified stochastic gradient descent to simultaneously learn the policy and barrier models from offline demonstrations.
% In this paper, we present an offline algorithm for learning neural CBF models.
% Our algorithm differs from the prior methods in two aspects.
% First,
% we allow the training data to contain unlabeled demonstrations which consist of states with uncertain safety. 
% We achieve this via novel annotation procedures based on out-of-distribution analysis____. 
% Second, we alleviate the assumption that the training data must be generated with a fixed performative controller. 
% We achieve this by improving the optimization of CBF's Lie-derivative condition to concern only the maximally-safe controls captured by the proposed actor model.

\textbf{Out-of-distribution Analysis.}
Out-of-distribution (OOD) analysis is an emerging topic of machine learning that examines the distribution shifts where test data diverges from the training data distribution ____.
% aiming to improve the reliability and safety of machine learning systems ____.
% OOD methods can be broadly classified into two categories.
Unsupervised representation learning methods focus on learning domain-agnostic features from unlabeled data____.
% capturing key attributes that enable OOD detection against OOD data.
However, these methods can introduce bias, if the OOD domain distributions overlap with the unlabeled data distribution____.
% A sub-domain of unsupervised methods is the self-supervised approaches that typically involve generating synthesized OOD distribution in order to 
Supervised learning methods incorporate implicit domain labels from both in-distribution and OOD data____.
While these methods are often more accurate due to the additional information, they may not generalize well to OOD examples that differ significantly from those seen during training.
% identifying and rejecting OOD samples.
% This unsupervised OOD algorithm explores the relationship between classification with rejection and cost-sensitive classification, with the goal of detecting OOD samples that deviate from the training data.