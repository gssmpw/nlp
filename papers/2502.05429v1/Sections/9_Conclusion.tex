\section{Conclusion}\label{sec:conclusion}
In this paper, we present new Prime+Probe and Flush+Reload attacks on the instruction cache created by the SMC detection mechanism in x86 processors. We show that an attacker can implement high-resolution attacks to leak RSA decryption keys with only 10 measurements. Moreover, single-trace attacks are possible with SMC-based attacks on an OpenSSL library. A new version of the Spectre attack is proposed to leak secrets in the memory. Finally, we propose a hardware performance counter-based detection system to detect ongoing SMC-based attacks with an F-score of 0.98 with a minimal performance overhead. The artifacts supporting our experiments are publicly available on our GitHub repository\footnote{\url{https://github.com/hunie-son/SMaCk}}.
%GITHUB