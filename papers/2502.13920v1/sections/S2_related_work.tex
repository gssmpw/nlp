\section{Background and Related Work}\label{sec.rw}

\subsection{Sleep Sensing and Tracking}\label{subsec.sleep_sensing}

Lullaby~\cite{kay2012lullaby} uses multiple sensors (\eg, sound, temperature) to assess and visualize environmental and sleep data together, helping users understand their sleep. 
WAKE~\cite{pham2020wake} is a behind-the-ear device that detects microsleep. FitBit\footnote{\url{https://www.fitbit.com/global/us/technology/fitbit-app}} tracks sleep duration and stages (light, deep, REM) and provides overall sleep quality assessments. Whoop\footnote{\url{https://www.whoop.com/us/en/thelocker/introducing-whoop-coach-powered-by-openai/}} monitors fitness, sleep, and recovery metrics, offering recommendations to improve human performance. 
The Oura Ring\footnote{\url{https://ouraring.com/oura-experience}} collects precise body signals (\eg, temperature, heart rate variability, movement) to generate readiness, sleep, and activity scores, along with personalized suggestions. 
We chose the Oura Ring for our research due to its high-quality sleep measurements and activity detection, which align well with our goals for personalized sleep-enhancing recommendations.

\subsection{Sleep Feedback and Recommendation}\label{subsec.sleep_feedback}
Sleep feedback and recommendation systems generally focus on two key aspects:
1) improving sleep hygiene awareness and 2) providing personalized recommendations based on user lifestyles to improve sleep health.

To improve sleep awareness, systems use various visualization approaches.
ShutEye~\cite{bauer2012shuteye} displays activity timelines on mobile wallpapers to indicate optimal timing for sleep-impacting activities. 
SleepExplorer~\cite{liang2016sleepexplorer} is a web-based tool that uses data visualizations to show the impacts of different contextual factors on sleep quality, such as steps, calories, and water consumed.
SleepTight~\cite{choe2015sleeptight} is a mobile application that further supports self-reporting on influential sleep factors and their impacts on sleep.

To provide personalized sleep recommendations, many studies incorporate user modeling techniques that consider user characteristics, behaviors, and contexts.
SleepCoach~\cite{daskalova2016sleepcoacher} utilizes static user models to correlate sleep factors with predefined recommendation templates of general guidelines, such as ``For the next 6 days, try going to bed at 11 PM.'' 
\citet{daskalova2018investigating} improved personalization by clustering users into groups based on shared physical profiles or recommendations.
However, this cohort-based model is inherently static and may overlook the nuances of individual behaviors and preferences over time.
\citet{lee2022sleepguru} built a dynamic model that considers usersâ€™ daily physiological data and calendar events to predict sleep pressure and sleepiness, which are used to recommend sleep schedules. However, it only focuses on calendar events, which constrains their applicability to broader lifestyle contexts and users' preferences.
Building upon these studies, we adopt a dynamic user modeling approach that incorporates just-in-time adaptive intervention (JITAI) principles~\cite{nahum2018just}.
JITAI is a design methodology that aims to deliver timely and personalized support by dynamically adjusting to users' internal and contextual conditions when individuals are in need of health support and receptive to engaging with an intervention.
To operationalize JITAI for sleep health, we build a contextual multi-armed bandit model inspired by previous reinforcement learning approaches~\cite{mybehavior,liao2020personalized} that personalizes interventions by learning from user behaviors over time.
The model, informed by self-efficacy~\cite{bandura1977self} and habit formation~\cite{lally2010habits} theories, dynamically adjusts recommendations by balancing the exploitation of proven successful sleep-enhancing activities with the exploration of novel ones.
Our model considers both immediate contextual factors (\eg, time and weather) and long-term user physiological data from wearable devices.
Furthermore, to enhance real-time adaptability and intervention effectiveness, we deliver these recommendations through a theory-guided LLM-based chatbot, which integrates behavior change techniques to address users' needs and preferences.


\subsection{LLMs for Health Applications}\label{subsec.llms4health}
\citet{kim2022leveraging} leveraged LLMs to streamline natural language interactions that can understand users' utterances and automatically generate questions for users to co-build retrospective activity logs for self-tracking.
\citet{englhardt2023classification} systematically investigated the use and evaluation of LLMs for multi-sensor data classification and reasoning to facilitate the clinical workflows of therapists.
\citet{abbasian2023conversational} presented a personalized LLM-powered framework for conversational health agents.
The framework aims to deliver personalized responses to users' healthcare-related queries via the analyses of users' questions and relevant and essential data from different external sources.
Recently, PH-LLM~\cite{cosentino2024towards}, a version of Gemini, has been fine-tuned for personal health applications in sleep and fitness, demonstrating performance comparable to human experts on long-form case studies and professional exams.
PHIA~\cite{merrill2024transforming} is an LLM-based agent framework that uses iterative reasoning, code generation, and web search to analyze and interpret personal health data from wearables.
However, all these LLMs and systems focus on static screenshots of user data.
Building upon prior work, we build an LLM-powered chatbot. 
This chatbot integrates an activity recommendation model that analyzes dynamic users' sleep and activity patterns and offers personalized advice or answers specific questions about their sleep health.
Moreover, by employing a behavior change framework, the chatbot motivates users to adopt recommended activities, thereby fostering better sleep habits.
