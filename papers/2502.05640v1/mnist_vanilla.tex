
\newcommand*{\MinNumberG}{0}%
\newcommand*{\MaxNumberG}{20}%

\makeatletter
\newcommand\HUGE{\@setfontsize\Huge{50}{80}}
\newcommand\SUPERHUGE{\@setfontsize\Huge{50}{300}}
\makeatother

\newcommand{\ApplyGradientG}[1]{%
	\pgfmathsetmacro{\PercentColor}{100.0*(#1-\MinNumberG)/(\MaxNumberG-\MinNumberG)}
	\hspace{-0.33em}\colorbox{red!\PercentColor!white}{}
}

\newcolumntype{G}{>{\collectcell\ApplyGradientG}c<{\endcollectcell}}


\begin{figure}[!htb]
\vspace{-0.2cm}
	\setlength{\fboxsep}{3mm} % box size
	\setlength{\tabcolsep}{0pt}
	\centering

\subfloat[]{%vanilla features
	\begin{tikzpicture}[scale=0.17,every node/.style={scale=0.17}]
	\node[] at (0,0) {
		\begin{tabular}{*{28}{G}}
0&0&0&0&0&0&1&0&0&1&0&1&1&0&0&0&0&0&1&0&1&0&1&0&0&0&1&1\\
0&0&0&1&1&0&0&1&0&0&1&2&0&1&1&0&0&0&1&0&0&0&0&0&0&0&0&0\\
0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&2&1&1&0&0&0&0&1&0&0&1&0\\
0&0&0&1&0&1&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&0&1&0&1&2&0\\
0&1&0&0&0&0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0\\
0&1&0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&1&0&1&0&0&0&0&0&1&0&0\\
0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&1&0&0\\
0&0&0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0&0&0&0&0&1&0\\
0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&2&1&1&0&1&1&1\\
0&0&0&0&0&0&0&0&0&0&0&0&1&0&1&0&0&0&0&0&0&0&0&1&0&1&0&1\\
1&0&0&0&0&0&0&1&1&1&0&0&2&2&0&1&0&0&0&0&0&0&0&1&0&1&0&0\\
0&0&0&0&0&1&0&1&2&2&1&2&4&1&1&1&0&0&0&0&0&0&0&0&1&0&1&0\\
0&0&1&0&0&3&2&4&3&4&3&3&2&3&1&0&0&0&0&0&0&0&0&0&1&0&0&0\\
1&1&0&1&0&1&0&2&2&4&4&0&1&2&0&0&0&0&0&0&0&2&0&1&1&0&0&0\\
0&1&0&0&0&1&1&1&0&3&0&0&0&0&0&0&0&0&0&0&0&0&3&0&0&1&0&0\\
0&0&2&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&0&1&0&0&0&1\\
1&0&0&0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&0&0&0&0&0&0&0\\
1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&0&1&0&0&0&1\\
1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0\\
1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1\\
1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0&0&0&0&0&1&1&0&0\\
0&0&0&0&0&0&0&0&0&0&0&0&1&0&1&1&1&1&0&1&0&0&0&0&0&0&0&0\\
0&0&0&1&1&0&0&0&0&0&0&0&0&2&1&1&1&0&0&0&0&1&0&0&0&0&0&1\\
0&0&1&1&0&0&0&0&0&1&1&0&0&1&2&0&1&0&0&0&0&0&1&1&1&0&1&0\\
0&0&0&1&1&0&1&1&1&0&2&1&1&2&0&1&1&1&0&2&0&1&0&1&0&1&0&0\\
0&0&0&0&0&0&1&1&0&1&0&4&1&1&0&0&0&0&0&0&0&0&1&1&0&0&0&1\\
1&0&0&1&1&0&1&0&2&4&0&0&0&0&1&0&0&0&1&0&0&0&0&0&0&1&0&0\\
0&0&0&1&0&0&1&0&0&0&0&1&0&0&1&0&1&2&0&0&1&1&0&0&1&1&0&1\\
		\end{tabular}
	};
\draw[draw=gray, dashed] (-8.5,-8.5) rectangle ++(17,17);
\draw[-{Straight Barb[angle=60:2pt 3]}] (-9, -8.5) -- (9, -8.5);
\node[] at (0, -9.5) {\HUGE{Horizontal position}};
\draw[-{Straight Barb[angle=60:2pt 3]}] (-8.5, -9) -- (-8.5, 9);
\node[rotate=90] at (-9.5, 0) {\HUGE{Vertical position}};
%\draw[draw=gray!30!white, very thin, step=0.607] (-8.5,-8.5) grid ++(17,17);

\node[] at (20,0) {
	\begin{tabular}{*{28}{G}}
0&5&1&2&5&2&1&2&1&1&2&2&3&3&1&2&3&1&0&3&1&4&3&3&4&5&2&3\\
1&2&0&3&3&4&1&3&3&2&0&2&0&1&3&2&0&0&3&1&4&0&1&2&5&1&3&2\\
1&4&4&1&4&1&2&1&4&1&2&1&1&3&1&3&1&1&1&1&1&1&1&2&2&3&3&2\\
1&3&2&0&2&1&3&1&6&4&1&3&2&3&3&2&1&0&3&1&1&4&4&3&0&2&1&2\\
1&2&4&6&2&1&1&5&1&3&3&2&2&1&0&1&1&0&0&0&0&0&0&2&0&2&0&3\\
2&6&1&3&1&2&3&1&0&2&1&0&1&0&0&2&1&0&0&0&0&0&2&0&2&0&2&3\\
0&1&1&1&4&1&2&2&3&0&2&0&0&0&1&0&0&0&0&0&0&0&0&0&0&0&2&8\\
0&2&2&2&1&1&1&0&0&1&0&0&0&0&0&0&0&0&0&0&0&0&1&0&2&1&5&2\\
1&2&0&2&1&0&1&1&1&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&3&1&0\\
4&3&3&1&3&1&0&1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&3&2&2\\
3&0&1&3&1&2&0&1&1&0&0&0&0&0&0&0&0&0&0&0&0&2&0&0&1&1&2&1\\
2&2&0&4&3&4&2&1&0&0&0&0&0&0&1&0&0&0&0&0&0&1&0&2&1&4&2&1\\
2&2&0&0&4&1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0&5&3&3&0\\
2&2&3&1&3&2&1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&3&3&1&2\\
4&0&1&1&0&0&1&1&0&0&0&0&0&0&0&0&0&0&0&0&1&1&2&1&4&3&3&1\\
0&3&1&5&1&1&0&2&0&0&1&0&0&0&0&0&0&0&0&0&0&0&4&2&3&3&5&2\\
1&2&2&1&2&2&2&1&1&0&2&0&0&0&0&1&0&0&0&0&0&1&4&2&4&6&1&1\\
0&2&2&3&2&4&1&1&0&0&0&2&1&1&0&0&0&0&0&0&1&1&5&5&6&1&3&1\\
2&2&1&1&3&1&1&1&1&0&0&0&1&0&1&0&0&0&0&0&2&2&5&5&10&1&1&2\\
1&2&0&1&1&2&1&0&0&0&2&2&0&0&1&1&0&0&0&0&1&5&2&5&7&2&2&5\\
1&2&2&3&3&0&1&0&0&2&0&0&0&0&0&0&0&0&2&1&3&2&5&7&5&0&4&2\\
4&2&5&2&1&0&0&1&0&1&0&0&0&0&0&0&0&1&2&5&5&4&6&3&4&4&1&5\\
1&1&1&2&1&1&1&0&0&0&0&0&0&0&0&0&1&1&2&1&0&4&3&0&5&3&2&2\\
3&4&4&0&3&2&1&0&0&0&0&0&0&0&0&0&0&1&2&3&2&3&1&3&0&4&2&1\\
2&1&1&3&4&1&2&1&2&0&0&0&0&0&0&1&0&0&3&1&1&3&1&5&5&4&7&0\\
2&3&4&1&1&2&2&0&1&1&1&0&0&2&2&1&4&0&2&4&2&3&1&2&0&3&2&4\\
2&2&3&2&2&0&4&2&3&2&1&1&1&0&1&0&1&2&4&2&3&3&3&3&2&2&2&2\\
4&2&0&2&2&5&1&2&1&4&1&1&3&2&0&0&1&5&1&3&2&4&2&3&0&3&0&4\\
	\end{tabular}
};
%\draw[draw=black] (11.6,-8.5) rectangle ++(17,17);
\draw[draw=gray, dashed] (11.6,-8.5) rectangle ++(17,17);
\draw[-{Straight Barb[angle=60:2pt 3]}] (11.1, -8.5) -- (29.1, -8.5);
\node[] at (20.1, -9.5) {\HUGE{Horizontal position}};
\draw[-{Straight Barb[angle=60:2pt 3]}] (11.6, -9) -- (11.6, 9);
\node[rotate=90] at (10.6, 0) {\HUGE{Vertical position}};

\node[] at (0,9.5) {\SUPERHUGE{\textbf{Positive clauses}}};
\node[] at (20.1,9.5) {\SUPERHUGE{\textbf{Negative clauses}}};
\node[] at (32,0) {
\begin{tabular}{*{28}{G}}
20&20\\
19&19\\
18&18\\
17&17\\
16&16\\
15&15\\
14&14\\
13&13\\
12&12\\
11&11\\
10&10\\
9&9\\
8&8\\
7&7\\
6&6\\
5&5\\
4&4\\
3&3\\
2&2\\
1&1\\
0&0\\
\end{tabular}
};
\draw[draw=black] (31.4,-6) rectangle ++(1.1,12.3);
\draw[] (31.4,-6) -- (33.5, -6);
\node[] at (34.5,-6) {\HUGE{0}};
\draw[] (31.4,6.3) -- (33.5, 6.3);
\node[] at (34.5,6.3) {\HUGE{20}};
\draw[] (32.5,0.15) -- (33.5, 0.15);
\node[] at (34.5, 0.15) {\HUGE{10}};

\node[rotate=-90] at (37, 0.15) {\HUGE{Number of includes}};

\end{tikzpicture}
}
\vspace{-0.2cm}
\subfloat[]{
	\begin{tikzpicture}[scale=0.17,every node/.style={scale=0.17}]
\node[] at (0,0) {
	\begin{tabular}{*{28}{G}}
4&4&6&4&2&3&4&1&5&2&6&3&4&0&4&5&4&1&4&4&5&2&2&0&5&7&3&4\\
2&2&3&3&3&6&2&5&5&4&3&1&5&7&1&2&3&4&4&3&2&7&3&4&2&4&4&3\\
5&4&1&4&2&7&1&3&0&1&5&1&2&2&5&2&1&3&4&7&4&2&6&5&6&3&4&4\\
3&6&2&4&6&4&0&7&2&1&2&1&0&0&0&0&0&2&2&2&2&3&6&5&6&2&5&2\\
1&3&1&3&3&2&3&1&0&1&0&0&0&0&0&0&0&0&1&2&3&1&4&3&4&2&2&6\\
5&2&2&2&3&4&2&1&0&0&0&0&0&0&0&0&0&0&0&1&3&1&3&2&4&3&4&2\\
2&4&5&2&2&2&1&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&1&7&4&2&1&2\\
5&2&5&1&2&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&2&4&5&2&5&4\\
3&2&4&3&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&1&1&2&3&4&3&2\\
3&4&4&7&1&0&2&0&1&1&0&0&1&0&1&0&0&0&0&0&0&0&1&4&7&4&3&1\\
1&8&4&3&2&0&2&2&3&2&0&1&2&1&1&1&0&0&0&0&0&0&2&1&7&4&6&2\\
3&8&3&4&4&4&2&2&3&2&3&4&3&4&2&1&1&1&0&0&0&0&2&4&2&4&5&4\\
3&3&6&5&2&3&4&3&3&4&4&2&3&3&4&0&0&1&0&0&1&1&3&1&3&2&0&4\\
3&4&2&6&0&6&4&3&3&2&5&1&2&2&0&0&0&1&0&0&0&0&3&6&0&3&0&3\\
2&2&3&4&3&3&6&4&2&2&0&0&0&0&0&0&1&0&0&1&0&2&3&5&1&3&4&2\\
5&3&4&3&5&1&0&2&0&0&0&0&0&0&0&0&0&0&1&0&1&1&1&1&0&3&0&4\\
2&5&5&4&2&0&0&2&0&0&0&0&0&0&0&0&0&0&0&1&1&0&1&1&0&1&1&2\\
3&3&2&1&1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&2&2&0&0&0&0&0&2&3\\
3&5&4&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&4\\
5&3&5&2&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&1&1&3\\
2&5&3&4&1&1&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0&0&0&0&0&1&4&3\\
7&2&2&3&0&0&1&0&0&0&0&0&0&0&1&0&0&2&1&0&0&0&0&0&0&4&2&4\\
4&2&4&3&2&0&1&0&0&0&0&0&0&0&2&2&0&1&1&0&0&0&0&0&0&3&2&3\\
1&4&2&2&1&4&2&2&2&1&2&1&2&2&2&3&2&0&1&1&0&0&0&1&3&1&3&3\\
3&1&1&6&5&4&3&7&4&5&1&4&3&1&3&4&3&1&5&2&2&2&1&2&4&4&1&4\\
1&4&3&1&2&5&5&5&7&9&5&10&9&5&1&3&3&4&4&6&5&5&5&3&2&3&1&5\\
6&4&1&3&1&2&3&6&6&5&3&5&1&2&4&3&6&10&2&5&5&4&3&5&3&1&2&2\\
3&3&2&5&2&2&3&5&7&3&2&2&4&5&5&3&3&3&5&1&3&6&3&3&1&6&5&5\\
	\end{tabular}
};
%\draw[draw=black] (-8.5,-8.5) rectangle ++(17,17);
\draw[draw=gray, dashed] (-8.5,-8.5) rectangle ++(17,17);
\draw[-{Straight Barb[angle=60:2pt 3]}] (-9, -8.5) -- (9, -8.5);
\node[] at (0, -9.5) {\HUGE{Horizontal position}};
\draw[-{Straight Barb[angle=60:2pt 3]}] (-8.5, -9) -- (-8.5, 9);
\node[rotate=90] at (-9.5, 0) {\HUGE{Vertical position}};

\node[] at (20,0) {
	\begin{tabular}{*{28}{G}}
5&6&4&4&6&4&6&5&4&6&5&6&5&9&4&7&3&6&3&8&7&5&2&10&10&3&11&7\\
4&4&2&4&8&4&3&7&4&5&6&1&2&5&8&6&6&2&6&6&3&7&6&4&3&3&2&3\\
4&7&9&6&5&6&4&6&7&3&9&4&5&5&3&3&0&3&5&3&4&2&5&8&7&6&4&5\\
6&6&5&10&7&5&7&3&7&5&3&3&1&2&4&3&0&1&3&3&3&1&5&3&4&4&8&6\\
5&6&4&3&6&6&3&1&6&3&2&2&3&0&0&1&1&0&0&1&0&0&1&1&0&6&6&7\\
7&5&4&6&5&0&2&2&1&2&3&1&0&1&1&0&1&0&0&0&0&0&0&0&2&1&5&8\\
10&1&3&3&5&1&1&0&0&0&0&0&0&0&1&0&0&0&0&0&0&0&0&1&1&6&4&5\\
5&6&6&5&1&2&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&2&2&3&7\\
2&7&4&5&2&2&0&1&0&0&0&0&0&0&0&0&0&0&0&0&1&0&0&0&3&3&3&9\\
6&8&5&1&3&1&0&1&1&0&0&0&0&0&0&0&0&0&1&1&0&0&0&0&2&4&3&4\\
6&2&6&3&5&3&2&1&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&2&1&6&5&5\\
2&10&3&5&1&4&2&1&0&1&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0&7&7&7\\
8&2&6&7&3&4&4&2&2&0&0&0&0&0&0&0&0&0&0&1&0&0&1&2&5&8&4&6\\
6&7&5&5&2&1&3&2&0&0&1&0&1&0&0&0&0&0&0&0&0&1&0&2&9&16&10&10\\
5&3&9&3&0&2&2&6&1&0&0&0&0&0&0&0&0&0&0&0&0&0&3&6&5&5&8&5\\
6&4&2&9&1&5&2&4&0&0&0&0&0&0&0&0&0&0&0&0&0&0&4&4&10&8&7&7\\
8&6&7&3&4&0&1&2&2&0&2&1&0&0&0&0&0&0&0&0&0&3&4&4&5&12&12&7\\
7&11&3&4&2&2&1&0&1&0&1&2&2&1&0&0&0&0&0&0&0&4&5&7&11&8&4&2\\
7&4&4&4&4&1&1&1&0&1&0&1&1&0&1&1&0&0&0&0&2&4&4&9&12&8&7&7\\
6&10&1&2&4&0&1&1&1&1&0&2&0&2&0&1&0&0&0&2&3&4&6&5&10&4&9&5\\
4&4&5&1&2&1&2&1&1&2&0&1&0&0&0&0&0&0&1&4&6&8&8&9&8&5&8&4\\
8&6&2&2&2&1&0&0&0&1&1&0&0&0&0&0&0&0&4&5&3&2&6&7&9&9&4&11\\
5&12&4&6&1&1&2&1&0&1&0&0&0&0&0&0&0&3&3&3&4&6&2&7&6&8&4&9\\
6&5&8&1&5&2&0&1&2&0&0&0&0&0&0&0&0&4&5&5&4&5&8&7&4&6&8&8\\
8&5&12&6&5&1&3&2&0&0&0&0&0&0&0&0&2&4&7&6&3&7&5&6&6&5&4&6\\
4&6&3&6&7&2&3&1&2&1&0&3&0&1&0&3&2&2&4&2&3&6&3&5&8&5&6&7\\
10&6&9&4&3&5&3&5&2&2&2&3&3&1&1&2&1&6&3&1&3&5&8&7&8&7&6&5\\
10&3&3&7&4&7&5&5&3&4&6&5&5&7&2&4&6&3&6&3&1&4&6&8&6&7&4&10\\
	\end{tabular}
};
%\draw[draw=black] (11.6,-8.5) rectangle ++(17,17);
\draw[draw=gray, dashed] (11.6,-8.5) rectangle ++(17,17);
\draw[-{Straight Barb[angle=60:2pt 3]}] (11.1, -8.5) -- (29.1, -8.5);
\node[] at (20.1, -9.5) {\HUGE{Horizontal position}};
\draw[-{Straight Barb[angle=60:2pt 3]}] (11.6, -9) -- (11.6, 9);
\node[rotate=90] at (10.6, 0) {\HUGE{Vertical position}};

\node[] at (0,9.5) {\SUPERHUGE{\textbf{Positive clauses}}};
\node[] at (20.1,9.5) {\SUPERHUGE{\textbf{Negative clauses}}};
\node[] at (32,0) {
	\begin{tabular}{*{28}{G}}
	20&20\\
	19&19\\
	18&18\\
	17&17\\
	16&16\\
	15&15\\
	14&14\\
	13&13\\
	12&12\\
	11&11\\
	10&10\\
	9&9\\
	8&8\\
	7&7\\
	6&6\\
	5&5\\
	4&4\\
	3&3\\
	2&2\\
	1&1\\
	0&0\\
	\end{tabular}
};
\draw[draw=black] (31.4,-6) rectangle ++(1.1,12.3);
\draw[] (31.4,-6) -- (33.5, -6);
\node[] at (34.5,-6) {\HUGE{0}};
\draw[] (31.4,6.3) -- (33.5, 6.3);
\node[] at (34.5,6.3) {\HUGE{20}};
\draw[] (32.5,0.15) -- (33.5, 0.15);
\node[] at (34.5, 0.15) {\HUGE{10}};

\node[rotate=-90] at (37, 0.15) {\HUGE{Number of includes}};

\end{tikzpicture}
}
\vspace{-0.2cm}			
\caption{Number of includes for all complemented features, represented in a 28$\times$28 image coordinate, for MNIST digit `2', after (a) 1 and (b) 50 epochs. More includes are induced as training proceeds. The included features are located both around the digit outline (as relatively significant features) and near the image border (as less significant features).}
	\label{fig:mnist_vanilla}

\Description[interpretable results for MNIST]
    
\end{figure}