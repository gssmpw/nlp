\begin{figure}[!htb]
\vspace{-0.3cm}
\centering
\begin{tikzpicture}[font=\small]
\draw[-] (2,-0.7) -- (2,-1.1);
\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners, fill=white] at (2,-0.7) {\textbf{Raw dataset}};
\draw[] (2,-1.1) to [bend left] (1.9,-1.2);
\draw[] (1.9,-1.2) -- (1,-1.2);
\draw[] (1,-1.2) to [bend right] (0.9,-1.3);
\draw[-stealth] (0.9,-1.3) -- (0.9,-1.45); 

\draw[draw=none, fill=gray, opacity=0.5] (-1.5,-1.3) rectangle ++(3.2, -1.6);
\node [draw=none, fill=gray!50!white, shape=rectangle, minimum width=0.8cm] at (-0.43,-1.1) {\textbf{Booleanization}};

\draw[dashed, rounded corners, semithick] (2, -1.3) rectangle ++(4.9, -3.7);
\node [] at (5.7, -1.1) {Hyperparameters};

\draw[-stealth] (0,-1.7) -- (0,-2.25); 

\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners, fill=white] at (0,-1.7) {Quantile binning};
\draw[-stealth, dashed] (4.5, -1.7) -- (1.1, -1.7);
\node[trapezium, draw, thick, minimum width=0.3cm, trapezium left angle=75, trapezium right angle=105, trapezium stretches=true, minimum height=0.3cm, fill=white] at (4.5,-1.7) {Number of bins};

\draw[-stealth] (0,-2.7) -- (0,-3.75); 

\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners, fill=white] at (0,-2.5) {Encoding};
\draw[-stealth, dashed] (4.5, -2.5) -- (0.65, -2.5);
\node[trapezium, draw, thick, minimum width=0.3cm, trapezium left angle=75, trapezium right angle=105, trapezium stretches=true, minimum height=0.3cm, fill=white] at (4.5,-2.5) {One-hot or thermometer};

\draw[-stealth] (0,-4) -- (0,-5.25); 
\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners, fill=white] at (0,-4) {\textbf{Off-platform training}};
\draw[-stealth, dashed] (3, -4) -- (1.5, -4);
\node[trapezium, draw, thick, minimum width=0.3cm, trapezium left angle=75, trapezium right angle=105, trapezium stretches=true, minimum height=0.3cm, fill=white] at (4.5,-4) {\begin{tabular}[c]{@{}c@{}} Total number of epochs, \\ number of clauses, $T$, $s$, \\ number of epochs after \\ each exclusion  \end{tabular}};

\draw[-stealth] (0,-5.7) -- (2.95,-5.7); 
\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners, fill=white] at (0,-5.7) {\begin{tabular}[c]{@{}c@{}} \textbf{Model exporting}: \\ REDRESS ecnoding \cite{maheshwari2023redress} \end{tabular}};

\node [draw, thick, shape=rectangle, minimum width=0.8cm, rounded corners] at (4.5,-5.7) {\textbf{On-platform inference}};

\end{tikzpicture}
\vspace{-0.6cm}
\caption{ML pipeline used for generating TM models for experimental validations.}
\label{fig:pipeline}

\Description[design pipeline]

\end{figure}
