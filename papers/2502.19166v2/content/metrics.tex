\section{Metrics}

Ensuring that large language models (LLMs) accurately follow instructions is crucial for code generation. To precisely evaluate this capability, we introduce four novel metrics designed to assess how LLMs handle code generation tasks with multiple constraints: \textbf{Completely Satisfaction Rate (CSR)}, \textbf{Soft Satisfaction Rate (SSR)}, \textbf{Rigorous Satisfaction Rate (RSR)}, and \textbf{Consistent Continuity Satisfaction Rate (CCSR)}. These metrics provide a comprehensive evaluation from different perspectives.

For a dataset with $m$ problems, each problem contains a set of $n_i$ constraints. We define CSR and SSR as follows:

\paragraph{Completely Satisfaction Rate (CSR)}
\begin{equation}
\text{CSR} = \frac{1}{m} \sum_{i=1}^{m} \left( \prod_{j=1}^{n_i} r_{i,j} \right)
\end{equation}
where $r_{i,j} \in [0,1]$ indicates whether the $j$-th constraint in the $i$-th problem is satisfied. CSR measures the proportion of problems where all constraints are fully met.

\paragraph{Soft Satisfaction Rate (SSR)}
\begin{equation}
\text{SSR} = \frac{1}{m} \sum_{i=1}^{m} \left( \frac{\sum_{j=1}^{n_i} r_{i,j}}{n_i} \right)
\end{equation}
SSR evaluates the average proportion of constraints satisfied per problem, providing a more flexible assessment.

\paragraph{Rigorous Satisfaction Rate (RSR)}
In code generation, some constraints depend on prior instructions, particularly in \textbf{Combination} constraints. To account for dependencies, we define RSR as:
\begin{equation}
\text{RSR} = \frac{1}{m} \sum_{i=1}^{m} \left( \frac{\sum_{j=1}^{n_i} \left[ r_{i,j} \cdot \prod_{k \in D_{i,j}} r_{i,k} \right]}{n_i} \right)
\end{equation}
where $D_{i,j}$ represents the set of constraints that the $j$-th constraint in the $i$-th problem depends on. RSR ensures that models satisfy prerequisite constraints before fulfilling dependent ones.

\paragraph{Consistent Continuity Satisfaction Rate (CCSR)}
In many code generation tasks, maintaining continuous adherence to instructions is essential. To measure this ability, we define CCSR as:
\begin{equation}
\small
\text{CCSR} = \frac{1}{m} \sum_{i=1}^{m} \frac{L_i}{n_i}, \\
L_i = \max \Bigl\{ l \,\Big|\, \exists t \mathbin{\in} [1, n_i{-}l{+}1],\ 
\prod_{\mathclap{j=t}}^{\mathclap{t+l-1}} r_{i,j} = 1 \Bigr\}
\end{equation}
where $L_i$ represents the longest consecutive sequence of satisfied constraints in problem $i$. CCSR evaluates a modelâ€™s consistency in following sequential instructions without errors.


