%|>>|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|>>|
%|>>|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|>>|
%|>>|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|>>|
\begin{proof}
{\LEMMA \ref{lemma:large-dist:1}}
%
\checkoff%
%
Let
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \thetaStar \in \ParamSpace  \)
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
be arbitrary.
Write
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \ParamCoverX \defeq \ParamCover \setminus \Ball{\tauX}( \thetaStar )  \).
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
%Initially, fix
For the time being, fix
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \JCoords \in \JS  \) and \(  \thetaX \in \ParamCoverX  \)
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
arbitrarily---to be varied over all possible choices later---and let
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \JCoordsX \defeq \Supp( \thetaX ) \cup \JCoords  \).
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
By \EQUATION \eqref{eqn:lemma:concentration-ineq:ev:4} in \LEMMA \ref{lemma:concentration-ineq},
%|>>|===========================================================================================|>>|
\begin{gather}
\label{eqn:pf:lemma:large-dist:1:2}
  \DENOM
  =
  \sqrt{\frac{\pi}{2}} \gammaX
,\end{gather}
%|<<|===========================================================================================|<<|
and thus, substituting \EQUATION \eqref{eqn:pf:lemma:large-dist:1:2} into the \RHS of \EQUATION \eqref{eqn:lemma:large-dist:1:ub} in \LEMMA \ref{lemma:large-dist:1} yields
%|>>|===========================================================================================|>>|
\begin{gather}
\label{eqn:pf:lemma:large-dist:1:3}
  \frac
  {2 \| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E[ \hFn[\JCoords]( \thetaStar, \thetaX ) ] \|_{2}}
  {\DENOM}
  =
  \frac
  {2 \| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E[ \hFn[\JCoords]( \thetaStar, \thetaX ) ] \|_{2}}
  {\sqrt{\hfrac{\pi}{2}} \gammaX}
.\end{gather}
%|<<|===========================================================================================|<<|
Towards bounding the term
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\({  \| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E[ \hFn[\JCoords]( \thetaStar, \thetaX ) ] \|_{2}  }\)
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
in the numerator on the \RHS of \EQUATION \eqref{eqn:pf:lemma:large-dist:1:3},
consider \EQUATION \eqref{eqn:lemma:concentration-ineq:pr:1} in \LEMMA \ref{lemma:concentration-ineq}, where \(  \sXX, \tX \in (0,1)  \) are taken to be
%|>>|===========================================================================================|>>|
\begin{gather}
\label{eqn:pf:lemma:large-dist:1:s}
  \sXX
  \defeq
  \sqrt{
    \frac{
      3\pi \log \left( \frac{3}{\rhoLDX} | \ParamCover | \right)
    }{
      \m \EDIST
    }
  }
,\end{gather}
%|<<|===========================================================================================|<<|
and
%|>>|===========================================================================================|>>|
\begin{align*}
  \tX
  &\defeq
%  \max \left\{
%  \sqrt{
%    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
%         {\m \EDIST}}
%  ,
%  \sqrt{
%    \frac{2\pi ( 1+\sXX ) \log \left( \frac{3}{\rhoLDX} | \JS | | \ParamCover | \right)}
%         {\m \EDIST}
%  }
%  \right\}
%  \\
%  &\leq
%  \max \left\{
%  \sqrt{
%    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
%         {\m \EDIST}}
%  ,
%  \sqrt{
%    \frac{4\pi \log \left( \frac{3}{\rhoLDX} | \JS | | \ParamCover | \right)}
%         {\m \EDIST}
%  }
%  \right\}
%  \\
%  &=
  \sqrt{
    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}}
\TagEqn{\label{eqn:pf:lemma:large-dist:1:t}}
,\end{align*}
%|<<|===========================================================================================|<<|
and where \(  \m  \) is at least
%|>>|===========================================================================================|>>|
\begin{align}
\label{eqn:pf:lemma:large-dist:1:m}
  \m
  \geq
  \frac{16}{\GAMMAX^{2} \deltaX}
  \max \left\{
    27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)
    ,
    4 ( \kO-2 )
  \right\}
  % \frac{8}{\pi \GAMMAX^{2} \deltaX}
  % \max \left\{
  %   54\pi^{2} \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)
  %   ,
  %   8\pi ( \kO-2 )
  % \right\}
.\end{align}
%|<<|===========================================================================================|<<|
This bound on \(  \m  \) suffices to ensure that under the lemma's condition that
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \thetaX \in \ParamCoverX = \ParamCover \setminus \Ball{\tauX}( \thetaStar )  \),
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
the variable \(  \sXX  \) satisfies the requirement that
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  \sXX < 1  \),
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
which further implies that
%|>>|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|>>|
\(  1+\sXX < 2  \).
%|<<|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|<<|
Hence also,
%|>>|===========================================================================================|>>|
\begin{align*}
  \tX
  &=
  \sqrt{
    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}}
  \\
  &=
  \max \left\{
  \sqrt{
    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}}
  ,
  \sqrt{
    \frac{4\pi \log \left( \frac{3}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}
  }
  \right\}
  \\
  &=
  \max \left\{
  \sqrt{
    \frac{27\pi \log \left( \frac{12}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}}
  ,
  \sqrt{
    \frac{2\pi ( 1+\sXX ) \log \left( \frac{3}{\rhoLDX} | \JS | | \ParamCover | \right)}
         {\m \EDIST}
  }
  \right\}
\TagEqn{\label{eqn:pf:lemma:large-dist:1:t:b}}
.\end{align*}
%|<<|===========================================================================================|<<|
Moreover, with these choices,
%|>>|===========================================================================================|>>|
\begin{align*}
  & \negphantom{\AlignSp}
  \sqrt{\frac{\pi ( 1+\sXX )( \kO-2 ) \EDIST}{\m}}
  +
  \sqrt{\frac{\pi}{2}} \tX \EDIST
  \\
  &\leq
  \frac{1}{2} \cdot \sqrt{\frac{\pi}{8}} \gammaX \sqrt{\deltaX \EDIST}
  +
  \frac{1}{2} \cdot \sqrt{\frac{\pi}{8}} \gammaX \sqrt{\deltaX \EDIST}
  \\
  &=
  \sqrt{\frac{\pi}{8}} \gammaX \sqrt{\deltaX \EDIST}
\TagEqn{\label{eqn:pf:lemma:large-dist:1:4}}
.\end{align*}
%|<<|===========================================================================================|<<|
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\par %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
For any random variable \(  U  \) taking values in \(  \Set{S} \subseteq \R  \), and for values \(  u \leq u' \in \Set{S}  \), the event that \(  U \leq u  \) implies \(  U \leq u'  \), and therefore,
%|>>|===========================================================================================|>>|
\begin{gather}
\label{eqn:pf:lemma:large-dist:1:5}
  \Pr( U \leq u ) \leq \Pr( U \leq u' )
  ,\quad
  u \leq u'
.\end{gather}
%|<<|===========================================================================================|<<|
Combining these observations with \EQUATION \eqref{eqn:lemma:concentration-ineq:pr:1} in \LEMMA \ref{lemma:concentration-ineq} yields:
%|>>|===========================================================================================|>>|
\begin{align*}
  & \textstyle
  \Pr \left(
    \Forall{\JCoords \in \JS, \thetaX \in \ParamCoverX}{
    \left\| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E \left[ \hFn[\JCoords]( \thetaStar, \thetaX ) \right] \right\|_{2}
    \leq
    \sqrt{\frac{\pi}{8}} \gammaX \sqrt{\deltaX \EDIST}
    }
  \right)
  \\
  & \textstyle \geq
  \Pr \left(
    \Forall{\JCoords \in \JS, \thetaX \in \ParamCoverX}{
    \left\| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E \left[ \hFn[\JCoords]( \thetaStar, \thetaX ) \right] \right\|_{2}
    \leq
    \sqrt{\frac{\pi ( 1+\sXX )( \kO-2 ) \EDIST}{\m}}
    +
    \sqrt{\frac{\pi}{2}} \tX \EDIST
    }
  \right)
  \\
  &\dCmt{by \EQUATIONS \eqref{eqn:pf:lemma:large-dist:1:4} and \eqref{eqn:pf:lemma:large-dist:1:5}}
  \\
  & \textstyle \geq
  \Pr \left(
    \Forall{\JCoords \in \JS, \thetaX \in \ParamCoverX}{
    \left\| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E \left[ \hFn[\JCoords]( \thetaStar, \thetaX ) \right] \right\|_{2}
    \leq
    \sqrt{\frac{2 ( 1+\sXX )( \kO-2 ) \ADIST}{\m}}
    +
    \sqrt{\frac{2}{\pi}} \tX \ADIST
    }
  \right)
  \\
  &\dCmt{\(  \ADIST \leq \frac{\pi}{2} \EDIST  \) by \FACT \ref{fact:d_angular-d_S}}
  \\
  &\geq
  1
  -
  4 | \JS | | \ParamCoverX | e^{-\frac{1}{27\pi} \m \tX^{2} \ADIST}
  -
  | \JS | | \ParamCoverX | e^{-\frac{1}{2\pi ( 1+\sXX )} \m \tX^{2} \ADIST}
  -
  | \ParamCoverX | e^{-\frac{1}{3\pi} \m \sXX^{2} \ADIST}
  \\
  &\dCmt{by \EQUATION \eqref{eqn:lemma:concentration-ineq:pr:1}}
  \\
  &\geq
  1
  -
  4 | \JS | | \ParamCoverX | e^{-\frac{1}{27\pi} \m \tX^{2} \EDIST}
  -
  | \JS | | \ParamCoverX | e^{-\frac{1}{2\pi ( 1+\sXX )} \m \tX^{2} \EDIST}
  -
  | \ParamCoverX | e^{-\frac{1}{3\pi} \m \sXX^{2} \EDIST}
  \\
  &\dCmt{\(  \ADIST \geq \EDIST  \) due to \FACT \ref{fact:d_angular-d_S}}
  \\
  &\geq
  1 - \frac{\rhoLDX}{3} - \frac{\rhoLDX}{3} - \frac{\rhoLDX}{3}
  \\
  &\dCmt{by the choice of \(  \sX, \tX  \) in \EQUATIONS \eqref{eqn:pf:lemma:large-dist:1:s} and \eqref{eqn:pf:lemma:large-dist:1:t}, respectively, and by \EQUATION \eqref{eqn:pf:lemma:large-dist:1:t:b}}
  \\
  &=
  1 - \rhoLDX
%  \\
%  &\geq
%  1
%  -
%  4 | \JS | | \ParamCoverX | e^{-\frac{1}{27\pi} \tauX \m \tX^{2}}
%  -
%  2 | \JS | | \ParamCoverX | e^{-\frac{\tauX \m \tX^{2}}{144 \pi ( 1+\sXX ) ( \kO-2 )}}
%  -
%  | \ParamCoverX | e^{-\frac{1}{3\pi} \tauX \m \sXX^{2}}
%  \\
%  &\dCmt{\(  \because \thetaX \in \ParamCoverX = \ParamCover \setminus \Ball{\tauX}( \thetaStar )  \) implies \(  \EDIST \geq \tauX  \)}
\TagEqn{\label{eqn:pf:lemma:large-dist:1:7}}
.\end{align*}
%|<<|===========================================================================================|<<|
%\ToDo{Check if the constant inside the log for the expression for \(  \sX  \) should be 3 instead of 6. (I changed it from 6 to 3, but need to double-check that that is correct.)}
Returning to \EQUATION \eqref{eqn:pf:lemma:large-dist:1:3} and inserting \EQUATION \eqref{eqn:pf:lemma:large-dist:1:7}, it follows that if \(  \m  \) satisfies \EQUATION \eqref{eqn:pf:lemma:large-dist:1:m}, then with probability at least \(  1-\rhoLDX  \), for all \(  \JCoords \in \JS  \) and \(  \thetaX \in \ParamCoverX  \),
%|>>|===========================================================================================|>>|
\begin{align*}
  \frac
  {2 \| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E[ \hFn[\JCoords]( \thetaStar, \thetaX ) ] \|_{2}}
  {\DENOM}
  &=
  \frac
  {2 \| \hFn[\JCoords]( \thetaStar, \thetaX ) - \E[ \hFn[\JCoords]( \thetaStar, \thetaX ) ] \|_{2}}
  {\sqrt{\hfrac{\pi}{2}} \gammaX}
  \\
  &\leq
  \sqrt{\frac{8}{\pi}} \frac{1}{\gammaX}
  \sqrt{\frac{\pi}{8}} \gammaX
  \sqrt{\deltaX \EDIST}
  \\
  &=
  \sqrt{\deltaX \EDIST}
,\end{align*}
%|<<|===========================================================================================|<<|
as desired.
\end{proof}
%|<<|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|<<|
%|<<|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|<<|
%|<<|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|<<|