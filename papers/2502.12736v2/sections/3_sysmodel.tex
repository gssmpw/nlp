\section{System Model}\label{sec_sysmod}

We consider a system comprising an ED hosting a wireless network for groups of users, where each user connects to the network with its own user device~(UD) carried in close proximity.
The wireless network possesses ISAC capability as the ED uses the uplink CSI to sense each user.
Here, we focus on general discriminative sensing tasks as they are one of the most common tasks in ISAC sensing services.
Without loss of generality, we refer to the sensing target uniformly as \emph{user activity}, regardless of its actual physical meaning.

With its limited computational and memory resources, the ED trains an EI to learn the intricate relationship between CSI variations and user activities. 
However, due to notoriously strong multi-path interference in wireless channels, this relationship, referred to as a \emph{domain}, can be highly specific to surrounding environment and user characteristics.
As a result, the EI tends to be domain-specific and face difficulties in applying to other domains.
\Copy{E-1-2}{\frev{For the considered system, users are designated as the domains since users change while the ED is fixed in an environment, and user characteristics have a determinant impact on the CSI-activity relationship, which will be demonstrated in Sec.~\ref{s3ec_influence}.}}
\Copy{R1-2}{\frev{In other ISAC systems, domains can be represented differently.
For example, if the UD senses its user by downlink CSI, domains can be the EDs that the UD connects to, whose distinct antenna and frequency band determine the CSI-activity relationship.
Furthermore, for the EI of a mono-static ISAC system as in~\cite{He24TWC_Integrated}, domains can be the environmental conditions, which determine the signal echoes associated with user activities.}}

To endow the EI with cross-domain sensing capability, the most effective method is to train it on sufficient training datasets for target domains, referred to as the domain datasets; yet, this is impractical since the ED has limited memory resources and cannot afford storing all domain datasets.
%
To facilitate addressing the challenges faced by the EI in wireless ISAC networks, below, we establish a general model of the CSI in wireless transmissions, demonstrating its domain specificity.
In addition, we define the EI model and outline how the domain datasets are collected and used.



%========================================
\subsection{CSI in Wireless Transmissions}\label{s2ec_channel_model}
%========================================
\subsubsection{Model of CSI}
In view of the symmetric status of each user and its UD, we hereby focus on the CSI between an arbitrary UD and the ED.
Given an uplink data transmitted by a UD as the Tx, the ED as the Rx obtains a CSI sample by using the channel sounding mechanism~\cite{IEEE_standard, 3GPP_TS_138_211}.
Here, a \emph{CSI sample} comprises the channel gains measured by the ED at a certain time for each pair of Tx-Rx antennas over the transmission bandwidth.
Specifically, for a pair of Tx and Rx antennas, within a time duration $T$ and bandwidth $B$, the CSI of frequency $f$ and time $t$ can be modeled as~\cite{goldsmith2005wireless,Chen23ACS_CDWIFI}:
\beq
\label{equ_csi}
h(f,t) = \big(h_{\rstatic}(f) + h_{\rdyna}(f, t) + h_{\rU}(f, t) + \epsilon(f, t)\big) e^{\iu \varphi(f,t)},
\eeq
where $h_{\rU}(f, t)\in\mathbb C$ denotes the channel gain for the dynamic scattering paths relating to the movements of the UD's user, which lays the foundation of sensing the user's activities. 
In contrast, the other terms in~\eqref{equ_csi} constitute interference for the sensing:
$h_{\rstatic}(f)\in\mathbb C$ represents the channel gain for static paths;
$h_{\rdyna}(f, t)\in\mathbb C$ represents the channel gain resulting from user-independent dynamic paths, such as scattering on moving surroundings or on other users;
and $\epsilon(f,t)\in\mathbb C$ denotes the noise that exists inherently in wireless channels.

Besides, in~\eqref{equ_csi}, the phase shift $\varphi(f,t)\in\mathbb R$ represents the random phase error caused by the inevitable unsynchronization between wireless transceivers, resulting from carrier frequency offset, sampling time offset, packet detection delay, etc~\cite{Chen23ACS_CDWIFI}.
Theoretically, $\varphi(f,t)$ can be modeled as a random variable following a uniform distribution within $[0,2\pi)$, $h_{\rstatic}(f)$ can be modeled as a constant complex number, and $\epsilon(f,t)$ can be modeled as a small random variable following complex Gaussian distribution. 
Moreover, based on~\cite{goldsmith2005wireless}, $h_{\rU}(f, t) $ and $h_{\rdyna}(f, t)$ can be modeled approximately by the sum of gains of $S$ scattering paths.
We can focus on the paths experience single scattering since multiple scattering causes significant attenuation.
Therefore, $h_{\rU}(f, t) $ can be expressed as
\begin{align}
    \label{equ_user_gain}
    & h_{\rU}(f,t) =\sum_{s=1}^S   \frac{\lambda \sqrt{G^{(s)}\alpha_{\rU}^{(s)}}\cdot e^{-\iu 2\pi (d_{\rTx, \rU}^{(s)}(t)+d_{\rRx, \rU}^{(s)}(t))/\lambda}}{ (4\pi)^{3/2} d_{\rTx, \rU}^{(s)}(t)\cdot d_{\rRx, \rU}^{(s)}(t) },
\end{align}
where $s$ is the index of the scattering paths, $\lambda = c/f$ is the wavelength of frequency $f$ with $c$ being the light speed, and $\iu$ is the imaginary unit.
Moreover, ${G^{(s)}}$ and $\alpha_{\rU}^{(s)}$ denote the antenna gain and radar cross section for the scattering path, respectively, and $d_{\rTx, \rU}^{(s)}(t)$ and $d_{\rRx, \rU}^{(s)}(t)$ denote the distance from the Tx and Rx antennas to the scattering point of the $s$-th path at time $t$.
Similar to $h_{\rU}(f, t)$, channel gain $h_{\rdyna}(f, t)$ can be modeled by~\eqref{equ_user_gain} with subscript ``$\rU$'' substituted by ``$\rdyna$''.


\subsubsection{Analysis of Domain Specificity} \label{s3ec_influence}
From~\eqref{equ_csi} and~\eqref{equ_user_gain}, it can be observed that sensing the user activity with CSI is susceptible to multiple of interference and noise.
Although the phase error $\varphi(f,t)$ can be handled by conjugate multiplication~\cite{Li17Ubicomp_IndoTrack} (details in Sec.~\ref{sec_alg_1}), and the static gain $h_{\rstatic}(f)$ and the noise $\epsilon(f, t)$ can be handled through band-pass filtering, it is difficult to separate between $h_{\rdyna}(f,t)$ and $h_{\rU}(f,t)$.
This is because the other users' movements are similar to the target user's movements, resulting in similar channel variations as indicated by~\eqref{equ_user_gain}.
Fortunately, in the considered daily scenarios where users keep their UDs in a close distance~(e.g., 20\!~cm), obtaining the CSI variations of the target user is feasible.
Specifically, based on~\cite[Eqn. (4)]{Hu2023Mobicom_Muse}, the following relationship between the CSI variation rates of  $ h_{\rU}^{(s)}$ and $ h_{\rdyna}^{(s)}$ can be derived
\beq
\label{equ_powerRatio_prop}
\frac{|\partial h_{\rU}^{(s)}/\partial t|}{|\partial h_{\rdyna}^{(s)}/\partial t|} \propto
    \Big(\frac{d_{\rTx, \rU}^{(s)}(t)}{d_{\rTx, \rdyna}^{(s)}(t)}\Big)^{-1},
\eeq
where $h_{\rU}^{(s)}$ and $h_{\rdyna}^{(s)}$ denote the gain of the $s$-th path of $h_{\rU}(f,t)$ and $h_{\rdyna}(f,t)$, respectively.
Therefore, since the Tx antenna of the UD is closer to the user while further away from the surroundings and other users, then $d_{\rTx, \rU}^{(s)}(t)\!\ll\! d_{\rTx, \rdyna}^{(s)}(t)$, indicating that the CSI variations caused by the user's movements dominate that caused by other users. 

\Copy{R1-1-1}{Although the close proximity between user and its UD helps separate the CSI variations caused by the user from those induced by other dynamics, it leads to higher domain specificity of the CSI-activity relationship \frev{compared with when the user is far from its UD.}} 
From~\eqref{equ_user_gain}, it is evident that the mapping between CSI and user activity largely depends on the detailed positions and scattering characteristics of the user's scattering points.
\Copy{R1-1-2}{Therefore, for CSI-based sensing in close proximity to the UD, subtle nuances in user behavior have a more pronounced impact \frev{compared with non-proximity sensing.}}  
The following corollary provides a theoretical explanation.

\input{sections/analyses/collary_1.tex}

\Copy{R1-1-3}{Eqn.~\eqref{equ_pos_influence} indicates that when a user is closer to its UD, the CSI variation rate changes more rapidly with the deviation of the scattering point \frev{than when the user is farther away.}} 
Although this implies a higher sensitivity, it also means that the discrepancy among the users' contours and subtle movements will be more influential.
In summary, in scenarios where users are in close proximity to their UDs, the resulting CSI variations can effectively capture the user's activity with minimal interference from other users or environmental dynamics. 
However, this comes at the cost of increased domain specificity of the CSI-activity mapping to individual user nuances.





%========================================
\subsection{Edge Intelligence in Wireless ISAC Network}\label{s2ec_protocol}

%========================================
Without loss of generality, an EI can be represented as a neural model, which in essential is a parameterized mapping $\bfg(\cdot ; \bm \theta): \mathcal H \rightarrow \mathcal P$.
Here, $\bfg$ represents the architecture of the neural model, and $\bm\theta\in\mathbb R^{V}$ is its trainable parameters of size $V$. 
In wireless ISAC networks, the input space $\mathcal H$ is the space of time series of CSI samples within duration $T$, each of which is represented by a matrix $\bm H$ referred to as \emph{CSI data}, i.e.,
\beq
\label{equ_csi_data}
\mathcal H \!=\! \{ \bm H\!\in\!\mathbb C^{N\!\times\! (1+L_{\rH})} | ~[\bm H]_{n} \!=\! (t[n], \bm h[n]), n\!=\!1,...,N\!\}, 
\eeq
where $N$ and $n$ denote the number of CSI samples and its index, respectively, 
and $t[n]\in [0,T]$ is the sampling time corresponding to the $n$-th data packet.
We note that the sequence of $t[n]$ is generally nonequispaced according to practical data traffic.
Vector $\bm h[n]\in\mathbb C^{L_{\rH}}$ denotes the $n$-th CSI sample, comprising $L_{\rH}$ elements, and each element represents a channel gain measurement of a certain subcarrier and a Tx-Rx link as defined in~\eqref{equ_csi}.
For the output space $\mathcal P$, it comprises probability vectors for $C$ classes of user activities, i.e.,
\beq
\label{eq_cP}
\mathcal P = \{\bm p\in \mathbb R^C| \sum_{j=1}^C p_j=1,~\bm 0\preceq\bm p\preceq\bm 1\},
\eeq
\Copy{R3-3}{\frev{where the number of classes $C$ is a predetermined integer and known to the EI.}}

Therefore, the sensing of the EI is equivalent to processing $\bm H$ by $\bm p = \bfg(\bm H; \bm \theta)$, where both the architecture $\bfg$ and the parameter vector $\btheta$ play a crucial role.
However, determining them analytically is prohibitively challenging due to the highly intricate relationship between $\bm H$ and $\bm p$, which cannot be addressed in closed-form. 
In contrast, deep learning techniques leverage a general neural network architecture and optimize parameters on training datasets, offering a powerful solution that achieves superior accuracy.

In particular, a training dataset for the EI comprises CSI data and activity labels sampled following the distribution $\varGamma$ of a certain domain, i.e., $\mathcal D=\{ (\bm H_m, \hat{\bm p}_m)\csim \varGamma\}_{m=1}^M$, and thus we refer to $\mathcal D$ as \emph{domain dataset}.
Here, $\hat{\bm p}_m$ represents class label of $\bm H_m$ in the form of a one-hot vector, $M$ denotes the size of domain dataset.
Owing to the significant influence of users' nuances on the CSI as analyzed in Sec.~\ref{s3ec_influence}, the domain is highly dependent on the users whom the CSI data are associated with.
Notably, a neural model is only statistically guaranteed to perform well for the domain of its training dataset, and using it in a different domain, i.e., for a different user, generally leads to poor performance~\cite{goodfellow2016deep}.
Therefore, to develop cross-domain sensing capability and ensure high sensing performance across all users, the EI must be trained on various domain-specific datasets.


However, due to the ED's limited memory resources, storing all domain datasets is impractical. 
For instance, with a sampling rate of 100 packets per second, an 80 MHz bandwidth, and $2 \times 2$ Tx-Rx pairs, a 20-activity dataset for 20 users will exceed 100 GB if each activity involves just 5 minutes of CSI data. 
This imposes a significant storage burden on the ED and results in substantial overhead if the data is uploaded to a cloud server. 
Moreover, as these datasets are collected over extended periods, the need for periodic retraining to incorporate new domains adds a considerable computational load.


To alleviate such heavy memory burdens, a potential approach is for the EI to sequentially learn the domain datasets collected over different time periods. 
For clarity, we assume that in the $k$-th~($k=1,\dots,K$) period, a domain dataset $\mathcal{D}_k$ is collected. 
The EI then updates the neural model's parameters $\btheta$ using $\mathcal{D}_k$ before discarding the dataset to free up memory. 
We note that, without loss of generality, a domain dataset may contain labeled CSI data from multiple users, while different domain datasets correspond to different users.
Although this approach alleviates storage pressure, it introduces the challenge of catastrophic forgetting during sequential learning. 
In the following section, we formally formulate this issue and propose the \name framework to address it.




\endinput