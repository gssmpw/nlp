\begin{figure}[!t]
    \vspace{-0.7em}
    \begin{algorithm}[H]
    \small
    \caption{Robustness-enhanced sequential training with distilled core-set replay for transformer-based discriminator.}
    \label{alg_overall}
    \begin{algorithmic} [1]
        \Require \Copy{R3-4}{\frev{Number of classes $C$, number of exemplars per class $E$, confidence downscaling factor $\eta$, clustering-herding ratio $\beta$, deviation radius $\epsilon$, and learning rate $\alpha$.}}
        \State Initialize $\bgun(\cdot; \btheta)$ based on transformer-based architecture in Sec.~\ref{sec_alg_1} with random parameters, and set $\cK_1=\emptyset$.
        \For{Period $k=1,\dots, K$}
            \State Collect domain dataset $\cD_{k} = \{(\bm H, \hat{\bm p})\}$ for new users. 
            \State With $\cD_{k}$ and $\cK_{k}$, solve the robustness-enhanced optimization~\eqref{equ_sam} by the parameter update in~\eqref{equ_param_update} for $I$ iterations.
            \State Generate feature vector set $\cF_k$ by processing CSI data in $\cD_k$ with $\hat{\bgun}(\cdot;\btheta^*_k)$. 
            \For{Class $c=1,\dots, C$}
                \State Select set ${\cS}_{k,c}$ of $E$ exemplars based on $\cF_{k,c}$ by hybrid clustering and herding method in~\eqref{equ_kmeans} and~\eqref{equ_herding}. 
                \State With $\bgun_{\eta}(\cdot;\btheta^*_k)$, predict probabilities for feature vectors in $\cS_{k,c}$ to obtain $\tilde{\cS}_{k,c}$.
            \EndFor
            \State Update the knowledge core-set by $\cK_{k+1} = \cK_{k} \cup \{\tilde{\cS}_{k,c}\}_{c=1}^C$.
            \State Discard $\cD_k$ to free the memory for the next domain dataset.
        \EndFor
    \end{algorithmic}
\end{algorithm}
\vspace{-1.em}
\end{figure}
\endinput

