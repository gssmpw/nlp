\newtheorem{theorem}{Theorem}[section]
\newtheorem{proof}{Proof}[section]

Based on the aforementioned  knowledge profile associated with RBAC policy and the virtual resource vulnerability model related to the cloud \cite{almutairi2014risk}, we now formally define the sensitive property based risk-aware  assignment problem (SPRAP) as follows: 

\begin{definition}\label{def:SPRAP}
(SPRAP). Given the knowledge profile of RBAC policy generated  based on the sensitive property function $f$, and the vulnerability matrix  $\mathcal{D}$ representing the virtual resources probability of leakage \cite{almutairi2014risk},   the sensitive property based risk-aware role assignment problem (SPRAP) is to minimize the total risk of sensitive property  disclosure by assigning access control roles to the virtual resources.
\end{definition} 

Formally, the $SPRAP$ optimization problem is given as:
\begin{equation}\label{eq:cost}
\begin{split}
\textit{minimize} \ Risk &= \sum_{r_i \in R} Risk(r_i) \\
&= \sum_{r_i \in R} \max_{A \in \mathcal{P}(R)} g_i^{A}\times Threat(A,r_i) \\
& \ \ \ \ \ \times \prod_{r_j \in A,r_j \neq r_i} d_{I(r_i),I(r_j)} 
\end{split}
\end{equation}

Such that:\\
\begin{equation}
g^A_i=  |f(A)-f(r_i)|
\end{equation}

\begin{equation}
Threat(A,r_i) =
  \begin{cases}
    1 & \quad  \text{if $r_i \in A$}\\
        0 & \quad \text{Otherwise}
  \end{cases}
\end{equation}

Where: \\
$R$: the set of roles\\
$\mathcal{P}(R)$: the power set of roles excluding the empty set\\
$A$: is subset of $\mathcal{P}(R)$\\
$I$: is the assignment function where $I(r_i)=v_j$ if role $r_i$ assigned to VM $v_j$\\
$f$: is the sensitive property function \\
$g^A_i$: is the quantitative measure associated with a sensitive property leaked to role $r_i$ when it attack the set of roles $A$ \\
$d_{i,j}$: is probability of leakage between VM $v_i$ and  VM $v_j$ 

\begin{theorem}
SPRAP problem is NP-complete.
\end{theorem} 
\begin{proof}
We construct a decision  formulation of SPRAP problem as follow:\\
For a given constant $c$, is there any assignment  $I$ such that 
\begin{eqnarray*}
Risk&=&\sum_{r_i \in R} \max_{A \in \mathcal{P}(R)} g_i^{A}\times Threat(A,r_i) \\
&\times& \prod_{r_j \in A,r_j \neq r_i} d_{I(r_i),I(r_j)}  \le c
\end{eqnarray*}
First, given $c$ and $I$ we can check if the SPRAP decision problem satisfies the bound in polynomial time. Accordingly, the decision formulation of SPRAP is NP. Next, we show that decision SPRAP problem is NP-Complete by showing that  Travel Salesman problem (TSP) can be reduced to SPRAP. We formulates TSP for a given set $U$ with a distance metric $h(a,b)$ where $a,b \in U$, is there such an ordering of elements of $U$:($u_1,u_2,...,u_m$) such that $\sum_{i=1}^n h(u_i,u_{i+1})+h(u_n,u_1) \leq c$.

Let  $f$ be the sensitive property function for  RBAC policy with $n$ roles where $R= \lbrace r_1,r_2, \dots , r_n \rbrace$.  We define $f$ as follows:
\[ f(A) = \left  \{
  \begin{array}{l l}
    1 & \quad  \text{if} \ A = \lbrace r_i, r_j \rbrace\ \text{and} \ |i-j| \ mod \ n = 1\\
    0 & \quad \text{Otherwise}
\end{array} \right.\]

Let  $V = U$  and $d_{i,i} = h(a,b)$ where $v_i= a \ \text{and} \ v_j = b$ then assume the assignment of role $r_i$ to VM $v_j$ as if the salesman visits city $u_j$. Therefore, if we find an optimal order of visits in TSP, we can find the optimal assignment of $R$  to $V$ in SPRAP.
\end{proof} 
