Given the proposed GSM associated with RBAC policy, and the virtual resource vulnerability model related to the cloud \cite{almutairi2014risk}, the Risk-aware Sensitive Property-driven Assignment Problem (RSPAP) is defined with the objective to minimize the risk (Eq. \ref{eq:risk}) of assigning virtual resources to access control roles as the following:

\begin{definition}\label{def:RSPAP}
(RSPAP). Given a suite of $m$ virtual resources, $v_1, \ldots, v_m$, an RBAC policy and the associated SPP , and the vulnerability matrix $\mathcal{D}$, the risk-aware sensitive property-driven assignment problem is to assign access control roles to virtual resources such that the total risk of sensitive property disclosure is minimized. Formally, let $Q_i = \{ A\in \mathcal{P}(R) | r_i \in A\}$ be the set of sets in $\mathcal{P}(R)$ that contains $r_i$ and $I$ be the assignment set of roles to VMs, where function $I(r_i)=v_j$ denoting the assignment of role $r_i$ to $v_j$. We formulate the $RSPAP$ optimization problem as the following:
\begin{equation}\label{eq:cost}
\begin{split}
\underset{I}{\text{Minimize}} \ & Risk \\ 
= &\sum_{r_i \in R} Risk(r_i) \\
= &\sum_{r_i \in R}  \max_{A \in Q_i} g_i^A \times \prod_{\underset{r_j \neq r_i}{r_j \in A}} d_{I(r_i),I(r_j)} 
\end{split}
\end{equation}
Where $g_i^A = |f(A)-f(r_i)|$ is the disclosure risk between role $r_i$ and set $A$, and $d_{k\ell}d_{I(r_i),I(r_j)} \in \mathcal{D}$ denotes the probability of leakage between $I(r_i)=v_k$ and  $I(r_j)=v_{\ell}$. 
\end{definition} 
\begin{theorem}
RSPAP problem is NP-complete.
\end{theorem} 

\begin{proof}
We construct a decision  formulation of RSPAP problem as follow:\\
For a given constant $c$, is there any assignment  $I$ such that 
\begin{eqnarray*}
Risk&=&\sum_{r_i \in R}  \max_{A \in Q_i} g_{i}^{A} \times \prod_{\underset{r_j \neq r_i}{r_j \in A}} d_{I(r_i),I(r_j)}   \le c
\end{eqnarray*}
First, given $c$ and $I$ we can check if the SPRAP decision problem satisfies the bound in polynomial time. Accordingly, the decision formulation of SPRAP is NP. Next, we show that decision SPRAP problem is NP-Complete by showing that  Travel Salesman problem (TSP) can be reduced to SPRAP. We formulates TSP for a given set $U$ with a distance metric $h(a,b)$ where $a,b \in U$, is there such an ordering of elements of $U$:($u_1,u_2,...,u_m$) such that $\sum_{i=1}^n h(u_i,u_{i+1})+h(u_n,u_1) \leq c$.

Let  $f$ be the sensitive property function for  RBAC policy with $n$ roles where $R= \lbrace r_1,r_2, \dots , r_n \rbrace$.  We define $f$ as follows:
\[ f(A) = \left  \{
  \begin{array}{l l}
    1 & \quad  \text{if} \ A = \lbrace r_i, r_j \rbrace\ \text{and} \ |i-j| \ mod \ n = 1\\
    0 & \quad \text{Otherwise}
\end{array} \right.\]

Let  $V = U$  and $d_{i,i} = h(a,b)$ where $v_i= a \ \text{and} \ v_j = b$ then assume the assignment of role $r_i$ to VM $v_j$ as if the salesman visits city $u_j$. Therefore, if we find an optimal order of visits in TSP, we can find the optimal assignment of $R$  to $V$ in RSPAP.
\end{proof} 

%\begin{proof}
%We construct a decision  formulation of SPRAP problem as follow:\\
%For a given constant $c$, is there any assignment  $I$ such that 
%\begin{eqnarray*}
%Risk&=&\sum_{r_i \in R} \max_{A \in \mathcal{P}(R)} g_i^{A}\times Threat(A,r_i) \\
%&\times& \prod_{r_j \in A,r_j \neq r_i} d_{I(r_i),I(r_j)}  \le c
%\end{eqnarray*}
%First, given $c$ and $I$ we can check if the SPRAP decision problem satisfies the bound in polynomial time. Accordingly, the decision formulation of SPRAP is NP. Next, we show that decision SPRAP problem is NP-Complete by showing that  Travel Salesman problem (TSP) can be reduced to SPRAP. We formulates TSP for a given set $U$ with a distance metric $h(a,b)$ where $a,b \in U$, is there such an ordering of elements of $U$:($u_1,u_2,...,u_m$) such that $\sum_{i=1}^n h(u_i,u_{i+1})+h(u_n,u_1) \leq c$.
%
%Let  $f$ be the sensitive property function for  RBAC policy with $n$ roles where $R= \lbrace r_1,r_2, \dots , r_n \rbrace$.  We define $f$ as follows:
%\[ f(A) = \left  \{
%  \begin{array}{l l}
%    1 & \quad  \text{if} \ A = \lbrace r_i, r_j \rbrace\ \text{and} \ |i-j| \ mod \ n = 1\\
%    0 & \quad \text{Otherwise}
%\end{array} \right.\]
%
%Let  $V = U$  and $d_{i,i} = h(a,b)$ where $v_i= a \ \text{and} \ v_j = b$ then assume the assignment of role $r_i$ to VM $v_j$ as if the salesman visits city $u_j$. Therefore, if we find an optimal order of visits in TSP, we can find the optimal assignment of $R$  to $V$ in SPRAP.
%\end{proof} 
