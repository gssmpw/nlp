\KwIn{A universal relation U and a set of FD in the form of minimal cover on the attributes of $U$}
\KwOut{Relation schema   $\mathcal{R}$=\{$R_1,R_2,...,R_p$\}}
\DontPrintSemicolon

%\ForEach{FD $A_1...A_n \to B$ with multiple attributes in LHS} {Replace it with two new FDs: $X_i \to  A_1...A_n,B$ and $ A_1...A_n \to X_i$}


%For each FD with LHS $A_1...A_p$ having multiple attributes, and $A_1...A_p \to B_1$,...,$A_1...A_p \to B_q$. Replace those dependencies with two new FDs: $X_i \to  A_1...A_p,B_1,...,B_q$ and $ A_1...A_p \to X_i$, where $X_i$ is a new attribute (a surrogate key);

\ForEach{FD in $C$,  where  the LHS  has multiple attributes $A_1, ..., A_p$, s.t. $A_1...A_p \to B_1$, ..., $A_1...A_p \to B_q$}
{

Replace those dependencies with two new FDs: $X_i \to  A_1...A_p,B_1,...,B_q$ and $ A_1...A_p \to X_i$, where $X_i$ is a new attribute (a surrogate key);

}


Compute a new minimal cover $C$;

\ForEach{FD in $C$,  where the LHS  has only a single attribute $K$}
{
Create a relation schema $R$  in $\mathcal{R}$ with $\{K \cup A_1 \cup ... \cup A_n\}$ where $K \to A_1$,..., $K \to A_n$ are the only dependencies in $C$ with $K$ as LHS;

    \If{$\exists A_{i_1}...A_{i_{p'}} \to X_i$ in $C$ s.t. $X_i=K$} 
    { 
           $R = R -  \{A_{i_1}...A_{i_{p'}}\}$;
    } 
}

\ForEach{ FD in $C$ with the form of $A_{i_1}...A_{i_{p'}} \to X_i$}
{
Create a relation $R$ in $\mathcal{R}$ with $\{X_i \cup A_{i_1} \cup ... \cup A_{i_{p'}}\}$ (only one FD involves $X_i$ in RHS, and $p' \leq p$)
}



%For each FD in $C$,  where the LHS $K$ has only a single attribute, create a relation schema $R$ in $\mathcal{R}$ with $\{K \cup A_1 \cup ... \cup A_n\}$ where $K \to A_1$,...,$K \to A_n$ are the only dependency in $C$ with $K$ as LHS;

%For each FD in $C$ with the form of $A_1,A_2,... A_{p'} \to X_i$, create a relation schema in $\mathcal{R}$ with $\{X_i \cup A_1 \cup ... \cup A_{p'}\}$ (only one FD involves $X_i$ in RHS, and $p' \leq p$);

\If{none of the relation schemas in $\mathcal{R}$ contain a key of $U$} 
    { 
           create one more correlation schema that contains attributes that form a key of $U$;
    } 

%If none of the relation schemas in $\mathcal{R}$ contain a key of $U$, then create one more correlation schema that contains attributes that form a key of $U$;


Eliminate redundant relations from the resulting set of relations in the relational database schema. A relation $R_i$ is considered redundant if $R_i$ is a projection of another relation $R_j$ in the schema, alternatively, $R_i$ is subsumed by $R_j$. 





%\ForEach{relationship object $O$} {Output a relation with $O$ and its associate objects}Clean\_SurrogateKey($\mathcal{R}$)

