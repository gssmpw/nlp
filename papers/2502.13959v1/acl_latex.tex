% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[final]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx} % Required for inserting images
\usepackage{appendix}
\usepackage{booktabs}
\usepackage{soul,xspace}
\usepackage{xcolor}
\usepackage[flushleft]{threeparttable}
\usepackage{makecell}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{verbatim}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{soul}
\usepackage{longtable,booktabs,threeparttablex}
\usepackage{subcaption}


% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\title{\agent: Language-based Intelligent Drug Discovery Agent}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\author{
  \textbf{Reza Averly\textsuperscript{*1}},
  \textbf{Frazier N. Baker\textsuperscript{*1}},
  \textbf{Xia Ning\textsuperscript{1,2,3,4}} \\
  \textsuperscript{1} Department of Computer Science and Engineering, The Ohio State University, USA\\
  \textsuperscript{2}Department of Biomedical Informatics, The Ohio State University, USA\\
  \textsuperscript{3}Translational Data Analytics Institute, The Ohio State University, USA\\
  \textsuperscript{4}College of Pharmacy, The Ohio State University, USA\\
  \texttt{\{averly.1,baker.3239\}@buckeyemail.osu.edu,ning.104@osu.edu}
  % \small{
  %   \textbf{Correspondence}:
  %   \href{mailto:ning.104@osu.edu}{ning.104@osu.edu}
  % }
}

%\author{
%  \textbf{First Author\textsuperscript{1}},
%  \textbf{Second Author\textsuperscript{1,2}},
%  \textbf{Third T. Author\textsuperscript{1}},
%  \textbf{Fourth Author\textsuperscript{1}},
%\\
%  \textbf{Fifth Author\textsuperscript{1,2}},
%  \textbf{Sixth Author\textsuperscript{1}},
%  \textbf{Seventh Author\textsuperscript{1}},
%  \textbf{Eighth Author \textsuperscript{1,2,3,4}},
%\\
%  \textbf{Ninth Author\textsuperscript{1}},
%  \textbf{Tenth Author\textsuperscript{1}},
%  \textbf{Eleventh E. Author\textsuperscript{1,2,3,4,5}},
%  \textbf{Twelfth Author\textsuperscript{1}},
%\\
%  \textbf{Thirteenth Author\textsuperscript{3}},
%  \textbf{Fourteenth F. Author\textsuperscript{2,4}},
%  \textbf{Fifteenth Author\textsuperscript{1}},
%  \textbf{Sixteenth Author\textsuperscript{1}},
%\\
%  \textbf{Seventeenth S. Author\textsuperscript{4,5}},
%  \textbf{Eighteenth Author\textsuperscript{3,4}},
%  \textbf{Nineteenth N. Author\textsuperscript{2,5}},
%  \textbf{Twentieth Author\textsuperscript{1}}
%\\
%\\
%  \textsuperscript{1}Affiliation 1,
%  \textsuperscript{2}Affiliation 2,
%  \textsuperscript{3}Affiliation 3,
%  \textsuperscript{4}Affiliation 4,
%  \textsuperscript{5}Affiliation 5
%\\
%  \small{
%    \textbf{Correspondence:} \href{mailto:email@domain}{email@domain}
%  }
%}
\input{macros}


\begin{document}
\maketitle
\def\thefootnote{*}\footnotetext{Equal contribution}
\begin{abstract}
%
Drug discovery is a long, expensive, and complex process, relying 
heavily on human medicinal chemists, who can spend years searching the vast space of potential therapies.
Recent advances in artificial intelligence for chemistry have 
sought to expedite individual drug discovery tasks; however, there remains a critical need for an intelligent agent that 
can navigate the drug discovery process. 
%
Towards this end, we introduce \agent, an autonomous agent capable of intelligently navigating the drug discovery process \textit{in silico}.
%
By leveraging the reasoning capabilities of large language models,
\agent serves as a low-cost and highly-adaptable tool for autonomous drug discovery. 
%
We comprehensively examine \agent, demonstrating that (1) it can generate molecules meeting key pharmaceutical criteria on over $70\%$ of 30 clinically relevant targets, (2) it intelligently balances exploration and exploitation in the chemical space, and (3) it can identify promising novel drug candidates on EGFR, a critical target for cancers.
%

\end{abstract}

\section{Introduction}
\label{sec:intro}

Artificial intelligence (AI) research has long sought to develop 
agents capable of intelligent
reasoning to aid humans 
by autonomously navigating complex, resource-intensive processes.
%
Drug discovery is one such process, relying 
heavily on human medicinal chemists, who can spend years searching the vast space of potential therapies~\cite{blass_chapter_2021}.
%
Recent advances~\cite{chen2020retro, zhao_meea_2024, trott_autodock_2010, swanson_admet-ai_2024, zhou_optimization_2019, jensen_graph-based_2019} in AI for chemistry have 
sought to expedite drug discovery by performing individual tasks \emph{in silico}.
However, there remains a critical need for an intelligent, autonomous agent that 
can strategically navigate and facilitate the drug discovery process.

Drug discovery is a complex, nonlinear process with many requirements. 
%
Successful drugs must not only bind well to heir therapeutic targets, 
but also exhibit good physicochemical, pharmacodynamic, and pharmacokinetic properties. 
%
These requirements are not necessarily independent;
changing a molecule to satisfy one may result in the violation of another.
%
Medicinal chemists combine manual analysis with computational tools to identify promising molecules, 
evaluate their properties, and optimize their structures---an iterative process 
that demands substantial time and effort.
%

Large language models (LLMs) have emerged as reasoning engines capable 
of intelligent reasoning and planning over complex tasks.
Recent works~\cite{
yao_react_2022, 
liu_conversational_2023, 
boiko_autonomous_2023, 
% m_bran_augmenting_2024, 
% mcnaughton_cactus_2024, 
zhou_automated_2023} have explored leveraging LLMs as intelligent agents,
using natural language as an interface for taking actions and observing results.
%
By pairing LLM's reasoning capabilities with computational tools for
%
drug discovery,
we envision
%  
% 
% 
building a digital twin of the medicinal chemist, 
capable of navigating the complexities of the drug discovery process.


In this work, we introduce \agent, an intelligent agent for 
navigating the pre-clinical drug discovery process \emph{in silico}.
%
\agent is composed of four interconnected components:
(1) \planner, 
(2) \executor, 
(3) \evaluator, 
and (4) \memory.
Each component interacts with the others to collaboratively navigate the drug discovery process.
%
By harnessing the pre-trained knowledge and reasoning capabilities of LLMs,
%
\agent enables intelligent and rational decision-making over drug discovery steps, 
mimicking experienced medicinal chemists and steering the drug discovery process toward 
high throughput and success rate.
%
In doing so, \agent orchestrates the intelligent use 
of computational tools (e.g., docking simulation, property prediction, molecule optimization).
%
One key strength of \agent lies in its integration of generative AI tools for molecular design, 
enabling it to explore vast chemical spaces beyond conventional molecular libraries.  
 %
With a modular architecture,
\agent is designed for flexibility, allowing it to be seamlessly extended or refined as new capabilities emerge.
%
To the best of our knowledge, \agent is the first of its kind, representing the first effort toward 
low-cost, high-effieciency, autonomous drug discovery.  


We rigorously benchmark \agent (Section~\ref{sec:results}) 
%
and demonstrate that it can produce promising drug candidates satisfying key pharmaceutical properties 
on more than $70\%$ of 30 major therapeutic targets (Section~\ref{sec:results:main}). 
%
We provide an in-depth study (Section~\ref{sec:results:analysis}), 
%
illustrating that \agent strategically generates, refines, and selects highly favorable molecules, 
well aligned with a real-world drug discovery workflow (Section~\ref{sec:results:behaviour}). 
%
We also identify a salient pattern underpinning successful outcomes for \agent: 
effectively balancing exploration and exploitation in the chemical space (Section~\ref{sec:results:case_study_action}). 
%
Lastly, we highlight several promising drug candidates for EGFR,
an important target for cancer therapy, 
with profiles comparable to approved drugs
%
(Section~\ref{sec:results:case_study_compounds}).
%

%%%%%%%%%%%%%%%%%%%%%%%%
\section{Related Work}
%%%%%%%%%%%%%%%%%%%%%%%%

LLMs equipped with tools
have recently shown great promise as autonomous agents for scientific discoveries, including
drug discovery~\cite{gao_empowering_2024}.
%
For instance, AutoBA~\cite{zhou_automated_2023} uses LLMs
to automate multi-omics bioinformatics analysis,
generating new insights using well-known bioinformatics 
libraries.
%
Another example for biomedical research is \protagent~\cite{ghafarollahi_protagents_2024}, an LLM agent system for \emph{de novo} protein design, equipped with physics-based simulations to ground its design process.
%
Materials science can also benefit from LLM agents as well, as shown by
\alab~\cite{szymanski_autonomous_2023}, a self-driving laboratory that uses an LLM agent to control both analysis tools and laboratory hardware for semiconductor material design.

%
For drug discovery, 
\coscientist~\cite{boiko_autonomous_2023} uses LLMs to perform web search,
conduct technical documentation, program, and operate physical hardware modules
to plan and control chemical synthetic experiments.
%
It demonstrates the viability LLM agents equipped with both physical and computational tools to 
act as self-driving laboratories for organic chemistry. 
%
However, \coscientist does not integrate any domain-specific tools for grounding, but rather relies upon the LLM's intrinsic chemistry knowledge, web search, and results from the physical experiments.

In addition, \chemcrow~\cite{m_bran_augmenting_2024} is an LLM agent equipped with specific tools for small molecule organic chemistry.
These tools support generating molecule structures from natural language descriptions, predicting molecule properties,
conducting \emph{in silico} safety checks, and performing retrosynthesis planning.
Grounded by these tools, \chemcrow demonstrates an ability to perform complex, multi-step chemistry tasks commonly found in the drug discovery process. 
%
\cactus~\cite{mcnaughton_cactus_2024} is a similar agent to \chemcrow,
emphasizing tools that can predict properties important to drug discovery.
%
\drugagent~\cite{inoue_drugagent_2024} is an LLM agent for drug repurposing, equipped with tools to search databases of existing drugs to identify candidates likely to interact with a protein target.
%
Notably, none of these LLM agents are grounded with well-established computational tools for 
novel structure-based drug discovery (SBDD).  

%%%%%%%%%%%%%%%%%%%%%%%%
\section{\agent Framework}
\label{sec:methods}
%%%%%%%%%%%%%%%%%%%%%%%%


%FIGURE-------------
\begin{figure*}[ht]
    \centering
    \includegraphics[width=0.87\linewidth]{figures/DDAgent_Overview.pdf}
    \vspace{-8pt}
    \caption{Overview of the \agent Framework\vspace{-11pt}} 
    \label{fig:overview}
    \vskip -8pt
\end{figure*}
%FIGURE-------------

\agent is an automated, agentic framework for navigating the drug discovery process by combining computational tools and reasoning capabilities.
As illustrated in Figure~\ref{fig:overview}, \agent is composed of four components:
%
(1) \planner (Section~\ref{sec:methods:reasoner}), 
which plans \agent's actions and directs \agent to conduct drug discovery;   
%
(2) \executor (Section~\ref{sec:methods:executor}), 
which executes \planner's actions using state-of-the-art computational tools;
%
(3) \evaluator (Section~\ref{sec:methods:evaluator}), 
which assesses candidate molecules;   
and 
(4) \memory (Section~\ref{sec:methods:memory}), which keeps  
all the information produced along the drug discovery process. 
%
Each of these components represents a logical abstraction from the traditional drug discovery, 
enhanced by computational tools and generative AI.
%
The ultimate goal is, given a target of interest and property specifications 
on its potential drugs (e.g., at least 5 molecules, binding affinities better than -7, drug-likeness better than 0.5),  
\agent produces a diverse set of 
high-quality molecules that satisfy these specifications and can be considered as 
potential drug candidates for the target. 
%
Overall, \agent represents an innovative initiative towards autonomous drug discovery, 
integrating AI-driven planning, execution, evaluation, and memory management to 
accelerate the identification and optimization of novel therapeutics. 
%

%============================================
\subsection{\planner}
\label{sec:methods:reasoner}
%============================================


%
\agent's decision-making is conducted through its \planner component. 
%
Using the information in \memory (e.g., molecules under current consideration 
and their property profiles),
\planner conducts reasoning and
strategically plans the next actions that \agent should take, 
leveraging the pre-trained knowledge and reasoning capabilities of LLMs.
%
\planner explores three action types:
(1) \generate to generate new molecules; 
(2) \optimize to optimize existing molecules; and 
(3) \code to process the current molecules. 
%
These actions correspond to several key steps in hit identification (via generative AI) and lead 
optimization in pre-clinical drug discovery. 
%
Therefore, \planner is key to guiding \agent through the iterative process of molecular design, 
ensuring that each decision aligns with the overall requirements of drug discovery 
while balancing all required properties.

%============================================
\subsection{\executor}
\label{sec:methods:executor}
%============================================


\agent executes all drug discovery actions planned by \planner through its \executor.  
\executor is equipped with state-of-the-art computational tools tailored to different actions. 
Specifically, \executor integrates:  
%
(1). generative models for structure-based
%
drug design 
to implement the \generate action, 
utilizing methods such as Pocket2Mol~\cite{peng_pocket2mol_2022};
%
(2). generative models for molecular refinement to implement the \optimize action, 
enhancing drug-like properties and optimizing molecular structures~\cite{jensen_graph-based_2019}; and
%
(3). a processor to implement the \code action, allowing complex and logic screening, organizing and 
managing molecules, and identifying the most promising ones.  
%


A key innovation of \agent is that \executor leverages generative models for both hit identification 
(\generate) and lead optimization (\optimize). 
%
Unlike conventional drug discovery, which relies on searching and modifying existing molecular databases, 
\executor enables \emph{de novo} molecular generation, 
expanding the chemical space beyond known molecules. 
%
This approach increases the likelihood of discovering novel, diverse, and more effective drug candidates.  
%
Moreover, by automating lead optimization through generative models, \executor reduces human bias
stemming from individual expertise levels and limited chemical knowledge. 
%
This ensures a more systematic, data-driven approach to improving molecular properties.  
%
By integrating generative tools, \agent can operate autonomously, 
designing superior drug candidates more efficiently than traditional human-driven search methods. 
%
This automation enhances cost-effectiveness and accelerates drug discovery, 
making \agent a powerful AI-driven co-pilot in the drug discovery process.

%============================================
\subsection{\evaluator}
\label{sec:methods:evaluator}
%============================================

\agent performs \emph{in silico} assessments over molecules using its \evaluator. 
%
\evaluator assesses an array of molecule properties essential to successful 
drug candidates, including target binding affinity, drug-likeness, synthetic accessibility, 
Lipinski's rule, novelty, and diversity.
%
For different properties, \evaluator uses the appropriate computational tools to conduct the evaluation.
% 
%
Evaluation results are systematically stored in \agent's memory 
(\memory; discussed in Section~\ref{sec:methods:memory}), and subsequently utilized 
by \planner to refine decision-making and guide the next steps in the drug discovery process.
%
Once \evaluator identifies molecules satisfying all user requirements, it signals \agent to terminate 
the search and return the most promising candidates. 
%
Thus, \evaluator serves as a critical quality control mechanism, 
systematically steering \agent toward identifying optimal drug candidates 
while minimizing the exploration of suboptimal chemical spaces.
%
In addition, \evaluator is designed in a plug-and-play fashion, 
allowing additional tools to be added or updated to support new property requirements. 

%============================================
\subsection{\memory}
\label{sec:methods:memory}
%============================================

\agent keeps all the information produced throughout its entire drug discovery process
in \memory. 
%
This includes information provided by users via prompts, such as
protein target structures, 
property requirements, and reference molecules (e.g., known drugs). 
%
More information will be dynamically generated as \agent progresses 
through the drug discovery process, including 
the trajectories of actions that \agent has taken (planned by \planner), 
molecules generated from prior actions, and their properties. 
%
The information in \memory is aggregated and provided to \planner to facilitate its planning. 
%
\memory is dynamically changing and continuously updated. 
%
This evolving repository enables \planner to be well informed by prior knowledge and newly
generated data, and thus better reflect and refine its strategies, 
enhancing the efficiency and effectiveness of automated drug discovery.

\input{./tables/dataset_stats}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experimental Settings}
\label{sec:experiments}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%================================
\subsection{Evaluation Metrics}
\label{sec:experiments:evaluation}
%================================

%------------------------------------------------------------------------------------------------------------
\paragraph{Molecule Qualities}
%------------------------------------------------------------------------------------------------------------
We use these metrics to evaluate the  molecules generated by different methods. 

%................................................................................................................................
\subparagraph{Key molecule properties}
%................................................................................................................................
%
We first evaluate the following general properties required for successful drugs:
%
\textbf{(1)} drug-likeness~\cite{bickerton_quantifying_2012} (\qedreq), 
\textbf{(2)} Lipinski's Rule of Five~\cite{lipinski_experimental_2001} (\lipinskireq),
\textbf{(3)} synthetic accessibility~\cite{ertl_estimation_2009} (\sascorereq), 
and 
\textbf{(4)} binding affinities measured by Vina scores~\cite{trott_autodock_2010} (\vinareq).  
%



%-------------------------------------------------------------------------------------------------------------------------
\subparagraph{Novelty}
%-------------------------------------------------------------------------------------------------------------------------
%
We measure the novelty (\noveltyreq) of a molecule \molecule with respect to a 
reference set of known drugs $\moleculeset_0$ as follows: 
%
\vspace{-5pt}
\begin{equation*}
\label{eqn:novelty}
\noveltyreq(\molecule; \moleculeset_0) \! 
= \! 1 - 
\max\nolimits_{\scriptsize{\molecule_i \in \moleculeset_0}}
(\tanimoto(\molecule, \molecule_i)),
\vspace{-5pt}
\end{equation*}
%
where $\moleculeset_0$ is the reference set of known drugs, % produced by \agent,
$\molecule$ and $\molecule_i$ are two molecules,
and $\tanimoto(\molecule, \molecule_i)$ is the Tanimoto similarity 
of $\molecule$ and $\molecule_i$'s Morgan fingerprints~\cite{morgan_generation_1965}.
%
High novelty indicates that new molecules are different from existing drugs, 
offering new therapeutic opportunities. 
%
A molecule \molecule is considered novel if $\noveltyreq(\molecule) \ge 0.8$. 

%------------------------------------------------------------------------------------------
\subparagraph{High-quality molecules}
%------------------------------------------------------------------------------------------

A molecule \molecule is considered as ``high quality'' (\HQ) for a target \target, 
if its properties satisfy 
%
$\qedreq\ge\overline{\qedreq}_{\scriptsize{\target}}, 
\lipinskireq \ge \overline{\lipinskireq}_{\scriptsize{\target}}, 
\sascorereq \le \overline{\sascorereq}_{\scriptsize{\target}}, 
\vinareq \le \overline{\vinareq}_{\scriptsize{\target}}$, and 
$\noveltyreq(\molecule) \ge 0.8$, 
%
where the $\overline{\text{overline}}$ and the subscript ${{\target}}$
indicate the average value from all the known drugs for target \target. 
%
Such multi-property requirements are typical in drug discovery. 
%
Meanwhile, this presents a significant challenge, as \agent must identify molecules
with key properties similar to or even better than existing drugs but structurally significantly 
different from them.  
%
In our dataset, we include existing drugs for targets as the gold standard 
for evaluation purposes. 



%-------------------------------------------------------------------------------------------------------------------------
\paragraph{Molecule Set Diversity}
%-------------------------------------------------------------------------------------------------------------------------

We measure the diversity (\diversityreq) of a set of generated molecules \moleculeset
defined as follows, 
%
\vspace{-5pt}
\begin{equation*}
\label{eqn:diversity}
%
\diversityreq(\moleculeset) = 1 - \mathop{\mathbb{E}}\nolimits_{\scriptsize{\{\molecule_i, \molecule_j\}} \subseteq \moleculeset}\left[\tanimoto(\molecule_i, \molecule_j)\right], 
%
\vspace{-5pt}
\end{equation*}
%
where $\molecule_i$ and $\molecule_j$ are two distinct molecules in $\moleculeset$.
%
High diversity is preferred, as chemically diverse molecules 
increase the likelihood of identifying successful drug candidates.
%
A set of molecules \moleculeset is considered diverse if $\diversityreq(\moleculeset) \ge 0.8$. 
This imposes a highly stringent requirement on the diversity of the generated molecules. 
%-------------------------------------------------------------------------------------------------------------------------
\paragraph{Target Success Rate}
%-------------------------------------------------------------------------------------------------------------------------

Target success rate, denoted as \successrate, is defined as the percentage of targets 
for which a method can generate a \emph{diverse} set of \emph{at least 5} \emph{high-quality} molecules.
%

%================================
\subsection{Protein Target Dataset}
\label{sec:experiments:data}
%================================


To evaluate \agent, we manually curated a diverse set of protein targets 
from OpenTargets~\cite{ochoa_opentargets_2023}
that are strongly associated with major human diseases: 
cancers, neurological conditions,
cardiovascular diseases, infectious diseases, diabetes,
and autoimmune diseases.
%
For each of these protein targets,
we identified an experimentally resolved structure with a small-molecule ligand
from the RCSB Protein Data Bank (PDB)~\cite{berman_protein_2000} 
and extracted the binding pocket according to its ligand's position.
%
To enable a comparison to existing drugs,
we searched ChEMBL~\cite{bento_chembl_2014, gaulton_chembl_2011}
for all known drugs targeting the selected proteins.
%
This leads to 30 protein targets with PDB structures, ligands, and existing drugs. 
These targets will be used as input in our experiments. 
%
Table~\ref{tab:dataset_stats} presents the distribution 
of the targets in terms of their disease associations. 
Please note, some targets are associated with multiple diseases.
A full list of targets is presented in Appendix~\ref{sec:appendix:dataset}.

%=======================================
\subsection{Implementation Details}
\label{sec:experiments:implementation}
%=======================================


\agent leverages Claude 3.5 Sonnet~\cite{anthropic_claude-sonnet3-5_2024} as the 
base model for its \planner and \evaluator.
%
We designed and fine-tuned specific prompts to guide \planner and \evaluator, respectively. 
%
Details on these prompts are provided in Appendix~\ref{sec:appendix:prompts}.
\evaluator evaluates all the metrics as defined in Section~\ref{sec:experiments:evaluation}. 
We set the maximum number of actions taken to 10 to ensure a concise yet effective drug discovery trajectory.
%

\executor executes the \generate action using Pocket2Mol~\cite{peng_pocket2mol_2022}.
As a structure-based drug design tool, Pocket2Mol can generate molecules using only the target protein structure.
This provides \agent with the ability to extend to novel targets without known ligands. % addressing the "why"
For efficiency, Pocket2Mol is set to generate a minimum of 100 molecules using a beam size of 300.
%
The \optimize action is implemented via GraphGA~\cite{jensen_graph-based_2019}, 
a popular graph-based genetic algorithm for molecule optimization.
%
In \agent, \optimize can refine molecules on three essential properties: 
drug-likeness (\qedreq), synthetic accessibility (\sascorereq), 
and target binding affinity (\vinareq).
%
However, the actions can be easily expanded to cover additional properties.


\input{./tables/table_main}

%================================
\subsection{Baselines}
\label{sec:experiments:baselines}
%================================



We compare \agent with two types of baselines:
task-specific molecule generation methods, and general-purpose LLMs. 
%
For molecule generation methods, 
we use the state-of-the-art Pocket2Mol~\cite{peng_pocket2mol_2022} and DiffSMol~\cite{chen_generating_2025}.
%
Pocket2Mol~\cite{peng_pocket2mol_2022} is a well-established generative method 
for structure-based drug design, which uses binding pocket structures as input. 
%
DiffSMol~\cite{chen_generating_2025}, on the other hand, is a state-of-the-art 
generative method for ligand-based drug design, requiring a binding ligand. 
%
These two methods represent distinct approaches in computational drug discovery, 
leveraging different sources of information to identify and optimize potential drug candidates. 
%
%
Notably, Pocket2Mol is employed by \agent in \generate actions, 
capitalizing on the popularity of SBDD and its ability to generate molecules without reference ligands

%%%

For general-purpose LLMs, we use 
GPT-4o~\cite{openai_gpt-4o_2024}, o1~\cite{openai_o1_2024}, 
o1-mini~\cite{openai_o1-mini_2024}, and Claude 3.5 Sonnet~\cite{anthropic_claude-sonnet3-5_2024}.
GPT-4o and Claude 3.5 Sonnet are representative state-of-the-art language models; 
o1 and o1-mini are specifically tailored towards scientific reasoning during their training.
We evaluate all four of these models as baselines to 
provide a comprehensive understanding of the performance of state-of-the-art LLMs.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experimental Results}
\label{sec:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%=================================================
\subsection{Main Result}
\label{sec:results:main}
%=================================================

\autoref{tab:main} presents the performance of different methods,
including their success rates
and the qualities of their generated molecules. 

\emph{\textbf{\agent successfully generates novel, diverse, and high-quality molecules as 
potential drug candidates 
for $73.3\%$ of targets (\successrate), significantly outperforming existing methods.}}  
%
Pocket2Mol, the second-best method, achieves only a $23.3\%$ success rate, 
while most proprietary LLMs fail entirely.  
%
Crucially, \agent excels in simultaneously optimizing all five key pharmaceutical properties -- 
\qedreq, \lipinskireq, \sascorereq, \vinareq, and \noveltyreq 
-- on average, 85\% of the generated molecules for each target are of high quality (\HQ). 
%
In contrast, GPT-4o 
%
%
achieves only $35\%$ in \HQ, lagging nearly 50 percentage points behind \agent, 
while all other methods perform even worse.  
%
In terms of the qualities of the generated molecules, 
\agent produces molecules of comparable or superior quality to the limited outputs 
of other methods. 
%
%
These results highlight \agent as a highly effective and reliable framework for accelerating drug discovery, 
consistently outperforming existing methods in both success rate and molecule qualities.
%
%

%FIGURE-------------
\begin{figure}[ht]
    % \vskip -5pt
    \centering
    \includegraphics[width=0.58\linewidth]{./figures/action_graph-v2.pdf}
    \vskip -5pt
    \caption{Action transactions in \agent. The numbers represent the transition probabilities.}
    \label{fig:action_graph}
    \vskip -22pt
\end{figure}
%FIGURE-------------

%FIGURE-------------
\begin{figure}[ht]
    % \vskip -8pt
    \centering
    \includegraphics[width=0.88\linewidth]{./figures/mol_update.pdf}
    \vskip -8pt
    \caption{Molecule quality (left panel) and actions (right panel) over iterations by \agent.} 
    \label{fig:iteration}
    \vskip -20pt
\end{figure}
%FIGURE-------------

\emph{\textbf{\agent consistently generates high-quality molecules across 
all key pharmaceutical properties.}}  
%
Notably,  it produces the most molecules (97.2\%) for each target with \qedreq higher than average, 
and the most molecules (95.8\%) for each target with \vinareq higher than average, compared to other methods.
%
Most of them ($97.8\%$) are also novel, second only to DiffSMol.
%
With respect to known drugs, a vast majority (88.3\%) of \agent's molecules exhibit high synthetic accessibility (\sascorereq) and
(96.7\%) adhere to Lipinski’s Rule of Five (\lipinskireq),  
comparable to general-purpose LLMs such as Claude, GPT-4o, and o1.  
%
On the most stringent metric, \vinareq, \agent significantly outperforms other methods, 
with $95.8\%$ of its generated molecules binding similarly to or better than existing drugs.  
%
In contrast, existing methods struggle to exceed $65\%$ across these key properties. 
%
Overall, \agent proves to be a robust and reliable approach, 
surpassing existing methods in generating high-quality drug candidates.

%FIGURE-------------
\begin{figure*}[ht]
    \centering
    \begin{subfigure}[b]{0.33\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./figures/action_cases/case1.pdf}
        \vskip -4pt
        \caption{Successful actions for CDK5}
        \label{fig:sub1}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.28\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./figures/action_cases/case2.pdf}
        \vskip -4pt
        \caption{Successful action trajectories}
        \label{fig:sub2}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.33\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./figures/action_cases/case3.pdf}
        \vskip -4pt
        \caption{Failure action trajectories}
        \label{fig:sub3}
    \end{subfigure}
    \vskip -9pt
    \caption{\agent actions trajectories across different targets.}
    \label{fig:case_study_action}
    \vskip -18pt
\end{figure*}
%FIGURE-------------


\emph{\textbf{Existing methods face substantial challenges to achieve multiple good properties concurrently.}}
%
For instance, general-purpose LLMs -- Claude, GPT4o, o1-mini, and o1-- exhibit a trade-off between 
novelty and binding. 
%
While they achieve impressive \vinareq, 
% 
their generations tend to resemble known drugs closely 
(e.g., \textless$70\%$ novelty). 
%
%%
In contrast, Pocket2mol and DiffSMol demonstrate the opposite: excel at \noveltyreq but struggle at \vinareq.
%
It is possible that LLMs often anchor their generations based on prior knowledge 
(e.g., known ligands), thus narrowing their explorations. 
%
Meanwhile, Pocket2Mol and DiffSMol could generate new binding molecules but not better than existing drugs. 
%
%
Note that \agent does not suffer from such compromise (e.g., both \sascorereq and \vinareq \textgreater$95\%$)

%

\input{./tables/table_evaluation}

%
%===============================================================
\subsection{Agent Analysis}
\label{sec:results:analysis}
%===============================================================

\subsubsection{\agent Action Patterns}
\label{sec:results:behaviour}

\autoref{fig:action_graph} presents the transition probabilities of actions that \agent takes 
throughout the drug discovery process across all the targets, from start to finish.
%

\emph{\textbf{\agent aligns with a typical drug discovery workflow, 
incorporating intelligent refinement at every stage.}}
%
The most likely strategy of \agent begins with the generation of target-binding molecules 
(\generate), followed by either optimization to enhance their properties (\optimize), or 
screening and selection over the generated molecules (\code).
%
Typically, optimization is necessary, which is followed by molecule screening
over the optimized molecules. Iterative optimization is possible when no viable molecules exist. 
%
Similarly, iterative molecule screening is employed 
when plenty of viable molecules exist but are structurally similar. 
For instance, \agent may cluster these molecules and 
subsequently identify the most promising molecules within each cluster. 
%
The most common workflow covers \generate, \optimize, and then \code toward 
successful outcomes. 

\textbf{\emph{\code serves as a quality-control mechanism to enable successful outcomes.}}
%
Successful molecules are only possible after \code completes screening and selection and 
identifies such molecules to output. 
%
As \generate and \optimize tend to yield more molecules than
necessary, allowing abundant opportunities for \agent to succeed, \code prevents \agent 
from producing low-quality drug candidates.   

%
\textbf{\emph{Most of the generated molecules from \generate directly go through subsequent 
optimization by \optimize.}}
%
This occurs in approximately 90\% of the cases. 
%
Among all the generated molecules by \generate, it is typical that none of them satisfies 
all the property requirements, particularly those properties that are not integrated into the \generate 
tool designs. 
%
Any screening by \code over such molecules will be futile and wasteful. 
Instead, \agent intelligently executes \optimize, improving the likelihood of successful molecules 
out of \code screening. 
%
Meanwhile, \agent can still identify high-quality generated molecules and conducts 
screening directly over them. 
%
This clearly demonstrates the reasoning capability of \agent as an effective tool for drug 
discovery.  

\emph{\textbf{\agent leverages performance-driven insights to determine the most optimal action.}}
%  
Confronted with low-quality outputs from \generate, \agent 
selectively pursues optimization to maximize results.
Whenever additional molecules need to be considered (e.g., \code does not identify good candidates), \agent prioritizes optimizing promising molecules stored in \memory rather than generating entirely new ones.  
%  
This represents a cost-effective, risk-averse strategy, balancing exploration and exploitation by refining known candidates with high potential rather than investing computational resources in \emph{de novo} generation 
with suboptimal outcomes. 

\emph{\textbf{\agent favors refining a few highly promising candidates as it continuously progresses.}}
%
\autoref{fig:iteration} describes both the quality of the molecules produced and the typical actions \agent takes at each step. 
%
%
Compared to the initial pool, the output molecules roughly achieve double the \qedreq and \vinareq, 
thus emphasizing the importance of iterative optimization and effective screening strategies.
%
However, diversity among these top candidates is often limited since molecules 
%
that satisfy multiple property requirements tend to converge on similar structures.
%
This further highlights the complexity of drug discovery.~\autoref{fig:iteration} (right) also highlights how \agent tends to focus on refining the molecules via \optimize or \code in later steps, mimicking a typical drug discovery workflow. 

%FIGURE-------------
\begin{figure*}[htb]
    \centering
    \begin{subfigure}{0.3\linewidth}
        \includegraphics[width=\linewidth]{./figures/case-heatmaps-part-vna.pdf} 
        \vskip -8pt
        \caption{\vinareq} 
        \label{fig:case_heatmap_vna} 
    \end{subfigure}
%
    \begin{subfigure}{0.3\linewidth}
       \includegraphics[width=\linewidth]{./figures/case-heatmaps-part-qeq.pdf}
       \vskip -8pt
        \caption{\qedreq} 
        \label{fig:case_heatmap_qeq} 
    \end{subfigure}
%
    \begin{subfigure}{0.3\linewidth}
       \includegraphics[width=\linewidth]{./figures/case-heatmaps-part-sas.pdf}
       \vskip -8pt
        \caption{\sascorereq} 
        \label{fig:case_heatmap_sas} 
    \end{subfigure}
    %
    \vspace{-10pt}
    \caption{Case study for EGFR. Each subfigure compares molecules generated by \agent to 
    three drugs and one binding ligand of EGFR on \vinareq, \sascorereq, and \qedreq, respectively. 
    Red squares indicate that the \agent molecule outperforms the reference molecule on respective metrics.}
    \label{fig:case_study_compounds}
    \vskip -17pt
\end{figure*}
%FIGURE-------------

%----------------------------------------------------------------------------------------------------------------
\subsubsection{Analysis on \agent action trajectories}
\label{sec:results:case_study_action}
%----------------------------------------------------------------------------------------------------------------

Figure~\ref{fig:case_study_action} presents an example of \agent action trajectories to identify 
promising drug candidates for CDK5~\cite{lau_cdk5_2002}, 
a target for neurological conditions, such as Alzheimer's Dementia, along with examples 
of trajectories that lead to success (e.g., HTR2A, HRAS, DRD2) and fail (e.g., PIK3CA, MET, ADRB2)  outcomes, respectively. 

\textit{\textbf{\agent intelligently balances exploration and exploitation, critical to identify promising candidates}}.
%
In the case of CDK5, where it is highly challenging to identify a good drug candiate as demonstrated 
in the literature~\cite{xie_lessons_2022},
%
\agent is able to adaptively explore the chemical space via iteratively screening viable molecules and improving any property the molecules fail to meet. 
As shown in~\autoref{fig:case_study_action} (a), \agent starts with \generate (step 1), proceeds with \optimize (step 2), then applies \code (step 3) but fails to find favorable candidates. 
In response, \agent refines the failing property (step 4) and performs another screening (step 5). This process continues (steps 6, 7, 8) until the agent finally converges to a set of promising candidates.

This not an isolated case; \agent consistently displays comparable intelligent decision-making behavior on other targets as observed in~\autoref{fig:case_study_action} (b) and~\autoref{fig:case_study_action} (c).
Notably, in cases with successful outcomes, \agent methodically refines several properties before screening for candidates (DRD2), or strategically determines which molecules to prioritize and what action to take (HTR2A and HRAS). For instance, in the HRAS case, \agent uses several screenings (steps 2 and 3) to identify viable candidates, optimize them (step 4), and conduct further screenings (step 5 to 8) until it identifies favorable candidates. 
%
This highlights one key strength of \agent -- its capability to adapt to feedback (e.g., molecules quality) from its \evaluator, to explore (e.g., via refinement and generation), and to exploit (e.g., screening existing molecules) the chemical space.
%
On cases where \agent yields suboptimal molecules, such as PIK3CA, MET, and ADRB2, 
it still exhaustively performs various actions up to the action limits (i.e., 10 iterations). 


%--------------------------------------------------------------------------------------------------------------
\subsubsection{Case Study for Target EGFR}
\label{sec:results:case_study_compounds}
%--------------------------------------------------------------------------------------------------------------

We task \agent with discovering new potential drug therapies targeting the Epidermal growth factor receptor 1 (EGFR) protein.
%
EGFR is a transmembrane glycoprotein that plays a pivotal role in many cancers,
including breast cancer, esophogeal cancer, and lung cancer~\cite{seshacharyulu_egfr_2012}.
%
Its role in cancer, as well as its accessibility on the cell membrane, 
has made it a prime therapeutic target~\cite{bento_chembl_2014, gaulton_chembl_2011}.
%
However, cancer cells mutate rapidly and can become resistant to drugs over time, 
leading to a need for novel drug therapies~\cite{das_next-generation_2024}.
%


We compare the molecules generated for EGFR by \agent 
with three approved drugs of EGFR -- Olmutinib, Masoprocol, and  Gefitinib,
which exhibit the best \vinareq, \qedreq and \sascorereq among all EGFR's approved drugs, respectively.
We also compare them with a known ligand for EGFR's binding pocket.
~\autoref{fig:case_study_compounds} presents the overall comparison results.
%
Note that most existing methods cannot generate any novel high-quality molecules. 
This emphasizes the strength of \agent, which can tackle even a challenging target.


\emph{\textbf{\agent effectively generates promising novel drug candidates on a critical drug target.}}
%
Notably, these molecules surpass the native ligand in both \vinareq and \qedreq, while displaying comparable overall profiles to approved drugs.
%
Moreover, some molecules (\autoref{fig:case_study_compounds} columns 1 and 2), illustrated in Appendix~\ref{sec:appendix:results}, are better than Olmutinib and Masoprocol on all metrics (i.e., \vinareq, \qedreq, and \sascorereq).
%
Overall, this suggests \agent has a strong potential in discovering novel therapeutics.

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Discussion}
% \label{sec:discuss}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We present \agent, an agent for autonomous drug discovery. We comprehensively examine its capabilities, demonstrating its performance across many major therapeutical targets and revealing several key insights on its success. Furthermore, we investigate the generated molecules on the highly critical target EGFR and show their potential as drug candidates.

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Limitations}
\label{sec:limitation}

\agent is not without its limitations.
\agent focuses on automating \textit{in silico drug disovery},
which requires further wet lab experiments on the molecules, particularly on their safety profiles.
Additionally, we focus only on a few key metrics in this work and intentionally design \agent to be easily extendable for other metrics. 
We leave this to future work.
Our experiments with \agent built on only one LLM base model and a limited number of API calls due to cost constraints. Further testing on other LLMs and more API calls will be an interesting avenue for future research.
Our benchmark dataset, consisting of primary therapeutic targets, is limited in size.
We prioritized targets associated with important diseases, such as cancer, given the constraint of our budget.
Future work may see an expansion of this dataset and additional benchmarking.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Ethics Statement}
\label{sec:ethic}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\agent is designed to generate small 
molecules meeting the parameters specified in a natural language prompt. However, 
we recognize that not all small molecules are safe,
and such a tool could generate harmful molecules.
As such, we have taken several steps to minimize the potential negative impact.
\agent only functions \emph{in silico} and does not currently generate synthesis plans for any of its molecules.
This prevents any dangerous molecules from being automatically produced without conscious human oversight or intervention.
Additionally, our \evaluator implementation and example prompts focus \agent on priority metrics in designing drugs to benefit humans, such as \qedreq and \lipinskireq.

Despite these efforts, we cannot guarantee that \agent will not generate harmful or incorrect content.
We encourage users to practice discretion when using \agent,
and to follow all applicable safety guidelines and research best practices.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgement}
\label{sec:acknowledgement}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This project was made possible, in part, by support from the National Science Foundation grant 
no. IIS-2133650 and the National Library of Medicine grant no. 1R01LM014385. 
Any opinions, findings and conclusions or recommendations expressed in this paper 
are those of the authors and do not necessarily reflect the views of the funding agency.
In addition, we would like to thank our colleagues, Ruoxi Gao, for generating some of the data in our experiments and Xinyi Ling for generating some of the figures in this work.

% Bibliography entries for the entire Anthology, followed by custom entries
%\bibliography{anthology,custom}
% Custom bibliography entries only
\bibliography{custom}

\clearpage
\onecolumn
\appendix

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dataset}
\label{sec:appendix:dataset}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The following table details each protein target in the dataset.  The disease categories column indicates whether the target is associated with autoimmune disease (A), cancer (CA), cardiovascular disease (CV), Diabetes (D), Infectious Disease (I), or Neurological Conditions (N).

\input{tables/test-long-table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Prompts}
\label{sec:appendix:prompts}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{\planner Prompt}

\begin{flushleft}
\texttt{You have access to the following molecules and pockets:}

\textbf{\texttt{\{pocket\_str\}\{mol\_str\}}}

\texttt{You also have access to a set of actions:}

\textbf{\texttt{\{action\_str\}}}

\texttt{Your job is to find molecules that satisfy these requirements:}

\textbf{\texttt{\{req\_str\}}}

\texttt{Here is a history of actions you have taken and the results:}

\textbf{\texttt{\{history\_str\}}}

\texttt{Here is the evaluation result from previous iteration:}

\textbf{\texttt{\{eval\_str\}}}

\vspace{1em}

\texttt{Let's think step by step and take your time before you answer the question. What is the best action to take and what is the input of the action?}

\vspace{1em}

\texttt{Remember that you currently have \textbf{\{resource\_str\}} left to solve the task.}

\texttt{Remember that you can only use one action.}

\vspace{1em}

\texttt{Your answer must follow this format:}

\vspace{1em}

\texttt{Action: [name of action]}

\texttt{Input: [input of the action, should be the identifier like ['MOL001'] or ['POCKET001']]}

\vspace{1em}

\texttt{If you plan to use "CODE" action, you need to include this additional format:}

\vspace{1em}

\texttt{Desc: [explain what you want to do with the input of the action. Be as verbose and descriptive as possible but at most three sentences. Always refer to the identifier of the action input.]}

\end{flushleft}

\subsection{\evaluator Prompt}

\begin{flushleft}

\texttt{You have access to the following pool of molecules:}

\textbf{\texttt{\{mol\_str\}}}

\texttt{Your job is to find molecules that satisfy these requirements:}

\textbf{\texttt{\{req\_str\}}}

\texttt{Does this pool of molecules satisfy the requirements?}

\texttt{Remember that all molecules in the pool must satisfy the requirements.}

\vspace{1em}

\texttt{Let's think step by step and answer with the following format:}

\texttt{Reason: (a compact and brief one-sentence reasoning)}

\texttt{Answer: (YES or NO)}

\end{flushleft}

\subsection{\code Prompt}

\begin{flushleft}

\texttt{Your job is to make a Python function called \_function.}

\texttt{The input is a Dict[str, pd.DataFrame] with the following columns:}

\texttt{["SMILES", "QED", "SAScore", "Lipinski", "Novelty", "Vina Score"].}

\texttt{The output must be a pandas DataFrame with the same columns as the input.}

\texttt{The function should be able to do the following task: \textbf{\{input\_desc\}}}

\vspace{1em}

\texttt{Your output must follow the following format:}

\vspace{1em}

\begin{verbatim}
import pandas as pd

def _function(Dict[str, pd.DataFrame]) -> pd.DataFrame:
    #---IMPORT LIBRARIES HERE---#
    #---IMPORT LIBRARIES HERE---#
    
    #---CODE HERE---#
    #---CODE HERE---#
    
    output_df = ...
    return output_df
\end{verbatim}

\vspace{1em}

\texttt{Make sure you import the necessary libraries.}

\end{flushleft}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Additional Results}
\label{sec:appendix:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In Figure~\ref{fig:two_mol}, we illustrate  two molecules as examples where \agent produced results which outperform  Olmutinib and Masoprocol, two of the known drugs targeting EGFR, on all three metrics discussed in Section~\ref{sec:results:case_study_compounds} (\vinareq, \qedreq, and \sascorereq).

\begin{figure}[h]
\centering
    \begin{subfigure}{0.325\linewidth}
        \includegraphics[width=\linewidth]{./figures/two_molecules.png}    
        \caption{Promising molecules generated by \agent} 
        \label{fig:two_mol:agent} 
    \end{subfigure}
~
    \begin{subfigure}{0.45\linewidth}
        \includegraphics[width=\linewidth]{./figures/o_m_drugs.png}    
        \caption{Existing drugs targeting EGFR} 
        \label{fig:two_mol:drugs} 
    \end{subfigure}
    \caption{Molecules from EGFR case study}
    \label{fig:two_mol}
\end{figure}


\end{document}
