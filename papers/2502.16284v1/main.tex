\documentclass{article}
\usepackage{iclr2025_conference,times}

% Optional math commands from https://github.com/goodfeli/dlbook_notation.
\input{math_commands.tex}

\usepackage{hyperref}
\usepackage{url}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage[capitalize]{cleveref}
\crefname{figure}{Figure}{Figures}
\crefname{table}{Table}{Tables}
\crefformat{equation}{Eq.~#2#1#3}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{caption}
\usepackage{enumitem}

% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsthm}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{Prop}[theorem]{Proposition}
\newtheorem{Lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage{romannum}
\usepackage{bbding}
\usepackage{xcolor}
\usepackage{colortbl}

\newcommand{\gtcoord}{\cellcolor[HTML]{ffffff}}
\newcommand{\eqcoord}{\cellcolor[HTML]{ffffff}}

\newcommand{\first}[1]{\textbf{#1}}
\newcommand{\second}[1]{\underline{#1}}
\newcommand{\third}[1]{#1}

\newcommand{\themodel}{MolSpectra\xspace}

\usepackage{tocloft}
\newcommand{\stoptocwriting}{
  \addtocontents{toc}{\protect\setcounter{tocdepth}{-5}}}
\newcommand{\resumetocwriting}{
  \addtocontents{toc}{\protect\setcounter{tocdepth}{\arabic{tocdepth}}}}

\definecolor{myblue}{RGB}{62, 104, 183}
\hypersetup{
    colorlinks=true,
    breaklinks=true,
    linkcolor=red,
    urlcolor=myblue,
    citecolor=myblue,
}

\title{MolSpectra: Pre-training 3D Molecular Representation with Multi-modal Energy Spectra}

\author{Liang Wang\textsuperscript{\textmd{1,2}}\thanks{Correspondence to Liang Wang: \texttt{liang.wang@cripac.ia.ac.cn}}~
    Shaozhen Liu\textsuperscript{\textmd{1}}
    Yu Rong\textsuperscript{\textmd{3}}\thanks{Corresponding authors: Yu Rong and Qiang Liu}~
    Deli Zhao\textsuperscript{\textmd{3}}
    Qiang Liu\textsuperscript{\textmd{1,2}}\footnotemark[\value{footnote}]~
    Shu Wu\textsuperscript{\textmd{1,2}}
    Liang Wang\textsuperscript{\textmd{1,2}}\\
\textsuperscript{\textmd{1}}New Laboratory of Pattern Recognition (NLPR),\\ 
\, State Key Laboratory of Multimodal Artificial Intelligence Systems (MAIS),\\
\, Institute of Automation, Chinese Academy of Sciences (CASIA)\\
\textsuperscript{\textmd{2}}School of Artificial Intelligence, University of Chinese Academy of Sciences \\
\textsuperscript{\textmd{3}}DAMO Academy, Alibaba Group\\
}

% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to \LaTeX{} to determine where to break
% the lines. Using \AND forces a linebreak at that point. So, if \LaTeX{}
% puts 3 of 4 authors names on the first line, and the last on the second
% line, try using \AND instead of \And before the third author name.

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\iclrfinalcopy % Uncomment for camera-ready version, but NOT for submission.
\begin{document}

\pagenumbering{arabic}

\maketitle

\stoptocwriting
\begin{abstract}
Establishing the relationship between 3D structures and the energy states of molecular systems has proven to be a promising approach for learning 3D molecular representations. However, existing methods are limited to modeling the molecular energy states from classical mechanics. 
This limitation results in a significant oversight of quantum mechanical effects, such as \textit{quantized (discrete) energy level structures}, which offer a more accurate estimation of molecular energy and can be experimentally measured through energy spectra.
In this paper, we propose to utilize the energy spectra to enhance the pre-training of 3D molecular representations (\themodel), thereby infusing the knowledge of quantum mechanics into the molecular representations.
Specifically, we propose SpecFormer, a multi-spectrum encoder for encoding molecular spectra via masked patch reconstruction. By further aligning outputs from the 3D encoder and spectrum encoder using a contrastive objective, we enhance the 3D encoder's understanding of molecules.
Evaluations on public benchmarks reveal that our pre-trained representations surpass existing methods in predicting molecular properties and modeling dynamics.
\setcounter{footnote}{1}
\footnotetext{The code is released at \hypersetup{urlcolor=black}\url{https://github.com/AzureLeon1/MolSpectra}}
\end{abstract}


\input{sections/introduction}
\input{sections/preliminaries}
\input{sections/method}
\input{sections/experiments}
\input{sections/related-work}
\input{sections/conclusion}

\clearpage

\section*{Acknowledgments}
This work is jointly supported by National Science and Technology Major Project (2023ZD0120901) and National Natural Science Foundation of China (62372454, 62236010).

\bibliography{reference}
\bibliographystyle{iclr2025_conference}

\clearpage

\appendix
\input{sections/appendix}

\end{document}
