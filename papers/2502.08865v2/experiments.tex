\section{Experiments on Open-Source Systems}
\label{sec:exp}

The goal of this section is to understand how acoustic attacks impact the first stage of the pipeline in \Cref{fig:overview}, pose estimation, in isolation, before considering end-to-end effects (\cref{sec:exp-hololens2}).
We will study the impact of perturbations on two  pose estimation frameworks:
%In this section, we will first study the effect of perturbations on accelerometer and gyroscope readings in the 
ORB-SLAM3 \cite{campos2021orb}, which is an open-source VIO library widely deployed as the basis of many SLAM systems 
%\jiasi{do we know it's deployed in practice? I would believe it but references?} \zijian{ORB-SLAM3 itself has a closed-source version for commercial usages}
(\Cref{subsec:exp-orbslam3}), as well as the ILLIXR runtime~\cite{huzaifa2021illixr}, which is an open testbed developed by academia (\Cref{subsec:exp-illixr}).
Together, these two evaluation platforms enable us to understand how different, popular pose estimation algorithms behave under controlled inputs.
%In \Cref{sec:exp-hololens2}, we study one of the effects on the popular commercial AR headset HoloLens 2 \cite{ungureanu2020hololens} and demonstrate some AR/VR specific attacks on it.










\subsection{Attack on ORB-SLAM3}
\label{subsec:exp-orbslam3}
%To understand the influence of perturbation on IMUs to the Visual-Inertial SLAMs, which is widely used in today's modern AR/VR headsets' multimodality systems, in a more detailed way, 
We simulate the effects of acoustic injection attacks on ORB-SLAM3 \cite{campos2021orb}
by adding noise to input IMU values in one of two ways: (1) in a fine-grained way, creating a constant bias, as studied by \cite{trippel2017walnut}; and (2) in a coarse-grained way, by building a data-driven model based on real headset measurements.
%for a coarse-grained control that takes the real effects into account.
%\jiasi{what does ``fine-grained'' and ``model for course control'' mean? I didn't understand how it maps to our experiments.} \zijian{finegrained means constant perturbation, course control means GMM perturbation}




%\begin{figure*}[htbp]
%    \centering
%    \begin{tabular}{ccc}
%        % First row of subfigures
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro X 2D trace plot X-Y.pdf}
%            \caption{X axis, X-Y plot}
%            \label{subfig:orbslam_gyro_constant_1}
%        \end{subfigure} &
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro Y 2D trace plot X-Y.pdf}
%            \caption{Y axis, X-Y plot}
%            \label{subfig:orbslam_gyro_constant_2}
%        \end{subfigure} &
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro Z 2D trace plot X-Y.pdf}
%            \caption{Z axis, X-Y plot}
%            \label{subfig:orbslam_gyro_constant_3}
%        \end{subfigure} \\
%        
%        % Second row of subfigures
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro X 2D trace plot Z-Y.pdf}
%            \caption{X axis, Z-Y plot}
%            \label{subfig:orbslam_gyro_constant_4}
%        \end{subfigure} &
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro Y 2D trace plot Z-Y.pdf}
%            \caption{Y axis, Z-Y plot}
%            \label{subfig:orbslam_gyro_constant_5}
%        \end{subfigure} &
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/Gyro Z 2D trace plot Z-Y.pdf}
%            \caption{Z axis, Z-Y plot}
%            \label{subfig:orbslam_gyro_constant_6}
%        \end{subfigure}
%    \end{tabular}
%    \caption{2D plots of ORB-SLAM3 pose traces under constant perturbation on gyroscope readings on different axis with different directions and magnitudes. ``neg'' means negative, and ``pos'' means positive. Numbers in each legend is the magnitude of perturbation.}
%    \label{fig:orbslam_gyro_constant}
%\end{figure*}





\subsubsection{Constant IMU Perturbations} 
\label{subsubsec:exp-orbslam3-constant}
\textbf{\emph{Setup.}}
As a first step, we start with the simplest scenario: adding constant bias to the IMU readings, which is possible in practical scenarios~\cite{trippel2017walnut}.
%As studied by many acoustic attack works, constant bias or even a specific designed IMU reading pattern can be achieved by fine-tuning the amplitude or the phase.
We add or subtract a constant value to the $x, y, z$ axes of accelerometer or gyroscope readings throughout the entire trace.
For realism, we constrain the range of perturbation to $[-g,+g]$ for accelerometer readings, where $g$ is the gravitational acceleration of 9.8 m/s$^2$, and $[-2\;\text{rad/s}, +2\;\text{rad/s}]$ for gyroscope readings, as reported in a previous study~\cite{jeong2023rocking}.
%\jiasi{can we cite Walnut/other papers to say these values are achievable in practice? isn't 2 rad/s quite a lot?} \zijian{done}
We leave the camera images unmodified as we do not assume an attack vector for the camera.
To understand the fundamental impact of the constant perturbation, we created a trace with a simple but common walking pattern of moving forward, recording camera images and IMU readings using a RealSense D435i~\cite{hu2024apple}.
In this trace, the user moves about 4 meters along the positive $y$ direction of the world frame for about 10 seconds. 
%\jiasi{the trace already publicly exists, or it's the trace from Tianyi? put one sentence more detail like trace duration, distance walked, Hololens 2, etc.} \zijian{done}
Note that the coordinate system of ORB-SLAM3 differs from that of the RealSense camera, as shown in \Cref{fig:coordinate_systems}, so we have to transform the coordinates of the camera data appropriately before feeding it into ORB-SLAM3.
%which is the output frame is that $x$ is left, $y$ is forward and $z$ is upward, and the coordinate system of the IMU sensor in RealSense D435i camera is that $x$ is right, $y$ is downward and $z$ is forward. The coordinate systems of ORB-SLAM3 and IMU is in \Cref{fig:coordinate_systems}. 

\begin{figure}[t]
    \centering
    % \vspace{-30pt}
    \includegraphics[width=0.45\textwidth]{figures/coordinate_system.pdf} % Replace 'image.png' with your actual image filename
    % \vspace{-30pt}
    \caption{The coordinate systems of ORB-SLAM3 (left) and IMU on the RealSense D435i camera (right) differ.}
    \label{fig:coordinate_systems}
\end{figure}

\textbf{\emph{Results of constant IMU perturbations.}}
We plot the trajectory output by ORB-SLAM3 in \Cref{subfig:orbslam_acc_constant_1,subfig:orbslam_acc_constant_6,subfig:orbslam_gyro_constant_3} for different magnitudes and directions of the input IMU data with perturbations.
The benign case is a simple forward and backward movement (blue line).
When the $x$ axis of the accelerometer, $z$ axis of the accelerometer, or the $z$ axis of gyroscope are perturbed,
 %(corresponding to the \jiasi{forward? left/right?}  directions) \zijian{since we mention both acc and gyro here and we have Figure 3, should we add this explanation?}, 
we can see that the trajectory error increases roughly proportionally with magnitude and duration of the perturbation.
For example, when the perturbation is $x+2.1\,\text{m/s}^2$, the final position is about 1.1 meters off, and when the perturbation is $x+4.1\,\text{m/s}^2$, the final position is about 1.8 meters off. %\zijian{done}
We call this effect the \textbf{Misleading attack}.
The impact on the displayed virtual content in an XR headset would be displacement; \eg if the final estimated device pose is 2 meters off to the right, the virtual content would be displayed 2 meters to the left (similar visualizations will be shown later in \Cref{subsec:exp-illixr} and \Cref{sec:exp-hololens2}). As shown in \Cref{subfig:orbslam_gyro_constant_3}, the perturbation on the gyroscope has a similar effect, causing the trajectory to veer off course since the IMU perceives an angular rotation. 
%\jiasi{mention gyro has same effect as acc, briefly} \zijian{done}

\begin{figure*}[h]
    \centering
    \begin{tabular}{ccc}
        % First row of subfigures
        \begin{subfigure}[b]{0.32\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/Acc_X_2D_trace_plot_X-Y.pdf}
            \caption{Attack on accelerometer X axis, X-Y plot in ORB-SLAM3 world frame}
            \label{subfig:orbslam_acc_constant_1}
        \end{subfigure}
        ~
        %\begin{subfigure}[b]{0.3\textwidth}
        %    \centering
        %    \includegraphics[width=\textwidth]{figures/Acc Y 2D trace plot X-Y.pdf}
        %    \caption{Y axis, X-Y plot}
        %    \label{subfig:orbslam_acc_constant_2}
        %\end{subfigure} &
        %\begin{subfigure}[b]{0.3\textwidth}
        %    \centering
        %    \includegraphics[width=\textwidth]{figures/Acc Z 2D trace plot X-Y.pdf}
        %    \caption{Z axis, X-Y plot}
        %    \label{subfig:orbslam_acc_constant_3}
        %\end{subfigure} \\
        
        % Second row of subfigures
        %\begin{subfigure}[b]{0.3\textwidth}
        %    \centering
        %    \includegraphics[width=\textwidth]{figures/Acc X 2D trace plot Z-Y.pdf}
        %    \caption{X axis, Z-Y plot}
        %    \label{subfig:orbslam_acc_constant_4}
        %\end{subfigure} &
        %\begin{subfigure}[b]{0.3\textwidth}
        %    \centering
        %    \includegraphics[width=\textwidth]{figures/Acc Y 2D trace plot Z-Y.pdf}
        %    \caption{Y axis, Z-Y plot}
        %    \label{subfig:orbslam_acc_constant_5}
        %\end{subfigure} &
        \begin{subfigure}[b]{0.32\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/Acc_Z_2D_trace_plot_Z-Y.pdf}
            \caption{Attack on accelerometer Z axis, Z-Y plot in ORB-SLAM3 world frame}
            \label{subfig:orbslam_acc_constant_6}
        \end{subfigure}
        ~
        \begin{subfigure}[b]{0.32\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/Gyro_Z_2D_trace_plot_X-Y.pdf}
            \caption{Attack on gyroscope Z axis, X-Y plot in ORB-SLAM3 world frame}
            \label{subfig:orbslam_gyro_constant_3}
        \end{subfigure} \\
    \end{tabular}
    \caption{
    Device pose estimated by ORB-SLAM3 under constant perturbation on the IMU readings.
    %``neg'' means negative, and ``pos'' means positive. 
    Legend denotes perturbation magnitude.
    Increased magnitude of perturbations leads to increased pose error (\textbf{Misleading attack}), and beyond a threshold, devices default to the origin (\textbf{Snapback attack}).
    }
    \label{fig:orbslam_acc_constant}
\end{figure*}

One key finding is that when the perturbation is large (\eg larger than $6.1\,\text{m/s}^2$ for the x-axis of the accelerometer or larger than $1.6\,\text{rad/s}$ for the gyroscope axis), the device's estimated pose will go back to zero.
As seen in \Cref{subfig:orbslam_acc_constant_1}, the device's estimated pose remains at the origin (0,0,0).
%For example, in \Cref{subfig:orbslam_acc_constant_1}, with a perturbation of $\pm [0.1,2.1,4.1]\,m/s^2$, the misleading attack occurs, while the re-initialization happens with the perturbation $\pm 6.1,8.1\,m/s^2$\jiasi{describe a specific example. highlight 0,0,0 part}. \zijian{done}
We call this the \textbf{Snapback attack}.
Regarding timing, we find that the snapback effect mainly happens at the onset or termination of the sound.
\Cref{fig:orbslam_snapback} shows a more detailed visualization of the snapback effect, where the snapback happens when the sound ends at time=2.
%We apply the same perturbation which does not cause snapback when adding it to the whole trace during either the first half or the second half of the trace, and we find that the snapback effect can take place when adding the perturbation in the middle or stop suddenly, as shown in \Cref{fig:orbslam_snapback}.
%\jiasi{Zijian to add another visualization and text description of snap back.}
%\jiasi{Write a sentence about snap back happening when sound starts or ends.} \zijian{done}

\begin{figure*}[htb]
    \centering
    \begin{tabular}{cccc}
        % First row of subfigures
        \begin{subfigure}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/firsthalf_snapback_1.pdf}
            \caption{time=0: device at origin}
            \label{subfig:firsthalf_snapback_frame1}
        \end{subfigure} &
        \begin{subfigure}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/firsthalf_snapback_2.pdf}
            \caption{time=1: device moves normally}
            \label{subfig:firsthalf_snapback_frame2}
        \end{subfigure} &
        \begin{subfigure}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/firsthalf_snapback_3.pdf}
            \caption{time=2: snapback occurs, device thinks it's at origin}
            \label{subfig:firsthalf_snapback_frame3}
        \end{subfigure} &
        \begin{subfigure}[t]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/firsthalf_snapback_4.pdf}
            \caption{time=3: device moves normally from new origin}
            \label{subfig:firsthalf_snapback_frame4}
        \end{subfigure} 
    \end{tabular}
    \caption{Detailed visualization of snapback attack in ORB-SLAM3. The acoustic attack ends at time=2 and snapback occurs. The scatter points represent visual features found in the real-world environment.
    %The figures in the first row are 4 frames of adding the perturbation on the accelerometer X-axis during the first half of the trace, and the figures in the second row are 5 frames of adding the perturbation on the accelerometer X-axis during the second half of the trace. frame 1 is the starting frame, frame 2 is a frame between the starting frame and \textbf{snapback} frame, frame 3 is the \textbf{snapback} frame, frame 4 is one frame after the \textbf{snapback}. \zijian{add arrows for start and end}
    }
    \label{fig:orbslam_snapback}
\end{figure*}

The snapback effect happens because only the IMU is perturbed and the camera is not; the mis-matched sensor readings confuse ORB-SLAM3 and cause it will lose track of its pose estimate, calling a failure recovery function that re-initializes the map and setting the device pose to its default at the origin~\cite{campos2021orb}.
This kind of failure recovery is common in commercial SLAM frameworks, such as that deployed in the Hololens 2, and can cause the snap back effect as we will show later in \Cref{sec:exp-hololens2}.
%What needs paying attention is that this kind of design is common in commercial SLAM systems, such as HoloLens 2, which might cause the snap back attack. %\jiasi{ask Zijian in meeting what the last sentence means} \zijian{want to connect this to snapback effect in HoloLens in later section}

We note that even though the change in the estimated pose corresponds to the direction of the perturbation when we apply it on $x$-axis of the accelerometer as shown in \Cref{subfig:orbslam_acc_constant_1}, the result in \Cref{subfig:orbslam_acc_constant_6,subfig:orbslam_gyro_constant_3} shows that this is not always the case.
For example, in \Cref{subfig:orbslam_acc_constant_6}, adding perturbations to the forward-backward direction produces incorrect pose estimates in the up-down direction.
We hypothesize that this is due to the complexity of VIO-SLAM processing, where the final pose estimate depends not only on the IMU readings but also on camera images through a series of non-linear optimizations~\cite{campos2021orb}.
Our real experiments later on (\Cref{sec:exp-hololens2}) also confirm this non-intuitive mapping between the axis of acoustic injection and the axis of pose mis-estimation.
%, and does not hold a one-to-one relationship with the IMU readings. 
Therefore, we argue that the attacker needs to conduct careful profiling ahead of time if he wants to create wrong pose estimates in certain directions for a misleading attack.
%\jiasi{is there a one-to-one correspondence in our real experiments later? to discuss} \zijian{I don't think so.}



%JC: The main points to me are: sound plays in the first half -> stay at 0. Sound plays in second half -> cuts map in half.
%Having this initial understanding of the effects of the acoustic signal on the final pose estimated by the ORB-SLAM3 system, we design some more complicated patterns to mislead the estimated trajectories: 
%\begin{itemize}
%    \item \textbf{Attack in Advance.} As shown in \Cref{fig:orbslam_acc_constant_firsthalf,fig:orbslam_gyro_constant_firsthalf}, the attacker can cheat users at the beginning by injecting acoustic signals with small magnitude only at the beginning (first half in our cases), which will cause initialization and false map construction a while later (e.g. \Cref{subfig:orbslam_acc_constant_1} vs. \Cref{subfig:orbslam_acc_constant_1_firsthalf}, \Cref{subfig:orbslam_gyro_constant_1} vs. \Cref{subfig:orbslam_gyro_constant_1_firsthalf})
%    \item \textbf{Partial Attack.} In partial attack, we inject acoustic signals in the middle of the trace. As shown in \Cref{fig:orbslam_acc_constant_secondhalf,fig:orbslam_gyro_constant_secondhalf}, this kind of attack can cause initialization in the middle of the trace and further mislead. 
%    \item \textbf{Linear Change Attack.} While \textbf{Attack in Advance} and \textbf{Partial Attack} add constant perturbation suddenly to the IMU sensor readings in the SLAM system, we study linear change perturbation, which simulates the gradually changing noise, to test whether it can mislead the pose estimation with larger perturbation magnitude while does not cause reinitialization. This is partially achieved in \Cref{subfig:orbslam_acc_constant_6_firsthalf_linear}. Meanwhile, as shown in \textbf{Partial Attack} and \textbf{Linear Change Attack}, the reinitialization will occur whenever the perturbation suddenly appear or disappear. 
%    \jiasi{important point; which plot shows snapback when sound stops? maybe a time series plot would be better?}
%    This phenomenon is an important basis for our real attack on HoloLens 2 headset later in \Cref{sec:exp-hololens2}.
%\end{itemize}

% \begin{figure*}[htbp]
%     \centering
%     \begin{tabular}{ccc}
%         % First row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right x acc mean.jpg}
%             \caption{Accelerometer X-axis}
%             \label{subfig:right_mean_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right y acc mean.jpg}
%             \caption{Accelerometer Y-axis}
%             \label{subfig:right_mean_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right z acc mean.jpg}
%             \caption{Accelerometer Z-axis}
%             \label{subfig:right_mean_3}
%         \end{subfigure} \\
        
%         % Second row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right x gyro mean.jpg}
%             \caption{Gyroscope X-axis}
%             \label{subfig:right_mean_4}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right y gyro mean.jpg}
%             \caption{Gyroscope Y-axis}
%             \label{subfig:right_mean_5}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/right z gyro mean.jpg}
%             \caption{Gyroscope Z-axis}
%             \label{subfig:right_mean_6}
%         \end{subfigure}
%     \end{tabular}
%     \caption{The mean value of sensor readings on different axis on the accelerometer or the gyroscope of Hololens 2 under acoustic signals with different frequencies. The red dashed line shows the frequency with either the minimum or the maximum mean value.
%     \jiasi{only keep the plots that show the resonant frequency that matches with the main text} \zijian{how about only keeping the standard deviation plots?}}
%     \label{fig:right_mean}
% \end{figure*}




% \begin{figure*}[htbp]
%     \centering
%     \begin{tabular}{ccc}
%         % First row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc X GMM 2D trace plot X-Y.pdf}
%             \caption{X-axis, X-Y plot}
%             \label{subfig:orbslam_acc_gmm_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc Y GMM 2D trace plot X-Y.pdf}
%             \caption{Y-axis, X-Y plot}
%             \label{subfig:orbslam_acc_gmm_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc Z GMM 2D trace plot X-Y.pdf}
%             \caption{Z-axis, X-Y plot}
%             \label{subfig:orbslam_acc_gmm_3}
%         \end{subfigure} \\
        
%         % Second row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc X GMM 2D trace plot Z-Y.pdf}
%             \caption{X-axis, Z-Y plot}
%             \label{subfig:orbslam_acc_gmm_4}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc Y GMM 2D trace plot Z-Y.pdf}
%             \caption{Y-axis, Z-Y plot}
%             \label{subfig:orbslam_acc_gmm_5}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/Acc Z GMM 2D trace plot Z-Y.pdf}
%             \caption{Z-axis, Z-Y plot}
%             \label{subfig:orbslam_acc_gmm_6}
%         \end{subfigure}
%     \end{tabular}
%     \caption{2D plots of ORB-SLAM3 pose traces under GMM perturbation on accelerometer readings on different axis with different directions and final magnitudes. Numbers in each legend is the absolute value of the magnitude of the 2 gaussian distributions. \jiasi{just keep one of these? I don't see much difference between the subfigs} \zijian{agree}}
%     \label{fig:orbslam_acc_gmm}
% \end{figure*}




\subsubsection{Vulnerability of XR Headsets to Acoustic Attacks}
\label{sec:frequency_sweep}




While the constant IMU perturbations simulated in \Cref{subsubsec:exp-orbslam3-constant} can experimentally be demonstrated through fine-grained tuning of the acoustic signal's amplitude and phase~\cite{trippel2017walnut,tu2018injected}, such fine control is difficult to achieve in practical scenarios, due to the IMU sensor being embedded in the headset, the difficulty of determining the phase offset, unstable environment factors, etc.
Therefore, we need to create a more realistic model of IMU perturbations by characterizing what perturbations are possible on a real XR headset.
To do this, we subject the Hololens 2 and Quest 3 to acoustic waves at varying frequencies (this subsection), and use this data to create a better model of IMU perturbations (next subsection).


\begin{figure}[h]
    \centering
    \includegraphics[width=0.5\textwidth]{figures/setup.pdf} % Replace 'image.png' with your actual image filename
    \caption{Experimental setup with XR headset, speaker and sound source, and remote-control car for mobility.}
    \label{fig:exp_setup}
\end{figure}


\textbf{\emph{Setup.}}
We use the experimental setup depicted in \Cref{fig:exp_setup} to test the effects of the acoustic attack on the IMU embedded in HoloLens 2 \cite{ungureanu2020hololens}.
Specifically, a portable speaker (Beats Pill+) plays a pre-generated acoustic signal produced from the laptop, while the Hololens 2 remains stationary.
%(Note that the Bluetooth speaker can be replaced1 with other sound output devices, such as professional speakers with higher ultrasonic output efficiency, which can induce resonance in the gyroscopes.~\cite{jeong2023rocking,khazaaleh2019vulnerability,hong2022esp}.
%\jiasi{why are we saying this? it sounds like our setup is not good.} \zijian{yes, it seems better to remove this})
We verified the output of the portable speaker compared to a function generator (Agilent 33220A) plus amplifier and found little difference, so we used the portable speaker for ease of use.
The speaker is placed to the front or right of the headset at a distance of 5-10 cm.
The pre-generated acoustic signal sweeps across a frequency range from 2-30 kHz, with a step size of 50 Hz, playing for 30 seconds at each step, at a volume of 85 dB.
%\zijian{The speaker is about 5 to 10 centimeters from the headset and the sinusoidal sound wave is played in the full volume of the Betas Pill+ speaker which is 85 dB.}
%with commercial speakers or speaker connected with a professional amplifier and a function generator.
We log the accelerometer's and gyroscope's readings using the \texttt{hl2ss} library~\cite{dibene2022hololens}.

\begin{figure*}[h]
    \centering
    \begin{tabular}{ccc}
        % First row of subfigures
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_x_acc_std.pdf}
            \caption{Accelerometer X-axis}
            \label{subfig:right_std_1}
        \end{subfigure} &
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_y_acc_std.pdf}
            \caption{Accelerometer Y-axis}
            \label{subfig:right_std_2}
        \end{subfigure} &
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_z_acc_std.pdf}
            \caption{Accelerometer Z-axis}
            \label{subfig:right_std_3}
        \end{subfigure} \\
        
        % Second row of subfigures
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_x_gyro_std.pdf}
            \caption{Gyroscope X-axis}
            \label{subfig:right_std_4}
        \end{subfigure} &
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_y_gyro_std.pdf}
            \caption{Gyroscope Y-axis}
            \label{subfig:right_std_5}
        \end{subfigure} &
        \begin{subfigure}[b]{0.3\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/right_z_gyro_std.pdf}
            \caption{Gyroscope Z-axis}
            \label{subfig:right_std_6}
        \end{subfigure}
    \end{tabular}
    \caption{Frequency response of the Hololens 2 IMU. The red dashed line shows the resonant frequency where large changes in the sensor readings occur. The accelerometer is vulnerable at 2-2.6 kHz and the gyroscope at 17.7 kHz.
    %the frequency with either the minimum or the maximum standard deviation value.
    }
    % \caption{Standard deviation Hololens. 2.65 kHz matters most to accelerometer. Gyro also affected but no impact on pose. \zijian{modify}}
    \label{fig:right_std}
\end{figure*}


\textbf{\emph{Results of frequency sweep.}}
\Cref{fig:right_std} show the response of the headset's IMU to acoustic signals played at different frequencies.
We plot the mean and standard deviation of the accelerometer and gyroscope readings, corresponding to potential output bias or output control vulnerabilities~\cite{trippel2017walnut}.
From the results, we observe that there are multiple spikes in the mean or standard deviation values, for different axes, for different sensors. 
%, and analyze the mean and standard deviation values for each frequency  and set the frequency with the largest spike in either mean value or standard deviation as the resonant frequency (typically there are multiple spikes and any frequency as an integer multiple of the resonant frequency is also resonant frequency).
We find that the resonant effect is more significant in terms of the standard deviation, rather than the mean, suggesting an output biasing vulnerability (see \Cref{sec:background}.
The resonant frequency is 2.65 kHz, 2.05 kHz, and 2.05 kHz for the accelerometer's $x,y,z$-axis, respectively, and 17.7 kHz, 17.7 kHz, and 17.55 kHz for the gyroscope $x,y,z$-axis.
This aligns with previous findings \cite{jeong2023rocking} that the resonant frequency for the accelerometer is in the lower range of human hearing range and the resonant frequency for the gyroscope is close to or in the ultrasonic range.
We also performed frequency sweeping for the Meta Quest 3,  but it does not have obvious spikes in terms of mean and standard deviation values. We hypothesize that that this might be the result of the physically enclosed case around the sensors, or the internal positioning of the IMU.

%\jiasi{Can you summarize the findings? What were the resonant frequencies for acc, gyro? how does this compare to Injected and Delivered's old headset models? include gyro resonant frequency, although later we could not show gyro effects on Hololens}
%\jiasi{add a few sentences that we did experiments on Quest 3 but there was no effect} \zijian{done}



\subsubsection{Data-Driven IMU Perturbations} 
\label{subsubsec:orb-slam gmm}

\begin{figure}[h]
    \centering
        % First row of subfigures
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/x_acc_distribution_gmm.pdf}
            \caption{Accelerometer X-axis}
            \label{subfig:right_distribution_1}
        \end{subfigure}
        ~
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/x_gyro_distribution_gmm.pdf}
            \caption{Gyroscope X-axis}
            \label{subfig:right_distribution_4}
        \end{subfigure} 
    \caption{Modeling the distribution of IMU sensor readings of the HoloLens 2 IMU using a Gaussian mixture model, under attack by their resonant frequency.}
    \label{fig:right_distribution}
\end{figure}
With the knowledge gleaned from the experiments on the Hololens 2 in the preceding subsection, we next seek to create a model of the IMU perturbations that can be realized in practice on the headset.
To do this, we plot the distribution of the sensor readings in \Cref{fig:right_distribution}.
Without attack, we would expect the readings to be around 0 (or 9.8 m/s$^2$ for gravity), but with the acoustic attack, the sensor readings exhibit a spread.
%\jiasi{why are some of the accelerometer readings not centered at 0?} \zijian{because the axis is not exactly the forward-back, left-right, up-down firection and the X axis is close to the up-down direction.}
We fit the data to a Gaussian Mixture Model (GMM) using the expectation-maximization algorithm.
%\jiasi{can we say why we chose GMM rather than another distribution? Can we report anything about how good the fit is? some of the subfigures look like a good fit, others not so much}. \zijian{maybe say EM algorithm is most popular in clusing problem?}
%This reveals the distribution of perturbation when the acoustic signal is not finegrained tuned enough or the acoustic source is not perfect enough during generation or transmission. 



Based on the fit of the GMMs, we choose a plausible range of mean and standard deviation values for the perturbed IMU readings.
%To simulate the strong power when doing acoustic injection, 
Specifically, for the accelerometer, we set the standard deviation to 0.1 and the mean from 0 to $6.1\,\text{m/s}^2$; for the gyroscope, we set the same standard deviation and the mean from 0 to $1.6 \,\text{rad/s}$.
%\jiasi{can you add justification for why these ranges of mean values? does it correspond to different volume?} \zijian{the reference to the same paper \cite{jeong2023rocking}? shape (GMM) is from data, real data has mean less than 3, max 6 is from constant bias paper} 
These ranges of values are based on a combination of our own measurements and prior reported data~\cite{jeong2023rocking}.
%\jiasi{wait, we add the the GMM-fit values on top to the IMU readings from the trace? I thought \Cref{fig:orbslam_acc_gmm} showed the total value, not the added on value} \zijian{they are perturbation values}
%\jiasi{exp stationary, add to sim}


\begin{figure}[h]
    \centering
    \includegraphics[width=0.42\textwidth]{figures/Acc_X_GMM_2D_trace_plot_X-Y.pdf}
   % \caption{X-axis, X-Y plot} 
    \caption{
    Device pose estimated by ORB-SLAM3 under data-driven GMM perturbation on the IMU readings.
    %X-Y plane 2D plot of ORB-SLAM3 pose traces under GMM perturbation on accelerometer X-axis readings with different absolute mean magnitudes. Numbers in each legend is the absolute value of the magnitude of the 2 gaussian distributions.
    Legend denotes absolute value of GMM mean.
    Beyond a threshold (6.1), the \textbf{snapback} effect occurs.}
    \label{fig:orbslam_acc_gmm}
\end{figure}


To use this data-driven GMM model of IMU perturbations, 
we take sampled values from the GMM and add them to the corresponding IMU readings from the user trace.
We plot the impact of this perturbed IMU on the pose estimates of ORB-SLAM3 in \Cref{fig:orbslam_acc_gmm} for accelerometer inputs (gyroscope results are similar).
This more realistic model also exhibits the snapback effect from \Cref{subsec:exp-orbslam3} and \Cref{fig:orbslam_acc_constant}: namely, when the magnitude of the perturbations exceeds a threshold (in the GMM case, a mean of 6.1 m/s$^2$), the snapback effect occurs and the device re-initializes its pose to the origin.
%\jiasi{how does the 1.6 threshold compare to the threshold from the constant perturbation case?} \zijian{I think this is just an example but not a hard threshold?}
For smaller mean perturbations, we observe less of a misleading effect, with up to 0.5 meters difference from the ground truth trajectory.
%We can see that even random perturbation on accelerometer can cause about 0.5 meters difference from \Cref{fig:orbslam_acc_gmm,fig:orbslam_gyro_gmm} or even stuck at original point as shown in \Cref{fig:orbslam_gyro_gmm}. 
Overall, these results provide further evidence that ORB-SLAM3 based pose estimation will exhibit snapback effects when under acoustic attacks.





% \begin{figure*}[htbp]
%     \centering
%     \begin{tabular}{ccc}
%         % First row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_1_1.png}
%             \caption{$[0\%,10\%]$, run 1 \jiasi{can you mark the time period on the graph when the attack is?}}
%             \label{subfig:illixr_acc_gmm_1_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_1_2.png}
%             \caption{$[0\%,10\%]$, run 2}
%             \label{subfig:illixr_acc_gmm_1_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_1_3.png}
%             \caption{$[0\%,10\%]$, run 3}
%             \label{subfig:illixr_acc_gmm_1_3}
%         \end{subfigure} \\
        
%         % Second row of subfigures
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_2_1.png}
%             \caption{$[30\%,40\%]$, run 1}
%             \label{subfig:illixr_acc_gmm_2_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_2_2.png}
%             \caption{$[30\%,40\%]$, run 2}
%             \label{subfig:illixr_acc_gmm_2_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_2_3.png}
%             \caption{$[30\%,40\%]$, run 3}
%             \label{subfig:illixr_acc_gmm_2_3}
%         \end{subfigure} \\ 

%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_3_1.png}
%             \caption{$[50\%,60\%]$, run 1}
%             \label{subfig:illixr_acc_gmm_3_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_3_2.png}
%             \caption{$[50\%,60\%]$, run 2}
%             \label{subfig:illixr_acc_gmm_3_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_3_3.png}
%             \caption{$[50\%,60\%]$, run 3}
%             \label{subfig:illixr_acc_gmm_3_3}
%         \end{subfigure} \\ 

%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_4_1.png}
%             \caption{$[70\%,80\%]$, run 1}
%             \label{subfig:illixr_acc_gmm_4_1}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_4_2.png}
%             \caption{$[70\%,80\%]$, run 2}
%             \label{subfig:illixr_acc_gmm_4_2}
%         \end{subfigure} &
%         \begin{subfigure}[b]{0.3\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{figures/illixr_gmm_4_3.png}
%             \caption{$[70\%,80\%]$, run 3}
%             \label{subfig:illixr_acc_gmm_4_3}
%         \end{subfigure} \\
%     \end{tabular}
%     \caption{Position Error by applying the GMM on ILLIXR distribution perturbation with mean, std = 0.5 on the accelerometer x-axis readings in different time frames ($0\%$ to $10\%$, $30\%$ to $40\%$, $50\%$ to $60\%$ and $70\%$ to $80\%$). \jiasi{add labels to x and y axis}}
%     \label{fig:illixr_acc_gmm}
% \end{figure*}





\subsection{Attacks on ILLIXR}
\label{subsec:exp-illixr}

The processing pipelines in commercial XR headsets are typically closed-source.
Therefore, to understand the range of possible effects from acoustic attacks, we experiment with another open XR research testbed, ILLIXR ~\cite{huzaifa2022illixr}.
ILLIXR uses a different pose estimation method, OpenVINS~\cite{geneva2020openvins}.
%With the systematic study in \Cref{subsec:exp-orbslam3}, we go one step further to study the acoustic injection effect in AR / VR / MR environments by simulation on the ILLIXR platform \cite{huzaifa2021illixr}. 
We inject the same two types of perturbation as in \Cref{subsec:exp-illixr}, constant perturbation, and data-driven perturbations.
We apply the perturbations to traces from a standard SLAM dataset, EuRoC~\cite{Burri25012016}. 
These trajectories are more complex than the ones we studied for ORB-SLAM3, enabling us to examine more complex effects of acoustic attacks.

\subsubsection{Constant IMU Perturbations} 

\begin{figure}[h]
    \centering
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/MH05_Constant_X+1.pdf}
            \caption{+1 m/s$^2$ on the accelerometer X-axis}
            \label{subfig:illixr_acc_x_constant_3}
        \end{subfigure} ~
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/MH05_Constant_X+2.pdf}
            \caption{+2 m/s$^2$ on the accelerometer X-axis}
            \label{subfig:illixr_acc_x_constant_4}
        \end{subfigure}
    \caption{
    Device pose estimated by ILLIXR under constant perturbation on the accelerometer.
    For larger perturbation (right), the device loses track of its pose and the \textbf{drift away} effect occurs.
    %3D plots of ILLIXR pose traces under constant perturbation on accelerometer readings on different axis with different directions and magnitudes. The ground truth map is the EuRoC MH05 map.
    }
    \label{fig:illixr_acc_constant}
\end{figure}
%As the constant perturbation is a very accurate attack method, we choose the 
For illustrative purposes, we focus on a particular trace from the EuRoC dataset (MH05), due to its relative simplicity compared to other traces in the dataset.
%in showing the precise control of pose estimation. 
\Cref{fig:illixr_acc_constant} shows the effect of adding a small constant perturbation (+1 m/s$^2$) to the x axis of the accelerometer.
The results in \Cref{subfig:illixr_acc_x_constant_3} show that the misleading attack is possible in one direction, with the new trajectory being precisely offset from the ground truth.
%, which might cause a malfunction of the localization system in headsets or even a safety issue by leading users to an unsafe area.
However, different from the snap back attack observed on ORB-SLAM3, with ILLIXR, when the perturbation is larger (+2 m/s$^2$ in \Cref{subfig:illixr_acc_x_constant_4}), 
%At the same time, the SLAM system will totally not work when the perturbation is large enough, which will cause the problem of \textbf{ drifting away}.
pose estimation will fail, causing the \textbf{Drift away attack}.
This means that the device's estimated pose drifts away to infinity.
%, an essential phenomenon in the XR environment (\eg \Cref{subfig:illixr_acc_x_constant_4})).
In terms of the effects on the AR display, screenshots from ILLIXR of the drifting away effect are shown in \Cref{fig:illixr_driftaway}, where the virtual object (colorful cube) flies away out of view.
The differing responses of ORB-SLAM3 and ILLIXR to IMU perturbations are due to how the pose estimation modules handle tracking loss.


\begin{figure}[h]
    \centering
%    \begin{tabular}{ccc}
        % First row of subfigures
        \begin{subfigure}[b]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/illixr_driftaway_1.pdf}
            \caption{time=0}
            \label{subfig:illixr_driftaway_1}
        \end{subfigure}~
        \begin{subfigure}[b]{0.23\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/illixr_driftaway_2.pdf}
            \caption{time=1}
            \label{subfig:illixr_driftaway_2}
        \end{subfigure}
%        \begin{subfigure}[b]{0.3\textwidth}
%            \centering
%            \includegraphics[width=\textwidth]{figures/illixr_driftaway_3.png}
%            \caption{$time=2$}
%            \label{subfig:illixr_driftaway_3}
%        \end{subfigure}
%    \end{tabular}
    \caption{Visualization of \textbf{drift away} attack in ILLIXR (virtual cube flies away) when the device's pose estimation does not reset to the origin to recover from tracking failure.}
    \label{fig:illixr_driftaway}
\end{figure}

%The \textbf{Snapback} effect does not happen in the ILLIXR system. This is because 
ILLIXR uses OpenVINS \cite{geneva2020openvins}, which does not re-initialize the device pose (\ie reset the pose to (0,0,0)) when the estimated pose is deemed unreliable, while ORB-SLAM does.


\subsubsection{Data-Driven IMU Perturbations} 
\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/illixr_acc_gmm.pdf}
    \caption{Effect of attack timing on the \textbf{drift away} attack (start=red dot, end=green dot), measured by feeding GMM-perturbed IMU readings to ILLIXR. Position error grows exponentially towards the end of the trace. % distribution perturbation with mean, std = 0.5 on the accelerometer x-axis readings in different time frames.
    %The red dots are the starting point of adding perturbation, and the light green dots are the ending point of the perturbation.}
    }
    \label{fig:illixr_acc_gmm}
\end{figure}
%As what we do in \Cref{subsubsec:orb-slam gmm}, we study the effect when the perturbation on IMU readings is not accurate enough.
Using the same GMM model as in  \Cref{subsubsec:orb-slam gmm}, we apply the perturbations for different time frames in the overall trace (from $0\%$ to $10\%$, $30\%$ to $40\%$, $50\%$ to $60\%$ and $70\%$ to $80\%$). 
The goal is to understand whether the drift away attack occurs nearly instantaneously when the IMU perturbations start/stop (as they do with ORB-SLAM3), or whether there is a time delay to see the effects of the acoustic attack.
The time series of the device's estimate pose are shown in \Cref{fig:illixr_acc_gmm}.
We observe two effects: \emph{\textbf{(1) Time Delay}}: When we apply the perturbation for a short time period, whether it is at the beginning or in the middle (\eg [0\%,10\%] or [30\%,40\%]), the pose estimation is still normal during the attack, but it will cause problems after some time (\eg around timestep 10,000); \emph{\textbf{(2) Exponential Drift Error}}: Even though no acoustic attack is present towards the end of the trace, the pose error will increase exponentially during the drift away attack. %, which is the SLAM system is totally not working. 
We believe both of these effects are due to the integrations during state estimation in SLAM, which cause errors to accumulate over time before eventually exploding.
%\jiasi{can you elaborate? what does this sentence mean?}
%\zijian{I mean the VI-SLAM state estimation have integral calculation, which will make the error larger and larger over time.}



\section{Proof-of-Concept Attacks on HoloLens}
\label{sec:exp-hololens2}

In this subsection, we use the knowledge gained from the attacks on ORB-SLAM3 (\Cref{subsec:exp-orbslam3}) and ILLIXR (\Cref{subsec:exp-illixr}) to demonstrate an end-to-end attack on a commercial XR headset.
We demonstrate several types of attacks on the Microsoft HoloLens 2~\cite{ungureanu2020hololens} using adversarial acoustic signals.
Our main finding is that we are able to replicate the snap back attack on the real device and leverage this effect to carry out four distinct proof-of-concept attacks.

% \yicheng{Yicheng will help draft this section.}


% As a proof and demonstration of the feasibility of our acoustic attack, we further apply the adversarial acoustic signals to the commercial AR headset HoloLens 2~\cite{ungureanu2020hololens}. 

% Sophie's thoughts: we should talk about setup and sweeps for the accelerometer and gyroscope.
%JC: yes, I moved part of the setup text below to earlier to go with the frequency sweeps.

\subsection{Experimental Setup} 

The experimental setup is the same as \Cref{sec:frequency_sweep}, including distance and volume, plus some additional functionality.
Along with the stationary settings discussed earlier, we also wish to experiment with user motion.
To do this in a repeatable and controlled fashion, we place the Hololens 2 on a remote-controlled toy car whose movement can be programmed and synchronized with the acoustic signals. 
%\zijian{The sound is played in the same manner of the frequency sweep experiment. 
%, which is generated using Python libraries.
% Our experiments do not involve volunteers wearing the headset, ensuring that no users were affected by the testing. 
The proof-of-concept AR applications are developed using Unity version 2022.3.15f1~\cite{UnitySDK} and the Microsoft Mixed Reality Toolkit (MRTK) version 2.8.3~\cite{mrtk}. During the experiments, we log the traces (including position and rotation) of both the headset and 3D objects in each application using the \texttt{hl2ss} interface~\cite{dibene2022hololens}, while also recording the renderings generated by the headset.





\subsection{Validation of Snapback Attack}
\label{sec:snapback_effect}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/snapback_basic.pdf}
    \caption{Example of of \textbf{snapback} effect on a Hololens 2 under acoustic injection attack. In the benign case, the headset starts at the green dot, moves forward, and stops. When a 2.6 kHz tone plays, the position of the headset snaps back.}
    \label{fig:holo_acc_basic}
\end{figure}


\textbf{Attack validation.}
Our experiments show that the snapback effect, simulated on ORB-SLAM3  (\Cref{subsec:exp-orbslam3}), can be recreated on the Hololens 2 as follows.
%Each experiment was run as follows: 
The headset was placed on a stationary remote-controlled car and its pose logged for 10 seconds in silence.
The car with the headset on top of it then drove forward for 10 seconds, while the speaker played a single 10-second tone at 2600 Hz (the resonant frequency of the accelerometer from \ref{sec:frequency_sweep}). Another 10 seconds of silence followed after the car and headset stopped moving.
\Cref{fig:holo_acc_basic} shows a sample trajectory of the headset without the acoustic attack (blue line) and with the acoustic attack (red line).
The headset suddenly estimated its position as (0, 0) after the headset and sound paused.
%\sophie{I'm actually not sure that it is exactly the origin--since its more like x-z origin)}
We repeated this experiment multiple times and achieved success rates $>90\%$.
%\sophie{yep-should make sure it is clear that we have a high success rate if the sound is sufficiently loud and long though}
%\jiasi{can we say this:} 

The key difference between making the snapback attack work in practice, compared to the ORB-SLAM3 simulation, was that the headset should be moving when the acoustic attack occurs.
When the headset was stationary and the acoustic sound was played, we did not observe any effect.
We hypothesize that this is because when stationary, the headset is able to filter out the effects of the acoustic attack as noise. However, when the headset was moving there were legitimate IMU signals mixed in with the noise, the headset was unable to filter out the attack and hence generated inaccurate pose estimates.
%\jiasi{should we mention the negative result that despite the resonant gyroscope frequencies in (\Cref{sec:frequency_sweep}), pose estimation was not affected. And speculate why} \zijian{adding to limitation section}

%\sophie{we suspect this is because of error handeling? a headset when first turned on is located at origin}
\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/volume_ASR.pdf}
    \caption{Impact of sound volume on attack success rate and mean translation.
    %. The plot of attack successful rate (ASR) and average translation distance under different volume. 
   A successful attack is defined as as \textbf{snapback} happening, and the mean translation is the average headset motion before the snapback occurs.
   %and the volume ratio as the ratio of the maximum sound volume. 
   A volume ratio of 1.0 corresponds to 85 dB.}
    \label{fig:volume_ASR}
\end{figure}

\textbf{Impact of sound volume.}
We also study the impact of the volume of the acoustic signal and the attack success rate (ASR).
Specifically, we run the same experiment as above, but with each trial at a different volume ratio, relative to the maximum volume of the speaker.
We run 5 trials at each volume and log the fraction of trials that the \textbf{snapback} occurs. In \Cref{fig:volume_ASR}, we observe that there is a threshold of signal power (around 50\% of the maximum speaker volume), below which the attack fails. %for the effectiveness of the attack.
We hypothesize that this is because at low volumes, the resulting small perturbation on the IMU readings can be compensated for by other sensors' observations and corrected by SLAM during sensor fusion, reducing the snapback effect. 

\textbf{Impact of background music.}
Since the resonant frequency of the Hololens 2 is in the audible range, we also conducted experiments to test the effectiveness of %the resonant frequency sound 
acoustic attack when masked by background music. 
In detail, we played a fast-paced rock song (``In the End (Instrumental)'' by Linkin Park) alongside the resonant sound on the same speaker at 85 dB, %using the same only speaker at the same time, 
which we qualitatively observed can hide the resonant sound to a large extent.
On the Hololens, we observed the same re-initialization and snapback effect.





\begin{figure}
    \centering
    \includegraphics[width=0.45\textwidth]{figures/snapback_diagram-crop.pdf}
    \caption{Effect of \textbf{snapback} effect on rendered virtual content. Normally, the world coordinates (black axes) should remain fixed on the grass. Under acoustic attack, when the user (blue smiley) moves across the grass (blue dashed line), the world coordinates reset and cube remains stuck at (3,2) in the user's display.
    %The cube with dashed lines represents some random shift of objects when playing acoustic signal.
    }
    \label{fig:snapback_virtual}
\end{figure}



\subsection{Impact on AR Applications} %\zijian{maybe a subsection and later 4 APPs as subsubsection?}
While pose re-initialization is commonly used when tracking is lost, preventing exponential drift in modern SLAM systems~\cite{campos2021orb}, it can create adverse visual and UI effects in XR applications.
%\yicheng{Can we add one reference about it?}. 
Below, we present four demonstration XR apps that illustrate two primary impacts of the snapback effect: (1) \textbf{potential harm to the user} and (2) \textbf{potential benefits to the user}. Note that the ``user'' is defined as the person wearing the headset, and may be either the attacker or the victim. 




To build these demonstration applications, we first have to understand the impact of the snapback attack on the visual display.
In \Cref{fig:snapback_virtual}, we illustrate what happens to a virtual object on the user's display during a snapback attack.
After the user moves and during a snapback (when the sound starts or stops), the world coordinate system will re-initialize to (0,0) because of the false readings of IMU caused by the acoustic signal. 
%, which further cause the snapback in the reinitialized coordinate systems. 
Since the virtual cube is always at (3,2) in world coordinates, it will appear at that same position relative to the user, \ie higher in the sky after the user moved and snapback occurred.
In other words, the virtual cube will appear as head-locked content that is frozen in place on the display, violating XR UI design guidelines~\cite{lebeck2017securing}.

In addition to the head-locked virtual content, we also observe an additional effect that we previously did not find during the simulations: a \textbf{small drift} effect.
Namely, during the acoustic signal, sometimes the virtual objects will have random shifts of a few tens of centimeters, which is illustrated by the cube with dashed lines in \Cref{fig:snapback_virtual}. 
We hypothesize that this is due to slight noise in the pose estimate, but not severe enough to cause snap back (similar to the Misleading effect).
We leverage this small drift effect during several of our demonstration apps.


The four proof-of-concept attacks we demonstrate are summarized in \Cref{table:app_summary}, in terms of user positioning (user is mobile or stationary) and the effect on the virtual content.
In the second column, virtual content should be world-locked (fixed in the real world) but is instead head-locked (fixed on the user's display); for example, in the ``denial of user interaction'' attack, the snapback effect causes an opaque virtual wall to be block the user's display.
In the third column, virtual content drifts unexpectedly in the user's display; for example, in the ``clickjacking attack'', a virtual keyboard that drifts even if the user is stationary.
Details of the attacks follow in the next four subsections.


\begin{table}[]
\begin{tabular}{l|ll|}
\cline{2-3}
 &
  \multicolumn{2}{c|}{\textbf{Undesired effect}} \\ \cline{2-3} 
 &
  \multicolumn{1}{l|}{\textbf{\begin{tabular}[c]{@{}l@{}}Virtual content\\is head-locked\end{tabular}}} &
  \textbf{\begin{tabular}[c]{@{}l@{}}Virtual content\\ drifts\end{tabular}} \\ \hline
\multicolumn{1}{|l|}{\textbf{\begin{tabular}[c]{@{}l@{}}User\\ mobile\end{tabular}}} &
  \multicolumn{1}{l|}{\begin{tabular}[c]{@{}l@{}}Denial of user\\ interaction (\S\ref{sec:app_blocking_wall})\\ Secure zone\\ invasion (\S\ref{sec:app_secure_zone})\end{tabular}} &
  \begin{tabular}[c]{@{}l@{}}Manipulating\\ user input (\S\ref{sec:app_vr_gaming})\end{tabular} \\ \hline
\multicolumn{1}{|l|}{\textbf{\begin{tabular}[c]{@{}l@{}}User\\ stationary\end{tabular}}} &
  \multicolumn{1}{l|}{N/A} &
  Clickjacking (\S\ref{sec:app_clickjacking}) \\ \hline
\end{tabular}
\caption{Summary of proof-of-concept end-to-end attacks}
\label{table:app_summary}
\end{table}


\begin{figure*}[h]
    % Left side with 2x3 subfigures
    \begin{minipage}{0.8\textwidth}
        \centering
        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_nosound_1.pdf}
            \caption{Benign, time=0}
            \label{subfig:car_nosound_frame1}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_nosound_2.pdf}
            \caption{Benign, time=1}
            \label{subfig:car_nosound_frame2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_nosound_3.pdf}
            \caption{Benign, time=2}
            \label{subfig:car_nosound_frame3}
        \end{subfigure}
        
        \vspace{0.5em} % Space between rows

        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_withsound_1.pdf}
            \caption{With sound, time=0}
            \label{subfig:car_withsound_frame1}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_withsound_2.pdf}
            \caption{With sound, time=1}
            \label{subfig:car_withsound_frame2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{figures/car_withsound_3.pdf}
            \caption{With sound, time=2}
            \label{subfig:car_withsound_frame3}
        \end{subfigure}
    \end{minipage}
    \hfill
    % Right side with one larger subfigure
    \begin{minipage}{0.15\textwidth}
        \centering
        \begin{subfigure}{\textwidth}
            \includegraphics[width=\linewidth]{figures/trace_forward.pdf}
            \vspace{-0.5cm}
            \caption{User's physical movements from time=0 to time=2.}
            \label{subfig:car_usertrace}
        \end{subfigure}
    \end{minipage}
    \caption{Manipulating user input attack. The top row shows the intended benign behavior of a virtual car driving forward, and the bottom row shows the effect of the acoustic attack: The car is unable to move from the starting point. 
    %The figures in the first row are 3 frames of the headset moving without the acoustic signal, and the figures in the second row are 3 frames of the headset moving with the acoustic signal.
    }
    \label{fig:car_game}
\end{figure*}



\subsubsection{Harm to User: Manipulating User Input}
\label{sec:app_vr_gaming}


\noindent \emph{\textbf{Attack motivation.}}
Gaming is a major driver of XR adoption, with 91 of the 100 most popular VR applications being games as of early 2023~\cite{nair2023unique}. In these XR games, players interact with virtual 3D objects (like cars or virtual avatars) in the virtual world using IMU sensors embedded in controllers or headsets. In this attack, we demonstrate how an attacker can manipulate a users input by injecting adversarial acoustic signals to cause unwanted effects in the game. %to spoof the IMU sensors in XR headsets. 

\noindent \emph{\textbf{Attack design.}} We implement this attack within a car racing game where the player controls the car's direction by moving their headset. The four directions (forward, backward, left, right) align with the players head movements, allowing the car to follow the users orientation. This interaction method is common in many AR/VR applications (\eg Google Earth VR) and games (\eg BeatSaber), where avatars or virtual vehicles move in sync with the users head movements.



\begin{figure*}[h]
    \centering
    \begin{tabular}{ccccc}
        % First row of subfigures
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_nosound_1.pdf}
            \caption{Benign, time=0}
            \label{subfig:keyboard_nosound_frame1}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_nosound_2.pdf}
            \caption{Benign, time=1}
            \label{subfig:keyboard_nosound_frame2}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_nosound_3.pdf}
            \caption{Benign, time=2}
            \label{subfig:keyboard_nosound_frame3}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_nosound_4.pdf}
            \caption{Benign, time=3}
            \label{subfig:keyboard_nosound_frame4}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_nosound_5.pdf}
            \caption{Benign, time=4}
            \label{subfig:keyboard_nosound_frame5}
        \end{subfigure} \\
        
        % Second row of subfigures
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_withsound_1.pdf}
            \caption{With sound, time=0}
            \label{subfig:keyboard_withsound_frame1}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_withsound_2.pdf}
            \caption{With sound, time=1}
            \label{subfig:keyboard_withsound_frame2}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_withsound_3.pdf}
            \caption{With sound, time=2}
            \label{subfig:keyboard_withsound_frame3}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_withsound_4.pdf}
            \caption{With sound, time=3}
            \label{subfig:keyboard_withsound_frame4}
        \end{subfigure} &
        \begin{subfigure}[b]{0.18\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/keyboard_withsound_5.pdf}
            \caption{With sound, time=4}
            \label{subfig:keyboard_withsound_frame5}
        \end{subfigure}
    \end{tabular}
    \caption{
    Clickjacking attack. In the benign case (top row), the keyboard remains mostly fixed in front of the user.
    In the attack case (bottom row), the keyboard drifts up and down, inhibiting the user from interacting with the desired keys.
    %Visualization of keyboard application. The figures in the first row are 3 frames of headset moving without acoustic signal, and the figures in the second row are 3 frames of headset moving with acoustic signal.
    }
    \label{fig:keyboard}
\end{figure*}


\noindent \emph{\textbf{Attack outcome.}} We place the headset on the remote-controlled car moving straight forward. According to the game design, the virtual car in the VR game should also move forward, aligned with the headsets movement. 
The top row of \Cref{fig:car_game} shows the game's normal behavior as visualized on the HoloLens 2, where the virtual car moves straight ahead from the initial starting point near the crosswalk.

During the attack, we place the HoloLens on the same remote control car and repeat the game, but this time we inject acoustic signals targeting the HoloLens' IMU sensors. As shown in \Cref{subfig:car_withsound_frame1} and \Cref{subfig:car_withsound_frame2}, the car initially moves forward but then shifts slightly to the left (leftward shift caused by a small deviation in the car's movement). Due to the \textbf{snapback} effect (detailed in Section~\ref{sec:snapback_effect}) caused by the acoustic interference, the cars position resets to zero, forcing it back to the starting point, as seen in  \Cref{subfig:car_withsound_frame3}.
In other words, we find that the car's position is fixed around the starting point when the acoustic signal is played, which destroys the functionality of the game for the victim user. 







\subsubsection{Harm to User: Clickjacking} 
\label{sec:app_clickjacking}


\noindent \emph{\textbf{Attack motivation.}} The goal of clickjacking attacks is to deceive the victim into thinking they are clicking on one object, while in reality, they are interacting with a baited object. In an XR game, an attacker might use clickjacking to trick the user into clicking on XR advertisements that generate extra revenue. For example, prior research has shown that clickjacking attacks can bait or hijack user interactions in XR environments~\cite{cheng2024user, lee2021adcube}. In this attack, we demonstrate a clickjacking attack in AR using adversarial acoustic signals.

\noindent \emph{\textbf{Attack design.}} The AR app is designed for users to enter text via a virtual keyboard, with the victim user interacting through her hand gestures (air tap~\cite{hololens-gestures-intro}) on the HoloLens 2. The virtual keyboard is developed using Microsofts Mixed Reality Toolkit (MRTK). In a benign scenario, the keyboard remains anchored to fixed coordinates in front of the user to ensure accurate typing. However, in this proof-of-concept attack, the attacker directs sound at the headset to shift the position of the keyboard. 
%\zijian{Do we wanna say ultrasonic here? current experiments does not apply ultrasonic sound, maybe mention in the later advanced part} 
The goal is to bait the victim into misclicking characters on the keyboard.
%JC: This could make a nice user study later. We have people type and count how well they are able to type. (if they can stand the sound!)



\noindent \emph{\textbf{Attack outcome.}} Without acoustic interference, the virtual keyboard remains stable in the same location across five consecutive frames, as shown in the top row of \Cref{fig:keyboard}. Regardless of the headset users movements, the virtual keyboard stays fixed.  However, after introducing acoustic sound directed at the headset, we observe that the keyboards position shifts. In the first two time instances (\Cref{subfig:keyboard_withsound_frame1} and \Cref{subfig:keyboard_withsound_frame2}), the keyboard drifts upward, with part of it moving out of the users field of view. However, because of the snapback effect, the keyboard then moves back down, returning to its original position in \Cref{subfig:keyboard_withsound_frame3} and \Cref{subfig:keyboard_withsound_frame4}. With continuous acoustic interference, the virtual keyboard shifts upward once more and disappears from the users field of view, as shown in \Cref{subfig:keyboard_withsound_frame5}. 

Thus with this continuous acoustic interference, the virtual keyboard oscillates up and down, complicating the users ability to accurately enter their intended input. In a more advanced attack scenario, the attacker could time the acoustic injection to coincide with the user entering sensitive information, such as passwords in a banking application. The exact timing of such injections could be precisely inferred through side channels~\cite{slocum2023going,zhang2023its}.
%leakages, such as IMU data~\cite{slocum2023going} and performance counters~\cite{zhang2023its}.

\begin{figure*}
    \centering
    \begin{tabular}{cccc}
        % First row of subfigures
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_nosound_1.pdf}
            \caption{Benign, time=0}
            \label{subfig:wall_nosound_frame1}
        \end{subfigure} &
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_nosound_2.pdf}
            \caption{Benign, time=1}
            \label{subfig:wall_nosound_frame2}
        \end{subfigure} &
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_nosound_3.pdf}
            \caption{Benign, time=2}
            \label{subfig:wall_nosound_frame3}
        \end{subfigure} &
        \begin{subfigure}[b]{0.24\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/trace_wall_benign.pdf}
            \caption{User's physical movements, benign case}
            \label{subfig:trace_wall_benign}
        \end{subfigure} \\
        
        % Second row of subfigures
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_withsound_1.pdf}
            \caption{With sound, time=0}
            \label{subfig:wall_withsound_frame1}
        \end{subfigure} &
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_withsound_2.pdf}
            \caption{With sound, time=1}
            \label{subfig:wall_withsound_frame2}
        \end{subfigure} &
        \begin{subfigure}[b]{0.22\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/wall_withsound_3.pdf}
            \caption{With sound, time=2}
            \label{subfig:wall_withsound_frame3}
        \end{subfigure} &
        \begin{subfigure}[b]{0.24\textwidth}
            \centering
            \includegraphics[width=\textwidth]{figures/trace_wall_attack.pdf}
            \caption{User's physical movements, With sound}
            \label{subfig:trace_wall_attack}
        \end{subfigure}
    \end{tabular}
    \caption{Denial of user interaction attack. 
    In the benign case (top row), the user is able to move pats the red blocking wall to interact with the brochure on the bulletin board.
    In the attack case (bottom row), the blocking wall prevents the user from clearly viewing or interacting with the brochure.
    %The figures in the first row are 3 frames of headset moving without acoustic signal, and the figures in the second row are 3 frames of headset moving with acoustic signal.
    In the user trajectory (d,h), the brown line is the content that the user wants to see, and the red line is the blocking wall.
   }
    \label{fig:wall}
\end{figure*}



\subsubsection{Harm to User: Denial of User Interaction Attack}
\label{sec:app_blocking_wall}


\noindent \emph{\textbf{Attack motivation.}} We introduce two variants of denial of user interaction attacks: \emph{denial-of-user-input} and \emph{visual blocking} attacks. \emph{Denial-of-user-input} attacks occur when an attacker blocks legitimate inputs, such as hand gestures or voice commands. Prior work~\cite{cheng2024user} demonstrates that an invisible ``cage'' can prevent a user from interacting with intended objects. \emph{Visual blocking} attacks arise when environmental factorslike poor lighting or occlusionsimpair object visibility~\cite{huang2024ar,xiu2024lobstar,lebeck2017securing}. In this attack, the attackers virtual object can collide with the victims, causing visual obstruction. Consequently, the victim cannot detect or interact with the intended object, as it is concealed by the attackers interference.

\noindent \emph{\textbf{Attack design.}} 
Normally, in best practice UI design for XR~\cite{laviola20173d}, the virtual objects should remain static with respect to the real world.
In this attack, we leverage the \textbf{snapback} effect by continuously playing an acoustic signal to shift a virtual blocking object (represented by the ``Blocking Wall'' in \Cref{fig:wall}) and prevent the victim from viewing/interacting with the intended target.
The blocking wall object is rendered using Unity's shader~\cite{unity_shader}, which allows two rendering options: opaque and transparent, which we use to implement our two attack variants. For the denial-of-user-input attack, we render the blocking wall with transparency. Setting the transparency to 100\% makes the blocking wall completely invisible while still obstructing the users hand interactions, thereby implementing the virtual ``cage''\cite{cheng2024user}. For the visual blocking attack, we can set the blocking wall to opaque to obstruct the victim's view of important objects in the scene.



\noindent \emph{\textbf{Attack outcome.}} In a benign scenario, the ``Blocking Wall'' remains in a fixed position with respect to the real world, as shown in the top row of \Cref{fig:wall}.
%\Cref{subfig:wall_nosound_frame1}. 
As the headset moves forward and passes the wall, the user can view and interact with the object behind it, as illustrated in \Cref{subfig:wall_nosound_frame2} and \Cref{subfig:wall_nosound_frame3}. 
However, when the attacker injects acoustic sound, the virtual begins to move with the headset due to the snapback effect. This causes the blocking wall to stay continually in front of the victim.
The attack outcome depends on the rendering option: (1) If a transparent shader is chosen, the victim encounters an invisible wall that blocks all user interactions (\eg controller and hand gestures) with the items on the bulletin board; (2) If an opaque shader is used, an opaque wall obstructs the victim's visual perception of the real world.
A semi-transparent wall is shown in the second row of \Cref{fig:wall} to illustrate both scenarios.




\begin{figure*}[h]
    % Left side with 2x4 subfigures
    \begin{minipage}{0.8\textwidth}
        \centering
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_nosound_1.pdf}
            \caption{Benign, time=0}
            \label{subfig:bomb_nosound_frame1}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_nosound_2.pdf}
            \caption{Benign, time=1}
            \label{subfig:bomb_nosound_frame2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_nosound_3.pdf}
            \caption{Benign, time=2}
            \label{subfig:bomb_nosound_frame3}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_nosound_4.pdf}
            \caption{Benign, time=3}
            \label{subfig:bomb_nosound_frame4}
        \end{subfigure}
        
        \vspace{0.5em} % Space between rows

        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_withsound_1.pdf}
            \caption{With sound, time=0}
            \label{subfig:bomb_withsound_frame1}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_withsound_2.pdf}
            \caption{With sound, time=1}
            \label{subfig:bomb_withsound_frame2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_withsound_3.pdf}
            \caption{With sound, time=2}
            \label{subfig:bomb_withsound_frame3}
        \end{subfigure}
        \hfill
        \begin{subfigure}{0.24\textwidth}
            \includegraphics[width=\linewidth]{figures/bomb_withsound_4.pdf}
            \caption{With sound, time=3}
            \label{subfig:bomb_withsound_frame4}
        \end{subfigure}
    \end{minipage}
    \hfill
    % Right side with one larger subfigure
    \begin{minipage}{0.19\textwidth}
        \centering
        \begin{subfigure}{\textwidth}
            \includegraphics[width=\linewidth]{figures/trace_bomb.pdf}
            \caption{User's physical movements}
            \label{subfig:bomb_usertrace}
        \end{subfigure}
    \end{minipage}
    \caption{Secure zone invasion attack. 
    In the benign case (top row), the virtual bomb remains outside of the private zone.
    In the attack case (bottom row), the virtual bomb is able to be placed inside the private zone.
    %The figures in the first row are 4 frames of headset moving without acoustic signal, and the figures in the second row are 4 frames of headset moving with acoustic signal. frame 1 is the starting point.
    }
    \label{fig:bomb}
\end{figure*}


\subsubsection{Benefit to User: Secure Zone Invasion}
\label{sec:app_secure_zone}


\noindent \emph{\textbf{Attack motivation.}} 
In a multi-user scenario, each user should control the AR content displayed within their designated physical space, especially in secure zones like private homes~\cite{ruth2019secure}. Users in separate physical spaces should adhere to such secure zone policies, resulting in unique views for each user. For instance, Alice may hide her private virtual content within her home, preventing Bob from viewing, interacting with, or manipulating those objects in her private space. Another example is AR e-souvenirs in a museum~\cite{kang2022tie}, 
%as presented by Kang et al.~\cite{kang2022tie}, 
where each museum visitor has a private space to view their souvenirs. If an adversary breaches the secure zone policy, they could disrupt the visitor's experience by introducing unrelated, frightening, or harmful objects into the victims private zone. 
In this attack, we aim to exploit the snapback effect from acoustic injection to disrupt the secure zone isolation policy. 
Note that the ``user'' here is the attacker who wears the headset to gain a benefit, rather than causing harm to a victim user.

\noindent \emph{\textbf{Attack design.}} In this AR game, we assume two users (victim and attacker) have their own private spaces where their own AR objects should be isolated inside their own spaces, as illustrated by the red box in \Cref{subfig:bomb_usertrace}.
Due to the secure zone (\eg Guardian Zone~\cite{guardian_zone_vr}), the attacker does not have permission to throw, view, or manipulate AR objects in the victim's private space. The attacker's goal is to break such isolation and place AR objects (\eg virtual bomb in \Cref{subfig:bomb_nosound_frame1}) inside the victim's space to scare or fool the victim. 
%\jiasi{how the victim will see the bomb, depends on how the multi-user host/resolve is implemented}

\noindent \emph{\textbf{Attack outcome.}} Without the acoustic attack, the virtual bomb object remains anchored at a fixed location within the attackers zone, as shown in \Cref{subfig:bomb_nosound_frame1} and \Cref{subfig:bomb_nosound_frame2}, positioned outside the door. \Cref{subfig:bomb_nosound_frame3} and \Cref{subfig:bomb_nosound_frame4} display the victim user's private space, where the attackers object is not present (as intended), even as the user moves towards the private space.
However, using the snapback effect induced by the acoustic attack, the adversary can transfer the unauthorized object (represented as a virtual bomb) into the victims private office, as shown in the second row of \Cref{fig:bomb}. \Cref{subfig:bomb_withsound_frame3} and \Cref{subfig:bomb_withsound_frame4} clearly illustrate that the virtual bomb has been brought inside the private office and placed on the victims table.
%JC: I didn't think through the multi-user scenario clearly before. How would a victim see the bomb? Only the attacker user would see it.


























%\subsubsection{Gyroscope}
%\begin{enumerate}
%\item Frequency sweep - 17.6 kHz - but no effect - Zijian DONE
%\item single tone experiment - Sophie
%\end{enumerate}



%\section{Quest 3}

% We use the same setup as with the Hololens2 for the Quest3 accelerometer and gyroscope

%\begin{enumerate}
%\item Setup verify - Sophie DONE (no observable effect)
%\item Gyroscope:
%\begin{enumerate}
%    \item sweep - Zijian DONE
%    \item single tone experiment (wait for results for next steps)
%\end{enumerate}
%\item Accelerometer:
%\begin{enumerate}
%    \item sweep - Zijian DONE (no observable effect)
%    \item single tone experiment (wait for results for next steps)
%    \item Different apps (Guardian Zone)
%\end{enumerate}
%\end{enumerate}

%\subsection{Other Effects (on Camera / Controllers)}
%\label{subsec:exp-other}
%\zijian{add if in page limit}
%As a side note, any other hardware on AR/VR devices with IMU sensors can be attacked by similar acoustic signals. The most common modules with IMU sensors are controllers and camera stablizers. 
