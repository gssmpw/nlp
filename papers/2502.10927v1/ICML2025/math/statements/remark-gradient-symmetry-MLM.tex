%
\begin{remark}
%
Let $\mathcal{C}_i = [0,1,\dots, N]$ and let the summation indexed by $i$ to run over a random subset of tokens $ M \subset [0,1,\dots, N]$.
%
The weight update of $\bm{W}_{qk}$ is then given by
%
\begin{equation}
    \Delta \bm{W}_{qk}^l = \sum_{i\in M} \sum_{j=1}^N \beta^l_{ij} \bm{K}^{l-1}_{ij} \,.
\end{equation}
%
The double summation contains $N|M|$ elements, where $|M|$ is the cardinality of the subset $M$. 
%
We can rewrite the double summation as follows,
%
\begin{equation}
\label{eq:factorization-summation}
\sum_{i \in M} \sum_{j =1}^N \beta^l_{ij} \bm{K}^{l-1}_{ij} =
\sum_{i \in M} \beta^l_{ii} \bm{K}^{l-1}_{ii} +
\sum_{\substack{i,j \in M \\ i < j}} (\beta^l_{ij} \bm{K}^{l-1}_{ij} + \beta^l_{ji} \bm{K}^{l-1}_{ji}) +
\sum_{i \in M} \sum_{\substack{j \in \bar{M}}} \beta^l_{ij} \bm{K}^{l-1}_{ij},
\end{equation}
%
where the first term includes the diagonal terms, the second includes the contributions of the pairs $(i,j)$ with $i,j \in M$, and the third includes the remaining terms with $\bar{M} = [1,\dots,N] \setminus M$.
%
The second term can be written as,
%
\begin{equation}
 \sum_{\substack{i,j \in M \\ i < j}} (\beta^l_{ij} \bm{K}^{l-1}_{ij} + \beta^l_{ji} \bm{K}^{l-1}_{ji}) = \sum_{\substack{i,j \in M \\ i < j}} (\beta^l_{ij} \bm{K}^{l-1}_{ij} + \beta^l_{ji} {\bm{K}^{l-1}_{ij}}^\top) \,, 
\end{equation}
%
and by decomposing $\bm{K}^{l-1}_{ij}$ in its symmetric and skew-symmetric parts, such that $\bm{K}^{l-1}_{ij} = \bm{S}^{l-1}_{ij} + \bm{N}^{l-1}_{ij}$, we obtain,
%
\begin{equation}
\begin{split}
    \sum_{\substack{i,j \in M \\ i < j}} (\beta^l_{ij} \bm{K}^{l-1}_{ij} + \beta^l_{ji} {\bm{K}^{l-1}_{ij}}^\top)
    & = \sum_{\substack{i,j \in M \\ i < j}} \big[ \beta_{ij}^l(\bm{S}^{l-1}_{ij} + \bm{N}^{l-1}_{ij}) + \beta_{ji}^l(\bm{S}^{l-1}_{ij} + \bm{N}^{l-1}_{ij})^T \big] \\
    & = \sum_{\substack{i,j \in M \\ i < j}} \big[(\beta^l_{ij} + \beta^l_{ji})\bm{S}^{l-1}_{ij} + (\beta^l_{ij} - \beta^l_{ji})\bm{N}^{l-1}_{ij}\big]\,,
\end{split}
\end{equation}
%
with a similar structure as in Equation \eqref{eq:gradients-symmetric-terms}.
%
\end{remark}