\documentclass[11pt,twocolumn]{article}
\setlength{\columnsep}{20pt} 

\usepackage[a4paper,bindingoffset=0.in,
            left=.8in,right=.8in,top=1in,bottom=1in,
            footskip=.25in]{geometry}
\usepackage{tikz-cd}
\usepackage{pifont} 
\usepackage{graphicx}

\usepackage{xcolor}
\definecolor{darkred}{rgb}{0.5,0.2,0.2}
\definecolor{darkblue}{rgb}{0.2,0.2,0.6}
\usepackage[hidelinks,colorlinks=true,linkcolor=darkred,citecolor=darkred,urlcolor=darkblue]{hyperref}
\usepackage{titlesec}
\titleformat{\section}[hang]{\bfseries\Large}{\thesection.}{0.3em}{} 
\titleformat{\subsection}[hang]{\bfseries\large}{\thesubsection.}{0.3em}{} 
\usepackage{gensymb}
\usepackage{textcomp}

% \usepackage{caption}
% \DeclareCaptionFormat{myformat}{#1#2#3\hrulefill}
% \captionsetup[figure]{format=myformat}
% \usepackage[labelfont=bf]{caption}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{dsfont}
\usepackage{txfonts} 
\usepackage[euler]{textgreek}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\let\bm\mathbf
\usepackage{enumitem}

\usepackage[capitalize,noabbrev]{cleveref}
\usepackage{booktabs}
\usepackage{natbib} 
\bibliographystyle{plainnat}
\usepackage{authblk}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

%%%%%%%%%%%%%%%%%%%%

\title{The underlying structures of self-attention: symmetry, directionality, and emergent dynamics in Transformer training}

\author[1,*]{Matteo Saponati}
\author[1,2,*]{Pascal Sager}
\author[1]{Pau Vilimelis Aceituno}
\author[1,2,3]{\\Thilo Stadelmann}
\author[1,4]{Benjamin Grewe}

\affil[1]{\small Institute of Neuroinformatics, ETH Zürich and University of Zürich, Zürich, Switzerland}
\affil[2]{\small Centre for Artificial Intelligence, Zürich University of Applied Sciences, Winterthur, Switzerland}
\affil[3]{\small ECLT European Centre for Living Technology, Venice, Italy}
\affil[4]{\small ETH AI Center, Zürich, Switzerland}
\affil[*]{\small equal contribution}
\date{}

%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle
\begin{abstract}
    \normalsize \input{ICML2025/sections/abstract}
\end{abstract}

\section{Introduction}
%
\blfootnote{Correspondence: \href{mailto:masapo@ini.ethz.ch}{masapo@ini.ethz.ch}, \href{mailto:bgrewe@ethz.ch}{bgrewe@ethz.ch}}
%
\label{sec-introduction}
\input{ICML2025/sections/introduction}

\section{Autoregressive and bidirectional training leads to directional and symmetric weight updates}
\label{sec-results-math}
\input{ICML2025/sections/results-math}
%


\section{Symmetric and directional structures are predominant in Transformer models}
\label{sec-results-pretrained-models}
\input{ICML2025/figures/figure-pretrained-models-language}
\input{ICML2025/sections/results-pretrained-models}
%

\section{Experiments}
\label{sec–results–experiments}
\input{ICML2025/sections/results-experiments}

\section{Related work}
\label{sec-related-work}
\input{ICML2025/sections/realted-work}

\section{Discussion}
\label{sec–discussion}
\input{ICML2025/sections/discussion}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Acknowledgments}
%
MS was supported by an ETH Postdoctoral fellowship (reference nr. 23-2 FEL-042). 
%
PVA was supported by a UZH Postdoctoral fellowship (reference nr. K-76207-01-01).
%
TS and PS were supported by DIZH Fellowship ``Stability of self-organizing net fragments as inductive bias for next-generation deep learning'' from the ZHAW.
%
We thank the Grewe lab, Alexander Nedergaard, Thomas Hofmann, and the Data Analytics lab for their helpful comments and insightful discussions.\\
%
\subsection*{Authorship contributions}
%
Conceptualization: MS, TS, BG. 
%
Mathematical analysis: MS, PVA. 
%
Analysis of pre-trained models: MS, PS.
%
Experiments: PS. 
%
Writing: MS, PS, BG. 
%
Supervision: TS, BG. 
%

\subsection*{Code availability}
%
The code to reproduce our results and all the Figures in the main text and Supplementary Materials is freely available at \href{https://github.com/matteosaponati/attention-geometry}{github.com/matteosaponati/attention-geometry}.
%
%
\subsection*{Declaration of Interests}
%
The authors declare no competing interests.

\bibliography{ICML2025/bib}


\newpage 

\setcounter{section}{0}
\setcounter{subsection}{0}
\setcounter{equation}{0}
\setcounter{figure}{0}
\setcounter{table}{0}
\setcounter{footnote}{0}

\makeatletter
\renewcommand{\thesection}{S\arabic{section}}
\renewcommand{\thesubsection}{S\arabic{section}.\arabic{subsection}}
\renewcommand{\theequation}{S\arabic{equation}}
\renewcommand{\thefigure}{S\arabic{figure}}
\renewcommand{\thetable}{S\arabic{table}}

% Fix hyperlinks so that section "S2" links to the correct place
\renewcommand{\theHsection}{S\arabic{section}}
\renewcommand{\theHsubsection}{S\arabic{section}.\arabic{subsection}}

\makeatother
\onecolumn


\section{Mathematical proofs}
\label{sec-proof-statements}
\input{ICML2025/supplementary/math-proofs}

\section{Experimental Details}
\label{sec-experimental-details}
\input{ICML2025/supplementary/experimental-details}

\section{Supplementary Figures}
\label{sec-supp-figures}
\input{ICML2025/supplementary/supplementary-figures}

\section{Supplementary Tables}
\label{sec-supp-tables}
\input{ICML2025/supplementary/supplementary-tables}




\end{document}