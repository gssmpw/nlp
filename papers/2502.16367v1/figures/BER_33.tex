% This file was created by matlab2tikz v0.4.7 running on MATLAB 8.3.
% Copyright (c) 2008--2014, Nico Schl√∂mer <nico.schloemer@gmail.com>
% All rights reserved.
% Minimal pgfplots version: 1.3
% 
% The latest updates can be retrieved from
%   http://www.mathworks.com/matlabcentral/fileexchange/22022-matlab2tikz
% where you can also make suggestions and rate matlab2tikz.
% 
%
% defining custom colors
\definecolor{mycolor1}{rgb}{0.00000,1.00000,1.00000}%
\definecolor{mycolor2}{rgb}{1.00000,0.00000,1.00000}%
\definecolor{mycolor3}{rgb}{0.83,0.69,0.22}%
%

\pgfplotsset{every axis label/.append style={font=\scriptsize
},
every tick label/.append style={font=\scriptsize
}
}




\begin{tikzpicture}[font=\scriptsize
] 
\begin{axis}[%
name=IF1,
%width=0.85\columnwidth,%5.63489583333333in,
width=0.8\columnwidth,
height=0.6\columnwidth,%4.16838541666667in,
scale only axis,
ymode=log,
xmin=0.1,
xmax=3.5,
xlabel={$\gamma$},
xmajorgrids,
ymin=0.0001,
ymax=1,
ylabel={BER},
ymajorgrids,
legend entries={Analytical BER upper bound,  Numerical BER},
legend style={at={(1,1)},anchor=north east,draw=black,fill=white,legend cell align=left,font=\tiny}
]

%% Add a (b) below x-axis
%\pgfplotsset{
%    every axis/.append style={
%        extra description/.code={
%            \node at (0.5,-0.25) {(a)};
%        },
%    },
%}

%thick
\addlegendimage{smooth,color=green,solid, line width=1.1pt, mark=star,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}}
\addlegendimage{smooth,color=red, solid, line width=1.1pt, every mark/.append style={solid, fill=red!50}, mark=square*,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}}


%\addlegendimage{no markers}
%\addlegendimage{no markers,color=blue}
%\addlegendimage{no markers,color=red}
%\addlegendimage{no markers,color=black}




%\node [draw,fill=white,font=\tiny,anchor= %north east] at (axis cs: 20, 0.5 ) { %$M_{\text{Tx}} = M_{\text{Rx}}= 2$ };
%borrar

%  0.1	0.830594410875438\\
%0.2	0.784309082744384\\
%0.3	0.733119364270609\\
%0.4	0.67829479349396\\
%0.5	0.621347562543179\\
%0.6	0.563497424627338\\
%0.7	0.506015571178479\\
%0.8	0.449877142337167\\
%0.9	0.396094295268169\\
%1	0.345327539806263\\
%1.1	0.29818357870922\\
%1.2	0.254999162920816\\
%1.3	0.216015104681713\\
%1.4	0.181239262779404\\
%1.5	0.150660007371108\\
%1.6	0.124039368510162\\
%1.7	0.101174148805985\\
%1.8	0.0817352935896231\\
%1.9	0.0654403069459961\\
%2	0.051871269641007\\
%2.1	0.0407561725448982\\
%2.2	0.0317104336000321\\
%2.3	0.0244072957514507\\
%2.4	0.0186349094755488\\
%2.5	0.0140975719078485\\
%2.6	0.0105517378287425\\
%2.7	0.0078440994812039\\
%2.8	0.00574537573550493\\
%2.9	0.00418487443560156\\
%3	0.00300110287421762\\
%3.1	0.00214090391832711\\
%3.2	0.00152573745607176\\
%3.3	0.00107025975381825\\
%3.4	0.000747234857360946\\
%3.5	0.000520585658641437\\
%3.6	0.00034759829368558\\
%3.7	0.000240938406534941\\
%3.8	0.00014826814373281\\
%3.9	0.000104041121012255\\
%4	6.65939377884062e-05\\
%  }
%analytical 
\addplot+[smooth,color=green,solid, thick, every mark/.append style={solid, fill=gray!20} ,mark=star, mark repeat=1,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}]
  table[row sep=crcr]{%
0.1	0.418595238489876\\
0.2	0.396776388452489\\
0.3	0.37252985619834\\
0.4	0.346426031712528\\
0.5	0.319061145709539\\
0.6	0.291023656035533\\
0.7	0.262878956860552\\
0.8	0.235144200156846\\
0.9	0.208286215199781\\
1	0.182695149437383\\
1.1	0.158684141442307\\
1.2	0.136484220174504\\
1.3	0.116253878326564\\
1.4	0.098057082815702\\
1.5	0.0819092292647692\\
1.6	0.0677591664286339\\
1.7	0.0555055076688788\\
1.8	0.0450355953297655\\
1.9	0.0361825664947906\\
2	0.0287918166866344\\
2.1	0.022689206039073\\
2.2	0.0177061139653135\\
2.3	0.0136883355893207\\
2.4	0.0104748522459755\\
2.5	0.00793884136472245\\
2.6	0.00596051998548675\\
2.7	0.00443061187488036\\
2.8	0.00326316448913516\\
2.9	0.00237732981806693\\
3	0.00171741649373119\\
3.1	0.00122816082556731\\
3.2	0.000869307136658282\\
3.3	0.000610007821490344\\
3.4	0.00042337129076947\\
3.5	0.000290575229516477\\
3.6	0.000197573704699416\\
3.7	0.000133687269696037\\
3.8	8.8786093022819e-05\\
3.9	5.84775379175451e-05\\
4	3.8319096470063e-05\\
};



%numerical MRx =3
\addplot+[smooth,color=red,solid, thick, every mark/.append style={solid, fill=red!20} ,mark=square*, mark repeat=1,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}]
  table[row sep=crcr]{%
0.1	0.491075\\
0.6	0.30055\\
1.1	0.13775\\
1.6	0.0556\\
2.1	0.0173\\
2.6	0.00435\\
3.1	0.001075\\
3.6	0.000175\\
};



%\addplot[smooth,color=green,solid, line width=1.1pt, %mark=none]
%  table[row sep=crcr]{%
%	50 2\\
%};\label{MC_MTX1}

\addplot[smooth,color=green, solid, line width=0.75pt, mark=none,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}]
  table[row sep=crcr]{%
	1 50\\
};\label{MC_MTX1}




\addplot[smooth,color=red, solid, line width=0.75pt, mark=none,
y filter/.code={\pgfmathparse{\pgfmathresult-0}\pgfmathresult}]
  table[row sep=crcr]{%
	1 50\\
};\label{MC_MTX2}



%\node [draw,fill=white,font=\tiny,anchor= south west] %at (axis cs: -10, 0.1 ) {
%\setlength{\tabcolsep}{0.5mm}
%\renewcommand{\arraystretch}{.8}
%\begin{tabular}{l l}
%\ref{MC_MTX1}{$\; M_{\text{Rx}} =2$} \\
%\ref{MC_MTX2}{$\; M_{\text{Rx}} =3$} \\
%\ref{P5_Zz}{ MMSE ACE iter $i_{\text{max}}=20$} \\
%\ref{P0_Zz}{ Optimal MMSE ACE QP \cite{LarsonB_2017} } \\
%\ref{P1_Zz}{ joint MMDDT } \\
%\ref{P4_Zz}{ MMSE} \\
%\end{tabular}
%};


\end{axis}



\end{tikzpicture}%