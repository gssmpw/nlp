%Version 3 December 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove Numbered in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst%  
 
%%\documentclass[pdflatex,sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
\documentclass[pdflatex,sn-mathphys-num]{sn-jnl}% Math and Physical Sciences Numbered Reference Style 
%%\documentclass[pdflatex,sn-mathphys-ay]{sn-jnl}% Math and Physical Sciences Author Year Reference Style
%%\documentclass[pdflatex,sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[pdflatex,sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[pdflatex,sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[pdflatex,sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style

%%%% Standard Packages
%%<additional latex packages if required can be included here>

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%
\usepackage{makecell}
\usepackage{float}

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}
\title[SurGrID]{SurGrID: Controllable \textit{Sur}gical Simulation via Scene \textit{Gr}aph to \textit{I}mage \textit{D}iffusion}

%%=============================================================%%
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% \author*[1,2]{\fnm{Joergen W.} \spfx{van der} \sur{Ploeg} 
%%  \sfx{IV}}\email{iauthor@gmail.com}
%%=============================================================%%

\author*[1]{\fnm{Yannik} \sur{Frisch}}\email{yannik.frisch@gris.tu-darmstadt.de}
\equalcont{These authors contributed equally to this work.}
\author*[1]{\fnm{Ssharvien} \sur{Kumar Sivakumar}}\email{ssharvien.kumar.sivakumar@gris.tu-darmstadt.de}
\equalcont{These authors contributed equally to this work.}
\author[2]{\fnm{\c{C}a\u{g}han} \sur{Köksal}}
\author[4]{\fnm{Elsa} \sur{Böhm}}
\author[4]{\fnm{Felix} \sur{Wagner}}
\author[4]{\fnm{Adrian} \sur{Gericke}}
\author[3]{\fnm{Ghazal} \sur{Ghazaei}}
\author[1]{\fnm{Anirban} \sur{Mukhopadhyay}}

\affil*[1]{\orgname{TU Darmstadt}, \orgaddress{\street{Fraunhoferstr. 5}, \city{Darmstadt}, \postcode{64297}, \country{Germany}}}
\affil[2]{\orgname{TU Munich}, \orgaddress{\street{Arcisstr. 21}, \city{Munich}, \postcode{80333}, \country{Germany}}}
\affil[3]{\orgname{Carl Zeiss AG}, \orgaddress{\street{Kistlerhofstr. 75}, \city{Munich}, \postcode{81379}, \country{Germany}}}
\affil[4]{\orgname{Universitätsmedizin Mainz}, \orgaddress{\street{Langenbeckstr. 1}, \city{Mainz}, \postcode{55131}, \country{Germany}}}

%\affil*[1]{\orgdiv{GRIS}, \orgname{TU Darmstadt}, \orgaddress{\street{Fraunhoferstr. 5}, \city{Darmstadt}, \postcode{64297}, \state{Hesse}, \country{Germany}}}
%\affil[2]{\orgdiv{Department}, \orgname{TU Munich}, \orgaddress{\street{Arcisstr. 21}, \city{Munich}, \postcode{80333}, \state{Bavaria}, \country{Germany}}}
%\affil[3]{\orgdiv{Department}, \orgname{Carl Zeiss AG}, \orgaddress{\street{Street}, \city{Munich}, \postcode{Postcode}, \state{Bavaria}, \country{Germany}}}
%\affil[4]{\orgdiv{Augenklinik}, \orgname{Universitätsmedizin Mainz}, \orgaddress{\street{Langenbeckstr. 1}, \city{Mainz}, \postcode{55131}, \state{Rhineland Palatinate}, \country{Germany}}}
%%\affil[3]{\orgdiv{Department}, \orgname{Organization}, \orgaddress{\street{Street}, \city{City}, \postcode{610101}, \state{State}, \country{Country}}}


\abstract{
\textbf{Purpose:} Surgical simulation offers a promising addition to conventional surgical training. However, available simulation tools lack photorealism and rely on hard-coded behaviour. Denoising Diffusion Models are a promising alternative for high-fidelity image synthesis, but existing state-of-the-art conditioning methods fall short in providing precise control or interactivity over the generated scenes.

% The scene graph is repeated twice
% Need to say why scene graphs are more interactable
\textbf{Methods:} We introduce SurGrID, a Scene Graph to Image Diffusion Model, allowing for controllable surgical scene synthesis by leveraging Scene Graphs. These graphs encode a surgical scene's components' spatial and semantic information, which are then translated into an intermediate representation using our novel pre-training step that explicitly captures local and global information.

% When seeing the abstract as a standalone, we are comparing other surgical simulation methods, and not comparing to sg2im methods  
\textbf{Results:} Our proposed method improves the fidelity of generated images and their coherence with the graph input over the state-of-the-art. Further, we demonstrate the simulation's realism and controllability in a user assessment study involving clinical experts.

\textbf{Conclusion:} Scene Graphs can be effectively used for precise and interactive conditioning of Denoising Diffusion Models for simulating surgical scenes, enabling high fidelity and interactive control over the generated content. 
}

%Additionally, our pre-training step also enhances the overall image quality, bringing us closer to photorealistic surgical simulation. 
%So surgical simulation can reduce the learning curve and better prepare trainee surgeons.
%Surgical simulation offers a promising benefit when worked together with the conventional Halstedian apprenticeship model, because alone it is linked to increased complication. So surgical simulation can reduce the learning curve and better prepare trainee surgeons. 
% The test retest -> talk about it because it is proof that we can produce the gain extreme control over the generation that the synthesised images look similar to original except a for different eye type. 
% Nice sentence from 2406.06537: hold much promise for benefiting surgical training by providing photorealism to simulation environments
% Nice sentence from 2406.06537: However, current computer-based simulations have lots of drawbacks, such as unrealistic visual appearance, lacking variability, and complex creation procedures taking into account the varying anatomical properties, all of which lead to diminishing the quality of surgical training


\keywords{Controllable Surgical Simulation, Scene Graph, Denoising Diffusion Models}

%%\pacs[JEL Classification]{D8, H51}
%%\pacs[MSC Classification]{35A01, 65L10, 65L12, 65L20, 65L70}

\maketitle

\input{revision_sections/introduction}
\input{revision_sections/related_work}
\input{revision_sections/method}
\input{revision_sections/experiments}
\input{revision_sections/conclusions}

\backmatter



\bmhead{Supplementary information}

The supplementary information comprises the Appendix of the main manuscript.

\section*{Declarations}

\textbf{Funding.} This work has been partially funded by the German Federal Ministry of Education and Research as part of the Software Campus programme (project 500 01 528). 
\\
\textbf{Data Availability.} All experiments were conducted on publicly available datasets.
\\
\textbf{Code Availability.} Code will be published upon acceptance.
\\
Other declarations are not applicable.

\noindent

\bibliography{sn-bibliography}
%%\input sn-article.bbl

\newpage
\begin{appendices}

\input{revision_sections/appendix}

\end{appendices}

\end{document}
