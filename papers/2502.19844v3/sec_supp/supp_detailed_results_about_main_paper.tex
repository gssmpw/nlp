
\newpage

\section{Detailed Results of More Benefits by Optimal Prompts}
\label{sec_supp: detailed_results_of_main_paper}

% ---------------------------------------------------- % 
%               迁移到 Adapter 方法的结果
% ---------------------------------------------------- %
\subsection{Transfer to Adapter-based Methods}
\label{sec_supp: transfer_to_adapter}
In~\cref{supp_fig: improve_train_free_adapter} and ~\cref{supp_fig: improve_train_adapter}, we show the detailed results of popular training-free and training adapter-based methods~\cite{Tip, Tip-X, APE, CLIP_Adapter} with different prompt initialization, \textit{i.e.}, SOTA method CuPL~\cite{CuPL} and our ProAPO. Adapter-based methods with ProAPO (solid lines) consistently surpass those with CuPL (dotted lines). It reveals that high-quality prompts make adapters perform better. Even in low shots, training with ProAPO achieves notable performance gains, which further verifies its effectiveness. 


{
\begin{figure*}[ht]
\centering
\begin{adjustbox}{minipage=\textwidth,scale=0.88}
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_ImageNet.pdf}
    \caption{ImageNet.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_Caltech-101.pdf}
    \caption{Caltech.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_StanfordCars.pdf}
    \caption{Cars.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}
% \vspace{-5pt}
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_DTD.pdf}
    \caption{DTD.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_FGVC.pdf}
    \caption{FGVC.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_EuroSAT.pdf}
    \caption{ESAT.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}

\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_Flowers102.pdf}
    \caption{FLO.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_Food101.pdf}
    \caption{Food.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_OxfordPets.pdf}
    \caption{Pets.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}

\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_SUN397.pdf}
    \caption{SUN.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
% \hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training-free_Results_on_UCF101.pdf}
    \caption{UCF.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\end{adjustbox}
\caption{\textbf{Results of training-free adapter-based methods with different initial prompts.} Solid and dotted lines denote prompt initialization with ProAPO and CuPL, respectively. We see that our ProAPO consistently improves adapter-based methods.}
\label{supp_fig: improve_train_free_adapter}
\vspace{60pt}
\end{figure*}
}


{
\begin{figure*}[ht]
\centering
\begin{adjustbox}{minipage=\textwidth,scale=0.88}
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_ImageNet.pdf}
    \caption{ImageNet.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_Caltech-101.pdf}
    \caption{Caltech.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_StanfordCars.pdf}
    \caption{Cars.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}
% \vspace{-5pt}
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_DTD.pdf}
    \caption{DTD.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_FGVC.pdf}
    \caption{FGVC.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_EuroSAT.pdf}
    \caption{ESAT.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}

\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_Flowers102.pdf}
    \caption{FLO.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_Food101.pdf}
    \caption{Food.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_OxfordPets.pdf}
    \caption{Pets.}
    % \label{fig:third}
    % \vspace{-10pt}
\end{subfigure}

\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_SUN397.pdf}
    \caption{SUN.}
    % \label{fig:first}
    % \vspace{-10pt}
\end{subfigure}
% \hfill
\begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{Paper_Result_supp/transfer_adapter/Training_Results_on_UCF101.pdf}
    \caption{UCF.}
    % \label{fig:second}
    % \vspace{-10pt}
\end{subfigure}
\end{adjustbox}
\caption{\textbf{Results of training adapter-based methods with different initial prompts.} Solid and dotted lines denote prompt initialization with ProAPO and CuPL, respectively. We see that our ProAPO consistently improves adapter-based methods.}
\label{supp_fig: improve_train_adapter}
\vspace{60pt}
\end{figure*}
}


% ---------------------------------------------------- % 
%               迁移到不同 backbones 的结果
% ---------------------------------------------------- %
\subsection{Transfer to Different Backbones}
\label{sec_supp: transfer_to_backbones}

In~\cref{supp_fig: transfer_backbones}, we show detailed results of transferring prompts from source to target models in thirteen datasets. Our optimized prompts of ResNet50 and ViT-B/32 are reported.
We see that ProAPO achieves stable performance gains compared to CuPL~\cite{CuPL}, which verifies that ProAPO transfers easily across different backbones.




{
\begin{figure*}[htbp]
\centering
% \resizebox{0.9\linewidth}{!}
{
    \hfill
    \subfloat[ImageNet]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_imagenet.pdf}}
    \hfill
    \subfloat[Caltech]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_caltech101.pdf}}
    \hfill
    \subfloat[Cars]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_stanford_cars.pdf}}
    \hfill
    % \vspace{0.5em}
    \subfloat[CUB]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_cub.pdf}}
    \hfill
    \subfloat[DTD]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_dtd.pdf}}
    \hfill
    \subfloat[FGVC]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_fgvc_aircraft.pdf}}
    \hfill
    % \vspace{0.5em}
    \subfloat[ESAT]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_euro_sat.pdf}}
    \hfill
    \subfloat[FLO]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_flo.pdf}}
    \hfill
    \subfloat[Food]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_food101.pdf}}
    \hfill
    % \vspace{0.5em}
    \subfloat[Pets]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_oxford_pets.pdf}}
    \hfill
    \subfloat[Places]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_places365.pdf}}
    \hfill
    \subfloat[SUN]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_sun397.pdf}}
    \hfill
    % \vspace{0.5em}
    \subfloat[UCF]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_ucf101.pdf}}
    % \hfill
    \subfloat[Avg (11)]{\includegraphics[width=0.32\textwidth]{Paper_Result_supp/transfer_backbones/transfer_to_backbones_avg11.pdf}}
    % \hfill
}
\vspace{-7pt}
\caption{\textbf{Results of prompt transfer to different backbones.} The value denotes performance gains compared to vanilla VLMs. Our optimized prompts of ResNet50 and ViT-B/32 are reported. We see that we achieve stable performance gains compared to CuPL~\cite{CuPL}. 
}
% \Description{}
\label{supp_fig: transfer_backbones}
\vspace{-5pt}
\end{figure*}
}



% ---------------------------------------------------- % 
%               性能提升分析的详细实验
% ---------------------------------------------------- %
% \newpage
\section{Detailed Results of Performance Improvement Analysis}

% ---------------------------------------------------- % 
%               Single VS Ensemble Prompts
% ---------------------------------------------------- %

{
\renewcommand{\arraystretch}{1.1} 
\begin{table*}[htbp]
  \centering
  \resizebox{0.75\linewidth}{!}
    {
    \begin{tabular}
        {l |  ccccc ccccc c | c }
        \toprule
        \textbf{Module} (ResNet50) & \rotatebox{90}{\textbf{IN-1K}} & \rotatebox{90}{\textbf{Caltech}} & \rotatebox{90}{\textbf{Cars}}  & \rotatebox{90}{\textbf{DTD}}  & \rotatebox{90}{\textbf{ESAT}} & \rotatebox{90}{\textbf{FGVC}} & \rotatebox{90}{\textbf{FLO}} & \rotatebox{90}{\textbf{Food}}  &  \rotatebox{90}{\textbf{Pets}}  & \rotatebox{90}{\textbf{SUN}} & \rotatebox{90}{\textbf{UCF}} & \rotatebox{90}{\textbf{Avg (11)}}  \\
        \midrule

        CLIP (a photo of a \{\})  & 57.9 & 84.5 & 53.9 & 38.8 & 28.6 & 15.9 & 60.2 & 74.0 & 83.2 & 58.0 & 56.9 & 55.6 \\ 

        \midrule
        \multicolumn{13}{c}{\textit{\textbf{\ccol{Single Prompt}}}} \\
        \midrule
        
        PN~\cite{P_N} & {59.6} & 89.1 & 56.2  & 44.8 & \underline{49.0} & 18.1 & 67.2 & {78.3} & 88.1  & 61.0 & 60.2 & 61.1 \\
        
        Best Single* & 60.2 & \underline{89.2} & \underline{57.9}  & 45.0 & 46.0 & \underline{18.3} & \underline{68.1} & \underline{81.8} & 88.3 & 61.5 & 62.6 & 61.7 \\

        \midrule
        \multicolumn{13}{c}{\textit{\textbf{\ccol{Ensemble Prompt}}}} \\
        \midrule 
        
        \highlight{\textbf{ATO} (ours)} & \highlight{\underline{61.3}} & \highlight{\underline{89.2}} & \highlight{\underline{57.9}} & \highlight{\underline{45.4}} & \highlight{44.7} & \highlight{18.2} & \highlight{\underline{68.1}} & \highlight{\underline{81.8}} & \highlight{\underline{88.5}} & \highlight{\underline{61.8}} & \highlight{\underline{63.9}} & \highlight{\underline{61.9}}  \\
        
        Best Ensemble* & \textbf{61.5} & \textbf{90.0} & \textbf{58.4}  & \textbf{47.0} & \textbf{49.1} & \textbf{18.7} & \textbf{69.9} & \textbf{82.2} & \textbf{89.4} & \textbf{62.1} & \textbf{64.8} & \textbf{63.0}  \\

        % \midrule
        
        \bottomrule
    \end{tabular}
}
  \vspace{-6pt}
  \caption{\textbf{Analysis of the effect of single vs ensemble prompts.} * denotes results evaluated in the test set. ATO is our automatic template optimization algorithm. We see that our optimized templates achieve higher results than PN~\cite{P_N}, even better than the best single template.}
  \vspace{-6pt}
  \label{supp_tab: ensemble_vs_single}
\end{table*}
}



\subsection{Analysis of the Effect of Single VS Ensemble Prompts}
\label{supp_sec: ensemble_vs_single}
In~\cref{supp_tab: ensemble_vs_single}, we show detailed results of the effect of single vs ensemble prompts. Compared to PN~\cite{P_N}, we utilize prompt ensembling instead of a single prompt to optimize the template and description. We observe that ensemble templates have a higher upper bound than the single template. Similarly, our optimized templates achieve higher performance than PN~\cite{P_N}, even better than the best single template, further verifying the effectiveness of our method.


% ---------------------------------------------------- % 
%               提升 Description 方法的性能
% ---------------------------------------------------- %
\subsection{Performance Improvement of Description Methods by ProAPO}
\label{sec_supp: improve_description_methods}
In~\cref{tab:description_add_APO}, we show detailed results of description methods~\cite{DCLIP, CuPL, GPT4Vis, AdaptCLIP} with our ATO and ProAPO. We see a notable improvement in description methods by at least 2.7\% average in thirteen datasets. It further verifies the effectiveness of our progressive optimization. 

{
\renewcommand{\arraystretch}{1.1} 
% \setlength{\tabcolsep}{4pt}

\begin{table*}[tbp]
  \centering
  \resizebox{0.99\linewidth}{!}
    {
    \begin{tabular}
        {l | lllll lllll lll | l | l}

            
        \toprule
        \textbf{Module} (ViT-B/32) & \rotatebox{90}{\textbf{IN-1K}} & \rotatebox{90}{\textbf{Caltech}} & \rotatebox{90}{\textbf{Cars}} & \rotatebox{90}{\textbf{CUB}} & \rotatebox{90}{\textbf{DTD}}  & \rotatebox{90}{\textbf{ESAT}} & \rotatebox{90}{\textbf{FGVC}} & \rotatebox{90}{\textbf{FLO}} & \rotatebox{90}{\textbf{Food}}  &  \rotatebox{90}{\textbf{Pets}} & \rotatebox{90}{\textbf{Places}} & \rotatebox{90}{\textbf{SUN}} & \rotatebox{90}{\textbf{UCF}} & \rotatebox{90}{\textbf{Avg (11)}} & \rotatebox{90}{\textbf{Avg (13)}} \\
        \midrule

        % \multicolumn{16}{c}{\textit{\textbf{\ccol{ViT-B/32 Backbone}}}} \\
        % \midrule

        Vanilla CLIP & 62.1  & 91.2  & 60.4  & 51.7 & 42.9  & 43.9  & 20.2  & 66.0  & 83.2  & 86.8 & 39.9 & 62.1  & 60.9 & 61.8 & 59.3 \\ 
        
        \midrule
        DCLIP~\cite{DCLIP} & 63.3  & 92.7  & 59.4  & 52.7  & 44.1  & 38.4  & 19.4  & 66.1  & 83.9  & 88.1  & 41.2  & 65.0  & 65.8  & 62.4  & 60.0 \\
        + \textbf{ATO} & 63.8& 93.0& 60.3& 52.5& 46.5& 54.1& 21.8& 68.9& 84.0& 88.4& 41.5& 65.4& 66.0 & 64.7 & 62.0 \\
        + \textbf{ProAPO} & \textbf{64.1} & \textbf{93.2} & \textbf{60.6} & \textbf{53.6} & \textbf{48.2} & \textbf{59.4} & \textbf{22.6} & \textbf{71.5} & \textbf{84.2} & \textbf{88.7} & \textbf{42.7} & \textbf{66.0} & \textbf{68.0} & \textbf{66.0}  & \textbf{63.3}  \\
        $\Delta$ & \textcolor{retained}{+ 0.8} & \textcolor{retained}{+ 0.5} & \textcolor{retained}{+ 1.2} & \textcolor{retained}{+ 0.9} & \textcolor{retained}{+ 4.1} & \textcolor{retained}{+ 21.0} & \textcolor{retained}{+ 3.2} & \textcolor{retained}{+ 5.4} & \textcolor{retained}{+ 0.3} & \textcolor{retained}{+ 0.6} & \textcolor{retained}{+ 1.5} & \textcolor{retained}{+ 1.0} & \textcolor{retained}{+ 2.2} & \textcolor{retained}{+ 3.6} & \textcolor{retained}{+ 3.3} \\

        \midrule
        
        CuPL-base~\cite{CuPL} & 64.0  & 92.3  & 60.1  & 54.3  & 47.2  & 42.4  & 21.7  & 68.7  & 84.3  & 88.8  & 42.0  & \textbf{66.2}  & 66.7  & 63.8  & 61.4 \\
        + \textbf{ATO} & 64.2 & 93.3 & 60.9 & 54.8 & 47.8 & 53.1 & 22.2  & 70.4  & 84.9 & 89.2  & 42.3 & 65.5 & 67.4 & 65.3 & 62.8 \\
        + \textbf{ProAPO} & \textbf{64.4} & \textbf{94.2} & \textbf{61.8} & \textbf{55.9} & \textbf{48.1} & \textbf{62.1} & \textbf{23.2} & \textbf{74.4} & \textbf{85.4} & \textbf{91.0} & \textbf{42.7} & 65.6 & \textbf{68.6} & \textbf{67.2}  & \textbf{64.4} \\
        $\Delta$ & \textcolor{retained}{+ 0.4} & \textcolor{retained}{+ 1.9} & \textcolor{retained}{+ 1.7} & \textcolor{retained}{+ 1.6} & \textcolor{retained}{+ 0.9} & \textcolor{retained}{+ 19.7} & \textcolor{retained}{+ 1.5} & \textcolor{retained}{+ 5.7} & \textcolor{retained}{+ 1.1} & \textcolor{retained}{+ 2.2} & \textcolor{retained}{+ 0.7} & -0.6 & \textcolor{retained}{+ 1.9} & \textcolor{retained}{+ 3.4} & \textcolor{retained}{+ 3.0} \\

        \midrule
        CuPL-full~\cite{CuPL} & 64.4  & 92.9  & 60.7  & 53.3  & 50.6  & 50.5  & 20.9  & 69.5  & 84.2  & 87.0  & 43.1  & 66.3  & 66.4  & 64.9  & 62.3 \\
        + \textbf{ATO} & 64.5 & 93.7 & 61.0 & 54.0 & 52.0 & 58.7 & 22.1 & 70.5 & 84.6 & 89.2 & 43.2 & 66.4 & 67.5 & 66.4 &  63.6 \\
        + \textbf{ProAPO} &  \textbf{64.7} & \textbf{94.4} & \textbf{61.7} & \textbf{55.4} & \textbf{53.5} & \textbf{63.0} & \textbf{23.0} & \textbf{74.3} & \textbf{85.3} & \textbf{91.0} & \textbf{43.3} & \textbf{66.6} & \textbf{69.0} & \textbf{67.9}  & \textbf{65.0} \\
        $\Delta$ & \textcolor{retained}{+ 0.3} & \textcolor{retained}{+ 1.5} & \textcolor{retained}{+ 1.0} & \textcolor{retained}{+ 2.1} & \textcolor{retained}{+ 2.9} & \textcolor{retained}{+ 12.5} & \textcolor{retained}{+ 2.1} & \textcolor{retained}{+ 4.8} & \textcolor{retained}{+ 1.1} & \textcolor{retained}{+ 4.0} & \textcolor{retained}{+ 0.2} & \textcolor{retained}{+ 0.3} & \textcolor{retained}{+ 2.6} & \textcolor{retained}{+ 3.0} & \textcolor{retained}{+ 2.7} \\

        \midrule
        GPT4Vis~\cite{GPT4Vis} & 63.5  & 93.1  & 61.4  & 52.7  & 48.5  & 47.0  & 21.4  & 69.8  & 84.3  & 88.1  & 42.7  & 64.2  & 65.7  & 64.3  & 61.7 \\ 
        + \textbf{ATO} & 63.8 & 93.4 & 61.2 & 53.8 & 49.0 & 54.0  & 22.4 & 70.8  & 84.7  & 88.1  & 42.6 & 64.7 & 66.8 & 65.3 & 62.7 \\
        + \textbf{ProAPO} & \textbf{64.4} & \textbf{93.7} & \textbf{61.8} & \textbf{55.4} & \textbf{49.3} & \textbf{62.6} & \textbf{23.9} & \textbf{73.8} & \textbf{85.4} & \textbf{90.7} & \textbf{42.8} & \textbf{65.5} & \textbf{68.2} & \textbf{67.2}  & \textbf{64.4} \\
        $\Delta$ & \textcolor{retained}{+ 0.9} & \textcolor{retained}{+ 0.6} & \textcolor{retained}{+ 0.4} & \textcolor{retained}{+ 2.7} & \textcolor{retained}{+ 0.8} & \textcolor{retained}{+ 15.6} & \textcolor{retained}{+ 2.5} & \textcolor{retained}{+ 4.0} & \textcolor{retained}{+ 1.1} & \textcolor{retained}{+ 2.6} & \textcolor{retained}{+ 0.1} & \textcolor{retained}{+ 1.3} & \textcolor{retained}{+ 2.5} & \textcolor{retained}{+ 2.9} & \textcolor{retained}{+ 2.7} \\

        \midrule 
        AdaptCLIP~\cite{AdaptCLIP} & 63.3  & 92.7  & 59.7  & 53.6  & 47.4  & 51.3  & 20.8  & 67.2  & 84.2  & 87.6  & 41.9  & 66.1  & 66.5  & 64.2  & 61.7 \\
        + \textbf{ATO} & 63.9 & 93.2 & 60.4 & 54.2 & 47.9 & 55.5 & \textbf{22.4} & 69.1 & 84.7  & 88.8  & 42.3 & 66.3 & 67.6 & 65.4 & 62.8 \\
        + \textbf{ProAPO} & \textbf{64.4} & \textbf{93.7} & \textbf{61.8} & \textbf{55.5} & \textbf{49.6} & \textbf{61.6} & {23.3} & \textbf{73.8} & \textbf{85.4} & \textbf{91.0} & \textbf{42.6} & \textbf{66.5} & \textbf{68.6} & \textbf{67.2}  & \textbf{64.5} \\
        $\Delta$ & \textcolor{retained}{+ 1.1} & \textcolor{retained}{+ 1.0} & \textcolor{retained}{+ 2.1} & \textcolor{retained}{+ 1.9} & \textcolor{retained}{+ 2.2} & \textcolor{retained}{+ 10.3} & \textcolor{retained}{+ 2.5} & \textcolor{retained}{+ 6.6} & \textcolor{retained}{+ 1.2} & \textcolor{retained}{+ 3.4} & \textcolor{retained}{+ 0.7} & \textcolor{retained}{+ 0.4} & \textcolor{retained}{+ 2.1} & \textcolor{retained}{+ 3.0} & \textcolor{retained}{+ 2.8}  \\
        
        \bottomrule
    \end{tabular}
}
  % \vspace{-6pt}
  \caption{\textbf{Performance improvement of description methods by our ProAPO.} 
  Avg (11) and Avg (13) denote average results across 11 datasets (excluding CUB~\cite{CUB} and Places~\cite{Places365}) and all 13 datasets, respectively. $\Delta$ denotes performance gains compared to baseline.}
  \vspace{40pt}
  \label{tab:description_add_APO}
\end{table*}
}



{
\renewcommand{\arraystretch}{1.1} 
% \setlength{\tabcolsep}{4pt}
\begin{table*}[t]
  \centering
  \resizebox{0.99\linewidth}{!}
    {
    \begin{tabular}
        {l c c c c c | ccccc ccccc ccc | c | c }    
        \toprule
        \multicolumn{6}{c}{\textbf{Component}}  &   \\
        \cmidrule(lr){1-6} 
        & \texttt{Add} & \texttt{Del} & \texttt{Rep} & \texttt{Cross} & \texttt{Mut}  & \rotatebox{90}{\textbf{IN-1K}} & \rotatebox{90}{\textbf{Caltech}} & \rotatebox{90}{\textbf{Cars}} & \rotatebox{90}{\textbf{CUB}} & \rotatebox{90}{\textbf{DTD}}  & \rotatebox{90}{\textbf{ESAT}} & \rotatebox{90}{\textbf{FGVC}} & \rotatebox{90}{\textbf{FLO}} & \rotatebox{90}{\textbf{Food}}  &  \rotatebox{90}{\textbf{Pets}} & \rotatebox{90}{\textbf{Places}} & \rotatebox{90}{\textbf{SUN}} & \rotatebox{90}{\textbf{UCF}} & \rotatebox{90}{\textbf{Avg (11)}} & \rotatebox{90}{\textbf{Avg (13)}}  \\
        \midrule
       \multicolumn{5}{l}{Vanilla CLIP (ViT-B/32)} & & 62.1  & 91.2  & 60.4  & 51.7 & 42.9  & 43.9  & 20.2  & 66.0  & 83.2  & 86.8 & 39.9 & 62.1  & 60.9 & 61.8 & 59.3  \\ 
       \midrule
       \multicolumn{5}{l}{\textbf{\textit{edit-based generation}}} \\
       \texttt{a)} & \cmark & & & & & 63.8 & 93.6 & 60.0 & 54.6 & 51.8 & 59.0 & 21.8 & 74.0 & 82.2 & 86.7 & 43.0 & 65.7 & 66.8 & 66.0  & 63.3  \\ 
       \texttt{b)} & \cmark & \cmark & & & & \underline{64.6} & 94.0 & 60.9 & 55.0 & 52.6 & 59.3 & 21.8 & 72.0 & 83.2 & \underline{88.0} & 43.2 & 66.4 & 68.0 & 66.4  & 63.8 \\
       \texttt{c)} & \cmark &  & \cmark & & & 64.4 & 94.0 & 61.0 & \underline{55.2} & 52.3 & 59.7 & 22.4 & 71.9 & 84.0 & 87.7 & 43.2 & 66.4 & 67.8 & 66.5  & 63.8 \\
       \texttt{d)} & \cmark & \cmark & \cmark & & & \underline{64.6}  & 93.6 & 60.8 & 54.4 & 53.1 & 60.1 & 22.2 & \textbf{74.7} & 82.4 & 87.2 & \textbf{43.4} & 66.5 & \underline{68.6} & 66.7  & 64.0  \\ 
        \midrule
        \multicolumn{5}{l}{\textbf{\textit{evolution-based generation}}} \\
        \texttt{e)} & \cmark & \cmark & \cmark & \cmark & & \underline{64.6} & \underline{94.3} & 61.2 & 55.0 & \underline{53.2} & \underline{62.6} & \underline{22.9} & 73.9 & \underline{84.3} & \underline{88.0} & 43.1 & \textbf{66.8} & 68.5 & \underline{67.3}  & \underline{64.5} \\ 
        \texttt{f)} & \cmark & \cmark & \cmark & & \cmark &  \textbf{64.7} & \underline{94.3} & \underline{61.4} & 55.1 & 52.9 & 61.4 & 22.6 & 74.0 & 83.6 & 87.7 & \textbf{43.4} & \underline{66.7} & 68.3 & 67.1  & 64.3   \\ 
        \highlight{\texttt{g)}} & \highlight{\cmark} & \highlight{\cmark} & \highlight{\cmark} & \highlight{\cmark} & \highlight{\cmark} & \highlight{\textbf{64.7}}  & \highlight{\textbf{94.4}} & \highlight{\textbf{61.7}} & \highlight{\textbf{55.4}} & \highlight{\textbf{53.5}} & \highlight{\textbf{63.0}} & \highlight{\textbf{23.0}} & \highlight{\underline{74.3}} & \highlight{\textbf{85.3}} & \highlight{\textbf{91.0}} & \highlight{\underline{43.3}} & \highlight{{66.6}} & \highlight{\textbf{69.0}} & \highlight{\textbf{67.9}}  & \highlight{\textbf{65.0}}   \\
        \bottomrule
    \end{tabular}
}
% \vspace{-6pt}
\caption{\textbf{Ablation of edit- and evolution-based operators.}}
\vspace{50pt}
\label{supp_tab: ablation_generate}
\end{table*}
}




{
\renewcommand{\arraystretch}{1.1} 
\begin{table*}[tbp]
  \centering
  \resizebox{0.99\linewidth}{!}
    {
    \begin{tabular}
        {l | ccccc ccccc ccc | c | c | c}  
        \toprule
        {\textbf{Module} (ViT-B/32)}  & \rotatebox{90}{\textbf{IN-1K}} & \rotatebox{90}{\textbf{Caltech}} & \rotatebox{90}{\textbf{Cars}} & \rotatebox{90}{\textbf{CUB}} & \rotatebox{90}{\textbf{DTD}}  & \rotatebox{90}{\textbf{ESAT}} & \rotatebox{90}{\textbf{FGVC}} & \rotatebox{90}{\textbf{FLO}} & \rotatebox{90}{\textbf{Food}}  &  \rotatebox{90}{\textbf{Pets}} & \rotatebox{90}{\textbf{Places}} & \rotatebox{90}{\textbf{SUN}} & \rotatebox{90}{\textbf{UCF}} & \rotatebox{90}{\textbf{Avg (11)}} & \rotatebox{90}{\textbf{Avg (13)}} & \textbf{Times} \\
        \midrule
         
        \texttt{a)} w/o prompt sampling & 64.4 & 93.8 & \textbf{61.8} & \underline{55.4} & 51.8 & 60.0 & \underline{23.2} & 74.0 & 85.1 & 90.7 & \underline{43.0} & 66.0 & 69.3 & 67.3 & 64.5 & 12 min \\
        
        \texttt{b)} w/o group sampling & \textbf{64.8} & \textbf{94.5} & \underline{61.7} & \textbf{55.5} & \textbf{53.6} & \textbf{63.5} & \underline{23.2} & \underline{75.3} & \textbf{85.4} & 90.8 & \textbf{43.3} & \textbf{66.7} & \textbf{69.8} & \textbf{68.1}  & \textbf{65.2} & \textbf{306 min} \\ 
        
        \texttt{c)} w/o sampling strategies & 64.5 & 93.4 & 57.4 & 54.8 & \textbf{53.6} & \underline{63.2} & \textbf{23.4} & \textbf{76.8} & 83.8 & 86.9 & \textbf{43.3} & 66.1 & \underline{69.7} & 67.2  & 64.4 & \underline{302 min} \\

        \midrule
        
        \highlight{\textbf{ProAPO} (full model)} & \highlight{\underline{64.7}}  & \highlight{\underline{94.4}} & \highlight{\underline{61.7}} & \highlight{\underline{55.4}} & \highlight{\underline{53.5}} & \highlight{{63.0}} & \highlight{{23.0}} & \highlight{{74.3}} & \highlight{\underline{85.3}} & \highlight{\textbf{91.0}} & \highlight{\textbf{43.3}} & \highlight{\underline{66.6}} & \highlight{{69.0}} & \highlight{\underline{67.9}}  & \highlight{\underline{65.0}} & \highlight{15 min} \\
        \bottomrule
    \end{tabular}
}
% \vspace{-6pt}
  \caption{\textbf{Ablation of two sampling strategies.}}
% \vspace{-6pt}
  \label{supp_tab: ablation_sample}
\end{table*}
}


{
\renewcommand{\arraystretch}{1.1} 
\begin{table*}[tbp]
  \centering
  \resizebox{0.99\linewidth}{!}
    {
    \begin{tabular}
        {l | ccccc ccccc ccc | c | c }  
        \toprule
        {\textbf{Module} (ViT-B/32)}  & \rotatebox{90}{\textbf{IN-1K}} & \rotatebox{90}{\textbf{Caltech}} & \rotatebox{90}{\textbf{Cars}} & \rotatebox{90}{\textbf{CUB}} & \rotatebox{90}{\textbf{DTD}}  & \rotatebox{90}{\textbf{ESAT}} & \rotatebox{90}{\textbf{FGVC}} & \rotatebox{90}{\textbf{FLO}} & \rotatebox{90}{\textbf{Food}}  &  \rotatebox{90}{\textbf{Pets}} & \rotatebox{90}{\textbf{Places}} & \rotatebox{90}{\textbf{SUN}} & \rotatebox{90}{\textbf{UCF}} & \rotatebox{90}{\textbf{Avg (11)}} & \rotatebox{90}{\textbf{Avg (13)}} \\
        \midrule
         
        \texttt{a)} w/ only accuracy & 64.0 & 93.0 & 60.8 & 54.2 & 49.1 & 55.5 & 20.4 & 68.3 & 84.8 & 88.4 & 41.9 & 64.6 & 65.1 & 64.9 & 62.3 \\
        
        \texttt{b)} w/ only entropy constrain & 64.3 & 93.4 & 61.6 & 54.8 & 49.3 & 56.7 & 22.3 & 69.9 & 85.2 & 89.1 & 42.4 & 65.1 & 66.7 & 65.8 & 63.1 \\ 
        
        \midrule
        
        \highlight{\textbf{ProAPO} (full model)} & \highlight{\textbf{64.7}}  & \highlight{\textbf{94.4}} & \highlight{\textbf{61.7}} & \highlight{\textbf{55.4}} & \highlight{\textbf{53.5}} & \highlight{\textbf{63.0}} & \highlight{\textbf{23.0}} & \highlight{\textbf{74.3}} & \highlight{\textbf{85.3}} & \highlight{\textbf{91.0}} & \highlight{\textbf{43.3}} & \highlight{\textbf{66.6}} & \highlight{\textbf{69.0}} & \highlight{\textbf{67.9}}  & \highlight{\textbf{65.0}}  \\
        \bottomrule
    \end{tabular}
}
% \vspace{-6pt}
  \caption{\textbf{Ablation of different score functions.}}
% \vspace{-8pt}
  \label{supp_tab: ablation_score_function}
\end{table*}
}


% ---------------------------------------------------- % 
%               Ablation Study 的详细实验
% ---------------------------------------------------- %
% \newpage
\section{Detailed Results of Ablation Study}

% ---------------------------------------------------- % 
%             对 Edit- 和 Evolution- 操作的消融
% ---------------------------------------------------- %
\subsection{Ablation of Edit- and Evolution-based Operators}
\label{supp_sec: ablation_operator}
In~\cref{supp_tab: ablation_generate}, we show detailed ablation results of edit- and evolution-based operators. For edit-based operators, we observe that the model with add, delete, and replace operations achieves a higher result in row d). After introducing evolution-based operators, \textit{i.e.}, crossover operator to combine advantages of high-scoring candidates, and mutation operator to avoid locally optimal solutions, we see an increase in performance in rows e)-g). It confirms that evolution-based operators make the model search the optimal prompt faster with limited iterations.




% ---------------------------------------------------- % 
%                对 Sampling 策略的消融
% ---------------------------------------------------- %
\subsection{Ablation of Two Sampling Strategies}
\label{supp_sec: ablation_two_sampling}

In~\cref{supp_tab: ablation_sample}, we show detailed ablation results of two sampling strategies. Without the prompt sampling, we see a slight decrease in times while results drop in row a). It verifies the effectiveness of the prompt sampling. Without the group sampling to select salient categories for optimization, we observe a notable increase in time costs (from 15 min to 300+ min, 20 times) yet similar results in row b) and the full model. It reveals that group sampling simultaneously improves performance and efficiency.




% ---------------------------------------------------- % 
%               对 Score Function 的消融
% ---------------------------------------------------- %
\subsection{Ablation of Different Score Functions}
\label{supp_sec: effect_score_func}

In~\cref{supp_tab: ablation_score_function}, we show detailed ablation results of score functions. Accuracy obtains the worst result as the score function due to the overfitting problem. Our full model with accuracy and entropy constraints as the score function achieves the SOTA result. The score function with only accuracy or entropy constraint achieves suboptimal results, suggesting a trade-off process between them. 


