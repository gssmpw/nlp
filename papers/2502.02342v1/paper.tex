\documentclass[runningheads]{llncs}


\usepackage{graphicx}

\usepackage{array}
\usepackage{multirow}
%\usepackage{amssymb}
\usepackage{xspace}
\usepackage{color,soul}
\usepackage{adjustbox}
\usepackage{comment}
\usepackage{url}
\usepackage[utf8]{inputenc}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{float}
\usepackage{enumitem}
\usepackage{amsmath}

\newcommand{\method}{SHIELD\xspace}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\newcommand{\new}[1]{\textcolor{red}{#1}}
\usepackage{color}

%% \BibTeX command to typeset BibTeX logo in the docs
%\AtBeginDocument{%
%  \providecommand\BibTeX{{%
%    Bib\TeX}}}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
%
\begin{document}
\title{\method: APT Detection and Intelligent Explanation Using LLM}
%
\titlerunning{\method: APT Detection and Intelligent Explanation Using LLM}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Parth Atulbhai Gandhi \and Prasanna N. Wudali \and Yonatan Amaru \and 
Yuval Elovici \and
Asaf Shabtai}
%
\authorrunning{Gandhi et al.}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{Ben-Gurion University of the Negev}
%
\maketitle


\begin{abstract}
Advanced persistent threats (APTs) are sophisticated cyber attacks that can remain undetected for extended periods, making their mitigation particularly challenging. 
Given their persistence, significant effort is required to detect them and respond effectively. 
Existing provenance-based attack detection methods often lack interpretability and suffer from high false positive rates, while investigation approaches are either supervised or limited to known attacks. 
To address these challenges, we introduce \method, a novel approach that combines statistical anomaly detection and graph-based analysis with the contextual analysis capabilities of large language models (LLMs). 
\method leverages the implicit knowledge of LLMs to uncover hidden attack patterns in provenance data, while reducing false positives and providing clear, interpretable attack descriptions. 
This reduces analysts' alert fatigue and makes it easier for them to understand the threat landscape. 
Our extensive evaluation demonstrates \method's effectiveness and computational efficiency in real-world scenarios. 
\method was shown to outperform state-of-the-art methods, achieving higher precision and recall. 
\method's integration of anomaly detection, LLM-driven contextual analysis, and advanced graph-based correlation establishes a new benchmark for APT detection.

\keywords{Attack detection, Large language model, provenance graph}

\end{abstract}


\input{introduction}
\input{related_works}
\input{implementation}
\input{evaluation}
\input{results}
\input{discussions}


%\bibliographystyle{unsrt}
\bibliographystyle{splncs04}
\bibliography{references}

\appendix

\section{Chain-of-Thought Detection Algorithm}
\label{app:algorithm}

\begin{algorithm}[h!]
  \small
  \caption{Chain-of-Thought detection}
  \label{alg:chain_prompting}
  \begin{algorithmic}[1]
  
    \REQUIRE Communities $C$, LLM model $M$
    \ENSURE Attack alerts, summaries, tagged processes
    \FOR{each community $c \in C$}
      \STATE $logs \gets$ GetLogsFromNodes$(c)$
      \STATE $suspiciousProcesses \gets$ CheckKnownBehavior$(logs, M)$
      \IF{$|suspiciousProcesses|$}
        \STATE $deviationFound \gets$ \textbf{False}
        \STATE $temporalPatterns \gets \emptyset$
        \FOR{each process $p \in suspiciousProcesses$}
          \STATE $processLogs \gets$ GetProcessLogs$(p)$
          \STATE $deviation \gets$ AnalyzeBehavior$(processLogs, M)$
          \IF{$deviation \neq \emptyset$}
            \STATE $deviationFound \gets$ \textbf{True}
            \STATE $temporalPatterns[p] \gets deviation$
          \ENDIF
        \ENDFOR
        \IF{$deviationFound$}
          \STATE $attackChain \gets$ ExtractProcessChain$(suspiciousProcesses, temporalPatterns, logs)$
          \IF{$attackChain \neq \emptyset$}
            \STATE $(score, summary, tagged) \gets$ AnalyzeChain$(attackChain, M)$
            \IF{$score \geq 0.8$}
              \RETURN RaiseAlert$()$, $summary$, $tagged$, $score$
            \ELSIF{$0.7 \leq score < 0.8$}
              \RETURN $tagged$, $score$
            \ENDIF
          \ENDIF
        \ENDIF
      \ENDIF
    \ENDFOR
    \RETURN $\emptyset$
  \end{algorithmic}
\end{algorithm}
\clearpage

\section{Comparative Study of LLM Models}
\label{app:model_eval}
\begin{comment}
\begin{figure}[!h]
\setlength{\abovecaptionskip}{3pt}
\setlength{\belowcaptionskip}{0pt}
    \makebox[\textwidth][c]{
        \includegraphics[width=0.7\textwidth]{figures/model_compare.pdf}
    }
    \caption{Performance Comparison of LLM Models}
    \label{fig:models_compare}
\end{figure}
\end{comment}

\begin{table}[h]
\centering
\caption{Performance comparison of different models across datasets.}
\label{tab:performance}
\adjustbox{max width=0.8\textwidth}{%
\begin{tabular}{|c|c|cccc|ccc|}
\hline
\textbf{Model} & \textbf{Dataset} &
  \multicolumn{4}{c|}{\textbf{Confusion Matrix}} &
  \multicolumn{3}{c|}{\textbf{Performance Metrics}} \\
\cline{3-9}
 & & \textbf{TP} & \textbf{FN} & \textbf{FP} & \textbf{TN} &
   \textbf{Precision} & \textbf{Recall} & \textbf{F1-Score} \\
\hline
\multirow{4}{*}{GPT-4o}
  & CADETS     & 07 & 05 & 21 & 681 & 25.0  & 58.3  & 35.0 \\
  & THEIA      & 06 & 03 & 00 & 294 & 100.0 & 66.7  & 80.0 \\
  & Arena      & 03 & 00 & 00 & 235 & 100.0 & 100.0 & 100.0 \\
  & BlindEagle & 01 & 00 & 00 & 00  & 100.0 & 100.0 & 100.0 \\
\hline
\multirow{4}{*}{Qwen-2.5}
  & CADETS     & 07 & 05 & 17 & 685 & 29.2  & 58.3  & 38.9 \\
  & THEIA      & 06 & 03 & 04 & 290 & 60.0  & 66.7  & 63.2 \\
  & Arena      & 03 & 00 & 00 & 235 & 100.0 & 100.0 & 100.0 \\
  & BlindEagle & 01 & 00 & 00 & 00  & 100.0 & 100.0 & 100.0 \\
\hline
\multirow{4}{*}{EXAONE-3.5}
  & CADETS     & 07 & 05 & 31 & 671 & 18.4  & 58.3  & 28.0 \\
  & THEIA      & 04 & 05 & 00 & 294 & 100.0 & 44.4  & 61.5 \\
  & Arena      & 02 & 01 & 00 & 235 & 100.0 & 67.0  & 80.2 \\
  & BlindEagle & 01 & 00 & 00 & 00  & 100.0 & 100.0 & 100.0 \\
\hline
\multirow{4}{*}{LLama-3.1}
  & CADETS     & 06 & 06 & 48 & 654 & 11.1  & 50.0  & 18.2 \\
  & THEIA      & 05 & 04 & 03 & 291 & 62.5  & 55.6  & 58.8 \\
  & Arena      & 03 & 00 & 02 & 233 & 60.0  & 100.0 & 75.0 \\
  & BlindEagle & 01 & 00 & 00 & 00  & 100.0 & 100.0 & 100.0 \\
\hline
\end{tabular}
}
\end{table}

\section{Attack Summary Visualization}
\label{app:attack_summary}
\begin{figure}[h!]
    \makebox[\textwidth][c]{
        \includegraphics[width=\textwidth]{figures/attack_summary.pdf}
    }
    \caption{An illustration of attack summary generated for the attack in THEIA dataset.}
    \label{fig:attacksum}
\end{figure}


% that's all folks
\end{document}


