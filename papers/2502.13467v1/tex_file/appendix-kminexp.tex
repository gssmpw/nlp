\section{Omitted proofs in \Cref{sec:kminexp}}\label{Appendix:k-min}
This proof mainly applies the techniques for general linear bandits \citet{liu2024almost, lee2024unified}. Given action $S \in \gS$ to the environment, we assume that $\ell_S$ is the random variable of the loss, i.e., $\E[\ell_S] = \ell^*(S)$. 

We have
\begin{align*}
    g_t(\theta; \lambda) :&= - \nabla_\theta \gL_t(\theta; \lambda) + \sum_{i < t} \ell_i \psi(S_i) \\
    &=  \sum_{i < t}  \frac{1}{\psi(S_i)^\top \theta} \cdot \psi(S_i) - \lambda \theta. \\
    H_t(\theta;\lambda) :&= \nabla^2_\theta \gL(\theta; \gH_t)\\
    &=  - \nabla_\theta g_t(\theta; \lambda)  \\
    &= \lambda I + \sum_{i < t} \frac{\psi(S_i)\psi(S_i)^\top}{(\psi(S_i)^\top\theta)^2}.
\end{align*}
\subsection{Concentration Argument for MLE}
\begin{lemma}[MLE Concentration]
\label{lemma:mle-concentration}
For $L^* := \sup_{S \in \gS} \ell^*(S)$, $M_1:= L^*/\sqrt{2}$, and $V = \sup\{\|\theta\|_2 : \theta \in \Theta\}$, set
\begin{align}\label{eq:def-lambda}
    \lambda_t := \max \left\{1, \frac{2dM_1}{V}\cdot \log\left(e\sqrt{1 + \frac{tL^*}{d}} + \frac{1}{\delta}\right)\right\},
\end{align}
and 
\begin{align} \label{eq:def-gamma}
    \gamma_t(\delta, \lambda_t) := \sqrt{\lambda_t}\left(\frac{1}{2M_1} + V\right) + \frac{2M_1d}{\sqrt{\lambda_t}}\left(\log(2) + \frac{1}{2}\log\left(1 + \frac{tL^*}{\lambda_t d}\right)\right) + \frac{2M_1}{\sqrt{\lambda_t}}\log(1/\delta).
\end{align}
Then we have with probability at least $1 - \delta$, 
\begin{align}\label{eq:def-confidence-set}
    \theta^* \in C_t(\hat\theta_t; \delta,\lambda_t) := \left\{ \theta \in \Theta : \left\| g_t(\theta; \lambda_t) - g_t(\hat\theta_t; \lambda_t) \right\|_{H_t^{-1}(\theta; \lambda_t)} \le \gamma_t(\delta, \lambda_t) \right\},
\end{align}
holds for any $t \in [T]$. We denote the confidence set as $C_t(\hat\theta_t; \delta, \lambda_t)$ and this good event as $\Xi$.

\begin{proof}
For simplicity, we denote the filtration of history as  $\gH_t := \left( S_1, Y_1, \cdots, S_{t-1}, Y_{t-1}, S_t \right)$. Then we have
\begin{align*}
    \ell_t \sim \exp(\psi(S_t)^\top \theta^*), \quad \E[\ell_t \mid \gH_t] = \frac{1}{\psi(S_t)^\top\theta^*},
\end{align*}
by the property of exponential distribution and definition of $\psi(S)$. Since we have
\begin{align*}
    \hat\theta_t \leftarrow \argmin_{\theta \in \R^d} \gL_t(\theta; \lambda_t),
\end{align*}
by \Cref{alg:k-min}. Then by KKT condition, we have
\begin{align*}
   \left.\frac{\partial \gL_t(\theta ; \lambda_t)}{\partial \theta} \right|_{\theta = \hat\theta_t} = 0 \Rightarrow g_t(\hat\theta_t; \lambda_t) - \sum_{i < t} \ell_i\psi(S_i) = 0
\end{align*}
Notice that by definition of $g_t$, 
\begin{align*}
    g_t(\theta^*; \lambda_t) =  \sum_{i < t}  \frac{1}{\psi(S_i)^\top \theta^*} \cdot \psi(S_i) - \lambda_t \theta^*.
\end{align*}
Denote $\varepsilon_t := \ell_t - \E[\ell_t \mid \gH_t] = \ell_t - {1}/({\psi_t(S_t)^\top\theta^*})$, we have
\begin{align*}
    g_t(\hat \theta_t; \lambda_t) - g_t(\theta^*; \lambda_t) = \sum_{i < t} \varepsilon_i \psi(S_i) + \lambda_t \theta^*.
\end{align*}
Fix $s \ge 0$, we have
\begin{align*}
    \E[\exp(s\varepsilon_t) \mid \gH_t] &= \E\left[\exp\left(s\ell_t - \frac{s}{\psi_t(S_t)^\top\theta^*}\right)\right] \\
    &= \exp\left(- \frac{s}{\psi_t(S_t)^\top\theta^*}\right)\cdot \E\left[\exp(s\ell_t)\mid \gH_t\right],
\end{align*}
and by calculation,
\begin{align*}
    \E[\exp(s\varepsilon_t) \mid \gH_{t-1}] &= \exp\left(- \frac{s}{\psi(S_t)^\top\theta^*}\right)\cdot \E\left[\exp(s\ell_t)\mid \gH_t\right] \\
    &=\exp\left(- \frac{s}{\psi(S_t)^\top\theta^*}\right)\cdot \int_{([0,+\infty)} \psi(S_t)^\top\theta^*\exp(-(\psi(S_t)^\top\theta^* - s)y)dy \\
    &= \exp\left(-\frac{1}{\ell_t^*}s + \log(\ell_t^*) - \log(\ell_t^* - s)\right),
\end{align*}
where we use $\ell_t^* := \psi_t(S_t)^\top\theta^*$ for simplicity. Consider the case for $s < \ell_t^*$, by intermediate value theorem, we have
\begin{align*}
    \log(\ell_t^*) - \log(\ell_t^* - s) = s \cdot \frac{1}{\ell_t^*} - \frac{s^2}{2\xi^2},
\end{align*}
for some $\xi \in [\ell_t^* - s, \ell_t^*]$. We further denote
\begin{equation}\label{eq:def-Lstar}
    L^* = \sup_{S \in \gS} \ell^*(S).
\end{equation}
Therefore, we can set constant $0 \le s \le L^*$, which gives
\begin{align*}
    \log(\ell_t^*) - \log(\ell_t^* - s) \leq s \cdot \frac{1}{\ell_t^*} - \frac{s^2}{(\ell_t^*)^2}.
\end{align*}
Denote $\nu_{t-1} := -1/{(\psi(S_t)^\top \theta^*)^2}$. We have for some constant $M_1 \ge L^*/\sqrt{2}$, and $|s| \le 1/M_1$,
\begin{align*}
    \E[\exp(s\varepsilon_t) \mid \gH_t] \le \exp(s^2 \nu_{t-1}).
\end{align*}
Applying \citet[Theorem 2]{janz2024exploration} with $\mS_t := \sum_{i<s} \varepsilon_i \psi(S_i)$, we can show that with probability at least $1 - \delta$,
\begin{align*}
    \left\|g_t(\hat\theta_t; \lambda_t) - g_t(\theta^*; \lambda_t)\right\|_{H_t^{-1}(\theta^*;\lambda_t)} &\le \left\|\sum_{i<t}\varepsilon_i \psi_i(S_i)\right\|_{H_t^{-1}(\theta^*;\lambda_t)} + \lambda_t \left\|\theta^*\right\|_{H_t^{-1}(\theta^*;\lambda_t)} \\
    &\le \frac{\sqrt{\lambda_t}}{2M_1} + \frac{2M_1}{\sqrt{\lambda_t}}\log\left(\frac{\det(H_t(\theta^*)^{1/2}/\lambda_t^{d/2})}{\delta}\right) + \frac{2M_1}{\sqrt{\lambda_t}}d\log(2) + \sqrt{\lambda_t} V,
\end{align*}
where $V = \sup\{\|\theta\|_2 : \theta \in \Theta\}$. Moreover, by definition of $H_t(\theta^*; \lambda_t)$, we have
\begin{align*}
    \det(H_t(\theta^*; \lambda_t))/\lambda_t^d \le \left(1 + \frac{tL^*}{\lambda_t d}\right)^d,
\end{align*}

Therefore, for
\begin{align*}
    \gamma_t(\delta, \lambda_t) \ge \sqrt{\lambda_t}\left(\frac{1}{2M_1} + V\right) + \frac{2M_1d}{\sqrt{\lambda_t}}\left(\log(2) + \frac{1}{2}\log\left(1 + \frac{tL^*}{\lambda_t d}\right)\right) + \frac{2M_1}{\sqrt{\lambda_t}}\log(1/\delta),
\end{align*}
we have with probability at least $1 - \delta$, 
\begin{align*}
    \theta^* \in C_t(\hat\theta_t; \delta,\lambda_t) := \left\{ \theta \in \Theta : \left\| g_t(\theta; \lambda_t) - g_t(\hat\theta_t; \lambda_t) \right\|_{H_t^{-1}(\theta; \lambda_t)} \le \gamma_t(\delta, \lambda_t) \right\},
\end{align*}
holds for any $t \in [T]$.
\end{proof}
\end{lemma}


\subsection{Proof of \Cref{thm:kminexp}}
\begin{theorem}[Formal version of \Cref{thm:kminexp}]
\label{thm:kminexp-formal}
By setting $\delta = 1/T$, $\gamma_t(\delta)$ according to \Cref{eq:def-gamma}, and $\lambda_t$ according to \Cref{eq:def-lambda}, \Cref{alg:k-min} enjoys the following regret guarantee: 
\begin{align*}
    \gR(T) &\le 
    16\gamma \cdot \sqrt{dT}\cdot \sqrt{(\ell^*(S^*))^2(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \\
    &\quad + 256\gamma^2 \cdot dL^* \cdot \log\left(1 + L^*T/d\lambda\right) \cdot \left(\frac{\sup_{S \in \gS} (\psi(S)^\top \theta^*)}{\ell^*(S^*)^3} + 2\right) + 1,
\end{align*}
where $\gamma := \sup_t \gamma_t(\delta)$ and $\lambda_t := \inf_t \lambda_t$.
\begin{proof}
Since we have $X_i \sim \exp(\phi(i)^\top \theta^*)$, then
\begin{align*}
    \min_{i \in S} X_i \sim \exp\left(\sum_{i \in S} \phi(i)^\top \theta^* \right) = \exp\left(\psi(S)^\top \theta^* \right),
\end{align*}
which shows that 
\begin{align*}
    \ell^*(S) = \E\left[\min_{i \in S} X_i\right] = \frac{1}{\psi(S)^\top \theta^*}.
\end{align*}
Therefore, by second-order Taylor expansion, we have for some $\xi \in [\ell^*(S_t), \sup_t \ell^*(S_t)]$, 
\begin{align*}
    \gR(T) &= \E\left[\sum_{t=1}^T \ell^*(S_t) - \ell^*(S^*) \right]\\
    &\le   \Prob[\Xi] \cdot \E\left[\sum_{t=1}^T \frac{1}{\psi(S_t)^\top \theta^*} - \frac{1}{\psi(S^*)^\top \theta^*} \middle| \Xi \right]+ \Prob[\neg\Xi] \cdot T \\
    &\le \E\left[ \underbrace{\sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2} \cdot \left( \psi(S^*)^\top \theta^* - \psi(S_t)^\top \theta^*  \right)}_{\gR_1(T)} \middle| \Xi \right] +\E\left[ \underbrace{\sum_{t=1}^T \frac{2}{\xi^3} \cdot \left(\psi(S^*)^\top \theta^* - \psi(S_t)^\top \theta^* \right)^2 }_{\gR_2(T)} \middle| \Xi \right] + 1.
\end{align*}
Under $\Xi$, we have $\theta^* \in C_t(\hat\theta_t; \delta, \lambda_t)$ for every $t \in [T]$. Therefore, by \Cref{alg:k-min}, we have
\begin{align}
\label{eq:optimism}
    \psi(S^*)^\top \theta^* \le \psi(S_t)^\top \wt{\theta}_t.
\end{align}
Under $\Xi$, we have
\begin{align*}
    \gR_1(T) &\le \sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2} \cdot \psi(S_t)^\top (\theta^* - \wt{\theta}_t) \\
    &\le \sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2} \cdot \| \psi(S_t) \|_{H_t^{-1}(\theta^*; \lambda_t)} \cdot \left\|\theta^* - \wt{\theta}_t\right\|_{H_t^{-1}(\theta^*; \lambda_t)},
\end{align*}
where the first inequality is due to \Cref{eq:optimism} and the second holds by Cauchy-Schwartz inequality. Notice that $\wt{\theta}_t, \theta^* \in C_t(\hat\theta_t; \delta, \lambda_t)$ under $\Xi$, we have
\begin{align*}
    \left\|\theta^* - \wt{\theta}_t\right\|_{H_t^{-1}(\theta^*; \lambda_t)} \le 8\gamma_t(\delta, \lambda_t)
\end{align*}
by \citet[Lemma 30]{liu2024almost}. Denote $\gamma := \sup_{t \in [T]} \gamma_t(\delta, \lambda_t)$, we can upper bound $\gR_1(T)$ by
\begin{align*}
    \gR_1(T) \le 8 \cdot \sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2} \cdot \| \psi(S_t) \|_{H_t^{-1}(\theta^*; \lambda_t)} \cdot \gamma.
\end{align*}
Denote $A_t := \psi(S_t)/\psi(S_t)^\top \theta^*$, we have $H_t(\theta^*; \lambda) = \sum_{i < t} A_t^\top A_t + \lambda_t I$ and $\|A_t\|_2 \le \sum_{i \in S_t} \|\phi(i)\|_2 \cdot \ell^*(S_t) \le KL^*$. Then we have
\begin{align*}
    \gR_1(T) &\le 8\gamma \sqrt{\sum_{t=1}^T \|A_t\|^2_{H_t^{-1}(\theta^*; \lambda_t)}} \cdot \sqrt{\sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2}} \\
    &\le 16\gamma \cdot \sqrt{d(1 + KL^*/\lambda) \cdot \log\left(1 + KL^*T/d\lambda\right)} \cdot \sqrt{\sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2}},
\end{align*}
where the first inequality is due to the Cauchy-Schwartz inequality, and the second inequality is due to the elliptical potential lemma of \citet{abbasi2011improved}. Moreover, by \citet[Lemma 31]{liu2024almost}, we have
\begin{align*}
    \sqrt{\sum_{t=1}^T \frac{1}{(\psi(S_t)^\top \theta^*)^2}} &\le \sqrt{T\cdot \frac{1}{(\psi(S^*)\psi^*)^2} + 2 \cdot \gR(T)} \\
    &\le \sqrt{T\cdot (\ell^*(S^*))^2 } + \sqrt{2 \cdot \gR(T)},
\end{align*}
which shows that for $\lambda := \inf_t \lambda_t$, 
\begin{align*}
    \gR_1(T) &\le 16\gamma \cdot \sqrt{d(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \cdot \sqrt{T\cdot (\ell^*(S^*))^2 } \\
    &\quad + 16\gamma \cdot \sqrt{d(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \cdot \sqrt{2 \cdot \gR(T)}.
\end{align*}
Next we give the upper bound for $\gR_2(T)$. Recall that 
\begin{align*}
    \gR_2(T) = \sum_{t=1}^T \frac{2}{\xi^3} \cdot \left(\psi(S_t)^\top \theta^* - \psi(S^*)\theta^*\right)^2.
\end{align*}
Then, under $\Xi$, we have
\begin{align*}
    \gR_2(T) &\le \sum_{t=1}^T \frac{2}{\xi^3} \cdot \left\langle\psi(S_t) ,\theta^* - \wt{\theta}_t\right\rangle^2 \\
    &\le  \frac{2}{\ell^*(S^*)^3} \cdot \sum_{t=1}^T \|\psi(S_t)\|^2_{H_t^{-1}(\theta^*; \lambda_t)} \cdot \|\theta^* - \wt{\theta}_t\|^2_{H_t^{-1}(\theta^*; \lambda_t)} \\
    &\le \frac{2}{\ell^*(S^*)^3} \cdot 64\gamma^2 \cdot \sum_{t=1}^T \|\psi(S_t)\|^2_{H_t^{-1}(\theta^*; \lambda_t)},
\end{align*}
where the first inequality is according to \Cref{eq:optimism}, the second inequality is due to the Cauchy-Schwartz inequality, and the last inequality holds by \Cref{lemma:mle-concentration}. Denote
\begin{align*}
    \Lambda_t := \lambda_t I + \sum_{i < t} \psi(S_i)^\top \psi(S_i). 
\end{align*}
Then we have
\begin{align*}
    \sup_{S \in \gS} (\psi(S)^\top \theta^*) \cdot \Lambda_t^{-1} \succ H_t^{-1}(\theta^*; \lambda_t),
\end{align*}
which further implies
\begin{align*}
    \gR_2(T) &\le \frac{2}{\ell^*(S^*)^3} \cdot 64\gamma^2 \cdot \sup_{S \in \gS} (\psi(S)^\top \theta^*) \cdot \sum_{t=1}^T \|\psi(S_t)\|^2_{\Lambda_t^{-1}} \\
    &\le \frac{2}{\ell^*(S^*)^3} \cdot 64\gamma^2 \cdot \sup_{S \in \gS} (\psi(S)^\top \theta^*) \cdot 2dL^*\log(1 + L^* T/d\lambda) \\
    &= \frac{256}{\ell^*(S^*)^3} \sup_{S \in \gS} (\psi(S)^\top \theta^*) \cdot \gamma^2 \cdot dL^*\log(1 + L^*T/d\lambda).
\end{align*}
Therefore, we have
\begin{align*}
    \gR(T) &\le 16\gamma \cdot \sqrt{d(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \cdot \sqrt{T\cdot (\ell^*(S^*))^2 } \\
    &\quad + 16\gamma \cdot \sqrt{d(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \cdot \sqrt{2 \cdot \gR(T)} \\
    &\quad + \frac{256}{\ell^*(S^*)^3} \sup_{S \in \gS} (\psi(S)^\top \theta^*) \cdot \gamma^2 \cdot dL^*\log(1 + L^*T/d\lambda) + 1.
\end{align*}
Notice that for $x \le A\sqrt{x} + B$, we have $x \le 2A^2 + B$. Therefore, we have
\begin{align*}
    \gR(T) &\le 
    16\gamma \cdot \sqrt{dT}\cdot \sqrt{(\ell^*(S^*))^2(1 + L^*/\lambda) \cdot \log\left(1 + L^*T/d\lambda\right)} \\
    &\quad + 256\gamma^2 \cdot dL^* \cdot \log\left(1 + L^*T/d\lambda\right) \cdot \left(\frac{\sup_{S \in \gS} (\psi(S)^\top \theta^*)}{\ell^*(S^*)^3} + 2\right) + 1, \\
    &\le \wt{\gO}\left(\sqrt{d^3 T}\right)
\end{align*}



\end{proof}
\end{theorem}