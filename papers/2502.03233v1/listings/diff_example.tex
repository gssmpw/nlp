\begin{lstlisting}[style=diff, caption={Fixing diff and vulnerability cause pattern for CVE-2022-1733}, label={lst:vuln_pattern}]
|{\color{gray}// Patch}|
...
- if (p[i] == '\\'')  
+ if (p[i - 1] != NUL && p[i] == '\\')
...

|{\color{gray}// Vulnerability Cause Pattern}|
|{\color{mybleu}Pattern name: }|Unchecked Null Termination.
|{\color{mybleu}Vulnerable Pattern: }|Accessing or modifying a string beyond its null terminator without proper checks.
|{\color{mybleu}Fixing Pattern: }|Ensure that the string access is within bounds before proceeding.
\end{lstlisting}