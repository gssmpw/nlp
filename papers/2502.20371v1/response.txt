\section{Related Work}
A framework for constraints on the sample space of generative models was first theoretically described in Goodfellow et al., "Generative Adversarial Networks"**Goodfellow et al., "Generative Adversarial Networks"**. In their framework, constraints are represented through a black-box oracle function labeling samples as valid or invalid. This problem has been practically explored for generative adversarial networks (GANs) **Sohl-Dickstein et al., "Deep Unsupervised Learning using Nonequilibrium Thermodynamics"**, diffusion models **Song et al., "Improved Techniques for Training Score-Based Generative Models"**.
More recently, **Nichol et al., "Rebar: A Fast and Effective Method for Imposing Hard Constraints in Deep Generative Models"** proposed a method for generating constraint satisfying samples from pre-trained diffusion models. It requires a projection operator the constraint set, which is generally intractable for complex constraints. Moreover, they employ a Langevin dynamics-based **Chen et al., "Variational Behavioural Cloning"** sampler which is slow to converge.
The main idea in all of these methods was to improve generative models by incorporating information from the constraints. In this paper, however, the goal is to construct a model family that does not generate invalid samples by design.

Recognizing the expressivity of diffusion models, various approaches to incorporating pre-defined constrains into them have emerged in the literature. **Ho et al., "Diffusion-based Generative Models for Text"** proposed reflected diffusion models that enforce the whole diffusion sampling trajectory to remain bounded in a convex set. **Zhang et al., "Constrained Diffusion Models for Discrete Sets"** extended reflected diffusion models to support more general constraints. However, their approaches are only evaluated on low-dimensional problems with simple constraints. Moreover, reflected diffusion makes the forward process, and consequently training, expensive.  **Li et al., "Barrier Functions for Constrained Diffusion Models"** also proposed a barrier function based approach for constrained diffusion models. **Zhang et al., "Transforming Constrained Domains into Unconstrained Dual Ones Using Barrier Functions"** used barrier functions to transform constrained domains into unconstrained dual ones. Both these methods only support convex constraints.

Another closely related body of work is diffusion bridges, stochastic processes that are guaranteed to end in a given constraint set. **Tse et al., "Mathematically Sufficient Conditions for Designing Diffusion Bridges"** developed a set of mathematically sufficient conditions for designing diffusion bridges to a given constraint set.  The follow-up work of **Zhang et al., "Formulating Diffusion Models on Discrete Sets Using Bridges"** used bridges to formulate diffusion models on discrete sets. They also provided closed-form bridges for a restricted set of constraints such as product of intervals. These closed form bridges quickly become intractable as the constraint set gets more complex.