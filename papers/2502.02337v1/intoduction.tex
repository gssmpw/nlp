\section{\label{sec:intro}Introduction}


The rapid advancement of technology and widespread adoption of digital applications have resulted in a significant increase in cyberattacks~\cite{checkpoint}.
To gain visibility into their digital ecosystems, organizations deploy security information and event management (SIEM) systems in their networks. 
These systems store and analyze log data generated by various digital entities in the network~\cite{exabeam}.

SIEM systems enable threat detection by allowing users to execute search queries, referred to as rules, on the ingested log data. 
Each SIEM platform employs its own rule definition language (RDL), a schema-based structure for defining these rules that standardizes the creation and execution of SIEM rules, making them inherently structured data and a foundational component of modern cybersecurity operations.
Examples of such schemas include the search processing language (SPL) from Splunk, the Lucene query language by Elasticsearch, and the Kusto query language (KQL) by Microsoft. 

Security alerts are triggered when the execution of SIEM rules yields search results. 
When such alerts are generated, security analysts must examine each alert individually, performing tasks such as triage, analysis, and interpretation, and determine whether the alert corresponds to an actual attack. 
A critical aspect of effective threat detection and hunting is the precise mapping and understanding of the tactics, techniques, and procedures (TTPs) employed by adversaries, as defined in the MITRE ATT\&CK framework.\footnote{\url{https://attack.mitre.org/}} 
Incorporating MITRE ATT\&CK techniques in the analysis provides valuable insights, enabling analysts to discern potential attack flows. 
Such mapping enhances security professionals' ability to anticipate and mitigate the strategies employed by cyber adversaries.

Mapping SIEM rules to specific MITRE ATT\&CK techniques is a complex manual process that is prone to errors and can be time-consuming.
Cybero, a leading cybersecurity company, reported~\cite{cybero} that \textit{"organizations collect sufficient log data to potentially detect 94\% of techniques outlined in the MITRE ATT\&CK framework; however, only 24\% of these techniques are effectively covered due to gaps in detection rules, with an additional 12\% of SIEM rules rendered non-functional or misconfigured."} 
In its best practices guide~\cite{cisa} to MITRE ATT\&CK mapping, CISA, an American cyber defense agency, listed (i) leaping to conclusions (i.e., prematurely deciding on a mapping based on insufficient evidence or examination of the facts), (ii) missing opportunities (i.e., not considering, being unaware of, or overlooking other potential technique mappings based on implied or unclear information), and (iii) miscategorization (i.e., the selection of incorrect techniques due to misinterpreting, misreading, or inadequately understanding the techniques, specifically the difference between two techniques) as common mistakes committed by security analysts when manually performing the mapping task.
Given the above, there is a need to automate the mapping process and thereby reduce the workload on security analysts and increase the speed and accuracy of threat detection.

Recent cybersecurity research has explored various techniques for mapping unstructured data from cyber threat intelligence (CTI) reports to the MITRE ATT\&CK framework~\cite{alves2022leveraging,alam2023looking,rani2024ttpxhunter,liu2022threat,zhang2024attackgboosting}. 
While these methods have demonstrated effectiveness in handling unstructured data, they have a limited ability to adapt to structured data use cases, such as intrusion detection system and SIEM rules.
Also, these methods use supervised learning-based approaches to classify structured data (i.e., intrusion detection system and SIEM rules) to MITRE ATT\&CK technique classes, which require retraining when new threats emerge.
Their reliance on retraining limits their scalability and efficiency in dynamic threat landscapes.
MÄƒrmureanu et al.~\cite{10398612} proposed a method to map structured data, specifically Splunk rules, to the MITRE ATT\&CK framework. 
This approach utilizes a BERT model trained as a classifier to categorize Splunk rules into 14 high-level MITRE ATT\&CK tactic classes. 
However, this method shares the same limitations as other supervised learning approaches discussed earlier, particularly the need for retraining with updated data to address new threats. 
Furthermore, the task of mapping rules to high-level tactics is comparatively easier than mapping them to MITRE ATT\&CK techniques and sub-techniques, which involve around 670 distinct classes and present a much greater challenge. 
Despite focusing on this simplified task, the method failed to achieve high performance in their evaluation, due to its inherent limitations.
In a recent study, Fayyazi et al.~\cite{fayyazi2023advancing} employed large language models (LLMs) to map CTIs in the form of unstructured text to MITRE ATT\&CK techniques, while Nir et al.~\cite{daniel2023labeling} employed them to map Snort intrusion detection rules to MITRE ATT\&CK techniques. 

These investigations highlight the potential of LLMs in cybersecurity tasks but also underscore their limitations. 
Solely relying on the implicit knowledge of LLMs has proven insufficient for addressing the domain-specific requirements of cybersecurity.
This gap highlights the need for more adaptable and scalable methodologies tailored to the dynamic nature of cyber threats.
To produce accurate and reliable predictions, they require additional contextual information that is not inherently available to the LLM.

To address these shortcomings, we propose \methodName, a novel LLM-based framework for analyzing SIEM rules and recommending relevant MITRE ATT\&CK techniques. 
\methodName eliminates dependence on training data, utilizes LLM agents to retrieve supplementary contextual information, and transforms structured rule into unstructured natural language to preserve the syntactic and semantic meaning of the rule.
This innovative approach ensures reliable and accurate predictions while overcoming the limitations of existing methods.

LLMs, with their advanced natural language processing (NLP) capabilities, can process and analyze structured data, automatically identify patterns, and understand the syntactic meaning of the data, but they often fall short in understanding the semantic meaning of the data.
This study leverages LLMs to autonomously map structured data in the form of SIEM rules %defined in any RDL 
to MITRE ATT\&CK techniques, enabling the automation of cybersecurity threat detection and investigation.

\methodName is a multi-stage AI agent pipeline (see Figure~\ref{fig:r2t}) inspired by the prompt chaining technique~\cite{wu2022promptchainer} and designed to enhance the understanding and application of SIEM rules. 
The pipeline begins with the extraction of indicators of compromise (IoCs) from the rule (e.g., process names, file names, registry keys and values, IP addresses, network ports).
Then, a web search LLM agent retrieves additional contextual information related to the IoCs identified in the rule. 
Leveraging the information gathered in the preceding stages, the next AI agent translates the rule into natural language text, providing a comprehensive description.
This textual description is then used by an LLM to identify the data source~\cite{ds} of the logs or the mitigation strategy being applied upon which the rule operates.
This natural language representation, along with the data source or mitigation-related information, serves as input to another LLM that maps the rule in question to probable MITRE ATT\&CK techniques. 
In the final stage, the pipeline refines the mapping and provides reasoning by extracting the most relevant techniques from the list of potential matches, facilitating precise alignment of the rule with the MITRE ATT\&CK framework.

We conducted a comprehensive series of experiments to evaluate \methodName's ability to map SIEM rules to the MITRE ATT\&CK framework. 
The evaluation focused on common metrics such as precision and recall, which are indicators of the method's accuracy and completeness in correctly classifying the SIEM rules to relevant techniques within the framework.
Various LLMs were examined, including Qwen, IBM Granite, Mistral, and GPT-4-Turbo, and we evaluated \methodName's effectiveness when each LLM was employed in the pipeline.
We used the threat detection rules published in the Splunk Security content dataset\footnote{\url{https://github.com/splunk/security_content/tree/develop/detections}} in our experiments; to ensure that the rules were not already known to the LLM, we carefully selected rules for the dataset based on their creation or modification dates. 
Specifically, we included only those rules with dates later than the knowledge cut-off date of the LLMs utilized in our experiments. 


Using various configuration settings, we aimed to identify the optimal strategies for maximizing the performance of these models. 
Our study not only demonstrates the potential of LLMs in automating threat analysis but also provides insights into the most effective configurations for deploying these models in real-world cybersecurity environments. 
This study is among the first to explore leveraging LLMs to map structured data to the MITRE ATT\&CK framework, and our results, which highlight RAM's potential, leave room for further refinement in future research. 
We also provide valuable insights regarding the challenges encountered during this study, which can guide subsequent advancements in this domain for example, the lack of a completely labeled SIEM rules dataset.

\noindent The main contributions of this paper are as follows:

\begin{itemize}[nosep,leftmargin=*]
    \item We demonstrate the feasibility of using LLMs to automate the mapping of SIEM rules to MITRE ATT\&CK techniques and provide reasoning, which could significantly enhance the capabilities of current cybersecurity tools.
    \item We propose an AI agent-based framework that utilizes both implicit and explicit knowledge in automating the mapping of structured SIEM rules to MITRE ATT\&CK techniques.
    \item We demonstrate the effective utilization of LLMs without the need for pretraining or fine-tuning, thereby eliminating the need for any training data.
    \item We provide a practical guide for deploying LLMs in cybersecurity, by identifying the optimal configurations for these models.
   
    \item We present valuable insights regarding the challenges encountered during the experimentation process, providing increased understanding of the obstacles and considerations that shaped our research and findings.
\end{itemize}


\begin{figure*}[ht!]
    \centering
    \includegraphics[width=0.85\linewidth]{Images/r2t_method_new.jpg}
    \caption{Overview of our AI Agent-based \methodName pipeline.}
    \label{fig:r2t}
\end{figure*}