        \begin{figure}[ht!]  
    \centering
    \begin{tikzpicture}[scale=1.5]
        % Main Rectangle w
        \draw (0,0) rectangle (7,0.5);
        \node at (-0.5, 0.25) {\(w\)};
        
        % Smaller Rectangle 2 - Border color red
        \draw[draw=red, thick] (0.3,0) rectangle (2.6,0.5);
        % Smaller Rectangle 2 - Border color red
        \draw[draw=red, thick] (3.5,0) rectangle (5.6,0.5);
        \fill[red!10] (3.5,0) rectangle (5.8,0.5);
        \draw[draw=red, thick] (5.8,0) rectangle (6.0,0.5);
        \fill[red!5] (5.8,0) rectangle (6.0,0.5);
        \node at (5.9,0.25) {$c_{i}$};
        

        \draw[->, thick] (3.5,1.2) -- (3.5,0.8);
        \node[align=center, below] at (3.5,1.6) {\(s_i\)};
        \draw[->, thick] (4.3,1.2) -- (4.3,0.8);
        \node[align=center, below] at (4.3,1.6) {\(s_{i}+z\)};
        
        
        
        
        \draw[->, thick] (6.0,1.2) -- (6.0,0.8);
        \node[align=center, below] at (6.0,1.6) {\(f_i\)};

        \node at (4.8,0.25) {$B_{i}$};

    % w'
    \draw (0,-2) rectangle (7,-2.5);
    \fill[gray!10] (1.8,-2) rectangle (2.6,-2.5);
    \fill[gray!10] (1.8,0) rectangle (2.6,0.5);

    \node at (0.7,0.25) {$z$};
    \node at (2.2,0.25) {$\tilde{z}$};
    \node at (2.2,-2.25) {$\tilde{z}$};
    
    
    \node at (-0.5, -2.25) {\(w'\)};
    \draw[draw=red, thick] (1.0,-2) rectangle (1.8,-2.5);
    \draw[dashed] (1.0,0.5) rectangle (1.0,-2.0);
    \draw[dashed] (1.8,0.5) rectangle (1.8,-2.0);
    \draw[dashed,draw=gray] (1.3,0.8) rectangle (1.6,-2.8);
    \node[color=gray] at (1.5,-3.0) {$w'[j]$};
    
    
    \draw[draw=red, thick] (1.8,-2) rectangle (2.6,-2.5);
    \draw[draw=red, thick] (4.3,-2) rectangle (5.8,-2.5);
    \node[align=center, below] at (0.3,1.6) {\(q_i\)};
    \draw[->, thick] (0.3,1.2) -- (0.3,0.8);

    \node[align=center, below] at (1.0,1.6) {\(q_i+z\)};
    \draw[->, thick] (1.0,1.2) -- (1.0,0.8);

    \node[align=center, below] at (1.8,2.3) {\(q_i+z+\ell'_k\)};
    \draw[->, thick] (1.8,2.0) -- (1.8,0.8);
    
    \fill[red!10] (4.3,-2) rectangle (5.8,-2.5);
    
    \draw[draw=red, thick] (5.2,-2) rectangle (5.2,-2.5);
    \fill[red!5] (5.2,-2) rectangle (5.8,-2.5);
    
    
    \draw[->, thick] (4.3,-3.0) -- (4.3,-2.6);
    \node[align=center, below] at (4.3,-3.2) {\(s'_{k}\)};
    
    
    \draw[->, thick] (5.8,-3.0) -- (5.8,-2.6);
    \node[align=center, below] at (5.8,-3.2) {\(f'_{k}\)};
    
    \node at (4.8,-2.25) {$B'_{k}$};
    \node at (5.5,-2.25) {$B'_{k+1}$};


    \draw[dashed] (4.3,0.5) rectangle (4.3,-2.0);
    \draw[dashed] (5.2,0.5) rectangle (5.2,-2);
    \draw[dashed] (5.8,0.5) rectangle (5.8,-2.);
    
    
    \node[align=center, below] at (5.2,2.3) {\(s_{i}+z+\ell'_k\)};
    \draw[->, thick] (5.2,2.0) -- (5.2,0.8);
    
        
        

        
    \end{tikzpicture}
    \caption{Compression for $w$ and $w'$ which $j<s_i$}
    \label{fig:case_2_a}
\end{figure}

         
        