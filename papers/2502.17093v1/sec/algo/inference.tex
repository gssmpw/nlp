\small
\caption{\small Mask2Alpha Inference}
\label{algo:inference}
\definecolor{codeblue}{rgb}{0.25,0.5,0.5}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codekw}{rgb}{0.85, 0.18, 0.50}
\lstset{
  backgroundcolor=\color{white},
  basicstyle=\fontsize{7.5pt}{7.5pt}\ttfamily\selectfont,
  columns=fullflexible,
  breaklines=true,
  captionpos=b,
  commentstyle=\fontsize{7.5pt}{7.5pt}\color{codegreen},
  keywordstyle=\fontsize{7.5pt}{7.5pt}\color{codekw},
  escapechar={|}, 
}
\begin{lstlisting}[language=python]
def infer(F, M_coarse, T):
  """
  F: image features from image encoder
  M_coarse: coarse mask, T: total iteration steps
  """
  
  # Initialize binary mask, 0 represents the coarse state
  x_t = [0]
  m_t = M_coarse
  
  for t in range(T, 0, -1):
    # Predict alpha and confidence map for current transition state
    confid_alpha, pred_alpha = iterate_decoder(F, m_t, x_t)
    
    # Sample transition state
    sample_xt = sample(confid_alpha)
    
    # Update current state and transition
    current_xt = update(sample_xt, x_t)
    m_t = current_xt * pred_alpha + (1 - current_xt) * m_t

  return pred_alpha  # Return predict alpha
\end{lstlisting}
