%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% File with macros and user defined commands
%
% @author: Angel Villar-Corrales
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amssymb}
\usepackage{amsmath}
%\usepackage{algorithm}% http://ctan.org/pkg/algorithms
%\usepackage[noend]{algpseudocode}
\usepackage{nth}
\usepackage[all]{nowidow}
\usepackage{bbm}
\usepackage{booktabs,etoolbox}
\usepackage{multirow}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{bbding}
\usepackage{overpic}
\usepackage{makecell}
\usepackage{enumitem}

\usepackage{tikz}
\usetikzlibrary{fit} 


\makeatletter
% Reinsert missing \algbackskip
%\def\algbackskip{\hskip-\ALG@thistlm}
\makeatother

\usepackage{array}
\usepackage{ragged2e}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{R}[1]{>{\RaggedLeft\arraybackslash}p{#1}}

\usepackage[export]{adjustbox}
\usepackage{arydshln}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% defined constants
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\overbar}[1]{\mkern 1.mu\overline{\mkern-1.mu#1\mkern-1.mu}\mkern 1.mu}

\usepackage{pifont}% http://ctan.org/pkg/pifont
\newcommand{\vmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%

\usepackage{amsmath}
\DeclareMathOperator*{\softmax}{softmax}

\newcommand{\TODO}{\textbf{\textcolor{red}{{TODO:~}}}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\COCVP}{\text{PlaySlot}}
\newcommand{\Method}{\text{PlaySlot}}

% Video Pred
\newcommand{\NumContext}{C}
\newcommand{\NumPreds}{T}
%\newcommand{\NumObjects}{N}
\newcommand{\NumFrames}{T}


% Images
\newcommand{\Images}{\mathbf{X}}
\newcommand{\PredImages}{\hat{\mathbf{X}}}
\newcommand{\ImageRange}[2]{\mathbf{X}_{#1:{#2}}}
\newcommand{\PredImageRange}[2]{\hat{\mathbf{X}}_{#1:{#2}}}
\newcommand{\Image}{\textbf{X}}
\newcommand{\PredImage}{\hat{\textbf{X}}}
\newcommand{\ImageT}[1]{\textbf{X}_{#1}}
\newcommand{\PredImageT}[1]{\hat{\textbf{X}}_{#1}}


% Slots
\newcommand{\Slots}{\mathbf{S}}
\newcommand{\SlotDim}{D_{\Slots}}
\newcommand{\NumSlots}{N_\Slots}
\newcommand{\PredSlots}{\hat{\mathbf{S}}}
\newcommand{\SlotsT}[1]{\textbf{S}_{#1}}
\newcommand{\PredSlotsT}[1]{\hat{\textbf{S}}_{#1}}
\newcommand{\SingleSlotsT}[2]{\textbf{s}_{#1}^{#2}}
\newcommand{\SinglePredSlotsT}[2]{\hat{\textbf{s}}_{#1}^{#2}}
\newcommand{\SlotsMany}[2]{\mathbf{S}_{#1:#2}}
\newcommand{\PredSlotsMany}[2]{\hat{\mathbf{S}}_{#1:#2}}



% Slot Attention
\newcommand{\FeatureMaps}{\textbf{h}}
\newcommand{\DimFeats}{D_h}
\newcommand{\NumLocs}{L}
\newcommand{\MLP}{\text{MLP}}
\newcommand{\GRU}{\text{GRU}}
\newcommand{\Attention}{\textbf{A}}
\newcommand{\OutSlotAttention}{\textbf{U}}
\newcommand{\SlotObject}[2]{\textbf{o}_{#1}^{#2}}
\newcommand{\SlotMask}[2]{\textbf{m}_{#1}^{#2}}
\newcommand{\ProcessedMask}[2]{\tilde{\textbf{m}}_{#1}^{#2}}


% Predictor
\newcommand{\NumPredLayers}{N_{\text{Pred}}}


% actions
\newcommand{\Action}{\textbf{a}}
\newcommand{\ActionT}[1]{\textbf{a}_{#1}}
\newcommand{\Actions}[2]{\textbf{a}_{#1:#2}}
\newcommand{\PredAction}{\mathbf{\hat{a}}}
\newcommand{\PredActionT}[1]{\mathbf{\hat{a}}_{#1}}
\newcommand{\PredActions}[2]{\mathbf{\hat{a}}_{#1:#2}}
%
\newcommand{\SceneDynamicsT}[1]{\textbf{d}_{#1}}
\newcommand{\MeanDynT}[1]{\boldsymbol{\mu_{\textbf{d}}}_{#1}}
\newcommand{\VarDynT}[1]{\boldsymbol{\sigma_{\textbf{d}}}^2_{#1}}


\newcommand{\ActionProto}{\textbf{p}}
\newcommand{\ActionProtoT}[1]{\textbf{p}_{#1}}
\newcommand{\ActionProtosMany}[2]{\textbf{p}_{#1:#2}}
%
\newcommand{\ActionVariability}{\textbf{v}}
\newcommand{\ActionVariabilityT}[1]{\textbf{v}_{#1}}
\newcommand{\ActionVariabilityMany}[2]{\textbf{v}_{#1:#2}}
%
\newcommand{\ActionEmbPred}{f_{\textbf{z}}}
\newcommand{\ActToken}{\texttt{[ACT]}}
%
\newcommand{\MeanT}[1]{\boldsymbol{\mu}_{#1}}
\newcommand{\VarT}[1]{\boldsymbol{\sigma}^2_{#1}}
\newcommand{\MeanActT}[1]{\boldsymbol{\mu_{\textbf{z}}}_{#1}}
\newcommand{\VarActT}[1]{\boldsymbol{\sigma_{\textbf{z}}}^2_{#1}}
\newcommand{\LatentT}[1]{\boldsymbol{z}_{#1}}
\newcommand{\LatentBig}{\boldsymbol{Z}}

\newcommand{\DimLatent}{{D_{\textbf{z}}}}
\newcommand{\PredLatent}{\mathbf{\hat{z}}}
\newcommand{\PredLatentT}[1]{\mathbf{\hat{z}}_{#1}}
\newcommand{\PredLatents}[2]{\mathbf{\hat{z}}_{#1:#2}}

\newcommand{\PredLatentBigT}[1]{\mathbf{\hat{Z}}_{#1}}
\newcommand{\PredLatentBigSingleT}[2]{\mathbf{\hat{z}}_{#1}^{#2}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Models
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\ImageEncoder}{\mathcal{E}_{\textrm{SAVi}}}
\newcommand{\SlotDecoder}{\mathcal{D}_{\text{SAVi}}}
\newcommand{\InverseDynamics}{\text{InvDyn}}
\newcommand{\InverseDynamicsSingle}{\text{InvDyn}_{\text{S}}}
\newcommand{\InverseDynamicsMany}{\text{InvDyn}_{\text{M}}}
\newcommand{\CondPred}{\text{cOCVP}}
\newcommand{\PolicyModel}{f_{\pi}}
\newcommand{\ActionDecoder}{\mathcal{D}_\textrm{a}}


\newcommand{\LinearSlots}{f_{\text{S}}}
\newcommand{\LinearProto}{f_{\text{p}}}
\newcommand{\LinearVar}{f_{\text{v}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Loss Functions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Loss}{\mathcal{L}}
\newcommand{\LossSAVi}{\mathcal{L}_{\text{SAVi}}}
\newcommand{\LossPlaySlot}{\mathcal{L}_{\text{PlaySlot}}}
\newcommand{\LossFunction}[2]{\mathcal{L}({#1},{#2})}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Datasets
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\ButtonPress}{ButtonPress}
\newcommand{\RobotDB}{BlockPush}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Makros General
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\def\N{{\mathbb N}}
\def\Z{{\mathbb Z}}
\def\Q{{\mathbb Q}}
\def\R{{\mathbb R}}
\def\C{{\mathbb C}}




% referencing figures, tables, equations and so on
\newcommand{\Figure}[1]{Fig.~\ref{#1}}
\newcommand{\FigColum}[1]{Column~\ref{#1}}
\newcommand{\FigColumss}[2]{Columns~\ref{#1}--\ref{#2}}
\newcommand{\Figures}[2]{Figs.~\ref{#1} and \ref{#2}~}
\newcommand{\Figuress}[2]{Figs.~\ref{#1}--\ref{#2}}
\newcommand{\SubFig}[1]{Subfig~\subref{#1}}
\newcommand{\SubFigure}[2]{Figure~\ref{#1}\,(#2)}
\newcommand{\SubFigures}[3]{Figure~\ref{#1}~(#2) and (#3)}
\newcommand{\SubFigureRange}[3]{Figure~\ref{#1}(#2)--(#3)}

\newcommand{\FigureStart}[1]{Fig.~\ref{#1}}
\newcommand{\SubFigureStart}[2]{Fig.~\ref{#1}(#2)}
\newcommand{\SubFiguresStart}[3]{Figures~\ref{#1}(#2) and \ref{#1}(#3)}

\newcommand{\Equation}[1]{Eq.~\eqref{#1}}
\newcommand{\Equations}[2]{Equations~\eqref{#1} and~\eqref{#2}}
\newcommand{\Table}[1]{Tab.~\ref{#1}}
\newcommand{\Tables}[2]{Tables~\ref{#1}~and~\ref{#2}}
\newcommand{\Section}[1]{Sec.~\ref{#1}}
\newcommand{\Sections}[2]{Sections~\ref{#1}~and~\ref{#2}}
\newcommand{\Sectionss}[2]{Sections~\ref{#1}--\ref{#2}}
\newcommand{\Subsection}[1]{Subsection~\ref{#1}}
\newcommand{\Subsections}[2]{Subsections~\ref{#1} and \ref{#2}}
\newcommand{\Chapter}[1]{Chapter~\ref{#1}}
\newcommand{\Chapters}[2]{Chapters~\ref{#1}~and~\ref{#2}}
\newcommand{\Appendix}[1]{Appendix~\ref{#1}}
\newcommand{\Appendices}[2]{Appendices~\ref{#1}~and~\ref{#2}}
\newcommand{\Algorithm}[1]{Algorithm~\ref{#1}}
\newcommand{\Step}[1]{Algorithm step~\ref{#1}}
\newcommand{\page}[1]{page~\pageref{#1}}


