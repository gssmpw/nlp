\section{Conclusion}

We present \sysname, a fine-grained, dynamic information flow control mechanism to safeguard Tool-based LLM Agents against both prompt injection and inadvertent privacy leaks. The mechanism selectively propagates only the relevant security labels, through the use of the LM-Judge and Attention-based screeners. The redaction of unused data enforces the information flow policy for all possible selective propagation. 

Empirically, we manage to curb malicious manipulations and detect undesirable confidential data disclosures. Notably, our evaluation on the AgentDojo benchmark shows that when under prompt injection attacks, the proposed RTBAS framework thwarts all policy-violating exploits with less than 2\% degradation to the agentâ€™s task utility. Similarly, our privacy leakage benchmark confirms RTBAS' ability to obtain near-oracle performance.

