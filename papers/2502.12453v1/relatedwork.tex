\section{Related work}
\label{releted work}
% \input{02_releted_work}
\subsection{Graph-based Molecular Property Prediction}
\label{subsection:releted_work_graph_based_MPP}

Graph-based methods are a mainstream approach for the few-shot molecular property prediction task. PAR \citep{wang2021propertyaware} and ADKF-IFT \citep{chen2023metalearning} employ GIN \citep{xu2018how} as the molecular encoder, while Meta-MGNN \citep{guo2021few} utilizes Pre-GIN \citep{hu2020strategies}. Meta-GAT \citep{lv2024meta} adopts GAT \citep{velivckovic2018graph} to learn molecular representations. However, these methods typically focus on single-scale molecular features and overlook the hierarchical nature of molecular structures \citep{altae2017low, ren2018meta, zhuang2023graph}.
In addition, several approaches \citep{zhao2023gimlet, liu2024moleculargpt} combine the strengths of Large Language Models (LLMs) to tackle the few-shot problem, but these methods often incur high computational costs.
Our method differs by incorporating molecular hierarchical structures through hierarchical pooling and matching, enabling more effective alignment of complex structures. 


\subsection{Matching Learning}
\label{matching_learning}

To address the few-shot learning problem, matching learning compares new instances with a small set of labeled examples to facilitate accurate predictions.
Common methods include Matching Networks \citep{vinyals2016matching}, ProtoNet \citep{snell2017prototypical}, Relation Networks \citep{sung2018learning}, and LGM-Net \citep{li2019lgm}.
While these methods perform well in Natural Language Processing (NLP) and Computer Vision (CV), they struggle with the inherent complexity of molecular graphs, which feature non-Euclidean structures and intricate relationships between nodes and edges. Hierarchical matching can mitigate this issue by capturing multi-level representations, but existing approaches still face limitations when applied to molecular data due to its unique topological complexity.
Specifically, 
AMN \citep{mai2019attentive} and SSF-HRNet \citep{zhong2023self}, despite their improvements in feature robustness and hierarchical relationships, struggle to fully represent global structural information and generalize across complex, varied molecular graphs.
Similarly, VTM \citep{kim2023universal} and HCL \citep{zheng2022few} integrate hierarchical matching with patch-level techniques in CV, but their effectiveness diminishes when handling the structural diversity of molecular graphs.
To overcome these challenges, our \method combines explicit intra-molecular hierarchical learning with attention mechanisms at atomic, substructural, and molecular levels, along with implicit task-level hierarchical learning via meta-learning, enhancing the modelâ€™s ability to capture task-specific molecular information and improve generalization.