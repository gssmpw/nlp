\subsection{Computational Results.}

\input{figure_1}


%\Rd{
%\begin{itemize}
%	\item Proposed framework implemented in 2D using Grasshopper, Rhinoceros 3D, and a custom plugin
%	\item Winding number computations from LibIGL
%	\item Computations on geographic datasets
%	\begin{itemize}
%		\item Mediterranean Sea/Chesapeake derived from a valid original mesh
%		\item Invalid Chesapeake Bay from a lot of disjoint edges
%	\end{itemize}
%	\item Discuss that desire to conform to geographic features informs choice of volume fraction, as does background mesh size
%\end{itemize}
%}

\briancode\ was developed and evaluated using a custom plugin to Rhinoceros 3D and Grasshopper.
Winding numbers were computed using libigl \cite{jacobson2013libigl}.
Persistent homology was computed using Aleph \cite{aleph}, which is based on PHAT \cite{Bauer:2017}.
%Here we developed a custom plugin that took the input geometry and the user defined number of test points and volume fraction threshold. The volume fractions were determined using winding number computations from LibIGL. It output a quadrilateral mesh, the homology of which was then computed {\Rd (in aleph if we get it working by then)} on it's dual.  

The framework is tested on a 2D model of Chesapeake Bay\footnote{Model derived from \url{https://vecta.io/symbols/281/ecosystems-maps/93/usa-md-va-chesapeake-bay-line-map}} with boundary errors, a 3D model of mechanical bearings \footnote{Model provided at \url{https://ten-thousand-models.appspot.com/detail.html?file_id=1716283}}, and a 3D graphics model of \emph{The Bronco Buster}\footnote{Model provided at \url{https://tinyurl.com/4cmrptev}}.
Snapshots of meshes given computed volume fractions are shown in \cref{fig:volfrac_chesapeake,fig:bearings,fig:cowboy}.
Model errors for the Chesapeake Bay include overlapping edges, repeated/offset edges, and numerous gaps.
Despite the ``interior'' of the bay being ill-defined, the proposed method still captures the intended geographic domain with respect to both the continent and to islands.
A complete view of the homological structure based on varying the volume fraction for the Chesapeake Bay is shown in \cref{fig:persistence_diagram}, while similar persistence diagrams for the volumetric models are shown in \cref{fig:ph_diagrams}.
% \cref{fig:persistence_diagram,fig:bearings_ph_diagram}.
Results demonstrate that a mesh with the desired homological structure could be extracted from the background grid by selecting the correct threshold. 
These figures are primarily for illustrative purposes: we purposely chose a coarse grid size to generate the topological issues we are addressing. 
In practice, a finer grid would better capture local behavior.

\begin{figure}
\centering
\includegraphics[trim=30cm 0cm 23.5cm 0cm, width=0.48\columnwidth,clip]{original_mesh_new.png}
\hfill
\includegraphics[trim=30cm 0cm 23.5cm 0cm, width=0.48\columnwidth,clip]{mended_mesh_new.png}
\caption{Meshes of Chesapeake bay with subcells and anti-aliasing are shown. Interior vertices and edges are shown as blue outlined circles and purple lines respectively, while removed faces are shown in black (left). Connecting and separating templates are in red (right). %{\Rd move to results, use simple figures 3 and 4 in the methodology section instead.}
}
\label{fig:antialiasing}
\end{figure}
%\input{sections/latex_figures/figure_4}
%\input{sections/latex_figures/figure_5}
%\input{sections/latex_figures/figure_6}

\begin{figure}
\centering
\subfloat[Time step: 0]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time0.png}}
\subfloat[Time step: 50]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time5.png}}
\subfloat[Time step: 100]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time10.png}}
\\
\subfloat[Time step: 200]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time20.png}}
%\subfloat[Time step: 300]{
%	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{fea_results/time30.png}}	
\subfloat[Time step: 400]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time40.png}}
%\subfloat[Time step: 600]{
%	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{fea_results/time60.png}}
\subfloat[Time step: 800]{
	\includegraphics[trim=13cm 3cm 4cm 3cm, width=0.3\columnwidth,clip]{time80.png}}
\caption{A finite element solution of contaminant propogation is displayed on a \briancode\  mesh of the Chesapeake Bay.}
\label{fig:fea}
\end{figure}

\paragraph{Anti-aliasing.}
%\Cref{fig:mended_jaggies} demonstrates that anti-aliasing can connect islands in an archipelago, resolving a thin region consistently.
%\Cref{fig:diagonal_mended} demonstrates that anti-aliasing can avoid pinches, resolving a gap consistently.
%{\Rd Should we move \cref{fig:mended_jaggies,fig:diagonal_mended} to the methodology as part of \cref{fig:diagonal_subcells,fig:jaggies_subcells} to demonstrate it on a simple example there. And in our results use just the Chesapeake Bay?}
\Cref{fig:antialiasing} demonstrates the anti-aliasing technique on a mesh of the Chesapeake Bay to resolve both pinches and archipelagos.
The anti-aliased mesh is analysis suitable, which is illustrated through a simulation of contaminant propagation, e.g. an oil spill, on a refined version of the Chesapeake Bay in \cref{fig:fea}.
Simulations were performed using MFEM \cite{mfem,mfem-web}.

%\input{sections/latex_figures/figure_8}
%\input{sections/latex_figures/figure_9}


\subsection{Anti-aliasing Guarantees and Limitations.}

As noted in Section \ref{sec:rasterization}, one of the primary difficulties with volume fraction-based meshing methods is mitigating the effects of rasterization (i.e.\ choice of orientation and sample size) through topological anti-aliasing.
The following theoretical result holds regarding the success of the proposed anti-aliasing methods in mitigating topological rasterization.
 A proof of the result can be found in the appendix this document.
\begin{theorem}
Given a rectangular lattice in $\mathbb{R}^2$ with characteristic length $\ell$ overlaying two parallel half-spaces separated by a length of $L$, topological rasterization may occur when $\ell(\sqrt{2}-1)<L\leq\ell$.
For the subgrid sampling scheme proposed in this text, topological rasterization may only occur when $\ell(\sqrt{2}-1)<L<\frac{\sqrt{2}\ell}{2}.$
Finally, topological rasterization due to changes in orientation cannot be resolved for $L$ such that $\ell(\sqrt{2}-1)<L<\frac{\ell}{2}.$
\end{theorem}


%\begin{itemize}
%	\item Discuss theoretical issues regarding aliasing under variations in rotations
%	\begin{itemize}
%		\item Maximal values are when centroid of the cell intersects centroid of the domain of interest
%		\item Minimal values are those in which cell moves perpendicular to the centroid of the object
%	\end{itemize}
%	\item Discuss theoretical guarantees on aliasing with and without the subgrid sampling
%	\begin{itemize}
%		\item Guarantees on no aliasing without subgrid sampling
%		\item Guarantees on no aliasing with subgrid sampling
%	\end{itemize}
%\end{itemize}
