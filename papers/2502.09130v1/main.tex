\documentclass{article} % For LaTeX2e

\usepackage{geometry}
\geometry{a4paper, scale=0.75}
\usepackage{natbib}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts

\usepackage{titletoc}
\usepackage[toc, page, header]{appendix} %%% MAKE SURE TO PUT THIS BEFORE hyperref PACKAGE

\usepackage[colorlinks=true, linkcolor=blue, citecolor=blue,urlcolor=black]{hyperref}
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{footnote}
% \usepackage{microtype}
\usepackage{graphicx}
% \usepackage{subfigure}
\usepackage{subcaption}
\usepackage{booktabs} % for professional tables

% tables
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{arydshln}
\setlength\dashlinedash{0.4pt}
\setlength\dashlinegap{2pt}
\setlength\arrayrulewidth{0.4pt}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}

\usepackage{comment}
\usepackage{bm}
\usepackage{bbm}
\usepackage{enumitem}
\setitemize{leftmargin=*}
\setenumerate{leftmargin=*}

% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}
\newcommand{\alglinelabel}{%
  \addtocounter{ALC@line}{-1}% Reduce line counter by 1
  \refstepcounter{ALC@line}% Increment line counter with reference capability
  \label% Regular \label
}
\usepackage{algorithm}
\usepackage[noend]{algorithmic}
\renewcommand{\algorithmiccomment}[1]{ \hfill $\triangleright$ {\color{blue} #1}}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\allowdisplaybreaks
\renewcommand\topfraction{0.85}
\renewcommand\bottomfraction{0.85}
\renewcommand\textfraction{0.1}
\renewcommand\floatpagefraction{0.85}

\renewcommand{\tilde}{\widetilde}
\renewcommand{\hat}{\widehat}
\renewcommand{\bar}{\overline}
\renewcommand{\O}{\operatorname{\mathcal O}}
\newcommand{\Otil}{\operatorname{\tilde{\mathcal O}}}

\usepackage{cleveref}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{remark}[theorem]{Remark}

\Crefname{ALC@line}{Line}{Lines}
\Crefname{assumption}{Assumption}{Assumptions}
\Crefformat{equation}{Eq. #2(#1)#3}
\Crefrangeformat{equation}{Eqs. #3(#1)#4 to #5(#2)#6}
\Crefmultiformat{equation}{Eqs. #2(#1)#3}{ and #2(#1)#3}{, #2(#1)#3}{ and #2(#1)#3}
\Crefrangemultiformat{equation}{Eqs. #3(#1)#4 to #5(#2)#6}{ and #3(#1)#4 to #5(#2)#6}{, #3(#1)#4 to #5(#2)#6}{ and #3(#1)#4 to #5(#2)#6}
\newcommand{\creflastconjunction}{, and\nobreakspace}

\newenvironment{tightcenter}{%
\setlength\topsep{2pt}
\setlength\parskip{0pt}
\begin{center}
}{%
\end{center}
}

% \newcommand{\longbo}[1]{{\color{red}  [\text{Longbo:} #1]}}
% \newcommand{\daiyan}[1]{{\color{violet} [\text{Yan:} #1]}}
% \newcommand{\yu}[1]{{\color{cyan}  [\text{Yu:} #1]}}
% \newcommand{\jiatai}[1]{{\color{magenta}  [\text{Jiatai:} #1]}}

\input{math_commands}
\newcommand{\EX}{\mathbb{E}}
\newcommand{\pll}{\kern 0.56em/\kern -0.8em /\kern 0.56em} 
\newcommand{\defeq}{\overset{\underset{\triangle}{}}{=}}
\newcommand{\Hesse}{\text{Hess}}
\newcommand{\sgn}{\text{sgn}}
\newcommand{\T}{\text{T}}
\newcommand{\holder}{H{\"o}lder's inequality}
\newcommand{\Span}{\text{span}}
\newcommand{\weakto}{\rightharpoonup}
\newcommand{\lloc}{L_{\text{loc}}}
\newcommand{\supp}{\text{supp}}
\newcommand{\dd}{\textnormal{d}}

\newcommand{\longbo}[1]{\textcolor{red}{[\text{Longbo:} #1]}}
\newcommand{\yu}[1]{{\color{cyan}[\text{Yu:} #1]}}
\newcommand{\rui}[1]{{\color{purple}[\text{Rui:} #1]}}
\newcommand{\yuhaoDone}{{\color{green}  [\text{Done}]}}

\usepackage{pifont}
\newcommand{\cmark}{{\color{green!70!black}\ding{51}}}%
\newcommand{\xmark}{{\color{red!70!black}\ding{55}}}%
\newcommand{\adv}{{\color{green!70!black}\textbf{Adv.}}}%
\newcommand{\stoc}{{\color{red!70!black}\textbf{Only Stoc.}}}%
\newcommand{\advred}{{\color{red!70!black}\textbf{Only Adv.}}}%
\newcommand{\stocgreen}{{\color{green!70!black}\textbf{Stoc.}}}%

\newcommand{\Clip}{{\text{clip}}}
\newcommand{\Skip}{{\text{skip}}}

\title{
Finite-Time Analysis of Discrete-Time Stochastic Interpolants
}

% \usepackage{authblk}
\author{
Yuhao Liu \thanks{IIIS, Tsinghua University. Email: \texttt{liuyuhao21@mails.tsinghua.edu.cn}.}
\and
Yu Chen \thanks{IIIS, Tsinghua University. Email: \texttt{chenyu23@mails.tsinghua.edu.cn}.}
\and
Rui Hu \thanks{IIIS, Tsinghua University. Email: \texttt{hu-r24@mails.tsinghua.edu.cn}.}
\and
Longbo Huang \thanks{IIIS, Tsinghua University. Email: \texttt{longbohuang@tsinghua.edu.cn}. Corresponding author.}
}
\date{}

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}


\begin{document}
\maketitle


\begin{abstract}
The stochastic interpolant framework offers a powerful approach for constructing generative models based on ordinary differential equations (ODEs) or stochastic differential equations (SDEs) to transform arbitrary data distributions. However, prior analyses of this framework have primarily focused on the continuous-time setting, assuming a perfect solution of the underlying equations. In this work, we present the first discrete-time analysis of the stochastic interpolant framework, where we introduce an innovative discrete-time sampler and derive a finite-time upper bound on its distribution estimation error. Our result provides a novel quantification of how different factors, including 
the distance between source and target distributions and estimation accuracy, affect the convergence rate and also offers a new principled way to design efficient schedules for convergence acceleration. Finally, numerical experiments are conducted on the discrete-time sampler to corroborate our theoretical findings. 
\end{abstract}

\input{tex_file/introduction}
\input{tex_file/preliminaries}
\input{tex_file/results}
\input{tex_file/schedules}
\input{tex_file/experiments}
\input{tex_file/conclusion}

\bibliographystyle{apalike}
\bibliography{ref}

\newpage
\appendix
% \renewcommand{\appendixpagename}{\centering \LARGE Supplementary Materials}
\appendixpage

% \begin{itemize}
%     \item \textbf{Appendix \ref{appendix:preliminaries}: Supplementary details for Section \ref{sec:preliminaries}} - This section provides additional details from \cite{interpolation} that were not included in Section \ref{sec:preliminaries}. It includes a formal statement of key equations and their associated conditions. Furthermore, it outlines the optimization objectives for the score and velocity estimators, which are used for model training in Section \ref{sec:experiments}.  %\longbo{explain why we need them}
    
%     \item \textbf{Appendix \ref{appendix:lemmas}: Useful lemmas in bounding derivatives} - This section presents lemmas that are essential for bounding the derivatives of velocity functions and score functions, along with their corresponding proofs. The proofs primarily rely on properties and inequalities related to (conditional) expectations. These lemmas play a crucial role in deriving the overall KL error bounds.
    
%     \item \textbf{Appendix \ref{appendix:overall}: Proofs of results in Section \ref{sec:results} and \ref{sec:instance}} - This section provides the complete proofs for the results presented in Section \ref{sec:results} and Section \ref{sec:instance}. This includes the proof of \Cref{thm:main} (\Cref{appendix:proofofmain}), the proof of \Cref{cor:schedule} and \Cref{cor:instant} (Appendices \ref{appendix:proofofcor},\ref{appendix:proofofschedule}), and additional details regarding the discussions in Section \ref{sec:instance} (Appendix \ref{appendix:another}).

%     \item \textbf{Appendix \ref{appendix:experiments}: More details of numerical experiments} - This section provides omitted details for Section \ref{sec:experiments}, including the parameterization of estimators, choice of $(t_0,t_N)$ and optimizers, and how the TV distance is estimated. We also include additional experiments for $\gamma(t)=\sqrt{(1-t)^2t}$.
% \end{itemize}


\startcontents[section]
\printcontents[section]{l}{1}{\setcounter{tocdepth}{2}}
\newpage


\input{tex_file/appendix_notations}
\input{tex_file/appendix_sde}
\input{tex_file/appendix_bounds}
\input{tex_file/appendix_mainproof}
\input{tex_file/appendix_experiments}

\end{document}
