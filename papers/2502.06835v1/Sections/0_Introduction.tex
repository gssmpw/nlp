\section{Introduction}

% Medication adherence is critical for improving health outcomes, especially for patients with severe conditions. 
For patients who have 
undergone allogeneic \textbf{hematopoietic stem cell transplantation (HCT)}, strict adherence to medication regimens, such as prophylactic immunosuppressant therapy (i.e., calcineurin inhibitors, such as tacrolimus or cyclosporine, taken twice-daily), is crucial for mitigating the risk of acute graft-versus host disease (GVHD) \cite{gresch2017medication}. Acute GVHD occurs in 50-70\% of patients following HCT. A lower medication adherence (60\%) rate is shown to associate with higher severity of GVHD \cite{kirsch2014differences}.

The challenges of adherence management are amplified among \textbf{adolescents and young adults (AYAs)}, 
%a medically underserved cancer cohort 
who often demonstrate poorer medication adherence \cite{psihogios2020needle,psihogios2022social,lyons2018theory}. For AYAs with cancer, self-management rarely involves the individual alone. Instead, up to 73\% of family care partners bear the primary responsibility for managing cancer-related medications for AYAs \cite{psihogios2020adherence}. 
% Many of these dyads express a desire to move toward sharing these responsibilities \cite{psihogios2020adherence}. This \textbf{dyadic structure} motivates us to design novel interventions that support not only the individuals in the dyads but also the dyadic relationship between the AYA and the care partner.

Many of these dyads express a desire to move toward sharing these responsibilities with each other \cite{psihogios2020adherence}. Indeed, for AYAs with chronic health conditions, this developmental period often marks a shift from relying solely on a caregiver to taking more personal responsibility for health care. While shifts in autonomy versus dependence and navigating the ensuing family conflict that can arise from these new dynamics are normative parts of AYA development, difficult family interactions can have a detrimental impact on medication adherence. For example, in a meta-analysis \cite{psihogios2019family}, higher level of family conflict and lower levels of family cohesion were significantly associated with worse medication adherence across pediatric illnesses and age groups. 
% \sam{this is about general, not digital intervention development.  I deleted to tighten up the exposition} These dyadic processes that impact medication adherence motivates us to design novel interventions that support not only the individuals in the dyads but also the dyadic relationship between the AYA and the care partner.


% why digital interventions and RL?
After being discharged from the hospital, both individuals in the dyad face significant emotional and physical challenges as they adjust to managing medication regimens \textit{outside the hospital environment}.
% Care partners often face a myriad of challenges as they navigate the demands of their paid jobs with unpaid caregiving responsibilities \cite{reinhard2008supporting}. Those who shoulder heavy caregiving responsibilities at home face higher physical and emotional stressors, which can impede their ability to provide effective care, make sound decisions, and even manage self-care. 
For AYAs, the daily challenges of managing complex medication regimens, coping with treatment side effects, coping with stress, and maintaining normal activities in the context of a complex medical regimen can create distress in their home environment. Similarly, care partners must balance caregiving responsibilities with their personal obligations. Those who shoulder heavy caregiving responsibilities at home face higher physical and emotional stressors, which can impede their ability to provide effective care, make sound decisions, and support their AYA's  self-care \cite{reinhard2008supporting}.


This need for support outside the inpatient environment motivates the development of interventions that leverage \textbf{digital technologies} such as mobile devices \cite{uribe2023effectiveness}.
% , such as positive psychology messages through mobile apps 
Digital interventions are promising for supporting both AYAs and care partners \textit{at home} on a daily basis, compared to traditional clinical support delivered with limited frequency (e.g., weekly clinical visits for post-HCT AYAs). There is strong heterogeneity across dyads and the users' context are constantly changing, which makes it important to personalize the intervention delivery to optimize the effectiveness of digital interventions.
% To optimize the effectiveness of digital interventions, it is important to personalize the intervention delivery based to the user's changing context and the heterogeneity. 
% \ziping{Billie: The justification for personalization and what the term means require more clarity } 
Reinforcement Learning (RL), a machine learning technique that adaptively learns the optimal behavior in an unknown environment to maximize cumulative rewards, is a promising approach for achieving this personalization.
% by adaptively learning from interactions with users. \ziping{Billie: This definition seems too broad to me, but maybe this is ok for this audience? Iâ€™m not sure...} 
RL has been successfully applied in a variety of digital interventions \cite{liao2020personalized,battalio2021sense2stop,trella2024deployed,ghosh2024miwaves}.

% Why personalized: people habituate. Have to be more thoughtful about providing supports. So personalization/adaptation is about managing the burden. 

In this paper, we describe our work in developing an RL algorithm for ADAPTS-HCT \cite{shani2024tips}. ADAPTS-HCT is a digital intervention for improving medication adherence by AYAs  over 100 days after receiving HCT. ADAPTS-HCT integrates three components: (1) twice-daily messages promoting positive emotions for the AYA, (2) daily messages focusing on coping and self-care strategies for the care partner, and (3) a weekly collaborative game for improving their relationship \cite{shani2024tips}. \textit{We call the three components AYA, care partner, and relationship component}, respectively. Table \ref{tab:interventions} summarizes these components. The fully developed intervention package will be evaluated in the upcoming clinical trial.
%, the ADAPTS-HCT Study. 
% RL algorithm is designed to personalize the delivery of these interventions to optimize their effectiveness.
% in terms of the feasibility, stability, autonomy of the algorithm, acceptability of interventions, and usability of the app.
% upcoming studies


% \ziping{Mention this when we talk about that this is for an upcoming clinical trial. About the feasibility, stability, autonamy of the algorithm. Acceptability of the intervention. Usability of app.}

% \vspace{-8mm}

\begin{table}[h]
\centering
\caption{Intervention components in ADAPTS-HCT}
\begin{tabular}{c|c}
\hline
\textbf{Component} & \textbf{Intervention} \\
\hline
AYA & Twice-daily positive psychology messages \\
\hline
Care partner & Daily positive psychology messages \\
\hline
Relationship & \makecell[c]{Weekly collaborative game designed to facilitate\\ positive dyadic interpersonal relationship}\\
\hline
\end{tabular}
\label{tab:interventions}
\end{table}

% \vspace{20mm}

\textbf{Goals.} Our goal is to design an RL algorithm that can personalize the delivery of these interventions to optimize their effectiveness. Given the complexity of the dyadic structure, we identify the following two key challenges:

% Challenge 1: incorperating domain knowledge into the RL algorithm and reward engineering to reduce noise

% Challenge 2: mutiple intervention compoent each operating at different time scale. We develop a MARL algorithm where each agent operates at different time scale. 

% Challenge 3: interpretability. We take advantage of the MARL, so each agent is easier to interpret. we use relatively simple model. 

\begin{enumerate}
% \item \textbf{Incorporating domain knowledge }

% \item \textbf{Accelerating learning in noisy, data-limited settings.} Early-recruited dyads have limited available data, while the observations are inherently noisy due to the variability of human behaviors. Developing an algorithm that can learn quickly in such conditions is critical to benefit as many dyads as possible.
% \hinal{Alternate Challenge 1: Incorporate domain knowledge into the RL algorithm and reward engineering to reduce noise}
\item \textbf{Managing multiple intervention decisions across different multi-scales.} There are three intervention components, each requiring decisions to be made at a different time scales. 
The decision-making occurs twice daily for AYAs, daily for care partners, and weekly for the relationship component. Making decisions on multiple timescales complicates the  algorithm design.
\item \textbf{Accelerating learning in noisy, data-limited settings.} 
Observed data in  digital intervention deployment is quite noisy \cite{trella2022designing}. Furthermore, limited data will be available to support in decision making for dyads recruited early in the clinical trial.  %will have limited available data. 
Additionally, less data is available for learning  decisions that occur at slower timescales. These factors necessitate a sample-efficient algorithm that learns faster given limited data.
%  Incorporating the expertise of domain scientists, and designing custom reward functions to each component are handy for reducing noise in such environments.  

% \item \textbf{Interpretability.} Interpretability is essential for domain experts to evaluate the algorithm's rationale, incorporate domain knowledge for algorithm design. Additionally, interpretable algorithms are more likely to be adopted in real clinical practice, where trust and understanding are important.
\end{enumerate}

% \ziping{Novel setting is the social network.}
% \ziping{Leave out hierarchical}

% \ziping{Directly reference the challenges.}

% \vspace{-3mm}

\subsubsection{Contribution.} Our contribution is a novel  multi-agent RL (MARL) framework involving three RL agents, where each agent is responsible for making decisions for one specific intervention component and operates at the timescale corresponding to its intervention component timescale, which directly addresses challenge (1) about multi-scale decision-making.
% Each agent operates at its respective time scale (twice-daily, daily, and weekly), which directly addresses challenge (1). 

The use of MARL decouples the decision processes of different intervention components, thus  improving  interpretability of the agent model design. This improved interpretability allows us to incorporate domain knowledge into the agent-specific algorithm designs to address challenge (2). To further accelerate learning, we propose a novel \textbf{reward engineering} method that learns a less noisy surrogate reward function for each component. Through evaluation in a carefully designed dyadic environment, we demonstrate both the superior performance of our proposed algorithm and strong collaborative behavior among the three agents. Lack of collaboration is often a critical issue in MARL \cite{oroojlooy2023review}.
% \sam{it would be great if we have a cite for this.} 

% In the meantime, MARL decouples the decision processes of different intervention component, which improves interpretability and allows us to incorporate domain knowledge into the agent-specific algorithm designs. 
% allowing agent-specific designs, such as tailored \textbf{reward functions} based on domain knowledge, to faciliatate faster learning and reduce noise. 
% Second, it enhances interpretability by decoupling the decision-making processes of individual agents.


% This addresses challenge (2) because it enables us to take advantage of domain expertise in designing the reward function and, hence, reduces noise. Along the way, the reward engineering also enhance collaboration, which accounts for the potential non-collaboration among three agents that may arise from multiple, individual agents.   
% , which accounts for the potential non-collaboration among three agents.
% We note further that the implementation of domain knowledge into the surrogate functions is enabled through the multi-agent choice because it decouples the decision making and provides an interpretability advantage that facilitates communication with the domain experts to obtain said knowledge. 


% \ziping{Use the reward engineering (reduce noise).}

% The interpretability not only clarifies the algorithm's rationale but