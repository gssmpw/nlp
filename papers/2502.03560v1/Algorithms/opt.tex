\begin{algorithm}
    \caption{Joint Optimization of Parameters}\label{alg:opt}
    \begin{algorithmic}[1]
    \Require Define the search space of parameters to optimize.
    \newline $\mathcal{X}_{r}$: search space of reward parameters; 
    \newline$\mathcal{X}_{model}$: search space of model parameters; 
    \newline$\mathcal{X}_{human}$: search space of human parameters.
    % $f$ : objective function
    \While{\textit{outer loop}: optimal $r^*$ and $\boldsymbol{\theta}_{model}^*$ has not been found}
    \State Jointly select $r \in \mathcal{X}_{r}$ and $\theta_{model} \in \mathcal{X}_{model}$ using Bayesian optimization.
    \State Train model $\mathcal{M}(\theta_{model})$ with $r$, $\theta_{policy}$ and $\theta_{human} \in \mathcal{X}_{human}$ randomly sampled in each training episode.
    \While{\textit{inner loop}: optimal $\boldsymbol{\theta}_{human}^*$ has not been found}
    \State Select parameters $\theta_{human} \in \mathcal{X}_{human}$ via Bayesian optimization
    \State Sample $n$ typing episodes ($\boldsymbol{\tau}_1$, $\boldsymbol{\tau}_2$, ..., $\boldsymbol{\tau}_{n}$) from the model $\mathcal{M}(\boldsymbol{\theta}_{env};\boldsymbol{\theta}_{human})$
    \State Compute the metrics $Metrics(\boldsymbol{\tau}_1, \boldsymbol{\tau}_2, ..., \boldsymbol{\tau}_{n})$ 
    \State Evaluate with human data: $JS(Metrics(\boldsymbol{\tau}_1, \boldsymbol{\tau}_2, ..., \boldsymbol{\tau}_{n}), Metrics({h}_1, {h}_2, ..., {h}_{n}))$ 
    \EndWhile
    %\State Sample $n$ typing episodes ($\boldsymbol{\tau}_1$, $\boldsymbol{\tau}_2$, ..., $\boldsymbol{\tau}_{n}$) from the model $\mathcal{M}(\boldsymbol{\theta}_{env};\boldsymbol{\theta}^*_{human})$
    %\State Compute the metrics $Metrics(\boldsymbol{\tau}_1, \boldsymbol{\tau}_2, ..., \boldsymbol{\tau}_{n})$ 
    %\State Evaluate with human data: $JS(Metrics(\boldsymbol{\tau}_1, \boldsymbol{\tau}_2, ..., \boldsymbol{\tau}_{n}), Metrics({h}_1, {h}_2, ..., {h}_{n}))$ 
    \EndWhile
    \State \textbf{return}: general model $\mathcal{M}(\boldsymbol{\theta}^*_{model})$, and user-fitted parameters $\boldsymbol{\theta}^*_{human}$
    \end{algorithmic}
\end{algorithm}