\section{Experiments}
\vspace{-1em}
We run two sets of experiments with the aim of answering two questions. 
Our first goal is to understand the extent to which our algorithms are able to compute inverse Nash equilibria, if any, beyond our theoretical guarantees.
%characteristics of a game that make it more likely for our algorithms to find its true parameters, and understand how far beyond our theory our algorithms can be successful at computing inverse Nash equilibria. 
Our second goal is to understand the ability of game-theoretic models to make predictions about the future.%
\footnote{Our code can be found \href{https://anonymous.4open.science/r/Generative-Adversarial-Inverse-Multiagent-Learning-ICLR2024-1C2C/}{here}. \amy{EXPIRED!}}

\begin{wrapfigure}{R}{0.4\textwidth}
    \centering
    \vspace{-1cm}
    \includegraphics[scale=0.5]{figures/electricity_market.png}
    \caption{Hourly prices in the Spanish electricity market from January 2015 to December 2020. The Nash simulacrum achieves a MSE that is twice as low as that of the ARIMA method.}
    \label{fig:electricity_market}
    \vspace{-0.5cm}
\end{wrapfigure}

In our first set of experiments, we consider five types of economic games whose equilibria and payoffs have different properties. 
The first three are Fisher market (FM) games, which are zero-sum, between sellers and buyers engaged in trading goods.
%seeking to maximize profits and buyers seeking to maximize utilities. 
These games can be categorized based on the buyers' utility functions as linear, Cobb-Douglas, or Leontief \citep{fisher-tatonnement}.
We then consider two general-sum economic games, which model competition between two firms, namely Cournot competition and Bertrand oligopoly.
% 
When budgets are the only parameters we seek to recover, our min-max formulation is convex-concave, because the players' payoffs are concave in their actions, and affine in their budgets, and hence the regret of players is also affine in the players' budgets. 
In addition, in both the Cournot competition and Bertrand oligopoly games, regret is again convex in the parameters of the game. 
Finally, all the games we study are concave, with the exception of the Bertrand oligopoly game, and the equilibria are unique in the Cobb-Douglas FM, Cournot competition, and Bertrand oligopoly games. 
%
In each experiment, we generate 500 synthetic game instances, for which the true parameters are known, and use \Cref{alg:gda} (which does not rely on this knowledge) to compute an inverse NE for each.
We record whether our algorithm recovers the true parameters of the market and whether it finds an inverse NE (i.e., average exploitability).
%
We summarize our findings for the FM games in \Cref{table:both}.
We find that our algorithm recovers the true parameters more often when budgets are the only parameters we seek to recover, as opposed to both budgets and types;
%But even though our min-max formulation is non-convex-concave 
but even in non-convex-concave case, our algorithm is still able to approximate inverse NE over 80\% of the time. 
In settings where the equilibria are unique, we recover true parameters most often, while the worst performance is on Leontief FM games, where payoffs are not differentiable. 

%Finally, for Leontief FM games, we note that the payoff functions are not Lipschitz-smooth. \sadie{Already mentioned can delete?}

\begin{table}[H]
    \centering
    \input{data/fisher_table}
    \input{data/cournot_bertrand_table}
    \caption{The percentage of games for which we recovered the true parameters and the average exploitabilities of the observed equilibrium evaluated w.r.t\@ the computed inverse Nash equilibrium.}
    %in Fisher, Cournot, and Bertrand markets.
    \label{table:both}
    \vspace{-1em}
\end{table}

In our second set of experiments, we model the Spanish electricity market as a stochastic Fisher market game between electricity re-sellers
%\amy{interesting! so supply is fixed!, as is assumed in FMs, since these guys are not generators?} \deni{Yes!} 
and consumers.
%re-sellers seek prices that maximize their profits, and consumers choose electricity loads so as to maximize their utilities. 
In this game, the state comprises the supply of each good and the consumers' budgets, while the re-sellers' actions are to set prices in today's spot market and tomorrow's day ahead market, and the consumers' actions are their electricity demands.
We assume the consumers utilities are linear; this choice is suited to modeling the substitution effect between electricity today and electricity tomorrow.
%\amy{does this mean utility is a weighted sum of electricity consumed today and electricity consumed tomorrow? and is our goal to learn these weights?} \deni{yes!}
%\amy{and what about budgets? are they also inferred? if so, are they useful at all? or does everyone just spend their entire budget?} \deni{They are useful, everyone either saves or spends entirely their budget.}
Using publicly available hourly Spanish electricity prices and aggregate demand data from \href{https://www.kaggle.com/datasets/nicholasjhana/energy-consumption-generation-prices-and-weather}{Kaggle}, we compute a simulacrum of the game that seeks to replicate these observations
%observed prices and aggregate demands of the consumers 
from January 2015 to December 2016. 
We also train an ARIMA model on the same data, and run a hyperparameter search for both algorithms using data from January 2017 to December 2018. 
After picking hyperparameters, we then retrain both models on the data between January 2015 to December 2018, and predict prices up to December 2018. 
We also compute the mean squared error (MSE) of both methods using January 2018 to December 2020 as a test set.
We show the predictions of both methods in \Cref{fig:electricity_market}. 
To summarize, we find that the simulacrum makes predictions whose MSE is twice as low.

% \begin{table}[H]
%     \centering
%     \begin{minipage}{0.6\linewidth}
%     \resizebox{1\columnwidth}{!}{%
%     \begin{tabular}{|l|c|c|c|c|c|c|}\hline
%      Parameters of the Game & \multicolumn{3}{|c|}{Budgets} & \multicolumn{3}{|c|}{Types + Budgets} \\\hline 
%        Type of Game& Linear FM
%        & Leontief FM
%        & CD FM
%         & Linear FM
%         & Leontief FM
%         & CDs FM \\ 
%      \hline
%      \% Parameters Recovered 
%      & 100\% & 36.8\% & 100\% 
%      & 12\% & 1\% & 99.6\% \\
%      \hline
%       Average Exploitability 
%      & 0.0018 & 2.2240 & 0.0004
%      & 0.0119& 0.1949 & 0.0004 \\
%      \hline
%      \end{tabular}
%      }
%  \end{minipage}
%  \begin{minipage}{0.3\linewidth}
%     \begin{tabular}{ |l|c|c|  }
% \hline
%  &Cournot &Bertrand\\
% \hline
% \%Parameters Recovered
% &95.2\% &78\%\\
% \hline
% Average  Exploitability
% &1.9949 &0.0011\\
% \hline
% \end{tabular}
% \end{minipage}
% % }
% % \caption{The percentage of models that we could recover the true parameters for and the average exploitability of the observed equilibrium evaluated under the computed inverse Nash equilibrium in the Cournot games and Bertrand games.}
%     \caption{Caption}
%     \label{tab:my_label}
% \end{table}



% \newpage
% \subsection{Synthetic Data Experiments}



% \subsection{Market experiments}
% In most real life scenarios, instead of having direct accesses of market parameters (e.g., budgets of buyers, supplies of goods, and costs of productions), we could only observe market outcomes. With tools of inverse game theory, by modeling some markets as games, we should be able to retrieve true parameters of these markets given the observed market outcomes. \sadie{Need to be reword. Just want to provide a brief motivation for all market experiments.}
