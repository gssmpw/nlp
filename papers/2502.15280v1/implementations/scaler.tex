%\begin{figure}[ht]
\begin{lstlisting}[
    language=Python,
    caption={A JAX implementation of Scaler (Section~\ref{subsection:init_and_update})},
    label={implementation:scaler}
]
import flax.linen as nn

class Scaler(nn.Module):
    dim: int
    init: float
    scale: float

    def setup(self):
        self.scaler = self.param(
            nn.initializers.constant(1.0 * self.scale),
            self.dim,
        )
        self.forward_scaler = self.init / self.scale

    def __call__(self, x: jnp.ndarray) -> jnp.ndarray:
        return self.scaler * self.forward_scaler * x
\end{lstlisting}
\vspace{5mm}
%\vspace{-3mm}
%\caption{A JAX implementation of Scaler (Section~\ref{subsection:init_and_update}).}
%\vspace{-1mm}
%\label{implementation:scaler}
%\end{figure}