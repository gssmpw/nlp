\section{Importance Weighted Evidence}
\label{sec:importance_weighted_evidence}

There are two possible explanations for why our \emph{data-emphasized ELBo} favors $q$ that produce higher test accuracy: 1)~our \emph{data-emphasized} objective addresses looseness in the ELBo and 2)~our \emph{data-emphasized} objective addresses a misspecified prior.
To demonstrate the latter is true, we use importance weighted evidence (IWE) \citep{burda2016importance} to approximate the logarithm of evidence.
IWE is a better estimator of the logarithm of evidence than the ELBo and a should approach the logarithm of evidence as the number of samples goes to infinity.
\begin{align}
    \log p_{\eta}(y_{1:N}) = \log \mathbb{E}_{q_{r}(\theta)} \left[ \frac{p_{\eta}(y_{1:N} | \theta) p_{\eta}(\theta)}{q_{r}(\theta)} \right] \geq \mathbb{E}_{q_{r}(\theta)} \left[ \log \frac{p_{\eta}(y_{1:N} | \theta) p_{\eta}(\theta)}{q_{r}(\theta)} \right] = \JELBO
\end{align}
\begin{align}
    J_{\text{IWE}} := \log \mathbb{E}_{q_{r}(\theta)} \left[ \exp \left( \sum_{i=1}^{N} \log p_{\eta}(y_i | \theta) + \log p_{\eta}(\theta) - \log q_{r}(\theta) \right) \right]
\end{align}
However, just like the ELBo, when $D \gg N$ the IWE prefers simpler $q$, while our \emph{data-emphasized IWE} (DE IWE) favors $q$ that produce higher test accuracy.
This suggests that our \emph{data-emphasized} objective addresses a misspecified prior rather than looseness in the ELBo.
\begin{align}
    J_{\text{DE IWE}} := \log \mathbb{E}_{q_{r}(\theta)} \left[ \exp \left( \kappa \cdot \sum_{i=1}^{N} \log p_{\eta}(y_i | \theta) + \log p_{\eta}(\theta) - \log q_{r}(\theta) \right) \right]
\end{align}

\input{fig_iwe_comparison}
