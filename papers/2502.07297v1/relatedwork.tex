\section{Related Works}
Generative methods have been widely used to generate ECGs, \textit{e.g.}, Generative Adversarial Networks (GANs)~\citep{simone2023ecgan}, Autoregressive Models (AMs)~\citep{chung2023text}, and Diffusion Models (DMs)~\citep{li2024biodiffusion}. Researchers design various GANs to generate realistic and personalized ECGs, for example, \citet{golany2020simgans,golany2021ecg} integrate physical knowledge into the generation process of GAN to produce realistic ECG signals by using a physically motivated ECG simulator, given by a set of ordinary differential equations~\citep{mcsharry2003dynamical}. \citet{golany2019pgans} uses the wave values and durations of ECG signals as constraints for GAN to generate personalized heartbeats. \citet{hu2024personalized} generates digital twins of healthy individualsâ€™ anomalous ECGs and enhances the model sensitivity to the personalized symptoms.
Besides GANs, AMs and DMs have also been employed for ECG signal generation, achieving SOTA performance in aiding the diagnosis of cardiac disease. For instance, \citet{chung2023text} proposes Auto-TTE, an autoregressive generation model driven by clinical text reports. \citet{neifar2023diffecg} introduces a novel versatile approach based on DMs for ECG synthesis. \citet{alcaraz2023diffusion,zama2023ecg} design novel DMs coupled with state space models to generate 12-lead ECGs.

Most of the aforementioned work has primarily focused on aiding cardiac disease diagnosis and has achieved significant progress in this area. In contrast, our work is centered on generating ECGs that reflect drug reactions, thereby enabling virtual clinical trials.



\begin{figure*}[htbp]
    \centering
    \includegraphics[width=1\textwidth]{images/1-cropped.pdf}
    \caption{(a) Workflow of integrating EPK; (b) Structure of RBDCA. $\mathbf{x}_{ode}$ represents the external physical knowledge. The output of the previous residual block is the input of the next one. Each block is also connected through a skip connection; (c) Structure of DCA. $\mathbf{y}_{inter}$ and $\mathbf{A}$ represent the output of the Bi-DilConv and the cross-attention map, respectively.}
    \label{1}
\end{figure*}