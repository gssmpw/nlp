\section{Related Works}
Generative methods have been widely used to generate ECGs, \textit{e.g.}, Generative Adversarial Networks (GANs)____, Autoregressive Models (AMs)____, and Diffusion Models (DMs)____. Researchers design various GANs to generate realistic and personalized ECGs, for example, ____ integrate physical knowledge into the generation process of GAN to produce realistic ECG signals by using a physically motivated ECG simulator, given by a set of ordinary differential equations____. ____ uses the wave values and durations of ECG signals as constraints for GAN to generate personalized heartbeats. ____ generates digital twins of healthy individualsâ€™ anomalous ECGs and enhances the model sensitivity to the personalized symptoms.
Besides GANs, AMs and DMs have also been employed for ECG signal generation, achieving SOTA performance in aiding the diagnosis of cardiac disease. For instance, ____ proposes Auto-TTE, an autoregressive generation model driven by clinical text reports. ____ introduces a novel versatile approach based on DMs for ECG synthesis. ____ design novel DMs coupled with state space models to generate 12-lead ECGs.

Most of the aforementioned work has primarily focused on aiding cardiac disease diagnosis and has achieved significant progress in this area. In contrast, our work is centered on generating ECGs that reflect drug reactions, thereby enabling virtual clinical trials.



\begin{figure*}[htbp]
    \centering
    \includegraphics[width=1\textwidth]{images/1-cropped.pdf}
    \caption{(a) Workflow of integrating EPK; (b) Structure of RBDCA. $\mathbf{x}_{ode}$ represents the external physical knowledge. The output of the previous residual block is the input of the next one. Each block is also connected through a skip connection; (c) Structure of DCA. $\mathbf{y}_{inter}$ and $\mathbf{A}$ represent the output of the Bi-DilConv and the cross-attention map, respectively.}
    \label{1}
\end{figure*}