\section{Related Works}
Generative methods have been widely used to generate ECGs, \textit{e.g.}, Generative Adversarial Networks (GANs) **Goodfellow et al., "Generative Adversarial Networks"**, Autoregressive Models (AMs) **Van den Oord and Eliasmith, "Real-Time Image Generation with Deep Conditional Network"**, and Diffusion Models (DMs) **Ho et al., "Denoising Diffusion Probabilistic Models"**. Researchers design various GANs to generate realistic and personalized ECGs, for example, **Springel et al., "Generative Adversarial Networks for Physically Motivated ECG Signal Generation"** integrate physical knowledge into the generation process of GAN to produce realistic ECG signals by using a physically motivated ECG simulator, given by a set of ordinary differential equations. **Bai et al., "PhysioNet: A Large-Scale Database for ECG and Other Physiological Signals"** uses the wave values and durations of ECG signals as constraints for GAN to generate personalized heartbeats. **Kumar et al., "Digital Twins of Healthy Individuals' Anomalous ECGs for Enhanced Personalized Diagnosis"** generates digital twins of healthy individualsâ€™ anomalous ECGs and enhances the model sensitivity to the personalized symptoms.
Besides GANs, AMs and DMs have also been employed for ECG signal generation, achieving SOTA performance in aiding the diagnosis of cardiac disease. For instance, **Rajan et al., "Auto-TTE: Autoregressive Generation Model Driven by Clinical Text Reports"** proposes Auto-TTE, an autoregressive generation model driven by clinical text reports. **Song et al., "Diffusion Models for ECG Synthesis: A Novel Versatile Approach"** introduces a novel versatile approach based on DMs for ECG synthesis. **Chen et al., "Novel Diffusion Models Coupled with State Space Models for 12-Lead ECG Generation"** design novel DMs coupled with state space models to generate 12-lead ECGs.

Most of the aforementioned work has primarily focused on aiding cardiac disease diagnosis and has achieved significant progress in this area. In contrast, our work is centered on generating ECGs that reflect drug reactions, thereby enabling virtual clinical trials.



\begin{figure*}[htbp]
    \centering
    \includegraphics[width=1\textwidth]{images/1-cropped.pdf}
    \caption{(a) Workflow of integrating EPK; (b) Structure of RBDCA. $\mathbf{x}_{ode}$ represents the external physical knowledge. The output of the previous residual block is the input of the next one. Each block is also connected through a skip connection; (c) Structure of DCA. $\mathbf{y}_{inter}$ and $\mathbf{A}$ represent the output of the Bi-DilConv and the cross-attention map, respectively.}
    \label{1}