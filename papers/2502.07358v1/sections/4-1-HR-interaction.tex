\section{Foundational Interactive Model}
\label{sec:interactivemodel}
% \begin{figure*}[]
%   \includegraphics[width=0.8\linewidth]{images/ActModel.drawio.pdf}
%   \caption{Foundational Interactive Model.}
% \end{figure*}
\input{figures/interactive-model}


% \iffalse
% \begin{table*}[]
% \centering
% \caption{Ablation studies on Foundational Interactive Model.}
% \resizebox{\linewidth}{!}{ 
% \begin{tabular}{ccc|cccccc|cccccc}
% \hline
% \multicolumn{3}{c|}{Constraint}                                & \multicolumn{6}{c|}{Unitree H1 robot}                                                                                                                                                                           & \multicolumn{6}{c}{LEJU Kuavo robot}                                                                                                                                                                      \\ \hline
% \multicolumn{1}{c|}{Pos} & \multicolumn{1}{c|}{Vel} & Interact & \multicolumn{1}{c|}{Contact}        & \multicolumn{1}{c|}{FID}             & \multicolumn{1}{c|}{Traj}           & \multicolumn{1}{c|}{Orientation}    & \multicolumn{1}{c|}{Relation}         & MPJPE          & \multicolumn{1}{c|}{Contact}        & \multicolumn{1}{c|}{FID}             & \multicolumn{1}{c|}{Traj}           & \multicolumn{1}{c|}{Orientation}    & \multicolumn{1}{c|}{Relation}         & MPJPE          \\ \hline
% \multicolumn{1}{c|}{$\checkmark$}   & \multicolumn{1}{c|}{$\times$}   & $\times$        & \multicolumn{1}{c|}{0.17}           & \multicolumn{1}{c|}{374.13}          & \multicolumn{1}{c|}{0.302}          & \multicolumn{1}{c|}{40.88}          & \multicolumn{1}{c|}{0.00051}          & 0.308          & \multicolumn{1}{c|}{0.02}           & \multicolumn{1}{c|}{432.25}          & \multicolumn{1}{c|}{0.433}          & \multicolumn{1}{c|}{58.8}           & \multicolumn{1}{c|}{0.00034}          & 0.444          \\ \hline
% \multicolumn{1}{c|}{$\checkmark$}   & \multicolumn{1}{c|}{$\checkmark$}   & $\times$        & \multicolumn{1}{c|}{0.034}          & \multicolumn{1}{c|}{\textbf{229.67}} & \multicolumn{1}{c|}{\textbf{0.176}} & \multicolumn{1}{c|}{\textbf{29.13}} & \multicolumn{1}{c|}{0.00051}          & \textbf{0.198} & \multicolumn{1}{c|}{\textbf{0.025}} & \multicolumn{1}{c|}{\textbf{228.08}} & \multicolumn{1}{c|}{\textbf{0.179}} & \multicolumn{1}{c|}{\textbf{29.17}} & \multicolumn{1}{c|}{0.00034}          & \textbf{0.193} \\ \hline
% \multicolumn{1}{c|}{$\checkmark$}   & \multicolumn{1}{c|}{$\checkmark$}   & $\checkmark$        & \multicolumn{1}{c|}{\textbf{0.022}} & \multicolumn{1}{c|}{251.61}          & \multicolumn{1}{c|}{0.194}          & \multicolumn{1}{c|}{31.94}          & \multicolumn{1}{c|}{\textbf{0.00051}} & 0.213          & \multicolumn{1}{c|}{0.026}          & \multicolumn{1}{c|}{240.06}          & \multicolumn{1}{c|}{0.193}          & \multicolumn{1}{c|}{31.75}          & \multicolumn{1}{c|}{\textbf{0.00034}} & 0.204          \\ \hline
% \end{tabular}
% }
% \end{table*}
% \fi

%\begin{table*}[]
%\centering
%\caption{Ablation Studies on Interx-HRI.}
%\resizebox{\linewidth}{!}{ 
%\begin{tabular}{c|cl|cccccccccc}
%\hline
%$L_{\text{pos}} $          & \multicolumn{2}{c|}{$L_{\text{vel}}$}          & PA-MPJPE↓      & MPJPE↓         & C\_prec↑       & C\_rec↑        & Acc↑           & F1↑            & Traj↓          & Orie↓          & FID↓          & R-score↑      \\ \hline 
%$\checkmark$ & \multicolumn{2}{c|}{$\times$}     & 3.958          & 14.32          & 0.243          & 0.326          & 0.763          & 0.278          & 0.302          & 40.79          & 0.60          & 0.40          \\ \hline
%$\times$     & \multicolumn{2}{c|}{$\checkmark$} & 3.194          & 12.04          & 0.360          & 0.357          & 0.821          & 0.359          & 0.206          & 32.04          & 0.34          & 0.46          \\ \hline
%$\checkmark$ & \multicolumn{2}{c|}{$\checkmark$} & \textbf{2.874} & \textbf{10.51} & \textbf{0.375} & \textbf{0.380} & \textbf{0.825} & \textbf{0.377} & \textbf{0.176} & \textbf{29.13} & \textbf{0.29} & \textbf{0.48} \\ \hline
%\end{tabular}
%}
%\label{tab:ab-hhi}
%\end{table*}


We propose a foundational human-robot interactive model, which autoregressively generates humanoid robot motion, ensuring reasonable and consistent real-time interaction with humans. Fig.~\ref{fig:interactiveModel} illustrates the pipeline of our model.

%by autoregressively utilizing past and present interaction data through maintaining a rollout queue and applying a series of optimization designs.


\subsection{Model Input and Output}
The interactive model receives three inputs at current time $t$: historical robot motion skeletons $J^R_{t-n \sim t}$, observed human motion skeletons $J^H_{t-n \sim t}$, and user's action command $T^A$.
Specifically, $J^R_{t-n \sim t}$ comes from the model output stored in the robot's rollout queue at time \( t-1 \), $J^H_{t-n \sim t}$ is derived from human motion capture data $P^H_{t-n \sim t}$ represented by SMPL~\cite{SMPL}, which is then processed through a forward kinematic module, and \( T^A \) represents a user-specified phrase, such as ``High-five'' or ``Handshake''.
The output is the predicted robot motion sequences $J^R_{t+1 \sim t+k}$ in future $k$ frames, because sequence supervision can benefit the consistency of predicted robot motion. However, to ensure timely response, we only feed $J^R_{t+1}$ to the following physical simulation module and store it in the robot's rollout queue. In our experiment, we set $n=10$ and $k=10$.
% \begin{enumerate}
%     \item Robot joint skeleton $J^R_t$;
%     \item Human joint skeleton $J^H_t$;
%     \item User's action command $T^A$,
% \end{enumerate}

\subsection{Real-time Interactive Feature Learning}

%\paragraph{\textbf{History Information Supplementary}}
%First, $J^R_t$ and $J^H_t$ are concatenated with recent historical data from the rollout queues to form continuous motion sequences, $J^R_{t-n \sim t}$ and $J^H_{t-n \sim t}$, respectively. 
%The role of rollout queues is to generate temporally consistent future motions by maintaining the continuous sequences that includes recent historical information.



\noindent{\textbf{Feature Encoder}}$\ $
% $F^R_{t-n \sim t}$ and $F^H_{t-n \sim t}$
Both human and robot motion sequences are encoded by convolution and attention-based hybrid network blocks for feature extraction. Meanwhile, $T^A$ is processed using a pre-trained CLIP model~\cite{radford2021learning} to obtain text embeddings $F^A$, which are promptly integrated into $F^R_{t-n \sim t}$ and $F^H_{t-n \sim t}$ by cross-attention blocks to guide the robot performing user-specified interactive action type. The Robot Encoder and Human Encoder are repeatedly stacked for $L$ times, and we set $L=3$:
\begin{equation}
F^A = CLIP(T^A),
\end{equation}
\begin{equation}
F^R_{t-n \sim t} = \{ \textbf{Robot Encoder}(J^R_{t-n \sim t}, F^A)\}_{\times L},
\end{equation}
\begin{equation}
F^H_{t-n \sim t} = \{ \textbf{Human Encoder}(J^H_{t-n \sim t}, F^A)\}_{\times L}.
\end{equation}
\noindent{\textbf{Human-robot Feature Interaction}}$\ $
To enable the robot to adapt to changes of human position and posture for effective human-robot interaction, $F^H_{t-n \sim t}$ is integrated with $F^R_{t-n \sim t}$ through Human-Robot Feature Interaction Module (HR Interaction), which contains
$M$ stacked self-attention and cross-attention blocks:
\begin{equation}
F'^R_{t+1 \sim t+k} = \{ \textbf{HR Interaction}(F^R_{t-n \sim t}, F^H_{t-n \sim t})\}_{\times M},
\end{equation}
where $M=2$, $F^{'R}_{t+1 \sim t+k}$ is the generated future robot motion features containing interactive representations.


\noindent{\textbf{Robot Motion Decoder}}$\ $
After the integration of human-robot interactive information, $F^{'R}_{t+1 \sim t+k}$ is then decoded into the future robot joint skeleton $J^R_{t+1 \sim t+k}$ by the Robot Decoder, which is similar to Robot Encoder:
\begin{equation}
J^R_{t+1 \sim t+k} = \{ \textbf{Robot Decoder}(F'^R_{t+1 \sim t+k}, F^A)\}_{\times L},
\end{equation}

% \subsection{Real-time Output}
\noindent{\textbf{Rollout Strategy}} To ensure real-time responsiveness, we maintain only $J^R_{t+1}$ from the set $J^R_{t+1 \sim t+k}$ as the output of the interactive model. This output is then pushed to the robot's rollout queue as the input for the subsequent $t+1$ frame. Different humanoid robots have their own unique joint representation $J^R_{t+1}$. It is then transformed into the specific robot's pose, $P^R_{t+1}$, via a dedicated Inverse Kinematic Solver (IK-Solver) from LiveHPS++~\cite{ren2025livehps++}, and subsequently used as the input for the following robot simulation.


%\begin{equation}
%P^R_{t+1} = \textbf{IK-Solver}(J^R_{t+1}).
%\end{equation}

\subsection{Training Strategy}
% \paragraph{\textbf{Training Strategy}}$\ $
In order to generate consistent future robot motion without jitteriness or sliding, our interactive model predicts the displacement of each skeleton joint from the previous frame to the current frame (i.e. Joint Velocity, $Vel^R$), rather than directly predicting the joint position of the current frame (Joint Position, $J^R$). 
We apply $L_{vel}$, which is the $l_2$ loss to constraint Joint Velocity between the predicted result and ground truth:
\begin{equation}
    L_{\text{vel}}  = \left\| Vel_{t+1 \sim t+k}^{\text{pred}}- Vel_{t+1 \sim t+k}^{\text{gt}} \right\|_2.
\end{equation}
Then, we sequentially accumulate $Vel_{t+1 \sim t+k}^{\text{pred}}$ from the initial frame's position to obtain the predicted Joint Position $P_{t+1 \sim t+k}^{\text{pred}}$ of each frame.
Besides, to prevent the accumulation of errors caused by the sequential summation, we also apply $L_{pos}$ to the Joint Position:
\begin{equation}
    L_{\text{pos}}  = \left\| P_{t+1 \sim t+k}^{\text{pred}} - P_{t+1 \sim t+k}^{\text{gt}} \right\|_2,
\end{equation}
Finally, the total training loss is:
\begin{equation}
    L = L_{\text{vel}} + L_{\text{pos}}.
\end{equation}









% \subsection{Initialization}
% The Foundational Interactive Model initializes the position and orientation of the robot based on those of the person in the first frame, ensuring that the human and robot face each other.
% Then the initial state of both person and robot will be replicated $n-1$ times to fill the rollout queue, which aims to generate temporally consistent future motions by maintaining a continuous sequence that includes recent historical information.
\subsection{Robot-object Interaction}
In addition to human-robot interaction, robot-object interaction is also a crucial skill for robots to live and work alongside humans, such as collaborating with a person to carry a box together. Therefore, building on the human-robot interaction model, we have also extended it to incorporate a robot-object interaction model. For Robot-Object Interaction task, the input consists of the observed object point cloud at the current time step \( t \), represented as \( \mathbf{P}_t \in \mathbb{R}^{N \times 3} \), where \( N \) is the number of points, and the output is responsive robot motion. To encode the object geometry, we adopt the Basis Point Set (BPS) representation~\cite{prokudin2019efficient}, following the approach in~\cite{li2023object}. A three-layer MLP is then used to encode the point cloud features.
For the remaining feature interaction blocks and robot control decoding, the model shares the same framework with the human-robot interactive model. 

Specifically, in addition to predicting the future robot's joint skeleton position \( J^R \) and velocity \( Vel^R \), the robot needs to approach the object and ensure that its hands make close contact with it. To achieve this, we further introduce an interactive decoder branch that predicts the future position of the object. We apply $L_{obj}$, which is the $l_2$ loss to minimize the discrepancy between the predicted object future position and the ground truth future position. Additionally, we compute the $L_{interactive}$  which measures the distance between the human hand's position $\mathbf{h}_t^{\text{pred}}$ and the closest point on the object surface $\mathbf{P}_t^{\text{surface}}$. This encourages the human hand to remain in close proximity to the object during interactions. The final loss function is a combination of these terms:

$$
L_{\text{obj}} = \left\| \mathbf{Obj}_{t+1 \sim t+k}^{\text{pred}} - \mathbf{Obj}_{t+1 \sim t+k}^{\text{gt}} \right\|_2,
$$
$$
L_{\text{interactive}} = \left\| \mathbf{h}_{t+1 \sim t+k}^{\text{pred}} - \mathbf{P}_{t+1 \sim t+k}^{\text{surface}} \right\|_2,
$$
$$
L = L_{\text{pos}} + L_{\text{vel}} + L_{\text{interactive}} + L_{\text{obj}}.
$$




\begin{table*}[]
\centering
\caption{Comparison results of human-robot interaction on Inter-HRI.}
\resizebox{\linewidth}{!}{ 
\begin{tabular}{c|c|ccccccccccc}
\hline
Robot Type                      & Methods                                                & PA-MPJPE↓     & MPJPE↓         & C\_prec↑       & C\_rec↑        & Acc↑           & F1↑            & Traj↓          & Orie↓          & FID↓          & R-score↑      & AITS↓          \\ \hline
\multirow{5}{*}{Unitree H1} & JRT~\cite{xu2023joint}          & 3.47          & 12.66          & 0.291          & 0.341          & 0.791          & 0.314          & 0.473          & 55.14          & 0.76          & 0.38          & 0.080          \\ \cline{2-13} 
                            & MRT~\cite{wang2021multi}         & 3.16          & 11.69          & 0.358          & 0.368          & 0.819          & 0.363          & 0.224          & 34.96          & 0.37          & 0.44          & 0.035          \\ \cline{2-13} 
                            & ReGenNet~\cite{xu2024regennet}   & 3.91          & 14.82          & 0.251          & 0.269          & 0.785          & 0.260          & 0.292          & 48.49          & 0.55          & 0.40          & 0.934          \\ \cline{2-13} 
                            & SAST~\cite{mueller2024massively} & 5.21          & 19.82          & 0.239          & 0.316          & 0.764          & 0.272          & 0.380          & 42.90          & 0.74          & 0.40          & 14.852         \\ \cline{2-13} 
                            & Ours                                                   & \textbf{2.87} & \textbf{10.51} & \textbf{0.375} & \textbf{0.380} & \textbf{0.825} & \textbf{0.377} & \textbf{0.176} & \textbf{29.13} & \textbf{0.29} & \textbf{0.48} & \textbf{0.023} \\ \hline
\multirow{5}{*}{LEJU Kuavo} & JRT~\cite{xu2023joint}           & 2.66          & 10.51          & 0.231          & 0.339          & 0.843          & 0.275          & 0.284          & 46.28          & 0.40          & 0.41          & 0.083          \\ \cline{2-13} 
                            & MRT~\cite{wang2021multi}         & 2.61          & 10.26          & 0.261          & 0.362          & 0.853          & 0.304          & 0.227          & 33.76          & 0.40          & 0.44          & 0.035          \\ \cline{2-13} 
                            & ReGenNet~\cite{xu2024regennet}   & 3.95          & 14.00          & 0.158          & 0.255          & 0.814          & 0.195          & 0.285          & 51.53          & 0.65          & 0.40          & 0.934          \\ \cline{2-13} 
                            & SAST~\cite{mueller2024massively} & 4.81          & 20.22          & 0.153          & 0.346          & 0.774          & 0.213          & 0.374          & 43.52          & 0.84          & 0.40          & 14.852         \\ \cline{2-13} 
                            & Ours                                                   & \textbf{2.36} & \textbf{9.34}  & \textbf{0.287} & \textbf{0.389} & \textbf{0.861} & \textbf{0.330} & \textbf{0.179} & \textbf{29.14} & \textbf{0.31} & \textbf{0.47} & \textbf{0.023} \\ \hline
\end{tabular}
}
\label{tab:hhi}
\end{table*}



\begin{table*}[]
\centering
\caption{Comparison results of robot-object interaction on Inter-ROI.}
\resizebox{\linewidth}{!}{ 
\begin{tabular}{c|c|ccccccccccc}
\hline
Robot Type                      & Methods                                                & PA-MPJPE↓     & MPJPE↓         & C\_prec↑       & C\_rec↑        & Acc↑           & F1↑            & Traj↓          & Orie↓          & FID↓          & R-score↑      & AITS↓             \\ \hline
\multirow{4}{*}{Unitree H1} & InterDiff~\cite{xu2023interdiff}                                              & 6.27           & 23.36          & 0.463          & 0.214          & 0.435          & 0.280          & 0.627          & 60.27         & 3.99          & 0.28           & 19.000             \\ \cline{2-13} 
& MRT~\cite{wang2021multi}         & 5.99           & 21.94          & 0.559          & \textbf{0.332}          & 0.540           & \textbf{0.361} & \textbf{0.315}  & \textbf{29.62} & 3.08          & 0.49           & \textbf{0.033} \\ \cline{2-13} 
& SAST~\cite{mueller2024massively} &  7.44              &        29.69        &    0.335            &  0.129              &       0.489         &    0.162           & 0.631               &     45.48          & 3.98          & \textbf{0.56}  & 14.896         \\ \cline{2-13} 
& Ours                                                   & \textbf{4.43} & \textbf{20.05} & \textbf{0.592} & 0.253 & \textbf{0.540}  & 0.320         & 0.486          & 53.79         & \textbf{2.02} & 0.36           & 0.035          \\ \hline
\multirow{4}{*}{LEJU Kuavo} & InterDiff~\cite{xu2023interdiff}                                              & 6.34           & 23.14          & 0.184          & 0.109          & 0.710           & 0.112         & 0.684          & 64.71          & 3.95          & 0.25          & 19.000             \\ \cline{2-13} 
& MRT ~\cite{wang2021multi}         & 5.80            & 22.10           & 0.161          & 0.100          & 0.733          & \textbf{0.170} & \textbf{0.330} & \textbf{33.61} & 2.49          & 0.39          & \textbf{0.033} \\ \cline{2-13} 
& SAST~\cite{mueller2024massively}  &    7.06            &     27.82           &    0.123            &    0.061           &   0.720             &     0.062          &  0.642              &    50.90           & 4.91          & \textbf{0.45} & 14.890         \\ \cline{2-13} 
& Ours                                                   & \textbf{4.04}  & \textbf{17.72} & \textbf{0.225} & \textbf{0.126} & \textbf{0.734} & 0.136         & 0.427          & 50.03         & \textbf{1.17} & 0.34          & 0.035          \\ \hline
\end{tabular}}
\label{tab:hoi}
\end{table*}


\begin{table*}[]
\centering
\caption{Ablation studies on Inter-HRI and Inter-ROI.}
\resizebox{\linewidth}{!}{ 
\begin{tabular}{c|c|c|c|c|cccccccccc}
\hline
Dataset  & 
$L_{\text{pos}} $          & $L_{\text{vel}}$          & $L_{\text{interactive}}$     & $L_{\text{obj}}$   &  PA-MPJPE↓     & MPJPE↓         & C\_prec↑       & C\_rec↑        & Acc↑           & F1↑            & Traj↓          & Orie↓          & FID↓          & R-score↑         \\ \hline \multirow{2}{*}{Inter-HRI} & 
$\checkmark$ &  & &   & 3.96          & 14.32          & 0.243          & 0.326          & 0.763          & 0.278          & 0.302          & 40.79          & 0.60          & 0.40           
\\ \cline{2-15}  & 
$\checkmark$ & $\checkmark$ & &&\textbf{2.87} & \textbf{10.51} & \textbf{0.375} & \textbf{0.380} & \textbf{0.825} & \textbf{0.377} & \textbf{0.176} & \textbf{29.13} & \textbf{0.29} & \textbf{0.48} 
\\ \hline \hline \multirow{4}{*}{Inter-ROI} & 
$\checkmark$ &              &              &              & 4.63           & 20.62          & 0.572           & 0.242           & 0.531         & 0.300           & \textbf{0.461} & 53.51          & 2.69          & 0.35          \\ \cline{2-15} & 
$\checkmark$ & $\checkmark$ &              &              & 4.62           & 20.92          & 0.561          & 0.251          & 0.531         & 0.308         & 0.476          & 53.68         & \textbf{1.92} & 0.37          \\ \cline{2-15} & 
$\checkmark$ & $\checkmark$ & $\checkmark$ &              & 4.45          & 20.72          & 0.579          & 0.242          & 0.533         & 0.308         & 0.495          & \textbf{53.30} & 2.14          & \textbf{0.38} \\ \cline{2-15}  & 
$\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$ & \textbf{4.43} & \textbf{20.05} & \textbf{0.592} & \textbf{0.253} & \textbf{0.54} & \textbf{0.320} & 0.486          & 53.79         & 2.02          & 0.36          \\ \hline
\end{tabular}
}
\label{tab:ab-hoi}
\end{table*}

