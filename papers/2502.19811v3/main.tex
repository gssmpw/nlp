\documentclass[twocolumn]{bytedance_seed}

% single-column: \documentclass[]{bytedance_seed}, 
%Please prioritize using single-column。

% twocolumn: \documentclass[twocolumn]{bytedance_seed}

\usepackage[toc,page,header]{appendix}
% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
% \usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{pifont}
\usepackage{xcolor}

% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{mlsys2024} with \usepackage[nohyperref]{mlsys2024} above.
\usepackage{hyperref}

% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

% Use the following line for the initial blind version submitted for review:
\newcommand{\sysname}{{\textsc{Comet}}}

% If accepted, instead use the following line for the camera-ready submission:
% \usepackage[accepted]{mlsys2024}

\newcommand{\redcomments}[1]{\todo[inline, color=red!40,size=\small]{#1}}
\newcommand{\yellowcomments}[1]{\todo[inline, color=yellow!40,size=\small]{#1}}

\newcommand{\comments}[2]{{\bf[\textcolor{red}{#1}: \textcolor{blue}{#2}]}}
%\newcommand{\sysname}{{SparGen}}%{{$AugC^{2}$}} % Marlin, Fractal, Atom, AutoC2, AugC2

\newcommand{\NX}[1]{{\comments{Ningxin}{#1}}}
\newcommand{\ZSL}[1]{{\comments{Shulai}{#1}}}
\newcommand{\bluetext}[1]{\textcolor{black}{#1}}
\newcommand{\browntext}[1]{\textcolor{black}{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{minitoc}








%%%%%%%%%%%%%%%%%%%%

\title{\sysname{}: Fine-grained Computation-communication Overlapping for Mixture-of-Experts}

\author[1,2,\circ,*]{Shulai Zhang}
\author[1,\circ,\dagger]{Ningxin Zheng}
\author[1,\dagger]{Haibin Lin}
\author[1]{Ziheng Jiang}
\author[1]{Wenlei Bao}
\author[1]{Chengquan Jiang}
\author[1]{Qi Hou}
\author[2]{Weihao Cui}
\author[1]{Size Zheng}
\author[1]{Li-Wen Chang}
\author[2,\dagger]{Quan Chen}
\author[1,\dagger]{Xin Liu}

\affiliation[1]{ByteDance Seed}
\affiliation[2]{Shanghai Jiao Tong University}

\contribution[\circ]{Equal Contribution}
\contribution[*]{Work done at ByteDance Seed}
\contribution[\dagger]{Corresponding authors}

\abstract{
Mixture-of-experts (MoE) has been extensively employed to scale large language models to trillion-plus parameters while maintaining a fixed computational cost. 
The development of large MoE models in the distributed scenario encounters the problem of large communication overhead. The inter-device communication of a MoE layer can occupy $47\%$ time of the entire model execution with popular models and frameworks. Therefore, existing methods suggest the communication in a MoE layer to be pipelined with the computation for overlapping. However, these coarse grained overlapping schemes introduce a notable impairment of computational efficiency and the latency concealing is sub-optimal.

To this end, we present \sysname{}, an optimized MoE system with fine-grained communication-computation overlapping. Leveraging data dependency analysis and task rescheduling, \sysname{} achieves precise fine-grained overlapping of communication and computation. Through adaptive workload assignment, \sysname{} effectively eliminates fine-grained communication bottlenecks and enhances its adaptability across various scenarios.
Our evaluation shows that \sysname{} accelerates the execution of a single MoE layer by $1.96\times$ and for end-to-end execution, \sysname{} delivers a $1.71\times$ speedup on average. \sysname{} has been adopted in the production environment of clusters with ten-thousand-scale of GPUs, achieving savings of millions of GPU hours.
}

% \date{\today}
\correspondence{Ningxin Zheng, Haibin Lin, Quan Chen, Xin Liu}

% You can add additional info fields as follows 
\checkdata[Project Page]{\url{https://github.com/bytedance/flux}}

\begin{document}
\maketitle

%不需要目录就注释掉 注意目录不要和第一页放在一块 要有\newpage
%\newpage
%\tableofcontents
%\newpage

\input{sections/introduction}
\input{sections/motivation}
\input{sections/design}
\input{sections/experiment}
\input{sections/related_work}
\input{sections/conclusion}


\clearpage

\bibliographystyle{plainnat}
\bibliography{main}

\clearpage

% \beginappendix

% \input{sections/appendix}

\end{document}