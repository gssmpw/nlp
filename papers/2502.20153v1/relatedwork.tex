\section{Related Work}
\label{Appd:related work}
In this paper, we propose to use the transport formula to address the negative transfer in latent contextual bandits under the assumption of distribution shift on the latent context. Also, we assume a high-dimensional proxy variable and employ VAEs to restore the latent context from it. In this section, we relate our contributions to the existing literature.  


\noindent \textbf{Transfer Learning in Bandits}. Our work is closely aligned with the framework of transfer learning in bandits, which aims to accelerate the convergence to the optimal actions in the target domain by transferring knowledge from an offline dataset collected from related environments. Existing works vary in their assumptions regarding the ``differences" between environments. For example, \cite{deshmukh2017multi} assume the reward distribution for each arm given the context is different and improves the estimation of the reward distributions for each arm by leveraging the similarities in the context-to-reward mapping. \cite{liu2018transferable} address potentially different context and action spaces and introduce a method to learn a translation matrix for aligning feature spaces between source and target domains. While they assume a single unknown reward parameter shared between domains, \cite{labille2021transferable} relax this assumption by considering different unknown reward parameters across domains. Combining with LinUCB, they propose leveraging historical data from similar domains to initialize new arm parameters, using a similarity measure and a decaying weight to prioritize relevant observations.  \cite{zhang2017transfer} address the presence of unobserved confounders that simultaneously influence both the rewards and actions. Under the assumption of shifts in reward distributions, they propose to derive causal bounds from prior datasets, utilizing these bounds to inform and optimize exploration and exploitation within the target domain. Although these works explore various assumptions regarding domain differences, none of them considers changes in the distribution of the context. The most closely related work to ours is by \cite{cai2024transfer}.
\cite{cai2024transfer} explore transfer learning for contextual bandits under covariate shift, \ie the distribution of context is different across domains. However, their approach involves partitioning the covariate space into bins, which may not be feasible for high-dimensional covariates such as the proxy in our problem setting. Moreover, their setting does not incorporate an underlying latent context, as is the case in our latent contextual bandit framework.

\noindent \textbf{Latent Contextual Bandits}. Latent contextual bandits were initially introduced by \cite{zhou2016latent} and later extended by \cite{hong2020latent}, who employ offline-learned models that provide an initial understanding of the latent states. However, their problem setting differs from ours in two key aspects: (1) their reward function depends on the context, action, and latent state, whereas our reward depends only on the action and latent state; and (2) they do not account for distributional shifts in the context or latent state. More closely related to our setting, \cite{sen2017contextual} consider a latent confounder associated with the observed context, and the reward depends solely on the latent confounder and action. Unlike our approach, they address the problem in an online setting by factorizing the observed context-reward matrix into two low-dimensional matrices, with one capturing the relationship between contexts and latent confounders and the other between rewards and latent confounders. Although this work defines their problem setting from a causal perspective, they do not apply any theory from causal inference to derive their method. %adding the explanation. 

\noindent \textbf{Bandits and Causal Inference}. The connection between bandit problems and causal inference is well-established. \cite{bareinboim2015bandits} introduce the problem of bandits with unobserved confounders and leverage counterfactual estimation from causal inference to reduce the cumulative regret. Building on this, \cite{forney2017counterfactual} further exploits counterfactual reasoning to generate counterfactual data, integrating it with the observational data and interventional data to learn a good policy. Moreover, there is extensive literature using causal graphs to define the structure of bandits under the name of causal bandits \citep{lattimore2016causal, lee2018structural,lee2019structural, lu2021causal, bilodeau2022adaptively, yan2024causal}. While those works exploit knowledge in a single environment, \cite{bellot2024transportability} propose a general transfer learning framework for causal bandits, using posterior approximations on the causal relations encoded in the selection diagram, grounded in transportability theory. We realize their approach of learning the invariant causal relations aligns with our method, and we position our work as an extension of their framework within the specific context of latent contextual bandits. Further, we relax their assumption of discrete SCMs by considering a high-dimensional proxy variable and a continuous latent context.