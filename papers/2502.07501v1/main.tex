\documentclass[11pt,a4paper]{article}
\usepackage[lmargin=1.0in,rmargin=1.0in,bottom=1.0in,top=1.0in,twoside=False]{geometry}

\usepackage{inconsolata}
\usepackage{libertine}

\usepackage{amssymb,amsmath,amsthm}
\usepackage{mathtools}
\usepackage{graphicx}%,algorithmic,algorithm}%, verbatim}
\usepackage{enumerate}
\usepackage{tikz}
\usetikzlibrary{shapes}

\usepackage[T1]{fontenc}

\usepackage{enumitem}

\usepackage{microtype}
\usepackage{amsfonts}
\usepackage{comment}
\usepackage{mathrsfs}
\setlength{\marginparwidth}{2cm}
\usepackage{todonotes}
\newcommand{\mpil}[2][]{\todo[color=magenta!80,#1]{{\textbf{MaPi:} #2}}}
\newcommand{\mipil}[2][]{\todo[color=orange!30,#1]{\small {\textbf{MiPi:} #2}}}
\newcommand{\gs}[2][]{\todo[color=blue!20,#1]{\small {\textbf{GS:} #2}}}
\newcommand{\kk}[2][]{\todo[color=green!20,#1]{\small {\textbf{KK:} #2}}}

\definecolor{blue}{rgb}{0.1,0.2,0.5}
\definecolor{brown}{rgb}{0.6,0.6,0.2}
\usepackage[ocgcolorlinks, linkcolor={blue}, citecolor={brown}]{hyperref}
\usepackage{cleveref}

\usepackage{enumerate}
\usepackage{latexsym}

\usepackage{soul}

\newtheorem{lemma}{Lemma}[section]
\newtheorem{observation}{Observation}[section]
\newtheorem{claim}{Claim}[section]
\newtheorem{theorem}[lemma]{Theorem}
\newtheorem{corollary}[lemma]{Corollary}
\newtheorem{conjecture}[lemma]{Conjecture}

\newcommand{\Oh}{\mathcal{O}}

\newcommand{\argmax}{\text{argmax}}
\newcommand{\argmin}{\text{argmin}}

\newcommand{\distprofile}[3]{\mathrm{prof}_{#1,#2}[#3]}
\newcommand{\tildeprofile}[3]{\widetilde{\mathrm{prof}}_{#1,#2}[#3]}
\newcommand{\barprofile}[3]{\overline{\mathrm{prof}}_{#1,#2}[#3]}

\newcommand{\hatprofile}[3]{\widehat{\mathrm{prof}}_{#1,#2}[#3]}
\newcommand{\diststarprofile}[3]{\mathrm{prof}^\star_{#1,#2}[#3]}
\newcommand{\dist}{\mathrm{dist}}
\newcommand{\ecc}{\mathrm{ecc}}

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\le}{\leqslant}
\renewcommand{\ge}{\geqslant}
\renewcommand{\setminus}{-}

\usepackage{marvosym}

\newcommand{\cutgraph}{\textrm{\CutLeft}}

\usepackage{textpos}


\begin{document}

\author{
  Kacper Kluk% 
  \thanks{Institute of Informatics, University of Warsaw, Poland. \texttt{k.kluk@uw.edu.pl}}
  \and
  Marcin Pilipczuk%
  \thanks{Institute of Informatics, University of Warsaw, Poland. \texttt{m.pilipczuk@uw.edu.pl}}
  \and
  Micha\l{} Pilipczuk%
  \thanks{Institute of Informatics, University of Warsaw, Poland. \texttt{michal.pilipczuk@mimuw.edu.pl}}
  \and
  Giannos Stamoulis%
  \thanks{IRIF, Université Paris Cité, CNRS, Paris, France. \texttt{giannos.stamoulis@irif.fr}}
}


\title{Faster diameter computation in graphs of bounded Euler genus%
  \thanks{
  K.K. and Ma.P. are supported by Polish National Science Centre SONATA BIS-12 grant number 2022/46/E/ST6/00143.
  This work is a part of project BOBR (Mi.P., G.S.) that has received funding from the European Research Council (ERC) 
under the European Union's Horizon 2020 research and innovation programme (grant agreement No.~948057). In particular, a majority of work on this manuscript was done while G.S. was affiliated with University of Warsaw.}}

\date{}

\maketitle

\begin{abstract}
We show that for any fixed integer $k \geq 0$, there exists an algorithm
that computes the diameter and the eccentricies of all vertices of an input
unweighted, undirected $n$-vertex graph of Euler genus at most $k$ in time
 \[ \Oh_k(n^{2-\frac{1}{25}}). \]
Furthermore, for the more general class of graphs
that can be constructed
by clique-sums from graphs that are of Euler genus at most $k$ after deletion
of at most $k$ vertices, we show an algorithm for the same task that achieves the running time bound
 \[ \Oh_k(n^{2-\frac{1}{356}} \log^{6k} n). \]
Up to today, the only known subquadratic algorithms for computing the diameter in those graph classes
are that of [Ducoffe, Habib, Viennot; SICOMP 2022], [Le, Wulff-Nilsen; SODA 2024],
and [Duraj, Konieczny, Pot\k{e}pa; ESA 2024]. These algorithms work
in the more general setting of $K_h$-minor-free graphs,
but the running time bound is $\Oh_h(n^{2-c_h})$ for some constant $c_h > 0$ depending
on $h$. 
That is, our savings in the exponent, as compared to the naive quadratic algorithm, 
are independent of the parameter $k$.

The main technical ingredient of our work is an improved bound on the number of distance
profiles, as defined in [Le, Wulff-Nilsen; SODA 2024], in graphs of bounded Euler genus.
\end{abstract}


\begin{textblock}{20}(11.8,4.35)
  \includegraphics[width=60px]{ERC2.jpg}
\end{textblock}


\section{Introduction}
\input{intro}

\section{Preliminaries}\label{sec:prelims}

\input{prelims}

\section{Distance profiles in graphs of bounded Euler genus}\label{sec:distprofiles}

\input{profiles}

\input{algorithm-genus}

\input{algorithm}

\section*{Acknowledgements}
Marcin thanks Jacob Holm, Eva Rotenberg, and Erik Jan van Leeuwen
for many discussions on subquadratic algorithms for diameter while his stay on sabbatical
in Copenhagen.

\bibliographystyle{plain}
\begin{thebibliography}{10}

  \bibitem{BorradaileDT14}
  Glencora Borradaile, Erik~D. Demaine, and Siamak Tazari.
  \newblock Polynomial-time approximation schemes for subset-connectivity problems in bounded-genus graphs.
  \newblock {\em Algorithmica}, 68(2):287--311, 2014.
  
  \bibitem{Cabello19}
  Sergio Cabello.
  \newblock Subquadratic algorithms for the diameter and the sum of pairwise distances in planar graphs.
  \newblock {\em {ACM} Transactions on Algorithms}, 15(2):21:1--21:38, 2019.
  
  \bibitem{CabelloK09}
  Sergio Cabello and Christian Knauer.
  \newblock Algorithms for graphs of bounded treewidth via orthogonal range searching.
  \newblock {\em Computational Geometry}, 42(9):815--824, 2009.
  
  \bibitem{CabelloCL12algo}
  Sergio Cabello, Éric {Colin de Verdière}, and Francis Lazarus.
  \newblock Algorithms for the edge-width of an embedded graph.
  \newblock {\em Computational Geometry}, 45(5):215--224, 2012.
  \newblock Special issue: 26th Annual Symposium on Computation Geometry at Snowbird, Utah, USA.
  
  \bibitem{DucoffeHV22}
  Guillaume Ducoffe, Michel Habib, and Laurent Viennot.
  \newblock Diameter, eccentricities and distance oracle computations on ${H}$-minor free graphs and graphs of bounded (distance) {V}apnik-{C}hervonenkis dimension.
  \newblock {\em {SIAM} Journal on Computing}, 51(5):1506--1534, 2022.
  
  \bibitem{DurajKP23}
  Lech Duraj, Filip Konieczny, and Krzysztof Pot\k{e}pa.
  \newblock Better diameter algorithms for bounded {VC}-dimension graphs and geometric intersection graphs.
  \newblock In {\em 32nd Annual European Symposium on Algorithms, {ESA} 2024}, volume 308 of {\em LIPIcs}, pages 51:1--51:18. Schloss Dagstuhl --- Leibniz-Zentrum f{\"{u}}r Informatik, 2024.
  
  \bibitem{EricksonW05}
  Jeff Erickson and Kim Whittlesey.
  \newblock Greedy optimal homotopy and homology generators.
  \newblock In {\em Proc. of the 16th Annual {ACM-SIAM} Symposium on Discrete Algorithms, {SODA} 2005}, pages 1038--1046. {SIAM}, 2005.
  
  \bibitem{GawrychowskiKMS21}
  Pawe\l{} Gawrychowski, Haim Kaplan, Shay Mozes, Micha Sharir, and Oren Weimann.
  \newblock Voronoi diagrams on planar graphs, and computing the diameter in deterministic $\widetilde{O}(n^{5/3})$ time.
  \newblock {\em {SIAM} Journal on Computing}, 50(2):509--554, 2021.
  
  \bibitem{KorhonenPS24}
  Tuukka Korhonen, Micha\l{} Pilipczuk, and Giannos Stamoulis.
  \newblock Minor {C}ontainment and {D}isjoint {P}aths in almost-linear time.
  \newblock {\em CoRR}, abs/2404.03958, 2024.
  
  \bibitem{KorhonenPST24priv}
  Tuukka Korhonen, Micha\l{} Pilipczuk, Giannos Stamoulis, and Dimitrios Thilikos, 2024.
  \newblock Private communication.
  
  \bibitem{LeW24}
  Hung Le and Christian Wulff{-}Nilsen.
  \newblock {VC} set systems in minor-free (di)graphs and applications.
  \newblock In {\em 2024 {ACM-SIAM} Symposium on Discrete Algorithms, {SODA} 2024}, pages 5332--5360. {SIAM}, 2024.
  
  \bibitem{MoharT01grap}
  Bojan Mohar and Carsten Thomassen.
  \newblock {\em Graphs on Surfaces}.
  \newblock Johns Hopkins series in the mathematical sciences. Johns Hopkins University Press, 2001.
  
  \bibitem{RobertsonS03a}
  Neil Robertson and Paul~D. Seymour.
  \newblock Graph {M}inors. {XVI.} {E}xcluding a non-planar graph.
  \newblock {\em Journal of Combinatorial Theory, Series {B}}, 89(1):43--76, 2003.
  
  \bibitem{RodittyW13}
  Liam Roditty and Virginia~Vassilevska Williams.
  \newblock Fast approximation algorithms for the diameter and radius of sparse graphs.
  \newblock In {\em 45th Symposium on Theory of Computing Conference, STOC 2013}, pages 515--524. {ACM}, 2013.
  
  \bibitem{Sauer72}
  Norbert Sauer.
  \newblock On the density of families of sets.
  \newblock {\em Journal of Combinatorial Theory, Series A}, 13(1):145--147, 1972.
  
  \bibitem{Shelah72}
  Saharon Shelah.
  \newblock A combinatorial problem; stability and order for models and theories in infinitary languages.
  \newblock {\em Pacific Journal of Mathematics}, 41(1):247 -- 261, 1972.
  
  \bibitem{StahlB77}
  Saul Stahl and Lowell~W. Beineke.
  \newblock Blocks and the nonorientable genus of graphs.
  \newblock {\em Journal of Graph Theory}, 1(1):75--78, 1977.
  
  \bibitem{ThilikosW22}
  Dimitrios~M. Thilikos and Sebastian Wiederrecht.
  \newblock Killing a vortex.
  \newblock In {\em 63rd {IEEE} Annual Symposium on Foundations of Computer Science, {FOCS} 2022}, pages 1069--1080. {IEEE}, 2022.
  
  \bibitem{VapnikC71}
  V.~N. Vapnik and A.~Ya. Chervonenkis.
  \newblock On the uniform convergence of relative frequencies of events to their probabilities.
  \newblock {\em Theory of Probability \& Its Applications}, 16(2):264--280, 1971.
  
  \bibitem{Willard85}
  Dan~E. Willard.
  \newblock New data structures for orthogonal range queries.
  \newblock {\em SIAM Journal on Computing}, 14(1):232--253, 1985.
  
  \bibitem{WulffNilsen11}
  Christian Wulff{-}Nilsen.
  \newblock Separator theorems for minor-free and shallow minor-free graphs with applications.
  \newblock {\em CoRR}, abs/1107.1292, 2011.
  
  \end{thebibliography}

\end{document}
