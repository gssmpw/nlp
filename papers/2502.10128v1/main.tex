\documentclass[11pt,reqno]{amsart}

\usepackage{amsfonts, amsthm, amsmath, amssymb}
\allowdisplaybreaks[4]

\usepackage{tikz} %\UTF{7ED8}\UTF{56FE}%

\usepackage{float} %使用浮\UTF{52A8}体(表格、\UTF{56FE}片)
\usepackage{multirow} %表格\UTF{7EB5}向合并\UTF{5355}元格
\usepackage{supertabular} %制作超\UTF{8FC7}一\UTF{9875}的表格

%定\UTF{4E49}\UTF{7F57}\UTF{9A6C}数字
\makeatletter
\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother

\usepackage{enumerate} %列表\UTF{73AF}境
\usepackage[inline]{enumitem} %列表\UTF{7F16}号

\usepackage[pagebackref]{hyperref} %超\UTF{94FE}接功能, pagebackref\UTF{5B9E}\UTF{73B0}参考文献与正文的双向\UTF{94FE}接
\hypersetup{colorlinks=true} %取消超\UTF{94FE}接\UTF{8FB9}框，\UTF{94FE}接文字\UTF{5E26}\UTF{989C}色

\usepackage{mathabx}

\numberwithin{equation}{section}
\topmargin 0.8in
\textheight=8.2in
\textwidth=6.4in
\voffset=-.68in
\hoffset=-.68in
%\renewcommand{\baselinestretch}{1.2}
\def\numset#1{{\mathbb #1}}
\def\blue{\textcolor{blue}}
\def\red{\textcolor{red}}
\def\magenta{\textcolor{magenta}}
\theoremstyle{plain}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{St}[theorem]{Statement}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{Fact}[theorem]{Fact}
\theoremstyle{definition}
\newtheorem{Def}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{conj}[theorem]{Conjecture}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{?}[theorem]{Problem}

\newcommand{\SF}[1]{\color{magenta}#1}

%%% Notations
\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\D}{\mathcal{D}}
\renewcommand{\L}{\mathcal{L}}
\renewcommand{\P}{\mathcal{P}}
\renewcommand{\S}{\mathfrak{S}}
\newcommand{\W}{\mathcal{W}}
\def\des{\mathrm{des}}
\def\std{\mathrm{std}}
\def\st{\mathrm{st}}
\def\inv{\mathrm{inv}}
\def\blk{\mathrm{blk}}
\def\sing{\mathrm{sing}}
\def\Par{\mathrm{Par}}

\begin{document}

\title[Consecutive and quasi-consecutive patterns]{Consecutive and quasi-consecutive patterns: $\mathrm{des}$-Wilf classifications and generating functions}


\author[Y. Wang, Q.Fang, S. Fu, S. Kitaev, H. Li]{Yan Wang, Qi Fang, Shishuo Fu, Sergey Kitaev, Haijun Li}
\address[Yan Wang]{College of Mathematics and Statistics, Chongqing University, Chongqing 401331, P.R. China}
\email{yanw2143@foxmail.com}
\address[Qi Fang]{College of Mathematics and Statistics, Chongqing University, Chongqing 401331, P.R. China}
\email{qifangpapers@163.com}
\address[Shishuo Fu]{College of Mathematics and Statistics, Chongqing University, Chongqing 401331, P.R. China}
\email{fsshuo@cqu.edu.cn}
\address[Sergey Kitaev]{Department of Mathematics and Statistics, University of Strathclyde, 26 Richmond Street, Glasgow G1 1XH, UK}
\email{sergey.kitaev@strath.ac.uk}
\address[Haijun Li]{College of Mathematics and Statistics, Chongqing University, Chongqing 401331, P.R. China}
\email{lihaijun@cqu.edu.cn}

\date{\today}

\begin{abstract}
Motivated by a correlation between the distribution of descents over permutations that avoid a consecutive pattern and those avoiding the respective quasi-consecutive pattern, as established in this paper, we obtain a complete $\des$-Wilf classification for quasi-consecutive patterns of length up to 4. For equivalence classes containing more than one pattern, we construct various descent-preserving bijections to establish the equivalences, which lead to the provision of proper versions of two incomplete bijective arguments previously published in the literature. Additionally, for two singleton classes, we derive explicit bivariate generating functions using the generalized run theorem.
\end{abstract}

\maketitle

\section{Introduction}

\input{introduction.tex}


\section{Structure Theorem and classification of length-3 quasi-consecutive patterns}\label{sec:structure theorem}

\input{structure_thm.tex}    

\section{des-Wilf classification of length 4 quasi-consecutive patterns} \label{sec:classifications of 4}

\input{classification_for_length4.tex}

\section{Generating functions} \label{sec:g.f. of 4}

\input{generating_function.tex}

\section{Conclusion}\label{conclusion}

This paper provides a complete $\des$-Wilf classification for quasi-consecutive patterns of length up to 4. Extending this classification to longer patterns would be interesting but may not be feasible with existing tools. Indeed, determining the descent distributions for consecutive patterns of length 4 or more is already a complex task, and even if successful, evaluating the integral in Theorem~\ref{id:struc} may not be possible. Nevertheless, descent distributions can still be studied over more restrictive sets of permutations, specifically when, in addition to avoiding a quasi-consecutive pattern, further constraints are imposed (e.g., avoidance of another pattern, a prescribed beginning or end of a permutation, etc.).

Finally, studying other permutation statistics, such as left-to-right and right-to-left minima and maxima  (see \cite{HK} for definitions), on permutations that avoid quasi-consecutive patterns would be an interesting direction for future research, extending our study of descents on such permutations.

\section{appendix}\label{sec:appendix}

To state the generalized run theorem, we start by introducing some definitions on words and compositions, then we review some basic facts about noncommutative symmetric functions. 

Given an alphabet $A$, the set of all words over $A$ is denoted by $A^*$, which is a free monoid under the operation of concatenation. If $A$ is a totally ordered set and $w \in A^*$, we call maximal weakly increasing consecutive subsequence in $w$ an \emph{increasing run} of $w$. It is clear that each word $w$ can be decomposed uniquely into a sequence of increasing runs. For example, let $\mathbf{P}$ denote the set of positve integers, then the word $w=73344256 \in \mathbf{P}^*$ is decomposed into three increasing runs, namely $7$, $3344$, and $256$.

Reall that for a permutation $\pi \in \S_n$, $\mathrm{Des}(\pi):=\{i \in [n-1]:\pi_i>\pi_{i+1}\}$ denotes the descent set of $\pi$. Clearly $\mathrm{Des}(\pi) \subseteq [n-1]$ and the lengths of increasing runs in $\pi$ from left to right constitute a composition of $n$. We call this composition the \emph{descent composition} of $\pi$, denoted as $\mathrm{Comp}(\pi)$. For example if $\pi=413782596$, then $\mathrm{Des}(\pi)=\{1,5,8\}$ and $\mathrm{Comp}(\pi)=\{1,4,3,1\}$. Obviously one can recover $\mathrm{Des(\pi)}$ from $\mathrm{Comp}(\pi)$ or the other way around. For $n\geq 1$ and $\pi \in \S_n$, we have $$|\mathrm{Comp}(\pi)|=\mathrm{des}(\pi)+1=|\mathrm{Des(\pi)}|+1.$$

Zhuang's generalized run theorem was developed to count words and permutations with restrictions on the lengths of their increasing runs.

Let $F$ be a field of characteristic zero. Denote by $F\left\langle\left\langle X_1, X_2, \ldots\right\rangle\right\rangle$ the $F$-algebra of formal power series in noncommuting variables $X_1, X_2, \ldots$. For $n \geq 1$, let

$$
\mathbf{h}_n:=\sum_{1 \leq i_1 \leq \cdots \leq i_n} X_{i_1} X_{i_2} \cdots X_{i_n}
$$and set $\mathbf{h}_0=1$. Then for any composition $L=\left(L_1, \ldots, L_l\right)$, let $\mathbf{h}_L:=\mathbf{h}_{L_1} \cdots \mathbf{h}_{L_l}$. The $F$-algebra $\mathbf{S y m}$ generated by the elements $\mathbf{h}_L$ is called the algebra of noncommutative symmetric functions with coefficients in $F$, which is a subalgebra of $F\left\langle\left\langle X_1, X_2, \ldots\right\rangle\right\rangle$. The vector space $\mathbf{S y m}_n$ of noncommutative symmetric functions homogeneous of degree $n$ is the span of the set $\left\{\mathbf{h}_L\right\}_{L \vdash n}$, where $L\vdash n$ means $L$ is a composition of $n$.

Next, we are going to introduce another base $\left\{\mathbf{r}_L\right\}_{L \vdash n}$ for the vector space of noncommutative symmetric functions homogeneous of degree $n$, see \cite{GKLLRT95} for more information about noncommutative symmetric functions. 

For any composition $L=\left(L_1, \ldots, L_l\right) \vdash n$, let

$$
\mathbf{r}_L:=\sum_{\left(i_1, \ldots, i_n\right)} X_{i_1} X_{i_2} \cdots X_{i_n}
$$where the sum is over all $\left(i_1, \ldots, i_n\right)$ satisfying

$$
\underbrace{i_1 \leq \cdots \leq i_{L_1}}_{L_1}>\underbrace{i_{L_1+1} \leq \cdots \leq i_{L_1+L_2}}_{L_2}>\cdots>\underbrace{i_{L_1+\cdots+L_{l-1}+1} \leq \cdots \leq i_n}_{L_l} .
$$

Define a partial order ``$\leq$'' on the set of compositions of $n$ by reverse refinement, that is, $K=\left(K_1, \ldots, K_k\right) \vdash n$ covers $L$ if and only if $L$ can be obtained from $K$ by replacing two consecutive parts $K_i$ and $K_{i+1}$ with $K_i+K_{i+1}$. It is easy to see that 


$$
\mathbf{h}_L=\sum_{K \leq L} \mathbf{r}_K.
$$Thus, by inclusion-exclusion we have

$$
\mathbf{r}_L=\sum_{K \leq L}(-1)^{\#L-\#K} \mathbf{h}_K,
$$where $\#L$ denotes the number of parts in $L$. Note that the functions $\mathbf{h}_L$ and $\mathbf{r}_L$ are noncommutative versions of the \emph{complete symmetric functions} and the \emph{ribbon Schur functions} (see \cite[Chap.~7]{sta11}), respectively.

Define the homomorphism $\Phi: \mathbf{S y m} \rightarrow F[[x]]$ by $\Phi\left(\mathbf{h}_n\right)=\dfrac{x^n}{n!}$. Then, $$\Phi(\mathbf{h}_{L})=\frac{x^{L_1}}{L_1 !}\cdots \frac{x^{L_l}}{L_l !}=\binom{n}{L}\frac{x^n}{n!},$$
where we use the abbreviation for multinomial coefficient $\binom{n}{L}:=\binom{n}{L_1,\ldots,L_l}$. Although noncommutative symmetric functions are generating functions for words, the following lemma allows us to move from the realm of word enumeration to that of permutation enumeration.

\begin{lemma}{\cite{zhu17}}
For a given composition $L\vdash n$, we have  
\begin{equation}\label{homomorphsim}
\Phi (\mathbf{r}_L)=\sum_{\substack{\pi \in \S_n\\ \mathrm{Comp}(\pi)=L}} \frac{x^n}{n!}
\end{equation}
\end{lemma}

\begin{Def}{(\emph{run network})} A digraph $G$ on vertex set $[m]$ where each arc $(i, j)$ is assigned a nonempty subset $P_{i, j} \subseteq \mathbf{P}$ is called a network of order $m$. Given such a network, let $P$ be the set of all pairs $(a, e)$ such that $a \in P_{i, j}$ and $e=(i, j)$ is an arc of $G$. Furthermore, let $\overrightarrow{P^*} \subseteq P^*$ be the subset of all sequences $\alpha=\left(a_1, e_1\right)\left(a_2, e_2\right) \cdots\left(a_n, e_n\right)$ such that $e_1 e_2 \cdots e_n$ is a walk in $G$.

Let $(G, P)$ be a network of order $m$ with $\overrightarrow{P^*}$ as constructed above. For $\alpha=\left(a_1, e_1\right) \cdots\left(a_n, e_n\right) \in \overrightarrow{P^*}$ with $i$ and $j$ respectively the initial and terminal vertices of the walk $e_1 \cdots e_n$, let $\rho(\alpha)=\left(a_1, a_2, \ldots, a_n\right)$ and $E(\alpha)=(i, j)$. Then $(G, P)$ is a run network of order $m$ if for any $\alpha, \beta \in \overrightarrow{P^*}$, whenever $\rho(\alpha)=\rho(\beta)$ and $E(\alpha)=E(\beta)$, there is $\alpha=\beta$. In other words, the same tuple $\left(a_1, a_2, \ldots, a_n\right)$ cannot be obtained by traversing two different walks in $G$ with the same initial and terminal vertices.
\end{Def}


\begin{theorem}{(Generalized Run Theorem~\cite{zhu17})}\label{thm:gen run thm}
  Suppose that $(G, P)$ is a run network of order $m$ and $A$ is a unital $F$-algebra of characteristic zero. Let $\left\{w_a^{(i , j)}:(a,(i, j)) \in P\right\}$ be a set of weights from $A$, with $w_a^{(i, j)}=0$ if $(a,(i, j)) \notin P$. For a composition $L=\left(L_1, \ldots, L_l\right)$ and $i, j \in[m]$, let $w^{(i, j)}(L)=w_{L_1}^{e_1} \cdots w_{L_l}^{e_l}$ if there exists $\alpha=\left(L_1, e_1\right) \cdots\left(L_l, e_l\right) \in \overrightarrow{P^*}$ such that $E(\alpha)=(i, j)$ and $L=\rho(\alpha)$, and let $w^{(i, j)}(L)=0$ otherwise. Let $v_n^{(i, j)}$ be defined by
    
\begin{align*}
      \left[\begin{array}{ccc}
      \sum\limits_{n \geq 0} v_n^{(1,1)} x^n & \cdots & \sum\limits_{n \geq 0} v_n^{(1, m)} x^n \\
      \vdots & \ddots & \vdots \\
      \sum\limits_{n \geq 0} v_n^{(m, 1)} x^n & \cdots & \sum\limits_{n \geq 0} v_n^{(m, m)} x^n
  \end{array}\right]=\left(I_m+\left[\begin{array}{ccc}
      \sum\limits_{k \geq 1} w_k^{(1,1)} x^k & \cdots & \sum\limits_{k \geq 1} w_k^{(1, m)} x^k \\
      \vdots & \ddots & \vdots \\
      \sum\limits_{k \geq 1} w_k^{(m, 1)} x^k & \cdots & \sum\limits_{k \geq 1} w_k^{(m, m)} x^k
  \end{array}\right]\right)^{-1},
\end{align*}

  where $I_m$ denotes the $m \times m$ identity matrix. Then
    
  \begin{align}
      \left[\begin{array}{ccc}\label{nonComGen}
      \sum\limits_L w^{(1,1)}(L) \mathbf{r}_L & \cdots & \sum\limits_L w^{(1, m)}(L) \mathbf{r}_L \\
      \vdots & \ddots & \vdots \\
      \sum\limits_L w^{(m, 1)}(L) \mathbf{r}_L & \cdots & \sum\limits_L w^{(m, m)}(L) \mathbf{r}_L
  \end{array}\right]=\left[\begin{array}{ccc}
      \sum\limits_{n \geq 0} v_n^{(1,1)} \mathbf{h}_n & \cdots & \sum\limits_{n \geq 0} v_n^{(1, m)} \mathbf{h}_n \\
      \vdots & \ddots & \vdots \\
      \sum\limits_{n \geq 0} v_n^{(m, 1)} \mathbf{h}_n & \cdots & \sum\limits_{n \geq 0} v_n^{(m, m)} \mathbf{h}_n
  \end{array}\right]^{-1},
  \end{align}

    
  where each sum in the matrix on the left-hand side is over all compositions $L$.
\end{theorem}

\section*{acknowledgement}
We are grateful to Quan Yuan for her help in finding the $\des$-Wilf-equivalence classifications
for quasi-consecutive patterns of length $4$. 


\begin{thebibliography}{99}
%    \bibitem{bax14} A.~M.~Baxter, Refining enumeration schemes to count according to permutation statistics, {\em Electron. J. Combin.} {\bf21} (2014), \#P2.50.

    \bibitem{BP12} A.~M.~Baxter and L.~K.~Pudwell, Enumeration schemes for vincular patterns, {\em Discrete Math.} {\bf312} (2012), 1699--1712.

    \bibitem{BS15} A.~M.~Baxter and M.~Shattuck, Some Wilf-equivalences for vincular patterns, {\em J. Comb.} {\bf6} (2015), 19--45.

    \bibitem{BDGZ19}C. Bielawa, R. Davis, D. Greeson and Q. Zhou, Descents and des-Wilf equivalence of permutations avoiding certain nonclassical patterns, {\em Involve} \textbf{12} (2019), 549--563. 

    \bibitem{Bukata2019}
    M. Bukata, R. Kulwicki, N. Lewandowski, L. Pudwell, J. Roth, T.	Wheeland. Distributions of statistics over pattern-avoiding permutations. {\em J. Integer Sequences} {\bf 22} (2019) Article 19.2.6.

    \bibitem{CN18} E.~Chen and S.~Narayanan, The 26 Wilf-equivalence classes of length five quasi-consecutive patterns, {\em Discrete Math. Theor. Comput. Sci.} {\bf20} (2018), \#12.
    
    \bibitem{cla01}A. Claesson, Generalized pattern avoidance, {\em European J. Combin.} \textbf{22} (2001), 961--971.

    \bibitem{eli06} S.~Elizalde, Asymptotic enumeration of permutations avoiding generalized patterns, {\em Adv. Appl. Math.} {\bf36} (2006), 138--155.
    
    \bibitem{eliz16} S.~Elizalde, A survey of consecutive patterns in permutations, {\em IMA Vol. Math. Appl.} {\bf 159}, Springer, [Cham], 2016. 

%    \bibitem{EN03} S. Elizalde and M. Noy, Consecutive patterns in permutations, {\em Adv. Appl. Math.} \textbf{30} (2003), 110--125.
    \bibitem{FS70} D.~Foata and M.-P.~Sch\"utzenberger, {\it Th\'eorie g\'eom\'etrique des polyn\^omes eul\'eriens}, Lecture Notes in Mathematics, {\bf138}, Berlin, Springer (1970).

    \bibitem{FTHZ19} S. Fu, D. Tang, B. Han and J. Zeng, $(q,t)$-Catalan numbers: gamma expansions, pattern avoidances, and the $(-1)$-phenomenon, {\em Adv. Appl. Math.} \textbf{106} (2019), 57--95.

   \bibitem{GKLLRT95}I.M. Gelfand, D. Krob, A. Lascoux, B. Leclerc, V.S. Retakh, and J.Y. Thibon, Noncommutative symmetrical functions, {\em Adv. Math.} \textbf{112} (1995), 218--348.

\bibitem{HK} T. Han and S. Kitaev, Joint distributions of statistics over permutations avoiding two patterns of length 3, {\em Discr. Math. and Theor. Comput. Sci.} {\bf 26:1}, Permutation Patterns 2023, (2024),  \#4 .

    \bibitem{kit05} S.~Kitaev, Partially ordered generalized patterns, {\em Discr. Math.} {\bf298} (2005), 212--229.
    
    \bibitem{kit11} S. Kitaev, {\it Patterns in Permutations and Words}, Springer Berlin, Heidelberg (2011).
    
    \bibitem{knu75} D. E. Knuth, {\it The art of computer programming, vol. 1, Fundamental Algorithms, 2nd edition}, Addison-Wesley Series in Computer Science and Information Processing, Addison-Wesley (1975).  
    
    \bibitem{mac60} P. A. MacMahon, {\it Combinatory analysis}, Chelsea, New York (1960).

    \bibitem{MR06} A. Mendes and J. Remmel, Permutations and words counted by consecutive patterns, {\em Adv. Appl. Mathem.} {\bf37} (2006), 443--480.
    
    \bibitem{pet15}T. K. Petersen, {\it Eulerian Numbers}, Birkh\"auser, New York (2015).

    \bibitem{rei95} V.~Reiner, The distribution of descents and length in a Coxeter group, {\em Electron. J. Combin.} {\bf2} (1995), R25.

    \bibitem{rio58} J.~Riordan, {\it An introduction to combinatorial analysis}, New York, Wiley (1958).

    \bibitem{sag91} B. E.~Sagan, {\it The symmetric group: representations, combinatorial algorithms, and symmetric functions}, Wadsworth (1991).

    \bibitem{SS85} R. Simion and F. W. Schmidt, Restricted permutations, {\em European J. Combin.} \textbf{6} (1985), 383--406.
    
    \bibitem{sta11}R. Stanley, { \it Enumerative Combinatorics}, Vol. 1, 2nd edition, Cambridge Studies in Advanced Mathematics, Cambridge University Press (2011). 
    
    \bibitem{zhu16}Y. Zhuang, Counting permutations by runs, {\em J. Combin. Theory Ser. A} \textbf{142} (2016), 147--176.
    
   \bibitem{zhu17}Y. Zhuang, Eulerian polynomials and descent statistics, {\em Adv. Appl. Math.} \textbf{90} (2017), 86--144.
    
\end{thebibliography}









\end{document}

