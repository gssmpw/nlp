
%\begin{gather}
%\label{eq:all_equations}
%    \text{attn}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}) = 
%    \sigma\left(\frac{\mathbf{W}^K_h\textbf{O}^{Sg}_{i, j} \cdot (\mathbf{W}^Q_h \textbf{O}^{Sp}_{i, j})^ \top}%{\sqrt{d_k}} \mathbf{W}^V_h \textbf{O}^{Sg}_{i, j}\right) \\
%    \textbf{CA}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}) =
%    \text{cat}[\text{attn}_1(\ldots), \ldots, \text{attn}_H(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j})] \\
%    \text{Output} = \text{layernorm}(\textbf{O}^{Sg}_{i, j} + \textbf{CA}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}))
%\end{gather}

% \begin{align}
% \label{eq15}
% \text{attn}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}) = 
%     \sigma\left(\frac{\mathbf{W}^K_h\textbf{O}^{Sg}_{i, j} \cdot (\mathbf{W}^Q_h \textbf{O}^{Sp}_{i, j})^ \top}{\sqrt{d_k}} \mathbf{W}^V_h \textbf{O}^{Sg}_{i, j}\right)
% \end{align}
% \vspace{-20pt}

% \begin{align}
% \label{eq16}
% \textbf{CA}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}) =
%     \text{cat}[\text{attn}_1(\ldots), \ldots, \text{attn}_H(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j})]
% \end{align}
% \vspace{-20pt}

% \begin{align}
% \label{eq17}
% \text{Output} = \text{layernorm}(\textbf{O}^{Sg}_{i, j} + \textbf{CA}(\textbf{O}^{Sg}_{i, j}, \textbf{O}^{Sp}_{i, j}))
% \end{align}
% \vspace{-5pt}

\newcommand{\vect}[1]{\mathbf{#1}}
\newcommand{\sg}{\vect{O}^{Sg}_{i, j}}
\newcommand{\spsp}{\vect{O}^{Sp}_{i, j}}
\newcommand{\whk}{\mathbf{W}^K_h}
\newcommand{\whq}{\mathbf{W}^Q_h}
\newcommand{\whv}{\mathbf{W}^V_h}
\newcommand{\dk}{\sqrt{d_k}}

\begin{align}
\text{Attn}(\sg, \spsp) &= \sigma\left(\frac{(\whk \sg) \cdot (\whq \spsp)^\top}{\dk} \whv \sg\right) \label{eq16}
\end{align}
