\section{Proof of Theorem \ref{theo:strong}}
\label{app:proof}

\begin{proof}
	\label{proof:strong}
	We proceed in two parts: first, we show that if \( \gamma \) is the geodesic path, then the equality holds; second, we show that if the equality holds, then \( \gamma \) must be the geodesic path.
	
	\noindent
	
	\textbf{Sufficiency: If \( \gamma \) is the geodesic, then the equality holds.}
	
	Let \( \gamma \) be the geodesic path connecting \( \overline{\mathbf{x}} \) and \( \mathbf{x} \). By definition of a geodesic in the given Riemannian metric, \( \gamma \) satisfies the geodesic equation:
	\[
	\nabla_{\dot{\gamma}} \dot{\gamma} = 0,
	\]
	where \( \nabla \) is the Levi-Civita connection associated with the metric \( \mathbf{G}_{\mathbf{x}} \). Under the given metric \( \mathbf{G}_{\mathbf{x}} = \nabla f(\mathbf{x}) \nabla f(\mathbf{x})^T \), the geodesic equation implies that \( \dot{\gamma}(t) \) is parallel to \( \nabla f(\gamma(t)) \) for all \( t \in [0,1] \). That is,
	\[
	\dot{\gamma}(t) = \lambda(t) \nabla f(\gamma(t)),
	\]
	for some scalar function \( \lambda(t) \).
	
	Substituting this into the definition of \( A_i^{\gamma}(\mathbf{x}) \), Eq. \ref{eq:attribution}, we obtain:
	\[
	A_i^{\gamma}(\mathbf{x}) = \int_0^1 \frac{\partial f}{\partial x_i}(\gamma(t)) \dot{\gamma}_i(t) \, dt = \int_0^1 \frac{\partial f}{\partial x_i}(\gamma(t)) \lambda(t) \frac{\partial f}{\partial x_i}(\gamma(t)) \, dt.
	\]
	Since \( \lambda(t) \) does not change sign (as \( \gamma \) is a geodesic\footnote{Since $\gamma$ is a geodesic, its velocity is always parallel to the gradient of $f$, so there exists a scalar function $\lambda(t)$ such that
		\[
		\dot{\gamma}(t) = \lambda(t)\nabla f(\gamma(t)).
		\]
		Then, by the chain rule,
		\[
		\frac{d}{dt} f(\gamma(t)) = \nabla f(\gamma(t))\cdot\dot{\gamma}(t)= \lambda(t)\|\nabla f(\gamma(t))\|^2.
		\]
		Assuming $\|\nabla f(\gamma(t))\|^2>0$, the sign of $\frac{d}{dt} f(\gamma(t))$ is completely determined by the sign of $\lambda(t)$. Since $f(\gamma(t))$ changes monotonically (i.e., without backtracking) from $f(\gamma(0))$ to $f(\gamma(1))$, $\lambda(t)$ must maintain a constant sign along $\gamma$. 
		
		Intuitively, $\dot{\gamma}(t)=\lambda(t)\nabla f(\gamma(t))$ means that $\gamma$ is always moving in the direction of steepest ascent (or descent) of $f$, with $\lambda(t)$ scaling its speed. Any reversal in the sign of $\lambda(t)$ would indicate a change in the direction of motion relative to $\nabla f$, corresponding to backtrackingâ€”a behaviour that contradicts the optimality of a geodesic. Thus, the monotonic variation of $f(\gamma(t))$ ensures that $\lambda(t)$ does not change sign.
		}), the integrand \( \frac{\partial f}{\partial x_i}(\gamma(t)) \dot{\gamma}_i(t) \) maintains a consistent sign across all \( i \) and \( t \). Therefore,
	\[
	\sum_{i=1}^n \left| A_i^{\gamma}(\mathbf{x}) \right| = \left| \sum_{i=1}^n A_i^{\gamma}(\mathbf{x}) \right|.
	\]
	By the Fundamental Theorem of Calculus,
	\[
	\sum_{i=1}^n A_i^{\gamma}(\mathbf{x}) = \int_0^1 \frac{d}{dt} f(\gamma(t)) \, dt = f(\mathbf{x}) - f(\overline{\mathbf{x}}).
	\]
	Thus,
	\[
	\sum_{i=1}^n \left| A_i^{\gamma}(\mathbf{x}) \right| = \left| f(\mathbf{x}) - f(\overline{\mathbf{x}}) \right|.
	\]

	\noindent
	\textbf{Necessity: If the equality holds, then \( \gamma \) is the geodesic.}
	
	Suppose \( \gamma \) is a smooth path such that
	\[
	\sum_{i=1}^n \left| A_i^{\gamma}(\mathbf{x}) \right| = \left| f(\mathbf{x}) - f(\overline{\mathbf{x}}) \right|.
	\]
	By the triangle inequality,
	\[
	\sum_{i=1}^n \left| A_i^{\gamma}(\mathbf{x}) \right| \geq \left| \sum_{i=1}^n A_i^{\gamma}(\mathbf{x}) \right| = \left| f(\mathbf{x}) - f(\overline{\mathbf{x}}) \right|.
	\]
	Equality holds if and only if all \( A_i^{\gamma}(\mathbf{x}) \) share the same sign. This implies that the integrand \( \frac{\partial f}{\partial x_i}(\gamma(t)) \dot{\gamma}_i(t) \) does not change sign for any \( i \) or \( t \). Consequently, \( \nabla f(\gamma(t)) \cdot \dot{\gamma}(t) \) does not change sign, and \( \dot{\gamma}(t) \) is everywhere parallel to \( \nabla f(\gamma(t)) \). That is,
	\[
	\dot{\gamma}(t) = \lambda(t) \nabla f(\gamma(t)),
	\]
	for some scalar function \( \lambda(t) \).
	
	Under the given Riemannian metric \( \mathbf{G}_{\mathbf{x}} = \nabla f(\mathbf{x}) \nabla f(\mathbf{x})^T \), such paths are precisely the geodesics, connecting \( \overline{\mathbf{x}} \) and \( \mathbf{x} \).
	
	\noindent
	\textbf{Conclusion:} Combining the Necessity and Sufficiency parts above, we can conclude that 
	the equality \( \sum_{i=1}^n \left| A_i^{\gamma}(\mathbf{x}) \right| = \left| f(\mathbf{x}) - f(\overline{\mathbf{x}}) \right| \) holds if and only if \( \gamma \) is the geodesic path connecting \( \overline{\mathbf{x}} \) and \( \mathbf{x} \). 
\end{proof}
\newpage


\section{Additional heatmaps and results on Pascal VOC 2012}
\label{app:voc}

We also qualitatively compare on Figure \ref{fig:more_images} Geodesic IG with the original IG on 5 different images of the Pascal VOC 2012 dataset. In these images Geodesic IG heatmaps appears to to have fewer artefacts and is not sensitive to the choice of baseline being a black image. This is contrary to IG, which assigns no importance to the segments of the image that are black, since they have no difference to the chosen baseline.

\begin{figure}[b!]
\begin{center}
\centerline{\includegraphics[width=0.68\textwidth]{figures/more_images_2.png}}
\caption{Heatmaps of Integrated Gradients (middle) and Geodesic IG (right) on 5 images from the test set of Pascal VOC 2012.}
\label{fig:more_images}
\end{center}
\end{figure}
