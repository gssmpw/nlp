\documentclass[11pt]{article}

% %% full size page
\usepackage{fullpage}
\usepackage[margin = 2.5cm]{geometry}

% author
\usepackage{authblk}

\usepackage[round]{natbib}

\usepackage[ruled,vlined]{algorithm2e}

\input{header/packages}
\input{header/custom_defs}

\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}

\newtheorem{subclaim}{Claim}[theorem]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{conjecture*}{Conjecture}
\newtheorem{fact}[theorem]{Fact}
\newtheorem*{fact*}{Fact}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{hypothesis}[theorem]{Hypothesis}
\newtheorem*{hypothesis*}{Hypothesis}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{itheorem}[theorem]{Informal Theorem}
\newtheorem{iproposition}[theorem]{Informal Proposition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem*{claim*}{Claim}


\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{construction}[theorem]{Construction}
\newtheorem{example}[theorem]{Example}
\newtheorem{question}[theorem]{Question}
\newtheorem{openquestion}[theorem]{Open Question}
%\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{protocol}[theorem]{Protocol}
\newtheorem{assumption}[theorem]{Assumption}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem*{remark*}{Remark}
%\newtheorem{observation}[theorem]{Observation}
%\newtheorem*{observation*}{Observation}

\renewcommand{\and}{\hspace{1em}} % or any spacing you prefer




\title{
Volume Optimality in Conformal Prediction with Structured Prediction Sets }


\author{    
    Chao Gao\thanks{Department of Statistics, University of Chicago, Chicago, USA} \and
    Liren Shan\thanks{Toyota Technological Institute at Chicago, Chicago, USA} \and Vaidehi Srinivas\thanks{Department of Computer Science, Northwestern University, Evanston, USA} \and Aravindan Vijayaraghavan\thanks{Department of Computer Science, Northwestern University, Evanston, USA}
    }
\date{}


\begin{document}


\maketitle



\begin{abstract}

Conformal Prediction is a widely studied technique to construct prediction sets of future observations. Most conformal prediction methods focus on achieving the necessary coverage guarantees, but do not provide formal guarantees on the size (volume) of the prediction sets. We first prove an impossibility of volume optimality where any distribution-free method can only find a trivial solution. We then introduce a new notion of volume optimality by restricting the prediction sets to belong to a set family (of finite VC-dimension), specifically a union of $k$-intervals. Our main contribution is an efficient distribution-free algorithm based on dynamic programming (DP) to find a union of $k$-intervals that is guaranteed for any distribution to have near-optimal volume among all unions of $k$-intervals satisfying the desired coverage property. 
By adopting the framework of distributional conformal prediction \citep{chernozhukov2021distributional}, the new DP based conformity score can also be applied to achieve approximate conditional coverage and conditional restricted volume optimality, as long as a reasonable estimator of the conditional CDF is available. 
While the theoretical results already establish volume-optimality guarantees, they are complemented by experiments that demonstrate that our method can significantly outperform existing methods in many settings.




\end{abstract}

\newpage

\tableofcontents

\newpage

\input{paper/intro}

\input{paper/unsupervised}

\input{paper/supervised}

\input{paper/numerical_experiment_arxiv}

\input{paper/conclusion}

\bibliographystyle{plainnat}
\bibliography{ref}

\newpage

\appendix 

\input{paper/related}

\input{paper/appendix_numerical_results}

\input{paper/appendix}

\end{document}
