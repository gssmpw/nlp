\section{Conclusion}

We study conformal prediction with volume optimality 
in both the unsupervised setting and the supervised setting, 
by proposing a new conformity score computed via dynamic programming. In the supervised setting, when consistent estimation of the conditional CDF is available, we prove that the proposed method not only achieves conditional coverage, but the output of prediction set also has approximate conditional volume optimality with respect to the class of unions of $k$ intervals.

Our method is especially suitable to settings where the data generating process is multi-modal or  has a mixture structure. The numerical experiments show that the performance of the method is quite insensitive to the choice of $k$, whenever it is not smaller than the number of modes of the distribution. For future work, it would be interesting to study restricted volume optimality in more general response settings and under other notions of coverage in conformal prediction. 


\section*{Acknowledgments}
This research project was supported by NSF-funded Institute for Data, Econometrics, Algorithms and Learning (IDEAL) through the grants NSF ECCS-2216970 and ECCS-2216912. The research started as part of the IDEAL special program on Reliable and Robust Data Science. Vaidehi Srinivas was supported by the Northwestern Presidential Fellowship.  We also acknowledge the support of the NSF-Simons SkAI institute and the NSF-Simons NITMB institute, and thank Rina Barber and Jing Lei for helpful discussions.