In recent years,
a substantial quantity of multivariate time series data
has been collected from various events and applications
related to the Internet of Things (IoT)~\cite{de2016iot,mahdavinejad2018machine},
web activities~\cite{kawabata2020non,nakamura2023fast},
the spread of infectious diseases~\cite{kimura2022fast}, and
patterns of user behavior~\cite{matsubara2012fast}.
% Especially in real-world scenarios,
In real-world scenarios, in particular,
these data are generated quickly and continuously, making it increasingly important to process them in a streaming fashion.
\par
% Generally,
There are various relationships between observations
in time series (e.g., correlation, independency)
and they are critical features for a wide range of time series analyses,
% \cite{hallac2017toeplitz, hallac2017network, tozzo2021statistical}.
including clustering~\cite{hallac2017toeplitz, obata2024dynamic}, forecasting~\cite{Yuqietal-2023-PatchTST}, imputation~\cite{wang2023networked}, and others~\cite{tozzo2021statistical}.
Among them, causality
\cite{bollen1989structural, spirtes2000causation}
offers particularly valuable insight,
with many studies dedicated to its investigation
\cite{he2021daring, fujiwara2023causal}
and improving downstream tasks by employing it as an inductive bias, guiding the learning process towards more generalizable representations
\cite{dai2022graph, cheng2023cuts}.
However, most existing methods assume that causal relationships do not evolve over time in multivariate time series~\cite{runge2018causal}.
It is crucial to discover such causal relationships
if we are to detect new causative factors promptly
and accurately forecast in a streaming fashion.
Their pivotal role becomes increasingly apparent upon
recognizing that real-world data streams contain these relationships.
For example,
with the spread of infectious diseases,
when a new virus strain emerges in a country,
certain activities, such as cross-border travel,
can lead to an increase in the number of infections in other countries,
and the causative countries change over time.
Here, we refer to such time-changing causal relationships as ``\textit{\relation}.''
So, how can we discover the \relation in data streams and 
model semi-infinite multivariate data sequences?
\par
Briefly, we design our model based on the structural equation model (SEM)~\cite{pearl2009causality}, 
which is often utilized for learning causal structures.
This model consists of two types of variables:
endogenous variables and exogenous variables.
The former are determined by the model itself,
while the latter exist outside the model.
In addition,
exogenous variables are independent of each other
and follow a non-Gaussian distribution.
In our work, we consider that the causal relationships in data streams evolve over time in accordance with the dynamic changes of exogenous variables.
\par
There are two difficulties involved in
designing a model for discovering \relation.
\textit{(i) Latent temporal dynamics in univariate time series}:
As pointed out above,
exogenous variables in the structural equation model
are independent of each other,
so it is unsuitable to consider
them as multivariate time series.
Therefore, we need to capture latent temporal dynamics in univariate time series
to discover the \relation.
However, it is challenging to design an appropriate system for univariate time series
because the latent temporal dynamics in the system are generally multi-dimensional,
and so a single dimension is insufficient for modeling the system.
We solve this issue by expressing univariate time series
as the superposition of computed basis vectors (i.e., modes) associated with
decay rate and temporal frequency.
\textit{(ii) Distinct dynamical patterns}:
Data streams typically contain various types of distinct dynamical patterns, and
they are factors that change causal relationships over time.
It is essential to understand their changes
if we are to model an entire data stream effectively.
For example,
in the context of web search activities,
we can identify various types of pattern changes
caused by a multitude of reasons, such as a new item release.
In addition, the event influences sales of other items, so the causal relationships could also change.
We refer to these distinct dynamical patterns in data streams as ``\textit{regimes}.''
\par
\TSK{
\input{components/fig_crown}
}
In this paper, we present \method\footnote{Our source codes and datasets are available at~\cite{code}},
% which deals with the above difficulties
which
simultaneously and continuously
% recognizes the change points of dynamical patterns,
discovers \relation in a multivariate co-evolving data stream
and forecasts future values.
% in a streaming fashion.
In addition, 
thanks to desirable features of modes,
\method extracts
the temporal behavior of the latent dynamics in each exogenous variable in terms of decay rate and temporal frequency by analyzing the corresponding eigenvalues.
\\ In short, the problem we deal with is as follows:
\vspace{1.15mm} \\
\textit{\noindent\textbf{Given:} a semi-infinite multivariate data stream $\mat{X}$, which consists of $d$-dimensional vectors $\vect{x}(t)$, i.e., $\mat{X} = \{ \vect{x}(1), ..., \vect{x}(t_c), ... \}$, where $t_c$ is the current time,
{\setlength{\leftmargini}{24pt}
\begin{itemize}
\item \textbf{Find} distinct dynamical patterns (\textit{i.e., regimes}),
\item \textbf{Discover} causal relationships that changes in accordance with the transitions of regimes (\textit{i.e., \relation}),
% \item \textbf{Identify} time-evolving relationships based on variables generating processes (\textit{i.e., \relation}),
% \item \textbf{Uncover} structure of inherent signals specific (i.e., decay rates and temporal frequencies),
% \item \textbf{Extract} interpretable latent dynamics (i.e., decay rates and temporal frequencies),
\item \textbf{Forecast} an $l_s$-steps-ahead future value, i.e., $\vvec(t_c+l_s)$,
\end{itemize}
}
% \vspace{0.2em}
continuously and quickly, in a streaming fashion.
% \vspace{0.5em}
}\par\noindent
\vspace{-2.0em}
\subsection{Preview of Our Results}
Figure \ref{fig:crown} shows the results obtained with \method
for modeling an epidemiological data stream (i.e., \covid).
This dataset consists of the number of COVID-19 infected patients in five countries (i.e., Japan, the United States, China, Italy, and the Republic of South Africa).
Our method captures the following properties: \par
\par
\myparaitemize{\Relation}
Figure \ref{fig:crown} (a) shows
the causal relationships
between observations, which change over time.
% based on variables generating processes.
The arrows indicate causality:
the base of each arrow represents the ``cause,''
while the head represents the ``effect.''
% The above causality is expressed using the structural equation $x_i = \sum_j b_{ij}x_j + e_i$,
% where $e_i$ in the equation corresponds to each inherent signal
\method successfully discovers the time-changing causal relationships between countries from an epidemiological data stream.
For example,
Figure \ref{fig:crown} (a-i) shows that the Republic of South Africa had a causal influence on other countries.
% with the exception of China.
This finding corresponds to the fact that
health officials announced the discovery of a new lineage of the coronavirus, namely 501.V2, in South Africa on December 18, 2020~\cite{covid19_africa},
and indicates that \method adaptively discovered the influence of the new coronavirus on other countries.
Additionally, Figure \ref{fig:crown} (a-ii) shows that China had a causal influence on other countries in contrast to Figure \ref{fig:crown} (a-i).
This insight aligns with the period of one of the longest and toughest lockdowns in Shanghai, which lasted from early April 2022 to June 1, 2022~\cite{covid19_china}.
% In other words,
It implies that
\method detected the influence of the spread of coronavirus infection in Shanghai,
which led to a strict and long-term lockdown.
In summary, the above discussions make it clear that
\method can capture the transitions of distinct dynamical patterns in an epidemiological data stream and
adaptively discover causal relationships at any given moment.
\par
% \myparaitemize{Latent dynamics}
% Figures \ref{fig:crown} (a/b-iv) show the interpretable latent dynamics of each inherent signal in Figures \ref{fig:crown} (a/b-ii).
% The graphs are complex planes, and the dotted gray circle is a unit circle.
% Also, the colored dots in the graph are eigenvalues,
% % where the argument and the magnitude of ones
% whose argument and magnitude
% imply the temporal frequency and the decay rate of modes, respectively.
% (please see the Figure \ref{fig:model:multi} to the right and Section \ref{section:uni} for a detailed explanation of their interpretability).
% For example, the inherent signal of ``Keystone"
% at the current time $t_c=208$ consists of three modes:
% one without seasonality, the other two with seasonality,
% and all exhibiting decay rates slightly less than 1.
% % Also, comparing the top and bottom of Figure \ref{fig:crown}
% Also, a comparison of Figures \ref{fig:crown} (a-iv) and Figures \ref{fig:crown} (b-iv)
% indicates that
% their decay rates increase over time.
% \par
% \vspace{-0.2em}
% Consequently, our method can capture time-evolving causality and latent dynamics in a current window and forecast $l_s$-steps-ahead future values, simultaneously at any time.
\myparaitemize{Latent temporal dynamics}
Figure \ref{fig:crown} (b) shows the eigenvalues of latent temporal dynamics in exogenous variables.
These figures represent complex planes.
The dotted gray lines are unit circles, and
colored points are eigenvalues of latent temporal dynamics,
whose magnitude and argument indicate the decay rate and temporal frequency of a specific mode, respectively.
Specifically, if the absolute value of an eigenvalue is greater than $1$, the corresponding mode exhibits growth; if it is less than $1$, it exhibits decay
(please see Section \ref{section:uni} for a detailed approach to reading these components).
% \method provides the 
Figure \ref{fig:crown} (b-i) shows the weak growth modes in exogenous variables for the Republic of South Africa,
and implies an increase in infections in South Africa due to 501.V2 mentioned above.
Figure \ref{fig:crown} (b-ii) shows the strong growth modes in exogenous variables for the United States,
where new infections surpassed 1 million in a single day for the first time~\cite{covid19_america}.
% It demonstrates that \method adaptively finds the current distinct dynamical pattern.
% On the other hand,
Figure \ref{fig:crown} (b-iii) shows the decay of exogenous variables for China.
This period was toward the end of the lockdown in Shanghai, indicating that the spread of infections was beginning to ease,
our result captures this precisely.
\par
\myparaitemize{$l_s$-steps-ahead future values}
% Figures \ref{fig:crown} (a-i) and (b-i)
Figure \ref{fig:crown} (c)
shows snapshots of
the $l_s = 10$-steps-ahead future forecasting
when given a current window.
The blue vertical axes show the beginning of a current window $t_m$ and
the current time point $t_c$,
and the red vertical axis shows the $l_s$-step-ahead time point $t_c+l_s$.
% (please see Figure \ref{fig:algorithm} for a detailed explanation of the axes).
In addition, we show our estimated values with bold-colored lines
(the originals are shown in gray).
\method successfully finds the current distinct dynamical pattern and
generates future values continuously at any time.
% \vspace{-0.42em}
\subsection{Contributions} 
In this paper, we propose \method, which has all of the following desirable properties: \par
% \vspace{-0.5em}
{\setlength{\leftmargini}{12pt}
\begin{itemize}
\item \textit{Effective}:
% it captures important dynamical patterns (i.e., regimes),
% discovers time-changing relationships between observations in each pattern (i.e., \relation),
% such as interpretable relationships between observations
% (i.e., \relation), 
% and
% interpretable latent dynamics of basis vectors (i.e., modes)
% associated with the temporal frequency and decay rate,
% \textcolor{red}{and forecasts future values
% in a streaming fashion.}
% \item \textcolor{red}{\textit{General}:
% it can be applied to various data types,
% as it is designed without relying on features unique to any specific domain.}
it discovers time-changing relationships between observations (i.e., \relation) based on monitoring transitions of distinct dynamical patterns (i.e., regimes).
\item\textit{Accurate}:
it theoretically discovers the \relation in data streams (please see Lemma \ref{lemma:causal} for details), and accurately forecast future values based on these relationships.
% Our experimental results demonstrate its practicality across multiple domains,
% including epidemiology, web activity, and physical activity monitoring.
\item \textit{Scalable}:
it is fast and requires only constant computational time with regard to the entire stream length.
% Our experimental results also demonstrate that
% it outperforms the state-of-the-art algorithms for time series forecasting.
\end{itemize}
}
% \vspace{-0.5em}

% \myparaitemize{Outline} The rest of this paper is organized conventionally.
% Next, introducing related studies in Section \ref{section:related_work},
% we present our proposed model and
% its optimization algorithm
% in Section \ref{section:model} and Section \ref{section:algorithm}, respectively.
% Then, we
% % theoretically analyze our proposed method and
% provide our experimental results in Section \ref{section:experiments}, followed by our conclusions in Section \ref{section:conclusion}.
