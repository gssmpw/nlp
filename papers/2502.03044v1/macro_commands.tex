% \usepackage{todonotes}
% \usepackage[normalem]{ulem}

%\usepackage[utf8]{inputenc} % allow utf-8 input
%\usepackage[T1]{fontenc}    % use 8-bit T1 font      % hyperlinks
% \usepackage[colorlinks,linkcolor=black,citecolor=blue, pagebackref=true]{hyperref}
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{eqnarray}
\usepackage{amsmath,amssymb,amsfonts,bm}
\usepackage{enumitem}
\usepackage{amsthm}
% \usepackage{subfigure}
\usepackage{caption, subcaption}

\theoremstyle{plain}
\theoremstyle{definition}
\theoremstyle{remark}

% Parameter Estimation

\newcommand{\dbzijn}{\Delta \beta_{0ij}^{n}}
\newcommand{\dboijn}{\Delta \beta_{1ij}^{n}}
\newcommand{\daijn}{\Delta a_{ij}^{n}}
\newcommand{\dbijn}{\Delta b_{ij}^{n}}
\newcommand{\dsijn}{\Delta \sigma_{ij}^{n}}
%\newcommand{\norm}[1]{\|#1\|}

\newcommand{\bzin}{\beta^{n}_{0i}}
\newcommand{\boin}{\beta^{n}_{1i}}
\newcommand{\ain}{a_i^n}
\newcommand{\bin}{b_i^n}
\newcommand{\sigmain}{\sigma_i^n}

\newcommand{\bzj}{\beta_{0j}^{*}}
\newcommand{\boj}{\beta_{1j}^{*}}
\newcommand{\aj}{a_{j}^{*}}
\newcommand{\bj}{b_{j}^{*}}
\newcommand{\sigmaj}{\sigma_{j}^{*}}

\newcommand{\bzjp}{\beta_{0j'}^{*}}
\newcommand{\bojp}{\beta_{1j'}^{*}}
\newcommand{\ajp}{a_{j'}^{*}}
\newcommand{\bjp}{b_{j'}^{*}}
\newcommand{\sigmajp}{\sigma_{j'}^{*}}

\newcommand{\zerod}{\mathbf{0}_d}
\newcommand{\ktilde}{\tilde{k}}
\newcommand{\Dtilde}{\widetilde{D}}

\newcommand{\brj}{\bar{r}(|\mathcal{A}_j|)}
\newcommand{\trj}{\tilde{r}(|\mathcal{A}_j|)}
\newcommand{\trjp}{\tilde{r}(|\mathcal{A}_{j'}|)}

%%% j* = 1
\newcommand{\brone}{\bar{r}(|\mathcal{A}_1|)}
\newcommand{\dboione}{\Delta_{t_2} \beta_{1i1}^{n}}
\newcommand{\dbzione}{\Delta \beta_{0i1}^{n}}
\newcommand{\daione}{\Delta a_{i1}^{n}}
\newcommand{\dbione}{\Delta b_{i1}^{n}}
\newcommand{\dsione}{\Delta \sigma_{i1}^{n}}

\newcommand{\trone}{\tilde{r}(|\mathcal{A}_1|)}
\newcommand{\trs}{\tilde{r}(|\mathcal{A}_{j^*}|)}

\newcommand{\dint}{\mathrm{d}}


\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\parenth}[1]{\left( #1 \right)}
\newcommand{\bigparenth}[1]{\big( #1 \big)}
\newcommand{\biggparenth}[1]{\bigg( #1 \bigg)}
\newcommand{\braces}[1]{\left\{ #1 \right \}}
\newcommand{\abss}[1]{\left| #1 \right |}
\newcommand{\angles}[1]{\left\langle #1 \right \rangle}
\newcommand{\tp}{^\top}
% \newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}

\def\argmin{\textnormal{arg} \min}
\def\st{\textnormal{s.t.}}
\def\sgn{\texttt{sign}}
% \newcommand{\todo}[1]{\textcolor{red}{[Todo: #1]}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
%\renewcommand{\algorithmicrequire}{\textbf{Input:}}
%\renewcommand{\algorithmicensure}{\textbf{Output:}}

\def\TM{\texttt{T}}
\def\OT{\textnormal{OT}}
\def\TW{\textnormal{TW}}
\def\TSW{\textnormal{TSW}}


\def\RR{\mathbb{R}}
\def\DD{\mathbb{D}}
\def\NN{\mathbb{N}}
\def\PP{\mathbb{P}}
\def\MM{\mathbb{M}}
\def\SS{\mathbb{S}}
\def\EE{\mathbb{E}}
\def\FF{\mathbb{F}}
\def\TT{\mathbb{T}}
\def\XX{\mathbb{X}}
\def\QQ{\mathbb{Q}}
\def\FF{\mathbb{F}}

\def\Ff{\mathcal{F}}
\def\Hh{\mathcal{H}}
\def\Gg{\mathcal{G}}
\def\Ee{\mathcal{E}}
\def\Pp{\mathcal{P}}
\def\Ss{\mathcal{S}}
\def\Ww{\mathcal{W}}
\def\Ff{\mathcal{F}}
\def\Rr{\mathcal{R}}
\def\Nn{\mathcal{N}}
\def\Xx{\mathcal{X}}
\def\Tt{\mathcal{T}}
\def\Mm{\mathcal{M}}
\def\Qq{\mathcal{Q}}

\newcommand{\xbm}{{\bm x}}
\newcommand{\Xbm}{{\bm X}}

\newcommand{\ybm}{{\bm y}}
\newcommand{\Ybm}{{\bm Y}}

\newcommand{\pbm}{{\bm p}}
\newcommand{\Pbm}{{\bm P}}

\newcommand{\Ebm}{{\bm E}}

\newcommand{\Mbm}{{\bm M}}

\newcommand{\Zbm}{{\bm Z}}

\newcommand{\wbm}{{\bm w}}
\newcommand{\Wbm}{\bm{W}}
\newcommand{\Wq}{\Wbm^{\rm q}}
\newcommand{\Wk}{\Wbm^{\rm k}}
\newcommand{\Wv}{\Wbm^{\rm v}}

\newcommand{\bbm}{{\bm b}}
\newcommand{\bq}{\bbm^{\rm q}}
\newcommand{\bk}{\bbm^{\rm k}}

\newcommand{\Abm}{{\bm A}}
\newcommand{\Bbm}{{\bm B}}

\newcommand{\cbm}{{\bm c}}


\newcommand{\kbm}{{\bm k}}
\newcommand{\Kbm}{{\bm K}}

\newcommand{\ubm}{{\bm u}}
\newcommand{\Ubm}{{\bm U}}

\newcommand{\vbm}{{\bm v}}
\newcommand{\Vbm}{{\bm V}}

\newcommand{\qbm}{{\bm q}}
\newcommand{\Qbm}{{\bm Q}}

\newcommand{\abm}{{\bm \alpha}}
\newcommand{\sbm}{{\bm s}}
\newcommand{\gbm}{{\bm g}}
\newcommand{\hbm}{{\bm h}}

\newcommand{\ebm}{{\bm e}}
\newcommand{\zbm}{{\bm z}}



% \newcommand{\vtheta}{{\bm \theta}}
\newcommand{\veta}{{\bm \eta}}


\newcommand{\LS}{\mathcal{LS}}
\newcommand{\NS}{\mathcal{NS}}
\newcommand{\CS}{\mathcal{CS}}
\newcommand{\NCS}{\mathcal{NCS}}
\newcommand{\CSb}{\mathcal{CS}\text{-b}}
\newcommand{\CSd}{\mathcal{CS}\text{-d}}
\newcommand{\CSs}{\mathcal{CS}\text{-s}}
\newcommand{\NCSb}{\mathcal{NCS}\text{-b}}
\newcommand{\NCSd}{\mathcal{NCS}\text{-d}}
\newcommand{\NCSs}{\mathcal{NCS}\text{-s}}
\newcommand{\CSW}{\text{CSW}}
\newcommand{\NCSW}{\text{NCSW}}
\newcommand{\NCSWb}{\mathcal{NCSW}\text{-b}}
\newcommand{\NCSWd}{\mathcal{NCSW}\text{-d}}
\newcommand{\NCSWs}{\mathcal{NCSW}\text{-s}}

\newcommand{\pop}{F}
\newcommand{\nop}{F_n}
\newcommand{\popNGD}{F^{\texttt{NGD}}}
\newcommand{\nopNGD}{F_n^{\texttt{NGD}}}

\newcommand{\xbf}{\mathbf{x}}
\newcommand{\ybf}{\mathbf{y}}
\newcommand{\wbf}{\mathbf{w}}
\newcommand{\bbf}{\mathbf{b}}

\newcommand*{\vertbar}{\rule[-1ex]{0.5pt}{2.5ex}}
\newcommand*{\horzbar}{\rule[.5ex]{2.5ex}{0.5pt}}

\newcommand{\NormGD}{NormGD}
\newcommand{\ds}{\displaystyle}



% \DeclareMathOperator*{\argmax}{arg\,max}
% \DeclareMathOperator*{\argmin}{arg\,min}
%---------------------------
\newcommand{\bbP}{\mathbb{P}}
\newcommand{\bbE}{\mathbb{E}}
\newcommand{\var}{\mathrm{Var}}


\newcommand{\softmax}{\mathrm{softmax}}
\newcommand{\sigmoid}{\mathrm{sigmoid}}
\newcommand{\gelu}{\mathrm{GELU}}
% \newcommand{\tanh}{\mathrm{tanh}}



% Some abbreviations
\def\st{{\em s.t.~}}
\def\ie{{\em i.e.,~}}
\def\eg{{\em e.g.,~}}
\def\cf{{\em cf.,~}}
\def\ea{{\em et al.~}}
\newcommand{\iid}{i.i.d.}
\newcommand{\wrt}{w.r.t.}


\newcommand{\deijn}{\Delta \eta_{ij}^{n}}

\newcommand{\dboin}{\Delta \beta_{1i}^{n}}
\newcommand{\dbzin}{\Delta \beta_{0i}^{n}}

\newcommand{\dain}{\Delta a_{i}^{n}}
\newcommand{\dbin}{\Delta b_{i}^{n}}
\newcommand{\dein}{\Delta \eta_{i}^{n}}


\newcommand{\cin}{c_i^n}
\newcommand{\ein}{\eta_i^n}

\newcommand{\boonen}{\beta_{11}^n}
\newcommand{\bzonen}{\beta_{01}^n}
\newcommand{\aonen}{a_1^n}
\newcommand{\bonen}{b_1^n}
\newcommand{\eonen}{\eta_1^n}

%\newcommand{\boj}{\beta_{1j}^*}
\newcommand{\coj}{c_j^0}
\newcommand{\coi}{c_i^0}

\newcommand{\aaoj}{A_j^0}
\newcommand{\aaoi}{A_i^0}

\newcommand{\eoj}{\eta_j^0}
\newcommand{\eoi}{\eta_i^0}

\newcommand{\cj}{c_j^*}

\newcommand{\ej}{\eta_j^*}

\newcommand{\boi}{\beta_{1i}^*}
\newcommand{\bzi}{\beta_{0i}^*}
\newcommand{\ai}{a_i^*}
\newcommand{\bi}{b_i^*}
\newcommand{\ei}{\eta_i^*}

\newcommand{\boone}{\beta_{11}^*}
\newcommand{\bzone}{\beta_{01}^*}
\newcommand{\aone}{a_1^*}
\newcommand{\bone}{b_1^*}
\newcommand{\eone}{\eta_1^*}

\newcommand{\cjp}{c_{j'}^0}
\newcommand{\gjp}{\Gamma_{j'}^0}
\newcommand{\ejp}{\eta_{j'}^0}


\newcommand{\zeroq}{\mathbf{0}_q}
\newcommand{\pizeroone}{\pi_{1}^{0}}
%\newcommand{\dboione}{\Delta \beta_{1i1}^{n}}
\newcommand{\dtone}{\Delta \tau^{n}}

\newcommand{\deione}{\Delta \eta_{i1}^{n}}



\newcommand{\normf}[1]{\|#1\|_{L^2(\mu)}}

\newcommand{\bfit}[1]{\boldsymbol{#1}}

\newcommand{\prompt}{\bm p}
\newcommand{\dt}{\mathcal{D}_t}
\newcommand{\data}{\mathcal{D}}

\newcommand{\xdom}{\mathcal{X}^{(t)}}
\newcommand{\ydom}{\mathcal{Y}^{(t)}}


\newcommand{\yi}{\mathcal{Y}^{(i)}}
\newcommand{\yj}{\mathcal{Y}^{(j)}}


\newcommand{\normop}{\mathcal{S}_p}
\newcommand{\att}{\mathrm{Attention}}
\newcommand{\dv}{d_v}
\newcommand{\dk}{d_k}

\def\mmoe{\texttt{MMoE}}

\definecolor{indigo}{RGB}{75, 0, 130}          % Indigo
\newcommand{\minh}[1]{\textcolor{indigo}{[Minh: #1]}}

\definecolor{blue}{RGB}{0, 0, 255}          
\newcommand{\tuan}[1]{\textcolor{blue}{[Tuan: #1]}}