In this section, we introduce a novel backwards-greedy algorithm
(\cref{alg:greedy-back}, denoted as \alggback) that carefully handles the bottom slots
for ad placement.
The backwards-greedy approach addresses %
the decaying-attention in the model, 
by iteratively considering
sub-problems over suffixes (of the form $j,\dots,\nV$, for \emph{decreasing} $j$) of the slots. %
We show in \cref{thm:greedy-streamadsr} that the backwards-greedy algorithm, perhaps surprisingly, 
finds an optimal solution for the \streamadsr~problem.


On the other hand, 
it is not straightforward to
analyze the \alggback algorithm for the more challenging \streamads problem 
due to the interplay between the decaying-attention effect and the additional matching constraint. %
To address this issue, we prove a novel decomposition of the expected reward over a matching, 
which we use to obtain a \emph{non-oblivious} backwards-greedy 2-approximation algorithm
(\alggbackproxy in \cref{alg:greedy-backproxy}) for the \streamads problem, 
running much faster than \alggback.
More specifically, 
the \alggbackproxy algorithm adopts a greedy criterion that deviates from the standard marginal-gain greedy criterion (with respect to the underlying objective value). %
Finally, by leveraging the structural lemmas for the \alggbackproxy algorithm, 
we provide an analysis for the \alggback algorithm. %
We conclude by also presenting other practical algorithms that can be used to solve \streamads.

Before presenting our novel algorithms,
we
introduce a sub-problem of \streamads, 
which we refer to as \streamadsj, for a fixed integer~$j\in[\nV]$.
In the \streamadsj sub-problem,
the first $j$ items and slots are not considered, i.e., we only consider slots $j+1,\dots,m$.
The resulting objective function for \streamadsj is,
\begin{align}
	f_j(\M) := \sum_{e=(i,j') \in \M: j' > j} \rw_{e} (1-q)^{j'-j + \nb_j(j')}, \label{eq:obj-j}
\end{align}
where $\nb_j(j')$ is the number of slots after slot $j$ and before slot $j'$ containing an ad,
i.e.,
$\nb_j(j')= |\{ j < k < j' : (i, k) \in \M \text{ for some } i \}|$.
In~particular, 
$f_0 = f$, while 
$f_{\nV}(\cdot) = 0$. %

\subsection{Solving \streamadsr optimally}\label{sec:algs:streamadsr}
\input{alg-streamadsr}
\input{streamadsr}


\subsection{Non-oblivious greedy for \streamads}\label{sec:algs:streamads}
\input{alg-streamads}
\input{streamads}


\subsection{Natural greedy for \streamads}\label{sec:algs:streamads:oblivious}
\input{streamads-oblivious}
