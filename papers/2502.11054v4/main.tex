%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
% \documentclass[sn-mathphys]{sn-jnl}% Math and Physical Sciences Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style
% \documentclass[sn-standardnature]{sn-jnl}% Standard Nature Portfolio Reference Style
% \documentclass[default]{sn-jnl}% Default
\documentclass[default,iicol]{sn-jnl}% Default with double column layout

%%%% Standard Packages
%%<additional latex packages if required can be included here>
%%%%

%%%%%=============================================================================%%%%
%%%%  Remarks: This template is provided to aid authors with the preparation
%%%%  of original research articles intended for submission to journals published 
%%%%  by Springer Nature. The guidance has been prepared in partnership with 
%%%%  production teams to conform to Springer Nature technical requirements. 
%%%%  Editorial and presentation requirements differ among journal portfolios and 
%%%%  research disciplines. You may find sections in this template are irrelevant 
%%%%  to your work and are empowered to omit any such section if allowed by the 
%%%%  journal you intend to submit to. The submission guidelines and policies 
%%%%  of the journal take precedence. A detailed User Manual is available in the 
%%%%  template package for technical guidance.
%%%%%=============================================================================%%%%

\jyear{2024}%

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

%%%%%%%%%%%%%%%%%%%%%5add package
\usepackage{booktabs} % for professional tables
\usepackage{mathtools,amssymb}
\usepackage{subcaption}
\usepackage{color,xcolor}
\usepackage{times}
\usepackage{epsfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{wasysym}
\usepackage{multirow}
\usepackage{graphicx} % more modern
\usepackage{colortbl}
\usepackage{footnote}
% For algorithms
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{longtable}
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{booktabs}
\usepackage{array} 
% added by myself
\usepackage{url}
\usepackage{lettrine}
\usepackage{makecell}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{xcolor}
% \usepackage[maxbibnames=150]{biblatex}
% \usepackage[numbers]{natbib}
% \definecolor{mycyan}{cmyk}{.3,0,0,0}
% \usepackage{cite}
% \usepackage{hyperref}

\input{math_commands.tex}


\newcommand{\tool}{\emph{SafeBench}\space}
\newcommand{\toolns}{\emph{SafeBench}}
\newcommand{\mini}{\emph{MiniBench}}
\usepackage{amsfonts}
\usepackage{colortbl}

\usepackage{caption}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{cleveref}

\newcommand{\todo}[1]{\textcolor{red}{#1}}

\usepackage{cellspace}
\setlength\cellspacetoplimit{5pt}
\setlength\cellspacebottomlimit{5pt}


\newcommand{\ie}{\textit{i}.\textit{e}.}
\newcommand{\eg}{\textit{e}.\textit{g}.} 
\newcommand{\Tref}[1]{Tab.~\ref{#1}}
\newcommand{\Eref}[1]{Eq.~(\ref{#1})}
\newcommand{\Fref}[1]{Fig.~\ref{#1}}
\newcommand{\Sref}[1]{Sec.~\ref{#1}}
\newcommand{\Aref}[1]{Alg.~\ref{#1}}
\newcommand{\etal}{\textit{et al}.}
\newcommand{\el}{\textit{et al}.}
\newcommand{\etc}{\textit{etc}.}
\newcommand{\ul}{\underline}
\newcommand{\method}{\emph{RACE}}

\usepackage{pifont}
\usepackage[perpage,symbol*]{footmisc}
\DefineFNsymbols{circled}{{\ding{192}}{\ding{193}}{\ding{194}}
{\ding{195}}{\ding{196}}{\ding{197}}{\ding{198}}{\ding{199}}{\ding{200}}{\ding{201}}}
\setfnsymbol{circled}

\newcommand\myfootnotestyle[1]{\ifcase#1 \or \ding{182}\or \ding{183}\or
\ding{184}\or \ding{185}\or \ding{186}\or \ding{187}%
\or \ding{188}\or \ding{189}\or \ding{190}\or \ding{191}\else *\fi\relax}


\newcommand{\red}[1]{\textcolor{red}{#1}}
%%%%%%%%%%%%%%%%%%%%555555

\lstset{
    escapeinside={(*}{*)}
}

\newcommand\pythonnstyle{\lstset{
escapeinside={(*}{*)},
numbers=left,
xleftmargin=5.0ex,
numberstyle=\scriptsize,
basicstyle=\scriptsize\ttfamily,
emphstyle=\scriptsize\ttfamily\color{red},
keywordstyle=\scriptsize\ttfamily\color{blue},
language=Python
}}
\lstnewenvironment{pythonn}[1][]
{
\pythonnstyle
\lstset{#1}
}
{}

\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    frame=single
}

\lstset{style=mystyle}




\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Article Title]{Reasoning-Augmented Conversation for Multi-Turn Jailbreak Attacks on Large Language Models}

%%=============================================================%%
%% Prefix	-> \pfx{Dr}
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% NatureName	-> \tanm{Poet Laureate} -> Title after name
%% Degrees	-> \dgr{MSc, PhD}
%% \author*[1,2]{\pfx{Dr} \fnm{Joergen W.} \spfx{van der} \sur{Ploeg} \sfx{IV} \tanm{Poet Laureate} 
%%                 \dgr{MSc, PhD}}\email{iauthor@gmail.com}
%%=============================================================%%
\author[1]{\fnm{Zonghao} \sur{Ying}}

\author[2]{\fnm{Deyue} \sur{Zhang}}

\author[1]{\fnm{Zonglei} \sur{Jing}}

\author[1]{\fnm{Yisong} \sur{Xiao}}

\author[2]{\fnm{Quanchen} \sur{Zou}} 


\author[1]{\fnm{Aishan} \sur{Liu}}

\author[3]{\fnm{Siyuan} \sur{Liang}}

\author[2]{\fnm{Xiangzheng} \sur{Zhang}}

\author[1]{\fnm{Xianglong} \sur{Liu}}

\author[4]{\fnm{Dacheng} \sur{Tao}}



\affil[1]{\orgname{Beihang University}, \orgaddress{\country{China}}}
\affil[2]{\orgname{360 AI Security Lab}, \orgaddress{\country{China}}}

\affil[3]{\orgname{National University of Singapore}, \orgaddress{\country{Singapore}}}

\affil[4]{\orgname{Nanyang Technological University}, \orgaddress{\country{Singapore}}}

% \affil[3]{\orgdiv{Department}, \orgname{Organization}, \orgaddress{\street{Street}, \city{City}, \postcode{610101}, \state{State}, \country{Country}}}

%%==================================%%
%% sample for unstructured abstract %%
%%==================================%%

\abstract{

Multi-turn jailbreak attacks simulate real-world human interactions by engaging large language models (LLMs) in iterative dialogues, exposing critical safety vulnerabilities. However, existing methods often struggle to balance semantic coherence with attack effectiveness, resulting in either benign semantic drift or ineffective detection evasion. To address this challenge, we propose Reasoning-Augmented Conversation (\method{}), a novel multi-turn jailbreak framework that reformulates harmful queries into benign reasoning tasks and leverages LLMsâ€™ strong reasoning capabilities to compromise safety alignment. Specifically, we introduce an attack state machine framework to systematically model problem translation and iterative reasoning, ensuring coherent query generation across multiple turns. Building on this framework, we design gain-guided exploration, self-play, and rejection feedback modules to preserve attack semantics, enhance effectiveness, and sustain reasoning-driven attack progression. Extensive experiments on multiple LLMs demonstrate that \method{} achieves state-of-the-art attack effectiveness in complex conversational scenarios, with attack success rates (ASRs) increasing by up to 96\%. Notably, our approach achieves ASRs of 82\% and 92\% against leading commercial models, OpenAI o1 and DeepSeek R1, underscoring its potency. We release our code at \url{https://github.com/NY1024/RACE} to facilitate further research in this critical domain. \textcolor{red}{Warning: This paper contains model outputs that are unsafe.}

}


\keywords{Multi-turn jailbreak, large language models, reasoning-driven attack}

\maketitle


\input{src/1-introduction}
\input{src/2-releatedwork}
\input{src/3-motivation}
\input{src/4-framework}
\input{src/5-experiments}
\input{src/7-conclusion}



\bibliographystyle{unsrt}
%\bibliographystyle{plain}
\bibliography{reference}

\clearpage
\input{src/11-appendix}


% \begin{appendices}

% \section{Section title of first appendix}\label{secA1}

% An appendix contains supplementary information that is not an essential part of the text itself but which may be helpful in providing a more comprehensive understanding of the research problem or it is information that is too cumbersome to be included in the body of the paper.

% %%=============================================%%
% %% For submissions to Nature Portfolio Journals %%
% %% please use the heading ``Extended Data''.   %%
% %%=============================================%%

% %%=============================================================%%
% %% Sample for another appendix section			       %%
% %%=============================================================%%

% %% \section{Example of another appendix section}\label{secA2}%
% %% Appendices may be used for helpful, supporting or essential material that would otherwise 
% %% clutter, break up or be distracting to the text. Appendices can consist of sections, figures, 
% %% tables and equations etc.

% \end{appendices}

%%===========================================================================================%%
%% If you are submitting to one of the Nature Portfolio journals, using the eJP submission   %%
%% system, please include the references within the manuscript file itself. You may do this  %%
%% by copying the reference list from your .bbl file, paste it into the main manuscript .tex %%
%% file, and delete the associated \verb+\bibliography+ commands.                            %%
%%===========================================================================================%%
%\bibliographystyle{unsrt}
%\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl

%% Default %%
%%\input sn-sample-bib.tex%

\end{document}



%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Chain of Backdoor Attacks for Code-Driven Embodied Intelligence}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%
%
%\IEEEcompsocitemizethanks is a special \thanks that produces the bulleted
% lists the Computer Society journals use for "first footnote" author
% affiliations. Use \IEEEcompsocthanksitem which works much like \item
% for each affiliation group. When not in compsoc mode,
% \IEEEcompsocitemizethanks becomes like \thanks and
% \IEEEcompsocthanksitem becomes a line break with idention. This
% facilitates dual compilation, although admittedly the differences in the
% desired content of \author between the different types of papers makes a
% one-size-fits-all approach a daunting prospect. For instance, compsoc 
% journal papers have the author affiliations above the "Manuscript
% received ..."  text while in non-compsoc journals this is reversed. Sigh.

\author{%
%Anonymous authors

  Aishan Liu, Yuguang Zhou,  Siyuan Liang, Xianglong Liu, Tianyuan Zhang, Jiakai Wang, Yanjun Pu, \\Tianlin Li, Junqi Zhang, Wenbo Zhou, Qing Guo, Dacheng Tao \\
  
%Beihang University\textsuperscript{1} \quad SenseTime Research\textsuperscript{2} \quad UC Berkeley\textsuperscript{3}\\
%  Johns Hopkins University\textsuperscript{4} \quad Oxford University\textsuperscript{5} \quad JD Explore Academy\textsuperscript{6}


\thanks{A. Liu, Y. Zhou, X. Liu, T. Zhang are with the State Key Lab of Software Development Environment, Beihang University, Beijing, China.}

\thanks{J. Wang and Y. Pu are with the ZGC Laborotary, Beijing, China.}

\thanks{J. Zhang and W. Zhou are with the University of Science and Technology of China, China}

\thanks{S. Liang is with the National University of Singapore, Singapore.}

\thanks{Q. Guo is with the A*STAR, Singapore.}

\thanks{T. Li and D. Tao are with Nanyang Technological University, Singapore.}


\thanks{The first two authors contribute equally. Correspondence to Xianglong Liu.}

}
% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{IEEE TRANSACTIONS ON PATTERN ANALYSIS AND MACHINE INTELLIGENCE}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Computer Society Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.



% The publisher's ID mark at the bottom of the page is less important with
% Computer Society journal papers as those publications place the marks
% outside of the main text columns and, therefore, unlike regular IEEE
% journals, the available text space is not reduced by their presence.
% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% or like this to get the Computer Society new two part style.
%\IEEEpubid{\makebox[\columnwidth]{\hfill 0000--0000/00/\$00.00~\copyright~2015 IEEE}%
%\hspace{\columnsep}\makebox[\columnwidth]{Published by the IEEE Computer Society\hfill}}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark (Computer Society jorunal
% papers don't need this extra clearance.)



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}



% for Computer Society papers, we must declare the abstract and index terms
% PRIOR to the title within the \IEEEtitleabstractindextext IEEEtran
% command as these need to go into the title area created by \maketitle.
% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\IEEEtitleabstractindextext{%
\begin{abstract}
  Large language models (LLMs) have revolutionized the programming and development of embodied intelligence. In this paradigm, LLMs translate complex tasks described in abstract language into a sequence of code snippets. The embodied agent subsequently interacts with the environment to solve these tasks, with the execution logic guided by the programs and the orchestration of operation calls (\eg, perception modules). However, exploiting untrusted third-party LLMs poses considerable security risks. This paper introduces \method{}, which for the first time identifies a severe chain of backdoor threats in this practical scenario. By presenting a few shots of poisoned demonstrations, adversaries can clandestinely infect a black-box LLM, prompting it to generate programs with backdoor defects. These malicious programs, supplied by LLMs to downstream users, will be activated and compromise the reliability of the operational agent when specific visual triggers appear. Originating from a few shots of stealthy demonstrations, our attack progresses from LLM to the generated code until infiltrating the intelligent system, thus establishing a chain of backdoors that could have serious consequences for millions of downstream embodied agents. To achieve the goal, we employ an additional LLM for poisoned demonstration prompt generation and treat the optimization process as a two-player game between the discriminator and generator LLMs, where the optimized poisoned prompts fed to the generator could output programs with accurate defects that are realistic enough output to fool the discriminator. To comprehensively explore the potential risks, we broaden the attack and devise five program defects attacking modes compromising the key aspects of confidentiality, integrity, and availability of the embodied agents. To validate the effectiveness, we conducted extensive experiments on a range of tasks including robot planning, robot manipulation, and compositional visual reasoning. Additionally, we showcase the potential of our approach and successfully attack real-world autonomous driving systems. This paper aims to raise awareness of the potential threats of backdoors for embodied intelligence in practical LLM usage scenarios involving code. Our code and demos are available at the \href{https://chain-of-backdoor.github.io}{website}.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords} Chain of Attacks, 
Model Robustness, Embodied Intelligence.
\end{IEEEkeywords}}


% make the title area
\maketitle


% To allow for easy dual compilation without having to reenter the
% abstract/keywords data, the \IEEEtitleabstractindextext text will
% not be used in maketitle, but will appear (i.e., to be "transported")
% here as \IEEEdisplaynontitleabstractindextext when the compsoc 
% or transmag modes are not selected <OR> if conference mode is selected 
% - because all conference papers position the abstract like regular
% papers do.
\IEEEdisplaynontitleabstractindextext
% \IEEEdisplaynontitleabstractindextext has no effect when using
% compsoc or transmag under a non-conference mode.



% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle


\input{src/1-introduction}
\input{src/2-releatedwork}
\input{src/3-threatmodel}
\input{src/4-approach}
\input{src/5-experiments}
\input{src/7-realword-exp}
\input{src/6-attackmode}
\input{src/8-countermeasures}
\input{src/9-relatedwork}
\input{src/10-conclusion}



% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi


{
\bibliography{reference}
\bibliographystyle{unsrt}
}
%\input{checklist}


% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

\input{bios}

\newpage
\newpage
\clearpage

%\appendices



% that's all folks
\end{document}
