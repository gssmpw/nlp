\documentclass{article}
\input{preamble_arxiv}
\input{macros}

\icmltitlerunning{Rectifying Conformity Scores for Better Conditional Coverage}

\begin{document}

\input{title}

\begin{abstract}
  We present a new method for generating confidence sets within the split conformal prediction framework. Our method performs a trainable transformation of any given conformity score to improve conditional coverage while ensuring exact marginal coverage. The transformation is based on an estimate of the conditional quantile of conformity scores. The resulting method is particularly beneficial for constructing adaptive confidence sets in multi-output problems where standard conformal quantile regression approaches have limited applicability. We develop a theoretical bound that captures the influence of the accuracy of the quantile estimate on the approximate conditional validity, unlike classical bounds for conformal prediction methods that only offer marginal coverage. We experimentally show that our method is highly adaptive to the local data structure and outperforms existing methods in terms of conditional coverage, improving the reliability of statistical inference in various applications.
\end{abstract}

\vspace{-20pt}

\section{Introduction}
\label{sec:introduction}

\vspace{-10pt}

  \input{tex/sec-introduction}

\vspace{-20pt}

\section{Background}
\label{sec:ccp}

\vspace{-10pt}

  \input{tex/sec-background}

\section{Rectified Conformal Prediction}
  \input{tex/sec-rcp}

\vspace{-15pt}
\section{Related works}
\label{sec:cr-literature}
  \input{tex/sec-literature}

\vspace{-15pt}
\section{Theoretical guarantees}
\label{sec:theory}
  \input{tex/sec-theory}

\vspace{-15pt}
\section{Experiments}
\label{sec:experiments}
  \input{tex/sec-numerics}

\vspace{-15pt}
\section{Conclusion}
\label{sec:conclusion}
  \input{tex/sec-conclusion}

%\section{Acknowledgments}
%\label{sec:acknowledgments}
%  \input{tex/sec-acknowledgments}

\clearpage
\newpage

%\section*{Impact Statement}
%\label{sec:impact}
%  \input{tex/sec-impact-statement}

\bibliography{conformal}
\bibliographystyle{icml2025}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\appendix
\onecolumn

\section{Additional experiments}
\label{suppl:additional_experiements}
  \input{tex/suppl-additional-experiments}

\newpage

\section{Proofs}
\label{suppl:examples}
  \input{tex/suppl_examples}

\subsection{Proof of \Cref{thm:coverage:marginal}}
\label{suppl:marginal}
  \input{tex/suppl-marginal}

\subsection{Proof of equality~\eqref{eq:key-relation}}
\label{suppl:cond-quantile}
  \input{tex/suppl-cond-quantile}

\subsection{Proof of \Cref{thm:coverage:conditional}}
\label{suppl:conditional:validity}
  \input{tex/suppl-conditional}

\subsection{Pointwise control of $\epsilon_{\tau}$}
\label{suppl:epsilon}
  \input{tex/suppl-epsilon-tau}

\subsection{Uniform convergence of cumulative density estimator}
\label{suppl:cdf}
  \input{tex/suppl-uniform-cdf}

\subsection{Asymptotic conditional validity}
\label{suppl:asympt}
  \input{tex/suppl-asymptotic}

\newpage

\section{Details on experimental setup}
\label{suppl:details}
  \input{tex/suppl-numerics}

\end{document} 