\section{Related Work}
\subsection{Urban Spatiotemporal Prediction}

Spatiotemporal prediction in urban environments**Anderson, "Spatio-Temporal Modeling"** aims to model and forecast the dynamics of urban data, such as traffic flow, cellular network traffic, and energy consumption. Previously, researchers have employed statistical methods (e.g., ARIMA**Box, Jenkins, "Time Series Analysis"**) and traditional machine learning models (e.g., SVM**Vapnik, "Statistical Learning Theory"**, GP**Rasmussen, Williams, "Gaussian Processes for Machine Learning"**, and RF**Breiman, "Random Forests"**) for prediction. Recently, a variety of neural network-based models have been proposed for this task, which can be categorized into deterministic and probabilistic prediction. 

\subsection{Deterministic  Prediction}

Deterministic prediction of spatiotemporal data is a point estimation approach that assumes a deterministic prediction can be made given the same historical observations. These models are typically trained using loss functions such as MSE or MAE, ensuring that the model learns to predict the conditional mean \(\mathbb{E}[y|x]\) to capture the primary patterns. Existing deep learning-based deterministic forecasting models include MLP-based**Rumelhart, Hinton, Williams, "Learning Representations by Maximizing a Chained Expression"**, CNN-based**LeCun, Boser, Denker, Henderson, Howard, Hubbard, Jackel, Leinhart, Munson, Simard, "Backpropagation Applied to Handwritten Zip Code Recognition"**, and RNN-based**Elman, "Finding Structure in Time"** architectures, which are commonly used for their computational efficiency. Additionally, GNN-based models**Kipf, Welling, "Semi-Supervised Classification with Graph Convolutional Networks"** have been developed to capture spatial dependencies in graph-structured data, while Transformer-based models**Vaswani, Shazeer, Parmar, Uszkoreit, Jones, Gomez, Clare, Polosukhin, "Attention Is All You Need"** excel at capturing complex dynamic patterns. 

\subsection{Probabilistic  Prediction}


The core of probabilistic prediction lies in constructing a conditional probability distribution \( p(y|x) \), which quantifies the uncertainty of the prediction rather than merely providing a single deterministic value**Gal, Ghahramani, "Deep Bayesian Learning for Visual Recognition"**. Unlike deterministic prediction models, these models 
%focus on capturing the randomness of spatiotemporal data, such as measurement noise and environmental interference, and 
assess the reliability of the predictions through probabilistic representations like quantiles or confidence intervals. Early applications typically employ Bayesian networks. In recent years, with the development of generative models, approaches based on GAN**Goodfellow, Pougetty-Abadie, Mirza, Xu, Warde-Farley, Ozair, Courville, Bengio, "Generative Adversarial Networks"**, VAE**Kingma, Welling, "Auto-Encoding Variational Bayes"**, and diffusion models**Ho, Jain, Matusik, Durand, Freeman, "Accelerating the Sde Iteration for Image Denoising: Algorithm, Implementation and Application"** have made significant advancements, owing to their powerful data distribution modeling capabilities. However, deterministic models still dominate in related research, and probabilistic prediction models remain relatively underexplored. This study aims to leverage the strengths of both deterministic and probabilistic models to achieve efficient probabilistic predictions.