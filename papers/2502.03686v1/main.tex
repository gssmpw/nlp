
\documentclass{article}

\usepackage[utf8]{inputenc} %
\usepackage[T1]{fontenc}    %
\usepackage{hyperref}       %
\usepackage{url}            %
\usepackage{booktabs}       %
\usepackage{amsfonts}       %
\usepackage{nicefrac}       %
\usepackage{microtype}      %
\usepackage{xcolor}         %
\usepackage{graphicx}
\usepackage{tcolorbox}
\usepackage{subfig}
\newcommand{\theHalgorithm}{\arabic{algorithm}}
\newcommand{\sm}[1]{\textbf{\textcolor{blue}{#1}}}

\usepackage[accepted]{icml2025}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

\usepackage[capitalize]{cleveref}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{proposition*}{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\input{math_commands}

\usepackage[textsize=tiny]{todonotes}

\newcommand{\cskip}{c_\text{skip}(t)}
\newcommand{\cout}{c_\text{out}(t)}
\newcommand{\cin}{c_\text{in}(t)}
\newcommand{\cnoise}{c_\text{noise}(t)}


\icmltitlerunning{Variational Control for Guidance in Diffusion Models}

\definecolor{algoshade}{HTML}{dedbd2}
\definecolor{algoshade2}{HTML}{e3d5ca}
\definecolor{algoshade3}{HTML}{dee2e6}
\definecolor{alt_algo}{HTML}{C5C2AD}

\tcbset{
  mathstyle/.style={
    colback=algoshade3,  %
    colframe=white,
    boxrule=0.5mm,
    arc=0mm,
    auto outer arc,
    boxsep=1pt,
    left=2pt,
    right=2pt,
    top=1pt,
    bottom=1pt
  }
}
\tcbset{
  algostyle/.style={
    colback=algoshade3,  %
    colframe=white,
    boxrule=0.5mm,
    arc=0mm,
    auto outer arc,
    boxsep=0pt,
    left=0pt,
    right=1pt,
    top=1pt,
    bottom=1pt
  }
}
\tcbset{
  algostyle2/.style={
    colback=algoshade2,  %
    colframe=white,
    boxrule=0.5mm,
    arc=0mm,
    auto outer arc,
    boxsep=0pt,
    left=0pt,
    right=1pt,
    top=1pt,
    bottom=1pt
  }
}
\tcbset{
  algostyle3/.style={
    colback=algoshade,  %
    colframe=white,
    boxrule=0.5mm,
    arc=0mm,
    auto outer arc,
    boxsep=0pt,
    left=0pt,
    right=1pt,
    top=1pt,
    bottom=1pt
  }
}

\begin{document}

\twocolumn[
\icmltitle{Variational Control for Guidance in Diffusion Models}

\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Kushagra Pandey}{equal,doc,czir}
\icmlauthor{Farrin Marouf Sofian}{equal,doc,czir}
\icmlauthor{Felix Draxler}{doc,czir}
\icmlauthor{Theofanis Karaletsos}{czi}
\icmlauthor{Stephan Mandt}{doc,dos,czir}
\end{icmlauthorlist}

\icmlaffiliation{doc}{Department of Computer Science, University of California, Irvine}
\icmlaffiliation{dos}{Department of Statistics, University of California, Irvine}
\icmlaffiliation{czi}{Chan Zuckerberg Initiative, Redwood City, CA 94063}
\icmlaffiliation{czir}{AI Resident, Chan Zuckerberg Initiative, Redwood City, CA 94063}

\icmlcorrespondingauthor{Kushagra Pandey}{pandeyk1@uci.edu}

\icmlkeywords{Diffusion Models, Inverse Problems, Optimal Control}

\vskip 0.3in
]



\printAffiliationsAndNotice{\icmlEqualContribution}

\begin{abstract}
Diffusion models exhibit excellent sample quality, but existing guidance methods often require additional model training or are limited to specific tasks. We revisit guidance in diffusion models from the perspective of variational inference and control, introducing \emph{Diffusion Trajectory Matching (DTM)} that enables guiding pretrained diffusion trajectories to satisfy a terminal cost. DTM unifies a broad class of guidance methods and enables novel instantiations. We introduce a new method within this framework that achieves state-of-the-art results on several linear and (blind) non-linear inverse problems without requiring additional model training or modifications. For instance, in ImageNet non-linear deblurring, our model achieves an FID score of 34.31, significantly improving over the best pretrained-method baseline (FID 78.07). We will make the code available in a future update.
\end{abstract}

\input{tex/introduction}
\input{tex/background}
\input{tex/method}
\input{tex/experiments}
\input{tex/related}
\input{tex/conclusion}


\bibliography{main}
\bibliographystyle{icml2025}


\newpage
\appendix
\onecolumn
\input{tex/appendix/appendix_a} 


\end{document}
