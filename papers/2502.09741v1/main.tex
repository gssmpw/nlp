 \def\isarxiv{1} 
\ifdefined\isarxiv
\documentclass[11pt]{article}
\usepackage[numbers]{natbib}
\usepackage{svg}
\else
%\documentclass[nohyperref]{article}
\documentclass{article}
%\usepackage{icml2022}
\usepackage{icml2025}
%\usepackage{times}
%\usepackage{neurips_2022}
\fi


\input{macro}
\usepackage{titletoc}
\usepackage{wrapfig}
\usepackage{mdframed}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{subfigure}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{wrapfig,epsfig}
\usepackage{url}
\usepackage{xcolor}
\usepackage{epstopdf}
\usepackage{accents}
\usepackage{enumerate}

\usepackage{algpseudocode}
\usepackage{enumitem}  
\usepackage{subfigure}
% \usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{wrapfig,epsfig}
\usepackage{url}
\usepackage{xcolor}
\usepackage{epstopdf}
\usepackage{booktabs} % Ensure you have this package included
\definecolor{academicblue}{RGB}{0, 0, 200} % Dark blue, similar to "dark blue" in web colors
\definecolor{academicred}{RGB}{200, 0, 0} % Dark red, similar to "dark red" in web colors
 % You can adjust the RGB values as needed.
\usepackage{float}
\usepackage{bbm}
\usepackage{dsfont}
\usepackage{xcolor} % Make sure to include this package
\usepackage{colortbl} % This package provides the \rowcolors command

 %%% print refs in table of contents
%\displaybreak
\allowdisplaybreaks


\ifdefined\isarxiv

% \usepackage[margin=0.8in]{geometry}
\let\C\relax
\usepackage{tikz}
\usepackage{titletoc}
\usepackage{hyperref}  %%% arxiv don't allow this.
\hypersetup{colorlinks=true,citecolor=blue,linkcolor=blue} 
\usetikzlibrary{arrows}
\usepackage[margin=0.8in]{geometry}

\else

\usepackage{microtype}
\usepackage{hyperref}
\newcommand{\theHalgorithm}{\arabic{algorithm}}

\definecolor{mydarkblue}{rgb}{0,0.08,0.45}
\hypersetup{colorlinks=true, citecolor=mydarkblue,linkcolor=mydarkblue}
%\usepackage[capitalize,noabbrev]{cleveref}
%\usepackage{colortbl}

\fi
%\linespread{1}
%\newcommand{\QED}{\hfill$\qed$}
%\graphicspath{{./figs/}}


\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
%\newtheorem{proof}[theorem]{Proof}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{example}[theorem]{Example}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{open}[theorem]{Open Problem}
\newtheorem{property}[theorem]{Property}
\newtheorem{hypothesis}[theorem]{Hypothesis}

\newcommand{\attn}{\mathrm{Attn}}
\newcommand{\mlp}{\mathrm{MLP}}

\newcommand{\wh}{\widehat}
\newcommand{\logits}{\mathcal{L}}
\newcommand{\wt}{\widetilde}
\newcommand{\ov}{\overline}
\newcommand{\N}{\mathcal{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\RHS}{\mathrm{RHS}}
\newcommand{\LHS}{\mathrm{LHS}}
\renewcommand{\mod}{\textrm{ mod }}
\renewcommand{\d}{\mathrm{d}}
\renewcommand{\i}{\mathbf{i}}
\renewcommand{\tilde}{\wt}
\renewcommand{\hat}{\wh}
\newcommand{\Tmat}{{\cal T}_{\mathrm{mat}}}

\DeclareMathOperator*{\E}{{\mathbb{E}}}
\DeclareMathOperator*{\var}{\mathrm{Var}}
\DeclareMathOperator*{\Z}{\mathbb{Z}}
\DeclareMathOperator*{\C}{\mathbb{C}}
\DeclareMathOperator*{\D}{\mathcal{D}}
\DeclareMathOperator*{\median}{median}
\DeclareMathOperator*{\mean}{mean}
\DeclareMathOperator{\OPT}{OPT}
\DeclareMathOperator{\opt}{opt}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\poly}{poly}

\DeclareMathOperator{\nnz}{nnz}
\DeclareMathOperator{\sparsity}{sparsity}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\cost}{cost}
\DeclareMathOperator{\vect}{vec}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\dis}{dis}
\DeclareMathOperator{\cts}{cts}
\DeclareMathOperator{\logistic}{logistic}
\DeclareMathOperator{\A}{\mathsf{A}}
\graphicspath{{./figures/}}
\DeclareMathOperator{\FoNE}{\mathsf{FoNE}}
\DeclareMathOperator{\FNP}{\mathsf{FNP}}
\definecolor{darkgreen}{rgb}{0, 0.7, 0.2}
\makeatletter
\newcommand*{\RN}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother
\newcommand{\Tianyi}[1]{\tzcomment{#1}}
\newcommand{\Deqing}[1]{{\color{orange}[Deqing: #1]}}
\newcommand{\Robin}[1]{\rjcomment{#1}}
\newcommand{\vatsal}[1]{{\color{darkgreen}[Vatsal: #1]}}







\ifdefined\isarxiv
%\title{\textbf{FNE: Fourier Number Embedding\\Embed Numbers in Fourier Space as One Token 
%}}
% Embedding Numbers as a Single Token in Fourier Space
% Fourier Number Embeddings: Single Token Embeddings in Fourier Space
\title{\huge{FoNE: Precise Single-Token Number Embeddings \\via Fourier Features}}
% Fourier Number Embeddings Enable Efficient and Precise Arithmetic 
% One Number, One Token: Fourier Number Embeddings 
% One Token is All You Need \\ When Embedding Numbers in Fourier Space

\author{
\textbf{Tianyi Zhou}
~~~\textbf{Deqing Fu}
~~~\textbf{Mahdi Soltanolkotabi}
~~~\textbf{Robin Jia}
~~~\textbf{Vatsal Sharan} \vspace{2mm}  \\
  Department of Computer Science\\
  University of Southern California\\
  Los Angeles, CA 90089 \\
  \texttt{\{tzhou029,deqingfu,soltanol,robinjia,vsharan\}@usc.edu} \\
}
\usepackage{lineno}

\def\linenumberfont{\normalfont\small}
% \usepackage{palatino}

%%% override paragraph
% \renewcommand{\paragraph}[1]{\textbf{#1}}

\date{}



\else



\icmltitlerunning{FoNE: Precise Single-Token Number Embeddings via Fourier Features}
\twocolumn[

%\icmltitle{FoNE: Fourier Number Embedding \\ Embed Numbers in Fourier Space as One Token }
\icmltitle{FoNE: Precise Single-Token Number Embeddings via Fourier Features}

\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Firstname1 Lastname1}{equal,yyy}
\icmlauthor{Firstname2 Lastname2}{equal,yyy,comp}
\icmlauthor{Firstname3 Lastname3}{comp}
\icmlauthor{Firstname4 Lastname4}{sch}
\icmlauthor{Firstname5 Lastname5}{yyy}
\icmlauthor{Firstname6 Lastname6}{sch,yyy,comp}
\icmlauthor{Firstname7 Lastname7}{comp}
%\icmlauthor{}{sch}
\icmlauthor{Firstname8 Lastname8}{sch}
\icmlauthor{Firstname8 Lastname8}{yyy,comp}
%\icmlauthor{}{sch}
%\icmlauthor{}{sch}
\end{icmlauthorlist}

\icmlaffiliation{yyy}{Department of XXX, University of YYY, Location, Country}
\icmlaffiliation{comp}{Company Name, Location, Country}
\icmlaffiliation{sch}{School of ZZZ, Institute of WWW, Location, Country}

\icmlcorrespondingauthor{Firstname1 Lastname1}{first1.last1@xxx.edu}
\icmlcorrespondingauthor{Firstname2 Lastname2}{first2.last2@www.uk}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}
\vskip 0.3in
]
\printAffiliationsAndNotice{} %
\renewcommand{\paragraph}[1]{\textbf{#1}}
\fi




\begin{document}

\ifdefined\isarxiv
\begin{titlepage}
  \maketitle
  \begin{abstract}
\input{abstract}

  \end{abstract}
  \thispagestyle{empty}
\end{titlepage}

% {\hypersetup{linkcolor=black}
% \tableofcontents
% }
\newpage

% \input{exp}
\else

\begin{abstract}
\input{abstract}
\end{abstract}

\fi

\input{intro}
\input{related_work}
\input{FNE}
\input{results}
\input{discussion}
\input{conclusion}



\ifdefined\isarxiv
%%%% Funding Sources
\section*{Acknowledgments}
This research is supported in part by AWS credits through an Amazon Faculty
research award, a NAIRR Pilot award, and Microsft accelerating foundations research grant, and a Google Research Scholar Award. M. Soltanolkotabi is also supported by the Packard Fellowship in Science
and Engineering, a Sloan Research Fellowship in Mathematics, an NSF-CAREER under award \#1846369, and NSF-CIF awards \#1813877 and \#2008443, NSF SLES award \#2417075. and NIH DP2LM014564-01. 
R. Jia was also supported by the National Science Foundation under Grant No. IIS-2403436. 
V. Sharan was supported in part by an NSF CAREER Award CCF-2239265 and an Amazon Research Award.
Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.
The work was done in part while some of the authors were visiting the Simons Institute for the Theory of Computing. 
\bibliographystyle{plainnat}
\bibliography{ref}
\else
\bibliographystyle{icml2025}
\bibliography{ref}

\fi



\clearpage
\newpage
\onecolumn
\appendix




\ifdefined\isarxiv
\section*{Appendix}
\input{appendix}
\else
\section*{Appendix}
\input{appendix}
\fi

%%%% Cut-line between first 10 pages and appendix









\end{document}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
