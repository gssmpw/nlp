\documentclass[twoside,11pt,dvipsnames, openleft]{book}
\usepackage{jmlr2e}
\usepackage{bm}
\usepackage{cancel}

\usepackage{pythonhighlight}
\usepackage{extarrows}
%A \xLongequal[\text{below}]{\text{above}} B

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  record parameters
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%----------------------------------------------------------------------------------------
% table space, row space, column space 
%\setlength{\tabcolsep}{7.3pt}    
\renewcommand{\arraystretch}{1.15}
% \setlength{\arraycolsep}{2pt}: reduce space in bmatrix



%----------------------------------------------------------------------------------------
%subfigure example:
%\begin{figure}[h!]
%\centering                       %图片全局居中
%\vspace{-0.35cm}                 %设置与上面正文的距离
%\subfigtopskip=2pt               %设置子图与上面正文或别的内容的距离
%\subfigbottomskip=2pt            %设置第二行子图与第一行子图的距离，即下面的头与上面的脚的距离
%\subfigcapskip=-5pt              %设置子图与子标题之间的距离
%\subfigure[A convex funtion]{\label{fig:aaa-1}
	%\includegraphics[width=0.31\linewidth]{./imgs/aaa.pdf}}
%\subfigure[A concave function]{\label{fig:aaa-2}
	%\includegraphics[width=0.31\linewidth]{./imgs/aaa.pdf}}
%\subfigure[A random function]{\label{fig:aaa-3}
	%\includegraphics[width=0.31\linewidth]{./imgs/aaa.pdf}}
%\caption{Three functions.}
%\label{fig:caaa}
%\end{figure}

%----------------------------------------------------------------------------------------
%\begin{SCfigure}
%\centering
%\includegraphics[width=0.6\textwidth]{./imgs/test.pdf}
%\caption{}
%\label{fig:test}
%\end{SCfigure}
%----------------------------------------------------------------------------------------




%% for theorems
%\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

%----------------------------------------------------------------------------------------
% index
%----------------------------------------------------------------------------------------
\usepackage{imakeidx}
\makeindex[columns=2, title=Alphabetical Index]

% stack
\usepackage{stackengine}


\usepackage{dsfont}

% xlongequal
\usepackage{extarrows} 


% for textbox
\usepackage[framemethod=tikz]{mdframed}


% for submatrix
\pagestyle{empty} % for cropping


\usepackage{amsmath}
\usepackage{arydshln}


%----------------------------------------------------------------------------------------
% number of the eqaution for each section
%----------------------------------------------------------------------------------------
\numberwithin{equation}{chapter}
%\renewcommand\theequation{\thechapter.\arabic{equation}



\usepackage{blkarray}
\newcommand{\xy}[2]{\ensuremath{\frac{x_{#1}}{y_{#2}}}}

% for move figure
%\usepackage{tikz}
%\usepackage{graphics}


% for textblock
\usepackage[absolute,overlay]{textpos}


%----------------------------------------------------------------------------------------
%  include a full pdf
%----------------------------------------------------------------------------------------
\usepackage[final]{pdfpages}

%% ADDED for graybox:
\usepackage[noframe]{showframe}
\usepackage{framed}
\usepackage{lipsum}



\newenvironment{svgraybox}{%
	\def\FrameCommand{\fboxsep=\FrameSep \colorbox{\mdframecolorTheorem}}%
	\MakeFramed{\advance\hsize-\width \FrameRestore\FrameRestore}}%
{\endMakeFramed}



% color for parentheses
\usepackage{xcolor}
\newcommand{\cleft}[2][.]{%
	\begingroup\colorlet{savedleftcolor}{.}%
	\color{#1}\left#2\color{savedleftcolor}%
}
\newcommand{\cright}[2][.]{%
	\color{#1}\right#2\endgroup
}



\usepackage{tcolorbox}
\usepackage{graphicx}             %插入图片的宏包
\usepackage[hang]{subfigure}


% algorithm
\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{algpseudocode}
\usepackage{graphics}
\usepackage{epsfig}

\usepackage{blkarray}
\usepackage{listings}

%----------------------------------------------------------------------------------------
%   Fancy Chapter: before hyperref
%----------------------------------------------------------------------------------------
%Options: Sonny, Lenny, Glenn, Conny, Rejne, Bjarne, Bjornstrup
\usepackage[Bjornstrup]{fncychap}
%------------------------------------
%\newcommand{\colortitlechap}{\color[rgb]{0.9,0.9,0.9}} % color of the chapter title <<<
%\newcommand{\colornumberchap}{\color[rgb]{0.6,0.6,0.6}} % color of the chapter number <<<<
%\newcommand{\colortitlechap}{\color[rgb]{0.3,0.3,0.3}} % color of the chapter title <<<
%\newcommand{\colornumberchap}{\color[rgb]{0.6,0.6,0.6}} % color of the chapter number <<<<
%\newcommand{\colorbackchap}{\colorbox[RGB]{187,201,242}} % color of the background rules <<<

\newcommand{\colortitlechap}{\color[RGB]{60,113,183}} % color of the chapter title <<<
\newcommand{\colornumberchap}{\color[RGB]{60,113,183}} % color of the chapter number <<<<
\newcommand{\colorbackchap}{\colorbox[RGB]{200,200,200}} % color of the background rules <<<


\makeatletter
\renewcommand{\DOCH}{%
		\settowidth{\py}{\CNoV\thechapter}
		\addtolength{\py}{-10pt}% 
		\fboxsep=0pt%
		\colorbackchap{\rule{0pt}{40pt}\parbox[b]{\textwidth}{\hfill}}%
		\kern-\py\raise20pt%
		\hbox{\colornumberchap\CNoV\thechapter}\\%
	}

\renewcommand{\DOTI}[1]{%
		\nointerlineskip\raggedright%
		\fboxsep=\myhi%
		\vskip-1ex%
		\colorbackchap{\parbox[t]{\mylen}{\CTV\FmTi{\colortitlechap#1}}}\par\nobreak%
		\vskip 40\p@%
	}

\renewcommand{\DOTIS}[1]{%
		\fboxsep=0pt%
		\colorbackchap{\rule{0pt}{40pt}\parbox[b]{\textwidth}{\hfill}}\\%
		\nointerlineskip\raggedright%
		\fboxsep=\myhi%
		\colorbackchap{\parbox[t]{\mylen}{\CTV\FmTi{\colortitlechap#1}}}\par\nobreak%
		\vskip 40\p@%
	}
\makeatother

% change color for Conny
%\usepackage{xcolor}
%\usepackage[Conny]{fncychap}
%\definecolor{winestain}{rgb}{0.5,0,0}
%\newcommand{\fancycolor}{\color{winestain}} % winestain
%\makeatletter  
%\newcommand{\structurecolor}{winestain}  
%\def\mghrulefill#1{\fancycolor\leavevmode\leaders\hrule\@height #1\hfill\kern\z@}
%\makeatother

%----------------------------------------------------------------------------------------
%   heading
% E for even page
% O for odd page
% L for left side
% C for centered
% R for right side
% \thepage adds number of the current page.
% \thechapter adds number of the current chapter.
% \thesection adds number of the current section.
% \chaptername adds the word "Chapter" in English or its equivalent in the current language.
% \leftmark adds name and number of the current top-level structure (for example, Chapter for reports and books classes; Section for articles ) in uppercase letters.
% \rightmark adds name and number of the current next to top-level structure (Section for reports and books; Subsection for articles) in uppercase letters.
%----------------------------------------------------------------------------------------
\usepackage{fancyhdr, blindtext}
\newcommand{\changefontt}{%
	\fontsize{11}{13}\selectfont
}
\newcommand{\changefonts}{%
	\fontsize{9}{11}\selectfont
}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[RO]{\color{structurecolor}\changefonts \leftmark}
\fancyhead[LO]{\color{structurecolor}\changefonts \thepage}
\fancyhead[RE]{\color{structurecolor}\changefonts \rightmark}  % \slshape if italic
\fancyhead[LE]{\color{structurecolor}\changefonts \thepage}  % \slshape if italic
%\fancyfoot[CE,CO]{\color{structurecolor}\thepage}

% the following solves the page number color in fanch chapter
\fancypagestyle{plain}{%
	\renewcommand{\headrule}{\color{structurecolor}\hrule height 0pt \vspace{0.5mm}}
	\renewcommand{\headrulewidth}{0pt}%
	\fancyhf{}  % Clear header and footer
	%\fancyfoot[C]{\color{structurecolor} \thepage}% add page number add foot for each part separation
}

\renewcommand{\headrule}{\color{structurecolor}\hrule height 1.2pt \vspace{0.5mm}}

%----------------------------------------------------------------------------------------
%  hyperref
%----------------------------------------------------------------------------------------
\usepackage[colorlinks]{hyperref}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true, %set true if you want colored links
    linktoc=all,     %set to all if you want both sections and subsections linked
    linkcolor=mydarkblue,  %choose some color if you want links to stand out
    anchorcolor=blue,
    citecolor=mydarkgreen,
}
\usepackage[hyperpageref]{backref} %backref
% footnote color
\renewcommand\thefootnote{\textcolor{cyan}{\arabic{footnote}}}


% matrix line
\usepackage{booktabs}  % for '\midrule' macro


%----------------------------------------------------------------------------------------
%  bookmark
%----------------------------------------------------------------------------------------
% Customize bookmark levels
\usepackage{bookmark}
\bookmarksetup{
	numbered,
	open
}



%----------------------------------------------------------------------------------------
% tikz: for network figuresf
%----------------------------------------------------------------------------------------
\usepackage{tikz}
\usetikzlibrary{mindmap,trees,backgrounds}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}

% bend text in tikz
\usetikzlibrary{decorations.text}

% flow
\usetikzlibrary{calc,backgrounds}


% cycle
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
		\node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
	
% widepage
\usepackage{changepage}                 % adjust margins for selected portions




% matrix line
\usepackage{hhline}
\newcommand*{\bmboxtimes}{\multicolumn{1}{|c|}{\bm{\boxtimes}}}
\newcommand*{\colorbmboxtimes}{\multicolumn{1}{|c|}{\textcolor{mylightbluetext}{\bm{\boxtimes}}}}



%tik class map
\usetikzlibrary{positioning,shapes,shadows,arrows}
\tikzstyle{condition}=[rectangle, draw=black, rounded corners, fill=colorqr, drop shadow,
text centered, anchor=north, text=black, text width=3cm]
\tikzstyle{abstract}=[rectangle, draw=black, rounded corners, fill=blue!30, drop shadow,
text centered, anchor=north, text=black, text width=3cm]
\tikzstyle{comment}=[rectangle, draw=black, rounded corners, fill=color1, drop shadow,
text centered, anchor=north, text=black, text width=3cm]
\tikzstyle{myarrow}=[->, >=open triangle 90, thick]
\tikzstyle{line}=[-, thick]

% tensor
\usepackage{tikz-3dplot}
\tikzset{>=latex}
\usetikzlibrary{matrix}

% tikz slice
\newcommand{\slicedist}{0.5}
\newcommand{\slicedistsmall}{0.008}

% tensor third-way-index
\newcommand{\Depth}{2}
\newcommand{\Height}{2}
\newcommand{\Width}{2}
\newcommand{\xx}{1}
\newcommand{\yy}{1}
\newcommand{\zz}{1}
\newcommand{\xd}{4.5}
\newcommand{\yd}{-0.3}
\newcommand{\ye}{1.1}
\newcommand{\zd}{1}

%----------------------------------------------------------------------------------------
%   SCFigure
%----------------------------------------------------------------------------------------
% caption on left side
\usepackage{sidecap}
\sidecaptionvpos{figure}{t}


\usepackage{verbatimbox}


% euler script letter
\usepackage[mathscr]{euscript}

% llbracket
\usepackage{stmaryrd}



%----------------------------------------------------------------------------------------
% widepage for Worldmap
%----------------------------------------------------------------------------------------
% wide page for side by side figures, tables, etc
\newlength{\offsetpage}
\setlength{\offsetpage}{2.5cm}
\newenvironment{widepage}{\begin{adjustwidth}{-\offsetpage/2}{-\offsetpage/2}
		\addtolength{\textwidth}{\offsetpage}}%
	{\end{adjustwidth}}
\newenvironment{widepage1}{\begin{adjustwidth}{-0.9cm}{-\offsetpage/2}
		\addtolength{\textwidth}{\offsetpage}}%
	{\end{adjustwidth}}

%----------------------------------------------------------------------------------------
% minitoc
%----------------------------------------------------------------------------------------
\usepackage{minitoc}   %option: un/dotted
% \setcounter{minitocdepth}{1}   % 会在minitoc显示到sections
\setcounter{minitocdepth}{3}     % 会显示到subsubsection。
\let\cleardoublepage\clearpage
\usepackage[titletoc]{appendix}



%----------------------------------------------------------------------------------------
% figure caption line
%----------------------------------------------------------------------------------------
\usepackage[labelfont=bf]{caption}
\newcommand\myhrulefill[1]{\leavevmode\leaders\hrule height#1\hfill\kern0pt}
\DeclareCaptionFormat{myformat}{
	{\color[RGB]{0,0,0}\myhrulefill{0.12em}}
	\\#1#2#3
}
\captionsetup[figure]{format=myformat}
\captionsetup[table]{format=myformat}






	
%----------------------------------------------------------------------------------------
% water mark
%----------------------------------------------------------------------------------------
%\usepackage{eso-pic}
%\newcommand\BackgroundPicture{%
%\put(0,0){%
%\parbox[b][\paperheight]{\paperwidth}{%
%\vfill
%\centering%
%\begin{tikzpicture}[remember picture,overlay]
%\node [rotate=60,scale=2,text opacity=0.2] at (current page.center) {Numerical Matrix Decomposition}; %中括号内是旋转角度，字体大小
%\end{tikzpicture}%
%\vfill
%}}}
%\AddToShipoutPicture{\BackgroundPicture}    %这一页开始水印背景.
%\ClearShipoutPicture                        %这一页终止水印背景.


		
		
		



















%----------------------------------------------------------------------------------------
% insert a blank page by using: \afterpage{\blankpage}
%----------------------------------------------------------------------------------------
\usepackage{afterpage}
\newcommand\blankpage{%
	\null
	\thispagestyle{empty}%
	\addtocounter{page}{-1}%
	\newpage}







%%----------------------------------------------------------------------------------------
%%   increae table row space
%%----------------------------------------------------------------------------------------
%\usepackage{array}

%----------------------------------------------------------------------------------------
%   define the new part that has color page
%----------------------------------------------------------------------------------------
% ---- add a blank page if needed
\makeatletter \renewcommand*\cleardoublepage{
\clearpage
\if@twoside   
	\ifodd\c@page 
		\hbox{}\newpage
		\if@twocolumn\hbox{}   
			\newpage
		\fi
	\fi
\fi
} \makeatother
% ----- define the new part
\let\originalpart=\part
\def\part#1{\cleardoublepage\clearpage \pagecolor{\partcolor} \originalpart{#1}\nopagecolor }

%----------------------------------------------------------------------------------------
%   calligraphic first letter \yinipar \lettrine
%----------------------------------------------------------------------------------------
%\usepackage{yfonts} 
\usepackage{yfonts,color,lettrine}
\definecolor{caligraphcolor}{HTML}{74AECB}

% https://tex.stackexchange.com/questions/252169/drop-cap-using-yfonts-and-yinipar-on-a-double-spaced-text	
\usepackage{setspace}
%\onehalfspacing
\renewcommand{\LettrineFont}{\initfamily\color{red}}
\setcounter{DefaultLines}{3}
\AtBeginDocument{\setlength{\DefaultFindent}{0.5em}}
\setlength{\DefaultNindent}{0pt}
\renewcommand{\DefaultLraise}{-0.1}


%----------------------------------------------------------------------------------------
%  alignment in algorithm: \parbox[t]{\dimexpr\linewidth-\algorithmicindent}{}
%----------------------------------------------------------------------------------------
\def\algoalign#1{\parbox[t]{\dimexpr\linewidth-\algorithmicindent}{#1}}

%----------------------------------------------------------------------------------------
%  % reduce space between lines of reference section
%----------------------------------------------------------------------------------------
%\let\oldthebibliography\thebibliography
%\let\endoldthebibliography\endthebibliography
%\renewenvironment{thebibliography}[1]{
%	\begin{oldthebibliography}{#1}
		\setlength{\itemsep}{0em}
%		\setlength{\parskip}{0.18em}
%	}
%	{
%	\end{oldthebibliography}
%}




%\jmlrheading{1}{2024-}{1-48}{4/00}{10/00}{Jun Lu}
\firstpageno{1}


%----------------------------------------------------------------------------------------
%   symbols
%----------------------------------------------------------------------------------------
\input{symbols.tex}
\input{symbols_theorems}


\begin{document}
%\includepdf{covers/cover-2022-matrix.pdf} 
%\includepdf[pages=-,scale=1.1,offset=0mm -4mm,]{imgs_header/front-cover-2024.pdf} 
%\blankpage
%\newpage

\frontmatter
% ---------- front page 1 ----------
\pagecolor{lowblue}
\newpage
\thispagestyle{empty}
%\includegraphics{imgs_header/headmatrix-blue.pdf}
\begingroup
\hypersetup{
	colorlinks=true, %set true if you want colored links
	linktoc=all,     %set to all if you want both sections and subsections linked
	linkcolor=mydarkblue,  %choose some color if you want links to stand out
	anchorcolor=blue,
	citecolor=mydarkgreen,
	urlcolor=mydarkblue,
}
%\begin{textblock}{14}(1,3.2)
%{\Large \noindent This book gives a comprehensive summary of the important matrix decomposition methods such as QR, ID, CUR, and SVD, as well as their state-of-the-art applications. It's worth noting that the improved programs for most decomposition algorithms were introduced that could potentially reduce their complexity. It is an interesting book for the researchers or engineers in this field.
%	
%--\href{https://scholar.google.com.hk/citations?user=DpRPZhgAAAAJ&hl=en&oi=ao}{Hua Zhang}, Professor of Environmental Engineering, Tongji University
%
%}
% 
%\end{textblock}
\endgroup
\clearpage
% ---------- front page 2 ----------
%\pagecolor{lowpink}
%\newpage
%\thispagestyle{empty}
%\includegraphics{imgs_header/headmatrix-pink.pdf}
% ---------- front page 3， 4 ----------
%\newpage
%\thispagestyle{empty}
%\includegraphics{imgs_header/headmatrix-pink.pdf}
%\newpage
%\thispagestyle{empty}
%\includegraphics{imgs_header/headmatrix-pink.pdf}

\clearpage
\nopagecolor % Use this to restore the color pages to white

	
	

	

\thispagestyle{empty}  % do not heading for first pages 
\title{Practical Topics in Optimization}



\author{
\begin{center}
\name Jun Lu \\ 
\email jun.lu.locky@gmail.com \\
\copyright \,\, 2025$\sim$ \,\, Jun Lu\\
%Version 0.1
\end{center}
}



\maketitle


\chapter*{\centering \begin{normalsize}Preface\end{normalsize}}


In an era where data-driven decision-making and computational efficiency are paramount, optimization plays a foundational role in advancing fields such as mathematics, computer science, operations research, machine learning, and beyond. From refining machine learning models to improving resource allocation and designing efficient algorithms, optimization techniques serve as essential tools for tackling complex problems. This book aims to provide both an introductory guide and a comprehensive reference, equipping readers with the necessary knowledge to understand and apply optimization methods within their respective fields.

Our primary goal is to demystify the inner workings of optimization algorithms, including black-box and stochastic optimizers, by offering both formal and intuitive explanations. Starting from fundamental mathematical principles, we derive key results to ensure that readers not only learn how these techniques work but also understand when and why to apply them effectively. By striking a careful balance between theoretical depth and practical application, this book serves a broad audience, from students and researchers to practitioners seeking robust optimization strategies.


A significant focus is placed on gradient descent, one of the most widely used optimization algorithms in machine learning. The text examines basic gradient descent, momentum-based methods, conjugate gradient techniques, and stochastic optimization strategies, highlighting their historical development and modern applications. Special attention is given to stochastic gradient descent (SGD) and its pivotal role in optimizing deep neural network or transformer structures, particularly in overcoming computational challenges and escaping saddle points. The book traces the evolution of these methods from the pioneering work of Robbins and Monro in 1951 to their current status as core technologies in deep learning or large language models.

Beyond gradient-based techniques, the book explores modern optimization methods such as proximal algorithms, augmented Lagrangian methods, the alternating direction method of multipliers (ADMM), and trust region approaches. It also discusses least squares problems, sparse optimization, and learning rate adaptation strategies, all of which play critical roles in large-scale and high-dimensional optimization settings.

%While the book is intended to be self-contained, providing rigorous proofs and structured development of ideas, it acknowledges the vast scope of the field. Some specialized topics, such as advanced convex optimization techniques, are briefly touched upon but left for more specialized texts in numerical optimization for further exploration.

%With minimal mathematical prerequisites---requiring only a first course in linear algebra and calculus---the book remains accessible while still offering depth for experts. By combining mathematical rigor with practical insights, it provides a cohesive, structured, and insightful treatment of optimization. Whether you are a student seeking foundational knowledge, a researcher exploring theoretical advancements, or a practitioner applying optimization techniques to real-world challenges, this book serves as a valuable resource for mastering modern optimization techniques and their applications.







\paragraph{Keywords.}
Optimality conditions, First-order methods, Second-order methods, Newton's method, Gradient descent, Stochastic gradient descent, Steepest descent, Greedy search, Conjugate descent and conjugate gradient, Learning rate annealing, Adaptive learning rate.



\vspace{5em}
\noindent
%\textit{Acknowledgment: }



\newpage
\begingroup
%\hypersetup{linkcolor=black}
\hypersetup{
linkcolor=structurecolor,
linktoc=page,  % page: only the page will be colored; section, all, none etc
}
\dominitoc
%\addtocontents{toc}{\protect{\pdfbookmark[0]{\contentsname}{toc}}}
\pdfbookmark{\contentsname}{toc} %% att TOC to bookmark
\tableofcontents 
%\listoffigures 
\endgroup



\input{chapter-notation}

\mainmatter
\input{chapter-intro}
\input{chapter-opt}
\input{chapter-GD}
\input{chapter-first}
\input{chapter-constraint}
\input{chapter-second}
\input{chapter-lssparse}
\input{chapter-stocopt}



\newpage
\vskip 0.2in
% \setcitestyle{numbers}
\bibliography{bib}


\clearpage
\printindex
\clearpage

%\input{end}


\backmatter
\clearpage
\pagestyle{empty}
% --------------------
% ---------- back page  1 ----------
%\newpage
%\thispagestyle{empty}

%\pagecolor{lowpink}
%\newpage
%\thispagestyle{empty}
%\includegraphics{imgs_header/headmatrix-pink.pdf}
% ---------- back page  2, 3 ----------
%\newpage
%\pagecolor{titlepagecolor}
%\includegraphics{imgs_header/headmatrix-pink.pdf}
%\newpage
%\pagecolor{titlepagecolor}
%\includegraphics{imgs_header/headmatrix-pink.pdf}
% ---------- back page  4 ----------
%\newpage
%\pagecolor{lowblue}   %titlepagecolor
%\nbvspace[3]
%\hfill\includegraphics{imgs_header/headmatrix-white.pdf}\hfill
%\nbvspace[3]



%\clearpage
%\nopagecolor





%\newpage
%\pagecolor{lowblue}
%\cleardoublepage
%\includepdf[pages=1,scale=1.1,offset=0mm -4mm,]{imgs_header/back-cover.pdf} 







\end{document}
