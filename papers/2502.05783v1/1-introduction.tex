\input{fig_tab_alg/fig_teaser}

\section{Introduction}
\label{sec:introduction}
% Human habits unfold at different scales, ranging from life-long routines that span years (\eg ) to small-scale actions that occur within a few minutes or even seconds (\eg ). 

% Everyday habits, formed based on individuals' daily routines, often have a lasting impact on personal health and well-being. For instance, evidence from public health has shown that the habits of xxx amount of daily water consumption, regular physical exercise, xxx, are all beneficial for one's health.

Recent advances in mobile sensing technologies and artificial intelligence (AI) have led to the emergence of research on intelligent, just-in-time interventions (JITIs)  using mobile or wearable devices \cite{li2024stayfocused, sarker2014assessing, liao2020personalized, rojas2021scalable, alharbi2023smokemon, rabbi2015mybehavior, zhao2023affective}.
A typical research paradigm usually starts by identifying a target undesirable behavior, followed by data collection from mobile and/or wearable devices, machine learning (ML) model development, and finally, real-time system evaluation (\eg \cite{orzikulova2024time2stop, han2022stressbal, lee2017itchtector, kim2022prediction, alharbi2023smokemon}).
When deployed, these systems will detect the occurrence of target behaviors and deliver JITIs to help users regulate their behaviors and achieve personal health goals.
In the past decade, researchers have achieved a wide range of successful JITI applications, such as reducing smartphone overuse \cite{lu2024interactout, xu2022typeout}, prevention of sedentary habits \cite{liao2020personalized}, smoking cessation \cite{alharbi2023smokemon}, promoting skin health \cite{lee2017itchtector, rojas2021scalable}, and managing stress and emotions \cite{kim2022prediction, koch2021drivers}.

Existing research predominantly focuses on \textit{common} health behaviors that are generally applicable to a large group of populations. However, some individuals' undesirable behaviors can be highly \textit{personal} and \textit{idiosyncratic}. This is especially the case for personal micro-actions or micro-habits.
Example actions include leg-shaking, nail-biting, hair-pulling, and skin-picking (some referred to as body-focused repetitive behaviors, BFRBs) \cite{stein1998phenomenology, snorrason2012skin,teng2002body,oshio2018shake,stein2008trichotillomania}. Such micro-actions can have negative impacts on ones' health (\eg lip-picking can cause cheilitis symptoms \cite{chalkoo2016exfoliative,greenberg2017diseases}), or unfavorable social implications (\eg leg-shaking is considered rude and disrespectful in some cultures~\cite{yilmaz2024leg}).
Such actions vary considerably across individuals \cite{xu2022enabling}, shaped by diverse physical, psychological, social, and environmental factors \cite{trapp2015individual}. Consequently, developing a personalized JITI system poses substantial challenges in both data collection and model training. From a data-collection perspective, it is impractical to require users to gather extensive real-world samples of every undesirable action. From a modeling perspective, training a robust system on such limited data to provide personalized interventions that are adapted to individual contexts and goals remains difficult.

To address this gap, we built \textbf{\projectname}, a smartwatch-based system enabling users to go beyond pre-defined undesirable actions and easily customize new interventions targeted at their own specific undesirable actions.
We developed a few-shot learning pipeline that only requires a small number of samples of the individual target behavior and outputs a reliable ML model for customized behavior detection and real-time JITIs.
Specifically, we built on top of a pre-trained inertial measurement unit (IMU) model based on self-supervised learning (SSL) \cite{yuan2024self} and finetuned the model on multiple open IMU datasets of hand-gesture recognition, with the goal to enhance the model's feature embedding capability on fine-grained actions.
Then, given the small sample sizes of new target behaviors, we adopted a series of data augmentation and data synthesis techniques to train additional lightweight classification layers for the new custom undesirable actions for each individual.

We evaluated our system through both an offline evaluation experiment and a real-time intervention study.
For the offline evaluation, we pre-determined a set of five micro-actions that are typically considered negative behaviors and can be captured with a wrist-worn smartwatch, including face-scratching, nail-biting, eye-rubbing, lip-picking, and leg-shaking \cite{stein1998phenomenology, snorrason2012skin,teng2002body,oshio2018shake,stein2008trichotillomania}.
We then collected data from participants (N=26) on these five actions. We also ask participants to self-define new wrist-based actions that they want to receive intervention. Our final model achieves an average accuracy of 76.8\%, 84.7\%, and 87.7\%, and an F1 score of 74.8\%, 84.2\%, and 87.2\% with one, five, and ten examples.
Building on the model, to evaluate the intervention effectiveness of \projectname, we conducted another four-hour-long study (N=21) that simulated real-life intervention experience.
We compared our system against a rule-based intervention method in an environment where participants naturally tended to perform their self-chosen actions.
The results indicate that \projectname reduced undesirable actions by 64.0Â±22.6\% with statistical significance (p<0.05), and our system substantially outperformed the baseline intervention method by 29.0\% (p<0.05).
Participants' qualitative feedback also revealed interesting insights into the human-AI intervention experience, including participants' distorted perceptions of the intervention's strength and effectiveness, and various collaborative relationships between users and AI.
The effectiveness of \projectname to mitigate personal undesirable behaviors, shown by both an offline evaluation experiment and a real-time intervention study, sheds light on the future design of personalized AI-powered JITI systems.
Overall, our contributions can be summarized as:

\begin{s_itemize}
\item We introduced \projectname, the first smartwatch-based JITI system that empowers users to define personalized intervention on undesirable micro-actions.
\item We conducted an offline evaluation of our few-shot learning pipeline by recognizing different numbers of undesirable actions and numbers of few-shot samples. This extensive evaluation indicates the robust performance of our pipeline.
\item We implemented \projectname as a real-time intervention system and conducted a user study to evaluate its effectiveness. Our results not only show its advantage over the baseline, but also reveal a range of interesting insights that can guide the future design of human-AI intervention systems.
\end{s_itemize}