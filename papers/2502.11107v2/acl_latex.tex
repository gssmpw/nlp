% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}
% hyperfootnotes=false

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}



\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{assumption}{Assumption}
\newtheorem{claim}{Claim}
\newtheorem{lemma}{Lemma}
\newtheorem*{remark}{Remark}

\newcommand{\cross}{\mathrm{CE}}
\newcommand{\kl}{\mathrm{KL}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\expect}{\mathbb{E}}
\newcommand{\prob}{\mathbb{P}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\bE}{\mathbb{E}}
\newcommand{\argmax}{\text{argmax}}
\newcommand{\argmin}{\text{argmin}}
\newcommand{\eps}{\varepsilon}
\newcommand{\tv}{\mathrm{D}_{\mathrm{TV}}}
\newcommand{\sq}{\mathrm{D}_{\mathrm{SQ}}}
\newcommand{\dist}{L}
% \newcommand{\dist}{L_\mathcal{P}}
\newcommand{\disthat}{\hat{L}}


\usepackage{cancel}


% 目录行距
\makeatletter
\renewcommand{\tableofcontents}{%
    \section*{\contentsname}%
    \begingroup
    \setlength{\baselineskip}{20pt} % 调整行距，值越小行距越窄
    \@starttoc{toc}%
    \endgroup
}
\makeatother

\allowdisplaybreaks[4]


\usepackage{subfigure}
\usepackage{booktabs}
\usepackage{subcaption}
\usepackage{float}








% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.

\usepackage[preprint]{acl}
% \usepackage[review]{acl}




\usepackage{url}
\def\UrlBreaks{\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X\do\Y\do\Z\do\[\do\\\do\]\do\^\do\_\do\`\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,\do\?\do\'\do+\do\=\do\#}


% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets


\usepackage[utf8]{inputenc}

\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}



% \usepackage{hyperref}
% \usepackage[pdftex]{hyperref}
% \usepackage[hyperfootnotes=true]{hyperref}

\usepackage[capitalize,noabbrev]{cleveref}




% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\title{Revisiting Weak-to-Strong Generalization in Theory and Practice: \\ Reverse KL vs. Forward KL}



\author{
\textbf{Wei Yao\textsuperscript{1{$\star$}}},
\textbf{Wenkai Yang\textsuperscript{1{$\star$}}},
\textbf{Ziqiao Wang\textsuperscript{2}},
\textbf{Yankai Lin\textsuperscript{1}},
\textbf{Yong Liu\textsuperscript{1}$^{\dag}$}
\\
\\
 \textsuperscript{1}Gaoling School of Artificial Intelligence, Renmin University of China,
\\
 \textsuperscript{2}School of Computer Science and Technology, Tongji University,
\\
\tt\footnotesize\{wei.yao, wenkaiyang, yankailin, liuyonggsai\}@ruc.edu.cn~~ziqiaowang@tongji.edu.cn\\
}


\begin{document}
\maketitle


\let\thefootnote\relax\footnotetext{$^\star$ Equal contribution\hspace{3pt} \hspace{5pt}$^{\dag}$ Corresponding author\hspace{5pt}}



\begin{abstract}
As large language models advance toward superhuman performance, ensuring their alignment with human values and abilities grows increasingly complex. 
Weak-to-strong generalization offers a promising approach by leveraging predictions from weaker models to guide stronger systems, but its effectiveness could be constrained by the inherent noise and inaccuracies in these weak predictions. 
To address this, we propose a theoretically grounded approach that replaces forward KL divergence—whose mass-covering behavior risks overfitting to imperfect weak signals—with reverse KL divergence. 
Reverse KL divergence’s zero-forcing effect prioritizes high-confidence predictions, effectively mitigating the influence of unreliable weak supervision.
Theoretically, we extend existing bounds and derive tighter lower bounds for both forward and reverse KL divergence, establishing that reverse KL achieves at least comparable guarantees to forward KL. 
Notably, when a sufficiently pre-trained strong model is fine-tuned on the last linear layer, reverse KL guarantees that it outperforms its weak supervisor by the magnitude of their disagreement.
Empirically, we demonstrate that reverse KL and reverse cross-entropy enable strong models to successfully outperform those trained with forward KL and standard cross-entropy across most settings, highlighting the practical advantages of these reverse losses.
\end{abstract}




\input{sections/introduction}

\input{sections/related_work}

\input{sections/preliminaries}

\input{sections/bound}

\input{sections/experiments}

\input{sections/conclusion}




% \newpage

\bibliography{custom}

\newpage
\onecolumn
\appendix

\clearpage
\tableofcontents
\newpage

{\LARGE \centering \textbf{Appendix} \par}
\input{sections/appendix}



\end{document}
