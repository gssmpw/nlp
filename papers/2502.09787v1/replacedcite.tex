\section{Related Work}
\added{Below, we discuss prior work on human factors of spreadsheet programming (Section~\ref{sec:human-factors-of-spreadsheet-programming}), scaffolding tools for programming tasks (Section~\ref{sec:scaffolding-processes}), and AI for spreasheet programming (Section~\ref{sec:llm-agents}).
}
Given the rapid advances in LLMs, our discussions offer a snapshot of the field as of December 2024.

\subsection{Human Factors of Spreadsheet Programming}
\label{sec:human-factors-of-spreadsheet-programming}
Prior work has investigated the process that spreadsheet programmers follow to create spreadsheets, revealing its complex and iterative nature.
In a field study of 11 spreadsheet programmers, ____ found that spreadsheet development was collaborative by nature and required both programming and domain expertise.
This expertise was often distributed among multiple individuals who had different specialties.
Closely related is ____'s cognitive task analysis, which found that professionals who developed knowledge products from data like spreadsheets followed a defined process.
This involved gathering information, developing a schema for analysis, generating insights by manipulating the schema, and creating some knowledge product or action.
Further, the authors found that the expert process involved a foraging loop (i.e., finding, searching, filtering, and extracting information) and a sense making loop (i.e., developing a mental model for a schema).

Other studies have revealed the challenges associated with spreadsheet development.
Spreadsheet programmers often struggle to find the correct abstractions to use and to know how to reuse existing code to accomplish a task____.
In addition, spreadsheet programs can be difficult to understand, extend, and manage____. 
As a result, they can be riddled with errors, including mechanical and logic errors____.
Although automating aspects of spreadsheet programming could be helpful____, it can also come at a cost to the programmer.
____ found that there was no clear benefit in using tools in spreadsheet programming: while tool usage could increase task correctness, it could also result in longer task completion times.

The prior literature on human factors of spreadsheet programming reveals rich insights on how programmers develop spreadsheets.
However, these works do not study how spreadsheet programmers use scaffolding tools like spreadsheet templates, which is vital to understanding how AI can guide spreadsheet development.
We corroborate and extend the findings of these studies by examining the benefits and challenges of using scaffolding tools in spreadsheet development in our formative user study (see Section~\ref{sec:formative-user-study}).
In addition, we leverage the insights from these studies in the design principles (see Section~\ref{sec:design-goals}) and implementation of \tool (see Section~\ref{sec:tool}),
such as having the agent follow the process from ____ for spreadsheet programmers.

\subsection{Scaffolding Tools for Programming}
\label{sec:scaffolding-processes}
Scaffolding tools help users complete complex tasks by structuring tasks in a way such that they can accomplish tasks that they struggle to attain on their own____.
Examples of scaffolding tools include templates, examples of other work, hints, or links to resources____, as well as step-by-step instructions to complete a task____.
In programming, scaffolding tools can help programmers with problem solving and planning. 
They have been applied to a variety of complex programming tasks, such as decision making____, debugging____, software architecture, and testing____.
However, scaffolding tools struggle to offer the right level of support by being too general or too specific____.
For example, when a programmer follows expert-defined instructions to solve programming problems---known as programming strategies____---it can be difficult to apply the strategy because it may not consider the programmer's unique context or be written too abstractly____.

LLMs have shown promise in alleviating these challenges by imbuing additional flexibility and user context into scaffolding tools for complex tasks, such as for the academic peer review process____ and information sense making____.
In programming, LLM-based scaffolding approaches have shown promise in helping programmers.
The most closely related tool to \tool is ROBIN____, a tool that guides programmers through a predefined debugging programming strategy.
ROBIN is implemented with four main LLM-based components, including one for generating follow-ups in the conversation.
With this approach, ROBIN led to a 150\% increase in defect localization rates and a 250\% increase in defect resolution rates compared to the baseline.

Overall, this body of literature points to the promise of scaffolding tools assisting spreadsheet programmers in creating spreadsheets.
However, to the best of our knowledge, scaffolding tools for spreadsheet development remain understudied.
This is because, rather than guiding programmers through complex tasks, many intelligent spreadsheet tools have focused on developing improved interfaces, algorithms, or machine learning techniques for a range of spreadsheet development tasks.
This includes writing formulas____, prototyping tables____, debugging____ as well as defining test cases____, assertions____, and constraints____.
Of these tools, perhaps the most related to \tool is Table Illustrator____ and GridBook____.
Table Illustrator____ is an interactive system that facilitates the rapid prototyping of different table layouts by allowing programmers to arrange puzzle pieces as a metaphor for table construction.
In the Table Illustrator user study, ____ found that the tool performed similarly to Excel, while decreasing cognitive load and task completion time.
Meanwhile, GridBook____ is an interactive system that allows programmers to provide input in natural language within a spreadsheet cell and uses deep learning techniques to generate formulas.
In the GridBook user study, ____ found that the tool performed comparably to Excel, but reduced task completion time compared to Jupyter notebooks.

However, some work has studied scaffolding spreadsheet programming, namely, detecting and producing spreadsheet templates____.
ViTSL____ is a visual programming language that defines abstractions for the spreadsheet structure to reduce spreadsheet programming errors.
It offers abstractions on cells, references, vertical groups, and horizontal groups.
Gencel____, an Excel add-on, then generates and edits tables that conform to the ViSTL template structure.
In Gencel's user study, ____ found that the participants wanted more flexibility in ViSTL templates and expressed concern in being able to adapt ViSTL templates due to the required programming knowledge.

To our knowledge, \added{\tool is the first conversational tool that uses LLM language agents to scaffold the spreadsheet creation process}.
Compared to Table Illustrator____ and GridBook____, \tool follows a scaffolding approach to develop spreadsheets. 
Unlike GridBook, \tool uses conversation rather than annotations in spreadsheet cells to develop speadsheets and further, can manipulate spreadsheet presentation (e.g., themes) in addition to complex formulas; unlike Table Illustrator, \tool uses state-of-the-art LLMs to create spreadsheets and supports the development of complex formulas, rather than being limited to simple summations.
Next, we build on previous work on spreadsheet programming scaffolding tools, such as ViSTL____ and Gencel____, by using language agents to provide additional flexibility in the spreadsheet creation process.
Finally, we extend the existing body of literature on LLM scaffolding tools such as ROBIN____ by studying the collaboration between programmers and agents that can modify the development environment, which is becoming increasingly important with the adoption of agentic approaches in practice with tools like Devin____. 

\subsection{AI for Spreadsheet Programming}
\label{sec:llm-agents}
Prior work has investigated multiple approaches for LLMs to solve spreadsheet programming tasks.
Previously, LLMs solved a range of self-contained spreasheet programming tasks through pre-training and fine-tuning, such as formula prediction____ and cell role prediction____.
Recently, a budding approach has allowed LLMs to complete more complex tasks and increase task performance in spreadsheet programming: \emph{language agents}, also known as agents.
Agents achieve a specific goal by observing the environment, performing actions, generating utterances, modeling internal state, and inferring intentions from others____.
Compared to traditional LLMs, which focus on generating text autoregressively (i.e., from left to right) given the previous text, agents put special emphasis on dynamic planning and proactive action-taking within an environment to complete tasks.
Following the trend of using language agents to achieve state-of-the-art performance in software development tasks (e.g., closing issues____ and generating code and tests____), ____ developed an agent to manipulate spreadsheets called SheetCopilot. 
SheetCopilot can understand spreadsheet manipulation requests in natural language and construct and execute plans to achieve the request.
Based on a benchmark of 221 spreadsheet programming tasks, SheetCopilot completed 44.3\% of the tasks in a single generation.

Although these advances have enabled state-of-the-art performance, agentic systems do not typically consider the role of human interaction, as they restrict human involvement to providing annotations on agent actions____ or limiting interactions to the beginning of the task rather than throughout the task (e.g.,____).
This reduces the usability of agent-based systems, as these approaches violate long-established principles in human-AI collaboration that underscored the importance of granular user feedback____ and the refinement of AI output____.
Thus, compared to other agentic approaches, \tool explores human-agent collaboration by being designed to work interactively with spreadsheet programmers to perform their tasks.
Rather than trying to complete a task in a single user interaction as in previous work____, \tool scaffolds the spreadsheet creation process and allows programmers---rather than models---to provide feedback on intermediate states and evaluate multiple next steps for planning.