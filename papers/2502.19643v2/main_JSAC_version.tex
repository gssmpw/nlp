\documentclass{IEEEtran}
\input{preamble}


\begin{document}
\bstctlcite{IEEEexample:BSTcontrol} % Control reference style


\title{Electromagnetically Reconfigurable Fluid Antenna System for Wireless Communications: Design, Modeling, Algorithm, Fabrication, and Experiment}

\input{authors}

\begin{abstract} 
This paper presents the concept, design, channel modeling, beamforming algorithm, prototype fabrication, and experimental measurement of an electromagnetically reconfigurable fluid antenna system (ER-FAS), in which each FAS array element features electromagnetic (EM) reconfigurability. Unlike most existing FAS works that investigate spatial reconfigurability by adjusting the position and/or orientation of array element, the proposed ER-FAS enables direct control over the EM characteristics of each element, allowing for dynamic radiation pattern reconfigurability. Specifically, a novel ER-FAS architecture leveraging software-controlled fluidics is proposed, and corresponding wireless channel models are established. Based on this ER-FAS channel model, a low-complexity greedy beamforming algorithm is developed to jointly optimize the analog phase shift and the radiation state of each array element. The accuracy of the ER-FAS channel model and the effectiveness of the beamforming algorithm are validated through (i) full-wave EM simulations and (ii) numerical spectral efficiency evaluations. Simulation results confirm that the proposed ER-FAS significantly enhances spectral efficiency in both near-field and far-field scenarios compared to conventional antenna arrays. To further validate this design, we fabricate hardware prototypes for both the ER-FAS element and array, using Galinstan liquid metal alloy, fluid silver paste, and software-controlled fluidic channels. The simulation results are experimentally verified through prototype measurements conducted in an anechoic chamber. Additionally, indoor communication trials are conducted via a pair of software-defined radios which demonstrate superior received power and bit error rate performance of the ER-FAS prototype. This work comprehensively demonstrates a liquid-based ER-FAS array for improved communication, featuring a novel EM reconfigurable design, wireless channel modeling, and beamforming, backed by simulations, hardware, and experiments.
\end{abstract}

\vspace{-1em}
\begin{IEEEkeywords}

electromagnetically reconfigurable antennas,
fluid antenna system,
wireless communication,
hardware fabrication,
experimental measurement.

\end{IEEEkeywords}


\section{Introduction}
The fifth-generation (5G) and sixth-generation (6G) networks envisage extremely high data rate and capacity, requiring fundamental breakthroughs at the physical layer~\cite{Dang2020Should}, which imposes intrinsic performance limitations~\cite{WKK2023FAS_Part2}. Recently, fluid antenna systems (FAS) have emerged as a state-of-the-art concept that enhances the flexibility of the physical layer, making them a promising technology for future 6G networks~\cite{NWK2024FAS_Tutorial}. Extensive investigations into switching antenna locations with spatial reconfigurability for advancing wireless communication applications have been reported~\cite{WKK2021First_Paper_on_FAS, ChaoWang2024FAS, NWK2025Oversampling}. Compared with traditional antenna systems, FAS introduces a new degree of freedom of activating the optimal position/port and provides substantial opportunities to enhance the spatial diversity and multiplexing capabilities of wireless communication systems~\cite{WKK2023FAS_Part1, WKK2023FAS_Part3}. Meanwhile, FAS can be potentially integrated with other cutting-edge systems and technologies, such as reconfigurable intelligent surfaces~\cite{Wang_ruiqi2024TAP}, massive \ac{MIMO} ~\cite{Ying2024Reconfigurable} and integrated sensing and communications (ISAC)~\cite{LA2022ISAC_Tutorial}, to further enhance future wireless networks. 

To distinctly clarify the concept of FAS in terms of spatial and \ac{EM} reconfigurability, detailed explanations are provided below. The FAS and other next-generation reconfigurable antenna (NGRA) technologies can be generally classified into three main categories: spatially reconfigurable, electromagnetically reconfigurable, and time-modulated. Firstly, in the spatial domain, the position or orientation of the antenna system can be flexibly changed, which is considered as spatially reconfigurable FAS (SR-FAS), also referred to as movable antenna (MA)\cite{Zhu_lipeng2024Magzine_MA, Zhu_lipeng2024TWC_MA}. For SR-FAS or MA, the spatial position can be adjusted; however, the intrinsic electromagnetic features of the antenna system itself do not change. In this case, FAS and MA share the same concept, where the communication performance enhancement is achieved by adding the spatial degree of freedom\cite{zhu2024historicalreviewfluidantenna}. Additionally, in the electromagnetic domain, FAS can also change its intrinsic electromagnetic radiation properties by reshaping the metallic patterns or the dielectric substrates while maintaining the antenna position~\cite{Song_lingnan2019TAP}. By reconstructing the shape of the overall radiator, electromagnetic features such as frequency, polarization, and radiation pattern can be flexibly controlled~\cite{Rodrigo2014TAP}. To differentiate it from the SR-FAS, we name this type of FAS as \ac{ER-FAS}. Lastly, in the time domain, FAS can be reconfigured by introducing the fourth dimension, time, to enhance overall performance~\cite{Zhu_quanjiang2014TAP}.

In the current literature, on the one hand, a series of theoretical studies on FAS has been reported. For example, \cite{Khammassi2023TWC}~presented a new analytical approximation for the FAS channel. In \cite{Wang_chao2024AI-empowered}, artificial intelligence (AI) has been investigated for empowering FAS optimization. The performance limits of FAS are characterized in~\cite{WKK2020FAS_limit}. However, the majority of these works focus only on spatial reconfigurability, i.e., SR-FAS or MA. On the other hand, despite the significant potential and promising capabilities of FAS, most studies remain theoretical, lacking full-wave simulation and experimental validation. Only a hand-
ful of works demonstrate experimental results. For instance, \cite{dong2024movableantennaprototyping} fabricated an MA system and conducted experiments that verified the MA can achieve full spatial performance gain in a practical environment. Nevertheless, the MA/SR-FAS only changes the antenna position without altering the intrinsic antenna electromagnetic radiation performance. Such reconfigurable methods typically require a heavy mechanically controlling platform that introduces extra design complexity and overall hardware cost\cite{dong2024movableantennaprototyping}, which also limits its application scenarios. Compared to MA/SR-FAS, a more efficient solution is ER-FASs, where the radiation properties of the FAS array element can be dynamically adjusted in real time by altering the fluid state of the RF radiator. A pixel-based reconfigurable antenna design for FAS with high switching speed is presented in~\cite{Zhang_jichen2025OJAP}, where reconfigurability is realized by changing the interconnection states between pixels\cite{Lotfi2017TAP}. However, FAS realized through pixels typically has mutual coupling issues due to the unutilized pixels still having parasitic electromagnetic coupling effect on the interconnected pixels. Therefore, a more promising approach for implementing ER-FAS can be utilizing the conductive liquid, where controlling the presence or absence of fluid metal can effectively circumvent the mutual coupling effect. Moreover, liquid metal-based FAS can be mechanically flexible to fit various practical applications with conformal requirements. Overall, to the authors' best knowledge, studies on ER-FAS for communication systems are still in the early stages, which will be comprehensively explored in this study.

In this work, we practically design a novel ER-FAS for wireless communication systems, where the radiation pattern of each array element can be reconfigured through software-controllable fluidics. Based on the proposed antenna design, we model the wireless channel for both near-field and far-field scenarios. Additionally, a low-complexity beamforming algorithm is developed for the ER-FAS system to optimize the analog phase shift and the radiation state of each antenna jointly. While the performance of the proposed model and algorithm has been validated through full-wave beampattern simulation and numerical spectral efficiency evaluation, we fabricate prototypes of the proposed ER-FAS design with both element and array configurations for further validation. Anechoic chamber measurements and indoor communication tests have been conducted to validate the simulation results. The main contributions of this work are summarized as follows:

\subsubsection{Proposing a Novel Practical ER-FAS Design}
We propose a novel practical ER-FAS design. By associating fluid radiators with controllable feeding phases, this design provides an antenna array with extensive degrees of freedom, enhancing wireless communication performance in complex channel conditions.

\subsubsection{Modeling and Beamforming for ER-FAS-Based Communications}
To characterize the newly introduced ER-FAS features, a single-user \ac{MIMO} channel model is developed in both near-field and far-field scenarios, capturing its EM-domain flexibility over conventional arrays. Furthermore, a greedy beamforming algorithm is designed to optimize analog phase shifts and antenna state selection with low complexity.

\subsubsection{Full-Wave Validation of the Derived Model and Numerical Evaluation of the Proposed Beamforming Algorithm}
We perform full-wave simulations to validate the proposed ER-FAS channel model and evaluate the spectral efficiency to assess the effectiveness of the beamforming algorithm. The results show the superior spectral efficiency of the ER-FAS design compared to conventional antenna arrays.

\subsubsection{Prototyping Practical ER-FAS Hardware}
Hardware prototypes are fabricated for both the ER-FAS array element and the entire array. The element prototype validates software-controlled fluidic manipulation and radiation pattern reconfigurability, while the array prototype verifies the beampattern and gain enhancement of the complete ER-FAS.

\subsubsection{Anechoic Chamber Measurements and Indoor Communication Trials}
The performance of the ER-FAS prototypes is measured in an anechoic chamber, showing good agreement with simulations. Additionally, real-world communication performance is validated using a software-defined radio (SDR) setup in indoor environments. The trials assess received power levels and bit error rate (BER), confirming the effectiveness of ER-FAS in enhancing practical communication systems.

The organization of the paper is as follows. Section~\ref{sec:design} demonstrates the proposed ER-FAS design. In Section~\ref{sec:channel modeling}, we model the wireless channel for both far-field and near-field scenarios for the designed ER-FAS \ac{MIMO} system. A greedy algorithm is developed to solve the joint ER-FAS beamforming problem in Section~\ref{sec:beamforming algorithm}. Section~\ref{sec:Full-wave simulation} presents the theoretical analysis with full-wave simulation validation for the ER-FAS design. Subsequently, we present the fabricated hardware prototypes in Section~\ref{sec:Hardware} and conduct experimental measurements in both anechoic chamber and SDR-based indoor communication setup in Section~\ref{sec:Experiments}. Finally, the conclusion is drawn in Section~\ref{sec:Conclusion}.

\section{Electromagnetically Reconfigurable Fluid Antenna Design}\label{sec:design}

\subsection{ER-FAS Concept}\label{subsec:concept}

The proposed ER-FAS hardware concept is demonstrated in Fig.~\ref{fig_FASConcept}. Compared to traditional antenna arrays and SR-FAS, the electromagnetic properties of each element of the ER-FAS can be reconfigured using fluid metal. Generally, antenna reconfigurability can be categorized into three main types: frequency reconfigurability, polarization reconfigurability, and radiation pattern reconfigurability, as shown in Fig.~\ref{fig_FASConcept}. Although it is possible to design an ER-FAS with all three reconfigurabilities, this work focuses on the pattern-reconfigurable type of ER-FAS to demonstrate the proposed concept.

\begin{figure}[t]
  \centering
  \includegraphics[width=0.85\columnwidth]{figures/fig_FASConcept.pdf}
  \vspace{-1em}
  \caption{
    Concept of the electromagnetically reconfigurable fluid antenna system.
  }
  \label{fig_FASConcept}
\end{figure} 

\subsection{ER-FAS Array Element}\label{subsec:element}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.85\columnwidth]{figures/fig_FAS_Array_Element.pdf}
  \vspace{-1em}
  \caption{
    The proposed ER-FAS array element design.
  }
  \label{fig_FAS_Array_Element}
\end{figure} 

Based on the ER-FAS concept, a novel practical ER-FAS element design is proposed in Fig.~\ref{fig_FAS_Array_Element}. The proposed ER-FAS array element consists of three horizontally stacked layers. The front layer comprises parasitic fluid metal channels, where the fluid metal is encapsulated within transparent polymethyl methacrylate (PMMA) and polyethylene terephthalate (PET) substrates. The fluid metal can be injected into and extracted from these channels, which are designed to be transparent to facilitate the visualization of the fluid channel states. The injection and extraction of each fluid metal channel can be independently controlled to prevent coupling effects between different reconfigurable states. The middle layer incorporates a planar monopole antenna with two metallic layers. The monopole antenna is excited via an SMA connector. The back layer consists of an additional set of parasitic fluid metal channels, which are also independently controlled and reconfigurable, further enhancing its adaptability.

The detailed operating principle of the proposed fluid antenna element design is described as follows. First, a planar monopole antenna is designed and optimized to achieve wideband impedance performance. The input RF signal is directly fed to the central planar monopole antenna, serving as the excitation source for the entire antenna element. However, the radiation pattern of the designed planar monopole is quasi-omnidirectional, meaning it radiates EM signals across the entire horizontal plane, which is typically undesirable for phased arrays. In contrast, an array element with a directional pattern is preferred for effective antenna array beamforming. Furthermore, with only the planar monopole element, the array remains static and non-reconfigurable.

Inspired by the Yagi-Uda antenna design~\cite{Yagi1928}, we further introduce two parasitic fluid-metal coupling channels into the planar monopole. The front fluid-metal layer serves as a set of directors that guide the EM wave to radiate into the front space, while the back fluid-metal layer acts as a set of reflectors, reducing back-radiation leakage. By incorporating these two fluid-metal layers, the directivity and front-to-back ratio (FBR) of the antenna element can be substantially improved. More importantly, since each fluid-metal channel for both directors and reflectors can be independently controlled, the overall antenna radiation pattern can be reconfigured accordingly. To provide a better understanding of the working mechanism of the designed ER-FAS element, a practical element model with various reconfigurable states is demonstrated in Fig.~\ref{fig_FAS_Element_Mechanism}. By injecting or extracting fluid metal in both the front and back channels, the overall antenna radiation pattern can be dynamically adjusted. Here, each channel has two states, filled and empty. Thus, both the director and reflector fluid channels contain three-bit information, leading to an array element with a total of six encoded bits, allowing the designed antenna to achieve 64 ($2^{6}$) reconfigurable states. Note that in this work, we introduce only three independent fluid-metal channels for both director and reflector layers as proof-of-concept. However, additional channels can be incorporated, and utilizing $N$ channels per layer can result in \textbf{$2^{2N}$} reconfigurable states.

\begin{figure*}[t]
  \centering
  \includegraphics[width=\linewidth]{figures/fig_FAS_Element_Mechanism.pdf}
  \vspace{-1.8em}
  \caption{ 
     The operation principle of the proposed ER-FAS array element and radiation patterns at different reconfigurable states.
    }
  \label{fig_FAS_Element_Mechanism}
\end{figure*}


The designed ER-FAS element is simulated in ANSYS High-Frequency Structure Simulator (HFSS), and the simulated three-dimensional (3D) radiation patterns are illustrated, as demonstrated in Fig.~\ref{fig_FAS_Element_Mechanism}. Here, for the sake of conciseness, six reconfigurable states (0, 1, 2, 3, 4 and 63) are presented, while the remaining states can be obtained in a similar manner. It can be observed that by configuring the fluid-metal channels, the antenna radiation pattern can be digitally controlled by encoding fluid-metal states. Diverse radiation patterns at different reconfigurable states in the $XOY$-plane are obtained, including radiation pattern direction, FBR, beamwidth, and other parameters. For instance, the radiation pattern can be reconfigured from omnidirectional (state 0) to forward radiation (state 2) and back radiation (state4). The main beam directions can be changed (state 1, 2, and 3). Additionally, the beamwidth can be controlled, as seen in states 2 and 63. Thus, the overall radiation pattern properties of the ER-FAS element can be flexibly optimized and controlled by the parasitic fluid-metal director and reflector channels.

\subsection{Array Configuration of the proposed ER-FAS}\label{subsec:array}

Based on the proposed reconfigurable fluid antenna element design, the entire ER-FAS can be constructed. In general, a two-dimensional (2D) array configuration can be constructed. In this work, we investigate a one-dimensional (1D) array configuration for proof of the proposed concept, which can be easily extended to 2D architectures. The designed 1D array architecture with 12 reconfigurable elements is illustrated in Fig.~\ref{fig_FAS_Array}. All the ER-FAS elements operate at \unit[3.55]{GHz}, which is the center frequency of the fifth generation (5G) n78 band. The space between array elements is determined as half a wavelength to mitigate mutual coupling effects between adjacent array elements.

For the proposed ER-FAS, there are three digitally encoded physical layers. The front layer with directors and the back layer with reflectors can have various combinations of fluid metal presence or absence. The middle layer with the planar monopole array can have different feeding magnitudes and phases. As a result, the ER-FAS hardware provides extensive degrees of freedom to adjust array beampattern and reshape the wireless channel, benefiting applications including but not limited to near-field beam focusing and far-field large-angle beam scanning. In this work, the excitation phase of the planar monopole array is adjustable while the magnitude is maintained. However, it is also feasible to adjust the magnitude to increase the design freedom in practice. Accordingly, the feeding network is designed, as illustrated in Fig.~\ref{fig_Feeding_Network}, comprising a 1-to-12 power divider cascaded with 12 independent phase shifters via RF adapters. The power divider provides 12 outputs with equal phases, and the specific phase states for each planar monopole antenna are achieved by the phase shifters that are realized using microstrip lines with different electrical lengths. Detailed simulation results of the designed ER-FAS are presented in Section~\ref{sec:Full-wave simulation}.


\begin{figure}[t]
  \centering
  \includegraphics[width=0.9\linewidth]{figures/fig_Array.pdf}
  \vspace{-1em}
  \caption{ 
     Array configuration of the proposed ER-FAS. The feeding network in this work maintains a fixed excitation magnitude while reconfiguring only the phase, though adjusting both is also achievable.
    }
  \label{fig_FAS_Array}
\end{figure}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.8\columnwidth]{figures/fig_Feeding_Network.pdf}
  \vspace{-1em}
  \caption{
    The designed feeding network.
  }
  \label{fig_Feeding_Network}
\end{figure} 


\section{Communication System Modeling}\label{sec:channel modeling}
This section models the baseband signal and wireless channel based on the \ac{ER-FAS} proposed in Section~\ref{sec:design}.

\subsection{Signal Model}

We consider a single-user communication system based on \ac{ER-FAS} as demonstrated in Fig.~\ref{fig_MIMOsystem}, where a $N_\Tt$-antenna transmitter (Tx) communicates a single data stream to a $N_\Rt$-antenna receiver (Rx). Both the transmitter and the receiver are equipped with a single \ac{RF} chain. Let~$s\in\mathbb{C}$ denote the transmit symbol. We assume $|s|^2=P_\mathrm{T}$, where $P_\Tt$ represents the transmit power. The transmitter first up-converts the symbol to the carrier frequency by passing through the \ac{RF} chain and then applying an \ac{RF} precoder~$\fv\in\mathbb{C}^{N_\Tt\times 1}$. This \ac{RF} precoder is implemented using analog phase shifters (i.e., the feeding network) with constraint~$|f_i|^2 = 1/N_\Tt$, $i=1,2,\dots,N_\Tt$. After the \ac{RF} precoder, the signal is radiated out via the~$N_\Tt$ transmit antennas, passes through the wireless channel~$\Hm\in\mathbb{C}^{N_\Rt\times N_\Tt}$, and is received by the~$N_\Rt$ receive antennas. Note that in our proposed antenna design, various radiation patterns can be chosen for each antenna individually. This reconfigurability will be reflected in the expression of channel matrix~$\Hm$ later.

The receiver applies a \ac{RF} combiner~$\wv\in\mathbb{C}^{N_\Rt\times 1}$ and then down-converts the radio signal to the baseband through the \ac{RF} chain. Similarly, we constrain the combiner as $|w_j|^2=1/N_\Rt$, $j=1,2,\dots,N_\Rt$. Hence, the final received baseband signal is given by \begin{equation}\label{eq:BBsignal}
    y = \wv^\HH\Hm\fv s + \wv^\HH\nv,
\end{equation}
where~$\nv\sim\mathcal{CN}(\mathbf{0},\sigma^2\mathbf{I}_{N_\Rt})$ denotes additive white Gaussian noise. Therefore, the overall spectral efficiency (rate) of such a system assuming Gaussian signaling is given by~\cite{Goldsmith2003Capacity,Ayach2014Spatially,Sohrabi2016Hybrid}
\begin{equation}\label{eq:Rate}
    R = \log_2 \Big(1+\frac{P_\Tt|\wv^{\HH}\Hm\fv|^2}{\sigma^2}\Big).
\end{equation}
In the following subsections, we model the wireless channel~$\Hm$ in both the far-field and near-field scenarios.

\begin{figure*}[t]
  \centering
  \includegraphics[width=0.9\linewidth]{figures/fig_MIMOsystem.pdf}
  \vspace{-0.7em}
  \caption{ 
     Simplified hardware block diagram of a single-user \ac{MIMO} system based on \ac{ER-FAS} and \ac{RF} phase shifters.
    }
  \label{fig_MIMOsystem}
\end{figure*}


\subsection{Far-Field Channel Model}
In this subsection, we express the channel matrix~$\Hm$ in the far-field condition, which is characterized by the \emph{planar wave model}. We will show that our proposed reconfigurable antenna design introduces extra degrees of freedom to reshape the wireless channel. We start by analyzing the wireless channel based on the conventional antenna array and then extend to the proposed \ac{ER-FAS}. 

\subsubsection{Conventional Antenna Array}
We consider a scenario where a \ac{LoS} and multiple \ac{NLoS} paths exist. Based on the \ac{SV} multipath model, the \ac{NLoS} channel is modeled as the sum of the contributions of $C$ scattering clusters, with the $c^\text{th}$ cluster contributing $L_c$ propagation paths. Assuming an ideal Dirac pulse-shaping filter, the equivalent frequency-domain baseband channel based on a conventional antenna array can be expressed as~\cite{Ayach2014Spatially,Tarboush2021TeraMIMO}
\begin{multline}\label{eq:HFF_conv}
    \Hm_\mathrm{CV} = \gamma\alpha_{\mathrm{LoS}}G_\Rt(\phiv_\mathrm{LoS})G_\Tt(\thetav_\mathrm{LoS})\av_\Rt(\phiv_\mathrm{LoS})\av_\Tt^\HH(\thetav_\mathrm{LoS}) \\
    +\gamma\sum_{c=1}^C\sum_{\ell=1}^{L_c}\alpha_{c,\ell}G_\Rt(\phiv_{c,\ell})G_\Tt(\thetav_{c,\ell})\av_\Rt(\phiv_{c,\ell})\av_\Tt^\HH(\thetav_{c,\ell}),
\end{multline}
where~$\gamma$ is a normalization factor such that~$\gamma = \sqrt{\frac{N_\Tt N_\Rt}{1+\sum_{c=1}^C L_c}}$. Here, $\alpha$ denotes complex channel gain, $\thetav$ denotes \ac{AoD} at the transmitter, and $\phiv$ denotes \ac{AoA} at the receiver, corresponding to different paths. Note that each angle contains an azimuth and elevation components, i.e., $\thetav = [\theta_{\mathrm{az}},\theta_{\mathrm{el}}]^\TT$, $\phiv = [\phi_{\mathrm{az}},\phi_{\mathrm{el}}]^\TT$. For clarity, the azimuth angle is defined as the angle between the positive $X$-axis and the target's projection on the $XOY$-plane, while the elevation angle is the angle between the $Z$-axis and the target direction. Both are expressed in the transmitter's and receiver's body frames. In addition, $G_\Tt$ and $G_\Rt$ represent the transmit and receive \emph{antenna gains}, which are functions of corresponding \ac{AoD} and \ac{AoA}. Finally, the vectors $\av_\Tt$ and $\av_\Rt$ are the normalized receive and transmit \acp{ARV}. Taking $\av_\Tt$ as an example, assuming an $N_\Tt^{\mathrm{h}}\times N_\Tt^{\mathrm{v}}$ \ac{UPA} configuration (thus $N_\Tt=N_\Tt^{\mathrm{h}} N_\Tt^{\mathrm{v}}$), the transmit \ac{ARV} is written as
\begin{equation}
    \av_\Tt(\thetav) = \frac{1}{\sqrt{N_\Tt}}e^{-j2\pi\theta^{\mathrm{h}}\kv(N_\Tt^\mathrm{h})}\!\otimes\! e^{-j2\pi\theta^\mathrm{v}\kv(N_\Tt^\mathrm{v})},
\end{equation}
where~$\kv(N)=[0,1,\dots,N-1]^\TT$, and~$\theta^\mathrm{h}$ and~$\theta^\mathrm{v}$ are the spatial angles corresponding to the horizontal and vertical dimensions, respectively. Assuming the \ac{UPA} is deployed on the $YOZ$-plane of the transmitter's body coordinate system, we obtain $\theta^\mathrm{h}\triangleq{d_\It}\sin(\theta_\mathrm{az})\sin(\theta_\mathrm{el})/{\lambda}$ and $\theta^\mathrm{v}\triangleq{d_\It}\cos(\theta_\mathrm{el})/{\lambda}$, where~$\lambda$ is the wavelength of the operating frequency and $d_\It$ is the inter-element spacing of the transmit antenna array. The receive \ac{ARV} $\av_\Rt(\phiv)$ is defined in the same way.

\subsubsection{Electromagnetically Reconfigurable Fluid Antenna Array}
In conventional antenna arrays, it is trivial to see that each antenna element shares the same radiation pattern, which is characterized by antenna gain function~$G_\Tt(\thetav)$/$G_\Rt(\phiv)$. 
When using the element-reconfigurable array, these antenna elements can choose different radiation patterns by adjusting the state of the liquid conducting material as demonstrated in Section~\ref{sec:design}. We use~$G_{\Tt,i}(\thetav)$ and $G_{\Rt,j}(\phiv)$ to denote the radiation patterns of the~$i^\text{th}$ transmit antenna and the~$j^\text{th}$ receive antenna, respectively. Each of these radiation patterns is chosen from a preset set of $N$ available radiation patterns, which we denote as~$\{\bar{G}_1,\bar{G}_2,\dots,\bar{G}_N\}$. Defining a dictionary vector $\bar{\gv}(\varphiv) \triangleq [\bar{G}_1(\varphiv),\bar{G}_2(\varphiv),\dots,\bar{G}_N(\varphiv)]^\TT$, we can write
\begin{align}
    G_{\Tt,i}(\thetav) &= \bar{\gv}(\thetav)^\TT \bv_{\Tt,i}, \quad i=1,2,\dots, N_\Tt,\\
    G_{\Rt,j}(\phiv) &= \bar{\gv}(\phiv)^\TT \bv_{\Rt,j}, \quad j=1,2,\dots, N_\Rt.
\end{align}
Here, $\bv_{\Tt,i}$ and $\bv_{\Rt,j}$ are two binary vectors denoting the selection of radiation pattern, which are constrained as 
\begin{equation}\label{eq:ConsSelection}
    \bv_{\Tt,i},\bv_{\Rt,j}\in\{\bv|b_n\in\{0,1\},n=1,2,\dots,N,\|\bv\|_2=1\}.
\end{equation}
For notational convenience, we assume that the transmit and receive antennas share the same set of reconfigurable radiation patterns.

Based on this radiation pattern selection mechanism, we can extend~\eqref{eq:HFF_conv} to our \ac{ER-FAS} as
\begin{align}\label{eq:HFF_new1}
    &\hspace{-0.5em}\Hm_\mathrm{ER}\! =\! \gamma\alpha_\mathrm{LoS}\big(\gv_\Rt(\phiv_\mathrm{LoS})\!\odot\!\av_\Rt(\phiv_\mathrm{LoS})\big)  \big(\gv_\Tt(\thetav_\mathrm{LoS})\!\odot\!\av_\Tt(\thetav_\mathrm{LoS})\big)^\HH\notag\\
    &\hspace{-0.5em}+ \!\gamma\!\sum_{c=1}^C\!\sum_{\ell=1}^{L_c}\!\!\alpha_{c,\ell}\!\big(\gv_\Rt(\phiv_{c,\ell})\!\odot\!\av_\Rt(\phiv_{c,\ell})\big) \!   \big(\gv_\Tt(\thetav_{c,\ell})\!\odot\!\av_\Tt(\thetav_{c,\ell})\big)^\HH\!\!\!,\!
\end{align}
where $\odot$ denotes the Hadamard product, and $\gv_\Xt(\varphiv)=[G_{\Xt,1}(\varphiv),G_{\Xt,2}(\varphiv),\dots,G_{\Xt,N_{\Xt}}(\varphiv)]^\TT$ for $\Xt\in\{\Tt,\Rt\}$. We further define the following two selection matrices $\Bm$ and $\Dm$ for the transmitter and receiver, respectively:
\begin{align}
    \Bm &= \text{blkdiag}\{\bv_{\Tt,1}^\TT,\bv_{\Tt,2}^\TT,\dots,\bv_{\Tt,N_\Tt}^\TT\}\in\mathbb{R}^{N_\Tt\times NN_\Tt},\label{eq:Bdef}\\
    \Dm &= \text{blkdiag}\{\bv_{\Rt,1}^\TT,\bv_{\Rt,2}^\TT,\dots,\bv_{\Rt,N_\Rt}^\TT\}\in\mathbb{R}^{N_\Rt\times NN_\Rt}.\label{eq:Ddef}
\end{align}
Then, we have
\begin{align}  \gv_\Tt(\thetav)\odot\av_\Tt(\thetav)&=\Bm\big(\av_\Tt(\thetav)\otimes\bar{\gv}(\thetav)\big),\label{eq:gtat}\\
\gv_\Rt(\phiv)\odot\av_\Rt(\phiv)&=\Dm\big(\av_\Rt(\phiv)\otimes\bar{\gv}(\phiv)\big),\label{eq:grar}
\end{align}
where $\otimes$ denotes the Kronecker product. 
Substituting \eqref{eq:gtat} and~\eqref{eq:grar} into \eqref{eq:HFF_new1}, we obtain
\begin{equation}\label{eq:HERFF_2}
    \Hm_\mathrm{ER} = \gamma\Dm{\Hm}_\mathrm{EM}\Bm^\TT,
\end{equation}
where~${\Hm}_\mathrm{EM}\in\mathbb{C}^{NN_\Rt\times NN_\Tt}$ is called the \ac{EM}-domain channel~\cite{Ying2024Reconfigurable} given by
\begin{multline}\label{eq:tildeHER}
    {\Hm}_\mathrm{EM} = \alpha_\mathrm{LoS}\big(\av_\Rt(\phiv_\mathrm{LoS})\!\otimes\!\bar{\gv}(\phiv_\mathrm{LoS})\big)\big(\av_\Tt(\thetav_\mathrm{LoS})\!\otimes\!\bar{\gv}(\thetav_\mathrm{LoS})\big)^\HH\\
    \!+ \!\sum_{c=1}^C\!\sum_{\ell=1}^{L_c}\!\alpha_{c,\ell}\big(\av_\Rt(\phiv_{c,\ell})\!\otimes\!\bar{\gv}(\phiv_{c,\ell})\big)  \big(\av_\Tt(\thetav_{c,\ell})\!\otimes\!\bar{\gv}(\thetav_{c,\ell})\big)^\HH\!\!\!.
\end{multline}
The matrices $\Bm$ and $\Dm$ fully describe the radiation pattern configurations of all antennas at the transmitter and receiver, as depicted in Fig.~\ref{fig_MIMOsystem}.

\subsection{Near-Field Channel Model}

We now extend the proposed \ac{ER-FAS} channel model to near-field scenarios, where the wireless channel is described by the \emph{spherical wave model}~\cite{Cui2023Near,Tarboush2024Cross}. For a near-field receiver, the signal transmitted from each antenna exhibits distinct amplitude, phase, and \ac{AoD}/\ac{AoA}. Note that under the far-field model, the signals associated with different antenna elements in an array share the same amplitude and \ac{AoD}/\ac{AoA}, differing only in phase. To characterize the spherical wave model, we use $\pv_{\mathrm{T},i}$ and $\pv_{\mathrm{R},j}$ to denote the absolute positions of the $i^\text{th}$ antenna at the transmitter and the $j^\text{th}$ antenna at the receiver, respectively. Additionally, the position of the ${\ell}^\text{th}$ scatterer in the $c^\text{th}$ scattering cluster is denoted as $\rv_{c,\ell}$. Then, the near-field version of~\eqref{eq:tildeHER} is given by~\cite{Liu2023Near}
\begin{equation}\label{eq:HEMNF}
    {\Hm}_\mathrm{EM} = {\Hm}_\mathrm{EM}^\mathrm{LoS} + \sum_{c=1}^C\sum_{\ell=1}^{L_c} \tilde{\av}_\Rt(\rv_{c,\ell})  \tilde{\av}_\Tt(\rv_{c,\ell})^\HH.
\end{equation}

Under the spherical wave model, the \ac{EM}-domain \ac{LoS} channel  ${\Hm}_\mathrm{EM}^\mathrm{LoS}\in\mathbb{C}^{NN_\Rt\times NN_\Tt}$ can be partitioned as 
\begin{equation}
  {\Hm}_\mathrm{EM}^\mathrm{LoS} = \begin{bmatrix}
      {\Hm}_\mathrm{EM}^\mathrm{LoS}(1,1) & \cdots & {\Hm}_\mathrm{EM}^\mathrm{LoS}(N_\Tt,1) \\
      \vdots & \ddots & \vdots \\
      {\Hm}_\mathrm{EM}^\mathrm{LoS}(1,N_\Rt) & \cdots & {\Hm}_\mathrm{EM}^\mathrm{LoS}(N_\Tt,N_\Rt)
  \end{bmatrix},  
\end{equation}
where 
\begin{equation}
    {\Hm}_\mathrm{EM}^\mathrm{LoS}(i,j) = \alpha_{i,j}e^{-j\frac{2\pi}{\lambda}\|\pv_{\Tt,i}-\pv_{\Rt,j}\|_2}\bar{\gv}(\phiv_{i,j})\bar{\gv}(\thetav_{i,j})^\TT\in\mathbb{C}^{N\times N}.\notag
\end{equation}
Here, $\alpha_{i,j}$, $\thetav_{i,j}$, and $\phiv_{i,j}$ respectively denote the distinct channel gain, \ac{AoD}, and \ac{AoA} of the \ac{LoS} link from the $i^\text{th}$~antenna at the transmitter to the $j^\text{th}$~antenna at the receiver. In addition, the \acp{ARV} in~\eqref{eq:HEMNF} can be partitioned as
\begin{align}
    \tilde{\av}_\Tt(\rv_{c,\ell}) &= [\tilde{\av}_{\Tt,1}(\rv_{c,\ell})^\TT,\dots,\tilde{\av}_{\Tt,N_\Tt}(\rv_{c,\ell})^\TT]^\TT\in\mathbb{C}^{NN_\Tt}, \\  \tilde{\av}_\Rt(\rv_{c,\ell}) &= [\tilde{\av}_{\Rt,1}(\rv_{c,\ell})^\TT,\dots,\tilde{\av}_{\Rt,N_\Rt}(\rv_{c,\ell})^\TT]^\TT \in\mathbb{C}^{NN_\Rt},
\end{align}
where
\begin{align}
    \tilde{\av}_{\Tt,i}(\rv_{c,\ell}) &= \alpha_{i,c,\ell}e^{-j\frac{2\pi}{\lambda}\|\pv_{\Tt,i}-\rv_{c,\ell}\|_2}\bar{\gv}(\thetav_{i,c,\ell})\in\mathbb{C}^{N},\\
    \tilde{\av}_{\Rt,j}(\rv_{c,\ell}) &= \beta_{j,c,\ell}e^{-j\frac{2\pi}{\lambda}\|\pv_{\Rt,j}-\rv_{c,\ell}\|_2}\bar{\gv}(\phiv_{j,c,\ell})\in\mathbb{C}^{N}.
\end{align}
Here, $\alpha_{i,c,\ell}$ and $\thetav_{i,c,\ell}$ respectively denote the channel gain and \ac{AoD} of the link from the $i^\text{th}$ antenna at the transmitter to the $\ell^\text{th}$ scatterer in the $c^\text{th}$ scattering cluster. Similarly, $\beta_{j,c,\ell}$ and $\phiv_{j,c,\ell}$ respectively denote the channel gain and \ac{AoA} of the link from the $\ell^\text{th}$ scatterer in the $c^\text{th}$ scattering cluster to the $j^\text{th}$ antenna at the receiver.

\section{Joint Beamforming Design}\label{sec:beamforming algorithm}
Based on~\eqref{eq:Rate} and~\eqref{eq:HERFF_2}, we can formulate the following joint beamforming problem
\begin{align}\label{eq:opt}
    \max_{\fv,\wv,\Bm,\Dm}&\quad \log_2 \Big(1+\frac{\gamma P_\Tt|\wv^{\HH}\Dm{\Hm}_\mathrm{EM}\Bm^\TT\fv |^2}{\sigma^2}\Big),\\
    \text{s.t.}&\quad |f_i|^2 = \frac{1}{N_\Tt},\ |w_j|^2=\frac{1}{N_\Rt},~\eqref{eq:ConsSelection},~\eqref{eq:Bdef},~\eqref{eq:Ddef},\notag
\end{align}
where $\Hm_\mathrm{EM}$ can be either a far-field channel (as defined in~\eqref{eq:tildeHER}) or a near-field channel (as defined in~\eqref{eq:HEMNF}) in the \ac{EM} domain. Here, $\fv$ and $\wv$ represent the analog phase shifters, while $\Bm$ and $\Dm$ characterize the radiation pattern selection of these antenna elements. Supposing the electromagnetic-domain channel $\Hm_\mathrm{EM}$ is known, this subsection proposes a low-complexity solution to~\eqref{eq:opt}. 

The formulated joint beamforming problem can be solved by optimizing $\{\fv,\wv,\Bm,\Dm\}$ alternately until they converge, i.e., applying the \emph{block-coordinate descent method}~\cite{Beck2013On}. The optimization of the analog phase shifters is straightforward given the other variables. For example, when updating $\fv$ given $\{\wv,\Bm,\Dm\}$, we have $\fv^\star = \frac{1}{\sqrt{N_\Tt}}e^{j\arg(\Bm{\Hm}_\mathrm{EM}^\HH\Dm^\TT\wv)}$. The same principle can be applied to optimizing $\wv$ given $\{\fv,\Bm,\Dm\}$. The main challenge lies in optimizing the antenna state selection matrices $\Bm$ and $\Dm$. The globally optimal solutions for $\Bm$ and $\Dm$ can be determined through exhaustive search; however, this approach becomes impractical due to the exponentially increasing computational complexity as the size of the antenna arrays grows. To address this problem, we propose a greedy approach to obtain a suboptimal solution for $\Bm$ and $\Dm$ within polynomial time.

Let's focus on optimizing $\Bm$ given $\{\fv,\wv,\Dm\}$. This subproblem is equivalent to
\begin{align}\label{eq:optB}
    \max_{\Bm}\quad &\big|\wv^\HH\Dm\Hm_\mathrm{EM}\Bm^\TT\fv\big|,\\
    \text{s.t.}\quad &\eqref{eq:ConsSelection},\  \eqref{eq:Bdef}.\notag
\end{align}
According to \eqref{eq:ConsSelection} and  \eqref{eq:Bdef}, we can rewrite the objective here as $\big|\dv^\TT[\bv_{\Tt,1}^\TT,\bv_{\Tt,2}^\TT,\dots,\bv_{\Tt,N_\Tt}^\TT]^\TT\big|$, where $\dv = (\Hm_\mathrm{EM}^\TT\Dm^\TT\wv^*)\odot(\fv\otimes\mathbf{1}_N)\in\mathbb{C}^{NN_\Tt}$. We further denote $\dv_m=[\dv]_{(m-1)N+1:mN}\in\mathbb{C}^{N},\ m=1,2,\dots,N_\Tt$. Then,~\eqref{eq:optB} can be rewritten as 
\begin{align}\label{eq:optB2}
    \max_{\{\bv_{\Tt,m}\}_{m=1}^{N_\Tt}}\quad &\Big|\sum_{m=1}^{N_t}\dv_m^\TT\bv_{\Tt,m}\Big|,\\
    \text{s.t.}\quad &\eqref{eq:ConsSelection}.\notag
\end{align}
This implies that the objective is the sum of the contributions from one entry selected from each $\dv_m,\ m=1,2,\dots,N_\Tt$. Therefore, our proposed strategy is as follows: we first sum all the elements in all $\dv_m$ to compute a complex objective value $v=\sum_{m=1}^{N_t}\dv_m^\TT\mathbf{1}_N$. Next, we remove one entry with the smallest contribution to the objective value from each $\dv_m$. That is, the index of the removed entry in $\dv_m$ is determined by
\begin{equation}
u_m = \arg\max_{u}\quad \big|v-[\dv_m]_u\big|.   
\end{equation}
We then update the objective value by summing all the remaining entries and iteratively removing the least contributing element from each $\dv_m$ based on the current objective value until only one entry remains in each $\dv_m$. Finally, the positions of the only remaining entries in these $\dv_m$ are marked as the selected antenna states. That is, the corresponding positions in $\bv_{\mathrm{T},N_\mathrm{T}}$ are set to 1 while all others are set to 0. The optimized matrix $\Bm$ is then obtained according to~\eqref{eq:Bdef}. The optimization of $\Dm$, given ${\fv, \wv, \Bm}$, can be tackled using the same principle. The complete optimization process is summarized in Algorithm~\ref{algo:1}.

 \begin{algorithm}[t]
 \caption{A Greedy Algorithm for Solving~\eqref{eq:opt}}
 \label{algo:1}
 \begin{algorithmic}[1]
 \State \textbf{Input:}  ${\Hm}_\mathrm{EM}$\qquad \textbf{Output:}  $\fv^\star,\wv^\star,\Bm^\star,\Dm^\star$
\State Set $k=0$ and randomly initialize $\fv_0,\wv_0,\Bm_0,\Dm_0$.
\Statex{\hspace{-1.2em}\textbf{Repeat:}}

\Statex{\hspace{-0.9em}\textbf{Optimize $\fv$:}} $\max_\fv\ |\wv_k^\HH\Dm_k{\Hm}_\mathrm{EM}\Bm_k^\TT \fv|$,\ s.t.\ $|f_i|^2=\frac{1}{N_\Tt}$
\State $\fv_{k+1}=\frac{1}{\sqrt{N_\Tt}}e^{j\arg(\Bm_k{\Hm}_\mathrm{EM}^\HH\Dm_k^\TT\wv_k)}$. 

\Statex{\hspace{-0.9em}\textbf{Optimize $\Bm$:}} $\max_{\Bm}\ |\wv_k^\HH\Dm_k{\Hm}_\mathrm{EM}\Bm^\TT \fv_{k+1}|$,\ s.t.~\eqref{eq:ConsSelection}, \eqref{eq:Bdef}
\State \label{step:begin}Compute $\dv_m\!=\!\big[(\Hm_\mathrm{EM}^\TT\Dm_k^\TT\wv_k^*)\odot(\fv_{k+1}\!\otimes\mathbf{1}_N)\big]_{(m\!-\!1)N\!+\!1:mN}.$ 
\State Define $N_\Tt$ sets $\mathcal{S}_m=\{1,2,\dots,N\}$, $m=1,2,\dots,N_\Tt$.
\State Set $[\bv_{\Tt,m}]_{\mathcal{S}_m}=1$, otherwise zeros, for $m=1,2,\dots,N_\Tt$.
\For{$n=1,2,\dots,N-1$}
    \State Compute $v=\sum_{m=1}^{N_t}\dv_m^\TT\bv_{\Tt,m}$.
    \For{$m=1,2,\dots,N_\Tt$}
        \State $u_m = \arg\max_{u}\ \big|v\!-\![\dv_m]_u\big|$, and $\mathcal{S}_m = \mathcal{S}_m $\textbackslash$u_m$. 
        \State Reset $[\bv_{\Tt,m}]_{\mathcal{S}_m}=1$, otherwise zeros.
    \EndFor
\EndFor
\State \label{step:end}$\Bm_{k+1} = \text{blkdiag}\{\bv_{\Tt,1}^\TT,\bv_{\Tt,2}^\TT,\dots,\bv_{\Tt,N_\Tt}^\TT\}.$ 

\Statex{\hspace{-0.9em}\textbf{Optimize $\wv$:}} $\max_\wv\!\ |\wv^\HH\Dm_k{\Hm}_\mathrm{EM}\Bm_{k+1}^\TT \fv_{k+1}|$,\ s.t.\!\ $|w_i|^2=\frac{1}{N_\Rt}$
\State $\wv_{k+1}=\frac{1}{\sqrt{N_\Rt}}e^{j\arg(\Dm_k{\Hm}_\mathrm{EM}\Bm_{k+1}^\TT\fv_{k+1})}$. 

\Statex{\hspace{-0.9em}\textbf{Optimize $\Dm$:}} $\max_{\Dm}\ |\wv_{k+1}^\HH\Dm{\Hm}_\mathrm{EM}\Bm_{k+1}^\TT \fv_{k+1}|$,\ s.t.~\eqref{eq:ConsSelection}, \eqref{eq:Ddef}
\State Rewrite the objective function as $|\fv_{k+1}^\HH\Bm_{k+1}\tilde{\Hm}_{\mathrm{ER}}^\HH\Dm^\TT\wv_{k+1}|$ and reapply Step~\ref{step:begin}--\ref{step:end} to obtain $\Dm_{k+1}$.

\State $k=k+1$.

\Statex{\hspace{-1.2em}\textbf{Until}} convergence

\Statex{\hspace{-1.2em}\textbf{Return}} $\fv_k,\wv_k,\Bm_k,\Dm_k$

\end{algorithmic} 
\end{algorithm}


\section{Simulation Results}\label{sec:Full-wave simulation}

\begin{figure*}[t]
  \centering
  \includegraphics[width=0.9\linewidth]{figures/fig_RPs_m90.pdf}
  \vspace{-0.7em}
  \caption{ 
    The simulated array beampatterns for beamforming to $(\theta_\mathrm{az}=-90^\circ,\ \theta_\mathrm{el}=90^\circ)$ using the proposed beamforming algorithm. The conventional antenna stands for the case where each array element's radiation pattern is fixed. Here, we set this fixed radiation pattern as state 2 in Fig~\ref{fig_FAS_Element_Mechanism}. The same setup applies to Fig.~\ref{fig_RPs_60}.
   }
\label{fig_RPs_m90}
\vspace{-1em}
\end{figure*}

\begin{figure*}[t]
  \centering
  \includegraphics[width=0.9\linewidth]{figures/fig_RPs_60.pdf}
  \vspace{-0.7em}
  \caption{ 
    The simulated array beampatterns for beamforming to  $(\theta_\mathrm{az}=60^\circ,\ \theta_\mathrm{el}=90^\circ)$.
   }
\label{fig_RPs_60}
\vspace{-1em}
\end{figure*}

This section presents the full-wave EM array beampattern simulation and the numerical evaluation of communication spectral efficiency. Throughout, the \ac{ER-FAS} selects radiation pattern of each element from three available states, namely, state 1, state 2, and state 3 shown in Fig.~\ref{fig_FAS_Element_Mechanism}. While more EM states are available, the simulation in this section will demonstrate that even with only three EM states for reconfigurability, substantial spectral efficiency enhancement can be achieved. In addition, an array of conventional antennas with a fixed element radiation pattern is employed as the benchmark, whose element radiation pattern is defined as state~2 in Fig.~\ref{fig_FAS_Element_Mechanism}.

\subsection{Full-Wave EM Simulation Validation}\label{sec:Full-wave EM Simulation Validation}

To verify the accuracy of the communication model derived in Section~\ref{sec:channel modeling}, full-wave EM simulation of the designed ER-FAS in array configuration (as shown in Fig.~\ref{fig_FAS_Array}) is conducted using ANSYS HFSS. Considering the far-field improvement of the designed ER-FAS model, characterized by larger beam-scanning angles, two verification scenarios with large angles—specifically, the hemisphere border ($\theta_\mathrm{az}=-90^\circ$) and an arbitrary azimuthal angle ($\theta_\mathrm{az}=60^\circ$)—are selected to validate the design. It is worth noting that all angle information described for the designed ER-FAS is azimuthal, i.e., $\theta_\mathrm{el}=90^\circ$, considering the adopted 1D ER-FAS configuration. The phase shifts and radiation state of each array element are assigned using the beamforming algorithm~\ref{algo:1}. 

The simulated radiation patterns of the conventional antenna and the designed \ac{ER-FAS} for $\theta_\mathrm{az}=-90^\circ$ and $\theta_\mathrm{az}=60^\circ$ beamforming are shown in Fig.~\ref{fig_RPs_m90} and Fig.~\ref{fig_RPs_60}, respectively. In the $XOY$ plane, the calculated results of the derived analytical model are also included for comparison with the full-wave simulation results. From the full-wave simulated 3D radiation patterns for $\theta_\mathrm{az}=-90^\circ$, it is evident that the overall radiated power of the developed ER-FAS design is more concentrated in the desired end-fire beam direction compared to the conventional antenna array based on both the numerical and full-wave EM simulation results. A similar observation can be made for $\theta_\mathrm{az}=60^\circ$ beamforming, where a higher gain is directed towards the desired beam direction. It is important to note that the phase states for both the conventional antenna and the designed element-reconfigurable array are maintained the same for a fair comparison.

To quantitatively demonstrate the gain enhancement of the proposed ER-FAS model, 2D $XOY$-plane radiation patterns are also presented, where the proposed model shows good agreement with the full-wave simulation. For the $-90^\circ$ beamforming direction, the proposed model demonstrates a gain enhancement of \unit[3.4]{dB}, which closely matches the \unit[4.5]{dB} enhancement observed in the full-wave simulation. Similarly, the gain enhancement at the $60^\circ$ beam direction is \unit[2.5]{dB} for the proposed analytical model, which is consistent with the full-wave simulated value of \unit[1.7]{dB}. The slight deviation between the analytical model and the full-wave simulation results is attributed to hardware impairments such as the mutual coupling effects~\cite{Zheng_pinjun2024MC}, which are outside the scope of this work but can be explored in future studies. Nevertheless, the proposed analytical model has been validated through full-wave simulation results, showing a good match.

\subsection{Numerical Spectral Efficiency Evaluation}\label{sec:Beamforming Numerical Evaluation}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.85\linewidth]{figures/fig_simSetup.pdf}
  \vspace{-1em}
  \caption{ 
     Illustration of the adopted \ac{MIMO} communication setup based on the \ac{SV} model, featuring a \ac{LoS} path and multiple \ac{NLoS} paths propagating through 3 clusters of scatterers.
    }
  \label{fig_simSetup}
  \vspace{-1em}
\end{figure}

After validating the proposed ER-FAS model through full-wave EM simulation, the assessment of the communication spectral efficiency is presented in this subsection. In this subsection, we first evaluate the communication performance of the proposed system and beamforming algorithm in far-field scenarios. The simulation setup is illustrated in Fig.~\ref{fig_simSetup}. Specifically, we consider a far-field communication system with a $4\times 4$ transmitter and a $4\times 4$ receiver, both equipped with \ac{ER-FAS}. The physical wireless channels are generated according to the \ac{SV} model, with 3 scatterer clusters generating \ac{NLoS} multipath. The signal frequency is set to \unit[$3.55$]{GHz}, and the thermal noise at the receiver is \unit[$-95$]{mW}~\cite{Zheng_pinjun2024MC}.

\begin{figure}[t]
    \centering
    \include{figures/fig_SE_vs_PT.tex}
    \vspace{-3em}
    \caption{Far-field spectral efficiency versus transmit power.}
    \label{fig_SE_vs_PT}
\end{figure}

Fig.~\ref{fig_SE_vs_PT} compares the communication spectral efficiency of the \ac{ER-FAS} and the conventional antenna system. The spectral efficiency is calculated using~\eqref{eq:Rate}. The results in Fig.~\ref{fig_SE_vs_PT} show that both the \ac{ER-FAS} and the conventional antenna system require beamforming optimization to achieve high spectral efficiency, as random phase shifts result in significantly lower performance. Furthermore, the \ac{ER-FAS} provides an approximate \unit[$1.5$]{bps/Hz} gain in spectral efficiency compared to the conventional antenna, demonstrating its strong potential for enhancing communication performance.

\begin{figure}[t]
    \centering
    \include{figures/fig_SE_vs_AoD.tex}
    \vspace{-3em}
    \caption{Far-field spectral efficiency versus azimuth \ac{AoD} $\theta_\mathrm{az}$, with the elevation \ac{AoD} fixed at $\theta_\mathrm{el}=\unit[90]{^\circ}$.}
    \label{fig_SE_vs_AoD}
\end{figure}

To comprehensively evaluate the performance of the proposed system, Fig.~\ref{fig_SE_vs_AoD} further presents the communication spectral efficiency as a function of the \ac{AoD}. In this trial, we keep the Tx-Rx \ac{LoS} distance fixed while varying the Rx locations to correspond to different azimuth \acp{AoD}, while the elevation \ac{AoD} is fixed to $\unit[90]{^\circ}$. To better illustrate the underlying trend, we consider only the \ac{LoS} path, eliminating the impact of \ac{NLoS} multipath. Note that the effect of multipath will be analyzed in a later trial. As shown in Fig.~\ref{fig_SE_vs_AoD}, the proposed \ac{ER-FAS} achieves spectral efficiency comparable to that of the conventional antenna system at small azimuth \acp{AoD}. However, at larger azimuth \acp{AoD}, it significantly outperforms the conventional antenna system, aligning well with the full-wave simulation results.

\begin{figure}[t]
    \centering
    \include{figures/fig_SE_vs_numNLoS.tex}
    \vspace{-3em}
    \caption{Far-field spectral efficiency versus the number of \ac{NLoS} multipath.}
    \label{fig_SE_vs_numNLoS}
\end{figure}

\begin{figure}[t]
    \centering
    \include{figures/fig_SE_NF.tex}
    \vspace{-3em}
    \caption{Near-field spectral efficiency versus Tx array size. The Tx is set as an $N_\mathrm{T}\times 1$ linear array along the $Y$-axis, with the Rx located in front of the transmitter at varying Tx-Rx distances $d_\mathrm{TR}$. The Tx array spacing is fixed as half-wavelength.}
    \label{fig_SE_NF}
\end{figure}

Now, we assess the impact of \ac{NLoS} multipath on system performance. We evaluate spectral efficiency at two azimuth \acp{AoD}, $\theta_\mathrm{az}=\unit[40]{^\circ}$ and $\theta_\mathrm{az}=\unit[80]{^\circ}$, while keeping the elevation \ac{AoD} fixed at $\unit[90]{^\circ}$. For each \ac{AoD}, we examine spectral efficiency under various numbers of multipath components by adjusting the number of scatterers per cluster. In both \ac{AoD} cases, we observe that an increasing number of \ac{NLoS} paths leads to a decline in spectral efficiency. Additionally, the \ac{ER-FAS} consistently outperforms the conventional antenna system. However, in the large \ac{AoD} case, the performance advantage of \ac{ER-FAS} over the conventional benchmark diminishes in the presence of rich \ac{NLoS} multipath. In contrast, for small \ac{AoD}, \ac{ER-FAS} maintains a steady performance gain over the conventional antenna system. This observation implies that the significant performance gain of \ac{ER-FAS} at large \ac{AoD} is particularly advantageous in sparse multipath environments, such as mmWave and THz communication systems, while its benefits may be less pronounced in rich-scattering conditions.

Furthermore, we evaluate the system performance in near-field scenarios. In this simulation, the transmitter is configured as an $N_\mathrm{T}\times 1$ linear array along the $Y$-axis. The \ac{AoD} is fixed at $\theta_\mathrm{az}=\unit[0]{^\circ}$ and $\theta_\mathrm{el}=\unit[90]{^\circ}$, i.e., the Rx is located in front of the Tx. Various Tx-Rx distances $d_\mathrm{TR}$ are tested, with the Tx array spacing fixed at half-wavelength. As shown in Fig.~\ref{fig_SE_NF}, we observe a performance gain of \ac{ER-FAS} compared to the conventional benchmark as the Tx array size increases and the Tx-Rx distance decreases. This indicates that the proposed \ac{ER-FAS} is particularly beneficial in near-field scenarios, especially when large antenna arrays are used. The performance improvement stems from the significant degree of freedom enabled by the radiation pattern reconfigurability, which allows for more effective focusing of radiated power in the desired focal regions.


\section{Hardware Fabrication}\label{sec:Hardware}

In this section, hardware prototypes are fabricated for both the ER-FAS array element and the entire array. The element prototype validates the software-controlled fluidic manipulation capability and radiation pattern reconfigurability using liquid metal, while the array prototype verifies the beamforming radiation pattern and gain enhancement in comparison to full-wave simulations

\subsection{ER-FAS Array Element}

Firstly, a software-controllable ER-FAS array element utilizing liquid metal is fabricated to validate both the radiation pattern reconfigurability and the dynamic fluidic manipulation capability, which is shown in Fig.~\ref{fig_Array_Element_Prototype}. In the array element fabrication, the Galinstan liquid metal alloy, consisting of 68.5\% gallium (Ga), 21.5\% indium (In), and 10\% tin (Sn), is adopted to demonstrate the antenna reconfigurability enabled by the liquid metal. It exhibits a low viscosity of 2.4 mPa$\cdot$s (20$^\circ$C), which is close to water’s viscosity of around 1 mPa$\cdot$s, demonstrating its decent fluidity. Meanwhile, it has a low melting point of -19°C with a conductivity of 3.46 × $10^\text{6}$ S/m, ensuring its fluid characteristic at regular room temperature with satisfactory electrical conductivity properties.

\begin{figure}[t]
  \centering 
  \includegraphics[width=\columnwidth]{figures/fig_Array_Element_Prototype.pdf}
  \vspace{-1.8em}
  \caption{
    The software-controllable ER-FAS array element prototype.
  }
  \label{fig_Array_Element_Prototype}
\end{figure} 

\begin{figure*}[t]
  \centering
  \includegraphics[width=0.9\linewidth]{figures/fig_fabricated_FAS_Array.pdf}
  \vspace{-0.7em}
  \caption{ 
     Fabricated ER-FAS array prototype and the measurement setup in an anechoic chamber.
    }
  \label{fig_fabricated_FAS_Array}
  \vspace{-1em}
\end{figure*}

\begin{figure}[t]
  \centering
  \includegraphics[width=0.6\columnwidth]{figures/fig_Sim_vs_Mea_Array_Element.png}
  \caption{
    Comparison between simulation and measurement of the designed ER-FAS array element.
  }
  \label{fig_Sim_vs_Mea_Array_Element}
  \vspace{-1em}
\end{figure} 

Then, the independent channels as containers of the liquid metal are fabricated. Specifically, the top layer is a 125 $\mu$m PMMA sheet with inlet and outlet cuts, the middle layer is a 0.4 mm PET substrate with metallic patterns, and the bottom layer is a full 125 $\mu$m PMMA sheet. All these different layers are cut through a laser cutting machine VLS 3.50. Then, these three layers are sandwiched together through adhesives.

Finally, the excitation source of the planar monopole antenna is fabricated with two single-clad 1.6 mm-thick FR4 substrates etched through an LPKF laser electronics equipment. Two FR4 substrates are assembled using fine screws with a diameter of 0.8 mm to avoid potential influence on antenna array performance. The antenna port is soldered with an SMA connector that is used to receive the RF signal for the entire array element. After all the prototypes have been prepared, the overall array element designs are assembled and fixed through customized 3D printed supports. During this process, PLA filament is adopted using a Raise3D Pro2 printer. Finally, a software-controllable pumping machine of the Harvard Apparatus type is deployed to control the injection or extraction of the Galinstan alloy.  According to the fabricated channels, a pumping speed of 50 $\mu$l/min is determined and set in the machine software for liquid injection through a specified syringe.


\subsection{ER-FAS Array}

To further validate the designed ER-FAS concept and model, an ER-FAS array configuration has been fabricated. The fabrication details are provided as follows. First, the planar monopole antenna is similar to the array element manufacturing, but with a larger number of elements of 6 for the PCB sheet size. The designed ER-FAS model consists of two \( 1 \times 6 \) sub-arrays, and the final array design follows a \( 1 \times 12 \) array configuration.

Next, the feeding network is fabricated. The power divider is fabricated with equal magnitudes for the 12 output ports. To reduce the antenna fabrication cost, the phase shifters are fabricated with 2-bit phase quantization. The power divider is connected to the phase shifters through adapters, and the overall feeding network transmits the RF signal using 12 RF cables with equal length (40 cm).

Furthermore, the parasitic reflectors and directors are fabricated. Due to limited pump control (two ports per machine), the array uses silver electronic paste DM-SIP-3072S from Dycotec Materials. For proper metallization of the silver paste, a mask is prepared using Kapton film, and the metallic pattern is cut using a laser cutting machine. The silver paste is then screen-printed on a 125-$\mu$m-thick polyethylene terephthalate (PET) substrate. The overall fluid-metalized sample is cured in an oven at 70$^\circ$C for 2 hours.

Finally, the directors, planar monopole antennas, and reflectors are assembled using 3D-printed supports, similar to those used for the array elements. The final fabricated ER-FAS prototype is shown in Fig.~\ref{fig_fabricated_FAS_Array}. It should be noted that the output port from the feeding network, without a phase shifter, acts as the $0^\circ$ phase reference.

\section{Experimental Results}\label{sec:Experiments}

\subsection{ER-FAS Element Measurement}

The radiation patterns of the array element prototype at various states are first measured in a Satimo anechoic chamber. The measured results, compared with the simulated results, are shown in Fig.~\ref{fig_Sim_vs_Mea_Array_Element}. From the normalized radiation patterns, it can be observed that the measured results generally follow the simulation trends, and three distinct patterns at different states can be obtained. The slight discrepancies are mainly attributed to fabrication errors of the channel structures, which can be further improved by using smoother and more precise channels. 

\subsection{ER-FAS Array Measurement}

\begin{figure}[t]
    \centering
    \include{figures/fig_S_parameter_Simulation_and_Measurement.tex}
    \vspace{-3em}
    \caption{Simulated and measured S parameter of the designed ER-FAS.}
    \label{fig_S_parameter_Simulation_and_Measurement}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{minipage}{0.2\textwidth}
        \centering
        \include{figures/fig_Sim_vs_Mea_a.tex}
    \end{minipage}
    \hspace{3em} 
    \begin{minipage}{0.2\textwidth}
        \centering
        \include{figures/fig_Sim_vs_Mea_b.tex}
    \end{minipage}
    \vspace{-2.5em}
    \caption{Measured radiation pattern compared with full-wave simulation for array beamforming at $\theta_\mathrm{az}=-90^\circ$ and $\theta_\mathrm{az}=60^\circ$.}
    \label{fig_patterns_sim_mea}
\end{figure}

The return loss performance is a crucial factor for FAS, which evaluates impedance matching. Therefore, the designed ER-FAS, including the planar monopole array, parasitic reflector, and director arrays, was measured using a PNA Network Analyzer (E8363C). The detailed measured S-parameter performance of the designed ER-FAS prototype, compared with the simulated results, is shown in Fig.~\ref{fig_S_parameter_Simulation_and_Measurement}. The measured results align well with the simulations. Specifically, the measured $S_{11}$ parameter is less than -10 dB from 1.8 GHz to 7.3 GHz, corresponding to a fractional bandwidth of 120.9\%. Therefore, the designed FAS exhibits wideband impedance matching performance, making it suitable for 5G sub-6 GHz applications.

To experimentally verify the simulation results for the far-field gain enhancement of the designed ER-FAS, as shown in Fig.~\ref{fig_RPs_m90} and Fig.~\ref{fig_RPs_60}, the entire ER-FAS prototype was measured in the Satimo anechoic chamber, as demonstrated in Fig.~\ref{fig_fabricated_FAS_Array}. The deployed Satimo anechoic chamber measures the near field of the antenna and then converts it to the far-field radiation pattern using a post-processing algorithm. The measured far-field normalized radiation pattern, compared with the simulation, for the $-90^\circ$ beamforming is shown in Fig.~\ref{fig_patterns_sim_mea}-(a). The measurement results closely match the simulated radiation patterns for both the conventional and electromagnetically reconfigurable antenna arrays. At the large desired beamforming angle of $-90^\circ$ (end-fire radiation), the measured result shows a gain enhancement of 4.2 dB for the designed ER-FAS compared to the conventional antenna array, which is consistent with the simulated enhancement of 4.5 dB. For the beamforming towards $60^\circ$, the simulated and measured far-field radiation patterns are shown in Fig.~\ref{fig_patterns_sim_mea}-(b). The experimental results indicate a gain enhancement of approximately 1.1 dB at the desired array beam of $60^\circ$, which matches the simulated enhancement of 0.9 dB. It should be noted that the measurement was conducted with 2-bit quantization for the phase shifters. 

\begin{figure}[t]
\centering
\includegraphics[width=0.95\linewidth]{figures/ExperimentSetup3_Annot.pdf}
\vspace{-0.5em}
\caption{Experimental setup for SDR-based validation.}
\label{fig:SDRExpeSetup}
\end{figure}

% -90 degree
\begin{figure*}[t]
        \centering
    % (a) Bar chart
    \begin{minipage}{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
            	width=4in,
				height=1.7in,
                ybar,
                ymin=-50, ymax=0, % Y-axis range
                ytick={-50,-40,-30,-20,-10,0},
                symbolic x coords={0.3m, 0.6m, 0.9m, 1.2m}, % X-axis labels
                xtick=data,
                xticklabels={$d_\mathrm{TR}=\unit[0.3]{m}$, $d_\mathrm{TR}=\unit[0.6]{m}$, $d_\mathrm{TR}=\unit[0.9]{m}$, $d_\mathrm{TR}=\unit[1.2]{m}$}, 
                xlabel style={font=\color{white!15!black},font=\footnotesize,align=center},
                xticklabel style = {font=\color{white!15!black},font=\footnotesize},
                ylabel style={font=\color{white!15!black},font=\footnotesize,align=center},
                yticklabel style = {font=\color{white!15!black},font=\footnotesize},
                ylabel={Received power (dBm)},
                nodes near coords, % Display values on bars
                every node near coord/.append style={font=\tiny}, % Change label font size
                enlarge x limits=0.2, % Add spacing between bars
                bar width=17pt, % Bar width
                ymajorgrids=true, % Add Y-axis grid lines
                grid style=dashed, % Set grid lines to dashed
                legend style={at={(0.97,0.93)}, anchor=north east, font=\footnotesize}
            ]
                % Blue bars (Conventional Antenna)
                \addplot [fill=blue!60] coordinates {(0.3m,-30.054) (0.6m,-35.372) (0.9m,-34.889) (1.2m,-42.474)};
                % Orange bars (Element-Reconfigurable Array)
                \addplot [fill=red!60] coordinates {(0.3m,-25.575) (0.6m,-29.141) (0.9m,-32.014) (1.2m,-35.092)};
                % Add legend
                \legend{Conventional antenna, ER-FAS}
            \end{axis}
        \end{tikzpicture}
        \\ \footnotesize\ \qquad\qquad (a) % Display "(a)" below the figure
    \end{minipage}
    \hfill
    % (b) Line plot
    \begin{minipage}{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[%
			width=2.8in,
			height=1.6in,
			at={(0in,0in)},
			scaled y ticks = false,  
			xmin=0.2000,
			xmax=0.5120,
			xminorticks=true,
			xlabel style={font=\color{white!15!black},font=\footnotesize},
			xticklabel style = {font=\color{white!15!black},font=\footnotesize},
			xlabel={Transmit power (mW)},
			ymin=0,
			ymax=0.06,
			ytick={0.01,0.02,0.03,0.04,0.05,0.06},
			yticklabels={0.01,0.02,0.03,0.04,0.05,0.06},
			ylabel style={font=\color{white!15!black},font=\footnotesize},
			yticklabel style = {font=\color{white!15!black},font=\footnotesize},
			ylabel={Bit error rate},
			axis background/.style={fill=white},
			xmajorgrids,
			xminorgrids,
			ymajorgrids,
			legend style={at={(1,1)}, anchor=north east, font=\footnotesize, legend cell align=left, align=left, draw=white!15!black}
]
\addplot [color=blue, line width=1.2pt, mark=diamond, mark options={solid, blue},mark size=2.5pt]
  table[row sep=crcr]{%
0.200000000000000	0.0575305486332192\\
0.220500000000000	0.0427881838706290\\
0.242000000000000	0.0283539656426352\\
0.264500000000000	0.0212745522393794\\
0.288000000000000	0.0120680033083711\\
0.312500000000000	0.00872517984253381\\
0.338000000000000	0.00465602497560607\\
0.364500000000000	0.00316607810540300\\
0.392000000000000	0.00278601100448377\\
0.420500000000000	0.00200293111871031\\
0.450000000000000	0.00161807086935723\\
0.480500000000000	0.00121133629691857\\
0.512000000000000	0.00106829080471840\\
};
%0.2000    0.2205    0.2420    0.2645    0.2880    0.3125    0.3380    0.3645    0.3920    0.4205    0.4500    0.4805    0.5120
\addlegendentry{Conventional antenna}
\addplot [color=red, line width=1.2pt, mark=o, mark options={solid, red}]
  table[row sep=crcr]{%
0.200000000000000	0.0296785900958885\\
0.220500000000000	0.0189892347746110\\
0.242000000000000	0.0124545586374842\\
0.264500000000000	0.00663393888480521\\
0.288000000000000	0.00463299380447338\\
0.312500000000000	0.00263230239738917\\
0.338000000000000	0.00185990002698616\\
0.364500000000000	0.00150536933570388\\
0.392000000000000	0.00106525721352982\\
0.420500000000000	0.00107360212574591\\
0.450000000000000	0.000787679856013568\\
0.480500000000000	0.000931233000958928\\
0.512000000000000	0.000471695266511447\\
};

\addlegendentry{ER-FAS}
\end{axis}
        \end{tikzpicture}
        \\ \footnotesize (b) % Display "(b)" below the figure
    \end{minipage}
    \vspace{-0.5em}
    \caption{The illustration of (a) received power and (b) communication BER measured at $\theta_\mathrm{az}=-90^\circ$.}
    \label{fig:com90} 
\end{figure*}


% 60 degree
\begin{figure*}[t]
        \centering
    % (a) Bar chart
    \begin{minipage}{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
            	width=4in,
				height=1.7in,
                ybar,
                ymin=-47, ymax=0, % Y-axis range
                ytick={-50,-40,-30,-20,-10,0},
                symbolic x coords={0.3m, 0.6m, 0.9m, 1.2m}, % X-axis labels
                xtick=data,
                xticklabels={$d_\mathrm{TR}=\unit[0.3]{m}$, $d_\mathrm{TR}=\unit[0.6]{m}$, $d_\mathrm{TR}=\unit[0.9]{m}$, $d_\mathrm{TR}=\unit[1.2]{m}$}, 
                xlabel style={font=\color{white!15!black},font=\footnotesize,align=center},
                xticklabel style = {font=\color{white!15!black},font=\footnotesize},
                ylabel style={font=\color{white!15!black},font=\footnotesize,align=center},
                yticklabel style = {font=\color{white!15!black},font=\footnotesize},
                ylabel={Received power (dBm)},
                nodes near coords, % Display values on bars
                every node near coord/.append style={font=\tiny}, % Change label font size
                enlarge x limits=0.2, % Add spacing between bars
                bar width=17pt, % Bar width
                ymajorgrids=true, % Add Y-axis grid lines
                grid style=dashed, % Set grid lines to dashed
                legend style={at={(0.97,0.93)}, anchor=north east, font=\footnotesize}
            ]
                % Blue bars (Conventional Antenna)
                \addplot [fill=blue!60] coordinates {(0.3m,-30.546) (0.6m,-33.680) (0.9m,-34.335) (1.2m,-39.754)};
                % Orange bars (Element-Reconfigurable Array)
                \addplot [fill=red!60] coordinates {(0.3m,-29.747) (0.6m,-32.402) (0.9m,-33.898) (1.2m,-38.308)};
                % Add legend
                \legend{Conventional antenna, ER-FAS}
            \end{axis}
        \end{tikzpicture}
        \\ \footnotesize\ \qquad\qquad (a) % Display "(a)" below the figure
    \end{minipage}
    \hfill
    % (b) Line plot
    \begin{minipage}{0.45\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[%
			width=2.8in,
			height=1.6in,
			at={(0in,0in)},
			scaled y ticks = false,  
			xmin=0.2000,
			xmax=0.5120,
			xminorticks=true,
			xlabel style={font=\color{white!15!black},font=\footnotesize},
			xticklabel style = {font=\color{white!15!black},font=\footnotesize},
			xlabel={Transmit power (mW)},
			ymin=0,
			ymax=0.06,
			ytick={0.01,0.02,0.03,0.04,0.05,0.06},
			yticklabels={0.01,0.02,0.03,0.04,0.05,0.06},
			ylabel style={font=\color{white!15!black},font=\footnotesize},
			yticklabel style = {font=\color{white!15!black},font=\footnotesize},
			ylabel={Bit error rate},
			axis background/.style={fill=white},
			xmajorgrids,
			xminorgrids,
			ymajorgrids,
			legend style={at={(1,1)}, anchor=north east, font=\footnotesize, legend cell align=left, align=left, draw=white!15!black}
]
\addplot [color=blue, line width=1.2pt, mark=diamond, mark options={solid, blue},mark size=2.5pt]
  table[row sep=crcr]{%
0.200000000000000	0.0501776861559548\\
0.220500000000000	0.0501782234823293\\
0.242000000000000	0.0337140702414251\\
0.264500000000000	0.0228254813423847\\
0.288000000000000	0.0188601347570240\\
0.312500000000000	0.0118601600123352\\
0.338000000000000	0.0115617213826812\\
0.364500000000000	0.00658823469874457\\
0.392000000000000	0.00452069460386892\\
0.420500000000000	0.00137094986407178\\
0.450000000000000	0.00138234221818967\\
0.480500000000000	0.00107911419661682\\
0.512000000000000	0.00113829675522419\\
};

\addlegendentry{Conventional antenna}
\addplot [color=red, line width=1.2pt, mark=o, mark options={solid, red}]
  table[row sep=crcr]{%
0.200000000000000	0.0388462175911459\\
0.220500000000000	0.0258250179113326\\
0.242000000000000	0.0181582471547119\\
0.264500000000000	0.0105370246793558\\
0.288000000000000	0.00605726486751374\\
0.312500000000000	0.00304847088473108\\
0.338000000000000	0.00315232229522118\\
0.364500000000000	0.00151879968620862\\
0.392000000000000	0.00134704473136031\\
0.420500000000000	0.00104436149800006\\
0.450000000000000	0.000880165723177379\\
0.480500000000000	0.000730953435389834\\
0.512000000000000	0.000715240570729411\\
};

\addlegendentry{ER-FAS}
\end{axis}
        \end{tikzpicture}
        \\ \footnotesize (b) % Display "(b)" below the figure
    \end{minipage}
    \vspace{-0.5em}
    \caption{The illustration of (a) received power and (b) communication BER measured at $\theta_\mathrm{az}=60^\circ$.}
    \label{fig:com60} 
\end{figure*}

\subsection{SDR-based Communication Experiment}
Last but not least, a series of indoor experiments are conducted using the Analog Devices ADALM-Pluto SDR, a versatile SDR platform designed for prototyping various digital communication systems in real time. It operates over a very wide frequency range, i.e., 325 MHz to 3.8 GHz, and could support an instantaneous bandwidth of up to 20 MHz. 

In the communication trails, two ADALM-Pluto SDRs are utilized to investigate the performance of a point-to-point communication link whereby the transmit SDR sends data using the ER-FAS antenna to the receive SDR.
Fig.~\ref{fig:SDRExpeSetup} shows the indoor experimental setup whereby the fabricated ER-FAS serves as the Tx, while a standard horn antenna (SH2000) is utilized as the Rx. For benchmarking the performance of the proposed ER-FAS system, the following precautions are taken to minimize the random small-scale fading due to multipath: (i) both Tx and Rx are placed in direct line-of-sight of each other, and away from all kinds of surrounding objects, (ii) a relatively small transmit power budget is allocated to the transmit node, (iii) each of the Tx and Rx is placed on a table covered by absorbers to avoid reflection from the ground. Under this experimental setup, two distinct experiments are conducted to do a performance comparison of the conventional antenna and ER-FAS by measuring the following at the receiver: (i) received power, and (ii) BER. 

The first experiment aimed to measure the received power at the receive SDR under two scenarios: i) when the transmit SDR utilized a conventional antenna, and ii) when it utilized the ER-FAS. In line with the simulation and measurement setup in previous sections, experiments are performed with $-90^\circ$ and $60^\circ$ beamforming directions to thoroughly examine the impact of ER-FAS on signal reception. The Tx sent 4-QAM data at a fixed transmit power of 5 mW using both conventional antenna and ER-FAS, while the receiver is placed at 4 different near-field distances (0.3 m, 0.6 m, 0.9 m, and 1.2 m). This allows a steady decrease in received power at the received side to be observed for both scenarios, i.e., conventional antenna and ER-FAS employed at the transmit side. This is in turn due to a monotonic increase in pathloss as the Tx-Rx separation $d_\mathrm{TR}$ increases (Fig.~\ref{fig:com90}-(a) and Fig.~\ref{fig:com60}-(a)). This is a physically consistent result as it follows the expected path loss characteristics of wireless signal propagation. Secondly, for both $-90^\circ$ and $60^\circ$ beamforming directions, the ER-FAS significantly enhanced the received power (in the range of 1--3 dB) compared to the conventional antenna, basically due to the directional gain offered by the ER-FAS. In short, this experiment provided valuable insights into the directional characteristics and tunability of the ER-FAS under varying phase-shift conditions. 

As for the second experiment, BER measurements are conducted for both the conventional antenna and the ER-FAS under $-90^\circ$ and $60^\circ$ beamforming setups. Specifically, an image $x$ (of size $162\times 311\times 3$) was transferred using 4-QAM from the transmit side. The transmit power $P$ varies between 0.2 and 0.51 mW to systematically adjust the channel conditions and observe the corresponding changes in the BER. %For each array element, the signal obtained from Rx $y$ is given as follows: $y=\sqrt{P_\mathrm{T}} hx+n$. Here, $n\sim \mathcal{CN}(0,\sigma_n^2)$ represents the zero-mean AWGN with variance $\sigma_n^2$, while $h\sim \mathcal{CN}(\mu_h,\sigma_h^2)$ represents the complex channel gain, with a strong line-of-sight component of strength $\mu_h$, and a small multipath component with power $\sigma_h^2$. 
The results, depicted in Fig.~\ref{fig:com90}-(b) and Fig.~\ref{fig:com60}-(b), illustrate the relationship between BER and the transmit power (in mW). For both beamforming configurations (i.e., $-90^\circ$ and $60^\circ$), the ER-FAS consistently outperformed the conventional antenna by exhibiting a lower BER across nearly the full range of transmit power values. Further, the BER improvement brought by the proposed ER-FAS system is more pronounced for the medium and lower values of the transmit power which correspond to the low-to-medium SNR conditions. This improvement highlights the capability of the proposed ER-FAS system in combating poor channel conditions. 



\section{Conclusion}\label{sec:Conclusion}

In this work, a novel design of the electromagnetically reconfigurable fluid antenna system (ER-FAS) is proposed for wireless communication applications, where each ER-FAS array element can be electromagnetically reconfigured. We present the entire process, including electromagnetic design, wireless channel modeling, MIMO beamforming algorithm, full-wave simulation, hardware fabrication, and experimental validation. The results demonstrate that the designed ER-FAS effectively addresses the large-angle beam-scanning issue in the far field and achieves better beam-focusing performance in the near field, thus enhancing the spectral efficiency of the overall wireless communication system. While this work focuses on the radiation pattern reconfigurability for each array element, the frequency and polarization reconfigurability can be further investigated in the future to further enhance wireless systems.


\bibliography{references}
\bibliographystyle{IEEEtran}

\end{document}