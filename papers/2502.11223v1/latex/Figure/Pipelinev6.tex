% \documentclass[11pt]{article}
% \usepackage{tikz}
% \usetikzlibrary{positioning, shapes.multipart, fit, calc, shapes.geometric, shapes.misc}

% \begin{document}

\begin{figure*}[htbp]

\begingroup
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{backgrounds}
\definecolor{tiffanyblue}{RGB}{129,216,208}
\definecolor{bangdiblue}{RGB}{0,149,182}
\definecolor{kleinblue}{RGB}{0,47,167}
\definecolor{kabuliblue}{RGB}{26,85,153}
\definecolor{purple}{RGB}{138,43,226}

    \centering

      \tikzset{global scale/.style={
    scale=#1,
    every node/.append style={scale=#1}
  }
}


\begin{tikzpicture}[global scale=0.65]
    \newlength{\moduleintervaly}
    \setlength{\moduleintervaly}{1.8em}    
    \newlength{\moduleintervalx}
    \setlength{\moduleintervalx}{-7em}
    \newlength{\blockintervalx}
    \setlength{\blockintervalx}{30em}
    
    \tikzstyle{circlenode}=[draw, circle,minimum size=4pt,inner sep=0, fill=red!30];
    
    \tikzstyle{moduleode}=[draw,minimum height=2.5em,minimum width=23em,inner sep=.0em,thick,rounded corners=.2em, font=\small, scale=0.8];
    
    \tikzstyle{layernode}=[draw,minimum height=1.5em,minimum width=5em,inner sep=.0em,thick,rounded corners=.2em, font=\small,fill=yellow!20];
    
    \tikzstyle{attentionnode}=[draw,minimum height=1.5em,minimum width=5em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{querynode}=[draw,minimum height=1.5em,minimum width=2em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{attnmapnode}=[fill=yellow!20,draw,minimum height=2.5em,minimum width=10em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{partialattnmapnode}=[fill=tiffanyblue!40,draw,minimum height=2.5em,minimum width=12em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{partialattnmapnode1}=[fill=red!20,draw,minimum height=2.5em,minimum width=12em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{GRLattnmapnode}=[fill=yellow!20,draw,minimum height=2.5em,minimum width=8em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{StandardFFNnode}=[fill=red!20,draw,minimum height=2.5em,minimum width=23em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{Concatenode}=[draw,minimum height=1.5em,minimum width=5em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{subspace_block}=[fill=yellow!20,draw,minimum height=2.5em,minimum width=8em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{partial_subspace_block}=[fill=red!20,draw,minimum height=2.5em,minimum width=11.0em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{global_partial_subspace_block}=[fill=pink!20,draw,minimum height=2.5em,minimum width=6.5em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{space_block}=[fill=blue!20,draw,minimum height=2.5em,minimum width=23em,inner sep=.0em,thick,rounded corners=.2em, font=\small];
    
    \tikzstyle{Encoder_block}=[draw,minimum height=8.8*\moduleintervaly,minimum width=20em,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{GRL_block}=[draw,minimum height=7em,minimum width=8.8*\moduleintervaly,inner sep=.0em,thick,rounded corners=.2em, font=\small];

    \tikzstyle{Partial_Encoder_block}=[draw,minimum height=7.7*\moduleintervaly,minimum width=25em,inner sep=.0em,thick,rounded corners=.2em, font=\small];
    
    \tikzstyle{Graph_structure_learning}=[draw,minimum height=1.6em,minimum width=2.5em,inner sep=.0em,thick,rounded corners=.2em, font=\small,fill=orange!20];

    
    \tikzstyle{recnode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!20];

    \tikzstyle{recnodewhite}=[rectangle,rounded corners=5pt,minimum height=2.2em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small];

    
    % added node
    % \tikzstyle{datanode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!20];
    \tikzstyle{datanode}=[cylinder,rounded corners=5pt,draw,minimum height=1.2em,minimum width=1.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!20];
    \tikzstyle{modelnode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=green!20];
    \tikzstyle{tasknode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=blue!20];
    \tikzstyle{mergenode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=15.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=yellow!20];
    \tikzstyle{mergemodelnode}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=15.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=green!20];
    
    \tikzstyle{databanknode}=[rectangle,rounded corners=5pt,draw,minimum height=3.0em,minimum width=15.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!10];
    \tikzstyle{basemodel}=[rectangle,rounded corners=5pt,draw,minimum height=1.8em,minimum width=17.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=green!18];
    \tikzstyle{loranode}=[rectangle,rounded corners=5pt,draw,minimum height=1.7em,minimum width=3.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=lime!20];
    \tikzstyle{longloranode}=[rectangle,rounded corners=5pt,draw,minimum height=1.7em,minimum width=13.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=lime!20];

    \tikzstyle{groupnode}=[cylinder,rounded corners=5pt,draw,minimum height=1.0em,minimum width=3.1em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!20];

     \tikzstyle{longdatabanknode}=[cylinder,rounded corners=5pt,draw,minimum height=10.0em,minimum width=1.5em,inner sep=0em,thick,rounded corners=0.2em,font=\small,fill=orange!13];
    \def\nodehsep{3em}
    \def\nodewsep{3.5em}

    % First pic 1
    \begin{scope}[xshift=0in,yshift=0.0in]
        \begin{pgfonlayer}{background}
            \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](background) at (0,0) {};
            % \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databank1) at ([yshift=-3.9em]data2_01.north) {};
        \end{pgfonlayer}
        
        % \node[datanode,anchor=south](data1_01) at (0, 2) {En-De};
        
        \node[datanode,anchor=south](data1_01) at ([xshift=-2.2*\nodehsep, yshift=14.7em]background.south) {En-De};
        \node[datanode,anchor=south](data1_02) at ([yshift=-1.8\nodehsep]data1_01.south) {De-En};
        
        \node[datanode,anchor=west](data2_01) at ([xshift=\nodehsep]data1_01.east) {En-Zh};
        \node[datanode,anchor=west](data2_02) at ([xshift=\nodehsep]data1_02.east) {Zh-En};        
        
        \node[align=center,thick, scale=2] (omit1_01) at ([xshift=\nodehsep]data2_01.center) {...};
        \node[align=center,thick, scale=2] (omit1_02) at ([xshift=\nodehsep]data2_02.center) {...};
        
        \node[datanode,anchor=west](data3_01) at ([xshift=\nodehsep]data2_01.east) {En-Fr};
        \node[datanode,anchor=west](data3_02) at ([xshift=\nodehsep]data2_02.east) {Fr-En};


        \node[datanode,anchor=south](data1_11) at ([yshift=-2.5\nodehsep]data1_02.south) {En-De};
        \node[datanode,anchor=west](data2_11) at ([xshift=\nodehsep]data1_11.east) {Zh-En};
        \node[align=center,thick, scale=2] (omit2_1) at ([xshift=\nodehsep]data2_11.center) {...};
        \node[datanode,anchor=west](data3_11) at ([xshift=\nodehsep]data2_11.east) {En-Fr};
        

        \node[basemodel,anchor=north](basemodel) at ([xshift=0.1\nodehsep,yshift=-3.1\nodehsep]data2_11.north) {Base Model};
        \draw[->,thick] (data1_11.south) -- ([xshift=-6.7\nodehsep]basemodel.north);
        \draw[->,thick] (data2_11.south) -- ([xshift=-0.1\nodehsep]basemodel.north);
        \draw[->,thick] (data3_11.south) -- ([xshift=6.5\nodehsep]basemodel.north);
        
        \node[loranode,anchor=north](lora1) at ([yshift=-4.6\nodehsep]data1_11.south) {$\mathrm{LoRA}_1$};
        \node[loranode,anchor=north](lora2) at ([yshift=-4.6\nodehsep]data2_11.south) {$\mathrm{LoRA}_2$};
        \node[align=center,thick, scale=2] (omit2) at ([xshift=\nodehsep]lora2.center) {...};
        \node[loranode,anchor=north](lora3) at ([yshift=-4.6\nodehsep]data3_11.south) {$\mathrm{LoRA}_n$}; 
        
        \node(plus1) at ([yshift=0.6\nodehsep]lora1.north) {\textbf{\(+\)}};
        \node(plus2) at ([yshift=0.6\nodehsep]lora2.north) {\textbf{\(+\)}};
        \node(plus3) at ([yshift=0.6\nodehsep]lora3.north) {\textbf{\(+\)}};
         % \draw[+,thick] (basemodel.south) -- (model2.north);
        % \draw[->,thick] (data2.south) -- (model2.north);
        % \draw[->,thick] (data3.south) -- (model3.north);
        

        \node[tasknode,anchor=north](task1) at ([yshift=-1.5\nodehsep]lora1.south) {$\mathrm{Task}_1$};
        \node[tasknode,anchor=north](task2) at ([yshift=-1.5\nodehsep]lora2.south) {$\mathrm{Task}_2$};
        \node[align=center,thick, scale=2] (omit3) at ([xshift=\nodehsep]task2.center) {...};
        \node[tasknode,anchor=north](task3) at ([yshift=-1.5\nodehsep]lora3.south) {$\mathrm{Task}_n$}; 


        \draw[->,thick] (lora1.south) -- (task1.north);
        \draw[->,thick] (lora2.south) -- (task2.north);
        \draw[->,thick] (lora3.south) -- (task3.north);

        \begin{pgfonlayer}{background}
            % \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](background) at ([yshift=-16.1em]data2_01.north) {};
            \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databank1) at ([yshift=-3.9em]data2_01.north) {};
        \end{pgfonlayer}
        
        \node[anchor=south,font=\Large](l1) at ([xshift=.5em,yshift=-3em]background.south) {(a) Separate Training};
    \end{scope}

    % second pic
    \begin{scope}[xshift=3.5in,yshift=0.0in]
        \begin{pgfonlayer}{background}
            \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundb) at (0,0) {};
            % \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databank2) at ([yshift=-3.9em]data2_01b.north) {};
        \end{pgfonlayer}
        
        \node[datanode,anchor=south](data1_01b) at ([xshift=-2.2*\nodehsep, yshift=14.7em]backgroundb.south) {En-De};
        \node[datanode,anchor=south](data1_02b) at ([yshift=-1.8\nodehsep]data1_01b.south) {De-En};
        \node[datanode,anchor=west](data2_01b) at ([xshift=\nodehsep]data1_01b.east) {En-Zh};
        \node[datanode,anchor=west](data2_02b) at ([xshift=\nodehsep]data1_02b.east) {Zh-En};        
        \node[align=center,thick, scale=2] (omit1_01b) at ([xshift=\nodehsep]data2_01b.center) {...};
        \node[align=center,thick, scale=2] (omit1_02b) at ([xshift=\nodehsep]data2_02b.center) {...};
        \node[datanode,anchor=west](data3_01b) at ([xshift=\nodehsep]data2_01b.east) {En-Fr};
        \node[datanode,anchor=west](data3_02b) at ([xshift=\nodehsep]data2_02b.east) {Fr-En};
        
        \node[mergenode,anchor=north](datamixture) at ([xshift=0.1\nodehsep,yshift=-1.1\nodehsep]data2_02b.south) {Data Mixture};
       
        
        \node[basemodel,anchor=north](basemodel2) at ([yshift=-3.1\nodehsep]datamixture.north) {Base Model};
        \draw[->,thick] (datamixture.south) -- (basemodel2.north);

        
       \node[longloranode,anchor=north](lora2b) at ([yshift=-7.1\nodehsep]data2_02b.south) {$\mathrm{LoRA}$};
        \node(plus2b) at ([yshift=0.5\nodehsep]lora2b.north) {\textbf{\(+\)}};
        

        \node[tasknode,anchor=north](task1b) at ([yshift=-10.5\nodehsep]data1_02b.south) {$\mathrm{Task}_1$};
        \node[tasknode,anchor=north](task2b) at ([yshift=-10.5\nodehsep]data2_02b.south) {$\mathrm{Task}_2$};
        \node[align=center,thick, scale=2] (omit3) at ([xshift=\nodehsep]task2b.center) {...};
        \node[tasknode,anchor=north](task3b) at ([yshift=-10.5\nodehsep]data3_02b.south) {$\mathrm{Task}_n$}; 


        \draw[->,thick] ([xshift=-6.0\nodehsep]lora2b.south) -- (task1b.north);
        \draw[->,thick] (lora2b.south) -- (task2b.north);
        \draw[->,thick] ([xshift=6.0\nodehsep]lora2b.south) -- (task3b.north);

        \begin{pgfonlayer}{background}
            % \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundb) at ([yshift=-16.1em]data2_01b.north) {};
            \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databank2) at ([yshift=-3.9em]data2_01b.north) {};
        \end{pgfonlayer}
         \draw[thick, -{Latex[round]}] (databank2.south) -- ([xshift=-0.12em]datamixture.north);
         
        \node[anchor=south,font=\Large](l2) at ([xshift=.5em,yshift=-3em]backgroundb.south) {(b) Multilingual};
    \end{scope}

    % picture c
    \begin{scope}[xshift=7.0in,yshift=0.0in]
        \begin{pgfonlayer}{background}
            \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundc) at (0, 0) {};
            % \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankc) at ([yshift=-3.8em]group2.north) {};
        \end{pgfonlayer}

        
        \node[groupnode,anchor=south](group1) at ([xshift=-1.8*\nodehsep, yshift=12.9em]backgroundc.south) {$\mathrm{Group}_1$};
        \node[groupnode,anchor=west](group2) at ([xshift=1.0\nodehsep]group1.east) {$\mathrm{Group}_2$};
        \node[align=center,thick, scale=2] (omitc) at ([xshift=1.06*\nodehsep]group2.center) {...};
        \node[groupnode,anchor=west](group3) at ([xshift=1.6\nodehsep]group2.east) {$\mathrm{Group}_n$};


        \node[mergenode,anchor=north](dataselectionc) at ([xshift=0.1\nodehsep,yshift=-1.1\nodehsep]group2.south) {Data Selection};
        
        \node[basemodel,anchor=north](basemodelc) at ([yshift=-3.1\nodehsep]dataselectionc.north) {Base Model};
        \draw[->,thick] (dataselectionc.south) -- (basemodelc.north);
        
        \node[loranode,anchor=north](lora1c) at ([yshift=-7.2\nodehsep]group1.south) {$\mathrm{LoRA}_{G1}$};
        \node[loranode,anchor=north](lora2c) at ([yshift=-7.2\nodehsep]group2.south) {$\mathrm{LoRA}_{G2}$};
        \node[align=center,thick, scale=2] (omit2) at ([xshift=\nodehsep]lora2c.center) {...};
        \node[loranode,anchor=north](lora3c) at ([yshift=-7.2\nodehsep]group3.south) {$\mathrm{LoRA}_{Gn}$}; 
        
        \node(plus1c) at ([yshift=0.6\nodehsep]lora1c.north) {\textbf{\(+\)}};
        \node(plus2c) at ([yshift=0.6\nodehsep]lora2c.north) {\textbf{\(+\)}};
        \node(plus3c) at ([yshift=0.6\nodehsep]lora3c.north) {\textbf{\(+\)}};
         % \draw[+,thick] (basemodel.south) -- (model2.north);
        % \draw[->,thick] (data2.south) -- (model2.north);
        % \draw[->,thick] (data3.south) -- (model3.north);
        

        \node[tasknode,anchor=north](task1c) at ([yshift=-1.5\nodehsep]lora1c.south) {$\mathrm{Task}_{G1}$};
        \node[tasknode,anchor=north](task2c) at ([yshift=-1.5\nodehsep]lora2c.south) {$\mathrm{Task}_{G2}$};
        \node[align=center,thick, scale=2] (omit3c) at ([xshift=\nodehsep]task2c.center) {...};
        \node[tasknode,anchor=north](task3c) at ([yshift=-1.5\nodehsep]lora3c.south) {$\mathrm{Task}_{Gn}$}; 


        \draw[->,thick] (lora1c.south) -- (task1c.north);
        \draw[->,thick] (lora2c.south) -- (task2c.north);
        \draw[->,thick] (lora3c.south) -- (task3c.north);

        \begin{pgfonlayer}{background}
            % \node[anchor=south,minimum height=\nodehsep*5.6,minimum width=19.5em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundc) at ([yshift=-16.1em]group2.north) {};
            \node[anchor=south,minimum height=1.4*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankc) at ([yshift=-3.8em]group2.north) {};
        \end{pgfonlayer}
        
         \draw[thick, -{Latex[round]}] (databankc.south) -- ([xshift=-0.12em]dataselectionc.north);
        \node[anchor=south,font=\Large](l3) at ([xshift=.5em,yshift=-3em]backgroundc.south) {(c) Group Training};
    \end{scope}

    % picture d
    %  \begin{scope}[xshift=1.5in,yshift=-3.6in]
    %     \begin{pgfonlayer}{background}
    %         \node[anchor=south,minimum height=\nodehsep*6.5,minimum width=39.6em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundd) at (0,0) {};
    %         % \node[anchor=south,minimum height=0.9*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankd1) at ([xshift=0.5em, yshift=-2.1em]group2d.north) {};
    %         % \node[anchor=north,minimum height=0.9*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankd2) at ([yshift=-0.9em]dataxxen.south) {};
    %         % \node[anchor=south,minimum height=1.9*\nodehsep,minimum width=18.2em,fill=green!8,rounded corners=5pt,draw](modelmerge) at ([yshift=-3.5em]basemodeld.south) {};
    %     \end{pgfonlayer}
        
    %     \node[longdatabanknode,anchor=south](dataenxx) at ([xshift=-11em, yshift=17.1em]backgroundd.south) {En-XX};
    %     \node[longdatabanknode,anchor=west](dataxxen) at ([xshift=3.5*\nodehsep]dataenxx.east) {XX-En};        
        
    %     \node[datanode,anchor=south](group2d) at ([yshift=-1.2*\nodehsep]dataenxx.south) {$\mathrm{Group_2}$};
    %     \node[datanode,anchor=west](group1d) at ([xshift=-3.0*\nodehsep]group2d.east) {$\mathrm{Group_1}$};     
    %     \node[align=center,thick, scale=2] (omit1_01d) at ([xshift=1.1*\nodehsep]group2d.center) {...};
    %     \node[datanode,anchor=west](group3d) at ([xshift=0.5*\nodehsep]group2d.east) {$\mathrm{Group_n}$};
        
    %     \node[datanode,anchor=south](data2_02d) at ([yshift=-1*\nodehsep]dataxxen.south) {En-Zh};
    %     \node[datanode,anchor=west](data1_02d) at ([xshift=-3.0*\nodehsep]data2_02d.east) {En-De};  
    %     \node[align=center,thick, scale=2] (omit1_02d) at ([xshift=\nodehsep]data2_02d.center) {...};
    %     \node[datanode,anchor=west](data3_02d) at ([xshift=\nodehsep]data2_02d.east) {Fr-En};
        
    %     \draw[->,thick] ([xshift=-3.0\nodehsep]dataenxx.south) -- (group1d.north);
    %     \draw[->,thick] (dataenxx.south) -- (group2d.north);
    %     \draw[->,thick] ([xshift=3.0\nodehsep]dataenxx.south) -- (group3d.north);
        
    %     \draw[->,thick] ([xshift=-3.0\nodehsep]dataxxen.south) -- (data1_02d.north);
    %     \draw[->,thick] (dataxxen.south) -- (data2_02d.north);
    %     \draw[->,thick] ([xshift=3.0\nodehsep]dataxxen.south) -- (data3_02d.north);

    %     \node[basemodel,anchor=north](basemodeld) at ([xshift=0.1*\nodehsep,yshift=-0.5*\nodehsep]data2_02d.south) {Base Model};
    %     \draw[->,thick] (data1_02d.south) -- ([xshift=-5.6\nodehsep]basemodeld.north);
    %     \draw[->,thick] (data2_02d.south) -- ([xshift=-0.2\nodehsep]basemodeld.north);
    %     \draw[->,thick] (data3_02d.south) -- ([xshift=6.2\nodehsep]basemodeld.north);
        
    %     \node[loranode,anchor=north](lora1d) at ([yshift=-4.6\nodehsep]data1_02d.south) {$\mathrm{LoRA}_{G1}$};
    %     \node[loranode,anchor=north](lora2d) at ([yshift=-4.6\nodehsep]data2_02d.south) {$\mathrm{LoRA}_{G2}$};
    %     \node[align=center,thick, scale=2] (omit2d) at ([xshift=\nodehsep]lora2d.center) {...};
    %     \node[loranode,anchor=north](lora3d) at ([yshift=-4.6\nodehsep]data3_02d.south) {$\mathrm{LoRA}_{Gn}$}; 
        
    %     \node(plus1d) at ([yshift=0.6\nodehsep]lora1d.north) {\textbf{\(+\)}};
    %     \node(plus2d) at ([yshift=0.6\nodehsep]lora2d.north) {\textbf{\(+\)}};
    %     \node(plus3d) at ([yshift=0.6\nodehsep]lora3d.north) {\textbf{\(+\)}};

        
    %     \node[mergemodelnode,anchor=north](mergedmodel) at ([yshift=-1.2\nodehsep]lora2d.south) {Group-wise Merged Model};
        
    %     \node[tasknode,anchor=north](task1d) at ([yshift=-4.6\nodehsep]lora1d.south) {$\mathrm{Task}_1^{\mathrm{xxen}}$};
    %     \node[tasknode,anchor=north](task2d) at ([yshift=-4.6\nodehsep]lora2d.south) {$\mathrm{Task}_2^{\mathrm{xxen}}$};
    %     \node[align=center,thick, scale=2] (omit3d) at ([xshift=\nodehsep]task2d.center) {...};
    %     \node[tasknode,anchor=north](task3d) at ([yshift=-4.6\nodehsep]lora3d.south) {$\mathrm{Task}_n^{\mathrm{xxen}}$}; 

    %     \draw[->,thick] ([xshift=-5.0\nodehsep]mergedmodel.south) -- (task1d.north);
    %     \draw[->,thick] (mergedmodel.south) -- (task2d.north);
    %     \draw[->,thick] ([xshift=6.0\nodehsep]mergedmodel.south) -- (task3d.north);
        
    %     \begin{pgfonlayer}{background}
    %         % \node[anchor=south,minimum height=\nodehsep*6.5,minimum width=39.6em,fill=gray!4,rounded corners=5pt,dotted,draw](backgroundd) at ([xshift=11em, yshift=-18.6em]dataenxx.north) {};
    %         \node[anchor=south,minimum height=0.9*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankd1) at ([xshift=0.5em, yshift=-2.1em]group2d.north) {};
    %         \node[anchor=north,minimum height=0.9*\nodehsep,minimum width=17.2em,fill=orange!8,rounded corners=5pt,draw](databankd2) at ([xshift=0.5em,yshift=-0.9em]dataxxen.south) {};
    %         \node[anchor=south,minimum height=1.9*\nodehsep,minimum width=18.2em,fill=green!8,rounded corners=5pt,draw,dotted,thick](modelmerge) at ([yshift=-3.5em]basemodeld.south) {};
    %     \end{pgfonlayer}


    %     \node[mergenode,anchor=north](dataselectiond) at ([yshift=-0.7\nodehsep]databankd1.south) {Data Selection};
    %     \draw[->,thick] (databankd1.south) -- (dataselectiond.north);
        
    %     \node[basemodel,anchor=north](basemodeldleft) at ([yshift=-0.7\nodehsep]dataselectiond.south) {Base Model};
    %     \draw[->,thick] (dataselectiond.south) -- (basemodeldleft.north);
        
    %     \node[loranode,anchor=north](lora1dleft) at ([yshift=-7.2\nodehsep]group1d.south) {$\mathrm{LoRA}_{G1}$};
    %     \node[loranode,anchor=north](lora2dleft) at ([yshift=-7.2\nodehsep]group2d.south) {$\mathrm{LoRA}_{G2}$};
    %     \node[align=center,thick, scale=2] (omit2dleft) at ([xshift=\nodehsep]lora2dleft.center) {...};
    %     \node[loranode,anchor=north](lora3dleft) at ([yshift=-7.2\nodehsep]group3d.south) {$\mathrm{LoRA}_{Gn}$}; 
        
    %     \node(plus1dleft) at ([yshift=0.6\nodehsep]lora1dleft.north) {\textbf{\(+\)}};
    %     \node(plus2dleft) at ([yshift=0.6\nodehsep]lora2dleft.north) {\textbf{\(+\)}};
    %     \node(plus3dleft) at ([yshift=0.6\nodehsep]lora3dleft.north) {\textbf{\(+\)}};
    %      % \draw[+,thick] (basemodel.south) -- (model2.north);
    %     % \draw[->,thick] (data2.south) -- (model2.north);
    %     % \draw[->,thick] (data3.south) -- (model3.north);
        

    %     \node[tasknode,anchor=north](task1dleft) at ([yshift=-1.5\nodehsep]lora1dleft.south) {$\mathrm{Task}_{G1}$};
    %     \node[tasknode,anchor=north](task2dleft) at ([yshift=-1.5\nodehsep]lora2dleft.south) {$\mathrm{Task}_{G2}$};
    %     \node[align=center,thick, scale=2] (omit3dleft) at ([xshift=\nodehsep]task2dleft.center) {...};
    %     \node[tasknode,anchor=north](task3dleft) at ([yshift=-1.5\nodehsep]lora3dleft.south) {$\mathrm{Task}_{Gn}$}; 


    %     \draw[->,thick] (lora1dleft.south) -- (task1dleft.north);
    %     \draw[->,thick] (lora2dleft.south) -- (task2dleft.north);
    %     \draw[->,thick] (lora3dleft.south) -- (task3dleft.north);

        
    %      \draw[thick, -{Latex[round]}] (modelmerge.south) -- ([xshift=0.3em]mergedmodel.north);
    %     \node[anchor=south,font=\Large](l4) at ([xshift=.5em,yshift=-3em]backgroundd.south) {(d) Model Merging};
    % \end{scope}

    % picture e (group-wise)
    % \begin{scope}[xshift=6.5in,yshift=-3.6in]
    %     \begin{pgfonlayer}{background}
    %         \node[anchor=south,minimum height=\nodehsep*6.5,minimum width=19.5em,fill=gray!4,dotted,dashed,draw](backgrounde) at (0, 0) {};
    %     \end{pgfonlayer}

    %     \draw[->,thick,dashed] (modelmerge.east) -- ([xshift=-0.1*\nodehsep,yshift=0.1*\nodehsep]backgrounde.west);


    %     \node[basemodel,anchor=north](basemodele) at ([xshift=0.0*\nodehsep,yshift=-0.5*\nodehsep]backgrounde.north) {Base Model};

    %     \node[loranode,anchor=north](lora1e) at ([xshift=-2.1*\nodehsep,yshift=4.9*\nodehsep]backgrounde.south) {$\mathrm{LoRA}_{G1}$};
    %     \node[loranode,anchor=west](lora2e) at ([xshift=\nodehsep]lora1e.east) {$\mathrm{LoRA}_{G2}$};
    %     \node[align=center,thick, scale=2] (omit2e) at ([xshift=\nodehsep]lora2e.center) {...};
    %     \node[loranode,anchor=west](lora3e) at ([xshift=\nodehsep]lora2e.east) {$\mathrm{LoRA}_{Gn}$}; 
        
    %     \node(plus1e) at ([yshift=0.6\nodehsep]lora1e.north) {\textbf{\(+\)}};
    %     \node(plus2e) at ([yshift=0.6\nodehsep]lora2e.north) {\textbf{\(+\)}};
    %     \node(plus3e) at ([yshift=0.6\nodehsep]lora3e.north) {\textbf{\(+\)}};

        
    %     \node[groupnode,anchor=south](group1) at ([xshift=-1.8*\nodehsep, yshift=12.9em]backgroundc.south) {$\mathrm{Group}_1$};
    %     \node[groupnode,anchor=west](group2) at ([xshift=1.0\nodehsep]group1.east) {$\mathrm{Group}_2$};
    %     \node[align=center,thick, scale=2] (omitc) at ([xshift=1.06*\nodehsep]group2.center) {...};
    %     \node[groupnode,anchor=west](group3) at ([xshift=1.6\nodehsep]group2.east) {$\mathrm{Group}_n$};

        
    %     \node[loranode,anchor=north](lora2e2) at ([xshift=-0.1*\nodehsep,yshift=-\nodehsep]lora2e.south) {$\mathrm{LoRA}_{G2}$};
    %     \node[loranode,anchor=west](lora1e2) at ([xshift=-1.2*\nodehsep]lora2e2.west) {$\mathrm{LoRA}_{G1}$};
    %     \node[align=center,thick, scale=2] (omite2) at ([xshift=0.3*\nodehsep]lora2e2.east) {...};
    %     \node[loranode,anchor=east](lora3e2) at ([xshift=1.8*\nodehsep]lora2e2.east) {$\mathrm{LoRA}_{Gn}$}; 
        
    %     \draw[->,thick] (lora2e.south) -- ([xshift=0.1*\nodehsep,yshift=0.1*\nodehsep]lora2e2.north) node[midway, above,xshift=1.4*\nodehsep,yshift=-0.3*\nodehsep] {Combining LoRA};

    %     \begin{pgfonlayer}{background}
    %         \node[anchor=south,minimum height=0.9*\nodehsep,minimum width=13.5em,fill=green!4,rounded corners=5pt,dotted,dashed,draw](mergedlorabg) at ([xshift=0.3*\nodehsep,yshift=-0.18*\nodehsep]lora2e2.south) {};
    %     \end{pgfonlayer}

    %     \node[longloranode,anchor=north](mergedlorae) at ([yshift=-0.4*\nodehsep]mergedlorabg.south) {Group Merged $\mathrm{LoRA}$};
    %     \draw[->,thick] ([xshift=-0.2*\nodehsep]mergedlorabg.south) -- ([xshift=-0.2*\nodehsep,yshift=0.1*\nodehsep]mergedlorae.north);
        
        
    %     \node(plus4e) at ([xshift=-0.2*\nodehsep,yshift=-0.3*\nodehsep]mergedlorae.south) {\textbf{\(+\)}};
    %     \node[basemodel,anchor=south](basemodele2) at ([xshift=-0.0*\nodehsep,yshift=0.4*\nodehsep]backgrounde.south) {Base Model};
        
    %      % \draw[thick, -{Latex[round]}] (databankc.south) -- ([xshift=-0.12em]dataselectionc.north);
    %     \node[anchor=south,font=\Large](l5) at ([xshift=.5em,yshift=-3em]backgrounde.south) {(e) Group-wise Model Merging};
    % \end{scope}
    
\end{tikzpicture}
    
    
    \caption{(a) Seperate training; (b) Multilingual training; (c) Group multilingual training; (d) Model merging; (e) Group-wise model merging}
    \label{fig:architecture}
    \vspace{-1em}
% \end{figure*}
\endgroup

\label{fig:comparison-merge}
\end{figure*}

% \end{document}
