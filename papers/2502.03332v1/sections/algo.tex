\begin{algorithm}[t]
    \caption{Midpoint Gibbs Sampler}
    \begin{algorithmic}[1]
        \STATE {\bfseries Input:} Number of repetitions $\gibbsReps$. 
        \STATE {\bfseries Init:} $\bX_{\initpoint} \gets \hpredx{n}{(\bX_n)}$

        \FOR{$k=n-1$ to $2$}
            \STATE {\bfseries Pick:} $\midpoint \sim \uniform(\intset{1}{k-1})$
            \STATE {\bfseries Init:} $\bX^{(0)}_k \sim \fwtrans{k|0}{\bX_{\initpoint}}{\cdot}, \, \bX^{(0)}_{\initpoint} \gets \bX_{\initpoint}$

            \FOR{$r = 1$ {\bfseries to} $R$}
                \STATE $\bX^{(r)}_\midpoint \sim \potn{\midpoint}{\cdot} \fwtrans{\midpoint|\initpoint, k}{\bX^{(r-1)}_\initpoint, \bX^{(r-1)}_k}{\cdot}$
                \STATE $\bX^{(r)}_\initpoint \sim \bw{\initpoint|\midpoint}{\bX^{(r)}_{\midpoint}}{\cdot}$
                \STATE $\bX^{(r)}_k \sim \fwtrans{k|\midpoint}{\bX^{(r)}_{\midpoint}}{\cdot}$
            \ENDFOR
            \STATE $\bX_{\initpoint} \gets \bX^{(R)}_{\initpoint}, \,\bX_{k} \gets \bX^{(R)}_{k}$
        \ENDFOR

        \STATE $\bX_1 \sim \potn{}{\cdot} \bw{1|2}{\bX_2}{\cdot}$

        \STATE {\bfseries Output:} $\hpredx{1}{(\bX_1)}$
    \end{algorithmic}
    \label{algo:midpoint-gibbs}
\end{algorithm}
