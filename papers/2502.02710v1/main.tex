\documentclass{article}


\PassOptionsToPackage{numbers,sort&compress}{natbib}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks

\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{amsfonts}[mathscr]
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{natbib}[numbers,sort&compress]
\usepackage{geometry}
\usepackage{booktabs} % for professional tables
\usepackage{graphicx} 
\usepackage{todonotes}
\usepackage{xcolor}
\usepackage{dsfont}
\usepackage{nicefrac}
\usepackage{tcolorbox}
\usepackage{tabularx}
\usepackage{pifont}
% \usepackage{enumitem}
\usepackage{multirow}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage[capitalize,noabbrev]{cleveref}
\usepackage{mathrsfs}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[export]{adjustbox}
\usepackage[list=true]{subcaption}

\usepackage{authblk,textcomp}

\usepackage[cal=euler]{mathalfa}
\usepackage{libertine}



\usepackage{titletoc}

% \newcommand\DoToC{%
%   \startcontents
% \hypersetup{colorlinks=true}
%   \printcontents{}{1}{\subsection*{\textbf{Table of contents}}}
%   \vskip3pt\vskip5pt
% }

%=====================================
% AMS package for theorem section
%-------------------------------------
\usepackage{amsthm}
\usepackage{thmtools, thm-restate}
\declaretheorem[numberwithin=section]{thm}
\declaretheorem[sibling=thm]{theorem}
\declaretheorem[sibling=thm]{lemma}
\declaretheorem[sibling=thm]{corollary}
\declaretheorem[numberwithin=section]{assumption}
\declaretheorem[numbered=no]{discussion}
\declaretheorem[]{challenged assumption}
\declaretheorem[]{definition}
\declaretheorem[]{proposition}
\declaretheorem[style=remark]{example}
%=====================================
% Commands for text
%-------------------------------------
\usepackage{xspace}
\DeclareRobustCommand{\eg}{e.g.,\@\xspace}
\DeclareRobustCommand{\ie}{i.e.,\@\xspace}
\DeclareRobustCommand{\wrt}{w.r.t.\@\xspace}


%=====================================
% Math commands
%-------------------------------------
\input{contents/sections/macros}

\renewcommand{\X}{\mathcal{X}}
\newcommand{\Aspace}{\mathcal{A}}
\newcommand{\Sspace}{\mathcal{S}}
\newcommand{\Hspace}{\mathcal{H}}
\DeclareMathOperator*{\EV}{\mathbb{E}}
\DeclareMathOperator*{\Var}{\mathbb{V}ar}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\mdp}{\mathcal{M}}
\newcommand{\one}{\mathds{1}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\var}{VaR_{\alpha}}
\DeclareMathOperator{\cvar}{CVaR_{\alpha}}
\renewcommand{\F}{\mathcal{F}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\cmdp}{\mathcal{CM}}
\renewcommand{\cmark}{\ding{51}}%
\renewcommand{\xmark}{\ding{55}}%
\newcommand{\emdp}{\mdp_\ell}
\newcommand{\eAspace}{\mathcal{A}_\ell}
\newcommand{\eSspace}{\mathcal{S}_\ell}
\newcommand{\eP}{P_\ell}
\newcommand{\emu}{\mu_\ell}
\newcommand{\er}{r_\ell}
\newcommand{\es}{s_\ell}
\newcommand{\ea}{a_\ell}
\newcommand{\pomdp}{\mathcal{P}\mdp}
\renewcommand{\R}{\mathcal{R}}
\DeclareMathOperator{\w}{\mathbf{w}}
%-------------------------------------

\usepackage{tikz}
\usetikzlibrary{shapes, arrows.meta, positioning}


\usepackage{enumerate}
\usepackage{wrapfig}

% Page Layout
\geometry{
a4paper,
left=20mm,
right=20mm,
top=20mm,
}

\hypersetup{
    colorlinks,
   linkcolor={pierCite},
    citecolor={pierCite},
    urlcolor={pierCite}
}



\title{Achievable distributional robustness when the robust risk is only partially identified}



\author[1]{Julia Kostin}
\author[2]{Nicola Gnecco\thanks{This work was conducted while NG was at the Gatsby Computational Neuroscience Unit, University College London.}}
\author[1]{Fanny Yang}
% new official EPFL format
\affil[1]{\small Department of Computer Science, ETH Zurich}
% \affil[2]
\affil[2]{\small Department of Mathematics, Imperial College London}



\begin{document}


\maketitle


\begin{abstract}

  In safety-critical applications, machine learning models should generalize well under worst-case distribution shifts, that is, have a small robust risk. Invariance-based algorithms 
  can provably take advantage of structural assumptions on the shifts when the training distributions are heterogeneous enough to identify the robust risk. However, in practice, such identifiability conditions are rarely
  satisfied -- a scenario so far underexplored in the theoretical literature. In this paper, we aim to fill the gap and propose to study the more general setting when the robust risk is only \emph{partially identifiable}. In particular, 
  we introduce the \emph{worst-case robust risk} as a new measure of robustness that is always well-defined regardless of identifiability.
  Its minimum corresponds to
  an algorithm-independent (population) minimax quantity that measures the \emph{best achievable robustness} under partial identifiability.
  While these concepts can be defined more broadly, 
  in this paper 
  we introduce and derive them explicitly for a linear model
  for concreteness of the presentation. 
  First, we show that existing robustness methods are provably suboptimal in the partially identifiable case.
  We then evaluate these methods and the minimizer of the (empirical) worst-case robust risk on real-world gene expression data and find a similar trend:
  the test error of existing robustness methods grows increasingly suboptimal as the 
  fraction of data from unseen environments increases, whereas accounting for partial identifiability allows for better generalization.
  \end{abstract}

  \section{Introduction}\label{sec:intro}
  \input{contents/sections/intro-final}

  \section{Setting}
  \label{sec:setting}\input{contents/sections/setting}
  \section{Theoretical results for 
  the linear setting}
  \label{sec:main-results}
  \input{contents/sections/main_results}
  
  \section{Conclusion and future directions}
  \label{sec:conclusion}
  \input{contents/sections/conclusion}

\section{Acknowledgements}
\label{sec:acknowledgements}
\input{contents/sections/acknowledgements}
  
  \bibliography{biblio}
  \bibliographystyle{unsrt}
  % \bibliographystyle{plain} % !!! change to this before submission
  % \bibliographystyle{plainnat}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage
\appendix
\hypersetup{
    colorlinks,
   linkcolor={pierCite},
    citecolor={pierCite},
    urlcolor={pierCite}
}
\section*{Appendix}
The following sections provide deferred discussions, proofs and experimental details.
% \DoToC
% \clearpage
% \hypersetup{
%     colorlinks,
%    linkcolor={pierLink},
%     citecolor={pierCite},
%     urlcolor={pierCite}
% }


\section{Extended related work}
\label{sec:apx-related_work}
\input{contents/sections/related_work}

\section{Extension to the general additive shift setting}\label{sec:apx-extension}
\input{contents/sections/apx_extension}
\section{Comparison to finite robustness methods continued}\label{sec:apx-anchor-connections}
\input{contents/sections/apx_anchor}
\section{Empirical estimation of the worst-case robust predictor}\label{sec:apx-empirical-estimation}

\input{contents/sections/apx_empirical_estimation}
\section{Details on finite-sample experiments}\label{sec:apx-experiments}
\input{contents/sections/apx_experiments}


\section{Proofs}
\label{sec:apx-proofs}
\input{contents/sections/apx_proofs}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}