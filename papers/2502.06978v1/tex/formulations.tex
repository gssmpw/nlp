\section{AC-OPF and a Semidefinite Relaxation}
\label{sec:formulation}

The imaginary unit is denoted by $\im$, i.e., $\im^{2} \, {=} \, -1$.
The complex conjugate of $z \, {\in} \, \mathbb{C}$ is $z^{\star}$.
$\Re(\cdot)$ and $\Im(\cdot)$ denotes the real and imaginary parts of a complex number.
In all that follows, let $\E_{ij}$ denote a square matrix of appropriate dimension, whose $(i, j)$ entry is equal to $1$, and all other zeros.
The identity matrix is denoted by $I$.
The symmetric and skew-symmetric parts of square matrix $\mathbf{A}$ are denoted by $\mathbf{A}^{+} = (\mathbf{A} + \mathbf{A}^{\top})/2$ and $\mathbf{A}^{-} = (\mathbf{A} - \mathbf{A}^{\top})/2$.
Note that $\mathbf{A} = \mathbf{A}^{+} + \mathbf{A}^{-}$.
The smallest eigenvalue of a Hermitian matrix $\mathbf{X}$ is denoted by $\lambda_{min}(\mathbf{X})$.
The cones of positive semidefinite Hermitian (resp. symmetric) matrices of order $n$ is denoted by $\mathbb{H}_{+}^{n}$ (resp. $\mathbb{S}^{n}_{+}$),
and the second-order cone of order $n$ is denoted by $\mathcal{Q}^{n} = \{x \in \mathbb{R}^{n} \, | \, x_{1} \geq \sqrt{x_{2}^{2} + ... + x_{n}^{2}} \}$.

The paper considers a power grid, represented as a simple directed graph, whose sets of buses and branches are denoted by $\mathcal{N}$ and $\mathcal{E}$, respectively.
Each branch is represented as a directed edge $(i, j)$ from bus $i$ to $j$, with admittance matrix
\begin{align}
    Y_{ij} =
    \begin{pmatrix}
        \yff_{ij} & \yft_{ij}\\
        \ytf_{ij} & \ytt_{ij}
    \end{pmatrix}
    = 
    \begin{pmatrix}
        \gff_{ij} + \im \bff_{ij} & \gft_{ij} + \im \bft_{ij}\\
        \gtf_{ij} + \im \btf_{ij} & \gtt_{ij} + \im \btt_{ij}
    \end{pmatrix}
    \in 
    \mathbb{C}^{2 \times 2}.
\end{align}
The shunt admittance and power demand at node $i$ are denoted by $Y^{s}_{i} = g^{s}_{i} + \im b^{s}_{i} \in \mathbb{C}$ and $\Sd_{i} = \pd_{i} + \im \qd_{i} \in \mathbb{C}$, respectively.
For ease of reading and without loss of generality, we formulate the problems assuming that exactly one generator is connected to each bus, and that generation costs are linear.



\subsection{The AC-Optimal Power Flow Formulation}

The formulation of AC-OPF considered in this paper is detailed in Model~\ref{model:AC-OPF}.
The decision variables comprise complex generation $\Sg = \pg + \im \qg$,
complex nodal voltage $\V = \vm \angle \va$,
and forward and reverse power flows $\Sf = \pf + \im \qf$ and $\St = \pt + \im \qt$.
The objective \eqref{eq:ACOPF:objective} minimizes total generation costs.
Constraint \eqref{eq:ACOPF:kirchhoff} enforces Kirchhoff current law at each bus.
Constraints \eqref{eq:ACOPF:ohm_fr}--\eqref{eq:ACOPF:ohm_to} express power flows on each branch using Ohm's law,
and constraints \eqref{eq:ACOPF:thermal_limits} enforce thermal limits on forward and reverse power flows.
Finally, constraints \eqref{eq:ACOPF:voltage_bounds} and \eqref{eq:ACOPF:reactive_dispatch_bounds} enforce minimum and maximum limits on nodal voltage magnitude and power generation.

\begin{figure}[!t]
    \centering
    \begin{minipage}[t]{0.47\textwidth}
        \begin{model}[H]
            \caption{The AC-OPF model}
            \label{model:AC-OPF}
            \begin{subequations}
            \footnotesize
            \label{eq:ACOPF}
            \begin{align}
                \min \quad 
                & \sum_{i \in \mathcal{N}} c_{i} \pg_{i}
                    \label{eq:ACOPF:objective}
                    \\
                \textrm{s.t.} \quad
                & \Sg_{i} - \Sd_{i} - Y_{i}^{s^{*}} |\V_{i}|^{2} = \sum_{(i,j) \in \mathcal{E}} \Sf_{ij} + \sum_{(j,i) \in \mathcal{E}} \St_{ji}
                    && \forall i \in \mathcal{N}
                    \label{eq:ACOPF:kirchhoff}
                    \\
                & \Sf_{ij} = {\yff_{ij}}^{*} |\V_{i}|^{2} - {\yft_{ij}}^{*} \V_{i} \V_{j}^{*} 
                    && \forall ij \in \mathcal{E}
                    \label{eq:ACOPF:ohm_fr}
                    \\
                & \St_{ij} = {\ytt_{ij}}^{*} |\V_{j}|^{2} - {\ytf_{ij}}^{*} \V_{i}^{*} \V_{j}
                    && \forall ij \in \mathcal{E}
                    \label{eq:ACOPF:ohm_to}
                    \\
                & |\Sf_{ij}|, |\St_{ij}| \leq \bar{s}_{ij}
                    && \forall ij \in \mathcal{E}
                    \label{eq:ACOPF:thermal_limits}
                    \\
                & \vmmin_{i} \leq |\V_{i}| \leq \vmmax_{i} 
                    && \forall i \in \mathcal{N}
                    \label{eq:ACOPF:voltage_bounds}
                    \\
                & \Sgmin_{i} \leq \Sg_{i} \leq \Sgmax_{i}
                    && \forall i \in \mathcal{N}
                    \label{eq:ACOPF:reactive_dispatch_bounds}
            \end{align}
            \end{subequations}
            \vspace{0.5em}
        \end{model}
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.45\textwidth}
        \begin{model}[H]
            \caption{The SDP-OPF model}
            \label{model:SDP-OPF}
            \begin{subequations}
            \footnotesize
            \begin{align}
                \min \quad 
                & \sum_{i \in \mathcal{G}} c_{i} \pg_{i}
                    \label{eq:SDPOPFC:obj}
                    \\
                \textrm{s.t.} \quad
                & \Sg_{i} - \Sd_{i} - Y_{i}^{s^{*}} \Wsdp_{ii} = \sum_{(i,j) \in \mathcal{E}} \Sf_{ij} + \sum_{(j,i) \in \mathcal{E}} \St_{ji}
                    && \forall i \in \mathcal{N}
                    \label{eq:SDPOPFC:kirchhoff}
                    \\
                & \Sf_{ij} = \inner{\yff_{ij} \E_{ii} + \yft_{ij} \E_{ij}}{\Wsdp}
                    && \forall ij \in \mathcal{E}
                    \\
                & \St_{ij} = \inner{\ytt_{ij} \E_{jj} + \ytf_{ij} \E_{ij}}{\Wsdp}
                    && \forall ij \in \mathcal{E}
                    \\
                & 
                    (\bar{s}_{ij}, \pf_{ij}, \qf_{ij}), (\bar{s}_{ij}, \pt_{ij}, \qt_{ij}) \in \mathcal{Q}^{3}
                    && \forall ij \in \mathcal{E}
                    \\
                & \vmmin_{i}^{2} \leq \Wsdp_{ii} \leq \vmmax_{i}^{2} 
                    && \forall i \in \mathcal{N} \\
                & \Sgmin_{i} \leq \Sg_{i} \leq \Sgmax_{i}
                    && \forall i \in \mathcal{N}
                    \label{eq:SDPOPFC:qg:bounds}
                    \\
                & \Wsdp \in \mathbb{H}^{|\mathcal{N}|}_{+}
                    \label{eq:SDPOPFC:psd}
            \end{align}
            \end{subequations}
        \end{model}
    \end{minipage}
\end{figure}



\subsection{A Semidefinite Relaxation of AC-OPF}

Introducing the change of variable $\Wsdp = \V \V^{\star}$ yields an equivalent formulation of AC-OPF if $\Wsdp \succeq 0$ and $\text{rank}(\Wsdp) = 1$.
Relaxing the rank constraint on $\Wsdp$ yields a semidefinite relaxation SDP-OPF, originally proposed in \cite{Bai2008_SDPRelaxationOPF}, which is stated in Model \ref{model:SDP-OPF}.
Because SDP-OPF is a relaxation of AC-OPF, its optimal value is a valid lower bound on the optimal value of AC-OPF.

Model \ref{model:DSDP-OPF} presents the conic dual of SDP-OPF, where $\mathcal{A}_{R}(\lambda, \mu, \nu)$ and $\mathcal{A}_{I}(\lambda, \mu, \nu)$ are defined as
\begin{align}
    \label{eq:AR_def}
    \mathcal{A}_{R}(\lambda, \mu, \nu) = 
        & \sum_{i \in \mathcal{N}} 
            (- g_{i}^{s} \lambdaP_{i} + b_{i}^{s} \lambdaQ_{i}) \E_{ii} 
            + (\muWmMin_{i} - \muWmMax_{i}) \E_{ii}\\
        &  + \sum_{(i, j) \in \mathcal{E}} \left(
                  \lambdaPf_{ij} \big( \gff_{ij} \E_{ii} + \gft_{ij} \E^{+}_{ij} \big)
                + \lambdaPt_{ij} \big( \gtt_{ij} \E_{jj} + \gtf_{ij} \E^{+}_{ij} \big)
                - \lambdaQf_{ij} \big( \bff_{ij} \E_{ii} + \bft_{ij} \E^{+}_{ij} \big)
                - \lambdaQt_{ij} \big( \btt_{ij} \E_{jj} + \btf_{ij} \E^{+}_{ij} \big)
                \right) \nonumber\\
    % & &+ & (-\muAngleDiffMin_{ij} \tan(\dvamin) + \muAngleDiffMax_{ij} \tan(\dvamax)) \sympart(\E_{ij}) \\
    \mathcal{A}_{I}(\lambda, \mu, \nu) = 
        & \sum_{(i, j) \in \mathcal{E}} \left(
            \lambdaPf_{ij} \bft_{ij} \E^{-}_{ij}
            - \lambdaPt_{ij} \btf_{ij} \E^{-}_{ij}
            + \lambdaQf_{ij} \gft_{ij} \E^{-}_{ij}
            - \lambdaQt_{ij} \gtf_{ij} \E^{-}_{ij}
            % + (\muAngleDiffMin_{ij} - \muAngleDiffMax_{ij}) \E^{-}_{ij}
        \right).
\end{align}
By weak duality, any dual solution that satisfies \eqref{eq:DSDPOPF:pg}-\eqref{eq:DSDPOPF:psd} yields a valid lower bound on the optimal value of SDP-OPF and, in turn, the optimal value of AC-OPF.

\begin{model}[!t]
\caption{The DSDP-OPF model}
\label{model:DSDP-OPF}
\begin{subequations}
    \small
    \begin{align}
        \max_{\lambda, \mu, \nu} \quad 
        & \sum_{i \in \mathcal{N}} \left(
            \pd_{i} \lambdaP_{i}
            + \qd_{i} \lambdaQ_{i}
            + \vmmin_{i}^{2} \muWmMin_{i} - \vmmax_{i}^{2} \muWmMax_{i}
            + \pgmin_{i} \muPgMin_{i} - \pgmax_{i} \muPgMax_{i}
            + \qgmin_{i} \muQgMin_{i} - \qgmax_{i} \muQgMax_{i}
        \right)
        - \sum_{e \in \mathcal{E}} \bar{s}_{e} \left( \nuThermalSfr_{e} + \nuThermalSto_{e} \right)
        \label{eq:DSDPOPF:obj}
        \\
        \text{s.t.} \quad
        & 
            \lambdaP_{i} + \muPgMin_{i} - \muPgMax_{i} = c_{i}
            && \forall i \in \mathcal{N}
            \label{eq:DSDPOPF:pg}\\
        & 
            \lambdaQ_{i} + \muQgMin_{i} - \muQgMax_{i} = 0
            && \forall i \in \mathcal{N}
            \label{eq:DSDPOPF:qg}\\
        & 
            -\lambdaP_{i} - \lambdaPf_{ij} + \nuThermalPfr_{ij} = 0
            && \forall ij \in \mathcal{E}
            \label{eq:DSDPOPF:pf}\\
        & 
            -\lambdaQ_{i} - \lambdaQf_{ij} + \nuThermalQfr_{ij} = 0
            && \forall ij \in \mathcal{E}
            \label{eq:DSDPOPF:qf}\\
        & 
            -\lambdaP_{j} - \lambdaPt_{ij }+ \nuThermalPto_{ij} = 0
            && \forall ij \in \mathcal{E}
            \label{eq:DSDPOPF:pt}\\
        & 
            -\lambdaQ_{j} - \lambdaQt_{ij} + \nuThermalQto_{ij} = 0
            && \forall ij \in \mathcal{E}
            \label{eq:DSDPOPF:qt}\\
        &
            \mathcal{A}_{R}(\lambda, \mu, \nu) + \im \mathcal{A}_{I}(\lambda, \mu, \nu) + \Ssdp = 0
            &&
            \label{eq:DSDPOPF:W}
            \\
        % Domain of dual variables
        & 
            \muPgMin, \muPgMax, \muQgMin, \muQgMax, \muWmMin, \muWmMax \geq 0
            && 
            \label{eq:DSDPOPF:non_negative} \\
        & 
            \nuThermalfr_{ij} = (\nuThermalSfr_{ij}, \nuThermalPfr_{ij}, \nuThermalQfr_{ij}) \in \mathcal{Q}^{3},
            \nuThermalto_{ij}  = (\nuThermalSto_{ij}, \nuThermalPto_{ij}, \nuThermalQto_{ij})\in \mathcal{Q}^{3}
            && \forall ij \in \mathcal{E}
            \label{eq:DSDPOPF:cone:nu} \\
        &
            \Ssdp \in \hermat^{|\mathcal{N}|}_{+}
            \label{eq:DSDPOPF:psd}
            && 
    \end{align}
\end{subequations}
\end{model}
