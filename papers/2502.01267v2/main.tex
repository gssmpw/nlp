\documentclass[twoside,11pt]{article}
\usepackage{jair, rawfonts}
% \usepackage{jair, theapa, rawfonts}
\usepackage[backend=biber, style=apa]{biblatex}
\addbibresource{references.bib}

% OURS
% \usepackage{caption}
\usepackage{graphicx}
% \graphicspath{figures/}
\usepackage{hyperref}
\usepackage{color}
\usepackage{epigraph}
\usepackage{csquotes}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bbm}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{shapes.geometric}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[algo2e,ruled,linesnumbered,noend]{algorithm2e}
\usepackage{soul}
\usepackage{bbm}
\usepackage{eurosym}
\usepackage{booktabs}
\usepackage{float}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{remark}{Remark}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{example}{Example}[section]

% JAIR arguments
\jairheading{82}{2025}{2279-2323}{12/2024}{04/2025}
\ShortHeadings{Counterfactual Situation Testing}{Alvarez \& Ruggieri}
\firstpageno{2279}

%%
\begin{document}

%%
\title{Counterfactual Situation Testing: \\ From Single to Multidimensional Discrimination}

%%
\author{\name Jose M. Alvarez \email josemanuel.alvarez@kuleuven.be \\
\addr Department of Computer Science, KU Leuven \\ 3001 Leuven, Belgium
\AND
\name Salvatore Ruggieri \email salvatore.ruggieri@unipi.it \\
\addr Department of Computer Science, University of Pisa \\ 56126 Pisa, Italy}

%%
\maketitle

%%
\begin{abstract}
    As machine learning models enable decisions once performed only by humans, it is central to develop tools that assess the fairness of such models. Notably, within high-stake settings like hiring and lending, these tools must be able to detect potentially discriminatory models. We present counterfactual situation testing (CST), a causal data mining framework for detecting individual discrimination in a dataset of classifier decisions. CST answers the question ``what would have been the model outcome had the individual, or complainant, been of a different protected status?'' It extends the legally-grounded situation testing (ST) of \textcite{Thanh_KnnSituationTesting2011} by operationalizing the notion of \textit{fairness given the difference} via counterfactual reasoning. ST finds for each complainant similar protected and non-protected instances in the dataset; constructs, respectively, a control and test group; and compares the groups such that a difference in model outcomes implies a potential case of individual discrimination. CST, instead, avoids this idealized comparison by establishing the test group on the complainant's generated counterfactual, which reflects how the protected attribute when changed influences other seemingly neutral attributes of the complainant. Under CST we test for discrimination for each complainant by comparing similar individuals within the control and test group but dissimilar individuals across these groups. We consider single (e.g.,~gender) and multidimensional (e.g.,~gender and race) discrimination testing. For multidimensional discrimination we study multiple and intersectional discrimination and, as feared by legal scholars, find evidence that the former fails to account for the latter kind. Using a k-nearest neighbor implementation, we showcase CST on synthetic and real data. Experimental results show that CST uncovers a higher number of cases than ST, even when the model is counterfactually fair. CST, in fact, extends counterfactual fairness (CF) of \textcite{Kusner2017CF} by equipping CF with confidence intervals, which we report for all experiments.
\end{abstract}

\section{Introduction}
\label{sec:Introduction}
\input{sections/01_Introduction.tex}

\section{Related Work}
\label{sec:RelatedWork}
\input{sections/02_RelatedWork}

\section{Causal Knowledge for Discrimination Testing}
\label{sec:CausalKnowledge}
\input{sections/03_CausalKnowledge.tex}

\section{Counterfactual Situation Testing}
\label{sec:CST}
\input{sections/04_CST.tex}

\section{Experiments}
\label{sec:Experiments}
\input{sections/05_Experiments.tex}

\section{Discussion}
\label{sec:Discussion}
\input{sections/06_Discussion}

\section{Conclusion}
\label{sec:Conclusion}
\input{sections/07_Conclusion.tex}

%%
\acks{A preliminary version of this work appeared in \textcite{DBLP:conf/eaamo/AlvarezR23}. This work has received funding from the European Unionâ€™s Horizon 2020 research and innovation program under Marie Sklodowska-Curie Actions (grant agreement number 860630) for the project ``NoBIAS - Artificial Intelligence without Bias''; and from M4C2 - Investimento 1.3, Partenariato Esteso PE00000013 - ``FAIR - Future Artificial Intelligence Research'' - Spoke~1 ``Human-centered AI''. This work reflects only the authors' views and the European Research Executive Agency (REA) is not responsible for any use that may be made of the information it contains. 
We thank the three anonymous reviewers for their comments, which helped us improve considerably this work.}

%%
\appendix
\input{sections/08_Appendix}

%%
\vskip 0.2in
\printbibliography
% \bibliography{references}
% \bibliographystyle{theapa}

\end{document}

%
% EOF
%
