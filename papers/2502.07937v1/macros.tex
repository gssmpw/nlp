\newcommand*\boldell{\pmb{\ell}}

\newcommand\lossIL{e}
\newcommand\loss{\ell}
\newcommand\lossB{\ensuremath{\boldell}}

\newcommand\Loss{\ensuremath{L}}
\newcommand\LossB{\ensuremath{\mathbi{L}}}

\newcommand\Policies{\ensuremath{\Pi}}
\newcommand\policy{\ensuremath{\pi}}
\newcommand\PoliciesDist{q}
\newcommand\PoliciesDistB{\mathbi{q}}
\newcommand\state{s}
\newcommand\stateB{\ensuremath{\hat{{\mathbi{\state}}}}}
\newcommand\stateDist{d}
\newcommand\stateDistB{\mathbi{d}}
\newcommand\transDynamics{\mathcal{P}}
\newcommand\reward{r}
\newcommand\RFunc{R}

\newcommand\DFunc{D}
\newcommand\Gradient{{g}}

\newcommand\VFunc{\ensuremath{\ensuremath{V}}}
\newcommand\Func{\ensuremath{\ensuremath{f}}}
\newcommand\QFunc{\ensuremath{\ensuremath{Q}}}
\newcommand\Adv{\mathbi{A}}
\newcommand\AFunc{\mathbi{A}}
\newcommand\pw{h}
\newcommand\pwB{\mathbi{h}}
\newcommand\PolicyAdviceMatrix{\mathcal{E}^{(t)}}

\newcommand\Indicator{\textit{I}}
\newcommand\queryProb{z}

\newcommand{\trollin}{\psi}

\def\mathbi#1{\textbf{\em #1}}
\newcommand\ipm{\mathbi{I}}
\newcommand\Evaluators{\Policies}
\newcommand\evaluator{\policy}
\newcommand\policyIndex{k}
\newcommand\modelIndex{j}
\newcommand\ModelsDist{w}%
\newcommand\ModelsDistB{\mathbi{w}}%


\newcommand\pd{\ensuremath{\hat{\clabel}}}
\newcommand\pdB{\ensuremath{\hat{{\mathbi{\clabel}}}}}

\newcommand\discFactor{\gamma}

\newcommand\qlb{\ensuremath{{\frac{1}{\sqrt{t}}}}}
\newcommand\constant{\ensuremath{C}}

\newcommand\Models{\ensuremath{\mathcal{F}}}
\newcommand\TasksNum{\ensuremath{k}}
\newcommand\bonus{\ensuremath{\mathcal{B}}}
\newcommand\ONum{\ensuremath{K}}

\newcommand\model{\ensuremath{f}}
\newcommand\instance{\ensuremath{\mathbi{x}}}
\newcommand\domInstance{\ensuremath{\mathcal{X}}}
\newcommand\domClabel{\ensuremath{\mathcal{Y}}}
\newcommand\stateSpace{\ensuremath{\mathcal{S}}}
\newcommand\action{\ensuremath{a}}
\newcommand\actionDist{\ensuremath{\mathbi{A}}}
\newcommand\actionSpace{\ensuremath{\mathcal{A}}}
\newcommand\trajectory{\ensuremath{\mathcal{\tau}}}
\newcommand\horizon{\ensuremath{T}}
\newcommand\ENum{\ensuremath{N}} %
\newcommand\eNum{\ensuremath{n}} %

\newcommand\GNum{\ensuremath{G}} %

\newcommand\EnsembleNum{\ensuremath{E}} %
\newcommand\PSet{\ensuremath{P}} %
\newcommand\batch{\ensuremath{N}} %

\newcommand\idx{\ensuremath{{I}}} 
\newcommand\weight{\ensuremath{{w}}} 

\newcommand\threshold{\ensuremath{{\epsilon}}}

\newcommand\exploreProb{\ensuremath{{p}}}
\newcommand\dataset{\ensuremath{\mathcal{G}}}
\newcommand\density{\ensuremath{{w}}}
\newcommand\priority{\ensuremath{{\sigma}}} %
\newcommand\prob{\ensuremath{{p}}} %

\newcommand\RewardFunc{\ensuremath{r}}

\newcommand\Regret{\ensuremath{R}}
\newcommand\TotalExpCost{\ensuremath{J}}
\newcommand\clabel{y} %
\newcommand\clabelB{\mathbi{y}} %
\newcommand\Learner{\ensuremath{\mathcal{AL}}\xspace} 

\newcommand\MDP{\ensuremath{\mathcal{M}}}




\newcommand\ReplayBuffer{\ensuremath{\mathcal{R}}}
\newcommand\OfflineBuffer{\ensuremath{\mathcal{D}}}
\newcommand\SamplingName{advantage online prioritized active sampling}

\newcommand\adviceMatrix{\ensuremath{\mathbi{E}}}
\newcommand\adviceMatrixI{\ensuremath{\mathcal{E}}}%
\newcommand\adviceMatrixIB{\ensuremath{\mathbb{\mathcal{E}}}}
\newcommand\expectation{\ensuremath{\mathbb{E}}}
\newcommand\budget{\ensuremath{b}}

\newcommand\entropyF{\mathfrak{E}}

\newcommand\minpgap[1]{\ensuremath{\rho_{#1}}}

\newcommand\maxind[1]{\ensuremath{\text{maxind}(#1)}}

\renewcommand{\Pr}[1]{\ensuremath{\mathbb{P}\left[#1\right] }}
\newcommand{\Prover}[2]{\ensuremath{\mathbb{P}_{#1}\!\left[#2\right]}}

\newcommand{\expct}[1]{\mathbb{E}\left[#1\right]}
\newcommand{\expctover}[2]{\mathbb{E}_{#1}\!\left[#2\right]}

\newcommand{\abs}[1]{\left\vert#1\right\vert}
\def \argmax {\mathop{\rm arg\,max}}
\def \argmin {\mathop{\rm arg\,min}}
\newcommand{\kl}{{\mathrm{KL}}}
\def\dr{\displaystyle \rm}

\newcommand\fm{\ensuremath{\mathbb{\psi}}}

\newcommand{\algname}{\textsc{$A^3$\text{RL}}\xspace}
\newcommand{\algRecommend}{\textsc{Recommend}\xspace}

\newif\iffinal
\finaltrue

\iffinal
    \newcommand{\fix}[1]{}
    \newcommand{\YC}[1]{}
    \newcommand{\YCinline}[1]{}
    \newcommand{\XL}[1]{}
    \newcommand{\XLinline}[1]{}
    \newcommand{\MW}[1]{}
    \newcommand{\MWinline}[1]{}
    \newcommand{\note}[1]{}
    \newcommand{\pref}[1]{}
\else
    \setlength{\marginparwidth}{1.5cm}
    \newcommand{\fix}[1]{{\color{red} #1}}
    \newcommand{\YC}[1]{\todo[fancyline,color=NavyBlue!40]{YC: #1}\xspace}
    \newcommand{\YCinline}[1]{\textcolor{NavyBlue}{[YC: #1]}}
    \newcommand{\XL}[1]{\todo[fancyline,color=green!40]{XL: #1}\xspace}
    \newcommand{\XLinline}[1]{\textcolor{NavyBlue}{[XL: #1]}}
    \newcommand{\MW}[1]{\todo[fancyline,color=blue!40]{MW: #1}\xspace}
    \newcommand{\MWinline}[1]{\textcolor{green}{[MW: #1]}}
    \newcommand{\note}[1]{{\color{purple}[XL: #1]}}
    \newcommand{\question}[1]{\todo[fancyline,color=Maroon!40]{XL: #1}\xspace}
    \newcommand{\pref}[1]{{\color{blue}(\ref{#1})}}
\fi
    


\newcommand{\NonNegativeReals}{\ensuremath{\mathbb{R}_{\ge 0}}}
\newcommand{\PositiveIntegers}{\ensuremath{\mathbb{Z^+}}}
\newcommand{\integers}{\ensuremath{\mathbb{Z}}}
\newcommand{\nats}{\ensuremath{\mathbb{N}}}
\newcommand{\reals}{\ensuremath{\mathbb{R}}}
\newcommand{\rationals}{\ensuremath{\mathbb{Q}}}
\newcommand{\distrib}[0]{\ensuremath{\mathcal{D}}}
\newcommand{\matroid}{\ensuremath{\mathcal{M}}}

\newcommand{\defref}[1]{Definition~\ref{#1}}
\newcommand{\tabref}[1]{Table~\ref{#1}}
\newcommand{\figref}[1]{Fig.~\ref{#1}}
\newcommand{\eqnref}[1]{\text{Eq.}~(\ref{#1})}
\newcommand{\secref}[1]{\S\ref{#1}}
\newcommand{\appref}[1]{Appendix~\ref{#1}}
\newcommand{\thmref}[1]{Theorem~\ref{#1}}
\newcommand{\corref}[1]{Corollary~\ref{#1}}
\newcommand{\propref}[1]{Proposition~\ref{#1}}
\newcommand{\lemref}[1]{Lemma~\ref{#1}}
\newcommand{\conref}[1]{Condition~\ref{#1}}
\newcommand{\assref}[1]{Assumption~\ref{#1}}
\newcommand{\egref}[1]{Example~\ref{#1}}
\newcommand{\algoref}[1]{Algorithm~\ref{#1}}


\newcommand{\op}[1]{\operatorname{#1}}
\newcommand{\paren} [1] {\ensuremath{ \left( {#1} \right) }}
\newcommand{\parenb} [1] {\ensuremath{ \big( {#1} \big) }}
\newcommand{\bigparen} [1] {\ensuremath{ \Big( {#1} \Big) }}
\newcommand{\biggparen} [1] {\ensuremath{ \bigg( {#1} \bigg) }}
\newcommand{\Biggparen} [1] {\ensuremath{ \Bigg( {#1} \Bigg) }}
\newcommand{\bracket}[1]{\left[#1\right]}
\newcommand{\tuple}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\curlybracket}[1]{\ensuremath{\left\{#1\right\}}}
\newcommand{\condcurlybracket}[2]{\ensuremath{\left\{#1\left\lvert\:#2\right.\right\}}}





\newtheorem{assumption}{Assumption} 
\newtheorem{conj}{Conjecture} 
\declaretheorem[name=Corollary]{cor} %
\declaretheorem[name=Lemma]{lem}
\declaretheorem[name=Remark]{rem}
\declaretheorem[name=Theorem]{thm}
\declaretheorem[name=Proposition]{prop}
\declaretheorem[name=Definition]{defn}
\declaretheorem[name=Assumption]{assump}
\declaretheorem[name=Example]{exmp}
\newenvironment{proof}{\emph{Proof:}}{\hfill$\square$}



\newcommand{\stochastic}{\textcolor{ForestGreen}{\textsc{stochastic}}}
\newcommand{\adversarial}{\textcolor{Maroon}{\textsc{adversarial}}}
\newcommand{\Cost}{C}

\newcommand{\numTotalPolicies}{m}


\newcommand{\bigO}{O}


\let\hat\widehat
\let\tilde\widetilde
\let\check\widecheck
\def\given{{\,|\,}}
\def\biggiven{{\,\big|\,}}
\def\Biggiven{{\,\Big|\,}}
\def\bigggiven{{\,\bigg|\,}}
\def\Bigggiven{{\,\Bigg|\,}}
\def\ds{\displaystyle}
\newcommand\wtilde{\stackrel{\sim}{\smash{\mathcal{W}}\rule{0pt}{1.1ex}}}
\newcommand{\indep}{\perp \!\!\! \perp}
\newcommand{\qqquad}{\quad\quad\quad}
\newcommand{\autoquad}[1]{\foreach \n in {1,...,#1}{\quad}}

\newcommand{\ab}{\mathbf{a}}
\newcommand{\bbb}{\mathbf{b}}
\newcommand{\cbb}{\mathbf{c}}
\newcommand{\db}{\mathbf{d}}
\newcommand{\eb}{\mathbf{e}}
\newcommand{\fb}{\mathbf{f}}
\newcommand{\gb}{\mathbf{g}}
\newcommand{\hb}{\mathbf{h}}
\newcommand{\ib}{\mathbf{i}}
\newcommand{\jb}{\mathbf{j}}
\newcommand{\kb}{\mathbf{k}}
\newcommand{\lb}{\mathbf{l}}
\newcommand{\mb}{\mathbf{m}}
\newcommand{\nbb}{\mathbf{n}}
\newcommand{\ob}{\mathbf{o}}
\newcommand{\pb}{\mathbf{p}}
\newcommand{\qb}{\mathbf{q}}
\newcommand{\rb}{\mathbf{r}}
\newcommand{\sbb}{\mathbf{s}}
\newcommand{\tb}{\mathbf{t}}
\newcommand{\ub}{\mathbf{u}}
\newcommand{\vb}{\mathbf{v}}
\newcommand{\wb}{\mathbf{w}}
\newcommand{\xb}{\mathbf{x}}
\newcommand{\yb}{\mathbf{y}}
\newcommand{\zb}{\mathbf{z}}

\newcommand{\ba}{\bm{a}}
\newcommand{\bb}{\bm{b}}
\newcommand{\bc}{\bm{c}}
\newcommand{\bd}{\bm{d}}
\newcommand{\be}{\bm{e}}
\newcommand{\bbf}{\bm{f}}
\newcommand{\bg}{\bm{g}}
\newcommand{\bh}{\bm{h}}
\newcommand{\bi}{\bmf{i}}
\newcommand{\bj}{\bm{j}}
\newcommand{\bk}{\bm{k}}
\newcommand{\bl}{\bm{l}}
\newcommand{\bbm}{\bm{m}}
\newcommand{\bn}{\bm{n}}
\newcommand{\bo}{\bm{o}}
\newcommand{\bp}{\bm{p}}
\newcommand{\bq}{\bm{q}}
\newcommand{\br}{\bm{r}}
\newcommand{\bs}{\bm{s}}
\newcommand{\bt}{\bm{t}}
\newcommand{\bu}{\bm{u}}
\newcommand{\bv}{\bm{v}}
\newcommand{\bw}{\bm{w}}
\newcommand{\bx}{\bm{x}}
\newcommand{\by}{\bm{y}}
\newcommand{\bz}{\bm{z}}




\newcommand{\Ab}{\mathbf{A}}
\newcommand{\Bb}{\mathbf{B}}
\newcommand{\Cb}{\mathbf{C}}
\newcommand{\Db}{\mathbf{D}}
\newcommand{\Eb}{\mathbf{E}}
\newcommand{\Fb}{\mathbf{F}}
\newcommand{\Gb}{\mathbf{G}}
\newcommand{\Hb}{\mathbf{H}}
\newcommand{\Ib}{\mathbf{I}}
\newcommand{\Jb}{\mathbf{J}}
\newcommand{\Kb}{\mathbf{K}}
\newcommand{\Lb}{\mathbf{L}}
\newcommand{\Mb}{\mathbf{M}}
\newcommand{\Nb}{\mathbf{N}}
\newcommand{\Ob}{\mathbf{O}}
\newcommand{\Pb}{\mathbf{P}}
\newcommand{\Qb}{\mathbf{Q}}
\newcommand{\Rb}{\mathbf{R}}
\newcommand{\Sbb}{\mathbf{S}}
\newcommand{\Tb}{\mathbf{T}}
\newcommand{\Ub}{\mathbf{U}}
\newcommand{\Vb}{\mathbf{V}}
\newcommand{\Wb}{\mathbf{W}}
\newcommand{\Xb}{\mathbf{X}}
\newcommand{\Yb}{\mathbf{Y}}
\newcommand{\Zb}{\mathbf{Z}}

\newcommand{\bA}{\bm{A}}
\newcommand{\bB}{\bm{B}}
\newcommand{\bC}{\bm{C}}
\newcommand{\bD}{\bm{D}}
\newcommand{\bE}{\bm{E}}
\newcommand{\bF}{\bm{F}}
\newcommand{\bG}{\bm{G}}
\newcommand{\bH}{\bm{H}}
\newcommand{\bI}{\bm{I}}
\newcommand{\bJ}{\bm{J}}
\newcommand{\bK}{\bm{K}}
\newcommand{\bL}{\bm{L}}
\newcommand{\bM}{\bm{M}}
\newcommand{\bN}{\bm{N}}
\newcommand{\bO}{\bm{O}}
\newcommand{\bP}{\bm{P}}
\newcommand{\bQ}{\bm{Q}}
\newcommand{\bR}{\bm{R}}
\newcommand{\bS}{\bm{S}}
\newcommand{\bT}{\bm{T}}
\newcommand{\bU}{\bm{U}}
\newcommand{\bV}{\bm{V}}
\newcommand{\bW}{\bm{W}}
\newcommand{\bX}{\bm{X}}
\newcommand{\bY}{\bm{Y}}
\newcommand{\bZ}{\bm{Z}}



\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{{\mathcal{S}}}
\newcommand{\cT}{{\mathcal{T}}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}





\newcommand{\CC}{\mathbb{C}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\VV}{\mathbb{V}}
\newcommand{\II}{\mathbb{I}}
\newcommand{\KK}{\mathbb{K}}
\newcommand{\LL}{\mathbb{L}}
\newcommand{\MM}{\mathbb{M}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\SSS}{\mathbb{S}}
\newcommand{\TT}{\mathbb{T}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\XX}{\mathbb{X}}
\newcommand{\YY}{\mathbb{Y}}
\newcommand{\OOmega}{\mathbb{\Omega}}


\newcommand{\sA}{\mathscr{A}}
\newcommand{\sB}{\mathscr{B}}
\newcommand{\sC}{\mathscr{C}}
\newcommand{\sD}{\mathscr{D}}
\newcommand{\sE}{\mathscr{E}}
\newcommand{\sF}{\mathscr{F}}
\newcommand{\sG}{\mathscr{G}}
\newcommand{\sH}{\mathscr{H}}
\newcommand{\sI}{\mathscr{I}}
\newcommand{\sJ}{\mathscr{J}}
\newcommand{\sK}{\mathscr{K}}
\newcommand{\sL}{\mathscr{L}}
\newcommand{\sM}{\mathscr{M}}
\newcommand{\sN}{\mathscr{N}}
\newcommand{\sO}{\mathscr{O}}
\newcommand{\sP}{\mathscr{P}}
\newcommand{\sQ}{\mathscr{Q}}
\newcommand{\sR}{\mathscr{R}}
\newcommand{\sS}{\mathscr{S}}
\newcommand{\sT}{\mathscr{T}}
\newcommand{\sU}{\mathscr{U}}
\newcommand{\sV}{\mathscr{V}}
\newcommand{\sW}{\mathscr{W}}
\newcommand{\sX}{\mathscr{X}}
\newcommand{\sY}{\mathscr{Y}}
\newcommand{\sZ}{\mathscr{Z}}


\newcommand{\balpha}{\bm{\alpha}}
\newcommand{\bbeta}{\bm{\beta}}
\newcommand{\bgamma}{\bm{\gamma}}
\newcommand{\bepsilon}{\bm{\epsilon}}
\newcommand{\bvarepsilon}{\bm{\varepsilon}}
\newcommand{\bzeta}{\bm{\zeta}}
\newcommand{\btheta}{\bm{\theta}}
\newcommand{\bvartheta}{\bm{\vartheta}}
\newcommand{\bkappa}{\bm{\kappa}}
\newcommand{\blambda}{\bm{\lambda}}
\newcommand{\bmu}{\bm{\mu}}
\newcommand{\bnu}{\bm{\nu}}
\newcommand{\bxi}{\bm{\xi}}
\newcommand{\bpi}{\bm{\pi}}
\newcommand{\bvarpi}{\bm{\varpi}}
\newcommand{\brho}{\bm{\varrho}}
\newcommand{\bsigma}{\bm{\sigma}}
\newcommand{\bvarsigma}{\bm{\varsigma}}
\newcommand{\btau}{\bm{\tau}}
\newcommand{\bupsilon}{\bm{\upsilon}}
\newcommand{\bphi}{\bm{\phi}}
\newcommand{\bvarphi}{\bm{\varphi}}
\newcommand{\bchi}{\bm{\chi}}
\newcommand{\bpsi}{\bm{\psi}}
\newcommand{\bomega}{\bm{\omega}}

\newcommand{\bGamma}{\bm{\Gamma}}
\newcommand{\bDelta}{\bm{\Delta}}
\newcommand{\bTheta}{\bm{\Theta}}
\newcommand{\bLambda}{\bm{\Lambda}}
\newcommand{\bXi}{\bm{\Xi}}
\newcommand{\bPi}{\bm{\Pi}}
\newcommand{\bSigma}{\bm{\Sigma}}
\newcommand{\bUpsilon}{\bm{\Upsilon}}
\newcommand{\bPhi}{\bm{\Phi}}
\newcommand{\bPsi}{\bm{\Psi}}
\newcommand{\bOmega}{\bm{\Omega}}



\newcommand{\minimize}{\mathop{\mathrm{minimize}}}

\newcommand{\sign}{\mathop{\mathrm{sign}}}
\newcommand{\autotrace}[1]{\mathop{\mathrm{Tr}\left[#1\right]}}
\newcommand{\trace}{\mathop{\mathrm{Tr}}}

\RequirePackage{dsfont}
\DeclareMathOperator{\Var}{{\rm Var}}
\DeclareMathOperator{\Cor}{\rm Corr}
\DeclareMathOperator{\Cov}{\rm Cov}
\DeclareMathOperator{\ind}{\mathds{1}}  %
\newcommand{\smallfrac}[2]{{\textstyle \frac{#1}{#2}}}

\newcommand*{\zero}{{\bm 0}}
\newcommand*{\one}{{\bm 1}}

\newcommand{\diag}{{\rm diag}}