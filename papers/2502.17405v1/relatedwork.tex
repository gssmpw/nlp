\section{Related work}
As far as we are aware, this work is unique in proposing methods to measure and set function-space learning rates in arbitrary neural networks far from initialisation, and using this approach to study the dynamics of optimizers.

There is an existing body of literature on hyperparameter transfer \citep[e.g.\ ][]{yang2022featurelearninginfinitewidthneural,bordelon2023depthwisehyperparametertransferresidual,large2024scalableoptimizationmodularnorm, yaida2022metaprincipledfamilyhyperparameterscaling}. Broadly speaking, these works analytically derive scaling laws for e.g.\ the initialisations and parameter-space learning rates, such that the function-space learning rates do not change as e.g.\ width is increased.
This is radically different from our approach to hyperparameter scaling.
In particular, none of these works provide a mechanism to empirically measure the function-space learning rates in an arbitrary neural network.
% At a high level, prior work takes the approach of theoretically deriving the scaling of the initialisation and learning rates necessary to give similar function-space learning rates for a small set of optimizers .
Furthermore, prior works tend to rely on rigid assumptions such as being close to a specific random initialisation, which we do not make.

Perhaps the earliest and best-known work on hyperparameter scaling is \textmu{}P \citep{yang2022featurelearninginfinitewidthneural}.
\textmu{}P derives how to scale random initialisations and learning rates as you increase model width, such that the function-space learning rates remain asymptotically constant (i.e.\ the magnitude of the activations does not blow up to infinity or shrink to zero as the model gets wider). \textmu{}P has since been extended to depth-scaling \citep{yang2023tensorprogramsvifeature,bordelon2023depthwisehyperparametertransferresidual} and networks trained with sharpness-aware minimisation \citep{haas2024boldsymbolmumathbfp2effectivesharpnessaware}, and is closely related to the mean-field analysis of neural networks grounded in statistical mechanics \citep{Mei_2018,Geiger_2020,bordelon2022selfconsistentdynamicalfieldtheory,Rotskoff_2022}.
Because this approach derives the function-space learning rates analytically, (in contrast to our approach of measuring them), it requires restrictive assumptions, including that the network is wide, and close to a random initialisation. Extending these results to more general cases is made complicated by the fact that they typically rely on heavy-duty mathematical machinery such as Tensor-Programs \citep{yang2021tensorprogramsiwide, yang2020tensorprogramsiineural, yang2021tensorprogramsiiineural, yang2022featurelearninginfinitewidthneural, yang2022tensorprogramsvtuning, yang2023tensorprogramsvifeature} or dynamical mean-field theory \citep{bordelon2022selfconsistentdynamicalfieldtheory, bordelon2023dynamicsfinitewidthkernel, bordelon2023depthwisehyperparametertransferresidual, bordelon2024infinitelimitsmultiheadtransformer}

The full \textmu{}P scheme can be complex to apply in practice, because it e.g.\ requires distinct treatment of the initialisation and learning rates for the embedding weights and output heads.
Later work \citep{large2024scalableoptimizationmodularnorm} sought to address this issue, by providing a library (Modula) of modules, such that when the modules are combined, the overall network naturally exhibits hyperparameter scaling. Rather than studying scaling asymptotically, Modula follows a metrisation-based approach \citep[for other metrisation works, see e.g.][]{yang2024spectralconditionfeaturelearning,bernstein2021distanceneuralnetworksstability, bernstein2024modulardualitydeeplearning, bernstein2024oldoptimizernewnorm}. Its carefully designed modules allow the computation of the network's Lipschitz constant, which can be used to normalise updates to enable hyperparameter scaling.
However, one important difficulty with Modula is that it requires setting the ``mass'' of each parameter.
This mass can be seen as analagous to the layerwise function-space learning rate in our work, for the first step of the optimiser (i.e.\ at initialisation).
This introduces a large number of new hyperparameters that must be tuned.
In contrast, our approach to hyperparameter transfer, \flerm{}, does not require the user to specify masses / function-space learning rates for each parameter, because it directly measures the function-space learning rates in a base model, and then uses them in a scaled model. We show in Section \ref{sec:experiments:flerm:naivecomparison} that using function-space learning rates measured directly from a base model leads to better training loss than simplistic user-defined function-space learning rates.
Furthermore, \flerm{} can be applied to any existing neural network in Pytorch, whereas Modula requires the user to rewrite their network architecture using the library's modules.

Finally, \citet{everett2024scalingexponentsparameterizationsoptimizers} recently evaluated the ``alignment" assumptions (concerning the size of dot products between activations and updates across different layers) made by \textmu{}P and mean-field parametrisations \citep{yang2022featurelearninginfinitewidthneural,Mei_2018,bordelon2022selfconsistentdynamicalfieldtheory}, and found that they are often violated in practice. They showed empirically that alignment in real models is highly dynamic and complex throughout training, meaning that static parametrisations like \textmu{}P and mean-field could be problematic.
By contrast, we propose methods that can directly measure the function-space learning rates throughout training, avoiding the need for such assumptions.