
\documentclass[twoside,11pt]{article}

\usepackage{blindtext}

\usepackage[preprint]{jmlr2e}

\newcommand{\dataset}{{\cal D}}
\newcommand{\fracpartial}[2]{\frac{\partial #1}{\partial  #2}}

\usepackage{lastpage}
% \jmlrheading{23}{2022}{1-\pageref{LastPage}}{1/21; Revised 5/22}{9/22}{21-0000}{Y. Montreuil, YS. Heng, A. Carlier, LN. Ng, WT Ooi}

\ShortHeadings{Adversarial Robustness in Two-Stage Learning-to-Defer: Algorithms and Guarantees}{Montreuil,  Carlier, Ng, Ooi}
\firstpageno{1}
%%%%
\renewcommand{\bibname}{References}
\renewcommand{\bibsection}{\subsubsection*{\bibname}}

% If you use BibTeX in apalike style, activate the following line:
% \bibliographystyle{apalike}

% \usepackage[hidelinks]{hyperref}
\usepackage{booktabs}
\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}
% \newtheorem{theorem}{Theorem}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{thmtools, thm-restate}
\newtheorem{assumption}{Assumption}
\newcommand{\Pm}{\mathbb{P}}
\newcommand{\mc}{\mathcal}
\newcommand{\mb}{\mathbb}
\newcommand{\EM}{\text{EM}}
\newcommand{\owt}[1]{\textcolor{blue}{#1}}
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argsup}{arg\,sup}
\DeclareMathOperator*{\arginf}{arg\,inf}
\let\emptyset\varnothing
\usepackage{appendix}
\usepackage{titletoc}
\usepackage{graphicx}
\newcommand\DoToC{%
  \startcontents
  \printcontents{}{2}{\textbf{Contents}\vskip3pt\hrule\vskip5pt}
  \vskip3pt\hrule\vskip5pt
}

% \usepackage{etoc}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                               PROOF, THEOREM, and FRIENDS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\BlackBox}{\rule{1.5ex}{1.5ex}}  % end of proof
\ifdefined\proof
    \renewenvironment{proof}{\par\noindent{\bf Proof\ }}{\hfill\BlackBox\\[2mm]}
\else
    \newenvironment{proof}{\par\noindent{\bf Proof\ }}{\hfill\BlackBox\\[2mm]}
\fi
\newtheorem{example}{Example} 
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma} 
\newtheorem{proposition}[theorem]{Proposition} 
\newtheorem{remark}[theorem]{Remark}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{axiom}[theorem]{Axiom}
\usepackage{mathtools}
%%%
\begin{document}

\title{Adversarial Robustness in Two-Stage Learning-to-Defer: Algorithms and Guarantees}

\author{\name Yannis Montreuil \email yannis.montreuil@u.nus.edu \\
       \addr School of Computing\\
       National University of Singapore\\
       Singapore, 118431, Singapore
       \AND
       \name Axel Carlier \email axel.carlier@toulouse-inp.fr \\
       \addr Institut de Recherche en Informatique de Toulouse \\
       Institut national polytechnique de Toulouse\\
       Toulouse, 31000, France 
       \AND
        \name Lai Xing Ng \email ng\_lai\_xing@i2r.a-star.edu.sg \\
       \addr Institute for Infocomm Research \\
       Agency for Science, Technology and Research\\
       Singapore, 138632, Singapore 
       \AND 
       \name Wei Tsang Ooi \email ooiwt@comp.nus.edu.sg \\
       \addr School of Computing\\
       National University of Singapore\\
       Singapore, 118431, Singapore}
\editor{My editor}
% \def\thefootnote{*}\footnotetext{These authors contributed equally to this work}\def\thefootnote{\arabic{footnote}}
\maketitle
\def\name{SARD}

\begin{abstract}
Learning-to-Defer (L2D) facilitates optimal task allocation between AI systems and decision-makers. Despite its potential, we show that current two-stage L2D frameworks are highly vulnerable to adversarial attacks, which can misdirect queries or overwhelm decision agents, significantly degrading system performance. This paper conducts the first comprehensive analysis of adversarial robustness in \emph{two-stage} L2D frameworks. We introduce two novel attack strategies—\emph{untargeted} and \emph{targeted}—that exploit inherent structural vulnerabilities in these systems. To mitigate these threats, we propose \name, a robust, convex, deferral algorithm rooted in Bayes and $(\mathcal{R},\mathcal{G})$-consistency. Our approach guarantees optimal task allocation under adversarial perturbations for all surrogates in the cross-entropy family. Extensive experiments on classification, regression, and multi-task benchmarks validate the robustness of \name{}.

\end{abstract}


\input{icml2024/Sections/Introduction}
\input{icml2024/Sections/Related_works}
\input{icml2024/Sections/Preliminaries}
\input{icml2024/Sections/Approach}
\input{icml2024/Sections/Experiments}
\input{icml2024/Sections/Conclusion}

% Two-Stage Learning-To-Defer for Multi-Task Learning

\bibliography{Main_paper.bib}
% \bibliographystyle{icml2025}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\input{icml2024/Sections/Appendix.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}


% This document was modified from the file originally made available by
% Pat Langley and Andrea Danyluk for ICML-2K. This version was created
% by Iain Murray in 2018, and modified by Alexandre Bouchard in
% 2019 and 2021 and by Csaba Szepesvari, Gang Niu and Sivan Sabato in 2022.
% Modified again in 2023 and 2024 by Sivan Sabato and Jonathan Scarlett.
% Previous contributors include Dan Roy, Lise Getoor and Tobias
% Scheffer, which was slightly modified from the 2010 version by
% Thorsten Joachims & Johannes Fuernkranz, slightly modified from the
% 2009 version by Kiri Wagstaff and Sam Roweis's 2008 version, which is
% slightly modified from Prasad Tadepalli's 2007 version which is a
% lightly changed version of the previous year's version by Andrew
% Moore, which was in turn edited from those of Kristian Kersting and
% Codrina Lauth. Alex Smola contributed to the algorithmic style files.
