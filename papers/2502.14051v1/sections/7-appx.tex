\newpage
\appendix
%\onecolumn

\section{Detailed Experiment Settings}
\label{sec:app_setting}
\subsection{Models}
We evaluate our methods on the three widely used long-context models: \llama ~\cite{metaai2024}, \mistral ~\cite{mistral2023}, and \longchat~\cite{longbench2023}. They are all decoder-only transformer models~\cite{attention2017}.  \llama and \mistral use GQA, while \longchat uses MHA in the attention module. In terms of sequence length, \llama supports a maximum sequence length of 128K while the other two support up to 32K sequence length. Prior work~\cite{quest2024,magicpig2024} usually skips the first two layers during KV cache compression to maintain accuracy. We found this is only necessary for \longchat; so, we conduct KV cache compression on all attention layers for \llama and \mistral but skip the first two layers for \longchat. 
\subsection{Benchmarks}
Our LongBench and Needle-in-a-Haystack settings are mostly following the prior work~\cite{kvcompression2024}. For LongBench, we set the maximum prompt length to 127,500 for \llama and 31,500 for \mistral and \longchat. Prompts beyond the maximum prompt length will be middle-truncated by keeping the first and last half of the input tokens. For Needle-in-a-Haystack, we evaluate with 10 different input sequence lengths uniformly spanning from 2048 to 81,920 words and 10 different depths for each sequence length in \llama. The maximum word count of 81,920 roughly converts to 109K tokens by the tokenizer in \llama. For the other two models, the input sequence lengths range from 512 to 20480 words since they support up to 32K sequence length, which convert up to ~30K and 31K tokens for \mistral and \longchat, respectively. For RULER, we mostly follow the configurations in the original benchmark except for reducing the number of examples per task from 500 to 50 to speed up the evaluation.

\subsection{Baselines}
Since \rocketkv primarily focuses on accelerating the decode phase of LLM inference, we do not perform any KV cache compression or sparse attention mechanism in the prefill phase across all comparing baselines including DuoAttention for fair comparison.


\textbf{Exact-TopK:}
Exact-TopK serves as an oracle method to demonstrate the effectiveness of \textit{top-k} sparse attention. We assume the \textit{top-k} KV tokens can be directly identified with no cost so a given token budget will directly correspond to its \textit{top-k} value. 
 
\textbf{DuoAttention:}
We set the initial and recent tokens to 128 and 512 respectively for streaming heads if the token budget is larger than 640, and vary the ratio of retrieval heads to match with the given token budget on average. If the token budget is lower than 640, all attention heads become streaming heads. In this case, we set the number of initial tokens for attention sink to 128 if the token budget is larger than 256, otherwise it is set to 20\% of the token budget. The rest of the token budget is assigned to recent tokens within the sliding window.

\textbf{SnapKV:}
We set the observation window size to 32 and kernel size for pooling to 7 following the SnapKV paper. Since SnapKV only compresses the KV cache of the input prompt, the token budget for the input prompt is calculated by deducting the number of maximum generated tokens from the total token budget. This budget is further divided by the number of heads per attention group in case of GQA as SnapKV performs on each attention head separately and the pruned KV cache is not shared within the attention group.

\textbf{Quest:}
We evenly split the token budget between approximate attention for identifying \textit{top-k} KV token indices and \textit{top-k} sparse attention so that the token budget can accurately reflect total memory fetching bandwidth required in the attention module. The original Quest method is not compatible with GQA. We modify it to select indices of \textit{top-k} accumulated attention scores per attention group rather than per attention head similar to our enhancement in SnapKV++.

\textbf{SparQ:}
Similar to Quest, we evenly split the token budget between approximate attention for identifying \textit{top-k} KV token indices and \textit{top-k} sparse attention.

\textbf{RocketKV:}
We evenly split the compression ratio between SnapKV++ in the first stage and hybrid attention in the second stage. For SnapKV++, we use an observation window size of 32 and adaptively select the kernel size for pooling between 63 and 511, depending on the input sequence length. For \llama, we use the kernel size of 63 if the input sequence length is shorter than 48K, otherwise 511 is used. For \longchat, the input sequence length threshold is 12K, and \mistral always selects a kernel size of 63. The adaptive selection policy is empirically determined based on our ablation study in Section~\ref{sec:ablation}. For hybrid attention, we evenly split the token budget between approximate attention for identifying \textit{top-k} indices and \textit{top-k} sparse attention.

\section{Detailed Results}
\label{sec:app_detail_results}

\subsection{Further Ablation Study}
\label{sec:app_detail_ablation}
This subsection presents additional results from the ablation studies discussed in the main paper. These results further enhance our observations in Section~\ref{sec:ablation}.



\begin{figure*}[!ht]
   \centering
   %\vspace{-3mm}
   \subfigure[\scriptsize \llama, SeqLen= 16K\label{fig:mgqa_ruler16000_llama318b}]{       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_16000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen=32K\label{fig:mgqa_ruler32000_llama318b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_32000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen=64K\label{fig:mgqa_ruler64000_llama318b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_64000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen=96K\label{fig:mgqa_ruler96000_llama318b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_96000_llama31_8b_instruct.pdf}
   }
   \subfigure[\scriptsize \mistral, SeqLen=8K\label{fig:mgqa_ruler8000_mistral7b}]{     \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_8000_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize \mistral, SeqLen=16K\label{fig:mgqa_ruler16000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_16000_mistral_7b_instruct_v02.pdf}
   }
   \subfigure[\scriptsize \mistral, SeqLen=24K\label{fig:mgqa_ruler24000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_24000_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize \mistral, SeqLen=32K\label{fig:mgqa_ruler32000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/mgqa/mgqa_ruler_32000_mistral_7b_instruct_v02.pdf}
   }
   %\vspace{-5mm}
   \caption{\ruler accuracy comparison between SnapKV and SnapKV with GQA enhancement.}
   \label{fig:mgqa_ruler}
   % \vspace{-4mm}
\end{figure*}


\begin{figure*}[!ht]
   \centering
   %\vspace{-3mm}
   \subfigure[\scriptsize LongBench, \llama \label{fig:r_LBAvg_llama31}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_LBAvg_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize LongBench, \mistral \label{fig:r_LBAvg_mistral7b}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_LBAvg_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize LongBench, \longchat \label{fig:r_LBAvg_longchat7b}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_NH_longchat_7b_v15_32k.pdf}
   }
   \hfill
   \subfigure[\scriptsize NIAH, \llama\label{fig:r_nh_llama31}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_NH_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize NIAH, \mistral \label{fig:r_nh_mistral7b}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_LBAvg_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize NIAH, \longchat \label{fig:r_nh_longchat7b}]{
       \includegraphics[width=0.31\textwidth]{plots/rocket/rocket_LBAvg_longchat_7b_v15_32k.pdf}
   }
   %\vspace{-5mm}
   \caption{Comparing \rocketkv with different kernel sizes (7, 63 and 511) under LongBench and \needle }
   \label{fig:r_longbench_nh}
   % \vspace{-4mm}
\end{figure*}





%hqs-ruler-llama
\begin{figure*}[!ht]
   \centering
   %\vspace{-3mm}
   \subfigure[\scriptsize \llama, SeqLen = 16K \label{fig:hqs_ruler16000_llama318b}]{       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_16000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen= 32K\label{fig:hqs_ruler32000_llama318b}]
   {
   \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_32000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen=64K\label{fig:hqs_ruler64000_llama318b}]{\includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_64000_llama31_8b_instruct.pdf}
   }
   \hfill
   \subfigure[\scriptsize \llama, SeqLen=96K\label{fig:hqs_ruler96000_llama318b}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_96000_llama31_8b_instruct.pdf}
   }
   \subfigure[\scriptsize \mistral, SeqLen=8K\label{fig:hqs_ruler8000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_8000_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize \mistral, SeqLen=16K\label{fig:hqs_ruler16000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_16000_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize \mistral, SeqLen=24K\label{fig:hqs_ruler24000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_24000_mistral_7b_instruct_v02.pdf}
   }
   \hfill
   \subfigure[\scriptsize \mistral, SeqLen=32K\label{fig:hqs_ruler32000_mistral7b}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_32000_mistral_7b_instruct_v02.pdf}
   }
   \subfigure[\scriptsize \longchat, SeqLen=8K\label{fig:hqs_ruler8000-longchat}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_8000_longchat_7b_v15_32k.pdf}
   }
   \hfill 
   \subfigure[\scriptsize \longchat, SeqLen=16K\label{fig:hqs
   _ruler16000_longchat}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_16000_longchat_7b_v15_32k.pdf}
   }
   \hfill 
   \subfigure[\scriptsize \longchat, SeqLen=24K\label{fig:hqs
   -ruler24000_longchat}]{
      \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_24000_longchat_7b_v15_32k.pdf}
   }
   \hfill 
   \subfigure[\scriptsize \longchat, SeqLen=32K\label{fig:hqs
   -ruler32000_longchat}]{
       \includegraphics[width=0.23\textwidth]{plots/hqs/hqs_ruler_32000_longchat_7b_v15_32k.pdf}
   }
   %\vspace{-5mm}
   \caption{accuracy comparison among Hybrid, Quest, and SparQ under \ruler with various sequence lengths}
   \label{fig:hqs_ruler}
   % \vspace{-4mm}
\end{figure*}
\clearpage
\subsection{\needle Visualization}
\label{sec:app_needle_vis}
Needle-in-a-haystack (NIAH) is a type of synthetic challenge designed to test how effectively an LLM can retrieve specific information in a large volume of text~\cite{needle2023}. In Figures~\ref{fig:nh_vis_llama318b},~\ref{fig:nh_vis_mistral7b}, ~\ref{fig:nh_vis_longchat}, the x-axis shows the document length (i.e., ''haystack''), while the y-axis marks the relative position of the ''needle'' (i.e., a short sentence) within the text. As the results show, \rocketkv can retrieve
the needle with almost the same accuracy as the Full-KV throughout the whole text across all three models with token budgets as low as 512, and only incurs small accuracy losses with a token budget of 256.



{
\renewcommand{\subfigcapskip}{1ex}% adjust as needed

\begin{figure*}[!ht]
    \centering
    \subfigure[Token Budget = 256 \label{fig:nh_vis_llama318b_256}]{
        \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_token256.pdf}
    }
    \hfill
    \subfigure[Token Budget =  512\label{fig:nh_vis_llama318b_512}]{
        \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_token512.pdf}
    }
    \hfill
    \subfigure[Token Budget = 1024 \label{fig:nh_vis_llama318b_1024}]{
        \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_token1024.pdf}
    }
    \hfill
    %\vspace{-1mm} 
    \subfigure[Token Budget = 2048\label{fig:nh_vis_llama318b_2048}]{
        \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_token2048.pdf}
    }
    \hfill
    \subfigure[Token Budget = 4096\label{fig:nh_vis_llama318b_4096}]{
        \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_token4096.pdf}
    }
     \hfill
    \subfigure[Full-KV\label{fig:nh_vis_llama318b_baseline}]{
    \includegraphics[width=0.31\textwidth]{plots/heatmap/result_vis_llama3.1-8b-instruct_tokenbaseline.pdf}
    }
     %\hfill
    %\vspace{-4mm}
    \caption{\needle visualization results of \rocketkv on \llama.}
    \label{fig:nh_vis_llama318b}
\end{figure*}












\begin{figure*}[!ht]
    \centering
    % First row with 3 figures
    \subfigure[Token Budget = 256 \label{fig:nh_mistral7b_256}]{    \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_token256.pdf}
    }
    \hfill
    \subfigure[Token Budget =  512\label{fig:nh_vis_mistral7b_512}]{
  \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_token512.pdf}
    }
    \hfill
    \subfigure[Token Budget = 1024 \label{fig:nh_vis_mistral1024}]{
        \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_token1024.pdf}
    }
     \hfill
    %\vspace{-2mm} 
    \subfigure[Token Budget = 2048\label{fig:nh_vis_mistral7b_2048}]{
     \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_token2048.pdf}
    }
    \hfill
    \subfigure[Token Budget = 4096\label{fig:nhvis__mistral7b_4096}]{
     \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_token4096.pdf}
    }
    \hfill
    \subfigure[Full-KV\label{fig:nhvis__mistral7b_baseline}]{
     \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_mistral-7b-instruct-v0.2_tokenbaseline.pdf}
    }
    \hfill
    %\vspace{-4mm}
    \caption{\needle visualization results of \rocketkv on \mistral.}
    \label{fig:nh_vis_mistral7b}
\end{figure*}








\begin{figure*}[!ht]
    \centering
    % First row with 3 figures
    \subfigure[Token Budget = 256 \label{fig:nh_vis_longchat_256}]{
      \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_token256.pdf}
    }
    \hfill
    \subfigure[Token Budget =  512\label{fig:nh_vis_longchat_512}]{
        \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_token512.pdf}
    }
    \hfill
    \subfigure[Token Budget = 1024 \label{fig:nh_vis_longchat_1024}]{
        \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_token1024.pdf}
    }
     \hfill
    %\vspace{-2mm}
    \subfigure[Token Budget = 2048\label{fig:nh_vis_longchat_2048}]{
        \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_token2048.pdf}
    }
    \hfill
    \subfigure[Token Budget = 4096\label{fig:nh_vis_longchat_4096}]{
     \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_token4096.pdf}
    }
     \hfill
    \subfigure[Full-KV\label{fig:nh_vis_longchat_baseline}]{
     \includegraphics[width=0.30\textwidth]{plots/heatmap/result_vis_longchat-7b-v1.5-32k_tokenbaseline.pdf}
    }
     \hfill
    %\vspace{-4mm}
    \caption{\needle visualization results of \rocketkv on \longchat.}
    \label{fig:nh_vis_longchat}
\end{figure*}

}
\clearpage




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Detailed Accuracy Results}
\label{sec:app_detail_acc}
In this section, we present 18 detailed tables that display the accuracy results discussed in previous sections. These tables offer additional information and insights into the results we captured.




%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table*}[!hb]
\centering
\caption{Average results of LongBench and NIAH for \llama}
\scalebox{0.85}{%
\begin{tabular}{llllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{Single QA}} & \rotatebox{45}{\textbf{Multi. QA}} & \rotatebox{45}{\textbf{Summ.}} & \rotatebox{45}{\textbf{Few-shot}} & \rotatebox{45}{\textbf{Synthetic}} & \rotatebox{45}{\textbf{Code}} & \rotatebox{45}{\textbf{LB Avg.}} & \rotatebox{45}{\textbf{NIAH(\%)}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 43.5 & 44.5 & 29.2 & 69.3 & 53.9 & 62.0 & 52.2 & 100.0 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 43.6 & 44.4 & 28.9 & 69.5 & 53.6 & 65.3 & 52.6 & 100.0 \\
 & DuoAttention & 24.4 & 33.5 & 18.2 & 39.0 & 51.2 & 60.1 & 37.6 & 20.0 \\
 & SnapKV & 12.3 & 35.8 & N/A & 30.8 & 53.5 & 54.4 & N/A & 0.0 \\
 & Quest & 16.0 & 14.0 & 14.3 & 14.4 & 4.0 & 41.4 & 17.8 & 10.7 \\
 & SparQ & 26.3 & 18.7 & 18.2 & 24.5 & 15.5 & 47.0 & 25.7 & 10.3 \\
 & Hybrid & 41.3 & 41.9 & \textbf{26.8} & 64.2 & 51.7 & 61.1 & 49.5 & 44.3 \\
 & RocketKV & \textbf{43.4} & \textbf{43.0} & 24.9 & \textbf{67.3} & \textbf{55.6} & \textbf{65.6} & \textbf{51.1} & \textbf{99.0} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 43.7 & 44.5 & 28.8 & 69.1 & 53.7 & 63.1 & 52.2 & 100.0 \\
 & DuoAttention & 27.7 & 34.9 & 21.6 & 47.4 & 51.5 & 61.7 & 41.2 & 21.0 \\
 & SnapKV & 33.9 & 41.0 & N/A & 50.4 & 53.3 & 59.7 & N/A & 99.0 \\
 & Quest & 27.9 & 27.7 & 19.8 & 38.0 & 43.5 & 52.6 & 35.1 & 18.0 \\
 & SparQ & 37.1 & 35.1 & 24.5 & 53.2 & 48.0 & 57.3 & 43.8 & 14.7 \\
 & Hybrid & 43.8 & 43.2 & \textbf{28.5} & 68.6 & 53.1 & 65.2 & 52.1 & 73.7 \\
 & RocketKV & \textbf{43.9} & \textbf{44.7} & 26.3 & \textbf{69.6} & \textbf{53.7} & \textbf{65.3} & \textbf{52.2} & \textbf{99.7} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 43.8 & 44.6 & 29.0 & 69.3 & 53.5 & 61.9 & 52.2 & 100.0 \\
 & DuoAttention & 31.8 & 36.4 & 23.7 & 54.8 & 53.3 & 64.2 & 44.5 & 26.3 \\
 & SnapKV & 36.2 & 41.8 & 21.5 & 57.9 & \textbf{54.8} & 60.6 & 46.2 & 99.7 \\
 & Quest & 36.5 & 37.5 & 24.8 & 54.9 & 50.9 & 57.3 & 45.0 & 37.3 \\
 & SparQ & 41.5 & 42.9 & 28.6 & 67.8 & 52.0 & 62.2 & 51.1 & 26.0 \\
 & Hybrid & \textbf{43.9} & \textbf{44.0} & \textbf{28.8} & \textbf{69.7} & 54.0 & 64.6 & \textbf{52.5} & 94.3 \\
 & RocketKV & 43.5 & \textbf{44.0} & 27.8 & 68.7 & 54.0 & \textbf{65.2} & 52.1 & \textbf{100.0} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 43.6 & 44.5 & 29.2 & 69.5 & 53.8 & 61.1 & 52.1 & 100.0 \\
 & DuoAttention & 39.3 & 40.9 & 25.4 & 64.5 & 52.2 & \textbf{64.8} & 49.2 & 28.3 \\
 & SnapKV & 40.1 & 42.7 & 24.1 & 63.3 & 53.3 & 63.4 & 49.1 & 99.7 \\
 & Quest & 42.5 & 43.0 & 28.4 & 65.5 & 52.3 & 59.8 & 50.5 & 64.3 \\
 & SparQ & 43.5 & 43.5 & \textbf{29.3} & \textbf{69.4} & 53.6 & 62.9 & 52.1 & 56.3 \\
 & Hybrid & 43.7 & 43.8 & 29.2 & \textbf{69.4} & 53.6 & 62.3 & \textbf{52.2} & \textbf{100.0} \\
 & RocketKV & \textbf{43.9} & \textbf{43.9} & 28.6 & 68.7 & \textbf{53.7} & 64.2 & \textbf{52.2} & \textbf{100.0} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 43.5 & 44.8 & 29.1 & 69.3 & 53.3 & 60.4 & 52.0 & 100.0 \\
 & DuoAttention & 42.4 & 41.7 & 27.5 & 68.9 & 53.2 & \textbf{63.9} & 51.2 & 36.7 \\
 & SnapKV & 42.5 & 44.0 & 26.1 & 67.4 & 53.1 & 63.2 & 51.0 & \textbf{100.0} \\
 & Quest & \textbf{43.9} & \textbf{44.3} & 28.9 & 69.0 & \textbf{53.5} & 60.0 & 51.9 & 94.3 \\
 & SparQ & 43.7 & 44.0 & \textbf{29.1} & 69.2 & 53.1 & 63.2 & \textbf{52.3} & 89.3 \\
 & Hybrid & \textbf{43.9} & 44.1 & \textbf{29.1} & 69.4 & \textbf{53.5} & 61.1 & 52.1 & \textbf{100.0} \\
 & RocketKV & 43.5 & 43.7 & 28.9 & \textbf{69.7} & \textbf{53.5} & 62.9 & 52.2 & \textbf{100.0} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Individual results of LongBench for \llama}
\scalebox{0.55}{%
\begin{tabular}{llllllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{narrativeqa}} & \rotatebox{45}{\textbf{qasper}} & \rotatebox{45}{\textbf{mul.fieldqa}} & \rotatebox{45}{\textbf{hotpotqa}} & \rotatebox{45}{\textbf{2wikimqa}} & \rotatebox{45}{\textbf{musique}} & \rotatebox{45}{\textbf{gov-report}} & \rotatebox{45}{\textbf{qmsum}} & \rotatebox{45}{\textbf{multi-news}} & \rotatebox{45}{\textbf{trec}} & \rotatebox{45}{\textbf{triviaqa}} & \rotatebox{45}{\textbf{samsum}} & \rotatebox{45}{\textbf{pass-ret.}} & \rotatebox{45}{\textbf{lcc}} & \rotatebox{45}{\textbf{repobench-p}} & \rotatebox{45}{\textbf{passagecnt}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 30.2 & 45.5 & 54.9 & 55.5 & 46.7 & 31.3 & 35.2 & 25.2 & 27.2 & 72.5 & 91.7 & 43.8 & 99.5 & 65.1 & 58.8 & 8.4 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 30.7 & 44.7 & 55.4 & 55.0 & 46.5 & 31.7 & 34.8 & 25.1 & 26.8 & 71.5 & 92.2 & 44.8 & 99.5 & 67.1 & 63.6 & 7.8 \\
 & DuoAttention & 19.4 & 22.8 & 31.1 & 42.3 & 35.9 & 22.4 & 16.9 & 20.6 & 17.2 & 20.0 & 57.4 & 39.7 & 98.0 & 61.2 & 59.1 & 4.5 \\
 & SnapKV & 0.0 & 0.0 & 36.8 & 47.5 & 37.8 & 22.2 & N/A & N/A & N/A & 17.5 & 75.0 & 0.0 & 99.0 & 55.8 & 53.0 & 8.0 \\
 & Quest & 3.0 & 22.4 & 22.6 & 14.9 & 23.2 & 4.1 & 9.8 & 12.7 & 20.5 & 11.5 & 17.3 & 14.4 & 7.5 & 49.5 & 33.3 & 0.5 \\
 & SparQ & 5.0 & 38.0 & 35.8 & 19.7 & 28.8 & 7.5 & 13.7 & 15.0 & 25.8 & 16.5 & 32.1 & 24.8 & 28.8 & 60.1 & 34.0 & 2.2 \\
 & Hybrid & 26.4 & \textbf{43.5} & 54.1 & 54.2 & 43.7 & 27.8 & \textbf{30.7} & 23.2 & \textbf{26.6} & 63.5 & 87.0 & 42.2 & 97.0 & 66.3 & 56.0 & 6.5 \\
 & RocketKV & \textbf{30.3} & \textbf{43.5} & \textbf{56.4} & \textbf{54.9} & \textbf{45.4} & \textbf{28.8} & 26.7 & \textbf{23.8} & 24.1 & \textbf{67.5} & \textbf{91.0} & \textbf{43.5} & \textbf{99.5} & \textbf{66.7} & \textbf{64.4} & \textbf{11.6} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 30.9 & 45.0 & 55.1 & 55.3 & 47.0 & 31.0 & 34.5 & 25.0 & 26.9 & 71.5 & 92.0 & 43.9 & 99.5 & 65.0 & 61.1 & 7.9 \\
 & DuoAttention & 23.0 & 25.0 & 35.1 & 44.8 & 36.4 & 23.6 & 22.3 & 20.2 & 22.4 & 34.5 & 65.9 & 41.7 & \textbf{99.5} & 63.0 & 60.4 & 3.5 \\
 & SnapKV & 25.6 & 28.2 & 47.8 & 52.9 & 43.0 & 27.2 & N/A & N/A & N/A & 27.0 & 85.3 & 38.8 & 97.5 & 60.7 & 58.7 & \textbf{9.2} \\
 & Quest & 9.0 & 36.5 & 38.2 & 32.2 & 36.4 & 14.4 & 16.1 & 17.7 & 25.6 & 35.2 & 51.2 & 27.5 & 82.0 & 59.7 & 45.4 & 5.0 \\
 & SparQ & 13.6 & \textbf{45.4} & 52.1 & 43.8 & 39.4 & 22.2 & 25.6 & 21.2 & 26.7 & 49.5 & 72.2 & 37.9 & 92.0 & 64.2 & 50.5 & 4.1 \\
 & Hybrid & \textbf{30.4} & 45.2 & 55.8 & 53.8 & 46.1 & 29.8 & \textbf{33.8} & \textbf{24.9} & \textbf{26.9} & 70.5 & 90.1 & \textbf{45.2} & 99.0 & \textbf{66.3} & 64.2 & 7.1 \\
 & RocketKV & \textbf{30.4} & 45.0 & \textbf{56.1} & \textbf{55.4} & \textbf{47.6} & \textbf{31.2} & 29.5 & 24.6 & 24.8 & \textbf{73.0} & \textbf{91.7} & 44.0 & \textbf{99.5} & 66.2 & \textbf{64.5} & 7.8 \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 30.8 & 45.5 & 55.0 & 54.7 & 48.0 & 31.1 & 34.7 & 25.1 & 27.1 & 72.5 & 91.5 & 43.8 & 99.5 & 64.2 & 59.6 & 7.5 \\
 & DuoAttention & 24.1 & 30.4 & 41.1 & 45.3 & 39.4 & 24.4 & 24.5 & 21.2 & 25.3 & 45.5 & 76.3 & 42.5 & 98.5 & \textbf{66.8} & 61.5 & 8.0 \\
 & SnapKV & 26.5 & 33.1 & 49.1 & 54.4 & 43.3 & 27.7 & 20.7 & 23.1 & 20.6 & 43.0 & 90.0 & 40.5 & \textbf{99.5} & 62.6 & 58.6 & \textbf{10.0} \\
 & Quest & 15.4 & 44.4 & 49.8 & 48.9 & 40.8 & 22.9 & 27.1 & 21.0 & 26.4 & 57.0 & 70.0 & 37.9 & 99.0 & 62.6 & 52.0 & 2.7 \\
 & SparQ & 23.1 & \textbf{46.1} & 55.1 & \textbf{54.7} & 42.9 & \textbf{31.2} & 34.0 & 24.9 & \textbf{27.0} & 69.5 & 89.9 & 44.0 & \textbf{99.5} & 65.0 & 59.3 & 4.5 \\
 & Hybrid & \textbf{31.1} & 45.3 & 55.3 & 54.2 & 46.5 & \textbf{31.2} & \textbf{34.6} & 24.9 & 26.9 & \textbf{72.5} & \textbf{92.1} & \textbf{44.5} & \textbf{99.5} & 66.3 & 62.9 & 8.5 \\
 & RocketKV & 30.1 & 44.4 & \textbf{56.2} & 54.6 & \textbf{47.0} & 30.5 & 32.0 & \textbf{25.2} & 26.2 & 71.0 & 91.8 & 43.2 & \textbf{99.5} & 66.6 & \textbf{63.8} & 8.4 \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 30.7 & 45.3 & 54.7 & 54.8 & 47.2 & 31.3 & 34.9 & 25.4 & 27.2 & 73.0 & 91.5 & 44.1 & 99.5 & 63.8 & 58.4 & 8.2 \\
 & DuoAttention & 25.6 & 42.3 & 50.0 & 52.3 & 42.1 & 28.1 & 27.5 & 22.1 & 26.6 & 66.0 & 84.9 & 42.8 & 98.5 & 66.1 & \textbf{63.6} & 6.0 \\
 & SnapKV & 28.5 & 39.1 & 52.7 & 53.4 & 46.5 & 28.4 & 24.6 & 23.9 & 23.7 & 55.5 & \textbf{91.7} & 42.6 & \textbf{99.5} & 65.5 & 61.3 & 7.2 \\
 & Quest & 28.0 & \textbf{45.5} & 54.2 & 54.3 & 44.7 & 29.8 & 33.1 & 24.9 & 27.2 & 68.5 & 84.5 & 43.4 & \textbf{99.5} & 63.2 & 56.5 & 5.1 \\
 & SparQ & 30.3 & 45.2 & 54.9 & 53.7 & 46.5 & 30.4 & \textbf{35.3} & 25.4 & 27.1 & \textbf{73.0} & 91.2 & 44.0 & \textbf{99.5} & 65.3 & 60.5 & 7.7 \\
 & Hybrid & 30.7 & 45.2 & 55.2 & 54.1 & 46.2 & \textbf{31.1} & 35.1 & 25.1 & \textbf{27.4} & \textbf{73.0} & 91.2 & \textbf{44.2} & \textbf{99.5} & 64.3 & 60.3 & 7.7 \\
 & RocketKV & \textbf{30.8} & 45.4 & \textbf{55.5} & \textbf{54.7} & \textbf{47.0} & 30.0 & 33.3 & \textbf{25.5} & 27.1 & 71.0 & 91.5 & 43.7 & \textbf{99.5} & \textbf{66.3} & 62.1 & \textbf{7.9} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 30.2 & 45.5 & 54.8 & 55.5 & 47.1 & 31.8 & 35.2 & 25.1 & 27.2 & 72.5 & 91.7 & 43.7 & 99.5 & 63.4 & 57.5 & 7.2 \\
 & DuoAttention & 26.5 & 45.1 & \textbf{55.5} & 55.0 & 43.3 & 26.7 & 31.9 & 23.7 & 27.0 & 73.5 & 89.9 & 43.3 & \textbf{99.5} & 65.5 & \textbf{62.3} & 7.0 \\
 & SnapKV & 29.4 & 44.2 & 53.9 & \textbf{55.8} & 46.0 & 30.1 & 28.2 & 24.3 & 25.7 & 67.0 & \textbf{92.0} & 43.1 & \textbf{99.5} & 65.1 & 61.2 & 6.8 \\
 & Quest & 30.7 & 45.5 & 55.4 & 55.6 & 46.0 & 31.3 & \textbf{34.9} & 24.8 & 27.1 & 72.0 & 90.9 & 44.0 & \textbf{99.5} & 63.3 & 56.8 & 7.4 \\
 & SparQ & 30.8 & 45.3 & 54.9 & 54.7 & \textbf{46.4} & 31.0 & \textbf{34.9} & 25.2 & 27.2 & 72.5 & 91.5 & 43.7 & \textbf{99.5} & 65.6 & 60.7 & 6.6 \\
 & Hybrid & \textbf{31.2} & \textbf{45.7} & 54.7 & 54.3 & \textbf{46.4} & \textbf{31.6} & \textbf{34.9} & \textbf{25.3} & 27.2 & 72.5 & 91.5 & \textbf{44.2} & \textbf{99.5} & 63.7 & 58.6 & \textbf{7.5} \\
 & RocketKV & 30.4 & 45.3 & 54.9 & 54.2 & \textbf{46.4} & 30.5 & 34.2 & \textbf{25.3} & \textbf{27.3} & \textbf{74.0} & 91.5 & 43.7 & \textbf{99.5} & \textbf{65.7} & 60.2 & \textbf{7.5} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=16000 for \llama}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.2 & 60.6 & 92.7 & 84.0 & 50.0 & 91.3 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 98.0 & 99.0 & 100.0 & 94.8 & 65.8 & 87.3 & 80.0 & 50.0 & 90.4 \\
 & DuoAttention & 0.0 & 2.0 & 2.0 & 2.0 & 0.0 & 0.0 & 6.0 & 5.0 & 1.6 & 2.8 & 67.3 & 42.0 & 28.0 & 12.2 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 62.0 & 42.0 & 8.0 \\
 & Quest & 2.0 & 4.0 & 0.0 & 12.0 & 0.0 & 0.0 & 1.0 & 2.5 & 0.0 & 0.6 & 33.3 & 6.0 & 8.0 & 5.3 \\
 & SparQ & 4.0 & 0.0 & 0.0 & 0.0 & 2.0 & 0.0 & 1.0 & 0.0 & 5.2 & 5.6 & 53.3 & 26.0 & 16.0 & 8.7 \\
 & Hybrid & \textbf{100.0} & 96.0 & 74.0 & 96.0 & 66.0 & 0.0 & 80.5 & 85.0 & 82.8 & 11.8 & 80.7 & 80.0 & 44.0 & 69.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{98.0} & \textbf{100.0} & \textbf{88.8} & \textbf{13.4} & \textbf{90.7} & \textbf{82.0} & \textbf{52.0} & \textbf{86.4} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 100.0 & 96.8 & 69.8 & 86.7 & 80.0 & 50.0 & 90.9 \\
 & DuoAttention & 2.0 & 2.0 & 4.0 & 2.0 & 4.0 & 0.0 & 6.0 & 5.0 & 3.2 & 0.4 & 90.0 & 42.0 & 20.0 & 13.9 \\
 & SnapKV & \textbf{100.0} & 60.0 & 0.0 & 34.0 & 26.0 & 0.0 & 2.0 & 2.5 & 3.6 & 0.0 & 53.3 & 68.0 & 40.0 & 30.0 \\
 & Quest & 98.0 & 74.0 & 0.0 & \textbf{100.0} & 26.0 & 0.0 & 22.0 & 16.0 & 60.4 & 4.0 & 52.7 & 34.0 & 22.0 & 39.2 \\
 & SparQ & 60.0 & 54.0 & 0.0 & 28.0 & 2.0 & 0.0 & 23.0 & 11.0 & 21.2 & 13.0 & 73.3 & 36.0 & 30.0 & 27.0 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & 98.0 & \textbf{100.0} & 90.0 & 66.0 & 95.0 & 99.5 & 90.4 & 24.0 & 88.7 & \textbf{82.0} & \textbf{52.0} & 83.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.5} & \textbf{100.0} & \textbf{93.6} & \textbf{27.4} & \textbf{93.3} & \textbf{82.0} & 50.0 & \textbf{88.1} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.5 & 100.0 & 98.8 & 71.4 & 89.3 & 80.0 & 50.0 & 91.5 \\
 & DuoAttention & 2.0 & 2.0 & 4.0 & 2.0 & 6.0 & 2.0 & 6.0 & 4.5 & 2.8 & 0.0 & 90.0 & 34.0 & 22.0 & 13.6 \\
 & SnapKV & \textbf{100.0} & 92.0 & 0.0 & 76.0 & 60.0 & 0.0 & 36.5 & 55.5 & 69.6 & 1.6 & 82.7 & 80.0 & 46.0 & 53.8 \\
 & Quest & 94.0 & \textbf{100.0} & 38.0 & \textbf{100.0} & 84.0 & 0.0 & 66.5 & 79.5 & 80.4 & 9.2 & 70.0 & 68.0 & 50.0 & 64.6 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 98.0 & 54.0 & 97.0 & 99.0 & 85.2 & \textbf{66.0} & 86.7 & \textbf{84.0} & \textbf{54.0} & 86.5 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 98.0 & 99.5 & \textbf{100.0} & 94.4 & 51.8 & 88.0 & 82.0 & 50.0 & 89.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{94.8} & 47.2 & \textbf{96.7} & 80.0 & \textbf{54.0} & \textbf{90.2} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.5 & 100.0 & 99.2 & 64.2 & 90.0 & 82.0 & 50.0 & 91.1 \\
 & DuoAttention & 4.0 & 20.0 & 6.0 & 20.0 & 24.0 & 4.0 & 6.0 & 8.0 & 2.4 & 2.6 & 89.3 & 52.0 & 34.0 & 20.9 \\
 & SnapKV & \textbf{100.0} & 96.0 & 0.0 & 92.0 & 84.0 & 2.0 & 59.0 & 82.0 & 92.0 & 11.6 & 87.3 & 76.0 & 48.0 & 63.8 \\
 & Quest & 94.0 & 96.0 & 60.0 & 98.0 & 92.0 & 28.0 & 91.5 & 90.5 & 80.8 & 19.8 & 86.7 & 80.0 & \textbf{50.0} & 74.4 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.2} & \textbf{77.2} & 88.0 & \textbf{82.0} & \textbf{50.0} & \textbf{92.0} \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 99.5 & \textbf{100.0} & 97.6 & 66.8 & 86.7 & 80.0 & \textbf{50.0} & 90.8 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 96.0 & 59.0 & \textbf{96.7} & 80.0 & \textbf{50.0} & 90.9 \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 98.5 & 100.0 & 99.2 & 57.4 & 90.7 & 84.0 & 50.0 & 90.8 \\
 & DuoAttention & 20.0 & 88.0 & 86.0 & 98.0 & \textbf{100.0} & 46.0 & 71.5 & 77.0 & 58.0 & 14.2 & 88.0 & \textbf{82.0} & 52.0 & 67.7 \\
 & SnapKV & \textbf{100.0} & 98.0 & 12.0 & 96.0 & 96.0 & 6.0 & 75.5 & 94.0 & 94.8 & 22.8 & 92.0 & 78.0 & \textbf{54.0} & 70.7 \\
 & Quest & \textbf{100.0} & 94.0 & 96.0 & \textbf{100.0} & 96.0 & 98.0 & 98.0 & 98.0 & 98.8 & 54.6 & 88.0 & \textbf{82.0} & 50.0 & 88.7 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.2} & 75.2 & 92.0 & \textbf{82.0} & 50.0 & 92.2 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.2} & \textbf{77.0} & 91.3 & \textbf{82.0} & 50.0 & \textbf{92.3} \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.2} & 59.6 & \textbf{94.7} & \textbf{82.0} & 50.0 & 91.2 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=32000 for \llama}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 99.5 & 96.4 & 6.0 & 94.0 & 74.0 & 54.0 & 86.4 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 90.0 & 99.0 & 99.5 & 91.6 & 24.6 & 81.3 & 76.0 & 54.0 & 85.8 \\
 & DuoAttention & 0.0 & 4.0 & 4.0 & 4.0 & 2.0 & 0.0 & 4.5 & 4.5 & 2.4 & 1.0 & 52.0 & 38.0 & 32.0 & 11.4 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 46.0 & 44.0 & 6.9 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{1.2} & 22.0 & 0.0 & 0.0 & 1.8 \\
 & SparQ & 44.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.8 & 0.4 & 18.7 & 4.0 & 8.0 & 6.0 \\
 & Hybrid & 98.0 & 96.0 & 38.0 & 94.0 & 16.0 & 0.0 & 52.0 & 57.5 & 70.4 & 0.4 & 48.0 & 62.0 & 38.0 & 51.6 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{94.0} & \textbf{95.5} & \textbf{97.5} & \textbf{83.6} & 1.0 & \textbf{73.3} & \textbf{82.0} & \textbf{54.0} & \textbf{83.1} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 99.0 & 90.8 & 17.2 & 82.0 & 78.0 & 52.0 & 86.0 \\
 & DuoAttention & 0.0 & 4.0 & 8.0 & 4.0 & 2.0 & 0.0 & 4.5 & 4.5 & 3.6 & 0.0 & 70.7 & 40.0 & 30.0 & 13.2 \\
 & SnapKV & \textbf{100.0} & 72.0 & 0.0 & 22.0 & 28.0 & 0.0 & 3.0 & 1.0 & 3.2 & 0.0 & 21.3 & 68.0 & 44.0 & 27.9 \\
 & Quest & \textbf{100.0} & 26.0 & 16.0 & 4.0 & 2.0 & 0.0 & 1.5 & 1.5 & 7.2 & 1.2 & 45.3 & 10.0 & 16.0 & 17.7 \\
 & SparQ & 62.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.5 & 0.5 & 3.2 & 1.6 & 26.7 & 24.0 & 26.0 & 11.1 \\
 & Hybrid & \textbf{100.0} & 96.0 & 90.0 & \textbf{100.0} & 72.0 & 6.0 & 89.0 & 96.0 & 83.2 & 1.2 & 60.7 & \textbf{80.0} & \textbf{52.0} & 71.2 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{97.0} & \textbf{99.5} & \textbf{89.2} & \textbf{5.4} & \textbf{81.3} & \textbf{80.0} & \textbf{52.0} & \textbf{85.0} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 98.5 & 91.6 & 10.6 & 87.3 & 74.0 & 52.0 & 85.6 \\
 & DuoAttention & 0.0 & 4.0 & 8.0 & 4.0 & 2.0 & 0.0 & 4.5 & 4.0 & 4.0 & 0.0 & 71.3 & 42.0 & 34.0 & 13.7 \\
 & SnapKV & \textbf{100.0} & 88.0 & 0.0 & 74.0 & 58.0 & 0.0 & 33.5 & 61.0 & 65.2 & 0.4 & 56.0 & 68.0 & 50.0 & 50.3 \\
 & Quest & 90.0 & 78.0 & 18.0 & 76.0 & 46.0 & 0.0 & 34.0 & 31.0 & 38.8 & 1.0 & 50.0 & 20.0 & 22.0 & 38.8 \\
 & SparQ & 84.0 & 54.0 & 0.0 & 46.0 & 8.0 & 0.0 & 27.0 & 23.0 & 21.6 & 4.2 & 53.3 & 44.0 & 38.0 & 31.0 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 82.0 & 97.5 & 99.5 & 88.0 & 6.0 & 72.7 & \textbf{80.0} & \textbf{58.0} & 83.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & \textbf{91.6} & \textbf{8.0} & \textbf{80.0} & 78.0 & 54.0 & \textbf{85.4} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 98.5 & 95.6 & 7.0 & 90.7 & 74.0 & 54.0 & 86.1 \\
 & DuoAttention & 0.0 & 4.0 & 8.0 & 6.0 & 8.0 & 0.0 & 4.5 & 3.5 & 3.2 & 0.0 & 72.0 & 40.0 & 36.0 & 14.2 \\
 & SnapKV & \textbf{100.0} & 96.0 & 0.0 & 90.0 & 70.0 & 0.0 & 67.0 & 84.0 & 85.6 & 5.8 & 58.7 & 66.0 & 48.0 & 59.3 \\
 & Quest & 86.0 & \textbf{100.0} & 6.0 & 86.0 & 76.0 & 0.0 & 43.5 & 66.0 & 54.4 & 2.2 & 68.0 & 60.0 & 42.0 & 53.1 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & 98.0 & 98.0 & 96.0 & 36.0 & 98.0 & 98.0 & 82.0 & \textbf{34.2} & 74.7 & \textbf{76.0} & \textbf{58.0} & 80.7 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 99.0 & 99.0 & 92.0 & 14.6 & 76.7 & \textbf{76.0} & 56.0 & 85.6 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.5} & \textbf{100.0} & \textbf{93.2} & 18.2 & \textbf{82.0} & \textbf{76.0} & 52.0 & \textbf{86.2} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 99.0 & 98.5 & 96.8 & 7.0 & 93.3 & 74.0 & 54.0 & 86.4 \\
 & DuoAttention & 4.0 & 26.0 & 14.0 & 36.0 & 16.0 & 2.0 & 5.5 & 10.5 & 3.2 & 0.0 & 76.7 & 50.0 & 48.0 & 22.5 \\
 & SnapKV & \textbf{100.0} & 96.0 & 14.0 & 98.0 & 80.0 & 2.0 & 76.0 & 93.5 & 88.8 & 9.2 & 68.7 & 74.0 & \textbf{54.0} & 65.7 \\
 & Quest & 82.0 & \textbf{100.0} & 70.0 & 90.0 & 92.0 & 38.0 & 87.0 & 87.5 & 88.4 & 5.6 & 78.7 & \textbf{78.0} & 52.0 & 73.0 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 99.5 & \textbf{99.0} & \textbf{95.2} & \textbf{20.6} & 86.7 & 74.0 & 52.0 & \textbf{86.7} \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 99.5 & \textbf{99.0} & 93.2 & 19.8 & 79.3 & 74.0 & 52.0 & 85.9 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{99.0} & 93.6 & 15.8 & \textbf{90.0} & 76.0 & 52.0 & 86.6 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=64000 for \llama}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 95.5 & 97.5 & 94.8 & 0.0 & 83.3 & 76.0 & 56.0 & 84.9 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 58.0 & 94.5 & 97.5 & 93.6 & 0.4 & 63.3 & 72.0 & 56.0 & 79.6 \\
 & DuoAttention & 0.0 & 2.0 & 0.0 & 8.0 & 0.0 & 0.0 & 5.0 & 3.0 & 0.0 & \textbf{0.4} & \textbf{84.0} & 44.0 & 32.0 & 13.7 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 52.0 & 32.0 & 6.5 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{0.4} & 25.3 & 0.0 & 2.0 & 2.1 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
 & Hybrid & \textbf{100.0} & 24.0 & 0.0 & 28.0 & 2.0 & 0.0 & 4.5 & 6.0 & 48.8 & 0.2 & 22.7 & 36.0 & 24.0 & 22.8 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{92.0} & \textbf{84.0} & \textbf{83.5} & \textbf{94.0} & \textbf{79.6} & 0.0 & 78.7 & \textbf{70.0} & \textbf{48.0} & \textbf{79.2} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 80.0 & 98.0 & 98.0 & 92.8 & 0.4 & 67.3 & 76.0 & 54.0 & 82.0 \\
 & DuoAttention & 0.0 & 2.0 & 0.0 & 8.0 & 0.0 & 0.0 & 5.0 & 3.5 & 0.4 & 0.8 & \textbf{96.0} & 38.0 & 28.0 & 14.0 \\
 & SnapKV & \textbf{100.0} & 60.0 & 0.0 & 28.0 & 12.0 & 0.0 & 1.0 & 0.0 & 3.2 & 0.0 & 20.0 & 62.0 & 48.0 & 25.7 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.5 & 0.0 & 0.4 & 34.7 & 4.0 & 6.0 & 3.5 \\
 & SparQ & 20.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.0 & \textbf{1.0} & 15.3 & 4.0 & 14.0 & 4.3 \\
 & Hybrid & \textbf{100.0} & 92.0 & 26.0 & 82.0 & 22.0 & 0.0 & 52.5 & 71.5 & 74.8 & 0.2 & 56.7 & 62.0 & 46.0 & 52.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{96.0} & \textbf{91.0} & \textbf{95.5} & \textbf{86.8} & 0.0 & 76.7 & \textbf{68.0} & \textbf{52.0} & \textbf{81.7} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 96.0 & 98.5 & 98.5 & 93.6 & 0.2 & 74.7 & 74.0 & 54.0 & 83.8 \\
 & DuoAttention & 0.0 & 2.0 & 0.0 & 8.0 & 0.0 & 2.0 & 5.0 & 3.5 & 0.4 & \textbf{0.8} & \textbf{96.0} & 40.0 & 30.0 & 14.4 \\
 & SnapKV & \textbf{100.0} & 82.0 & 0.0 & 76.0 & 40.0 & 0.0 & 22.0 & 35.0 & 55.2 & 0.0 & 58.0 & 62.0 & 50.0 & 44.6 \\
 & Quest & \textbf{100.0} & 32.0 & 10.0 & 24.0 & 2.0 & 0.0 & 1.5 & 6.0 & 35.6 & 0.4 & 49.3 & 12.0 & 12.0 & 21.9 \\
 & SparQ & 48.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.0 & 0.5 & 0.0 & 12.4 & \textbf{0.8} & 18.7 & 20.0 & 24.0 & 9.7 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 70.0 & 2.0 & \textbf{92.0} & \textbf{98.0} & 84.4 & 0.2 & 70.0 & \textbf{72.0} & \textbf{54.0} & 72.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{100.0} & \textbf{92.0} & \textbf{98.0} & \textbf{87.2} & 0.0 & 78.7 & \textbf{72.0} & \textbf{54.0} & \textbf{82.9} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 98.0 & 97.0 & 99.0 & 94.0 & 0.0 & 78.7 & 74.0 & 52.0 & 84.1 \\
 & DuoAttention & 0.0 & 2.0 & 0.0 & 8.0 & 0.0 & 2.0 & 5.0 & 3.5 & 0.4 & 0.8 & \textbf{94.0} & 44.0 & 28.0 & 14.4 \\
 & SnapKV & \textbf{100.0} & 82.0 & 4.0 & 98.0 & 52.0 & 0.0 & 50.5 & 72.0 & 82.0 & 0.4 & 60.0 & 70.0 & 50.0 & 55.5 \\
 & Quest & \textbf{100.0} & 78.0 & 70.0 & 88.0 & 48.0 & 0.0 & 19.5 & 39.5 & 76.8 & 0.0 & 63.3 & 38.0 & 38.0 & 50.7 \\
 & SparQ & 98.0 & 46.0 & 0.0 & 54.0 & 10.0 & 0.0 & 31.0 & 27.0 & 41.2 & \textbf{5.6} & 52.0 & 36.0 & 36.0 & 33.6 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & 98.0 & \textbf{100.0} & \textbf{96.0} & 54.0 & \textbf{96.0} & 99.0 & 85.6 & 0.8 & 68.7 & \textbf{78.0} & \textbf{56.0} & 79.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{100.0} & 93.5 & \textbf{99.5} & \textbf{89.2} & 0.0 & 82.7 & 74.0 & 54.0 & \textbf{83.8} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 100.0 & 96.5 & 99.0 & 95.6 & 0.0 & 80.0 & 76.0 & 52.0 & 84.5 \\
 & DuoAttention & 0.0 & 4.0 & 0.0 & 8.0 & 0.0 & 2.0 & 4.5 & 3.5 & 0.4 & 0.8 & \textbf{91.3} & 44.0 & 32.0 & 14.7 \\
 & SnapKV & \textbf{100.0} & 84.0 & 14.0 & 98.0 & 54.0 & 2.0 & 71.0 & 88.0 & 91.2 & 1.2 & 60.0 & \textbf{76.0} & 50.0 & 60.7 \\
 & Quest & \textbf{100.0} & 76.0 & 20.0 & \textbf{100.0} & 76.0 & 0.0 & 48.0 & 77.5 & 78.8 & 0.0 & 72.0 & \textbf{76.0} & 52.0 & 59.7 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 94.0 & 32.0 & 94.0 & 96.5 & 86.4 & \textbf{2.4} & 73.3 & 70.0 & 52.0 & 77.0 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 96.0 & 96.5 & 98.0 & 90.8 & 0.2 & 70.0 & \textbf{76.0} & \textbf{56.0} & 83.2 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & \textbf{98.0} & \textbf{99.5} & \textbf{92.4} & 0.0 & 84.0 & 74.0 & \textbf{56.0} & \textbf{84.8} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=96000 for \llama}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 100.0 & 94.0 & 88.0 & 98.5 & 100.0 & 66.8 & 0.0 & 74.7 & 78.0 & 50.0 & 80.8 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 84.0 & 14.0 & 95.5 & 99.0 & 67.2 & 0.4 & 56.0 & 82.0 & 50.0 & 72.9 \\
 & DuoAttention & 0.0 & 2.0 & 4.0 & 6.0 & 0.0 & \textbf{0.0} & 3.5 & 5.0 & 1.6 & 0.0 & 38.7 & 40.0 & 32.0 & 10.2 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{0.0} & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 50.0 & 34.0 & 6.5 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{0.0} & 0.0 & 0.0 & 0.0 & \textbf{0.6} & 19.3 & 0.0 & 2.0 & 1.7 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{0.0} & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
 & Hybrid & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & \textbf{0.0} & 0.0 & 0.0 & 4.8 & 0.0 & 11.3 & 4.0 & 4.0 & 1.9 \\
 & RocketKV & \textbf{100.0} & \textbf{98.0} & \textbf{56.0} & \textbf{94.0} & \textbf{66.0} & \textbf{0.0} & \textbf{47.5} & \textbf{54.5} & \textbf{53.6} & 0.0 & \textbf{51.3} & \textbf{80.0} & \textbf{46.0} & \textbf{57.5} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 84.0 & 32.0 & 96.5 & 100.0 & 67.6 & 0.4 & 59.3 & 80.0 & 50.0 & 74.6 \\
 & DuoAttention & 0.0 & 2.0 & 6.0 & 6.0 & 0.0 & 0.0 & 3.5 & 5.5 & 1.6 & 0.0 & \textbf{70.0} & 38.0 & 32.0 & 12.7 \\
 & SnapKV & 90.0 & 50.0 & 0.0 & 30.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.8 & 0.0 & 22.7 & 60.0 & 38.0 & 22.4 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 26.0 & 0.0 & 4.0 & 2.3 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
 & Hybrid & 94.0 & 46.0 & 0.0 & 18.0 & 0.0 & 0.0 & 4.0 & 7.5 & 42.0 & \textbf{0.6} & 28.0 & 20.0 & 16.0 & 21.2 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{100.0} & \textbf{80.0} & \textbf{6.0} & \textbf{89.0} & \textbf{95.0} & \textbf{58.4} & 0.0 & 56.7 & \textbf{78.0} & \textbf{44.0} & \textbf{69.5} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 90.0 & 58.0 & 96.0 & 100.0 & 68.4 & 0.0 & 61.3 & 80.0 & 48.0 & 77.1 \\
 & DuoAttention & 0.0 & 2.0 & 6.0 & 6.0 & 0.0 & 0.0 & 3.5 & 5.5 & 1.6 & 0.0 & \textbf{70.7} & 40.0 & 32.0 & 12.9 \\
 & SnapKV & \textbf{100.0} & 78.0 & 0.0 & 62.0 & 14.0 & 0.0 & 5.0 & 12.0 & 32.8 & 0.0 & 33.3 & 58.0 & 40.0 & 33.5 \\
 & Quest & 94.0 & 0.0 & 0.0 & 10.0 & 0.0 & 0.0 & 2.5 & 2.5 & 0.4 & 0.2 & 58.0 & 2.0 & 8.0 & 13.7 \\
 & SparQ & 36.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.2 & 0.6 & 15.3 & 2.0 & 0.0 & 4.2 \\
 & Hybrid & \textbf{100.0} & 88.0 & 2.0 & 84.0 & 12.0 & 0.0 & 61.5 & 72.0 & \textbf{66.0} & \textbf{1.2} & 43.3 & 58.0 & 42.0 & 48.5 \\
 & RocketKV & 98.0 & \textbf{100.0} & \textbf{96.0} & \textbf{100.0} & \textbf{88.0} & \textbf{72.0} & \textbf{93.5} & \textbf{98.5} & 63.6 & 0.0 & 56.0 & \textbf{76.0} & \textbf{50.0} & \textbf{76.3} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 92.0 & 82.0 & 95.5 & 100.0 & 64.4 & 0.0 & 66.7 & 80.0 & 48.0 & 79.1 \\
 & DuoAttention & 0.0 & 2.0 & 6.0 & 6.0 & 0.0 & 0.0 & 3.5 & 5.0 & 1.6 & 0.0 & \textbf{70.7} & 44.0 & 28.0 & 12.8 \\
 & SnapKV & \textbf{100.0} & 94.0 & 0.0 & 88.0 & 20.0 & 0.0 & 28.5 & 47.0 & 50.4 & \textbf{0.4} & 40.0 & 66.0 & 42.0 & 44.3 \\
 & Quest & \textbf{100.0} & 56.0 & 0.0 & 62.0 & 4.0 & 0.0 & 11.5 & 9.5 & 54.0 & 0.2 & 59.3 & 32.0 & 22.0 & 31.6 \\
 & SparQ & 12.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.0 & 3.6 & 0.2 & 32.7 & 8.0 & 14.0 & 5.6 \\
 & Hybrid & \textbf{100.0} & 96.0 & 74.0 & 98.0 & 54.0 & 0.0 & 89.0 & 96.5 & \textbf{77.2} & \textbf{0.4} & 52.0 & \textbf{78.0} & \textbf{48.0} & 66.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{88.0} & \textbf{84.0} & \textbf{96.0} & \textbf{99.5} & 65.6 & 0.0 & 56.7 & 76.0 & \textbf{48.0} & \textbf{78.0} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 100.0 & 96.0 & 88.0 & 96.5 & 100.0 & 65.6 & 0.0 & 71.3 & 78.0 & 46.0 & 80.1 \\
 & DuoAttention & 0.0 & 2.0 & 6.0 & 8.0 & 0.0 & 0.0 & 3.5 & 5.0 & 1.2 & 0.0 & \textbf{72.0} & 44.0 & 32.0 & 13.4 \\
 & SnapKV & \textbf{100.0} & \textbf{100.0} & 0.0 & 96.0 & 36.0 & 0.0 & 50.5 & 75.5 & 62.8 & 0.2 & 49.3 & 74.0 & 42.0 & 52.8 \\
 & Quest & 98.0 & \textbf{100.0} & 0.0 & 94.0 & 36.0 & 2.0 & 40.5 & 63.0 & 45.2 & 0.0 & 58.7 & 36.0 & 36.0 & 46.9 \\
 & SparQ & \textbf{100.0} & 62.0 & 2.0 & 60.0 & 12.0 & 0.0 & 68.5 & 62.5 & 46.0 & \textbf{0.4} & 46.7 & 48.0 & 42.0 & 42.3 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & 98.0 & \textbf{100.0} & \textbf{88.0} & 16.0 & 96.5 & 99.0 & \textbf{70.4} & 0.2 & 54.7 & \textbf{76.0} & \textbf{48.0} & 72.8 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{88.0} & \textbf{88.0} & \textbf{97.0} & \textbf{99.5} & 69.2 & 0.0 & 58.7 & \textbf{76.0} & \textbf{48.0} & \textbf{78.8} \\
\hline
\end{tabular}
}
\end{table*}







%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%

\begin{table*}[t]
\centering
\caption{Average results of LongBench and NIAH for \mistral}
\scalebox{0.85}{%
\begin{tabular}{llllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{Single QA}} & \rotatebox{45}{\textbf{Multi. QA}} & \rotatebox{45}{\textbf{Summ.}} & \rotatebox{45}{\textbf{Few-shot}} & \rotatebox{45}{\textbf{Synthetic}} & \rotatebox{45}{\textbf{Code}} & \rotatebox{45}{\textbf{LB Avg.}} & \rotatebox{45}{\textbf{NIAH(\%)}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 36.4 & 29.6 & 28.1 & 66.7 & 44.9 & 55.6 & 45.4 & 99.0 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 35.5 & 28.6 & 28.2 & 67.6 & 42.6 & 58.2 & 45.3 & 98.7 \\
 & DuoAttention & 17.7 & 19.6 & 18.5 & 48.5 & 5.2 & 52.3 & 28.3 & 22.0 \\
 & SnapKV & 11.2 & 19.8 & N/A & 33.8 & 20.9 & 47.7 & N/A & 2.3 \\
 & Quest & 8.7 & 5.3 & 15.3 & 12.6 & 3.2 & 32.6 & 13.1 & 14.0 \\
 & SparQ & 1.6 & 0.9 & 8.6 & 2.5 & 6.4 & 26.0 & 7.0 & 10.0 \\
 & Hybrid & 29.7 & 21.9 & \textbf{25.5} & 58.5 & 25.0 & 50.9 & 37.0 & 56.7 \\
 & RocketKV & \textbf{34.4} & \textbf{26.8} & 24.6 & \textbf{65.6} & \textbf{38.5} & \textbf{57.8} & \textbf{42.9} & \textbf{97.7} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 35.8 & 29.2 & 28.2 & 67.1 & 42.9 & 57.4 & 45.3 & 99.3 \\
 & DuoAttention & 19.8 & 19.2 & 21.1 & 53.9 & 7.1 & 53.8 & 30.8 & 24.0 \\
 & SnapKV & 25.1 & 22.8 & N/A & 53.2 & 35.2 & 53.3 & N/A & 39.3 \\
 & Quest & 17.4 & 12.3 & 22.4 & 35.8 & 23.0 & 44.8 & 26.4 & 39.7 \\
 & SparQ & 5.1 & 1.7 & 13.0 & 8.2 & 2.3 & 35.3 & 10.6 & 11.7 \\
 & Hybrid & 34.2 & 27.4 & \textbf{27.2} & 65.9 & 38.3 & 57.2 & 43.5 & 85.7 \\
 & RocketKV & \textbf{35.3} & \textbf{27.9} & 25.8 & \textbf{66.6} & \textbf{41.2} & \textbf{57.9} & \textbf{44.1} & \textbf{98.7} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 35.8 & 29.5 & 28.2 & 67.0 & 42.8 & 56.7 & 45.2 & 99.3 \\
 & DuoAttention & 21.2 & 19.4 & 22.4 & 59.1 & 8.1 & 55.0 & 32.6 & 30.0 \\
 & SnapKV & 29.2 & 25.3 & 20.7 & 59.6 & 42.1 & 56.2 & 39.9 & 53.3 \\
 & Quest & 25.4 & 18.6 & 25.5 & 56.2 & 36.3 & 53.3 & 36.9 & 79.3 \\
 & SparQ & 13.1 & 4.1 & 16.9 & 18.1 & 0.5 & 43.5 & 16.3 & 20.0 \\
 & Hybrid & 35.3 & 28.0 & \textbf{27.7} & \textbf{67.3} & 42.1 & \textbf{57.7} & \textbf{44.8} & 97.7 \\
 & RocketKV & \textbf{35.6} & \textbf{28.1} & 26.9 & 66.4 & \textbf{42.2} & 57.6 & 44.6 & \textbf{98.7} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 36.2 & 29.7 & 28.2 & 66.6 & 42.9 & 56.8 & 45.2 & 99.3 \\
 & DuoAttention & 27.1 & 21.5 & 23.5 & 62.4 & 12.1 & 55.6 & 35.7 & 41.0 \\
 & SnapKV & 33.1 & 26.7 & 23.3 & 63.9 & \textbf{43.1} & \textbf{57.6} & 42.6 & 62.3 \\
 & Quest & 32.2 & 26.9 & 27.0 & 62.5 & 39.3 & 56.0 & 42.3 & 90.3 \\
 & SparQ & 22.0 & 10.3 & 20.1 & 34.1 & 4.0 & 50.5 & 24.5 & 27.0 \\
 & Hybrid & \textbf{36.2} & 29.0 & \textbf{28.2} & \textbf{67.2} & 42.2 & 57.2 & \textbf{45.2} & 99.0 \\
 & RocketKV & 35.9 & \textbf{29.1} & 27.6 & 66.9 & 42.5 & 57.2 & 45.0 & \textbf{99.3} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 36.2 & 29.6 & 28.1 & 66.5 & 43.0 & 56.5 & 45.2 & 99.3 \\
 & DuoAttention & 32.1 & 25.3 & 25.6 & 65.4 & 26.7 & 56.4 & 40.6 & 62.0 \\
 & SnapKV & 34.1 & 28.0 & 25.2 & 64.6 & \textbf{42.8} & \textbf{57.9} & 43.6 & 76.7 \\
 & Quest & 35.1 & 29.1 & 27.9 & 66.3 & 42.7 & 56.3 & 44.7 & 96.0 \\
 & SparQ & 30.6 & 20.3 & 24.8 & 59.4 & 37.7 & 53.3 & 38.9 & 50.3 \\
 & Hybrid & \textbf{36.4} & \textbf{29.5} & \textbf{28.1} & \textbf{66.8} & \textbf{42.8} & 57.0 & \textbf{45.3} & \textbf{99.3} \\
 & RocketKV & 36.2 & \textbf{29.5} & 27.9 & 66.6 & 42.6 & 57.0 & 45.1 & \textbf{99.3} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Individual results of LongBench for \mistral}
\scalebox{0.55}{%
\begin{tabular}{llllllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{narrativeqa}} & \rotatebox{45}{\textbf{qasper}} & \rotatebox{45}{\textbf{mul.fieldqa}} & \rotatebox{45}{\textbf{hotpotqa}} & \rotatebox{45}{\textbf{2wikimqa}} & \rotatebox{45}{\textbf{musique}} & \rotatebox{45}{\textbf{gov-report}} & \rotatebox{45}{\textbf{qmsum}} & \rotatebox{45}{\textbf{multi-news}} & \rotatebox{45}{\textbf{trec}} & \rotatebox{45}{\textbf{triviaqa}} & \rotatebox{45}{\textbf{samsum}} & \rotatebox{45}{\textbf{pass-ret.}} & \rotatebox{45}{\textbf{lcc}} & \rotatebox{45}{\textbf{repobench-p}} & \rotatebox{45}{\textbf{passagecnt}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 26.8 & 33.1 & 49.3 & 42.8 & 27.3 & 18.8 & 33.0 & 24.2 & 27.1 & 71.0 & 86.2 & 42.8 & 87.0 & 56.9 & 54.3 & 2.8 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 26.2 & 31.3 & 48.9 & 40.0 & 26.2 & 19.6 & 33.3 & 24.2 & 27.1 & 73.0 & 86.6 & 43.3 & 82.9 & 59.0 & 57.3 & 2.3 \\
 & DuoAttention & 13.0 & 11.7 & 28.5 & 29.5 & 20.1 & 9.3 & 17.6 & 19.4 & 18.6 & 26.0 & 81.8 & 37.7 & 7.1 & 50.4 & 54.1 & 3.2 \\
 & SnapKV & 0.9 & 1.9 & 30.7 & 26.4 & 21.3 & 11.6 & N/A & N/A & N/A & 23.0 & 77.9 & 0.5 & 38.0 & 46.0 & 49.5 & \textbf{3.8} \\
 & Quest & 2.1 & 9.1 & 14.9 & 6.0 & 7.8 & 2.1 & 13.0 & 10.8 & 22.2 & 14.0 & 14.1 & 9.6 & 5.9 & 39.6 & 25.6 & 0.4 \\
 & SparQ & 0.3 & 1.7 & 2.9 & 0.9 & 1.5 & 0.1 & 5.3 & 6.7 & 13.8 & 0.0 & 7.1 & 0.4 & 12.7 & 30.0 & 22.0 & 0.2 \\
 & Hybrid & 17.1 & 28.1 & 43.9 & 30.2 & 23.6 & 11.8 & \textbf{27.3} & 22.4 & \textbf{26.8} & 63.0 & 78.8 & 33.6 & 46.9 & 52.1 & 49.7 & 3.2 \\
 & RocketKV & \textbf{25.6} & \textbf{28.8} & \textbf{48.9} & \textbf{37.2} & \textbf{24.8} & \textbf{18.4} & 26.0 & \textbf{23.6} & 24.3 & \textbf{68.5} & \textbf{86.3} & \textbf{42.0} & \textbf{73.7} & \textbf{57.2} & \textbf{58.5} & 3.3 \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 27.2 & 31.6 & 48.6 & 40.5 & 27.5 & 19.7 & 33.2 & 24.2 & 27.1 & 72.0 & 86.6 & 42.8 & 83.1 & 58.3 & 56.5 & 2.6 \\
 & DuoAttention & 14.7 & 13.8 & 30.8 & 27.2 & 20.5 & 10.0 & 20.6 & 19.9 & 22.8 & 40.0 & 81.8 & 39.8 & 11.7 & 53.5 & 54.0 & 2.5 \\
 & SnapKV & 18.1 & 15.8 & 41.2 & 32.7 & 21.4 & 14.4 & N/A & N/A & N/A & 38.0 & 83.2 & 38.4 & 66.7 & 52.4 & 54.3 & \textbf{3.6} \\
 & Quest & 6.0 & 17.0 & 29.1 & 18.1 & 13.8 & 5.1 & 22.8 & 18.9 & 25.5 & 35.0 & 50.7 & 21.8 & 43.1 & 48.3 & 41.2 & 2.9 \\
 & SparQ & 0.1 & 4.1 & 10.9 & 1.8 & 2.8 & 0.5 & 6.8 & 11.9 & 20.3 & 4.5 & 16.2 & 3.9 & 4.4 & 45.2 & 25.4 & 0.2 \\
 & Hybrid & 23.2 & \textbf{31.2} & 48.4 & 38.6 & \textbf{26.6} & 17.0 & \textbf{31.0} & 23.3 & \textbf{27.2} & \textbf{71.5} & 85.0 & 41.2 & 74.7 & 57.1 & 57.3 & 1.9 \\
 & RocketKV & \textbf{26.5} & 30.6 & \textbf{48.9} & \textbf{38.7} & 25.9 & \textbf{19.0} & 28.0 & \textbf{24.3} & 25.1 & 70.5 & \textbf{86.1} & \textbf{43.3} & \textbf{79.2} & \textbf{58.2} & \textbf{57.6} & 3.3 \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 27.2 & 31.3 & 48.8 & 41.7 & 27.4 & 19.3 & 33.4 & 24.1 & 27.2 & 72.0 & 86.4 & 42.5 & 82.8 & 57.7 & 55.7 & 2.9 \\
 & DuoAttention & 15.7 & 15.7 & 32.3 & 29.4 & 19.3 & 9.4 & 22.0 & 20.4 & 24.8 & 53.0 & 83.8 & 40.5 & 13.2 & 55.1 & 54.9 & 3.1 \\
 & SnapKV & 20.0 & 22.4 & 45.2 & 36.3 & 23.1 & 16.6 & 18.5 & 22.1 & 21.6 & 52.5 & 85.6 & 40.6 & 80.9 & 55.3 & \textbf{57.2} & \textbf{3.3} \\
 & Quest & 10.1 & 26.7 & 39.6 & 26.5 & 17.9 & 11.4 & 27.5 & 22.9 & 26.3 & 66.0 & 70.5 & 32.3 & 69.8 & 55.7 & 50.9 & 2.8 \\
 & SparQ & 0.2 & 14.5 & 24.5 & 5.8 & 6.0 & 0.5 & 9.3 & 16.3 & 25.1 & 13.0 & 31.1 & 10.1 & 1.0 & 54.3 & 32.8 & 0.0 \\
 & Hybrid & 26.1 & 31.6 & 48.2 & 38.4 & \textbf{26.8} & \textbf{18.8} & \textbf{32.1} & 23.5 & \textbf{27.3} & \textbf{73.0} & \textbf{86.5} & \textbf{42.5} & 81.8 & \textbf{58.8} & 56.7 & 2.5 \\
 & RocketKV & \textbf{26.4} & \textbf{32.1} & \textbf{48.5} & \textbf{39.9} & 25.9 & 18.5 & 29.7 & \textbf{24.6} & 26.4 & 71.0 & 86.1 & 42.1 & \textbf{82.1} & 58.4 & 56.9 & 2.4 \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 27.3 & 32.8 & 48.6 & 41.8 & 27.9 & 19.4 & 33.3 & 24.0 & 27.4 & 71.0 & 86.4 & 42.4 & 82.8 & 57.9 & 55.6 & 3.0 \\
 & DuoAttention & 17.2 & 24.5 & 39.5 & 32.9 & 21.8 & 9.9 & 23.5 & 20.6 & 26.6 & 61.5 & 84.3 & 41.3 & 20.7 & 56.1 & 55.0 & \textbf{3.4} \\
 & SnapKV & 24.8 & 26.9 & 47.7 & 38.1 & 23.6 & 18.4 & 22.4 & 23.5 & 24.1 & 65.5 & 85.7 & 40.7 & \textbf{82.9} & 57.6 & \textbf{57.7} & 3.3 \\
 & Quest & 18.3 & 31.5 & 46.7 & 36.9 & 25.5 & 18.3 & 31.0 & 23.1 & 27.0 & 70.5 & 79.6 & 37.4 & 76.3 & 58.0 & 54.1 & 2.3 \\
 & SparQ & 2.9 & 29.3 & 33.8 & 9.0 & 21.4 & 0.6 & 16.7 & 16.9 & 26.6 & 35.5 & 47.6 & 19.2 & 6.9 & 57.2 & 43.8 & 1.2 \\
 & Hybrid & 27.2 & \textbf{32.2} & \textbf{49.1} & 40.8 & \textbf{27.0} & 19.2 & \textbf{33.2} & 24.1 & \textbf{27.4} & \textbf{72.0} & \textbf{86.8} & \textbf{42.9} & 81.3 & 57.7 & 56.8 & 3.1 \\
 & RocketKV & \textbf{27.7} & 32.0 & 48.1 & \textbf{41.2} & 26.7 & \textbf{19.5} & 31.4 & \textbf{24.4} & 26.9 & 71.5 & 86.4 & 42.8 & 82.7 & \textbf{58.1} & 56.2 & 2.4 \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 27.7 & 32.7 & 48.2 & 41.5 & 27.9 & 19.4 & 33.1 & 24.1 & 27.2 & 71.0 & 86.2 & 42.4 & 83.3 & 57.8 & 55.3 & 2.8 \\
 & DuoAttention & 19.1 & 31.6 & 45.6 & 36.6 & 26.8 & 12.4 & 27.7 & 21.8 & \textbf{27.2} & 70.0 & 85.0 & 41.2 & 51.2 & 56.8 & 56.1 & 2.2 \\
 & SnapKV & 24.9 & 29.7 & 47.7 & 39.6 & 25.0 & 19.5 & 25.6 & 23.9 & 26.1 & 66.5 & 86.0 & 41.3 & 82.8 & \textbf{58.7} & \textbf{57.0} & 2.8 \\
 & Quest & 24.6 & 32.1 & 48.7 & 40.4 & 27.1 & \textbf{19.7} & 32.8 & 23.5 & \textbf{27.2} & \textbf{72.5} & \textbf{86.3} & 40.3 & 82.7 & 57.7 & 54.9 & 2.8 \\
 & SparQ & 12.3 & 31.7 & 47.9 & 26.1 & 25.8 & 9.0 & 26.5 & 20.7 & 27.1 & 71.0 & 69.6 & 37.5 & 71.5 & 57.4 & 49.1 & \textbf{3.9} \\
 & Hybrid & \textbf{27.8} & \textbf{32.2} & \textbf{49.0} & \textbf{42.0} & 27.4 & 19.2 & \textbf{33.0} & 23.9 & \textbf{27.2} & 71.5 & 86.2 & \textbf{42.7} & \textbf{83.3} & 57.9 & 56.2 & 2.3 \\
 & RocketKV & 27.7 & 32.1 & 48.7 & 41.2 & \textbf{27.8} & 19.6 & 32.2 & \textbf{24.6} & 27.0 & 71.5 & 86.2 & 42.0 & 82.2 & 57.8 & 56.2 & 3.1 \\
\hline
\end{tabular}
}
\end{table*}








\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=8000 for \mistral}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 82.0 & 79.5 & 94.0 & 97.6 & 90.6 & 71.3 & 82.0 & 64.0 & 89.2 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 84.0 & 80.5 & 98.0 & 96.0 & 88.0 & 68.7 & 84.0 & 66.0 & 89.5 \\
 & DuoAttention & 4.0 & 0.0 & 2.0 & 2.0 & 0.0 & 0.0 & 2.0 & 2.0 & 2.4 & 26.8 & 48.7 & 32.0 & 40.0 & 12.5 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 3.6 & 1.3 & 48.0 & 50.0 & 7.9 \\
 & Quest & 92.0 & 32.0 & 0.0 & 24.0 & 6.0 & 0.0 & 3.0 & 6.0 & 15.2 & 19.6 & 38.0 & 22.0 & 28.0 & 22.0 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.2 & 9.3 & 2.0 & 10.0 & 1.8 \\
 & Hybrid & 98.0 & 82.0 & 50.0 & 84.0 & 74.0 & 12.0 & 42.5 & 60.5 & 88.4 & 30.4 & 73.3 & 84.0 & \textbf{66.0} & 65.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{98.0} & \textbf{100.0} & \textbf{72.0} & \textbf{82.0} & \textbf{95.5} & \textbf{93.6} & \textbf{47.8} & \textbf{74.0} & \textbf{88.0} & 62.0 & \textbf{85.5} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 82.0 & 80.5 & 98.0 & 96.0 & 89.6 & 72.7 & 82.0 & 66.0 & 89.6 \\
 & DuoAttention & 8.0 & 12.0 & 2.0 & 4.0 & 4.0 & 8.0 & 9.5 & 8.0 & 6.0 & 2.4 & 69.3 & 26.0 & 42.0 & 15.5 \\
 & SnapKV & 18.0 & 36.0 & 0.0 & 10.0 & 34.0 & 0.0 & 0.0 & 0.0 & 11.6 & 6.6 & 52.7 & 76.0 & 54.0 & 23.0 \\
 & Quest & 94.0 & 76.0 & 2.0 & 92.0 & 52.0 & 0.0 & 53.5 & 59.5 & 76.4 & 29.8 & 65.3 & 64.0 & 54.0 & 55.3 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 6.0 & 0.0 & 0.0 & 0.0 & 2.6 & 67.3 & 0.0 & 32.0 & 8.3 \\
 & Hybrid & \textbf{100.0} & 98.0 & 96.0 & \textbf{98.0} & 96.0 & \textbf{80.0} & 75.5 & 93.0 & 95.2 & 58.0 & 71.3 & \textbf{84.0} & \textbf{66.0} & 85.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & \textbf{80.0} & \textbf{87.5} & \textbf{97.5} & \textbf{96.8} & \textbf{59.6} & \textbf{74.7} & \textbf{84.0} & \textbf{66.0} & \textbf{88.0} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 82.0 & 80.0 & 96.0 & 96.8 & 90.8 & 73.3 & 80.0 & 66.0 & 89.5 \\
 & DuoAttention & 12.0 & 12.0 & 2.0 & 4.0 & 14.0 & 10.0 & 9.5 & 8.0 & 9.2 & 14.2 & 72.0 & 42.0 & 48.0 & 19.8 \\
 & SnapKV & 92.0 & 66.0 & 0.0 & 54.0 & 64.0 & 0.0 & 3.5 & 7.5 & 79.6 & 12.0 & \textbf{73.3} & 78.0 & 58.0 & 45.2 \\
 & Quest & 92.0 & 84.0 & 26.0 & 94.0 & 76.0 & 22.0 & 74.5 & 78.0 & 89.6 & 51.8 & 70.0 & 84.0 & 64.0 & 69.7 \\
 & SparQ & 0.0 & 62.0 & 6.0 & 72.0 & 0.0 & 72.0 & 70.0 & 61.0 & 0.0 & 8.6 & 68.0 & 30.0 & 44.0 & 38.0 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & \textbf{84.0} & 79.5 & 98.0 & 96.4 & \textbf{80.0} & 68.7 & 82.0 & \textbf{66.0} & 88.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & 98.0 & \textbf{98.0} & \textbf{100.0} & 78.0 & \textbf{89.0} & \textbf{98.5} & \textbf{96.8} & 72.4 & 72.0 & \textbf{86.0} & \textbf{66.0} & \textbf{88.8} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 82.0 & 79.5 & 95.5 & 97.6 & 91.2 & 74.0 & 80.0 & 66.0 & 89.5 \\
 & DuoAttention & 38.0 & 40.0 & 30.0 & 34.0 & 60.0 & 24.0 & 15.0 & 22.0 & 24.0 & 48.0 & 70.0 & 62.0 & 62.0 & 40.7 \\
 & SnapKV & \textbf{100.0} & 84.0 & 0.0 & 82.0 & 88.0 & 0.0 & 8.5 & 26.5 & 96.4 & 25.0 & \textbf{75.3} & 78.0 & 66.0 & 56.1 \\
 & Quest & \textbf{100.0} & 96.0 & 98.0 & 94.0 & 98.0 & 80.0 & 80.5 & 95.5 & 97.2 & 74.2 & 70.7 & \textbf{82.0} & 66.0 & 87.1 \\
 & SparQ & 96.0 & 90.0 & \textbf{100.0} & 96.0 & \textbf{100.0} & \textbf{84.0} & 78.5 & 95.0 & 81.6 & \textbf{90.0} & 70.7 & \textbf{82.0} & 66.0 & 86.9 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & 82.0 & 80.5 & 96.0 & 96.4 & 88.4 & 69.3 & 80.0 & 66.0 & 89.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & 78.0 & \textbf{90.5} & \textbf{98.0} & \textbf{98.4} & 82.6 & 74.0 & \textbf{82.0} & \textbf{68.0} & \textbf{90.0} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 98.0 & 100.0 & 82.0 & 79.5 & 94.5 & 97.6 & 90.8 & 73.3 & 82.0 & 64.0 & 89.4 \\
 & DuoAttention & \textbf{100.0} & 98.0 & \textbf{100.0} & 96.0 & \textbf{100.0} & \textbf{84.0} & 71.0 & 90.5 & 96.0 & 85.4 & 70.0 & \textbf{86.0} & \textbf{66.0} & 87.9 \\
 & SnapKV & \textbf{100.0} & 96.0 & 2.0 & 94.0 & 90.0 & 6.0 & 24.0 & 51.5 & 98.4 & 52.2 & 73.3 & 80.0 & \textbf{66.0} & 64.1 \\
 & Quest & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & \textbf{84.0} & 80.0 & 96.0 & 96.8 & 87.8 & 71.3 & 82.0 & \textbf{66.0} & 89.4 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & 82.0 & 79.0 & 95.5 & 97.6 & 89.8 & 72.7 & 82.0 & 64.0 & 89.3 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{100.0} & 82.0 & 79.5 & 96.0 & 97.6 & \textbf{90.6} & \textbf{74.0} & 80.0 & 64.0 & 89.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & 94.0 & \textbf{98.0} & \textbf{100.0} & 82.0 & \textbf{91.0} & \textbf{98.0} & \textbf{98.8} & 87.2 & \textbf{74.0} & 84.0 & \textbf{66.0} & \textbf{90.2} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=16000 for \mistral}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 100.0 & 86.0 & 90.0 & 74.0 & 84.0 & 85.5 & 87.6 & 74.2 & 86.7 & 78.0 & 54.0 & 84.6 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 100.0 & 100.0 & 84.0 & 92.0 & 82.0 & 87.0 & 80.0 & 85.2 & 70.6 & 76.7 & 80.0 & 58.0 & 84.3 \\
 & DuoAttention & 2.0 & 0.0 & 2.0 & 2.0 & 0.0 & 0.0 & 2.5 & 3.5 & 0.8 & 12.6 & 48.7 & 30.0 & 36.0 & 10.8 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.6 & 0.7 & 38.0 & 40.0 & 6.3 \\
 & Quest & 0.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 3.6 & 18.7 & 8.0 & 12.0 & 3.4 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.4 & 0.0 & 2.0 & 0.0 & 0.2 \\
 & Hybrid & 96.0 & 52.0 & 2.0 & 30.0 & 24.0 & 0.0 & 16.0 & 10.0 & 72.0 & 16.0 & 70.7 & 74.0 & \textbf{54.0} & 39.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{86.0} & \textbf{92.0} & \textbf{42.0} & \textbf{79.5} & \textbf{91.5} & \textbf{85.6} & \textbf{37.0} & \textbf{79.3} & \textbf{76.0} & 52.0 & \textbf{78.4} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 100.0 & 84.0 & 92.0 & 80.0 & 85.0 & 84.0 & 86.0 & 72.6 & 79.3 & 80.0 & 58.0 & 84.7 \\
 & DuoAttention & 2.0 & 2.0 & 4.0 & 2.0 & 0.0 & 0.0 & 6.5 & 4.5 & 2.8 & 0.4 & 80.7 & 32.0 & 32.0 & 13.0 \\
 & SnapKV & 26.0 & 18.0 & 0.0 & 2.0 & 12.0 & 0.0 & 0.0 & 0.0 & 10.4 & 2.2 & 50.0 & 62.0 & 46.0 & 17.6 \\
 & Quest & \textbf{100.0} & 72.0 & 4.0 & 56.0 & 12.0 & 0.0 & 18.5 & 16.5 & 41.2 & 13.4 & 62.7 & 22.0 & 36.0 & 34.9 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.2 & 2.7 & 0.0 & 6.0 & 0.8 \\
 & Hybrid & \textbf{100.0} & 94.0 & 86.0 & 80.0 & 76.0 & 18.0 & 47.5 & 59.0 & 81.6 & 34.4 & 75.3 & \textbf{80.0} & \textbf{58.0} & 68.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{82.0} & \textbf{86.0} & \textbf{44.0} & \textbf{87.5} & \textbf{95.0} & \textbf{84.8} & \textbf{48.0} & \textbf{81.3} & \textbf{80.0} & 52.0 & \textbf{79.9} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 100.0 & 84.0 & 92.0 & 78.0 & 83.0 & 85.5 & 88.4 & 74.4 & 84.0 & 78.0 & 58.0 & 85.0 \\
 & DuoAttention & 6.0 & 8.0 & 4.0 & 2.0 & 0.0 & 0.0 & 8.0 & 5.0 & 4.4 & 0.2 & 80.7 & 38.0 & 46.0 & 15.6 \\
 & SnapKV & 90.0 & 62.0 & 0.0 & 36.0 & 36.0 & 0.0 & 3.0 & 3.5 & 73.2 & 8.4 & 73.3 & 64.0 & 48.0 & 38.3 \\
 & Quest & 84.0 & 94.0 & 10.0 & 82.0 & 44.0 & 0.0 & 61.5 & 54.5 & 73.6 & 28.8 & 70.0 & 68.0 & \textbf{56.0} & 55.9 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 6.6 & 60.0 & 0.0 & 2.0 & 5.3 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{86.0} & \textbf{90.0} & \textbf{72.0} & 76.5 & 77.5 & 82.4 & \textbf{57.8} & 78.0 & \textbf{78.0} & \textbf{56.0} & 80.9 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 82.0 & 88.0 & 56.0 & \textbf{93.0} & \textbf{97.0} & \textbf{88.4} & 56.8 & \textbf{83.3} & 76.0 & 52.0 & \textbf{82.3} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 100.0 & 84.0 & 92.0 & 76.0 & 83.0 & 85.5 & 88.8 & 74.2 & 86.7 & 80.0 & 58.0 & 85.2 \\
 & DuoAttention & 10.0 & 8.0 & 6.0 & 6.0 & 6.0 & 0.0 & 8.0 & 6.0 & 4.8 & 2.2 & 79.3 & 40.0 & 48.0 & 17.3 \\
 & SnapKV & 98.0 & 76.0 & 0.0 & 54.0 & 44.0 & 0.0 & 9.5 & 17.0 & 85.6 & 22.0 & 81.3 & 72.0 & 50.0 & 46.9 \\
 & Quest & 92.0 & 88.0 & 44.0 & 76.0 & 72.0 & 10.0 & 68.0 & 73.0 & 84.0 & 51.6 & 74.7 & \textbf{80.0} & \textbf{58.0} & 67.0 \\
 & SparQ & 0.0 & 6.0 & 0.0 & 16.0 & 0.0 & 4.0 & 22.0 & 6.0 & 0.4 & 12.8 & 79.3 & 4.0 & 20.0 & 13.1 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & \textbf{84.0} & \textbf{92.0} & \textbf{76.0} & 82.5 & 82.0 & 85.2 & \textbf{70.8} & 78.0 & 76.0 & \textbf{58.0} & 83.4 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 82.0 & 88.0 & 66.0 & \textbf{93.0} & \textbf{96.5} & \textbf{87.2} & 65.8 & \textbf{84.7} & 76.0 & 56.0 & \textbf{84.2} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 100.0 & 84.0 & 92.0 & 74.0 & 83.0 & 86.0 & 88.0 & 75.2 & 86.7 & 80.0 & 56.0 & 85.0 \\
 & DuoAttention & 48.0 & 46.0 & 40.0 & 32.0 & 48.0 & 14.0 & 24.0 & 20.0 & 22.8 & 16.6 & 80.7 & 62.0 & \textbf{58.0} & 39.4 \\
 & SnapKV & \textbf{100.0} & 88.0 & 2.0 & 74.0 & 58.0 & 0.0 & 20.0 & 39.0 & \textbf{92.0} & 36.4 & 81.3 & 74.0 & 52.0 & 55.1 \\
 & Quest & \textbf{100.0} & \textbf{100.0} & 96.0 & \textbf{86.0} & \textbf{92.0} & \textbf{82.0} & 82.5 & 83.0 & 86.0 & 65.8 & 80.7 & \textbf{80.0} & \textbf{58.0} & 84.0 \\
 & SparQ & 82.0 & 86.0 & 84.0 & 82.0 & 80.0 & 78.0 & 67.5 & 64.5 & 31.2 & 73.2 & 83.3 & 76.0 & 52.0 & 72.3 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 84.0 & \textbf{92.0} & 78.0 & 84.0 & 86.5 & 84.4 & \textbf{74.6} & 81.3 & 78.0 & \textbf{58.0} & 84.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{100.0} & 82.0 & 88.0 & 70.0 & \textbf{95.5} & \textbf{98.0} & 88.8 & 70.0 & \textbf{86.0} & 74.0 & 56.0 & \textbf{85.3} \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=24000 for \mistral}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 92.0 & 86.0 & 94.0 & 78.0 & 77.5 & 83.5 & 93.2 & 40.6 & 86.7 & 68.0 & 58.0 & 81.3 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 98.0 & 88.0 & 90.0 & 92.0 & 78.0 & 78.5 & 79.0 & 92.8 & 62.4 & 80.0 & 70.0 & 58.0 & 82.1 \\
 & DuoAttention & 2.0 & 0.0 & 2.0 & 6.0 & 2.0 & 0.0 & 1.5 & 3.0 & 0.8 & 1.2 & 56.7 & 24.0 & 34.0 & 10.2 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.4 & 0.0 & 38.0 & 38.0 & 6.0 \\
 & Quest & 0.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 1.8 & 15.3 & 2.0 & 2.0 & 1.8 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 6.0 & 0.0 & 0.5 \\
 & Hybrid & 90.0 & 34.0 & 0.0 & 24.0 & 0.0 & 0.0 & 8.0 & 7.5 & 73.6 & 6.4 & 56.0 & 52.0 & 44.0 & 30.4 \\
 & RocketKV & \textbf{100.0} & \textbf{98.0} & \textbf{90.0} & \textbf{78.0} & \textbf{88.0} & \textbf{36.0} & \textbf{73.0} & \textbf{79.5} & \textbf{87.2} & \textbf{18.8} & \textbf{67.3} & \textbf{76.0} & \textbf{52.0} & \textbf{72.6} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 90.0 & 88.0 & 92.0 & 80.0 & 77.0 & 81.0 & 93.2 & 59.0 & 86.0 & 70.0 & 58.0 & 82.6 \\
 & DuoAttention & 4.0 & 4.0 & 4.0 & 6.0 & 6.0 & 2.0 & 4.5 & 4.5 & 1.6 & 0.4 & 68.7 & 26.0 & 28.0 & 12.3 \\
 & SnapKV & 42.0 & 20.0 & 0.0 & 6.0 & 10.0 & 0.0 & 0.0 & 0.0 & 5.2 & 1.6 & 38.0 & 50.0 & 42.0 & 16.5 \\
 & Quest & \textbf{100.0} & 12.0 & 32.0 & 8.0 & 6.0 & 0.0 & 2.0 & 7.0 & 7.2 & 3.0 & 56.7 & 8.0 & 16.0 & 19.8 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.6 & 0.0 & 2.0 & 0.0 & 0.2 \\
 & Hybrid & \textbf{100.0} & 74.0 & 48.0 & 54.0 & 42.0 & 0.0 & 33.0 & 33.5 & 86.0 & 18.0 & 66.7 & 68.0 & 52.0 & 51.9 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{84.0} & \textbf{96.0} & \textbf{48.0} & \textbf{80.5} & \textbf{91.5} & \textbf{95.2} & \textbf{32.4} & \textbf{74.0} & \textbf{70.0} & \textbf{54.0} & \textbf{78.6} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 90.0 & 86.0 & 92.0 & 80.0 & 78.0 & 84.0 & 93.6 & 55.4 & 86.7 & 70.0 & 58.0 & 82.6 \\
 & DuoAttention & 4.0 & 4.0 & 4.0 & 6.0 & 8.0 & 2.0 & 4.5 & 4.5 & 2.0 & 0.6 & 70.0 & 28.0 & 32.0 & 13.0 \\
 & SnapKV & 96.0 & 58.0 & 0.0 & 24.0 & 30.0 & 0.0 & 2.5 & 4.0 & 68.0 & 4.2 & 65.3 & 60.0 & 46.0 & 35.2 \\
 & Quest & \textbf{100.0} & 82.0 & 2.0 & 78.0 & 20.0 & 0.0 & 32.0 & 34.5 & 45.2 & 9.6 & 66.0 & 36.0 & 32.0 & 41.3 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.2 & 1.3 & 0.0 & 4.0 & 0.6 \\
 & Hybrid & \textbf{100.0} & 98.0 & 86.0 & 80.0 & 72.0 & 36.0 & 62.0 & 71.5 & 93.2 & 36.4 & 72.7 & \textbf{72.0} & \textbf{56.0} & 72.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{82.0} & \textbf{94.0} & \textbf{50.0} & \textbf{83.0} & \textbf{93.5} & \textbf{96.8} & \textbf{38.2} & \textbf{78.0} & 68.0 & 54.0 & \textbf{79.7} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 90.0 & 86.0 & 94.0 & 80.0 & 78.0 & 83.0 & 93.6 & 50.2 & 88.7 & 70.0 & 58.0 & 82.4 \\
 & DuoAttention & 4.0 & 4.0 & 4.0 & 6.0 & 10.0 & 2.0 & 4.5 & 4.5 & 2.4 & 0.4 & 69.3 & 26.0 & 30.0 & 12.9 \\
 & SnapKV & 96.0 & 80.0 & 0.0 & 52.0 & 40.0 & 0.0 & 7.0 & 17.5 & 96.0 & 11.0 & 70.7 & 64.0 & 46.0 & 44.6 \\
 & Quest & 96.0 & 88.0 & 2.0 & 80.0 & 64.0 & 0.0 & 65.0 & 66.0 & 88.0 & 18.0 & 75.3 & 62.0 & 50.0 & 58.0 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 34.0 & 0.0 & 0.0 & 0.0 & 27.2 & 80.0 & 2.0 & 4.0 & 11.3 \\
 & Hybrid & \textbf{100.0} & 98.0 & 88.0 & \textbf{88.0} & 90.0 & \textbf{68.0} & 73.5 & 80.5 & 94.8 & \textbf{53.6} & 74.7 & \textbf{68.0} & \textbf{60.0} & 79.8 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 84.0 & \textbf{94.0} & 64.0 & \textbf{87.5} & \textbf{93.5} & \textbf{98.4} & 44.8 & \textbf{82.7} & 60.0 & 54.0 & \textbf{81.6} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 90.0 & 86.0 & 94.0 & 78.0 & 78.0 & 84.0 & 93.6 & 41.2 & 88.7 & 70.0 & 58.0 & 81.7 \\
 & DuoAttention & 24.0 & 18.0 & 10.0 & 18.0 & 20.0 & 2.0 & 6.0 & 6.0 & 6.4 & 0.8 & 71.3 & 52.0 & 44.0 & 21.4 \\
 & SnapKV & \textbf{100.0} & 84.0 & 0.0 & 60.0 & 54.0 & 2.0 & 19.5 & 37.5 & 96.4 & 21.8 & 75.3 & 68.0 & 46.0 & 51.1 \\
 & Quest & 90.0 & 86.0 & 72.0 & 72.0 & 72.0 & 38.0 & 71.5 & 75.0 & 90.4 & 43.4 & 80.0 & \textbf{70.0} & 56.0 & 70.5 \\
 & SparQ & 0.0 & 6.0 & 0.0 & 4.0 & 0.0 & 8.0 & 2.0 & 10.5 & 0.0 & 6.2 & \textbf{86.0} & 0.0 & 18.0 & 10.8 \\
 & Hybrid & \textbf{100.0} & 98.0 & 90.0 & \textbf{88.0} & \textbf{92.0} & \textbf{78.0} & 73.5 & 83.0 & 94.8 & \textbf{62.0} & 82.7 & \textbf{70.0} & \textbf{58.0} & \textbf{82.3} \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 82.0 & \textbf{92.0} & 70.0 & \textbf{87.5} & \textbf{94.0} & \textbf{97.2} & 47.8 & 85.3 & 60.0 & 54.0 & 82.1 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=32000 for \mistral}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 98.0 & 86.0 & 82.0 & 88.0 & 68.0 & 83.0 & 81.0 & 90.0 & 29.6 & 94.7 & 70.0 & 48.0 & 78.3 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 92.0 & 68.0 & 78.0 & 80.0 & 60.0 & 78.0 & 58.5 & 91.2 & 40.4 & 86.0 & 66.0 & 48.0 & 72.8 \\
 & DuoAttention & 0.0 & 2.0 & 4.0 & 4.0 & 0.0 & 0.0 & 1.0 & 3.0 & 0.0 & 2.0 & 34.0 & 24.0 & 30.0 & 8.0 \\
 & SnapKV & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.6 & 0.0 & 22.0 & 36.0 & 4.5 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.6 & 22.0 & 0.0 & 2.0 & 1.9 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.2 \\
 & Hybrid & 76.0 & 14.0 & 0.0 & 4.0 & 2.0 & 0.0 & 6.0 & 3.5 & 55.6 & 2.2 & 57.3 & 26.0 & 32.0 & 21.4 \\
 & RocketKV & \textbf{98.0} & \textbf{86.0} & \textbf{50.0} & \textbf{68.0} & \textbf{66.0} & \textbf{16.0} & \textbf{48.5} & \textbf{44.5} & \textbf{82.8} & \textbf{11.2} & \textbf{78.7} & \textbf{70.0} & \textbf{42.0} & \textbf{58.6} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 94.0 & 68.0 & 78.0 & 86.0 & 64.0 & 83.0 & 60.5 & 93.2 & 37.4 & 87.3 & 66.0 & 46.0 & 74.1 \\
 & DuoAttention & 2.0 & 6.0 & 6.0 & 4.0 & 0.0 & 2.0 & 3.5 & 4.0 & 2.8 & 0.8 & 75.3 & 24.0 & 30.0 & 12.3 \\
 & SnapKV & 56.0 & 6.0 & 0.0 & 6.0 & 6.0 & 0.0 & 0.0 & 0.0 & 2.8 & 1.0 & 30.0 & 46.0 & 38.0 & 14.8 \\
 & Quest & 88.0 & 2.0 & 4.0 & 2.0 & 0.0 & 0.0 & 1.5 & 1.0 & 0.0 & 4.0 & 64.0 & 8.0 & 16.0 & 14.7 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.4 & 0.0 & 0.0 & 2.0 & 0.2 \\
 & Hybrid & 96.0 & 28.0 & 4.0 & 28.0 & 26.0 & 0.0 & 16.5 & 12.5 & 77.2 & 9.2 & 77.3 & \textbf{72.0} & 44.0 & 37.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{80.0} & \textbf{80.0} & \textbf{90.0} & \textbf{38.0} & \textbf{84.0} & \textbf{81.5} & \textbf{92.0} & \textbf{16.8} & \textbf{83.3} & 66.0 & \textbf{48.0} & \textbf{73.8} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 96.0 & 72.0 & 80.0 & 90.0 & 64.0 & 81.5 & 66.0 & 92.4 & 37.0 & 91.3 & 68.0 & 50.0 & 76.0 \\
 & DuoAttention & 2.0 & 6.0 & 6.0 & 4.0 & 0.0 & 2.0 & 3.5 & 4.5 & 3.6 & 0.6 & 80.7 & 20.0 & 32.0 & 12.7 \\
 & SnapKV & \textbf{100.0} & 46.0 & 0.0 & 20.0 & 14.0 & 0.0 & 1.5 & 2.5 & 44.0 & 3.0 & 70.0 & 58.0 & 40.0 & 30.7 \\
 & Quest & 94.0 & 74.0 & 2.0 & 44.0 & 18.0 & 0.0 & 15.5 & 19.0 & 69.6 & 5.6 & 77.3 & 28.0 & 32.0 & 36.8 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.6 & 0.0 & 0.0 & 8.0 & 0.7 \\
 & Hybrid & 98.0 & 70.0 & 56.0 & 56.0 & 50.0 & 10.0 & 46.5 & 38.0 & 85.2 & \textbf{24.8} & 78.7 & \textbf{74.0} & \textbf{48.0} & 56.6 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{84.0} & \textbf{80.0} & \textbf{90.0} & \textbf{28.0} & \textbf{86.5} & \textbf{87.0} & \textbf{94.0} & 23.0 & \textbf{84.7} & 68.0 & \textbf{48.0} & \textbf{74.9} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 98.0 & 76.0 & 82.0 & 90.0 & 64.0 & 84.0 & 73.5 & 90.8 & 34.0 & 92.7 & 68.0 & 48.0 & 77.0 \\
 & DuoAttention & 2.0 & 6.0 & 6.0 & 4.0 & 0.0 & 2.0 & 3.5 & 5.0 & 3.6 & 0.8 & 81.3 & 28.0 & 30.0 & 13.2 \\
 & SnapKV & \textbf{100.0} & 66.0 & 0.0 & 44.0 & 20.0 & 0.0 & 4.5 & 10.0 & 85.2 & 7.2 & 78.0 & 62.0 & 42.0 & 39.9 \\
 & Quest & 98.0 & 94.0 & 2.0 & 70.0 & 32.0 & 0.0 & 49.5 & 46.0 & 91.2 & 7.0 & 84.7 & 52.0 & 40.0 & 51.3 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 4.4 & 67.3 & 0.0 & 4.0 & 5.8 \\
 & Hybrid & \textbf{100.0} & 96.0 & 76.0 & 72.0 & 72.0 & 40.0 & 71.5 & 59.5 & 90.8 & \textbf{44.2} & 82.0 & \textbf{68.0} & \textbf{50.0} & 70.9 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{86.0} & \textbf{86.0} & \textbf{90.0} & \textbf{48.0} & \textbf{87.0} & \textbf{93.5} & \textbf{96.0} & 25.8 & \textbf{86.7} & \textbf{68.0} & 48.0 & \textbf{78.1} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 98.0 & 76.0 & 82.0 & 92.0 & 64.0 & 82.5 & 77.0 & 90.4 & 34.8 & 93.3 & 68.0 & 48.0 & 77.4 \\
 & DuoAttention & 10.0 & 8.0 & 8.0 & 6.0 & 6.0 & 2.0 & 4.0 & 4.5 & 4.8 & 1.8 & 84.0 & 34.0 & 32.0 & 15.8 \\
 & SnapKV & \textbf{100.0} & 70.0 & 0.0 & 58.0 & 30.0 & 0.0 & 12.5 & 22.0 & 92.0 & 15.8 & 80.0 & 64.0 & 46.0 & 45.4 \\
 & Quest & 92.0 & 78.0 & 32.0 & 68.0 & 64.0 & 8.0 & 67.0 & 59.0 & 90.0 & 24.8 & \textbf{89.3} & \textbf{68.0} & 46.0 & 60.5 \\
 & SparQ & 0.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.5 & 0.0 & 0.0 & 9.4 & 88.0 & 0.0 & 4.0 & 8.0 \\
 & Hybrid & \textbf{100.0} & 98.0 & 76.0 & 78.0 & 84.0 & \textbf{60.0} & 74.0 & 68.5 & 94.4 & \textbf{43.4} & 85.3 & 66.0 & \textbf{48.0} & 75.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{86.0} & \textbf{88.0} & \textbf{90.0} & 56.0 & \textbf{88.0} & \textbf{93.0} & \textbf{96.4} & 30.0 & 88.7 & 66.0 & \textbf{48.0} & \textbf{79.2} \\
\hline
\end{tabular}
}
\end{table*}




%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\begin{table*}[t]
\centering
\caption{Average results of LongBench and NIAH for \longchat}
\scalebox{0.85}{%
\begin{tabular}{llllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{Single QA}} & \rotatebox{45}{\textbf{Multi. QA}} & \rotatebox{45}{\textbf{Summ.}} & \rotatebox{45}{\textbf{Few-shot}} & \rotatebox{45}{\textbf{Synthetic}} & \rotatebox{45}{\textbf{Code}} & \rotatebox{45}{\textbf{LB Avg.}} & \rotatebox{45}{\textbf{NIAH(\%)}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 31.1 & 24.1 & 26.7 & 57.7 & 15.2 & 57.0 & 37.5 & 96.3 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 30.5 & 23.5 & 26.5 & 53.9 & 14.8 & 58.3 & 36.6 & 96.7 \\
 & DuoAttention & 14.7 & 15.8 & 14.4 & 29.8 & 2.4 & 48.5 & 21.7 & 20.7 \\
 & SnapKV & 24.4 & 21.8 & N/A & 42.7 & \textbf{15.0} & 52.2 & N/A & 16.7 \\
 & Quest & 9.2 & 7.2 & 7.8 & 11.4 & 0.9 & 34.4 & 11.8 & 15.3 \\
 & SparQ & 18.9 & 11.2 & 15.2 & 16.8 & 1.5 & 32.4 & 16.9 & 21.0 \\
 & Hybrid & 28.2 & \textbf{23.7} & \textbf{25.1} & 49.4 & 13.0 & 54.4 & \textbf{34.1} & 58.0 \\
 & RocketKV & \textbf{29.6} & 22.5 & 23.1 & \textbf{50.9} & 7.0 & \textbf{57.9} & 33.8 & \textbf{93.7} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 30.8 & 23.9 & 26.7 & 54.4 & 14.5 & 57.6 & 36.8 & 96.3 \\
 & DuoAttention & 18.1 & 20.4 & 19.5 & 37.7 & 3.2 & 49.4 & 26.1 & 23.7 \\
 & SnapKV & 27.8 & 23.5 & N/A & 50.0 & 13.5 & 55.0 & N/A & 58.3 \\
 & Quest & 20.7 & 15.6 & 16.8 & 32.5 & 7.6 & 46.4 & 24.2 & 48.0 \\
 & SparQ & 26.5 & 21.4 & 23.6 & 41.5 & 13.5 & 49.1 & 30.9 & 38.0 \\
 & Hybrid & \textbf{30.6} & \textbf{24.8} & \textbf{26.5} & 52.3 & \textbf{14.2} & 57.2 & \textbf{36.3} & 90.7 \\
 & RocketKV & 30.3 & 23.1 & 24.0 & \textbf{52.6} & 8.8 & \textbf{57.7} & 34.9 & \textbf{95.7} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 30.7 & 23.9 & 26.8 & 54.3 & 14.2 & 57.4 & 36.7 & 96.3 \\
 & DuoAttention & 20.8 & 20.7 & 21.0 & 42.0 & 4.0 & 53.6 & 28.5 & 28.0 \\
 & SnapKV & 28.7 & 24.0 & 22.2 & 52.6 & 14.5 & 56.2 & 34.9 & 76.0 \\
 & Quest & 28.2 & 23.0 & 23.6 & 47.9 & \textbf{17.2} & 53.3 & 33.8 & 77.0 \\
 & SparQ & 29.7 & 22.9 & 26.4 & 53.3 & \textbf{17.2} & 55.9 & 36.1 & 76.7 \\
 & Hybrid & \textbf{30.7} & \textbf{24.2} & \textbf{27.0} & 53.8 & 14.0 & \textbf{57.9} & \textbf{36.7} & 95.7 \\
 & RocketKV & 30.4 & 23.0 & 25.2 & \textbf{54.0} & 11.5 & 57.4 & 35.7 & \textbf{96.3} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 30.7 & 24.0 & 26.8 & 54.4 & 15.0 & 57.3 & 36.8 & 96.3 \\
 & DuoAttention & 26.0 & 20.2 & 23.1 & 46.3 & 3.8 & 55.0 & 30.9 & 42.3 \\
 & SnapKV & 29.9 & 24.1 & 24.4 & 54.2 & 14.5 & 56.6 & 36.0 & 85.0 \\
 & Quest & 30.0 & \textbf{24.2} & 26.5 & 53.3 & \textbf{15.5} & 56.3 & 36.3 & 89.7 \\
 & SparQ & 30.6 & 24.1 & \textbf{26.9} & \textbf{54.6} & 14.5 & 56.8 & 36.7 & 96.0 \\
 & Hybrid & 30.7 & 24.1 & 26.8 & \textbf{54.6} & 14.5 & \textbf{57.3} & \textbf{36.8} & \textbf{96.3} \\
 & RocketKV & \textbf{31.1} & 23.8 & 26.2 & 54.3 & 13.2 & 57.1 & 36.4 & \textbf{96.3} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 31.0 & 24.0 & 26.6 & 54.4 & 15.5 & 57.2 & 36.9 & 96.3 \\
 & DuoAttention & 28.6 & 22.4 & 25.4 & 50.5 & 10.5 & 55.2 & 34.1 & 67.3 \\
 & SnapKV & 30.9 & \textbf{24.2} & 25.9 & \textbf{55.0} & 14.8 & 57.0 & \textbf{36.8} & 89.0 \\
 & Quest & 30.7 & \textbf{24.2} & \textbf{27.0} & 54.3 & 14.2 & \textbf{57.3} & \textbf{36.8} & \textbf{96.3} \\
 & SparQ & 30.8 & 23.9 & 26.7 & 54.6 & \textbf{15.0} & 57.2 & \textbf{36.8} & 94.3 \\
 & Hybrid & \textbf{31.0} & 23.9 & 26.8 & 54.4 & 14.2 & \textbf{57.3} & \textbf{36.8} & \textbf{96.3} \\
 & RocketKV & \textbf{31.0} & \textbf{24.2} & 26.5 & 54.7 & 14.2 & 57.2 & \textbf{36.8} & 96.0 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Individual results of LongBench for \longchat}
\scalebox{0.55}{%
\begin{tabular}{llllllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{narrativeqa}} & \rotatebox{45}{\textbf{qasper}} & \rotatebox{45}{\textbf{mul.fieldqa}} & \rotatebox{45}{\textbf{hotpotqa}} & \rotatebox{45}{\textbf{2wikimqa}} & \rotatebox{45}{\textbf{musique}} & \rotatebox{45}{\textbf{gov-report}} & \rotatebox{45}{\textbf{qmsum}} & \rotatebox{45}{\textbf{multi-news}} & \rotatebox{45}{\textbf{trec}} & \rotatebox{45}{\textbf{triviaqa}} & \rotatebox{45}{\textbf{samsum}} & \rotatebox{45}{\textbf{pass-ret.}} & \rotatebox{45}{\textbf{lcc}} & \rotatebox{45}{\textbf{repobench-p}} & \rotatebox{45}{\textbf{passagecnt}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 20.8 & 29.4 & 43.1 & 33.0 & 24.4 & 14.7 & 30.8 & 22.8 & 26.7 & 66.5 & 84.0 & 22.5 & 30.5 & 54.7 & 59.2 & 0.0 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 19.6 & 30.2 & 41.6 & 33.7 & 23.5 & 13.5 & 30.6 & 22.5 & 26.3 & 65.5 & 83.5 & 12.7 & 29.5 & 57.7 & 58.9 & 0.0 \\
 & DuoAttention & 12.4 & 10.1 & 21.6 & 18.6 & 20.5 & 8.1 & 12.6 & 18.7 & 11.8 & 13.5 & 65.9 & \textbf{9.8} & 4.8 & 48.6 & 48.3 & 0.0 \\
 & SnapKV & 15.8 & 20.2 & 37.3 & 29.9 & 23.4 & 12.2 & N/A & N/A & N/A & 39.5 & \textbf{83.0} & 5.5 & \textbf{28.5} & 51.7 & 52.6 & 1.5 \\
 & Quest & 1.7 & 13.8 & 12.0 & 8.3 & 12.4 & 0.9 & 2.9 & 4.1 & 16.5 & 18.0 & 14.7 & 1.5 & 1.1 & 43.1 & 25.6 & 0.8 \\
 & SparQ & 2.5 & 27.3 & 26.8 & 12.9 & 19.4 & 1.2 & 10.4 & 9.8 & 25.3 & 22.5 & 25.4 & 2.5 & 2.5 & 44.8 & 20.0 & 0.5 \\
 & Hybrid & 14.1 & \textbf{29.8} & 40.7 & \textbf{35.0} & \textbf{23.8} & 12.3 & \textbf{27.3} & 21.3 & \textbf{26.7} & \textbf{62.0} & 78.3 & 7.8 & 24.1 & \textbf{57.8} & 50.9 & \textbf{2.0} \\
 & RocketKV & \textbf{18.8} & 28.6 & \textbf{41.3} & 31.0 & 23.4 & \textbf{13.3} & 24.6 & \textbf{22.1} & 22.7 & \textbf{62.0} & 82.5 & 8.1 & 13.5 & 57.4 & \textbf{58.4} & 0.5 \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 20.1 & 30.5 & 41.9 & 33.9 & 23.8 & 14.0 & 30.6 & 22.9 & 26.6 & 66.0 & 84.4 & 12.9 & 29.0 & 56.4 & 58.8 & 0.0 \\
 & DuoAttention & 13.1 & 15.9 & 25.4 & 28.0 & 24.1 & 9.2 & 19.4 & 19.3 & 19.7 & 31.5 & 72.2 & 9.5 & 5.5 & 50.6 & 48.3 & 1.0 \\
 & SnapKV & 17.5 & 25.8 & 40.2 & 33.4 & 23.6 & 13.6 & N/A & N/A & N/A & 55.5 & \textbf{84.8} & \textbf{9.7} & 27.0 & 53.5 & 56.5 & 0.0 \\
 & Quest & 5.0 & 26.8 & 30.2 & 21.3 & 19.8 & 5.8 & 11.4 & 13.9 & 25.2 & 42.5 & 51.4 & 3.5 & 13.8 & 54.0 & 38.8 & \textbf{1.5} \\
 & SparQ & 10.3 & 29.6 & 39.5 & 30.6 & 24.1 & 9.6 & 23.9 & 20.5 & \textbf{26.5} & 62.0 & 58.0 & 4.6 & 26.1 & 54.6 & 43.5 & 1.0 \\
 & Hybrid & 19.1 & \textbf{29.8} & \textbf{42.8} & \textbf{35.1} & \textbf{24.3} & \textbf{15.1} & \textbf{30.8} & \textbf{22.4} & 26.4 & 64.5 & 83.6 & 8.8 & \textbf{28.0} & \textbf{57.3} & 57.2 & 0.5 \\
 & RocketKV & \textbf{20.3} & 28.9 & 41.8 & 32.3 & 23.7 & 13.4 & 26.3 & 22.3 & 23.3 & \textbf{65.0} & 83.2 & 9.4 & 17.5 & 57.2 & \textbf{58.1} & 0.0 \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 20.5 & 29.7 & 42.0 & 33.5 & 24.2 & 14.2 & 30.9 & 23.2 & 26.4 & 65.5 & 84.4 & 13.1 & 28.5 & 55.7 & 59.1 & 0.0 \\
 & DuoAttention & 13.5 & 18.1 & 30.7 & 28.2 & \textbf{24.8} & 9.2 & 20.2 & 19.9 & 22.9 & 43.5 & 72.8 & 9.7 & 6.5 & 56.6 & 50.6 & 1.5 \\
 & SnapKV & 19.3 & 26.9 & 40.1 & \textbf{35.5} & 23.2 & 13.3 & 21.4 & 22.0 & 23.1 & 62.5 & 83.8 & \textbf{11.4} & 29.0 & 53.9 & 58.4 & 0.0 \\
 & Quest & 13.2 & 29.5 & 42.0 & 33.1 & 24.4 & 11.5 & 23.6 & 21.4 & 25.9 & 63.0 & 76.5 & 4.1 & 32.0 & 55.9 & 50.8 & \textbf{2.5} \\
 & SparQ & 17.8 & 29.6 & 41.8 & 32.6 & 23.3 & 12.7 & 30.3 & 22.7 & 26.3 & 66.5 & 83.2 & 10.3 & \textbf{33.0} & 55.6 & 56.2 & 1.5 \\
 & Hybrid & 20.4 & \textbf{30.5} & 41.2 & 34.2 & 23.7 & \textbf{14.9} & \textbf{31.4} & \textbf{23.0} & \textbf{26.5} & 65.5 & \textbf{84.6} & \textbf{11.4} & 28.0 & \textbf{57.2} & \textbf{58.6} & 0.0 \\
 & RocketKV & \textbf{20.5} & 28.6 & \textbf{42.1} & 32.6 & 23.5 & 12.9 & 28.0 & 22.6 & 25.1 & \textbf{67.5} & 83.2 & 11.3 & 22.5 & 56.4 & 58.5 & 0.5 \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 20.3 & 29.5 & 42.4 & 33.2 & 24.7 & 14.2 & 31.1 & 22.9 & 26.5 & 66.0 & 84.2 & 12.9 & 30.0 & 55.3 & 59.4 & 0.0 \\
 & DuoAttention & 13.9 & 26.6 & 37.4 & 27.8 & \textbf{25.4} & 7.4 & 23.3 & 19.9 & 26.1 & 55.5 & 74.4 & 9.1 & 6.5 & \textbf{56.5} & 53.5 & \textbf{1.0} \\
 & SnapKV & 20.3 & 28.2 & 41.2 & 33.7 & 24.3 & \textbf{14.5} & 25.2 & 22.6 & 25.4 & 65.0 & \textbf{84.8} & 12.8 & 29.0 & 54.5 & 58.7 & 0.0 \\
 & Quest & 18.4 & \textbf{30.4} & 41.3 & \textbf{34.7} & 23.9 & 13.9 & 30.2 & 22.7 & \textbf{26.5} & \textbf{67.5} & 83.5 & 8.9 & \textbf{30.0} & 56.2 & 56.5 & \textbf{1.0} \\
 & SparQ & 20.3 & 29.5 & 42.0 & 33.3 & 24.7 & 14.4 & \textbf{31.3} & \textbf{22.9} & \textbf{26.5} & 66.0 & 84.5 & \textbf{13.3} & 29.0 & 55.1 & 58.4 & 0.0 \\
 & Hybrid & 20.3 & 29.9 & 42.0 & 34.3 & 24.2 & 13.8 & 31.2 & 22.6 & 26.4 & 67.0 & 84.4 & 12.4 & 29.0 & 55.5 & \textbf{59.1} & 0.0 \\
 & RocketKV & \textbf{20.6} & 29.1 & \textbf{43.5} & 32.6 & 24.5 & 14.2 & 29.6 & 22.8 & 26.1 & \textbf{67.5} & 83.8 & 11.6 & 26.5 & 55.1 & \textbf{59.1} & 0.0 \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 21.0 & 29.4 & 42.6 & 33.0 & 24.3 & 14.6 & 30.7 & 22.6 & 26.5 & 66.5 & 84.0 & 12.8 & 31.0 & 55.1 & 59.4 & 0.0 \\
 & DuoAttention & 14.2 & 29.6 & 42.1 & 32.2 & 23.9 & 11.1 & 28.6 & 21.1 & 26.5 & 64.0 & 78.3 & 9.1 & 20.5 & \textbf{55.7} & 54.6 & \textbf{0.5} \\
 & SnapKV & 20.6 & 29.4 & 42.7 & \textbf{34.1} & 24.2 & \textbf{14.4} & 28.3 & \textbf{23.0} & 26.4 & \textbf{67.5} & 84.2 & \textbf{13.3} & 29.5 & 55.0 & 59.1 & 0.0 \\
 & Quest & 20.5 & \textbf{29.8} & 41.9 & 33.9 & 24.8 & 14.0 & \textbf{31.4} & 22.8 & \textbf{26.7} & 67.0 & \textbf{84.3} & 11.6 & 28.5 & 55.4 & 59.2 & 0.0 \\
 & SparQ & \textbf{21.0} & 29.0 & 42.5 & 33.2 & 24.2 & 14.3 & 30.7 & 22.8 & 26.6 & 66.5 & 84.2 & 13.1 & \textbf{30.0} & 55.1 & \textbf{59.4} & 0.0 \\
 & Hybrid & 20.8 & 29.2 & \textbf{43.2} & 33.5 & 24.2 & 14.1 & 31.0 & 22.9 & 26.5 & 66.0 & 84.2 & 12.9 & 28.5 & 55.3 & 59.3 & 0.0 \\
 & RocketKV & 20.1 & \textbf{29.8} & \textbf{43.2} & 33.2 & \textbf{25.1} & \textbf{14.4} & 30.2 & 22.7 & 26.6 & 67.0 & \textbf{84.3} & 12.8 & 28.5 & 54.9 & \textbf{59.4} & 0.0 \\
\hline
\end{tabular}
}
\end{table*}





\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=8000 for \longchat}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 96.0 & 98.0 & 100.0 & 74.0 & 96.0 & 69.0 & 94.0 & 33.8 & 80.7 & 70.0 & 58.0 & 82.3 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 96.0 & 96.0 & 94.0 & 100.0 & 84.0 & 88.0 & 60.0 & 90.8 & 39.4 & 76.7 & 66.0 & 58.0 & 80.7 \\
 & DuoAttention & 4.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.0 & 2.0 & 2.0 & 1.2 & 1.6 & 3.3 & 28.0 & 24.0 & 5.2 \\
 & SnapKV & 94.0 & 28.0 & 0.0 & 6.0 & 2.0 & 0.0 & 0.0 & 0.0 & 41.6 & 11.4 & 46.0 & 58.0 & 48.0 & 25.8 \\
 & Quest & 52.0 & 56.0 & 0.0 & 28.0 & 0.0 & 0.0 & 4.5 & 7.0 & 30.8 & 12.4 & 46.0 & 6.0 & 18.0 & 20.1 \\
 & SparQ & 4.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.0 & 0.5 & 0.0 & 20.0 & 30.4 & 35.3 & 46.0 & 40.0 & 13.7 \\
 & Hybrid & \textbf{98.0} & 86.0 & 72.0 & \textbf{78.0} & 92.0 & \textbf{30.0} & 80.0 & 27.5 & \textbf{89.2} & 31.8 & \textbf{71.3} & \textbf{72.0} & \textbf{56.0} & 68.0 \\
 & RocketKV & 96.0 & \textbf{88.0} & \textbf{84.0} & 76.0 & \textbf{96.0} & 10.0 & \textbf{81.5} & \textbf{53.5} & \textbf{89.2} & \textbf{33.6} & 70.7 & 66.0 & 54.0 & \textbf{69.1} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 98.0 & 96.0 & 96.0 & 100.0 & 82.0 & 92.5 & 64.0 & 91.2 & 36.6 & 78.0 & 64.0 & 58.0 & 81.3 \\
 & DuoAttention & 8.0 & 12.0 & 2.0 & 4.0 & 4.0 & 0.0 & 8.5 & 3.0 & 0.0 & 0.4 & 52.7 & 30.0 & 26.0 & 11.6 \\
 & SnapKV & \textbf{100.0} & 84.0 & 0.0 & 64.0 & 14.0 & 0.0 & 17.5 & 4.5 & 89.6 & 20.2 & 51.3 & 64.0 & 50.0 & 43.0 \\
 & Quest & 98.0 & 74.0 & 2.0 & 36.0 & 68.0 & 0.0 & 45.5 & 21.0 & 83.6 & 30.4 & 71.3 & 38.0 & 40.0 & 46.8 \\
 & SparQ & 98.0 & 94.0 & 56.0 & 76.0 & 92.0 & 16.0 & 39.0 & 23.0 & 78.0 & \textbf{38.4} & 70.0 & \textbf{72.0} & 56.0 & 62.2 \\
 & Hybrid & \textbf{100.0} & 96.0 & 84.0 & 94.0 & \textbf{100.0} & \textbf{74.0} & 85.0 & 51.5 & 88.8 & 37.0 & 71.3 & 68.0 & 58.0 & 77.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{96.0} & \textbf{100.0} & 36.0 & \textbf{95.0} & \textbf{67.5} & \textbf{90.0} & 33.6 & \textbf{72.0} & 68.0 & \textbf{60.0} & \textbf{78.0} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 96.0 & 98.0 & 100.0 & 80.0 & 97.0 & 68.0 & 93.2 & 34.4 & 82.0 & 62.0 & 56.0 & 82.0 \\
 & DuoAttention & 12.0 & 12.0 & 0.0 & 4.0 & 4.0 & 0.0 & 8.5 & 5.0 & 1.2 & 0.8 & 62.0 & 32.0 & 30.0 & 13.2 \\
 & SnapKV & \textbf{100.0} & 88.0 & 6.0 & 92.0 & 34.0 & 2.0 & 63.5 & 21.5 & 91.2 & 29.8 & 60.0 & \textbf{68.0} & 58.0 & 54.9 \\
 & Quest & \textbf{100.0} & 90.0 & 30.0 & 80.0 & 78.0 & 24.0 & 80.0 & 49.5 & \textbf{92.4} & 32.8 & 73.3 & 66.0 & 54.0 & 65.4 \\
 & SparQ & \textbf{100.0} & \textbf{98.0} & 94.0 & \textbf{98.0} & \textbf{100.0} & 66.0 & \textbf{93.0} & 67.0 & 91.2 & 35.2 & \textbf{79.3} & 66.0 & 56.0 & 80.3 \\
 & Hybrid & \textbf{100.0} & \textbf{98.0} & \textbf{96.0} & 96.0 & \textbf{100.0} & \textbf{86.0} & 91.0 & 62.0 & \textbf{92.4} & \textbf{37.0} & 74.7 & 66.0 & 58.0 & \textbf{81.3} \\
 & RocketKV & \textbf{100.0} & \textbf{98.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 52.0 & 92.5 & \textbf{68.5} & \textbf{92.4} & 32.8 & 78.7 & \textbf{68.0} & \textbf{62.0} & 79.9 \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 96.0 & 98.0 & 100.0 & 80.0 & 96.5 & 69.0 & 92.8 & 34.4 & 82.7 & 66.0 & 58.0 & 82.6 \\
 & DuoAttention & 48.0 & 76.0 & 18.0 & 78.0 & 66.0 & 26.0 & 61.5 & 28.5 & 14.8 & 1.6 & 76.7 & 60.0 & 48.0 & 46.4 \\
 & SnapKV & \textbf{100.0} & 98.0 & 62.0 & 96.0 & 52.0 & 8.0 & 77.5 & 52.0 & \textbf{92.8} & 34.2 & 64.7 & 64.0 & 58.0 & 66.1 \\
 & Quest & \textbf{100.0} & 98.0 & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & \textbf{84.0} & 96.0 & \textbf{70.0} & \textbf{92.8} & 34.2 & 74.0 & \textbf{68.0} & 58.0 & 82.2 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 80.0 & 97.0 & 68.5 & \textbf{92.8} & 34.0 & \textbf{82.0} & 66.0 & 58.0 & \textbf{82.5} \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 80.0 & \textbf{98.0} & 67.0 & 91.2 & \textbf{36.6} & 79.3 & 62.0 & 58.0 & 82.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 74.0 & 95.5 & 68.0 & \textbf{92.8} & 33.2 & 80.7 & 64.0 & \textbf{60.0} & 81.7 \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 96.0 & 98.0 & 100.0 & 74.0 & 96.5 & 70.0 & 93.6 & 33.8 & 82.7 & 70.0 & 58.0 & 82.5 \\
 & DuoAttention & 98.0 & \textbf{100.0} & 88.0 & 96.0 & \textbf{100.0} & 64.0 & \textbf{97.0} & \textbf{74.5} & 85.6 & \textbf{35.0} & 82.0 & 66.0 & 58.0 & 80.3 \\
 & SnapKV & \textbf{100.0} & 98.0 & 94.0 & \textbf{98.0} & 88.0 & 26.0 & 92.5 & 65.0 & \textbf{94.0} & 34.4 & 74.0 & 66.0 & \textbf{60.0} & 76.1 \\
 & Quest & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 78.0 & 96.5 & 69.5 & 93.6 & 34.0 & 80.0 & 66.0 & 58.0 & 82.3 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 76.0 & 96.5 & 69.5 & 93.2 & 33.8 & 82.0 & \textbf{70.0} & 58.0 & 82.5 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & \textbf{80.0} & 96.5 & 69.5 & 92.8 & 34.4 & \textbf{82.7} & 66.0 & 58.0 & \textbf{82.6} \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{98.0} & \textbf{100.0} & 74.0 & 96.5 & 71.5 & 92.8 & 33.6 & 82.0 & 66.0 & 58.0 & 82.2 \\
\hline
\end{tabular}
}
\end{table*}





\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=16000 for \longchat}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 96.0 & 94.0 & 98.0 & 42.0 & 84.5 & 50.0 & 82.4 & 18.0 & 72.0 & 64.0 & 44.0 & 72.7 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 98.0 & 98.0 & 86.0 & 100.0 & 54.0 & 74.0 & 44.5 & 75.6 & 38.4 & 70.0 & 58.0 & 44.0 & 72.3 \\
 & DuoAttention & 2.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.0 & 2.5 & 3.5 & 0.8 & 0.4 & 0.7 & 26.0 & 30.0 & 5.2 \\
 & SnapKV & 92.0 & 22.0 & 0.0 & 8.0 & 0.0 & 0.0 & 0.0 & 0.5 & 36.4 & 1.2 & 44.0 & 50.0 & 38.0 & 22.5 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.2 & 12.0 & 0.0 & 6.0 & 1.4 \\
 & SparQ & 6.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.8 & 0.0 & 12.0 & 2.0 & 14.0 & 3.0 \\
 & Hybrid & 96.0 & 86.0 & 24.0 & 38.0 & 22.0 & 0.0 & 36.5 & 11.5 & \textbf{76.8} & \textbf{15.2} & 39.3 & 50.0 & 40.0 & 41.2 \\
 & RocketKV & \textbf{100.0} & \textbf{98.0} & \textbf{96.0} & \textbf{86.0} & \textbf{96.0} & \textbf{38.0} & \textbf{60.0} & \textbf{34.5} & 35.6 & 12.8 & \textbf{64.0} & \textbf{54.0} & \textbf{46.0} & \textbf{63.1} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 98.0 & 84.0 & 100.0 & 54.0 & 78.5 & 50.0 & 76.8 & 29.8 & 73.3 & 58.0 & 44.0 & 72.8 \\
 & DuoAttention & 2.0 & 2.0 & 2.0 & 2.0 & 2.0 & 0.0 & 5.5 & 4.5 & 0.4 & 0.6 & 68.0 & 20.0 & 30.0 & 10.7 \\
 & SnapKV & \textbf{100.0} & 78.0 & 0.0 & 44.0 & 2.0 & 0.0 & 6.5 & 4.5 & 76.0 & 2.4 & 46.7 & 54.0 & 42.0 & 35.1 \\
 & Quest & 58.0 & 46.0 & 0.0 & 20.0 & 2.0 & 0.0 & 16.0 & 0.5 & 61.2 & 8.4 & 48.0 & 4.0 & 16.0 & 21.5 \\
 & SparQ & 46.0 & 54.0 & 0.0 & 6.0 & 10.0 & 0.0 & 5.5 & 0.5 & 64.8 & \textbf{32.6} & 22.0 & 30.0 & 36.0 & 23.6 \\
 & Hybrid & \textbf{100.0} & 96.0 & 90.0 & 68.0 & 62.0 & 8.0 & 72.0 & 47.5 & \textbf{78.8} & 19.6 & 52.0 & 60.0 & \textbf{46.0} & 61.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{94.0} & \textbf{98.0} & \textbf{44.0} & \textbf{77.0} & \textbf{58.0} & 64.0 & 11.2 & \textbf{70.0} & \textbf{64.0} & \textbf{46.0} & \textbf{70.9} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 96.0 & 90.0 & 100.0 & 52.0 & 82.0 & 49.5 & 77.6 & 26.4 & 69.3 & 64.0 & 44.0 & 73.1 \\
 & DuoAttention & 6.0 & 8.0 & 2.0 & 2.0 & 2.0 & 0.0 & 7.0 & 4.5 & 1.2 & 0.6 & 65.3 & 28.0 & 34.0 & 12.4 \\
 & SnapKV & \textbf{100.0} & 86.0 & 0.0 & 76.0 & 14.0 & 0.0 & 25.5 & 11.0 & 77.2 & 9.8 & 57.3 & 56.0 & \textbf{46.0} & 43.0 \\
 & Quest & 94.0 & 98.0 & 8.0 & 74.0 & 42.0 & 0.0 & 55.5 & 19.0 & \textbf{80.0} & 26.0 & 58.7 & 36.0 & 34.0 & 48.1 \\
 & SparQ & \textbf{100.0} & 96.0 & 88.0 & 86.0 & 90.0 & 28.0 & 66.0 & 42.0 & 79.2 & 27.6 & 68.0 & 58.0 & 38.0 & 66.7 \\
 & Hybrid & \textbf{100.0} & 98.0 & \textbf{96.0} & 84.0 & 88.0 & 44.0 & 76.0 & 46.5 & 77.6 & \textbf{29.2} & 60.0 & 56.0 & \textbf{46.0} & 69.3 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & \textbf{94.0} & \textbf{98.0} & \textbf{46.0} & \textbf{81.5} & \textbf{55.5} & 77.6 & 12.4 & \textbf{71.3} & \textbf{60.0} & \textbf{46.0} & \textbf{72.2} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 96.0 & 92.0 & 98.0 & 50.0 & 82.5 & 51.0 & 81.6 & 25.0 & 71.3 & 62.0 & 44.0 & 73.3 \\
 & DuoAttention & 6.0 & 14.0 & 2.0 & 4.0 & 2.0 & 0.0 & 8.5 & 5.0 & 1.2 & 0.4 & 70.0 & 38.0 & 28.0 & 13.8 \\
 & SnapKV & \textbf{100.0} & 90.0 & 12.0 & 84.0 & 28.0 & 0.0 & 44.0 & 19.5 & 78.0 & 15.8 & 64.0 & 60.0 & 44.0 & 49.2 \\
 & Quest & \textbf{100.0} & 92.0 & 64.0 & 82.0 & 80.0 & 16.0 & 80.5 & 48.0 & 77.6 & 26.8 & 69.3 & 52.0 & \textbf{48.0} & 64.3 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & 94.0 & 90.0 & \textbf{100.0} & 54.0 & 82.0 & 53.5 & 77.6 & 21.2 & \textbf{74.7} & \textbf{64.0} & 44.0 & 73.5 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 88.0 & 98.0 & \textbf{56.0} & 81.5 & 52.0 & \textbf{78.8} & \textbf{29.6} & 69.3 & 62.0 & 46.0 & \textbf{73.8} \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{92.0} & 98.0 & 44.0 & \textbf{82.5} & \textbf{58.5} & \textbf{78.8} & 15.0 & 72.0 & 62.0 & \textbf{48.0} & 73.0 \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 96.0 & 92.0 & 98.0 & 44.0 & 84.5 & 52.5 & 82.0 & 20.6 & 70.7 & 62.0 & 44.0 & 72.8 \\
 & DuoAttention & 82.0 & 90.0 & 38.0 & 90.0 & 58.0 & 4.0 & 68.5 & 46.0 & 34.8 & 0.4 & 70.7 & 58.0 & \textbf{46.0} & 52.8 \\
 & SnapKV & \textbf{100.0} & 96.0 & 46.0 & \textbf{92.0} & 42.0 & 4.0 & 67.5 & 37.0 & 78.4 & 20.8 & 65.3 & 60.0 & 44.0 & 57.9 \\
 & Quest & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{92.0} & 96.0 & \textbf{62.0} & 81.5 & \textbf{53.5} & 78.4 & \textbf{26.6} & 68.7 & \textbf{62.0} & 44.0 & \textbf{74.1} \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & 96.0 & \textbf{92.0} & \textbf{98.0} & 48.0 & 81.5 & 52.0 & \textbf{81.6} & 22.4 & 72.0 & \textbf{62.0} & 44.0 & 73.0 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & 96.0 & \textbf{92.0} & \textbf{98.0} & 52.0 & \textbf{83.0} & 53.0 & 79.2 & 26.4 & 70.7 & \textbf{62.0} & 44.0 & 73.6 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & 96.0 & \textbf{92.0} & 96.0 & 40.0 & 82.0 & 51.5 & 79.2 & 18.8 & \textbf{73.3} & \textbf{62.0} & 42.0 & 71.8 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=24000 for \longchat}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 100.0 & 98.0 & 90.0 & 84.0 & 18.0 & 60.5 & 38.5 & 79.6 & 5.8 & 70.0 & 50.0 & 36.0 & 63.9 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 98.0 & 98.0 & 88.0 & 78.0 & 16.0 & 46.5 & 39.0 & 60.0 & 24.8 & 64.7 & 46.0 & 38.0 & 61.3 \\
 & DuoAttention & 0.0 & 0.0 & 2.0 & 4.0 & 0.0 & 0.0 & 2.0 & 3.0 & 1.2 & 0.4 & 0.0 & 20.0 & 24.0 & 4.4 \\
 & SnapKV & 90.0 & 10.0 & 0.0 & 6.0 & 0.0 & 0.0 & 0.0 & 0.0 & 44.4 & 1.0 & 26.0 & 42.0 & 26.0 & 18.9 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 16.0 & 0.0 & 2.0 & 1.4 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 2.0 & 0.2 \\
 & Hybrid & 78.0 & 40.0 & 0.0 & 22.0 & 0.0 & 0.0 & 5.0 & 1.0 & \textbf{64.4} & \textbf{7.8} & 47.3 & 28.0 & 28.0 & 24.7 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{94.0} & \textbf{88.0} & \textbf{64.0} & \textbf{6.0} & \textbf{46.0} & \textbf{29.5} & 63.2 & 2.6 & \textbf{56.7} & \textbf{50.0} & \textbf{38.0} & \textbf{56.8} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 100.0 & 98.0 & 88.0 & 78.0 & 22.0 & 49.5 & 38.5 & 63.6 & 19.6 & 68.7 & 46.0 & 36.0 & 62.1 \\
 & DuoAttention & 2.0 & 4.0 & 4.0 & 4.0 & 2.0 & 0.0 & 4.5 & 4.0 & 0.4 & 0.6 & 55.3 & 22.0 & 22.0 & 9.6 \\
 & SnapKV & \textbf{100.0} & 28.0 & 0.0 & 28.0 & 2.0 & 0.0 & 2.0 & 3.0 & 70.4 & 2.0 & 30.0 & 48.0 & 30.0 & 26.4 \\
 & Quest & 96.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.5 & 1.5 & 32.8 & 0.6 & 50.7 & 2.0 & 12.0 & 15.1 \\
 & SparQ & 10.0 & 0.0 & 0.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 6.4 & 12.2 & 34.0 & 20.0 & 18.0 & 7.9 \\
 & Hybrid & 90.0 & 86.0 & 70.0 & 64.0 & 44.0 & 0.0 & 34.0 & 28.0 & 64.0 & \textbf{17.6} & 51.3 & \textbf{50.0} & \textbf{42.0} & 49.3 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{92.0} & \textbf{86.0} & \textbf{68.0} & \textbf{6.0} & \textbf{55.5} & \textbf{41.0} & \textbf{70.8} & 2.8 & \textbf{59.3} & \textbf{50.0} & 32.0 & \textbf{58.7} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 100.0 & 98.0 & 86.0 & 82.0 & 20.0 & 58.0 & 35.5 & 66.8 & 12.2 & 70.7 & 46.0 & 34.0 & 62.2 \\
 & DuoAttention & 4.0 & 4.0 & 4.0 & 6.0 & 2.0 & 0.0 & 4.5 & 4.5 & 0.4 & 0.6 & 58.7 & 16.0 & 24.0 & 9.9 \\
 & SnapKV & \textbf{100.0} & 56.0 & 0.0 & 52.0 & 4.0 & 0.0 & 9.0 & 7.5 & 71.2 & 3.2 & 35.3 & \textbf{50.0} & 28.0 & 32.0 \\
 & Quest & 98.0 & 44.0 & 2.0 & 72.0 & 6.0 & 0.0 & 40.0 & 17.0 & 73.6 & 13.2 & 56.0 & 20.0 & 34.0 & 36.6 \\
 & SparQ & 86.0 & 62.0 & 0.0 & 20.0 & 12.0 & 0.0 & 4.5 & 5.5 & \textbf{76.8} & \textbf{27.6} & 26.0 & 48.0 & 34.0 & 31.0 \\
 & Hybrid & \textbf{100.0} & 98.0 & 90.0 & \textbf{88.0} & 76.0 & \textbf{10.0} & 40.0 & 36.5 & 72.0 & 26.2 & 52.0 & \textbf{50.0} & \textbf{42.0} & 60.1 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{96.0} & 86.0 & \textbf{80.0} & 8.0 & \textbf{56.5} & \textbf{38.5} & 73.2 & 2.6 & \textbf{64.7} & 48.0 & 36.0 & \textbf{60.7} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 100.0 & 98.0 & 88.0 & 84.0 & 22.0 & 60.0 & 36.5 & 66.8 & 9.4 & 69.3 & 48.0 & 34.0 & 62.8 \\
 & DuoAttention & 4.0 & 4.0 & 4.0 & 6.0 & 2.0 & 0.0 & 4.5 & 4.5 & 0.4 & 0.4 & 57.3 & 22.0 & 24.0 & 10.2 \\
 & SnapKV & \textbf{100.0} & 72.0 & 2.0 & 66.0 & 12.0 & 0.0 & 18.0 & 15.0 & 77.6 & 5.0 & 48.0 & \textbf{50.0} & 34.0 & 38.4 \\
 & Quest & 90.0 & 74.0 & 42.0 & 68.0 & 50.0 & 0.0 & 57.5 & 24.5 & \textbf{79.2} & \textbf{34.2} & 56.7 & 44.0 & 36.0 & 50.5 \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 90.0 & 82.0 & 10.0 & 57.0 & 38.5 & 63.6 & 11.0 & 65.3 & 48.0 & \textbf{38.0} & 61.6 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & 92.0 & 86.0 & 78.0 & \textbf{28.0} & 53.0 & 39.5 & 76.8 & 21.4 & 62.7 & 46.0 & 36.0 & 63.0 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{92.0} & \textbf{88.0} & 18.0 & \textbf{59.0} & \textbf{44.5} & 76.8 & 2.2 & \textbf{66.7} & \textbf{50.0} & 34.0 & \textbf{63.8} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 100.0 & 98.0 & 90.0 & 84.0 & 20.0 & 63.5 & 36.5 & 68.4 & 7.6 & 72.0 & 48.0 & 36.0 & 63.4 \\
 & DuoAttention & 16.0 & 14.0 & 4.0 & 10.0 & 2.0 & 0.0 & 6.5 & 5.0 & 0.4 & 0.6 & 65.3 & 28.0 & 22.0 & 13.4 \\
 & SnapKV & \textbf{100.0} & 86.0 & 18.0 & 74.0 & 24.0 & 2.0 & 35.0 & 21.0 & 78.0 & 8.4 & 56.7 & 48.0 & 34.0 & 45.0 \\
 & Quest & \textbf{100.0} & 98.0 & 96.0 & 90.0 & 78.0 & 10.0 & \textbf{65.0} & \textbf{48.0} & \textbf{80.0} & \textbf{25.2} & 64.0 & \textbf{50.0} & \textbf{36.0} & \textbf{64.6} \\
 & SparQ & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 90.0 & 82.0 & 18.0 & 61.0 & 38.0 & 65.2 & 7.0 & \textbf{69.3} & 48.0 & \textbf{36.0} & 62.5 \\
 & Hybrid & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & 88.0 & 82.0 & \textbf{22.0} & 58.5 & 38.5 & 67.2 & 12.2 & 66.0 & 46.0 & 34.0 & 62.5 \\
 & RocketKV & \textbf{100.0} & \textbf{100.0} & \textbf{98.0} & \textbf{92.0} & \textbf{88.0} & 16.0 & \textbf{65.0} & 39.0 & 72.8 & 3.6 & 68.7 & \textbf{50.0} & 32.0 & 63.5 \\
\hline
\end{tabular}
}
\end{table*}

\begin{table*}[t]
\centering
\caption{Results of RULER, SeqLen=32000 for \longchat}
\scalebox{0.7}{%
\begin{tabular}{llllllllllllllll}
\hline
\rotatebox{45}{\textbf{Token Budget}} & \rotatebox{45}{\textbf{Method}} & \rotatebox{45}{\textbf{single1}} & \rotatebox{45}{\textbf{single2}} & \rotatebox{45}{\textbf{single3}} & \rotatebox{45}{\textbf{multikey1}} & \rotatebox{45}{\textbf{multikey2}} & \rotatebox{45}{\textbf{multikey3}} & \rotatebox{45}{\textbf{multivalue}} & \rotatebox{45}{\textbf{multiquery}} & \rotatebox{45}{\textbf{vt}} & \rotatebox{45}{\textbf{cwe}} & \rotatebox{45}{\textbf{fwe}} & \rotatebox{45}{\textbf{qa-1}} & \rotatebox{45}{\textbf{qa-2}} & \rotatebox{45}{\textbf{avg}} \\
\hline
\multirow{1}{*}{N/A} & Full-KV & 100.0 & 94.0 & 80.0 & 78.0 & 68.0 & 4.0 & 58.5 & 31.0 & 47.6 & 38.6 & 70.7 & 22.0 & 34.0 & 55.9 \\
\hline
\multirow{7}{*}{256} & Exact-TopK & 100.0 & 88.0 & 82.0 & 78.0 & 70.0 & 8.0 & 49.0 & 25.0 & 39.2 & 53.4 & 57.3 & 18.0 & 30.0 & 53.7 \\
 & DuoAttention & 0.0 & 2.0 & 4.0 & 4.0 & 0.0 & 0.0 & 1.0 & 2.5 & 0.4 & 0.4 & 0.7 & 20.0 & 26.0 & 4.7 \\
 & SnapKV & 80.0 & 2.0 & 0.0 & 2.0 & 0.0 & 0.0 & 0.0 & 0.0 & 13.2 & 0.4 & 13.3 & \textbf{24.0} & \textbf{32.0} & 12.8 \\
 & Quest & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 4.7 & 0.0 & 0.0 & 0.4 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\
 & Hybrid & 60.0 & 4.0 & 0.0 & 8.0 & 0.0 & 0.0 & 1.0 & 0.0 & \textbf{38.0} & 2.0 & 14.0 & 8.0 & 22.0 & 12.1 \\
 & RocketKV & \textbf{100.0} & \textbf{78.0} & \textbf{52.0} & \textbf{66.0} & \textbf{50.0} & \textbf{2.0} & \textbf{34.5} & \textbf{16.5} & 34.4 & \textbf{5.2} & \textbf{45.3} & 20.0 & 28.0 & \textbf{40.9} \\
\hline
\multirow{7}{*}{512} & Exact-TopK & 100.0 & 90.0 & 84.0 & 78.0 & 72.0 & 8.0 & 51.0 & 27.5 & 43.2 & 52.4 & 65.3 & 20.0 & 30.0 & 55.5 \\
 & DuoAttention & 2.0 & 6.0 & 8.0 & 4.0 & 0.0 & 0.0 & 2.5 & 1.5 & 0.0 & 0.4 & 33.3 & 20.0 & 28.0 & 8.1 \\
 & SnapKV & \textbf{100.0} & 14.0 & 0.0 & 12.0 & 0.0 & 0.0 & 0.5 & 1.0 & 34.4 & 1.0 & 11.3 & \textbf{24.0} & 30.0 & 17.6 \\
 & Quest & 24.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.4 & 0.4 & 18.7 & 0.0 & 10.0 & 4.1 \\
 & SparQ & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 6.8 & 1.8 & 10.0 & 2.0 & 14.0 & 2.7 \\
 & Hybrid & 76.0 & 28.0 & 2.0 & 34.0 & 0.0 & 0.0 & 13.5 & 0.5 & 35.2 & \textbf{14.0} & 34.7 & 20.0 & \textbf{32.0} & 22.3 \\
 & RocketKV & 98.0 & \textbf{84.0} & \textbf{78.0} & \textbf{74.0} & \textbf{66.0} & \textbf{2.0} & \textbf{45.0} & \textbf{29.0} & \textbf{37.6} & 6.0 & \textbf{52.0} & \textbf{24.0} & \textbf{32.0} & \textbf{48.3} \\
\hline
\multirow{7}{*}{1024} & Exact-TopK & 100.0 & 90.0 & 84.0 & 78.0 & 72.0 & 6.0 & 50.0 & 26.0 & 44.0 & 49.8 & 68.0 & 20.0 & 32.0 & 55.4 \\
 & DuoAttention & 2.0 & 6.0 & 8.0 & 4.0 & 2.0 & 0.0 & 2.5 & 2.0 & 0.4 & 0.4 & 33.3 & 20.0 & 24.0 & 8.0 \\
 & SnapKV & \textbf{100.0} & 28.0 & 0.0 & 30.0 & 4.0 & 0.0 & 4.5 & 4.0 & 38.4 & 4.0 & 14.7 & \textbf{24.0} & \textbf{34.0} & 22.0 \\
 & Quest & 96.0 & 20.0 & 0.0 & 8.0 & 0.0 & 0.0 & 9.5 & 1.5 & 35.6 & 3.4 & 42.0 & 2.0 & 18.0 & 18.2 \\
 & SparQ & 54.0 & 8.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 20.8 & \textbf{33.0} & 22.0 & 18.0 & \textbf{34.0} & 14.6 \\
 & Hybrid & 94.0 & 64.0 & 72.0 & 70.0 & 12.0 & 0.0 & \textbf{54.0} & 17.5 & 40.0 & 29.2 & 42.7 & 22.0 & 30.0 & 42.1 \\
 & RocketKV & 98.0 & \textbf{94.0} & \textbf{80.0} & \textbf{74.0} & \textbf{64.0} & \textbf{2.0} & 49.0 & \textbf{32.5} & \textbf{41.2} & 9.0 & \textbf{55.3} & \textbf{24.0} & \textbf{34.0} & \textbf{50.5} \\
\hline
\multirow{7}{*}{2048} & Exact-TopK & 100.0 & 90.0 & 82.0 & 78.0 & 68.0 & 6.0 & 51.5 & 27.0 & 47.2 & 47.6 & 73.3 & 20.0 & 30.0 & 55.4 \\
 & DuoAttention & 2.0 & 6.0 & 8.0 & 4.0 & 2.0 & 0.0 & 2.5 & 2.0 & 0.8 & 0.2 & 35.3 & 18.0 & 24.0 & 8.1 \\
 & SnapKV & \textbf{100.0} & 60.0 & 2.0 & 50.0 & 6.0 & 2.0 & 11.5 & 13.0 & 38.4 & 7.8 & 22.7 & 20.0 & 32.0 & 28.1 \\
 & Quest & 88.0 & 90.0 & 0.0 & 46.0 & 14.0 & 0.0 & 50.5 & 17.5 & \textbf{50.0} & 26.6 & 52.0 & 20.0 & 26.0 & 37.0 \\
 & SparQ & 96.0 & 58.0 & 62.0 & \textbf{78.0} & 34.0 & 0.0 & 34.0 & 20.5 & 41.2 & 46.2 & 60.0 & \textbf{22.0} & 28.0 & 44.6 \\
 & Hybrid & \textbf{100.0} & 86.0 & \textbf{86.0} & 76.0 & 44.0 & \textbf{4.0} & 52.0 & 30.5 & 40.4 & \textbf{46.8} & 58.0 & 20.0 & 28.0 & 51.7 \\
 & RocketKV & \textbf{100.0} & \textbf{94.0} & \textbf{86.0} & 74.0 & \textbf{72.0} & 2.0 & \textbf{56.0} & \textbf{34.5} & 41.6 & 13.6 & \textbf{68.7} & 20.0 & \textbf{34.0} & \textbf{53.6} \\
\hline
\multirow{7}{*}{4096} & Exact-TopK & 100.0 & 94.0 & 82.0 & 78.0 & 70.0 & 6.0 & 53.0 & 30.0 & 46.8 & 41.2 & 71.3 & 20.0 & 32.0 & 55.7 \\
 & DuoAttention & 6.0 & 8.0 & 8.0 & 6.0 & 2.0 & 2.0 & 2.5 & 2.5 & 1.6 & 0.0 & 49.3 & 18.0 & 26.0 & 10.1 \\
 & SnapKV & \textbf{100.0} & 76.0 & 6.0 & 70.0 & 8.0 & 0.0 & 21.0 & 17.5 & 40.8 & 12.4 & 37.3 & 20.0 & 32.0 & 33.9 \\
 & Quest & \textbf{100.0} & \textbf{94.0} & 66.0 & \textbf{78.0} & 54.0 & 0.0 & \textbf{58.0} & 27.0 & 45.2 & 44.8 & 57.3 & \textbf{22.0} & 26.0 & 51.7 \\
 & SparQ & \textbf{100.0} & \textbf{94.0} & 84.0 & \textbf{78.0} & 58.0 & 2.0 & 49.5 & 26.5 & \textbf{45.6} & \textbf{47.4} & \textbf{72.0} & 20.0 & 32.0 & 54.5 \\
 & Hybrid & \textbf{100.0} & 90.0 & \textbf{90.0} & 76.0 & 70.0 & \textbf{6.0} & 49.5 & 30.5 & 43.2 & 44.2 & 66.0 & 20.0 & 32.0 & \textbf{55.2} \\
 & RocketKV & \textbf{100.0} & 92.0 & 86.0 & \textbf{78.0} & \textbf{76.0} & 4.0 & 57.5 & \textbf{38.0} & 43.2 & 17.8 & 70.7 & 16.0 & \textbf{36.0} & 55.0 \\
\hline
\end{tabular}
}
\end{table*}

