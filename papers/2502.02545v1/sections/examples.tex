
\begin{figure*}[ht!]
    \centering
    \includegraphics[width=0.99\linewidth]{plots/squares_p4_and_z1z2_d5000_10seeds_overlaps.pdf}
    \caption{Overlap $\normf{\bM}^2 / \Tr(\bQ)$ as a function of the sample complexity $\alpha$. The dots represent numerical simulation results, computed for $n = 5000$ (for the asymmetric method) or $d = 5000$ (for the symmetric method) and averaging over $10$ instances. (\textbf{Left}) Link function $g(z_1,z_2) = z_1z_2$. Solid lines are obtained from state evolution predictions eq. (\ref{eq:overlap_prod_zk},\ref{eq:examples_symmetric_general}). Dashed line at $\alpha_c \approx 0.59375$. (\textbf{Right}) Link function $g(\bz) = p^{-1}\norm{\bz}^2$, $p = 4$. Solid lines are obtained from state evolution predictions eq. (\ref{eq:overlap_asymmetric_squares},\ref{eq:examples_symmetric_general}). Dashed line at $\alpha_c = 2$.}
    \label{fig:z1z2_overlap}
\end{figure*}
In this section we illustrate the framework introduced in Section \ref{sec:main_results} to predict the asymptotic performance of the spectral estimators (\ref{eq:def:spectral_asymmetric},\ref{eq:def:spectral_symmetric}) for specific examples of link functions, providing a comparison between our asymptotic analytical results and finite size numerical simulations for the overlap between the spectral estimators and the weights $\mat{W}_\star$, defined as $m \coloneqq \nicefrac{\normf{\bM}}{\sqrt{\Tr(\bQ)}}$, where $\bM$ and $\bQ$ are the overlap matrices defined in eq. (\ref{eq:def:overlaps_amp}) correspondent to the fixed points in Lemmas \ref{result:1}, \ref{result:2}, \ref{result:3}, \ref{result:4}. In Figure \ref{fig:z1z2_overlap} we compare these theoretical predictions to numerical simulations at finite dimensions, respectively for the link functions $g(z_1,z_2) = z_1z_2$ and $g(\bz) = p^{-1}\norm{\bz}^2$. Additional numerical experiments are presented in Appendix \ref{app:example_details}.
\subsection{Asymmetric spectral method}\label{sec:examples_asymmetric}
%\subsection{$\dgout(y)$ jointly diagonalizable $\forall y$}
We provide closed-form expressions for the overlap parameter $m \coloneqq \nicefrac{\normf{\bM}}{\sqrt{\Tr(\bQ)}}$ of the spectral estimator $\matwhat_{\tens{L}}$ (\ref{eq:def:spectral_asymmetric}), for a selection of examples of link functions. The details of the derivation are given in Appendix \ref{app:example_details}.
\begin{itemize}[leftmargin=2em,wide=1pt]
    \item $g(z\in\R)$ (single-index model):
    \begin{align}
        \alpha_c &= \left(\E_{\rdm{y}\sim\Zout}\left[\left(\Var[z\big|\rdm{y}] - 1\right)^2\right]\right)^{-1},\\
        m^2 &= \Bigg(\frac{\alpha - \alpha_c}{\alpha + \alpha_c^2\E_{\rdm{y}\sim\Zout}\left[\left(\Var[z\big|\rdm{y}] - 1\right)^3\right]}\Bigg)_+
    \end{align}
    \item $g(\bz) = p^{-1}||\bz||^2$:
    \begin{equation}\label{eq:overlap_asymmetric_squares}
        \alpha_c = \frac{p}{2},\quad m^2 = \left(\frac{(2\alpha-p)}{2(\alpha+2)}\right)_+
    \end{equation}
    \item $g(\bz) = \operatorname{sign}(z_1z_2)$: 
    \begin{equation}
        \alpha_c = \frac{\pi^2}{4},\quad m^2 = \left(1-\frac{\pi^2}{4\alpha}\right)_+
    \end{equation}
    \item $g(\bz) = \prod_{k=1}^pz_k$:
   \begin{align}\label{eq:overlap_prod_zk}
        \alpha_c &= \left(\E_{\rdm{y}\sim\Zout}\left[\lambda(\rdm{y})^2\right]\right)^{-1},\\
        m^2 &= \left(\frac{\alpha - \alpha_c}{\alpha + \alpha_c^2\E_{\rdm{y}\sim\Zout}\left[\lambda(\rdm{y})^3\right]}\right)_+,
    \end{align}
    where
    \begin{equation}\label{eq:lambda_prod_zk}
        \lambda(y) = \begin{cases}
            \begin{array}{ll}
              |y|\frac{K_1(|y|)}{K_0(|y|)} +\rdm{y}- 1,   & p = 2 \\
              \frac{2G^{p, 0}_{0, p} \left( y^22^{-p}  \, \bigg| \, \begin{array}{c}
0 \\
\vect{e}_p
\end{array} \right)}{ G^{p, 0}_{0, p} \left( y^22^{-p} \, \bigg| \, \begin{array}{c}
0 \\
\bzero_p
\end{array} \right)} - 1,   & p\geq 3
            \end{array}
        \end{cases}
    \end{equation}
    and the previous expression are written in terms of the modified Bessel function of the second kind and Meijer $G$-function, with the notations $\bzero_p\in\R^p = (0,\ldots,0)^T$ and $\vect{e}_p\in\R^p=(0,\ldots,0,1)^T$.
    \item $g(z_1,z_2) = z_1z_2^{-1}$: $
        \alpha_c = 1,\quad m^2 = (1 -\alpha^{-1})_+$
\end{itemize}

\subsection{Symmetric spectral method}
We provide expressions for the overlap parameter $m \coloneqq \nicefrac{\normf{\bM}}{\sqrt{\Tr(\bQ)}}$ of the spectral estimator $\matwhat_{\tens{T}}$ (\ref{eq:def:spectral_symmetric}), for a selection of examples of link functions.
In all the following cases, the state evolution equations simplify, allowing to write the results as functionals of $\lambda:\R\to\R$, which is a specific to each problem:
\begin{itemize}
    \item $g(z\in\R)$ (single-index model): $\lambda(y) = \Var[z\big|y] - 1$;
    
    \item $g(\bz) = p^{-1}||\bz||^2$: $\lambda(y) = y - 1$;
    \item $g(\bz) = \operatorname{sign}(z_1z_2)$: $\lambda(y) = 2\pi^{-1}y$;
    \item $g(\bz) = \prod_{k=1}^pz_k$: $\lambda(y)$ defined in eq. (\ref{eq:lambda_prod_zk}).
\end{itemize}
For all these example, the value $\alpha_c$ can be found in Section \ref{sec:examples_asymmetric}.
For $\alpha>\alpha_c$, consider $a$ and $\gamma$ solutions of
\begin{align}\label{eq:examples_symmetric_a}
&\E_{\rdm{y}\sim\Zout}\left[\frac{\lambda(\rdm{y})^2}{a(1 + \lambda(\rdm{y})) - \lambda(\rdm{y}) }\right] = \frac{1}{\alpha}\\
\label{eq:examples_symmetric_gamma}
&\gamma = 1 + \alpha\E_{\rdm{y}\sim\Zout}\left[\frac{\lambda(\rdm{y})}{a(1 + \lambda(\rdm{y})) - \lambda(\rdm{y}) }\right].
\end{align}
Then, for any $\alpha$, the overlap $m \coloneqq \nicefrac{\normf{\bM}}{\sqrt{\Tr(\bQ)}} $ is given by
\begin{equation}\label{eq:examples_symmetric_general}
    m^2 = \Bigg(\frac{1 - \alpha\E_{\rdm{y}\sim\Zout}[\lambda^2(\rdm{y})\left(a(1 + \lambda(\rdm{y})) - \lambda(\rdm{y})\right)^{-2}]}{1 + \alpha\E_{\rdm{y}\sim\Zout}[\lambda^3(\rdm{y})\left(a(1+ \lambda(\rdm{y})) - \lambda(\rdm{y})\right)^{-2}] } \Bigg)_+,
\end{equation}
which is strictly positive $\forall \alpha > \alpha_c$. Additional details on the derivation of this result can be found in Appendix \ref{app:details_examples_symmetric}.
