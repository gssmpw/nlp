\section{Combinatorics Proof}
\label{appendix:K}

\begin{tcolorbox}[enhanced, breakable, rounded corners,
    colback=gray!5!white, colframe=gray!75!black,
    colbacktitle=gray!85!black, fonttitle=\bfseries, coltitle=white, title=2024 IMO Problem 5]

\setlength{\parskip}{1em}
We will prove that the minimal number of attempts is $ n = 3 $ by demonstrating both sufficiency and necessity.


\subsection*{Sufficiency ($ n \leq 3 $)}

We will construct a strategy that ensures Turbo reaches the last row in at most three attempts, regardless of monster placement.

\subsubsection*{Attempt 1: Exploring the Second Row}

\begin{itemize}
    \item \textbf{Objective:} Locate the monster in the second row.
    \item \textbf{Action:}
    \begin{itemize}
        \item Turbo starts at cell $ (1,1) $ in the first row.
        \item He moves to cell $ (2,1) $ in the second row.
        \item Turbo moves right across the second row, from $ (2,1) $ to $ (2,2) $, $ (2,3) $, and so on, until he encounters the monster $ M_1 $ at $ (2, c_1) $. Since there is exactly one monster in row 2, he will eventually find it.
    \end{itemize}
    \item \textbf{Outcome:}
    \begin{itemize}
        \item Turbo knows the position of $ M_1 $ at $ (2, c_1) $.
        \item All other cells in the second row are safe.
        \item Column $ c_1 $ contains at most one monster, which Turbo has found at $ (2, c_1) $.
    \end{itemize}
\end{itemize}

\subsubsection*{Attempt 2 and 3: Planning Paths Based on $ M_1 $}

We consider two cases based on the position of $ M_1 $.



\textbf{Case A:} Monster $ M_1 $ is not in the first or last column $( 1 < c_1 < 2023 )$.

\begin{itemize}
    \item \textbf{Attempt 2:}
    \begin{itemize}
        \item Turbo starts from cell $ (1, c_1 - 1) $ in the first row (which is safe, as the first row has no monsters).
        \item He moves down to $ (2, c_1 - 1) $. Since he did not encounter a monster at $ (2, c_1 - 1) $ in Attempt 1, this cell is safe.
        \item Moves down to $ (3, c_1 - 1) $.
        \item If $ (3, c_1 - 1) $ does not contain a monster, he moves right to $ (3, c_1) $, which is in column $ c_1 $ and safe.
        \item Continues down column $ c_1 $ from $ (3, c_1) $ to the last row, because column $ c_1 $ has no other monsters (only at $ (2, c_1) $, which he already knows and can avoid).
    \end{itemize}
    \item \textbf{If Attempt 2 fails:}
    \begin{itemize}
        \item If $ (3, c_1 - 1) $ contains a monster $ M_2 $, the attempt ends.
        \item Turbo knows the position of $ M_1 $ at  $(2,c_1)$ and position of $ M_2 $ at $ (3, c_1 - 1) $
    \end{itemize}
    \item \textbf{Attempt 3:}
    \begin{itemize}
        \item Turbo starts from cell $ (1, c_1 + 1) $ in the first row.
        \item Moves down to $ (2, c_1 + 1) $, which is safe.
        \item Proceeds to $ (3, c_1 + 1) $ which is safe.
        \item Moves left to $ (3, c_1) $ and continues down column $ c_1 $ to the last row.
    \end{itemize}
\end{itemize}

\textbf{Why This Works:}

\begin{itemize}
    \item In row 3, there is exactly one monster. It can be in $ (3, c_1 - 1) $, $ (3, c_1) $, $ (3, c_1 + 1) $, or elsewhere.
    \item Only one of $ (3, c_1 - 1) $ and $ (3, c_1 + 1) $ can contain a monster, because each row contains exactly one monster and each column contains at most one monster.
    \item Therefore, at least one of the paths in Attempt 2 or Attempt 3 will allow Turbo to proceed without encountering a monster in $ (3, c_1 \pm 1) $.
    \item Once at $ (3, c_1) $, Turbo can proceed down column $ c_1 $, which is safe beyond $ (2, c_1) $ (the known monster he can avoid).
\end{itemize}


\textbf{Case B: Monster \( M_1 \) is in the first or last column}

Without loss of generality, suppose the monster $ M_1 $ is in $ (2,1) $.

\begin{itemize}
    \item \textbf{Action:}
    \begin{itemize}
        \item Turbo starts from cell $ (1,3) $ in the first row.
        \item Moves to $ (2,3) $, then follows a staircase pattern:
        \item Moves down to $ (3,3) $, right to $ (3,4) $, down to $ (4,4) $, and so on until he encounters a monster or reaches the bottom row.
    \end{itemize}
\end{itemize}

\textbf{Outcome of Attempt 2:}

\begin{itemize}
    \item Turbo may reach the last row without encountering another monster.
    \item Alternatively, he may encounter a second monster $ M_2 $ at $ (r_2, c_2) $.
\end{itemize}

\subsubsection*{Attempt 3: Planning a Guaranteed Staircase Safe Path}

\begin{itemize}
    \item \textbf{Knowledge:}
    \begin{itemize}
        \item Positions of $ M_1 $ at $ (2, 1) $ and $ M_2 $ at $ (r_2, c_2) $.
        \item Safe path to get to $ (r_2, c_2) $.
    \end{itemize}
    \item \textbf{Action:}
    \begin{itemize}
        \item Turbo follows the staircase safe path until he reaches $ (r_2 - 1, c_2 - 1) $.
        \item Moves down to $ (r_2, c_2 - 1) $ and moves left to $ (r_2, 1) $.
        \item Moves down all the way.
        
    \end{itemize}
    \item \textbf{Outcome:}
    \begin{itemize}
        \item Turbo reaches the last row $ (n, 1) $ without encountering any monsters.
    \end{itemize}
\end{itemize}


\subsection*{Necessity (\( n \geq 3 \))}

We will show that Turbo cannot guarantee reaching the last row in fewer than three attempts.

\subsubsection*{Adversarial Monster Placement}
Suppose the monsters are placed as follows:
\begin{itemize}
    \item Monster \( M_1 \) at \( (2, c) \).
    \item Monster \( M_2 \) at \( (3, c') \), where \( c' \neq c \).
    \item Assume that \( (2, c) \) represents the first cell that Turbo reaches in the second row on his first attempt.
\end{itemize}

\subsubsection*{Analysis} 

\begin{itemize}
    \item \textbf{First Attempt:}
    \begin{itemize}
        \item Turbo cannot avoid encountering \( M_1 \) at \( (2, c) \) without prior knowledge.
    \end{itemize}
    \item \textbf{Second Attempt:}
    \begin{itemize}
        \item Knowing the monster at \( (2, c) \), Turbo must avoid column \( c \) and descend through a different column \( c' \neq c \).
        \item Upon reaching \( (3, c') \), Turbo cannot avoid encountering \( M_2 \), as he does not know its location yet.
        \item Although the cell \( (3, c) \) is safe, Turbo cannot reach it without moving through \( (3, c') \) since he cannot directly access \( (3, c) \) from his current path without passing through an unknown cell that may contain a monster.
    \end{itemize}
    \item \textbf{Conclusion:}
    \begin{itemize}
        \item Without knowledge of both \( M_1 \) and \( M_2 \), Turbo cannot guarantee a safe path in two attempts.
    \end{itemize}
\end{itemize}

Therefore, at least three attempts are necessary.

\subsection*{Conclusion}

We have demonstrated that:

\begin{itemize}
    \item \textbf{Three attempts are sufficient} by using a strategy that leverages the constraints and Turbo's memory, he can always reach the last row in three attempts.
    \item \textbf{Three attempts are necessary} there exist monster placements where fewer than three attempts cannot guarantee success.
\end{itemize}

Therefore, the minimal integer $ n $ is $ 3 $.

\end{tcolorbox}
