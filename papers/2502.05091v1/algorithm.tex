\definecolor{commentcolor}{RGB}{110,154,155}   % Define comment color
\newcommand{\PyComment}[1]{\ttfamily\textcolor{commentcolor}{\# #1}}  % Add "#" before text
\newcommand{\PyCode}[1]{\ttfamily\textcolor{black}{#1}} % Python code font

\begin{algorithm}[h]
\SetAlgoLined
    \PyCode{\textcolor{magenta}{class} DecompConv3D(nn.Module):} \\
    \Indp
        \PyCode{\textcolor{magenta}{def} \_\_init\_\_(self, dim, kernel\_size, stride=1, norm=True, act=None):} \\
        \Indp
            \PyCode{\textcolor{magenta}{super}().\_\_init\_\_()} \\
            \PyComment{Initialize final activation layer} \\            
            \PyCode{self.act = act} \\
            \PyComment{Initialize normalization layer} \\
            \PyCode{self.norm = nn.ModuleList([nn.BatchNorm3d(dim) if norm else nn.Identity() for \_ in range(3)])} \\
            \PyComment{Initialize decomposed convolution layers} \\
            \PyCode{self.c1 = nn.Sequential(} \\
            \Indp
                \PyCode{nn.Conv3d(dim, dim, kernel\_size=(kernel\_size, 1, 1),} \\
                \PyCode{padding=(kernel\_size//2, 0, 0), stride=stride, groups=dim),} \\
                \PyCode{self.norm[0])} \\
            \Indm
            \PyCode{self.c2 = nn.Sequential(} \\
            \Indp
                \PyCode{nn.Conv3d(dim, dim, kernel\_size=(1, kernel\_size, 1),} \\
                \PyCode{padding=(0, kernel\_size//2, 0), stride=stride, groups=dim),} \\
                \PyCode{self.norm[1])} \\
            \Indm
            \PyCode{self.c3 = nn.Sequential(} \\
            \Indp
                \PyCode{nn.Conv3d(dim, dim, kernel\_size=(1, 1, kernel\_size),} \\
                \PyCode{padding=(0, 0, kernel\_size//2), stride=stride, groups=dim),} \\
                \PyCode{self.norm[2])} \\
            \Indm
        \Indm

        \PyCode{\textcolor{magenta}{def} forward(self, x):} \\
        \Indp
            \PyCode{x = self.c1(x) + self.c2(x) + self.c3(x)} \\
            \PyCode{if self.act is not None:} \\
            \Indp
                \PyCode{x = self.act(x)} \\
            \Indm
            \PyCode{\textcolor{magenta}{return} x} \\
        \Indm
    \Indm
\caption{PyTorch-style pseudocode for DecompConv3D}
\label{algo:decompconv3d}
\end{algorithm}



