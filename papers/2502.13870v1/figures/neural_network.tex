%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Welcome to Overleaf --- just edit your LaTeX on the left,
% and we'll compile it for you on the right. If you open the
% 'Share' menu, you can invite other users to edit at the same
% time. See www.overleaf.com/learn for more info. Enjoy!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Author: Izaak Neutelings (September 2021)
% Inspiration:
%   https://www.asimovinstitute.org/neural-network-zoo/
%   https://www.youtube.com/watch?v=aircAruvnKk&list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&index=1
\documentclass[border=0pt,tikz]{standalone}
\usepackage{amsmath} % for aligned
\usepackage{listofitems} % for \readlist to create arrays
\usetikzlibrary{arrows.meta} % for arrow size
\usepackage[outline]{contour} % glow around text
\contourlength{1.4pt}

% COLORS
\usepackage{xcolor}
\definecolor{nblue}{HTML}{9eb988}
\definecolor{dpurple}{HTML}{434752}
\definecolor{lpurple}{HTML}{ffffff}
\definecolor{darkgray}{HTML}{373737}
\definecolor{lightgray}{HTML}{b0b0b0}
% STYLES
\tikzset{
  >=latex, % for default LaTeX arrow head
  node/.style={thick,circle,draw=red,minimum size=22,inner sep=0.5,outer sep=0.6},
  node in/.style={node,draw=gray!60,fill=lpurple},
  node hidden/.style={node,blue!20!black,draw=gray!60,fill=gray!30},
  node convol/.style={node,orange!20!black,draw=gray!60,fill=myorange!20},
  node out/.style={node,gray!60,draw=gray!60,fill=nblue},
  connect/.style={thick,draw=gray!60}, %,line cap=round
  connect arrow/.style={-{Latex[length=4,width=3.5]},thick,draw=gray!60,shorten <=0.5,shorten >=1},
  node 1/.style={node in}, % node styles, numbered for easy mapping with \nstyle
  node 2/.style={node hidden},
  node 3/.style={node out}
}
\def\nstyle{int(\lay<\Nnodlen?min(2,\lay):3)} % map layer number onto 1, 2, or 3\begin{tikzpicture}[]

\begin{document}



% AUTOENCODER
\begin{tikzpicture}[x=2.1cm,y=1.2cm]
  \large
  \message{^^JNeural network without arrows}
  \readlist\Nnod{3,3,1} % array of number of nodes per layer
  % TRAPEZIA
  \fill[black] (0.75, -1.4) rectangle (3.22, 1.4);
    
  \message{^^J  Layer}
  \foreachitem \N \in \Nnod{ % loop over layers
    \def\lay{\Ncnt} % alias of index of current layer
    \pgfmathsetmacro\prev{int(\Ncnt-1)} % number of previous layer
    \message{\lay,}
    \foreach \i [evaluate={\y=\N/2-\i+0.5; \x=\lay; \n=\nstyle;}] in {1,...,\N}{ % loop over nodes
      
      % NODES
      \node[node \n,outer sep=0.6, line width=3] (N\lay-\i) at (\x,\y) {};
      
      % CONNECTIONS
      \ifnum\lay>1 % connect to previous layer
        \foreach \j in {1,...,\Nnod[\prev]}{ % loop over nodes in previous layer
          \draw[connect,white,line width=3] (N\prev-\j) -- (N\lay-\i);
          \draw[connect, line width=3] (N\prev-\j) -- (N\lay-\i);
          %\draw[connect] (N\prev-\j.0) -- (N\lay-\i.180); % connect to left
        }
      \fi % else: nothing to connect first layer
      \node[node \n,outer sep=0.6, line width=3] (N\lay-\i) at (\x,\y) {};
      
    }
  }

\node[node,draw=gray!60,fill=dpurple,outer sep=0.6, line width=3] at (1,-1) {};
  

  
\end{tikzpicture}



\end{document}