\documentclass[border=0cm]{standalone}

\input{john_macros}

\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{graphicx}
\usepackage{overpic}
\usepackage{amsmath,amssymb}
%\usepackage{textcomp}
\usepackage[theoremfont]{newpxtext}
\usepackage{cabin}
%\usepackage[varqu,varl]{inconsolata}
\usepackage[bigdelims,vvarbb]{newpxmath}
%\usepackage[scr=boondoxo]{mathalfa}
\newcommand\hmmax{0}
\newcommand\bmmax{0}
\usepackage{bm}
\usepackage{mathrsfs}

\usepackage{pgfplots}
\usepackage{tikz}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{fillbetween}
\usetikzlibrary{shapes.misc, shapes.geometric, arrows,
positioning, decorations.pathreplacing,calc,shadings}
\tikzstyle{line} = [draw, -latex']

\begin{document}

\begin{tikzpicture}
        \draw [fill=white, dashed] (5,-1) to [out=85,in=-65] (4.8,1) to [out=15,in=160] (9,1) to [out=-45,in=85] (9.75,-1) to [out=160,in=20] cycle;
        \draw [fill=white, dashed] (-1,-1) to [out=85,in=-65] (-1.2,1) to [out=15,in=160] (3,1) to [out=-45,in=85] (3.75,-1) to [out=160,in=20] cycle;
    \draw[color = red!50!blue, dashed] (2.35+6,.5) -- (8.45,1.5);
    \filldraw[color = red] (8.75,.75) circle (2pt);
    \filldraw[color = red] (8.45,1.5) circle (2pt);
    \node at (8.75,1.6) {\color{red} $\mb x$}; 
    %\filldraw[color = red!50!blue] (8.3,.8) circle (2pt);  
    \node at (8.65,.45) {\color{red!50!blue} $\wh{\mb x}$}; 
    \draw [red,dashed] (8.75,.75) -- (8.45,1.5);
    \node at (9.1,.5) {\color{red} $\mb x_\natural$}; 
%    \filldraw[color = gray] (5.5,-.5) circle (2pt); 
%    \filldraw[color = gray] (6.85,.25) circle (2pt); 
%    \filldraw[color = gray] (7.9,.45) circle (2pt); 
%    \draw [blue, thick, -{Stealth[length=3mm]}] (5.5,-.5) -> (6.85,.25);
%    \draw [blue, thick, -{Stealth[length=3mm]}] (6.85,.25) -> (7.9,.45);
%    \draw [blue, thick, -{Stealth[length=3mm]}] (7.9,.45) -> (8.3,.8); 
        \draw [fill=white, dashed] (-7,-1) to [out=85,in=-65] (-7.2,1) to [out=15,in=160] (-3,1) to [out=-45,in=85] (-2.25,-1) to [out=160,in=20] cycle;
    \filldraw[color = black] (-4,.8) circle (2pt);
    \filldraw[color = black] (-6.2,.9) circle (2pt);
    \filldraw[color = black] (-3.2,.6) circle (2pt);
    \filldraw[color = black] (-4.9,1.05) circle (2pt);
    \filldraw[color = black] (-4.2,1.1) circle (2pt);
    \filldraw[color = black] (-5.5,1) circle (2pt);
    \filldraw[color = black] (-6.7,.87) circle (2pt);
    \filldraw[color = black] (-3.6,.96) circle (2pt);
    \filldraw[color = black] (-4.11,.5) circle (2pt);
    \filldraw[color = black] (-6,.5) circle (2pt);
    \filldraw[color = black] (-3,.5) circle (2pt);
    \filldraw[color = black] (-5,.5) circle (2pt);
    \filldraw[color = black] (-4.43,.56) circle (2pt);
    \filldraw[color = black] (-5.41,.57) circle (2pt);
    \filldraw[color = black] (-6.6,.5) circle (2pt);
    \filldraw[color = black] (-3.55,.5) circle (2pt);
    \filldraw[color = black] (-4.02,0) circle (2pt);
    \filldraw[color = black] (-6.3,.3) circle (2pt);
    \filldraw[color = black] (-2.78,-.02) circle (2pt);
    \filldraw[color = black] (-5.15,.06) circle (2pt);
    \filldraw[color = black] (-4.7,0) circle (2pt);
    \filldraw[color = black] (-5.7,.03) circle (2pt);
    \filldraw[color = black] (-6.7,0) circle (2pt);
    \filldraw[color = black] (-3.39,.1) circle (2pt);
    \filldraw[color = black] (-3.96,-.39) circle (2pt);
    \filldraw[color = black] (-6.1,-.3) circle (2pt);
    \filldraw[color = black] (-2.7,-.51) circle (2pt);
    \filldraw[color = black] (-4.91, -.32) circle (2pt);
    \filldraw[color = black] (-4.47,-.22) circle (2pt);
    \filldraw[color = black] (-5.47,-.39) circle (2pt);
    \filldraw[color = black] (-6.5,-.57) circle (2pt);
    \filldraw[color = black] (-3.3,-.33) circle (2pt);
    \node at (-4.75,-1.25) {\bf Data}; 
    \node at (-4.75,-1.65) {$\mb x_1, \dots, \mb x_N$}; 
    \filldraw[color = blue] (-.4,-.32) circle (2pt); 
    \filldraw[color = blue] (-.5,.8) circle (2pt); 
    \draw[color = blue] (-.4,-.32) -- (.35,.4); 
    \draw[color = blue] (.35,.4) -- (-.5,.8);
    \draw[color = blue] (.35,.4) -- (1.15,1);
    \draw[color = blue] (.35,.4) -- (1.35,0); 
    \draw[color = blue] (1.15,1) -- (1.35,0);
    \draw[color = blue] (1.15,1) -- (2.35,.5);
    \draw[color = blue] (1.35,0) -- (2.35,.5); 
    \draw[color = blue] (2.35,.5) -- (3.02,-.29);
    \draw[color = blue] (1.35,0) -- (3.02,-.29); 
    \draw[color = blue] (2.35,.5) -- (2.55,.65); 
 %   \draw[color = blue] (3.02,-.29) -- (3.22,-.22);
 %   \draw[color = blue] (3.02,-.29) -- (3.22,-.42);
 %   \draw[color = blue] (1.15,1) -- (1.35,1.01);
    \filldraw[color = blue] (1.35,0) circle (2pt); 
    \filldraw[color = blue] (3.02,-.29) circle (2pt); 
    \filldraw[color = blue] (1.15,1) circle (2pt);     
    \filldraw[color = blue] (.35,.4) circle (2pt); 
    \filldraw[color = blue] (2.35,.5) circle (2pt); 
    \filldraw[color= red!50!blue, fill opacity = .1] (.81,.16) -- (.58,.81) -- (-.1,.7) -- (.05,.0) -- cycle; 
    \filldraw[color= red, fill opacity = .1] (2.6,-.47) -- (2.7,.103) -- (3.34,-.025) -- (3.3,-.63) -- cycle; 
    \filldraw[color= cyan, fill opacity = .1] (2.1,.2) -- (2.00,.8) -- (2.6,.8) -- (2.73,.2) -- cycle; 
    \filldraw[color= blue, fill opacity = .1] (-.7,-.76) -- (-.8,.0) -- (-.14,.145) -- (0,-.6) -- cycle; 
    \filldraw[color= amber, fill opacity = .1] (-.8,.448) -- (-.95,1.02) -- (-.3,1.178) -- (-.05,.62) -- cycle; 
    \filldraw[color= green, fill opacity = .1] (1.0,-.35) -- (.95,.3) -- (1.6,.35) -- (1.7,-.31) -- cycle; 
    \filldraw[color= orange, fill opacity = .1] (.81,.67) -- (.72,1.27) -- (1.4,1.3) -- (1.57,.7) -- cycle; 
%
    \filldraw[color = blue] (5.6,-.32) circle (2pt); 
    \filldraw[color = gray] (5.5,.8) circle (2pt); 
    \draw[color = blue, ultra thick,-{Stealth[length=3mm]}] (-.4+6,-.32) -- (.35+6,.4); 
    \draw[color = gray] (.35+6,.4) -- (-.5+6,.8);
    \draw[color = gray] (.35+6,.4) -- (1.15+6,1);
    \draw[color = blue, ultra thick,-{Stealth[length=3mm]}] (.35+6,.4) -- (1.35+6,0); 
    \draw[color = gray] (1.15+6,1) -- (1.35+6,0);
    \draw[color = gray] (1.15+6,1) -- (2.35+6,.5);
    \draw[color = blue, ultra thick,-{Stealth[length=3mm]}] (1.35+6,0) -- (2.35+6,.5); 
    \draw[color = gray] (2.35+6,.5) -- (3.02+6,-.29);
    \draw[color = gray] (1.35+6,0) -- (3.02+6,-.29); 
    \draw[color = gray] (2.35+6,.5) -- (2.55+6,.65); 
 %   \draw[color = blue] (3.02,-.29) -- (3.22,-.22);
 %   \draw[color = blue] (3.02,-.29) -- (3.22,-.42);
 %   \draw[color = blue] (1.15,1) -- (1.35,1.01);
    \filldraw[color = blue] (1.35+6,0) circle (2pt); 
    \filldraw[color = gray] (3.02+6,-.29) circle (2pt); 
    \filldraw[color = gray] (1.15+6,1) circle (2pt);     
    \filldraw[color = blue] (.35+6,.4) circle (2pt); 
    \filldraw[color = red!50!blue] (2.35+6,.5) circle (2pt); 
    \filldraw[color= gray, fill opacity = .1] (.81+6,.16) -- (.58+6,.81) -- (-.1+6,.7) -- (.05+6,.0) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (2.6+6,-.47) -- (2.7+6,.103) -- (3.34+6,-.025) -- (3.3+6,-.63) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (2.1+6,.2) -- (2.00+6,.8) -- (2.6+6,.8) -- (2.73+6,.2) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (-.7+6,-.76) -- (-.8+6,.0) -- (-.14+6,.145) -- (0+6,-.6) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (-.8+6,.448) -- (-.95+6,1.02) -- (-.3+6,1.178) -- (-.05+6,.62) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (1.0+6,-.35) -- (.95+6,.3) -- (1.6+6,.35) -- (1.7+6,-.31) -- cycle; 
    \filldraw[color= gray, fill opacity = .1] (.81+6,.67) -- (.72+6,1.27) -- (1.4+6,1.3) -- (1.57+6,.7) -- cycle; 
    %
    \node at (1.35,-1.25) {\bf Tangent Bundle Graph};
    \node at (1.35,-1.65) {Landmarks $\mb q_i$, subspaces $\mr{span}(\mb U_i)$};
    \node at (7.5,-1.25) {\bf Optimization};
    \node at (-1.7,.2) {$\Rightarrow$};
    \node at (4.3,.2) {$\Rightarrow$}; 
\end{tikzpicture}

\end{document}
