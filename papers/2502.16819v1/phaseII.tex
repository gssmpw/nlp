
{
\begin{lemma}\label{Phase II Probability bound on H}
Given noise vector $\mb z \simiid \mc N(0,\sigma^2)$, let $H = \max_{\mb q \in Q}\left\|P_{T_{\mb q}\mc M} \mb z \right\|$. 
Then, with probability at least $1 - e^{-\frac{9d}{2}}$, we have
\begin{equation}
 H \le \sigma\left(4\sqrt{\log|Q|}+10\sqrt{d}\right).
\end{equation}
\end{lemma}
\begin{proof}
For any landmark $\mb q$, we define set $S_{\mb q} = \left\{\mb v \in T_qM: \|\mb v\| = 1\right\}$. From Corrollary 4.2.13 in \cite{vershynin2018high}, we know that for any $\delta$, $S_q$ can be $\delta$-covered by at most $\left(\frac{1+\delta/2}{\delta/2}\right)^d = \left(1+\frac{2}{\delta}\right)^d$ points. In particular, we can choose $\delta =\frac{1}{2}$ and let $C_{\mb q}$ to be a 1/2 cover of $S_{\mb q}$ such that $|C_q| \le 5^d$. We let $S_Q = \cup_{\mb q\in Q}S_q$ and $C_Q = \cup_{\mb q\in Q}C_q$. Then, we have
\begin{align}
H &= \max_{\mb u \in S_Q} \innerprod{\mb u}{\mb z} \\
  &\le \max_{\mb v \in C_Q} \innerprod{\mb v}{\mb z} + \frac{1}{2}H, \\
\end{align}
this implies 
\begin{equation}\label{upper bound H by covering}
H \le 2 \max_{\mb v \in C_Q} \innerprod{\mb v}{\mb z}.
\end{equation}
Let $h(\mb z) = \max_{\mb v \in C_Q} \innerprod{\mb v}{\mb z}$, and since it's a 1-lipshitz function in $\mb z$, by applying gaussian concentration inequality, we have 
\begin{equation}\label{eq:Gaussian Concentration Bounds for Liptshiz function}
    \mathbb P\left(h(\mb z) - \mathbb E[h(\mb z)] \geq s \right) \leq e^{-\frac{s^2}{2\sigma^2}}.
\end{equation}
We  then bound its expectation. For any $t>0$,
\begin{equation}
    \begin{aligned}
        e^{t \mathbb E[h(\mb z)]}
        &\le \mathbb E[e^{t [h(\mb z)]}]\\
        &= \mathbb E[e^{t\max_{\mb v \in C_Q} \innerprod{\mb v}{\mb z}}] \\
        &\leq \sum_{\mb v \in C_Q} \mathbb E[e^{t\innerprod{\mb v}{\mb z}}] \\
        &= |C_Q| e^{\frac{1}{2}\sigma^2 t^2}.
    \end{aligned}
\end{equation}
Take logarithm of both sides, we have
\begin{equation}\label{eq:take log again}
    \E{h(\mb z)}
    \leq \frac{\log|C_Q|}{t} + \frac{ \sigma^2 t}{2}.
\end{equation}
When $t = \frac{\sqrt{2 \log |C_Q|}}{\sigma}$, the right hand side of equation \eqref{eq:take log again} is minimized, and we obtain
\begin{equation}
    \E{h(\mb z)}
     \leq \sqrt{2} \sigma \sqrt{\log |C_Q|} 
     = \sqrt{2} \sigma \sqrt{d\log5 +\log |Q|}.
\end{equation}
Plugging this result back to \ref{eq:Gaussian Concentration Bounds for Liptshiz function}, we have 
\begin{equation}
    \mathbb P\left(h(\mb z) - \sqrt{2} \sigma \sqrt{d\log5 +\log |Q|}  \geq s \right) \leq e^{-\frac{s^2}{2\sigma^2}}.
\end{equation}
Picking $s= 3\sigma\sqrt{d}$, this implies with probability at least $1 - e^{-\frac{9d}{2}}$, we have
\begin{equation}
    \max_{\mb v \in C_Q} \innerprod{\mb v}{\mb z} = h(\mb z) \le \sigma\left(\sqrt{(2\log5)d +2\log |Q|}+3\sqrt{d}\right) \le \sigma\left(\sqrt{2\log|Q|}+5\sqrt{d}\right).
\end{equation}
Plugging this result back to \ref{upper bound H by covering}, we have with probability $\ge 1 - e^{-\frac{9d}{2}}$,
\begin{equation}
H \le  \sigma\left(2\sqrt{2\log|Q|}+10\sqrt{d}\right).
\end{equation}
\end{proof}
}

{

\begin{lemma}\label{lem:existence of good ZOE}
    Suppose for any landmark $\mb q'' \in \mb q + N_{\mb q}^{\eta}$ \footnote{$N^{\eta}_{\mb q} \mc M = \set{ \mb v \in \bb R^D \mid \| \mc P_{T_{\mb q}\mc M} \mb v \|_2 \le \eta}$},  with 
    \begin{equation}
    \eta \geq  \epsilon + \delta + \sigma\left(4\sqrt{\log|Q|}+10\sqrt{d}\right),     
    \end{equation}
    there exists a zero-order edge $\mb q \overset{0}{\rightarrow} \mb q'$, such that
    \begin{equation}
        \mb q' \in B_{\mc M}(\mb q'', c_4 \tau_{\mc M}),
    \end{equation}
    where $\delta$ is the covering radius for $Q$, $\epsilon> 0$, 
    and $c_4 \le \tfrac{1}{40}$. \\
    Then, for $\mb x = \mb x_\natural + \mb z$, with probability at least $1 - e^{-\frac{9d}{2}}$ in the noise $\mb z$, the following property obtains: for every point $\mb q$ such that $\mb x \in \mb q + N^{\epsilon}_{\mb q}$, there exists a zero-order edge $\mb q \overset{0}{\rightarrow} \mb q'''$ for some $\mb q''' \in B_{\mc M}(\mb x_\natural, c_4 \tau_{\mc M} + \delta)$.
\end{lemma}




\begin{proof}
    For $\mb x = \mb x_\natural + \mb z \in \mb q+N_{\mb q}^{\epsilon} \mc M$, we have
    \begin{equation}
        \norm*{P_{T_{\mb q}}(\mb x - \mb q)}_2 \leq \epsilon.
    \end{equation}
By the covering property, there exists $\mb q'' \in Q$, such that
\begin{equation}
    d_{\mc M}(\mb x_\natural, \mb q'') \leq \delta. 
\end{equation}
Since
    \begin{equation}
        \norm*{P_{T_{\mb q}}(\mb x - \mb q)}_2 
        \geq \norm*{P_{T_{\mb q}}(\mb q'' - \mb q)}_2 - \norm*{P_{T_{\mb q}}(\mb x_\natural - \mb q'')}_2 - \norm*{P_{T_{\mb q}}\mb z}_2,
    \end{equation}
 we have
\begin{equation}
    \norm*{P_{T_{\mb q}}(\mb q'' - \mb q)}_2 - \norm*{P_{T_{\mb q}}(\mb x_\natural - \mb q'')}_2 - \norm*{P_{T_{\mb q}}\mb z}_2
    \leq \epsilon.
\end{equation}
Together with $\norm*{P_{T_{\mb q}}(\mb x_\natural - \mb q'')}_2 \leq \norm*{\mb x_\natural - \mb q''}_2 \leq \delta$, and \Cref{Phase II Probability bound on H}, then with probability at least $1-e^{\frac{-9d}{2}}$, we have
\begin{equation}
    \begin{aligned}
    \norm*{P_{T_{\mb q}}(\mb q'' - \mb q)}_2
    &\leq \epsilon + \delta + H\\
    &\leq \eta.
    \end{aligned}
\end{equation}
By assumption, there exists a zero-order edge $\mb q \overset{0}{\rightarrow} \mb q'$, such that $\mb q' \in B_{\mc M}(\mb q'', c_4\tau_{\mc M})$. Then
\begin{equation}
    \begin{aligned}
        d_{\mc M}(\mb q', \mb x_\natural)
        &\leq d_{\mc M}(\mb q', \mb q'') + d_{\mc M}(\mb q'', \mb x_\natural)\\
        &\leq c_4 \tau_{\mc M} + \delta.
    \end{aligned}
\end{equation}
\end{proof}
}


\begin{lemma}\label{Phase II ZOE gives an acceptable landmark}
{Assume $\sigma \sqrt{D} \leq c_1 \tau_{\mc M}$ for some $c_1 \leq \frac{1}{640}$} and for any landmark $\mb q'' \in \mb q + N_{\mb q}^{\eta}$, with {$ \eta \geq  \epsilon + \delta + \sigma\left(4\sqrt{\log|Q|}+10\sqrt{d}\right)$}, where $\delta$ is the covering radius of Q and $\epsilon$ > 0, there exists a zero-order edge $\mb q \overset{0}{\rightarrow} \mb q'$, such that $\mb q' \in B_{\mc M}(\mb q'', c_4\tau_{\mc M})$, where $c_4 \le \frac{1}{40}$. Then, for any noisy $\mb x = \mb x_\natural + \mb z$ where $\mb x \in \mb q+N_{\mb q}^{\epsilon}$, with probability at least {$ 1 - 2e^{\frac{-9d}{2}}$} in the noise,  $\mb q^* = \arg\min_{\mb q': \mb q \overset{0}{\rightarrow} \mb q'}\left\|\mb q' -\mb x\right\|_2$ satisfies landmark  $\mb q^* \in B_{\mc M}(\mb x_\natural,{(2c_4 + 16 c_1)\tau_{\mc M}+2\delta})$
\end{lemma}

\begin{proof}
     Given the assumption,  lemma \ref{lem:existence of good ZOE} guarantees that with probability at least $1 - e^{\frac{-9d}{2}}$, there exists a landmark $\mb q'''$ and a zero-order edge $\mb q \overset{0}{\rightarrow} \mb q'''$, such that $\mb q''' \in B_{\mc M}(\mb x_\natural, c_4\tau_{\mc M}+\delta)$.
    Since $\mb q^* = \arg\min_{\mb q': \mb q \overset{0}{\rightarrow} \mb q'}\left\|\mb q' -\mb x\right\|_2$, we know that
    \begin{equation}\label{eq:ZOS output is closer than good edge}
        \norm{\mb q^* - \mb x}_2 \leq \norm{\mb q''' - \mb x}_2.
    \end{equation} 
    which is the same as 
    \begin{equation}
        \norm{\mb q^* - \mb x_\natural - \mb z}_2 \leq \norm{\mb q''' - \mb x_\natural - \mb z}_2.
    \end{equation} 
From triangular inequality, we have 
\begin{equation}
 \norm{\mb q^* - \mb x_\natural}_2 \le \norm{\mb q''' - \mb x_\natural}_2 + 2\norm{\mb z}_2.  
\end{equation}
Since $g(\mb z)=\norm{\mb z}_2$ is 1-lipschitz function in $\mb z$ and $\mathbb E[\norm{\mb z}_2] \leq \sigma \sqrt{D}$, then with probability at least $1-e^{-\frac{t^2}{2\sigma^2}}$, we have
\begin{equation}
    \norm{\mb z}_2 
    \leq \sigma \sqrt{D} + t.
\end{equation}
Take $t=3\sigma \sqrt{D}$, then with probability at least $1-e^{-\frac{9D}{2}}$, we have
\begin{equation}\label{eq:high prob bound for norm of z}
     \norm{\mb z}_2 
    \leq 4\sigma\sqrt{D} \le 4c_1 \tau_{\mc M},
\end{equation}
which implies with probability at least $1-e^{-\frac{9D}{2}}$, we have
\begin{equation}
 \norm{\mb q^* - \mb x_\natural}_2 \le \norm{\mb q''' - \mb x_\natural}_2 + 8c_1 \tau_{\mc M}  \le (c_4 + 8 c_1) \tau_{\mc M}+\delta  \le \tau_{\mc M}.
\end{equation}
The last inequality follows from the conditions $c_4 \leq 1/40, c_1 \leq 1/640, \delta = R_{\mr{nbrs}}/a\leq \tau_{\mc M}/40$. Together with the fact that on this scale $d_{\mc M}(\mb x_\natural, \mb q^*) \le 2 \norm{\mb q^* - \mb x_\natural}_2$, we have 
\begin{equation}
d_{\mc M}(\mb x_\natural, \mb q^*) \le (2c_4 + 16 c_1)\tau_{\mc M}+2\delta.
\end{equation}
\end{proof}






    
