\section{Main Claim and Proof Roadmap}
\begin{theorem} 
Let $\mc M \subset \mathbb{R}^D$ be a complete and connected $d$-dimensional manifold whose extrinsic geodesic curvature is bounded by $\kappa$. 
\begin{itemize}
    \item {\bf Assumptions on $\mc M$}
    Assume $\kappa \diam(\mc M) \ge 1$ and $\sigma \sqrt{D} \leq \frac{1}{640} \tau_{\mc M}$.
    \item {\bf Assumptions on $Q$} Suppose that the landmarks $Q=\left\{\mb q_1, \dots, \mb q_{ M}\right\} \subset \mc M$ are $\delta$-separated, and form a $\delta$-net for $\mc M$. Assume $\delta \le \diam(\mc M)$.
    \item {\bf Assumptions on $E^1$} Further suppose that the first-order graph $E^1$ satisfies that $u \overset{1}{\rightarrow} v \in E^1$ when $\left\|\mb q_u - \mb q_v\right\|_2 \leq R_{\text{nbrs}}$, and ${a\delta} = R_{\text{nbrs}} \leq \frac{\sqrt{2}}{64}\sigma\sqrt{d}$ for some $a\ge40,$ and $\tau_{\mc M}$ is the reach of the manifold $\mc M$.  
    \item {\bf Assumptions on $E^0$}  Suppose for every $\mb q \in Q$ and every $\mb q' \in \mb q + N^{\eta}_{\mb q}\mc M$ with 
    \begin{equation}  \eta \geq  \epsilon_1 + \delta + 14\sigma\sqrt{d}\sqrt{\kappa\diam(\mc M)+\log(\diam(\mc M))-\log(\delta)+\log(7)}
    \end{equation} there exists a ZOE $\mb q \overset{0}{\rightarrow} \mb q''$ with $\mb q'' \in B_{\mc M}( \mb q', \frac{1}{80}\tau_{\mc M} )$
\end{itemize} 
With probability at least $ 1-4e^{-\frac{d}{16}} - \left(\frac{e}{2}\right)^{-\frac{D}{2}}$ in the noise $\mb z$, the Algorithm \ref{algo:1-0-1} with parameters 
\begin{align} 
R_a &= R_{\mr{nbrs}} - \delta\\
\eps_1 &>  \frac{2R_{\text{nbrs}}}{0.55}\left(\frac{2}{3} + \frac{8}{3}\kappa \diam(\mc M) + \right.\\
&\qquad \qquad \left.+16\kappa\sigma\sqrt{d}\sqrt{\kappa \diam(\sM) + \log(a) - \log(\delta) + \log(\diam(\sM)) + \log(100)}\right) \\ 
\epsilon_2 &> C\max\{\kappa,1\} \sigma \sqrt{d} 
\end{align} 
produces an output $\mb q_\star$ satisfying \begin{equation}
    d_{\mc M}(\mb q_\star, \mb x_\natural) \leq 2\epsilon_2
\end{equation}

with an overall number of arithmetic operations bounded by 
    \begin{equation}
       \left(Dd + d \paren{1 + 4\sqrt{2} a e }^d\right)\left( \frac{10 \mr{diam}^2(\mc M) + 20 \sigma^2 D}{ \epsilon_1 \delta } + \frac{8}{\kappa \delta}\right) + D \times \$^{\eta}_{\frac{1}{80} \tau_{\mc M}} (\mc M)
    \end{equation}
\end{theorem} 

\begin{proof}
With the above assumptions and the combination of \cref{prop:phase I}, \cref{prop:phase II prop}, and \cref{prop:phase III}, it's easy to show that with probability at least $ 1-4e^{-\frac{d}{16}} - \left(\frac{e}{2}\right)^{-\frac{D}{2}}$ in the noise $\mb z$, the output of the algorithm $\mb q_\star$ satisfies
\begin{equation}
    d_{\mc M}(\mb q_\star, \mb x_\natural) \leq 2\epsilon_2,
\end{equation}

and phase $\mr{I}$ and phase $\mr{III}$ use at most $ \frac{\diam^2(\mc M) + 2 \sigma^2 D} {0.1375 \epsilon_1 \delta} + \frac{8}{\kappa\delta}$ steps, and phase $\mr{II}$ takes at most $ D \times \$^{\eta}_{\frac{1}{80} \tau_{\mc M}} (\mc M)$ operations.

And we note that projection of the gradient onto the tangent space takes the cost of $D*d$ number of operations, and choosing the first-order neighbor takes the cost of $d * \max_{\vq_u \in \sQ}\abs{E_{u}^1}$. The number of arithmetic operations  of zero-order step is $D*\max_{\mb q\in Q} \deg^0(\mb q)$, where $D$ comes from the Euclidean distance calculation, and $\max_{\mb q\in Q} \deg^0(\mb q)$ is bounded by the defined geometric quantity $\$^{\eta}_{\frac{1}{80} \tau_{\mc M}} (\mc M)$. Combined all of terms above, we end up with the bound on the number of operations performed by our algorithm.
\end{proof}



\begin{fact} 
    For a manifold $\mc M$ with reach $\tau_{\mc M}$ and extrinsic curvature bounded by $\kappa$, we have
    \begin{equation}
        \tau_{\mc M} \leq 1/\kappa.
    \end{equation}
See Proposition 2.3 in \cite{aamari2019estimating}. We used this fact directly in the following proofs.
\end{fact}




\begin{proposition}\label{prop:phase I}
 Let $\mc M \subset \mathbb{R}^D$ be a complete and connected $d$-dimensional manifold whose extrinsic geodesic curvature is bounded by $\kappa$. Suppose the landmarks $\{ \mb q_u \}$ are $\delta$-separated, and form a $\delta$-net for $\mc M$, and that the first order graph $E^1$ satisfies $u \overset{1}{\rightarrow} v \in E^1$ when $\| \mb q_u - \mb q_v \|_2 \le R_{\mr{nbrs}}$, and that $40 \delta \le R_{\text{nbrs}} \le \tau_{\mc M}$. Assume $\delta \leq \diam(\mc M)$ and $\kappa \diam(\mc M) \geq 1$. Then with probability at least 
  \begin{equation}
      1-e^{-\frac{9d}{2}} - \left(\frac{e}{2}\right)^{-\frac{D}{2}}
  \end{equation}
  in the noise $\mb z$, the first phase of first-order optimization in Algorithm \ref{algo:1-0-1} with parameters  
  \begin{align}
        R_a &= R_{\text{nbrs}}-\delta,  \\
      \epsilon_1 &>  \frac{2R_{\text{nbrs}}}{0.55}\left(\frac{2}{3} + \frac{8}{3}\kappa \diam(\mc M) + \right.\\
      &\qquad \qquad \left. + 16\kappa\sigma\sqrt{d}\sqrt{\kappa \diam(\sM) + \log(a) - \log(\delta) + \log(\diam(\sM)) + \log(100)}\right), \\ 
  \end{align}
  produces $\mb q_{i_{\mr{I}}}$ satisfying 
  \begin{equation}
        \grad[\varphi_{\mb x}](\mb q_{i_{\mr{I}}})
        =\| \mc P_{T_{i_{\mr{I}}}}(\mb x - \mb q_{i_{\mr{I}}}) \|_2 
        \leq \epsilon_1
    \end{equation}
    using at most 
    \begin{equation}
        \frac{\diam^2(\mc M) + 2 \sigma^2 D} {0.1375 \epsilon_1 \delta}
    \end{equation}
    steps. 
\end{proposition}


\begin{proof}
    
    We can bound the total number of steps by dividing maximum initial distance by the minimal distance decrease over each first-order step.

    We note that \begin{equation}
    \begin{aligned}
        \varphi_{\mb x}(\mb q_{i^0})
        &= \frac{1}{2}\left\| \mb q_{i^0} - \mb x \right\|_2^2\\
        &\leq \left\| \mb q_{i^0} - \mb x_\natural \right\|_2^2 + \left\| \mb z \right\|_2^2\\
        &\leq \text{diam}^2(\mc M) + \left\| \mb z \right\|_2^2
    \end{aligned}
\end{equation} 

     We let $\mb{\bar z}$ be the standard unit variance Gaussian variable, for any $0<t<1/2$, we have
\begin{equation}
\begin{aligned}
    \mathbb P[\left\| \mb z \right\|_2^2 \ge 2\sigma^2D] &= \mathbb P[\left\| \mb{\bar z} \right\|_2^2 \ge 2D]\\ &= \mathbb P[e^{t \left\| \mb{\bar z} \right\|_2^2} \ge e^{2tD}] \\ &\le \frac{\mathbb E[e^{t \left\| \mb{\bar z} \right\|_2^2}]}{e^{2tD}} \\ 
    &= \frac{e^{-2tD}}{(1-2t)^{\frac{D}{2}}},
\end{aligned}
\end{equation}
where we used Markov's inequality from the second line to the third line. In particular, we can pick $t = \frac{1}{4}$, so with probability at least $1 - (\frac{e}{2})^{-\frac{D}{2}}$ in the noise $\mb z$, we have
\begin{equation}\label{eq:bound on initial distance}
        \varphi_{\mb x}(\mb q_{i^0}) \leq \text{diam}^2(\mc M) + 2\sigma^2D
\end{equation}

Now we will analyze the decrease over each first-order step from $u$ to $u^+$. We have
\begin{equation}
    \begin{aligned}
        \varphi_{\mb x}(\mb q_{u^+}) - \varphi_{\mb x}(\mb q_u) 
    & = \frac{1}{2}(\|\mb x - \mb q_{u^+}\|_2^2 - \|\mb x - \mb q_u \|_2^2) \\
    & = \frac{1}{2} \| \mb q_{u^+} - \mb q_u \|_2^2
        - \innerprod{\mc P_{T_u}(\mb x - \mb q_u)}{\mc P_{T_u}(\mb q_{u^+} - \mb q_u)}
        - \innerprod{\mc P_{N_u}(\mb x - \mb q_u)}{\mc P_{N_u}(\mb q_{u^+} - \mb q_u)}
    \end{aligned}
\end{equation}

We apply Lemma \ref{lem:edge bounded by tangent term} to bound the first term and Lemma \ref{lem:bound dot product of gradient and edge in the normal direction} to get a high probability bound on the last term, setting $t = 3\sigma\sqrt{d}$. 



Next, we apply \cref{lem:tangent space covering}and \cref{lem:bound dot product of gradient and edge in tangent direction} to bound the second term, which dominates the decrease in the values of the objective function after taking a first-order step. As a reminder, the step rule in \cref{algo:1-0-1} is 
\begin{equation}
    u^+ = \arg\min_{u \overset{1}{\rightarrow} v}
     \left\| \mc P_{B(0,R_a)} \mc P_{T_u} (\mb x -\mb q_u) - \mc P_{T_u} (\mb q_v - \mb q_u) \right\|_2.
\end{equation}
We observe that before phase I in \cref{algo:1-0-1} terminates, $\left\|\mc P_{T_u} (\mb x -\mb q_u)\right\| \ge \epsilon_1 > R_a$ holds. Then the step rule is equivalent to 
\begin{equation}
    u^+ = \arg\min_{u \overset{1}{\rightarrow} v}
     \left\| \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u} (\mb q_v - \mb q_u) \right\|_2,
\end{equation}
in which we have $\left\|\frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a\right\|_2 = R_a$. Applying \cref{lem:tangent space covering}, there exists $u \overset{1}{\rightarrow} v \in E^1$, such that $\left\| \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u}(\mb q_v - \mb q_u)\right\|_2 \leq \delta + \frac{1}{2}\kappa R_a^2$. From the construction of this step rule, we have  $\left\| \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u}(\mb q_{u^+} - \mb q_u)\right\|_2 \leq \left\| \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u}(\mb q_v - \mb q_u)\right\|_2 \leq \delta + \frac{1}{2}\kappa R_a^2$. Thus when $\mb x \neq \mb q_u$, applying \cref{lem:bound dot product of gradient and edge in tangent direction}, we have $\innerprod{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\mc P_{T_u}\paren{\mb q_v - \mb q_u}} \ge 0.55 \| \mc P_{T_u} \paren{\mb x - \mb q_u} \|_2   \| \mc P_{T_u}\paren{\mb q_v - \mb q_u} \|_2$.





Combining all the above results, we conclude that with probability at least $1-e^{-\frac{9d}{2}}$ in the noise $\vz$, we have 
\begin{equation}
    \begin{aligned}
        \varphi_{\mb x}(\mb q_{u^+}) - \varphi_{\mb x}(\mb q_u)
        &\leq \frac{2}{3} \| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2^2 - 0.55 \| \mc P_{T_u}(\mb x - \mb q_u) \|_2 \| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2\\ 
        &+ \frac{8}{3} \kappa (\diam(\mc M) + \sqrt{2} \sigma \sqrt{\log |E^1|} + 3\sigma\sqrt{d}) \| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2^2.
    \end{aligned}
\end{equation}

Given our assumption on $\epsilon_1$ and applying the bound of $\abs{E^1}$ in \cref{lem:app:foe_bound}, together with the assumption that $\delta \leq \diam(\mc M)$ and $\kappa \diam(\mc M)>1$, it follows that before Phase I ends, we have 
\begin{equation}
\begin{aligned}
0.55 \| \mc P_{T_u}(\mb x - \mb q_u) \|_2
&> 0.55 \epsilon_1\\
&> 2R_{\mr{nbrs}}\left(\frac{2}{3} + \frac{8}{3}\kappa \diam(\mc M) + \right.\\
      &\qquad \qquad \left. + 16\kappa\sigma\sqrt{d}\sqrt{\kappa \diam(\sM) + \log(a) - \log(\delta) + \log(\diam(\sM)) + \log(100)}\right)\\
&> 2R_{\mr{nbrs}} \left( \frac{2}{3} + \frac{8}{3}\kappa \diam({\mc M}) + 8\kappa \sigma \sqrt{d} + 8\kappa\sigma\sqrt{d}\sqrt{\kappa \diam(\sM) + \log(a) - \log(\delta) + \log(\diam(\sM)) + \log(100)}\right)\\
&> 2R_{\mr{nbrs}} \left( \frac{2}{3} + \frac{8}{3}\kappa \diam({\mc M}) + 8\kappa \sigma \sqrt{d} + 8\kappa\sigma \sqrt{\log|E^1|}\right)\\
&>2R_{\text{nbrs}}\paren{\frac{2}{3} + \frac{8}{3}\kappa \left(\mathrm{diam}(\mc M) + \sigma\sqrt{2\log\left|E^1\right|} + 3\sigma\sqrt{d}\right)},
\end{aligned}
\end{equation}
together with $\| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2 \leq \|\mb q_{u^+}-\mb q_u\|_2 \le R_{\text{nbrs}}$, then we have 
\begin{equation}\label{eq: bound of sufficient decrease in each step}
    \varphi_{\mb x}(\mb q_{u^+}) - \varphi_{\mb x}(\mb q_u) 
    \le -\frac{0.55}{2} \| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2 \| \mc P_{T_u}(\mb x - \mb q_u) \|_2.
\end{equation}
In the following, we develop a lower bound for $\| \mc P_{T_u}(\mb q_{u^+} - \mb q_u) \|_2$.
Let $\mb\gamma:[0,1] \rightarrow \mc M$ be a minimum length geodesic joining $\mb q_u$ and $\mb q_{u^+}$ with constant speed $d_{\mc M}(\mb q_u, \mb q_{u^+})$, where $\mb\gamma(0)=\mb q_u, \mb\gamma(1)=\mb q_{u^+}$. Then we have

\begin{equation}\label{eq: bound norm of edge embedding}
    \begin{aligned}
        \left\|P_{T_u}\left(\mb q_{u^+}-\mb q_u\right)\right\|_2
        &= \left\|
        P_{T_u}\left(\mb\gamma(1)-\mb\gamma(0)
        \right)\right\|_2\\
        &= \left\|
        P_{T_u}\left(\int_{a=0}^1 \Dot{\mb\gamma}(a)da
        \right)\right\|_2\\
        &= \left\|\Dot{\mb\gamma}(0) + \int_{a=0}^1 \int_{b=0}^a P_{T_u}\Ddot{\mb\gamma}(b) db da\right\|_2\\
        &\geq \left\|\Dot{\mb\gamma}(0)\right\|_2 - \left\|\int_{a=0}^1 \int_{b=0}^a P_{T_u}\Ddot{\mb\gamma}(b) db da\right\|_2\\
        &\geq \left\|\Dot{\mb\gamma}(0)\right\|_2 - \int_{a=0}^1 \int_{b=0}^a \left\|P_{T_u}\Ddot{\mb\gamma}(b)\right\|_2 db da\\
        &\geq \left\|\Dot{\mb\gamma}(0)\right\|_2 - \int_{a=0}^1 \int_{b=0}^a \kappa \left\|\Dot{\mb\gamma}(0)\right\|_2^2 db da\\
        &= d_{\mc M}(\mb q_{u^+}, \mb q_u) - \frac{1}{2}\kappa d_{\mc M}^2(\mb q_{u^+}, \mb q_u)\\
        &\geq \frac{1}{2} d_{\mc M}(\mb q_{u^+}, \mb q_u)\\
        &\geq \frac{1}{2} \delta,
    \end{aligned}
\end{equation}
where in the third line we've used the fact that $\Dot{\mb\gamma}(0)$ lies in the tangent space of $q_u$, in the forth and fifth lines we applied triangle inequality, and in the final lines we've used our assumption that $d_{\mc M}(\mb q_{u^+}, \mb q_u) \leq \tau_{\mc M} \le \frac{1}{\kappa}$ and the landmarks are $\delta$-separated.\\
\vspace{0.2in}
Plugging this back into Equation \eqref{eq: bound of sufficient decrease in each step}, we have 
\begin{equation}
        \varphi_{\mb x}(\mb q_{u^+}) - \varphi_{\mb x}(\mb q_u) \le \frac{\delta}{2} \left(-\frac{0.55}{2}\| \mc P_{T_u}(\mb x - \mb q_u) \|_2 \right) \le \frac{-0.55}{4}\delta\epsilon_1
\end{equation}
Lastly, combining this result with Equation \eqref{eq:bound on initial distance} yields the desired upper bound on the number of iterations.


\end{proof}

\noindent In the following proposition, we let 
\begin{equation}
    N^\eta_{\mb q} \mc M 
\end{equation}
denote the $\eta$-dilated normal space: 
\begin{equation}
    N^{\eta}_{\mb q} \mc M = \set{ \mb v \in \bb R^D \mid \| \mc P_{T_{\mb q}\mc M} \mb v \|_2 \le \eta }
\end{equation}


\begin{proposition} \label{prop:phase II prop}
Assume $\delta \leq \diam(\mc M)$, $\kappa \diam(\mc M)\geq 1$ and $\sigma\sqrt{D} \leq \frac{1}{640} \tau_{\mc M}$. Suppose for every $\mb q \in Q$ and every $\mb q' \in \mb q + N^{\eta}_{\mb q}\mc M$ with 
\begin{equation}  
\eta \geq  \epsilon_1 + \delta + 14\sigma\sqrt{d}\sqrt{\kappa\diam(\mc M)+\log(\diam(\mc M))-\log(\delta)+\log(7)},
\end{equation} 
there exists a ZOE $\mb q \overset{0}{\rightarrow} \mb q''$ with $\mb q'' \in  B_{\mc M}( \mb q', \frac{1}{80}\tau_{\mc M} )$ Then, with probability at least {$1- 2e^{-\frac{9d}{2}}$} in the noise $\mb z$, whenever $\mb q_{i_{\mr{I}}}$ satisfies 
    \begin{equation}
        \| \mc P_{T_{\mb q_{i_{\mr{I}}}}\mc M} (\mb x - \mb q_{i_{\mr{I}}} ) \| \le \epsilon_1, 
    \end{equation}
    the second phase (zero-order step) produces $\mb q_{i_{\mr{II}}}$ satisfying
    \begin{equation}
        d_{\mc M}(\mb q_{i_{\mr{II}}}, \mb x_\natural) \leq 0.1/\kappa.
    \end{equation}
\end{proposition}
\begin{proof}
From \cref{lemma:bound of number of landmarks within R ball}, we have
\begin{equation}
    \abs{\sQ} \le \paren{1 + 4\sqrt{2}\delta^{-1} \diam(\sM) e^{\kappa \diam(\sM)} }^d,
\end{equation}
which gives us that
\begin{equation}
    \begin{aligned}
    \log \abs{\sQ} 
    &\leq d \log \paren{1 + 4\sqrt{2}\delta^{-1} \diam(\sM) e^{\kappa \diam(\sM)}}\\
    &\leq d \log \paren{\paren{\frac{1}{e}+4 \sqrt{2}}\delta^{-1}\diam(\mc M)e^{\kappa \diam(\mc M)}}\\
    &\leq d \paren{\log \paren{ 7 \delta^{-1} \diam(\mc M)} + \kappa \diam(\mc M)},
    \end{aligned}
\end{equation}
where we used the assumption that $\delta \leq \diam(\mc M)$ and $\kappa \diam(\mc M) \geq 1$ from the first line to the second line. Together with the assumption on $\eta$, we have
\begin{equation}
    \eta \geq \epsilon_1 + \delta + \sigma \paren{4 \sqrt{\log \abs{\sQ}} + 10\sqrt{d}}.
\end{equation}


Under these conditions and the assumption that {$\sigma\sqrt{D} \leq \frac{1}{640} \tau_{\mc M} $}, applying \cref{Phase II ZOE gives an acceptable landmark}, we conclude that with probability at least {$1 - 2e^{\frac{-9d}{2}}$} in the noise,  $\mb q_{i_{\mr{II}}} = \arg\min_{\mb q': \mb q_{i_{\mr{I}}} \overset{0}{\rightarrow} \mb q'}\left\|\mb q' -\mb x\right\|_2$ satisfies 
\begin{equation}
    d_{\mc M}(\mb x_\natural, \mb q_{i_{\mr{II}}}) \le \frac{1}{20}\tau_{\mc M}+2\delta \leq \frac{1}{20}\tau_{\mc M}+\frac{1}{20}R_{\text{nbrs}} \le \frac{1}{20}\tau_{\mc M}+\frac{1}{20}\tau_{\mc M} = \frac{1}{10}\tau_{\mc M}.
\end{equation} 
\end{proof}

\begin{proposition}\label{prop:phase III}
      Assume $\sigma\sqrt{D} \leq \frac{1}{640} \tau_{\mc M}$. Suppose the landmarks $\{ \mb q_u \}$ are $\delta$-separated, and form a $\delta$-net for $\mc M$, and that the first order graph $E^1$ satisfies $u \overset{1}{\rightarrow} v \in E^1$ when $\| \mb q_u - \mb q_v \|_2 \le R_{\mr{nbrs}}$, and that 
      \begin{equation}\label{eqn:PIII_RNBR_COND}
          40 \delta \le R_{nbrs} \le \frac{\sqrt{2}}{64}\sigma \sqrt{d}.
      \end{equation}
       
      Initializing at $\mb q_{i_{\mr{II}}} \in B_{\mc M}(\mb x_\natural, 0.1/\kappa)$,
       with probability at least 
      \begin{equation}
          1 - e^{-\tfrac{9}{2} d} - e^{-\frac{1}{16}d}, 
      \end{equation} 
      the third phase of first-order optimization in Algorithm \ref{algo:1-0-1} with parameters
      \begin{equation}
          R_a = R_{\mr{nbrs}} - \delta,
      \end{equation}
      \begin{equation}
          \epsilon_2 > { C\max\{\kappa,1\} } \sigma \sqrt{d},
      \end{equation}      
      for some $C > 0$, produces $\mb q_{i_{\mr{III}}}$ which satisfies
    \begin{equation}
        d_{\mc M}(\mb q_{i_{\mr{III}}}, \mb x_\natural) \leq {2\epsilon_2},
    \end{equation}
using at most
\begin{equation}
    \frac{8}{\kappa\delta}
\end{equation}
steps.
\end{proposition}




\begin{proof}
Let 
\begin{equation}
    \mb q_{i_{\mr{II}}} = \mb q^0, \mb q^1, \mb q^2, \dots 
\end{equation}
denote the sequence of landmarks $\mb q^j$ produced by first order optimization in Phase III. Let $j_\star \in \bb Z \cup \{ \infty \}$ denote the number of iterations taken by this phase of optimization. If the algorithm terminates at some finite $j_\star$, we have 
\begin{equation}
    \| P_{T_{\mb q^{j_\star}}} (\mb x - \mb q^{j_\star} ) \| \le \epsilon_2. 
\end{equation}
Below, we will prove that indeed the algorithm terminates, and bound the number of steps $j_\star$ required. To this end, we will prove that on an event of probability at least 
\begin{equation}
    1 - e^{-\tfrac{9}{2} d} - e^{-\tfrac{1}{16} d},
\end{equation}
the iterates $\mb q^j$ ($j = 0,1,\dots, j_\star$) satisfy the following property:
\begin{equation} \label{eqn:decrement-induction}
    d_{\mc M}(\mb q^j, \mb x_\natural) \le \max\left\{ \frac{1}{10\kappa} -  c_1 j \delta, C_1 \max\{ \kappa, 1 \} \sigma \sqrt{d} \right\}.  
\end{equation}
This immediately implies that there exists $C_2$ such that for all 
\begin{equation}
j \ge  \frac{C_2}{\kappa \delta},
\end{equation} 
the iterates  $\mb q^j$ satisfies 
\begin{equation} 
d_{\mc M}( \mb q^j, \mb x_\natural ) \le C_1 \max\{ \kappa, 1 \} \sigma \sqrt{d}. 
\end{equation}

\paragraph{Step Sizes.} Our next task is to verify \eqref{eqn:decrement-induction}. We begin by noting some bounds on the step size $d_{\mc M}(\mb q^{j},\mb q^{j-1})$. By construction, for each $j$, 
\begin{equation}
    \|\mb q^{j+1} - \mb q^j \|_2 
    \leq R_{\mr{nbrs}} \le \frac{\sqrt{2}}{64}\sigma \sqrt{d}
\end{equation}
Since we know $\frac{1}{\kappa} \ge \tau_{\mc M}$, $D \ge d$, and we've assumed $
\tau_{\mc M}\ge 640 \sigma\sqrt{D}$, we have 
\begin{equation}
R_{\mr{nbrs}} \le \min\left\{\frac{\sqrt{2}}{64}\sigma \sqrt{d}, \: \tau_{\mc M}, \: \frac{1}{200\kappa}\right\}.
\end{equation}

Since $\mb q^j, \mb q^{j+1} \in \mc M$ and $\|\mb q^{j+1}-\mb q^j \|_2 \leq \tau_{\mc M}$, applying Lemma \ref{lem:intrinsic dist bounded by extrinsic dist}, we have
\begin{equation}
     d_{\mc M}(\mb q^{j+1}, \mb q^j ) 
     \leq 2 \|\mb q^{j+1} - \mb q^j \|_2 
     \leq \min \left\{ \frac{\sqrt{2}}{32}\sigma \sqrt{d}, \frac{1}{100\kappa} \right\}
\end{equation}
From Lemma \ref{lem:lower bound for Tmax}, take $t=\frac{\sqrt{2}}{4} \sigma \sqrt{d}$, with probability at least $1-e^{-\frac{d}{16}}$, the random variable
\begin{equation}
    T_{\max} = \sup_{\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa), \mb v \in T_{\mb y } \mc M, \| \mb v \|_2 =1} \innerprod{\mb v}{\mb z},
\end{equation}
satisfies 
\begin{equation}
    T_{\max} \geq \frac{\sqrt{2}}{4} \sigma \sqrt{d},
\end{equation}
which gives us $\frac{\sqrt{2}}{32}\sigma \sqrt{d} \leq \frac{1}{8}T_{\max}$. Hence on an event of probability at least $1-e^{-\frac{d}{16}}$, for every $j$, 
\begin{equation}
    d_{\mc M}(\mb q^{j+1}, \mb q^j ) 
     \leq \min \left\{ \frac{\sqrt{2}}{32}\sigma \sqrt{d}, \frac{1}{100\kappa} \right\}
     \leq \min \left\{\frac{T_{\max}}{8}, \frac{1}{100\kappa}\right\}.
\end{equation}
In particular, this implies that the condition on the step size in Lemma \ref{prop:one step in phase III} is satisfied. 

\paragraph{Radius of Decrease.} From Lemma \ref{lem:upper bound for Tmax}, with probability at least $1 - e^{-\tfrac{9}{2} d}$, $T_{\max}$ satisfies 
\begin{equation}
T_{\max} \le C_4 \max\{ \kappa, 1 \} \sigma \sqrt{d}, 
\end{equation}
and hence the distance condition in Lemma \ref{prop:one step in phase III} is satisfied whenever 
\begin{equation}
    C_5 \max\{ \kappa, 1 \} \sigma \sqrt{d} \le d_{\mc M}(\mb q^j, \mb x_\natural ) \le \frac{1}{10\kappa}. 
\end{equation}

\paragraph{Proof of Equation \eqref{eqn:decrement-induction}.} We proceed by induction on $j$. For $j = 0$, $\mb q^0 = \mb q_{i_{\mr{II}}} \in B_{\mc M}(\mb x_\natural, \tfrac{1}{10\kappa} )$, and so \eqref{eqn:decrement-induction} holds. Now, suppose that \eqref{eqn:decrement-induction} condition holds for iterates $0, 1, \dots, j-1$. By Lemma \ref{prop:one step in phase III}, {\em if} 
\begin{equation}
    C_5 \max\{ \kappa, 1 \} \sigma \sqrt{d} \le d_{\mc M}(\mb q^j, \mb x_\natural ) \le \frac{1}{10\kappa}. 
\end{equation}
then 
\begin{eqnarray}
    d_{\mc M}(\mb q^{j}, \mb x_\natural) &\le& d_{\mc M}(\mb q^{j-1},\mb x_\natural) - c_2 d_{\mc M}(\mb q^j,\mb q^{j-1}) \\ 
    &\le& d_{\mc M}(\mb q^{j-1},\mb x_\natural) - c_2 \delta \\
    &\le& \frac{1}{10\kappa} - c_2 (j-1) \delta - c_2 j \delta \\
    &\le& \frac{1}{10\kappa} - c_2 j \delta
\end{eqnarray}
On the other hand, if $d_{\mc M}(\mb q^{j-1}, \mb x_\natural) < C_5 \max\{ \kappa, 1 \} \sigma \sqrt{d}$, we have 
\begin{eqnarray}
    d_{\mc M}( \mb q^{j}, \mb x_\natural ) &\le&     d_{\mc M}( \mb q^{j-1}, \mb x_\natural ) + d_{\mc M}( \mb q^{j}, \mb q^{j-1} ) \\
    &\le& C_5 \max\{ \kappa, 1 \} \sigma \sqrt{d} + \frac{\sqrt{2}}{32} \sigma \sqrt{d} \\
    &\le& C_6 \max\{ \kappa, 1 \} \sigma \sqrt{d}. 
\end{eqnarray}
Combining, we have 
\begin{equation}
    d_{\mc M}(\mb q^{j}, \mb x_\natural ) \le \max \left\{ \frac{1}{10\kappa} - c_2 j \delta, C_6 \max\{ \kappa, 1 \} \sigma \sqrt{d} \right\},  
\end{equation}
and \eqref{eqn:decrement-induction} is verified. 

\paragraph{Proof of Termination.} We next verify that under our assumptions on $\epsilon_2$, the algorithm terminates. For an arbitrary point $\mb q \in B_{\mc M}( \mb x_\natural, 1/\kappa)$, let $\phi(t)$ denote a geodesic with $\phi(0) = \mb x_\natural$, $\phi(1) =\mb q$ and constant speed $d_{\mc M}(\mb x_\natural, \mb q)$. Then 
\begin{equation}\label{eqn:tangent-upper} 
    \begin{aligned}
        \left\| P_{T_{\mb q} \mc M}(\mb x_\natural - \mb q) \right\|_2
        &= \left\| P_{T_{\mb q}\mc M} \Dot{\mb \phi}(0) + \int_{a=0}^1 \int_{b=0}^a P_{T_{\mb q }\mc M} \Ddot{\phi}(b) db da\right\|_2\\
        &= \left\| \Dot{\mb \phi}(0) + \int_{a=0}^1 \int_{b=0}^a P_{T_{\mb q}\mc M} \Ddot{\phi}(b) db da\right\|_2\\
        &\le \left\| \Dot{\mb \phi}(0) \right\|_2 + \left\| \int_{a=0}^1 \int_{b=0}^a P_{T_{\mb q}\mc M} \Ddot{\phi}(b) db da \right\|_2\\
        &\le d_{\mc M}(\mb x_\natural, \mb q ) +  \int_{a=0}^1 \int_{b=0}^a \left\|P_{T_{\mb q}\mc M} \Ddot{\phi}(b)\right\|_2 db da\\
        &\le d_{\mc M}(\mb x_\natural, \mb q) + \int_{a=0}^1 \int_{b=0}^a \kappa d_{\mc M}^2(\mb x_\natural, \mb q ) db da\\
        &\le d_{\mc M}(\mb x_\natural, \mb q ) + \frac{1}{2} \kappa d_{\mc M}^2(\mb x_\natural, \mb q )\\
        &\le \frac{3}{2} d_{\mc M}(\mb x_\natural, \mb q )
    \end{aligned}
\end{equation}
Comparing this lower bound to \eqref{eqn:decrement-induction}, we obtain that for any $\epsilon_2 > \tfrac{3}{2} C_1 \max\{ \kappa, 1 \} \sigma \sqrt{d}$, after at most 
\begin{equation}
\wh{j} > \frac{1}{10 c_2 \kappa \delta} 
\end{equation}
steps, the algorithm produces a point $\mb q^{j_\star}$ satisfying 
\begin{equation}
    \| P_{T_{\mb q^{j_\star}} \mc M} (\mb x - \mb q^{j_\star} ) \| \le \epsilon_2,
\end{equation}
and hence the algorithm terminates after at most $\frac{1}{10c_2\kappa \delta}$ steps. To be more specific, 
Lemma \ref{prop:one step in phase III} gives $c_2 = \frac{1}{80}$, so the algorithm stops after at most  $\frac{8}{\kappa \delta}$ steps.
\paragraph{Quality of Terminal Point.} Finally, we bound the distance of $\mb q_{i_{\mr{III}}} = \mb q^{j_\star}$ to $\mb x_\natural$. By reasoning analogous to \eqref{eqn:tangent-upper}, we obtain that for $\mb q \in B_{\mc M}(\mb x_\natural, 1/\kappa)$
\begin{equation}
        \left\| P_{T_{\mb q} \mc M}(\mb x_\natural - \mb q) \right\|_2 \ge \frac{1}{2} d_{\mc M}(\mb x_\natural, \mb q ). 
\end{equation}
This immediately implies that 
\begin{equation}
    d_{\mc M}(\mb q^{j_\star}, \mb x_\natural ) \le 2 \eps_2, 
\end{equation}
as claimed. 
\end{proof}



\section{Phase I Analysis}
\input{phaseI.tex}


\section{Phase II Analysis} 
\input{phaseII.tex}


\section{Phase III Analysis} 
\input{phase3.tex}

\appendix 


\section{Supporting Results} 
\input{supporting_result.tex}




