{
\begin{lemma}\label{lemma:velocity-edgeembedding-comparison}
    Consider the first-order edge $u \overset{1}{\rightarrow} v$. Let $\mb\xi_{uv} = P_{T_u} (\mb q_v - \mb q_u)$ denote the edge embedding, where $P_{T_u}$ is the projection operator onto the tangent space $T_u$ of the manifold $\mc M$ at landmark $\mb q_u$. Let $\mb\gamma:[0,1] \rightarrow \mc M$ be a geodesic joining $\mb q_u$ and $\mb q_v$ with constant speed $\|\mb v\|_2$, where $\mb\gamma(0)=\mb q_u, \mb\gamma(1)=\mb q_v$. Then, for all $t\in[0,1]$, we have
    \begin{equation}
        \|\dot{\mb\gamma}(t)-\mb\xi_{uv}\|_2 \leq \frac{3}{2} \kappa d_{\mc M}^2(\mb q_u, \mb q_v).
    \end{equation}
\end{lemma}
\begin{proof}
    From Taylor expansion, we have
    \begin{equation}
        \mb q_v = \mb q_u + \int_{a=0}^1 \dot{\mb\gamma}(a) da.
    \end{equation}
Therefore $\mb \xi_{uv} = P_{T_u} \int_{a=0}^1 \dot{\mb\gamma}(a) da$. Then


    \begin{equation}
        \begin{aligned}
            \|\dot{\mb\gamma}(t)-\mb\xi_{uv}\|_2
            &= \left\| \dot{\mb\gamma}(t) -  P_{T_u} \int_{a=0}^1 \dot{\mb\gamma}(a) da \right\|_2\\
            &=\left\| \dot{\mb\gamma}(0) + \int_{b=0}^t \Ddot{\mb\gamma}(b)db -  P_{T_u} \int_{a=0}^1 \left(\dot{\mb\gamma}(0) + \int_{b=0}^a \Ddot{\mb\gamma}(b)db \right)da  \right\|_2\\
            &=\left\| \int_{b=0}^t \Ddot{\mb\gamma}(b)db -  \int_{a=0}^1 \int_{b=0}^a P_{T_u} \Ddot{\mb\gamma}(b)dbda\right\|_2\\
            &= \left\| \int_{a=0}^1 \int_{b=0}^t \Ddot{\mb\gamma}(b)db da - \int_{a=0}^1 \left(\int_{b=0}^t P_{T_u} \Ddot{\mb\gamma}(b)db\right) + \left( \int_{b=t}^a P_{T_u} \Ddot{\mb\gamma}(b)db\right)da\right\|_2\\
            &=\left\|\int_{a=0}^1 \left( \int_{b=0}^t P_{N_u}\Ddot{\mb\gamma}(b)db - \int_{b=t}^a P_{T_u} \Ddot{\mb\gamma}(b)db\right)da\right\|_2\\
            &\leq \int_{a=0}^1 \left\| \int_{b=0}^t P_{N_u}\Ddot{\mb\gamma}(b)db \right\|_2 + \left\|\int_{b=t}^a P_{T_u} \Ddot{\mb\gamma}(b)db\right\|_2 da \\
            &\leq \int_{a=0}^1 (t+|a - t|)\kappa \|\mb v\|_2^2 \, da\\
            &= \left(  \int_{a = 0}^t [ 2t - a ] \, da + \int_{a = t}^1 a \, da \right) \kappa \|\mb v\|_2^2 \\
            &= \left( 2 t^2 - \tfrac{1}{2} t^2 + \tfrac{1}{2} - \tfrac{1}{2} t^2 \right) \kappa \|\mb v\|_2^2  \\
            &= \left(\frac{1}{2} + t^2 \right) \kappa \|\mb v\|_2^2 \\ 
            &\le \frac{3}{2} \kappa \|\mb v\|_2^2\\
            &=\frac{3}{2} \kappa d_{\mc M}^2(\mb q_u, \mb q_v)
        \end{aligned}
    \end{equation}
\end{proof}
}




\begin{lemma}\label{lemma:log-grad-comparison}
    For any $\mb z$ and $\mb x_\natural, \mb y \in \mc M$, let
\begin{equation}
    T_{\max} = \sup_{\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa), \mb v \in T_{\mb y } \mc M, \| \mb v \|_2 =1} \innerprod{\mb v}{\mb z},
\end{equation}
Then if $d_{\mc M}(\mb y, \mb x_\natural ) \le 1/\kappa$, we have 
    \begin{equation}
        \left\|-\log_{\mb y}\mb x_\natural - \grad[\varphi_{\mb x}](\mb y)\right\|_2 \leq 
        \frac{1}{2} \kappa d_{\mc M}^2 (\mb y, \mb x_\natural) + T_{\max}
    \end{equation}
\end{lemma}

\begin{proof}
We first decompose the left hand side into
\begin{equation}
    \begin{aligned}
        \left\|-\log_{\mb y}\mb x_\natural - \grad[\varphi_{\mb x}](\mb y)\right\|_2
        &= \left\| -\log_{\mb y}\mb x_\natural + P_{T_{\mb y}\mc M} (\mb x-\mb y)\right\|_2\\
        &\leq \left\| -\log_{\mb y}\mb x_\natural + P_{T_{\mb y}\mc M} (\mb x_\natural -\mb y) \right\|_2 + \left\| P_{T_{\mb y}\mc M} \mb z \right\|_2.
    \end{aligned}
\end{equation}
 Consider a geodesic $\mb\eta:[0,1] \rightarrow \mc M$ with constant speed $\|\mb v_{\mb\eta}\|_2$, where $\mb\eta(0)=\mb y, \mb\eta(1)=\mb x_\natural$,
then we bound the signal term (first term) of the above bound:
\begin{equation}
    \begin{aligned}
        \left\| -\log_{\mb y}\mb x_\natural + P_{T_{\mb y}\mc M} (\mb x_\natural -\mb y) \right\|_2
        &= \left\| -\Dot{\mb\eta}(0) + P_{T_{\mb y}\mc M} \int_{a=0}^1 \Dot{\mb\eta}(a) da\right\|_2\\
        &=\left\| -\Dot{\mb\eta}(0) + P_{T_{\mb\eta(0)}\mc M} \int_{a=0}^1 \left(\Dot{\mb\eta}(0) + \int_{b=0}^a \Ddot{\mb\eta}(b) db\right) da \right\|_2\\
        &=\left\| P_{T_{\mb\eta(0)}\mc M} \int_{a=0}^1 \int_{b=0}^a \Ddot{\mb\eta}(b) db da\right\|_2\\
        &\leq \int_{a=0}^1 \int_{b=0}^a \left\|\Ddot{\mb\eta}(b) \right\|_2 db da\\
        &\leq \int_{a=0}^1 \int_{b=0}^a \kappa \|\mb v_{\mb \eta}\|_2^2  db da\\
        &=\frac{1}{2} \kappa d_{\mc M}^2 (\mb y, \mb x_\natural).
    \end{aligned}
\end{equation}
Since $\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa)$, we have 
\begin{equation}
    \begin{aligned}
        \left\| P_{T_{\mb y}\mc M} \mb z\right\|_2
        \leq T_{\max}
    \end{aligned}
\end{equation}
Combining the above, we end up with the result.
\end{proof}


\begin{lemma}\label{lemma:grad-bound} 
For any point $\mb z$ and $\mb x_\natural, \mb y \in \mc M$, let
\begin{equation}
    T_{\max} = \sup_{\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa), \mb v \in T_{\mb y } \mc M, \| \mb v \|_2 =1} \innerprod{\mb v}{\mb z},
\end{equation}
if $d_{\mc M}(\mb y, \mb x_\natural ) \le 1/\kappa$,  then we have
    \begin{equation}
        \left\|\grad[\varphi_{\mb x}](\mb y) \right\|_2\leq d_{\mc M}(\mb y,\mb x_\natural) + T_{\max}.
    \end{equation}
\end{lemma}

\begin{proof}   
    \begin{equation}
        \begin{aligned}
             \left\|\grad[\varphi_{\mb x}](\mb y) \right\|_2
            &=  \left\| P_{T_{\mb y}\mc M} (\mb y - \mb x)\right\|_2\\
            &\le \left\| P_{T_{\mb y}\mc M} (\mb y - \mb x_\natural)\right\|_2 
            + \left\| P_{T_{\mb y}\mc M} \mb z\right\|_2
        \end{aligned}
    \end{equation}
It's easy to show that $\left\| P_{T_{\mb y}\mc M} (\mb y - \mb x_\natural)\right\|_2 \leq d_{\mc M}(\mb y,\mb x_\natural)$. Let 
\begin{equation}
    T_{\max} = \sup_{\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa), \mb v \in T_{\mb y } \mc M, \| \mb v \|_2 =1} \innerprod{\mb v}{\mb z},
\end{equation}
then we have
\begin{equation}
    \left\| P_{T_{\mb y}\mc M} \mb z\right\|_2
    \leq T_{\max}
\end{equation}
Combining the above two bounds, we end up with the desired result.
\end{proof}




\begin{lemma}\label{lemma:vecotr-parallel transported vector-comparison}
    Let $\zeta:[0,1] \rightarrow \mc M$ be a geodesic in a Riemannian manifold $\mc M$. Take any initial vector $\mb v_0 \in T_{\mb\zeta(0)}\mc M$, and let $\mb v_t$ be its parallel transport along $\zeta$ up to time $t$. Then 
    \begin{equation}
        \left\| \mb v_t - \mb v_0 \right\|_2
        \leq 3\kappa t \|\mb v_0\|_2 \|\Dot{\mb\zeta}\|_2 
    \end{equation}
\end{lemma}

\begin{proof}
When paralleling transport a $\mb v_0 \in T_{\mb\zeta(0)}\mc M$ along the geodesic $\mb\zeta$, we have
\begin{equation}
    \frac{d}{dt} \mb v_t = \Pi(\mb v_t, \Dot{\mb\zeta}(t)).
\end{equation}
From fundamental theorem of calculus, we have
\begin{equation}
    \mb v_t = \mb v_0 + \int_{a=0}^t \Pi(\mb v_a, \Dot{\mb\zeta}(a)) da.
\end{equation}
From above and applying Lemma 8 in \cite{yan2023tpopt}, we have 
\begin{equation}
    \begin{aligned}
        \left\| \mb v_t - \mb v_0 \right\|_2
        &= \left\| \int_{a=0}^t \Pi(\mb v_a, \Dot{\mb\zeta}(a)) da \right\|_2\\
        &\leq \int_{a=0}^t \left\|\Pi(\mb v_a, \Dot{\mb\zeta}(a))\right\|_2 da\\
        &\leq { \int_{a=0}^t 3\kappa \|\mb v_0\|_2 \|\Dot{\mb\zeta}\|_2da}\\
        &= 3\kappa t \|\mb v_0\|_2 \|\Dot{\mb\zeta}\|_2 
    \end{aligned}
\end{equation}
\end{proof}

\begin{lemma}\label{lemma:tangnet space diff bound}
    Let $\mb\gamma:[0,1] \rightarrow \mc M$ be a geodesic joining $\mb q_u$ and $\mb q_v$ with constant speed, where $\mb\gamma(0)=\mb q_u, \mb\gamma(1)=\mb q_v$. Then, for all $t\in[0,1]$, we have
    \begin{equation}
    \left\| P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right\|_{op}
    \leq 3\sqrt{2} \kappa t \|\Dot{\mb\gamma}\|_2  .
    \end{equation}
\end{lemma}


\begin{proof}
\begin{equation}
    \begin{aligned}
        \left\| P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right\|_{op}
        &= \sup_{\|\mb w\|_2=1} \left\| \left( P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right) \mb w\right\|_2\\
        &= \sup_{\|\mb w\|_2=1} \left\| \left( P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right) (\mb w_{||} + \mb w_{\perp}) \right\|_2\\
        &\leq \sup_{\|\mb w\|_2=1} \left\| \left( P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right) \mb w_{||} \right\|_2 + \left\| \left( P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right) \mb w_{\perp} \right\|_2\\
        &= \sup_{\|\mb w\|_2=1} \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{||} -  \mb w_{||} \right\|_2 
        + \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{\perp}  \right\|_2
    \end{aligned}
\end{equation}
where $\mb w_{||} = P_{T_{\mb\gamma (0)}\mc M} \mb w, \mb w_{\perp} = P_{T_{\mb\gamma (0)}^{\perp} \mc M} \mb w$.

Together with Lemma \ref{lemma:vecotr-parallel transported vector-comparison}, we bound the first term $\left\| \left( P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right) \mb w_{||} \right\|_2$.
\begin{equation}
    \begin{aligned}
        \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{||} -  \mb w_{||} \right\|_2
        &= \min_{\mb h \in T_{\mb\gamma(t)}\mc M} \left\| \mb h - \mb w_{||}\right\|_2\\
        &\leq \left\|  \Pi_{0\rightarrow t} \mb w_{||} - \mb w_{||}\right\|_2\\
        &\leq 3 \kappa t\|\mb w_{||}\|_2 \|\Dot{\mb\gamma}\|_2 
    \end{aligned}
\end{equation}
Here $\Pi_{0\rightarrow t}$ is a transport operator which transports a vector in $T_{\mb\gamma(0)} \mc M$ to the $T_{\mb\gamma(t)} \mc M$ along the geodesic $\mb\gamma$.

We next bound the second term $\left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{\perp}  \right\|_2$.
\begin{equation}
    \begin{aligned}
        \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{\perp}  \right\|_2
        &= \left\| P_{T_{\mb\gamma(t)} \mc M} P_{T_{\mb\gamma(0)}^{\perp}\mc M}\mb w_{\perp}  \right\|_2\\
        &\leq \|\mb w_{\perp}\|_2 \left\| P_{T_{\mb\gamma(t)} \mc M} P_{T_{\mb\gamma(0)}^{\perp}\mc M}\right\|_{op}\\
        &= \|\mb w_{\perp}\|_2 \left\| P_{T_{\mb\gamma(0)}^{\perp} \mc M} P_{T_{\mb\gamma(t)}\mc M}\right\|_{op} \\
        &= \|\mb w_{\perp}\|_2 \sup_{\|\mb u\|_2=1} \left\| P_{T_{\mb\gamma(0)}^{\perp} \mc M} P_{T_{\mb\gamma(t)}\mc M} \mb u\right\|_2\\
        &= \|\mb w_{\perp}\|_2 \sup_{\|\mb u\|_2=1, \mb u \in T_{\mb\gamma(t)}\mc M} \left\| P_{T_{\mb\gamma(0)}^{\perp} \mc M} \mb u\right\|_2\\
        &= \|\mb w_{\perp}\|_2 \sup_{\|\mb u\|_2=1, \mb u \in T_{\mb\gamma(t)}\mc M} \left\| \left(\mb I - P_{T_{\mb\gamma(0)} \mc M} \right) \mb u\right\|_2\\
        &= \|\mb w_{\perp}\|_2 \sup_{\|\mb u\|_2=1, \mb u \in T_{\mb\gamma(t)}\mc M} \min_{\mb h \in T_{\mb\gamma(0)}\mc M}\left\| \mb h - \mb u\right\|_2\\
        &\leq \|\mb w_{\perp}\|_2 \sup_{\|\mb u\|_2=1, \mb u \in T_{\mb\gamma(t)}\mc M} \left\|
        \Pi_{t\rightarrow 0} \mb u - \mb u\right\|_2\\
        &\leq 3 \kappa t \| \|\mb w_{\perp}\|_2 \|\Dot{\mb\gamma}\|_2 
    \end{aligned}
\end{equation}

Therefore,
\begin{equation}
    \begin{aligned}
        \sup_{\|\mb w\|_2=1} \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{||} -  \mb w_{||} \right\|_2 
        + \left\| P_{T_{\mb\gamma(t)} \mc M} \mb w_{\perp}  \right\|_2
        &\leq \sup_{\|\mb w\|_2=1} 3 \kappa t\|\Dot{\mb\gamma}\|_2  (\|\mb w_{||}\|_2 + \|\mb w_{\perp}\|_2)\\
        &\leq \sup_{\|\mb w\|_2=1} 3 \sqrt{2} \kappa t \|\Dot{\mb\gamma}\|_2 \|\mb w\|_2\\
        &= 3\sqrt{2} \kappa t \|\Dot{\mb\gamma}\|_2 
    \end{aligned}
\end{equation}
Hence
\begin{equation}
    \left\| P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right\|_{op}
    \leq 3\sqrt{2} \kappa t \|\Dot{\mb\gamma}\|_2  
\end{equation}

\end{proof}


\begin{lemma}\label{lemma:main term bound}
Let $\mb\gamma:[0,1] \rightarrow \mc M$ be a minimum length geodesic joining $\mb q_u$ and $\mb q_{u^+}$ with constant speed $d_{\mc M}(\mb q_u, \mb q_{u^+})$, where $\mb\gamma(0)=\mb q_u, \mb\gamma(1)=\mb q_{u^+}$. Suppose for any $t \in [0,1], \: d_{\mc M}( \mb \gamma(t), \mb x_\natural ) \le 1 /\kappa$, then, we have
\begin{equation}
    \begin{aligned}\innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
    &\leq -\frac{0.55}{2} \left( \frac{1}{2}d_{\mc M}(\mb x_\natural, \mb\gamma(0))  - T_{\max}\right) 
        d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        &+ \left( 3\sqrt{2} \kappa t d_{\mc M}(\mb q_u, \mb q_{u^+}) d_{\mc M}(\mb\gamma(t),\mb x_\natural)+2T_{\max}+ t d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} \kappa t^2 d_{\mc M}^2 (\mb q_u, \mb q_{u^+})\right) d_{\mc M}(\mb q_u, \mb q_{u^+})
        \end{aligned}
\end{equation}
\end{lemma}



\begin{proof}
    We note that
    \begin{equation}
    \begin{aligned}
        \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
        &= \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(0))}{\mb \xi_{uu^+}} 
        + \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(0))}{\mb \xi_{uu^+}}\\
        &\leq \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(0))}{\mb \xi_{uu^+}} 
        + \left\| \grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(0)) \right\|_2 d_{\mc M}(\mb q_u, \mb q_{u^+}).
    \end{aligned}
\end{equation}


For any $\mb x \ne \mb q_u$, our first-order step rule is equivalent of choosing \[u^+ = \arg \min_{v : u \overset{1}{\rightarrow} v \in E^1} \left\| R_a\frac{\mc P_{T_u} (\mb x -\mb q_u)}{\left\|\mc P_{T_u} (\mb x -\mb q_u) \right\|_2} - \mc P_{T_u} (\mb q_v - \mb q_u) \right\|_2\] 
Then, lemma \ref{lem:tangent space covering} guarantees that there exists a $v$ satisfies \Cref{eq:app:bound_dot_prod_grad_edge_tangent_dir_condition}. From our step rule, we know that $q_{u^+}$ also satisfies \Cref{eq:app:bound_dot_prod_grad_edge_tangent_dir_condition}. Together with Lemma \ref{lem:bound dot product of gradient and edge in tangent direction}  and $d_{\mc M}(\mb\gamma(0),\mb x_\natural) \leq 1/\kappa$, we have
\begin{equation}
    \begin{aligned}
        \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(0))}{\mb \xi_{uu^+}} 
        &\leq -0.55 \left\|\grad[\varphi_{\mb x}](\mb\gamma(0)) \right\|_2 \left\|\mb \xi_{uu^+} \right\|_2\\
        &\leq -0.55 \left( \left\| P_{T_{\mb\gamma(0)}\mc M}  \left(\mb x_\natural - \mb\gamma(0)\right)\right\|_2 - \left\| P_{T_{\mb\gamma(0)}\mc M} \mb z\right\|_2\right) \left\|\mb \xi_{uu^+} \right\|_2\\
        &\leq -0.55\left( d_{\mc M}(\mb\gamma(0),\mb x_\natural)\left( 1-\frac{1}{2}\kappa d_{\mc M}(\mb\gamma(0),\mb x_\natural)\right) - T_{\max}\right) \frac{1}{2}d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        &\leq \frac{-0.55}{2}\left(\frac{1}{2}d_{\mc M}(\mb\gamma(0),\mb x_\natural) -T_{\max} \right) d_{\mc M}(\mb q_u, \mb q_{u^+}).
    \end{aligned}
\end{equation}
where from the second to the third line we've used the same argument from equation \eqref{eq: bound norm of edge embedding} to lower bound $\left\| P_{T_{\mb\gamma(0)}\mc M}  \left(\mb x_\natural - \mb\gamma(0)\right)\right\|_2$ by $d_{\mc M}(\mb\gamma(0),\mb x_\natural)\left( 1-\frac{1}{2}\kappa d_{\mc M}(\mb\gamma(0),\mb x_\natural)\right)$ and $\left\|\mb \xi_{uu^+} \right\|_2$ by $\frac{1}{2}d_{\mc M}(\mb q_u, \mb q_{u^+})$
And we can bound $\left\| \grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(0)) \right\|_2$:

\begin{equation}
    \begin{aligned}
        \left\| \grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(0)) \right\|_2 
        &\leq \left\| \left(P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right)(\mb\gamma(t)-\mb x_\natural)\right\|_2\\
        &+  \left\| \left(P_{T_{\mb\gamma(t)} \mc M} - 
        P_{T_{\mb\gamma(0)} \mc M}\right) \mb z\right\|_2\\
        &+\left\|P_{T_{\mb\gamma(0)} \mc M}(\mb\gamma(t)-\mb\gamma(0)) \right\|_2\\
        &\leq \left\| P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right\|_{op} d_{\mc M}(\mb\gamma(t),\mb x_\natural)\\
        &+ \left\| P_{T_{\mb\gamma(t)} \mc M}  \mb z\right\|_2 + \left\| P_{T_{\mb\gamma(0)} \mc M}  \mb z\right\|_2\\
        &+ \left\|P_{T_{\mb\gamma(0)} \mc M}(\mb\gamma(t)-\mb\gamma(0)) \right\|_2
    \end{aligned}
\end{equation}

Together with Lemma \ref{lemma:tangnet space diff bound}, we have
\begin{equation}
    \left\| P_{T_{\mb\gamma(t)} \mc M} - P_{T_{\mb\gamma(0)} \mc M}\right\|_{op} d_{\mc M}(\mb\gamma(t),\mb x_\natural)
    \leq 3\sqrt{2} \kappa t d_{\mc M}(\mb q_u, \mb q_{u^+}) d_{\mc M}(\mb\gamma(t),\mb x_\natural)
\end{equation}

Since $\mb\gamma(t)\in B_{\mc M}(\mb x_\natural, 1/\kappa) \quad \forall t\in[0,1]$, we have
\begin{equation}
    \left\| P_{T_{\mb\gamma(t)} \mc M}  \mb z\right\|_2 \leq T_{\max},
\end{equation}
hence
\begin{equation}
    \left\| P_{T_{\mb\gamma(t)} \mc M}  \mb z\right\|_2+
    \left\| P_{T_{\mb\gamma(0)} \mc M}  \mb z\right\|_2 
    \leq 2T_{\max}.
\end{equation}

From Taylor expansion on the geodesic $\mb\gamma$, we have
\begin{equation}
    \begin{aligned}
        \left\|P_{T_{\mb\gamma(0)} \mc M}(\mb\gamma(t)-\mb\gamma(0)) \right\|_2
        &= \left\|P_{T_{\mb\gamma(0)} \mc M} \int_{a=0}^t \Dot{\mb\gamma}(a) da \right\|_2\\
        &= \left\|P_{T_{\mb\gamma(0)} \mc M} \int_{a=0}^t \left(\Dot{\mb\gamma}(0) + \int_{b=0}^a \Ddot{\mb\gamma}(b) db\right) da \right\|_2\\
        &= \left\| \Dot{\mb\gamma}(0) t + \int_{a=0}^t \int_{b=0}^a 
        P_{T_{\mb\gamma(0)} \mc M} \Ddot{\mb\gamma}(b) db  da \right\|_2\\
        &\leq t d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} \kappa t^2 d_{\mc M}^2 (\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
Therefore, 
\begin{equation}
    \begin{aligned}
     \left\| \grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(0)) \right\|_2 
      \leq 3\sqrt{2} \kappa t d_{\mc M}(\mb q_u, \mb q_{u^+}) d_{\mc M}(\mb\gamma(t),\mb x_\natural)
      + 2T_{\max}
      + t d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} \kappa t^2 d_{\mc M}^2 (\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}

Combining all of things above, we have
\begin{equation}
    \begin{aligned}
        \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
        &\leq \frac{-0.55}{2} \left( \frac{1}{2}d_{\mc M}(\mb x_\natural, \mb\gamma(0))  - T_{\max}\right) 
        d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        &+ \left( 3\sqrt{2} \kappa t d_{\mc M}(\mb q_u, \mb q_{u^+}) d_{\mc M}(\mb\gamma(t),\mb x_\natural)+2T_{\max}+ t d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} \kappa t^2 d_{\mc M}^2 (\mb q_u, \mb q_{u^+})\right) d_{\mc M}(\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
\end{proof}






\begin{lemma}\label{prop:one step in phase III}
Suppose
\begin{equation}
    \mb q_u \in B_{\mc M}(\mb x_\natural, c/\kappa) \setminus B_{\mc M}(\mb x_\natural, C T_{\max} ),
\end{equation}
for some constant $c \leq 0.1, \: C \ge 321$, with 
\begin{equation}
    T_{\max} = \sup_{\mb y \in B_{\mc M}(\mb x_\natural, 1/\kappa), \mb v \in T_{\mb y} \mc M, \| \mb v \|_2 =1} \innerprod{\mb v}{\mb z},
\end{equation}
and \begin{equation}
    d_{\mc M}(\mb q_u, \mb q_{u^+}) \leq \min \left\{ \frac{1}{100\kappa}, \frac{1}{8} T_{\max}\ \right\}, 
    \end{equation}
    then 
    \begin{equation}
        d_{\mc M}(\mb q_{u^+},\mb x_\natural) \leq  d_{\mc M}(\mb q_{u},\mb x_\natural) - \frac{1}{80} d_{\mc M}(\mb q_u, \mb q_{u^+}).    
    \end{equation}
\end{lemma}

\begin{proof} Let $\mb\gamma:[0,1] \rightarrow \mc M$ be a minimum length geodesic joining $\mb q_u$ and $\mb q_{u^+}$ with constant speed $d_{\mc M}(\mb q_u, \mb q_{u^+})$, where $\mb\gamma(0)=\mb q_u, \mb\gamma(1)=\mb q_{u^+}$. Then we have
\begin{equation}
    \begin{aligned}
        d_{\mc M}(\mb x_\natural, \mb q_{u^+}) - d_{\mc M}(\mb x_\natural, \mb q_u)
        &= \int_{t=0}^1 \frac{d}{dt}d_{\mc M}(\mb x_\natural, \mb\gamma(t)) dt\\
        &=\int_{t=0}^1 \innerprod{\frac{d}{d \mb y}d_{\mc M}(\mb x_\natural,\mb y)\Big|_{\mb y=\mb\gamma(t)}}{\dot{\mb\gamma}(t)} dt\\
        &= \int_{t=0}^1 \innerprod{\frac{-\log_{\mb \gamma(t)}\mb x_\natural}{\| \log_{\mb \gamma(t)}\mb x_\natural\|_2}}{\dot{\mb\gamma}(t)} dt.
    \end{aligned}
\end{equation}
We can further decompose the integrand as follows:
\begin{equation}
    \begin{aligned}
        &\innerprod{\frac{-\log_{\mb \gamma(t)}\mb x_\natural}{\| \log_{\mb \gamma(t)}\mb x_\natural\|_2}}{\dot{\mb\gamma}(t)}\\
        &= \frac{1}{\| \log_{\mb \gamma(t)}\mb x_\natural\|_2} \innerprod{-\log_{\mb \gamma(t)}\mb x_\natural + \grad[\varphi_{\mb x}](\mb\gamma(t)) - \grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t) + \mb \xi_{uu^+} - \mb \xi_{uu^+}}\\
        &= \frac{1}{d_{\mc M}(\mb\gamma(t), \mb x_\natural)}  
        \left(\innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
        + \innerprod{-\log_{\mb \gamma(t)}\mb x_\natural - \grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)}
        + \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)-\mb\xi_{uu^+}} \right) \label{eqn:dist-deriv-split1}.
    \end{aligned}
\end{equation}
We will proceed to use Lemma \ref{lemma:main term bound} to bound the first term, Lemma \ref{lemma:log-grad-comparison} to bound the second term, and Lemmas \ref{lemma:velocity-edgeembedding-comparison} and \ref{lemma:grad-bound} to bound the last term. In order to apply these lemmas, we observe that $\forall t\in[0,1], d_{\mc M}(\mb\gamma(t),\mb x_\natural) \leq d_{\mc M}(\mb\gamma(0),\mb x_\natural) + d_{\mc M}(\mb\gamma(0),\mb\gamma(t)) \leq d_{\mc M}(\mb\gamma(0),\mb x_\natural) + d_{\mc M}(\mb\gamma(0),\mb\gamma(1)) \leq \frac{c}{\kappa} + \frac{1}{100\kappa}\leq \frac{1}{8\kappa}.$ 



Thus from Lemma \ref{lemma:main term bound} we have
 \begin{equation}
    \begin{aligned}
        \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
        &\leq {\frac{-0.55}{2}} \left( \frac{1}{2}d_{\mc M}(\mb x_\natural, \mb\gamma(0))  - T_{\max}\right) 
        d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        &+ \left( 3\sqrt{2} \kappa t d_{\mc M}(\mb q_u, \mb q_{u^+}) d_{\mc M}(\mb\gamma(t),\mb x_\natural)+2T_{\max}+ t d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} \kappa t^2 d_{\mc M}^2 (\mb q_u, \mb q_{u^+})\right) d_{\mc M}(\mb q_u, \mb q_{u^+}) \\
        &\leq \left(-\frac{1}{8}d_{\mc M}(\mb x_\natural, \mb\gamma(t))+\frac{1}{8}d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{2} T_{\max}\right)d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        &+ \left( \frac{3\sqrt{2}}{8}d_{\mc M}(\mb q_u, \mb q_{u^+})+2T_{\max}+ d_{\mc M}(\mb q_u, \mb q_{u^+}) + \frac{1}{200} d_{\mc M} (\mb q_u, \mb q_{u^+})\right) d_{\mc M}(\mb q_u, \mb q_{u^+}) \\
        &\leq \left(-\frac{1}{8}d_{\mc M}(\mb x_\natural, \mb\gamma(t))+ \frac{5}{2} T_{\max} + 2d_{\mc M}(\mb q_u, \mb q_{u^+}) \right)d_{\mc M}(\mb q_u, \mb q_{u^+})\\
    \end{aligned}
\end{equation}
Similarly, from Lemma \ref{lemma:log-grad-comparison} we have 
\begin{equation}
    \begin{aligned}
    \innerprod{-\log_{\mb \gamma(t)}\mb x_\natural - \grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)}
    &\leq \left\|-\log_{\mb \gamma(t)}\mb x_\natural - \grad[\varphi_{\mb x}](\mb\gamma(t))\right\| \cdot \left\|\dot{\mb\gamma}(t)\right\| \\ 
    &\leq \left(\frac{1}{2} \kappa d_{\mc M}^2 (\mb\gamma(t), \mb x_\natural) + T_{\max}\right)\cdot d_{\mc M}(\mb q_u, \mb q_{u^+})\\
    &\leq \left(\frac{1}{16}d_{\mc M} (\mb\gamma(t), \mb x_\natural) + T_{\max}\right)\cdot d_{\mc M}(\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
and Lemmas \ref{lemma:velocity-edgeembedding-comparison} and \ref{lemma:grad-bound} also give
\begin{equation}
    \begin{aligned}
    \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)-\mb\xi_{uu^+}}
    &\leq \left\|\grad[\varphi_{\mb x}](\mb\gamma(t))\right\| \cdot \left\|\dot{\mb\gamma}(t)-\mb\xi_{uu^+}\right\| \\ 
    &\leq \left(d_{\mc M} (\mb\gamma(t), \mb x_\natural) + T_{\max} \right)\cdot\left(\frac{3\kappa}{2}d_{\mc M}{^2}(\mb q_u, \mb q_{u^+})\right)\\
    &\leq \left(\frac{3}{200}d_{\mc M} (\mb\gamma(t), \mb x_\natural) +\frac{3}{200} T_{\max} \right)d_{\mc M}(\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
Lastly, we combine the terms to get
\begin{equation}
    \begin{aligned}
        & \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\mb \xi_{uu^+}}
        + \innerprod{-\log_{\mb \gamma(t)}\mb x_\natural - \grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)}
        + \innerprod{\grad[\varphi_{\mb x}](\mb\gamma(t))}{\dot{\mb\gamma}(t)-\mb\xi_{uu^+}} \\
        \leq& \left(-\frac{1}{40}d_{\mc M} (\mb\gamma(t), \mb x_\natural) +\frac{15}{4}T_{\max}+ 2d_{\mc M}(\mb q_u, \mb q_{u^+}) \right)d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        \leq& \left(-\frac{1}{40}d_{\mc M} (\mb\gamma(t), \mb x_\natural) +4T_{\max}\right)d_{\mc M}(\mb q_u, \mb q_{u^+})\\
        \leq& \left(-\frac{1}{80}d_{\mc M} (\mb\gamma(t), \mb x_\natural)\right)d_{\mc M}(\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
where we've used our assumption that $d_{\mc M}(\mb q_u, \mb q_{u^+})\leq \frac{1}{8}T_{\max}$ and $d_{\mc M} (\mb\gamma(t), \mb x_\natural) \ge d_{\mc M} (\mb\gamma(0), \mb x_\natural) - d_{\mc M}(\mb q_u, \mb q_{u^+}) \ge C T_{\max} - \frac{1}{8} T_{\max} \ge 320 T_{\max}$. Finanly, plugging this result back to Equation \ref{eqn:dist-deriv-split1}, we observe 
\begin{equation}
    \begin{aligned}
        d_{\mc M}(\mb x_\natural, \mb q_{u^+}) - d_{\mc M}(\mb x_\natural, \mb q_u)
        &= \int_{t=0}^1 \innerprod{\frac{-\log_{\mb \gamma(t)}\mb x_\natural}{\| \log_{\mb \gamma(t)}\mb x_\natural\|_2}}{\dot{\mb\gamma}(t)} dt\\
        & \leq \int_{t=0}^1\frac{1}{d_{\mc M}(\mb\gamma(t), \mb x_\natural)}  \left(-\frac{1}{80}d_{\mc M} (\mb\gamma(t), \mb x_\natural)\right)d_{\mc M}(\mb q_u, \mb q_{u^+}) dt\\
        & \leq -\frac{1}{80}d_{\mc M}(\mb q_u, \mb q_{u^+})
    \end{aligned}
\end{equation}
This completes the proof
\end{proof}


