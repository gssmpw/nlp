
\begin{lemma}\label{lem:edge bounded by tangent term}
With the assumption $R_{\text{nbrs}} \leq \tau_{\mc M}$ , for any $\mb q_u, \mb q_v \in \mc M$ and $u\overset{1}{\rightarrow} v \in E^1$, we have
    \begin{equation}
        \| \mb q_u - \mb q_v \|_2^2
        \leq \frac{4}{3} \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2
    \end{equation}
where $T_u$ is the tangent space at $\mb q_u \in \mc M$, and $\mc P_{T_u}$ is the orthogonal projection onto  $T_u$.
\end{lemma}
\begin{proof}
    For the self edge $u\overset{1}{\rightarrow} u \in E^1$, it's easy to show that $ \| \mb q_u - \mb q_u \|_2^2 = \frac{4}{3} \| \mc P_{T_u} \paren{\mb q_u - \mb q_u} \|_2^2 =0$.\\
    Now we consider the situation when $u\overset{1}{\rightarrow} v \in E^1 (u \neq v)$.  By the theorem 2.2 in \cite{aamari2019estimating} and theorem 4.18 in \cite{federer1959curvature}, we know the reach $\tau_{\mc M}$ of the manifold $\mc M$ satisfies
    \begin{equation}
    \tau_{\mc M} = \inf_{\mb q_u \neq \mb q_v \in \mc M}
    \frac{\| \mb q_u - \mb q_v \|_2^2}{2 \| \mc P_{N_u } \paren{\mb q_u - \mb q_v}\|_2}
\end{equation}
where $N_u$ is the normal space at $\mb q_u \in \mc M$, and $\mc P_{N_u}$ is the orthogonal projection onto the $N_u$.\\
Thus, for any $u\overset{1}{\rightarrow} v \in E^1 (u \neq v)$, we have
\begin{equation}
    \tau_{\mc M}
    \leq \frac{\| \mb q_u - \mb q_v \|_2^2}{2 \mc \| \mc P_{N_u} \paren{\mb q_u - \mb q_v} \|_2}
\end{equation}
By the rule of connecting first-order edges, for any edge $u\overset{1}{\rightarrow} v \in E^1$, we have $\| \mb q_u - \mb q_v \|_2 \leq R_{\text{nbrs}}$.\\
By assumption, $R_{\text{nbrs}} \leq \tau_{\mc M}$, thus for first-order edges $u\overset{1}{\rightarrow} v (u \neq v)$, we have:
\begin{equation}
    \begin{aligned}
    \| \mb q_u - \mb q_v \|
    &\leq R_{\text{nbrs}}\\
    &\leq \tau_{\mc M}\\
    &\leq \frac{\| \mb q_u - \mb q_v \|_2^2}{2 \mc \| \mc P_{N_u} \paren{\mb q_u - \mb q_v} \|_2}
    \end{aligned}
\end{equation}
Square both sides, we obtain:
\begin{equation}
    \begin{aligned}
        \| \mb q_u - \mb q_v \|_2^2
        \geq 4 \| \mc P_{N_u} \paren{\mb q_u - \mb q_v} \|_2^2
    \end{aligned}
\end{equation}
Since the tangent and normal components are orthogonal, we have $ \| \mb q_u - \mb q_v \|_2^2 = \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2 + \| \mc P_{N_u} \paren{\mb q_u - \mb q_v} \|_2^2$. Therefore, we have:
\begin{equation}
     \| P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2
     \geq 3  \| P_{N_u} \paren{\mb q_u - \mb q_v} \|_2^2
\end{equation}
Consequently, we have
\begin{equation}
    \begin{aligned}
    \| \mb q_u - \mb q_v \|_2^2
    &= \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2 + \| \mc P_{N_u} \paren{\mb q_u - \mb q_v} \|_2^2\\
    &\leq \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2 + \frac{1}{3}\| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2\\
    &= \frac{4}{3} \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2
    \end{aligned}
\end{equation}
This completes the proof.
\end{proof}


\begin{lemma}\label{lem:small Euclidean ball covering} For any $\mb w_\natural \in B(\mb q_u, R_a) \cap \mc M$, there exists $v: u \overset{1}{\rightarrow} v \in E^1$, such that 
    \begin{equation}
        \| \mb w_\natural - \mb q_v \|_2 \leq \delta
    \end{equation}
\end{lemma}
\begin{proof}
    Since the landmarks form a $\delta$- cover of $\mc M$, and $R_{\text{nbrs}} = a \cdot \delta (a \geq 40)$, there exists $v \in V$ such that $\| \mb q_v - \mb w_\natural \|_2 \leq \delta = \frac{1}{a} R_{\text{nbrs}}$.  \\
    From the triangle inequality, we have
    \begin{equation}
        \begin{aligned}
            \| \mb q_v - \mb q_u \|_2
            &\leq \| \mb q_v - \mb w_\natural \|_2 + \| \mb w_\natural - \mb q_u \|_2\\
            &\leq \frac{1}{a} R_{\text{nbrs}} + R_a\\
            &= \frac{1}{a} R_{\text{nbrs}} + \frac{a-1}{a} R_{\text{nbrs}}\\
            &= R_{\text{nbrs}}
        \end{aligned}
    \end{equation}
From the rule of connecting first-order edges, we know $u \overset{1}{\rightarrow} v \in E^1$. This completes the proof.
\end{proof}

\begin{lemma}\label{lem:tangent space covering}
 For any $\mb w \in T_u$, with $\| \mb w \|_2 \leq R_a$, there exists $v: u \overset{1}{\rightarrow} v \in E^1$, such that 
 \begin{equation}
     \| \mb w - \mc P_{T_u} \paren{\mb q_v - \mb q_u}\|_2
     \leq \delta + \frac{1}{2} \kappa R_a^2
 \end{equation}
\end{lemma}

\begin{proof}
    Consider a constant-speed geodesic $\mb \gamma: [0,1] \rightarrow \mc M$, $\mb \gamma(0)=\mb q_u, \dot{\mb \gamma}(0) =\mb w$ with $\| \mb w \|_2 \leq R_a$. Let $\mb \gamma(1)= \mb w_\natural$.
From the fundemental theorem of calculus, we have
\begin{equation}
    \begin{aligned}
        \mb \gamma(1) = \mb \gamma(0) + \int_{t=0}^1 \dot{\mb \gamma}(t) dt
    \end{aligned}
\end{equation}
Therefore,
\begin{equation}
    \begin{aligned}
       \left\| \mb w_\natural - \mb q_u \right\|_2 
        &= \left\| \int_{t=0}^1 \dot{\mb \gamma}(t) dt \right\|_2\\
        &\leq \int_{t=0}^1 \left\| \dot{\mb \gamma}(t)\right\| dt\\
        &= \| \mb w \|_2\\
        &\leq R_a
    \end{aligned}
\end{equation}
This means $\mb w_\natural \in B(\mb q_u, R_a)$. By lemma \ref{lem:small Euclidean ball covering}, there exists $v: u \overset{1}{\rightarrow} v \in E^1$, such that $\| \mb w_\natural - \mb q_v \|_2 \leq \delta$.\\
By fundamental theorem of calculus, we also know
\begin{equation}\label{eq:geodesic taylor expansion}
    \begin{aligned}
    \mb \gamma(1) 
    &= \mb \gamma(0) + \int_{t=0}^1 \dot{\mb \gamma}(t) dt\\
    &= \mb \gamma(0) + \int_{t=0}^1 \paren{ \dot{\mb \gamma}(0) + \int_{s=0}^t \ddot{\mb \gamma}(s) ds } dt\\
    &= \mb \gamma(0) + \dot{\mb \gamma}(0) + \int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt
    \end{aligned}
\end{equation}
Then we have
\begin{equation}
    \begin{aligned}
        \mb w = \mb w_\natural - \mb q_u - \int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt
    \end{aligned}
\end{equation}
Since $\mb w \in T_u$, we have
\begin{equation}
    \begin{aligned}
        \mb w = \mc P_{T_u} (\mb w)
        = \mc P_{T_u} \paren{\mb w_\natural - \mb q_u} - \mc P_{T_u} \paren{\int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt}
    \end{aligned}
\end{equation}
Hence we know
\begin{equation}
    \begin{aligned}
    \left\| \mb w - \mc P_{T_u} \paren{\mb q_v - \mb q_u}\right\|_2
        &= \left\| \mc P_{T_u}\paren{\mb w_\natural - \mb q_u} - \mc P_{T_u} \paren{\int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt} - \mc P_{T_u} \paren{\mb q_v - \mb q_u} \right\|_2\\
        &= \left\| \mc P_{T_u} \paren{\mb w_\natural - \mb q_v} - \mc P_{T_u} \paren{\int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt}\right\|_2\\
        &\leq \left\| \mb w_\natural - \mb q_v \right\|_2 + \left\| \int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt\right\|_2\\
        &\leq \delta + \int_{t=0}^1 \int_{s=0}^t \| \ddot{\mb\gamma}(s)\|_2 ds dt\\
        &\leq \delta + \frac{1}{2} \kappa \|\mb w\|_2^2\\
        &\leq \delta + \frac{1}{2} \kappa R_a^2
    \end{aligned}
\end{equation}
\end{proof}

\begin{lemma}\label{lem:bound dot product of gradient and edge in tangent direction}
    For any $\mb q_u\in \mc M$ and $\vx \ne \vq_u$, let $v: u\overset{1}{\rightarrow} v \in E^1$ satisfies:
    \begin{align}\label{eq:app:bound_dot_prod_grad_edge_tangent_dir_condition}
        \norm*{ \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u} \paren{\mb q_v - \mb q_u}}_2 \le \delta + \frac{1}{2}\kappa R_a^2.
    \end{align}
    Then we have
    \begin{equation}
         \innerprod{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\mc P_{T_u}\paren{\mb q_v - \mb q_u}}
        \ge 0.55
        \| \mc P_{T_u} \paren{\mb x - \mb q_u} \|_2   \| \mc P_{T_u}\paren{\mb q_v - \mb q_u} \|_2. 
    \end{equation}
\end{lemma}


\begin{proof}
Let $ \delta_T = \delta + \frac{1}{2} \kappa R_a^2$. Given our global constraints that $\delta = \frac{1}{a} R_{\text{nbrs}}$, $a\ge 40$ and $R_{\mr{nbrs}} \le \tau_{\mc M} \le 1/\kappa$,
\begin{equation}\label{eq:bound on delta_T over R_a}
    \begin{aligned}
        \frac{\delta_T}{R_a} 
        &= \frac{\frac{1}{a}R_{\text{nbrs}} + \frac{1}{2}\kappa (1-\frac{1}{a})^2 R_{\text{nbrs}}^2}{(1-\frac{1}{a})R_{\text{nbrs}}}\\
        &=\frac{1}{a(1-\frac{1}{a})} + \frac{1}{2} \kappa (1-\frac{1}{a}) R_{\text{nbrs}}\\
        &\leq \frac{1}{a-1} + \frac{1}{2} (1-\frac{1}{a})\\
        & \le \frac{5}{6} \\ 
    \end{aligned}
\end{equation}

From the assumption we have
 \begin{equation}\label{eq:tangent space covering assumption in tangent term}
     \norm*{ \frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a - \mc P_{T_u} \paren{\mb q_v - \mb q_u}}_2
     \leq \delta_T
 \end{equation}

Square both sides of the equation \eqref{eq:tangent space covering assumption in tangent term}, we have
\begin{equation}
    R_a^2 + \| \mc P_{T_u} \paren{\mb q_v - \mb q_u }\|_2^2 - 2 \innerprod{\frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a}{\mc P_{T_u} \paren{\mb q_v - \mb q_u}} \leq \delta_T^2
\end{equation}
Then we have
\begin{equation}
    \begin{aligned}
        \innerprod{\frac{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\| \mc P_{T_u} \paren{\mb x - \mb q_u}\|_2} R_a}{\mc P_{T_u} \paren{\mb q_v - \mb q_u}}
        &\geq \frac{R_a^2 - \delta_T^2 + \| \mc P_{T_u} \paren{\mb q_v - \mb q_u }\|_2^2}{2}\\
        &\geq \sqrt{R_a^2 - \delta_T^2} \| \mc P_{T_u} \paren{\mb q_v - \mb q_u }\|_2
    \end{aligned}
\end{equation}
Therefore, we have
\begin{equation}
\label{eq:dot product on the tangent space large compared to the norm}
    \begin{aligned}
         \innerprod{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\mc P_{T_u} \paren{\mb q_v - \mb q_u}} 
        \geq \sqrt{1 - \frac{\delta_T^2}{R_a^2}}
        \| \mc P_{T_u} \paren{\mb x - \mb q_u }\|_2
        \| \mc P_{T_u} \paren{\mb q_v - \mb q_u }\|_2
    \end{aligned}
\end{equation}
Substituting our result from eq(\ref{eq:bound on delta_T over R_a} to) eq \eqref{eq:dot product on the tangent space large compared to the norm}, we have the following inequality:
\begin{equation}
     \innerprod{\mc P_{T_u} \paren{\mb x - \mb q_u}}{\mc P_{T_u} \paren{\mb q_v - \mb q_u}} 
    \geq 0.55
    \| \mc P_{T_u} \paren{\mb x - \mb q_u }\|_2
    \| \mc P_{T_u} \paren{\mb q_v - \mb q_u }\|_2
\end{equation}
\end{proof}

\begin{lemma}\label{lem:intrinsic dist bounded by extrinsic dist}
     If $\mb q_u, \mb q_v \in \mc M$ and $\| \mb q_u - \mb q_v \|_2 \leq \tau_{\mc M}$, we have
    \begin{equation}
        d_{\mc M}(\mb q_u, \mb q_v) \leq 2 \| \mb q_u - \mb q_v \|_2
    \end{equation}
where $d_{\mc M}(\cdot,\cdot)$ is the intrinsic distance along the manifold.
\end{lemma}
\begin{proof}
    Let $\mb q_t = \mb q_u + t (\mb q_v - \mb q_u), t\in[0,1]$. From Theorem C in \cite{leobacher2021existence}, we know 
    \begin{equation}
        \frac{d}{dt} \mc P_{\mc M} [\mb q_t]=
        \paren{\mb I - \sff^*[\mb q_t - \mc P_{\mc M}[\mb q_t]]}^{-1}  \mc P_{T_{\mc P_{\mc M} [\mb q_t]} \mc M} (\mb q_v - \mb q_u) 
    \end{equation}
Therefore, we have
\begin{equation}
    \begin{aligned}
        \| \frac{d}{dt} \mc P_{\mc M} [\mb q_t] \|_2
        &\leq \| \paren{\mb I - \sff^*[\mb q_t - \mc P_{\mc M}[\mb q_t]]}^{-1} \|_{\text{op}} \| \mc P_{T_{\mb q_t} \mc M} (\mb q_v - \mb q_u)  \|_2\\
        &\leq \frac{\| \mb q_v - \mb q_u \|_2}{1-\kappa \|\mb q_t - \mc P_{\mc M}[\mb q_t] \|_2}\\
        &= \frac{\| \mb q_v - \mb q_u \|_2}{1-\kappa d(\mb q_t, \mc M)}\\
        &\leq \frac{\| \mb q_v - \mb q_u \|_2}{1-\kappa \min\{\| \mb q_t - \mb q_u\|_2, \| \mb q_t - \mb q_v \|_2\}}\\
        &\leq \frac{\| \mb q_v - \mb q_u \|_2}{1-\frac{1}{2} \kappa \| \mb q_v - \mb q_u \|_2}\\
        & \leq \frac{\| \mb q_v - \mb q_u \|_2}{1-\frac{1}{2} \kappa \tau_{\mc M}}\\
        &\leq 2 \| \mb q_v - \mb q_u\|_2
    \end{aligned}
\end{equation}
where in the second line we've used the property that $\forall \mb \eta$, $\| \sff^*[\mb \eta] \| \le \kappa \| \mb \eta \|_2$, and in the last line we've applied the fact that $\tau_{\mc M} \le 1/ \kappa$. 
Then the intrinsic distance along the manifold is 
\begin{equation}
    \begin{aligned}
        d_{\mc M}(\mb q_u, \mb q_v) 
        &\leq \int_{t=0}^1 \| \frac{d}{dt} \mc P_{\mc M} [\mb q_t] \|_2 dt\\
        &\leq \int_{t=0}^1 2\| \mb q_v - \mb q_u \|_2 dt\\
        &= 2\| \mb q_v - \mb q_u \|_2
    \end{aligned}
\end{equation}
This completes the proof.
\end{proof}






\begin{lemma}\label{lem:bound norm edge term}
    For any $\mb q_u, \mb q_v \in \mc M$, we have
    \begin{equation}
        \| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2
        \leq \frac{1}{2} \kappa d_{\mc M}^2(\mb q_u, \mb q_v)
    \end{equation}
\end{lemma}
\begin{proof}
    Consider the geodesic $\mb \gamma:[0,1] \rightarrow M \subset \mathbb{R}^D$ with constant speed $\| \mb v\|_2$, where $\mb \gamma \paren{0} = \mb q_u, \mb \gamma \paren{1} = \mb q_v$.
    Then the intrinsic distance between the $\mb q_u$ and $\mb q_v$ is:
    \begin{equation}
            d_{\mc M}(\mb q_u, \mb q_v)
            = \int_{t=0}^1 \| \mb v\|_2 dt = \| \mb v\|_2
    \end{equation}
From equation \eqref{eq:geodesic taylor expansion} and the fact $\dot{\mb\gamma}(0) \in T_{u}$, we have
\begin{equation}
    \| \mc P_{N_u }(\mb\gamma(1) - \mb\gamma(0))\|_2
    = \norm*{ \int_{t=0}^1 \int_{s=0}^t \ddot{\mb\gamma}(s) ds dt }_2
\end{equation}


\begin{equation}
    \begin{aligned}
        \| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2
        &= \norm*{ \mc P_{N_u} \paren{\mb \gamma \paren{1} - \mb \gamma \paren{0}} }_2\\
        &= \norm*{  \mc P_{N_u} \int_{t=0}^1 \int_{s=0}^t \Ddot{\mb \gamma} \paren{s}  ds dt }_2\\
        & \leq \norm*{ \int_{t=0}^1 \int_{s=0}^t \Ddot{\mb \gamma} \paren{s}  ds dt }_2\\
        & \leq \int_{t=0}^1 \int_{s=0}^t \| \Ddot{\mb \gamma} \paren{s} \|_2  ds dt\\
        & \leq \int_{t=0}^1 \int_{s=0}^t \kappa \| \vv\|_2 ds dt\\
        &= \frac{1}{2} \kappa \|\mb v\|_2^2\\
        &= \frac{1}{2} \kappa d^2_{\mc M}(\mb q_u, \mb q_v)
    \end{aligned}
\end{equation}
This completes the proof.
\end{proof}

\begin{lemma} \label{lem:bound normal edge by tangent edge square}
    If $\mb q_u, \mb q_v \in \mc M$ and $\| \mb q_u - \mb q_v \|_2 \leq \tau_{\mc M}$, we have
    \begin{equation}
        \| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2 \leq \frac{8}{3} \kappa \| \mc P_{T_u} \paren{\mb q_v - \mb q_u} \|_2^2
    \end{equation}
\end{lemma}
\begin{proof}
    Given $\mb q_u, \mb q_v \in \mc M$ and $\| \mb q_u - \mb q_v \|_2 \leq \tau_{\mc M}$, from lemma \ref{lem:intrinsic dist bounded by extrinsic dist}, we know $d_{\mc M}(\mb q_u, \mb q_v) \leq 2 \| \mb q_u - \mb q_v \|_2$.
    From lemma \ref{lem:bound norm edge term}, we have
    $\| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2 \leq \frac{1}{2} \kappa d_{\mc M}^2(\mb q_u, \mb q_v)$. By lemma \ref{lem:edge bounded by tangent term}, we have  $ \| \mb q_u - \mb q_v \|_2^2 \leq \frac{4}{3} \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2$. Then we have 

    \begin{equation}
        \begin{aligned}
        \| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2
        &\leq \frac{1}{2} \kappa d_{\mc M}^2(\mb q_u, \mb q_v)\\
        &\leq 2 \kappa \| \mb q_u - \mb q_v \|_2^2\\
        &= \frac{8}{3} \kappa \| \mc P_{T_u} \paren{\mb q_u - \mb q_v} \|_2^2
        \end{aligned}
    \end{equation}
This completes the proof.
\end{proof}

\begin{lemma}\label{lem:bound dot product of gradient and edge in the normal direction}
    For any $t > 0$, with probability at least $1-e^{-\frac{t^2}{2\sigma^2}}$ in the noise, for any $\mb q_u, \mb q_v \in \mc M$ and $u\overset{1}{\rightarrow} v \in E^1$,
    \begin{equation}\label{eq:high prob bound for normal term}
         - \innerprod{\mc P_{N_u} \paren{\mb x - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}} 
         \leq \frac{8}{3} \kappa (\diam(\mc M) + \sqrt{2} \sigma \sqrt{\log |E^1|} + t) \| \mc P_{T_u}(\mb q_v - \mb q_u) \|_2^2
    \end{equation}
\end{lemma}
\begin{proof}
As $u \firstE v \in E^1$, we have $\norm{\vq_u - \vq_v} \le \firstER \le \tau_{\sM}$ from the construction of $E^1$. We decompose the left hand side in equation \eqref{eq:high prob bound for normal term} as follows: 

\begin{align}
- \innerprod{\mc P_{N_u} \paren{\mb x - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}} 
= - \innerprod{\mc P_{N_u} \paren{\mb x_\natural - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}} - \innerprod{\mb z}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}}. \label{eq:dot_prod_of_gd_and_edge_normal_dir_decompose}
\end{align}

From lemma \ref{lem:bound normal edge by tangent edge square}, we have $\| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2 \leq \frac{8}{3} \kappa \| \mc P_{T_u} \paren{\mb q_v - \mb q_u} \|_2^2$.
Then the first component on the right hand side can be rewritten as:
\begin{equation}\label{eq:bound signal component in normal term}
    \begin{aligned}
         - \innerprod{\mc P_{N_u} \paren{\mb x_\natural - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}}
         &\leq \| \mb x_\natural - \mb q_u \|_2 \| \mc P_{N_u} \paren{\mb q_v - \mb q_u} \|_2\\
         &\leq \frac{8}{3} \kappa \diam \mc M \| \mc P_{T_u} \paren{\mb q_v - \mb q_u} \|_2^2
    \end{aligned}
\end{equation}
Now consider a set of random variables 
\begin{equation}
    X_{\mb y} = - \innerprod{\mb z}{\mb y} \quad \mb y \in \mc Y
\end{equation}
with \[\mc Y = \Biggl\{ \frac{\mc P_{N_{u}} (\mb q_v - \mb q_u)}{\| \mc P_{N_{u}} (\mb q_v - \mb q_u) \|_2} \Big\vert \ \forall u \overset{1}{\rightarrow} v \in E^1, u \ne v,  \forall u, v \in \mc V \Biggl\}.\] 
Because $\mb z \sim \mathcal{N}(\mb 0, \sigma^2 \mb I)$, $X_{\mb y}$ follows the distribution $X_{\mb y} \sim \mathcal{N}(0, \sigma^2)$, and $(X_{\mb y})_{\mb y \in \mc Y}$ is a Gaussian process. We first bound the expectation of the supremum of this Gaussian process $ \mathbb E [\sup_{\mb y \in \mc Y} X_{\mb y}]$ by starting from
\begin{equation}
    \begin{aligned}
        e^{t' \mathbb E[\sup_{\mb y \in \mc Y} X_{\mb y}]}
        &= e^{\mathbb E[t'\sup_{\mb y \in \mc Y} X_{\mb y}]}\\
        &\leq \mathbb E[e^{t' \sup_{\mb y \in \mc Y} X_{\mb y}}] \\
        &\leq \sum_{i=1}^{|\mc Y|} \mathbb E[e^{t' X_{\mb y}}] \\
        &= |Y| e^{\frac{1}{2}\sigma^2 t'^2}, \quad \forall t' > 0. 
    \end{aligned}
\end{equation}
Take logarithm of both sides, we have
\begin{equation}\label{eq:take log}
    \E{\sup_{\mb y \in \mc Y} X_{\mb y}}
    \leq \frac{\log|\mc Y|}{t} + \frac{ \sigma^2 t'}{2}
\end{equation}
When $t' = \frac{\sqrt{2 \log |Y|}}{\sigma}$, the right hand side of equation \eqref{eq:take log} is minimized, and we obtain
\begin{equation}
     \mathbb E[\sup_{\mb y \in \mc Y} X_{\mb y}]
     \leq \sqrt{2} \sigma \sqrt{\log |Y|}
\end{equation}
By using Borellâ€“TIS inequality \cite{adler2007gaussian}, for any $t > 0$ we have
\begin{equation}
    \mathbb P(\sup_{\mb y \in \mc Y} X_{\mb y} - \mathbb E[\sup_{\mb y \in \mc Y} X_{\mb y}] > t) 
    \leq e^{\frac{-t^2}{2\sigma^2}}
\end{equation}
This implies 
\begin{equation}
    \mathbb P \left( -\innerprod{\mb z}{\frac{\mc P_{N_u}(\mb q_v - \mb q_u)}{\| \mc P_{N_u}(\mb q_v - \mb q_u) \|_2}} -  \mathbb E[\sup_{\mb y \in \mc Y} X_{\mb y}] \leq t \right) 
    > 1-  e^{\frac{-t^2}{2\sigma^2}}
\end{equation}
Therefore, with probability at least $1-e^{-\frac{t^2}{2\sigma^2}}$, we have
\begin{equation}\label{eq:bound noise component in normal term}
    \begin{aligned}
     -\innerprod{\mb z}{\mc P_{N_u}(\mb q_v - \mb q_u)}
    &\leq \| \mc P_{N_u}(\mb q_v - \mb q_u) \|_2 (\mathbb E[\sup_{\mb y \in \mc Y} X_{\mb y}] +  t) \\
    &\leq  \| \mc P_{N_u}(\mb q_v - \mb q_u) \|_2 (\sqrt{2} \sigma \sqrt{\log |Y|} + t)\\
    &\leq \frac{8}{3} \kappa \| \mc P_{T_u}(\mb q_v - \mb q_u) \|_2^2 (\sqrt{2} \sigma \sqrt{\log |Y|} + t) \quad \text{by lemma \ref{lem:bound normal edge by tangent edge square}}
    \end{aligned}
\end{equation}
Plug equation \eqref{eq:bound signal component in normal term} and equation \eqref{eq:bound noise component in normal term}, with probability at least $1-e^{-\frac{t^2}{2\sigma^2}}$, we have
\begin{equation}
    \begin{aligned}
        &- \innerprod{\mc P_{N_u} \paren{\mb x_\natural - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}} - \innerprod{\mb z}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}}
        \\
        &\qquad \qquad \leq - \innerprod{\mc P_{N_u} \paren{\mb x_\natural - \mb q_u}}{\mc P_{N_u} \paren{\mb q_v - \mb q_u}} + \sup_{u\overset{1}{\rightarrow}v} -\innerprod{\mb z}{\mc P_{N_u}(\mb q_v - \mb q_u)}\\
        &\qquad \qquad \leq \frac{8}{3} \kappa (\text{diam}(\mc M) + \sqrt{2} \sigma \sqrt{\log |Y|} + t) \| \mc P_{T_u}(\mb q_v - \mb q_u) \|_2^2
    \end{aligned}
\end{equation}
We conclude the proof by noting that $\abs{Y} < \abs{E^1}$. 
\end{proof}







