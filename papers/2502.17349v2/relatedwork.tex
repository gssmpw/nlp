\section{Related Works: Molecule Generation and Guidance on Diffusion Models}
\label{app:relatedwork}
\paragraph{Fragment-Based Drug Design.} Fragment-Based Drug Design (FBDD)~\citep{jin2023fflom,igashov2024difflinker,diffhop,imrie2020delinker,huang2022_3dlinker} is a drug discovery approach that utilizes small molecular fragments and optimizes them into larger, more potent drug candidates. Deep learning-based FBDD encompasses a variety of tasks, each distinguished by its learning objective. \textbf{Linker Generation} \citep{igashov2024difflinker,huang2022_3dlinker} is a fundamental task in FBDD, where two molecular fragments are connected to form a complete molecule. Similarly, \textbf{Topology Linker Generation} \citep{jin2023fflom,imrie2020delinker,zhang2024grelinker} focuses on linking the topological graphs of fragments to generate a complete molecular topology graph. \textbf{Scaffold Hopping}~\citep{diffhop,decompopt} involves replacing the core structure of a given molecule while preserving its biological activity. \textbf{PROTAC Design}~\citep{guan2024linkernet,kao2023_aimlinker} focuses on generating molecules that incorporate fragment linkers with flexible rotation and translation in 3D space. \textbf{Fragment Growing}~\citep{moler,autofragdiff} expands single small molecular fragment into larger drug-like structure. Our work specifically addresses Linker Generation, tackling the critical trade-off between diversity and validity observed in existing models. \cref{tab:moleculetasks} Summarizes the tasks in FBDD along with two standard molecular generation tasksâ€”De Novo Generation and Conformation Generation.

\paragraph{Molecule Generation.} Molecule generation~\citep{edm,midi,graphlatentdiffusion,liu2021graphpiece,madhawa2019graphnvp,sbdddiff} based on deep learning plays a crucial role in drug discovery and is broadly categorized into \textbf{De Novo Molecule Generation}\citep{moldiff,micam,midi,grum}, \textbf{Fragment-Based Drug Design}\citep{jin2023fflom,igashov2024difflinker,diffhop,imrie2020delinker,huang2022_3dlinker}, \textbf{Target-Aware Drug Design}\citep{targetdiff,diffdock,sbdddiff,pocket2mol}, and \textbf{Conformer Generation}\citep{geodiff,rebind,torsiondiff,confvae}, based on their input and output formulations. Molecule generation can also be classified into three sub-tasks: \textbf{Topology Generation}\citep{graphaf,micam,jin2023fflom,grum,graphpolish,graphlatentdiffusion,gldm}, \textbf{Point Cloud Generation}\citep{edm,geoldm,igashov2024difflinker,targetdiff,sbdddiff}, and \textbf{3D Graph Generation}, where deep learning models learn the distributions of molecular bonding topology, spatial coordinates, and 3D molecular graph representations, respectively. Our work falls under Fragment-Based Drug Design, introducing a hybrid approach that leverages pretrained models for topology and point cloud generation in a zero-shot manner.


\paragraph{Guidance on Diffusion Models.}
Diffusion models~\citep{ddpm,ddim,latentdiffusion,videodiffusion,grum,edm,midi} have demonstrated exceptional performance across various generative tasks, including image, video, graph, and molecular generation. A recent advancement in diffusion models is \textbf{conditional generation}~\citep{cfg,dps,mcg,classifierguidance}, which enables sampling from a conditional distribution based on desired properties. This is achieved by incorporating a guidance term into the backward diffusion process. To compute the guidance term, \textbf{Classifier Guidance} \citep{classifierguidance} employs a classifier trained to estimate the likelihood of a given property, while \textbf{Classifer-Free Guidance} (CFG) \citep{classifierguidance} replaces the classifier with a conditional diffusion model. \textbf{CFG++} \citep{mcg} is designed to mitigate off-manifold sampling issues, and \textbf{Diffusion Posterior Sampling} (DPS) \citep{dps} was developed to solve nonlinear noisy inverse problems. In this paper, we introduce the first DPS-based method for guiding diffusion models in molecular point cloud generation using molecular topology. Our approach introduces a novel energy-based function that effectively bridges topological and spatial molecular representations.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%