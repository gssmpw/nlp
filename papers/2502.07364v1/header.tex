\usepackage[table,dvipsnames]{xcolor}
\usepackage{setspace}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{bbm}
\usepackage{mathtools}
\usepackage{xspace}
\usepackage{tcolorbox}
\usepackage{emptypage}
\usepackage{float}
\usepackage{fancyhdr,lipsum}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[toc,page]{appendix}
\usepackage{listings}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{tabularx}
\usepackage{multirow}

\DeclareCaptionFont{figfont}{\fontsize{9pt}{10.8pt}\selectfont}
\captionsetup{font=figfont,labelfont=bf}

\urlstyle{same}

\definecolor{darkred}{rgb}{0.55, 0.0, 0.0}
\definecolor{darkblue}{rgb}{0.0, 0.0, 0.55}

\hypersetup{
    colorlinks=true,
    linkcolor=darkblue,
    citecolor=darkred,
    urlcolor=darkblue
}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour}, 
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false, 
    breaklines=true, 
    captionpos=b, 
    keepspaces=true, 
    numbers=left, 
    numbersep=5pt, 
    showspaces=false, 
    showstringspaces=false,
    showtabs=false, 
    tabsize=2
}

\lstset{style=mystyle}

\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Section}
\renewcommand{\appendixname}{Appendix}
\renewcommand{\appendixpagename}{Appendix}

% begin appendix autoref patch [\autoref subsections in appendix](https://tex.stackexchange.com/questions/149807/autoref-subsections-in-appendix)
\usepackage{etoolbox}
\makeatletter
\patchcmd{\hyper@makecurrent}{%
    \ifx\Hy@param\Hy@chapterstring
        \let\Hy@param\Hy@chapapp
    \fi
}{%
    \iftoggle{inappendix}{%true-branch
        % list the names of all sectioning counters here
        \@checkappendixparam{chapter}%
        \@checkappendixparam{section}%
        \@checkappendixparam{subsection}%
        \@checkappendixparam{subsubsection}%
        \@checkappendixparam{paragraph}%
        \@checkappendixparam{subparagraph}%
    }{}%
}{}{\errmessage{failed to patch}}

\newcommand*{\@checkappendixparam}[1]{%
    \def\@checkappendixparamtmp{#1}%
    \ifx\Hy@param\@checkappendixparamtmp
        \let\Hy@param\Hy@appendixstring
    \fi
}
\makeatletter

\newtoggle{inappendix}
\togglefalse{inappendix}

\apptocmd{\appendix}{\toggletrue{inappendix}}{}{\errmessage{failed to patch}}
% end appendix autoref patch

\numberwithin{equation}{section}
\newtheorem{assumption}{Assumption}[section]
\newtheorem{claim}{Claim}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]

\newcommand{\assumptionautorefname}{Assumption}
\newcommand{\claimautorefname}{Claim}
\newcommand{\definitionautorefname}{Definition}
\newcommand{\lemmaautorefname}{Lemma}
\newcommand{\corollaryautorefname}{Corollary}
\newcommand{\algorithmautorefname}{Algorithm}

\newcommand{\pp}{\newline}
\newcommand{\lr}[3]{\left#1#2\right#3}
\newcommand{\rb}[1]{\lr{(}{#1}{)}}
\renewcommand{\sb}[1]{\lr{[}{#1}{]}}
\newcommand{\cb}[1]{\lr{\{}{#1}{\}}}
\newcommand{\eg}{e.g.\;}
\newcommand{\wrt}{w.r.t.\;}
\newcommand{\ie}{i.e.\;}
\newcommand{\iid}{i.i.d.\;}

\newcommand{\vertices}{\cV}
\newcommand{\edges}{\cE}
\newcommand{\edgeweights}{W}
\newcommand{\graph}{\cG}
\newcommand{\unweightedgraph}{\graph = \rb{\vertices,\edges}}
\newcommand{\weightedgraph}{\graph = \rb{\vertices,\edges,\edgeweights}}
\newcommand{\adjacency}{\bm{A}}
\newcommand{\degree}{\bm{D}}
\newcommand{\laplacian}{\bm{L}}
\newcommand{\propagation}{\hat{\adjacency}}
\newcommand{\transition}{\bm{P}}
\newcommand{\mask}{\bM}
\newcommand{\passage}{\bT}
\newcommand{\commute}{\bC}
\newcommand{\resistance}{\bR}
\newcommand{\stationary}{\boldsymbol{\pi}}

\newcommand{\inline}[1]{\text{#1}}
\newcommand{\gnn}{\mathsf{GNN}}
\newcommand{\mpnn}{\mathsf{MPNN}}
\renewcommand{\message}{\mathsf{Msg}}
\newcommand{\aggregate}{\mathsf{Agg}}
\newcommand{\update}{\mathsf{Upd}}
\newcommand{\readout}{\mathsf{Out}}
\newcommand{\source}{\mathsf{src}}
\newcommand{\target}{\mathsf{tgt}}
\newcommand{\maxpool}{\mathsf{MAX}}
\newcommand{\meanpool}{\mathsf{AVG}}
\newcommand{\sumpool}{\mathsf{SUM}}
\newcommand{\rewire}{\mathsf{Rew}}
\newcommand{\removeedges}{\mathsf{rem}}
\newcommand{\addedges}{\mathsf{add}}
\newcommand{\mix}{\mathsf{mix}}
\newcommand{\volume}{\mathsf{vol}}
\newcommand{\paths}{\mathsf{Paths}}
\newcommand{\hopnbr}{\mathbb{S}}
\newcommand{\recfld}{\mathbb{B}}

\newcommand{\hidden}{H}
\newcommand{\dataset}{\cD}
\newcommand{\feature}{\bm{x}}
\newcommand{\features}{\bm{X}}
\newcommand{\nodelabels}{\bm{y}}
\newcommand{\graphlabels}{\bm{Y}}
\newcommand{\representation}{\bm{z}}
\newcommand{\representations}{\bm{Z}}
\newcommand{\weights}{\bm{W}}
\newcommand{\attention}{\bm{a}}
\newcommand{\layer}[1]{^{\rb{#1}}}
\newcommand{\sym}{\text{sym}}
\newcommand{\asym}{\text{asym}}

\newcommand{\relu}{\mathsf{ReLU}}
\newcommand{\leakyrelu}{\mathsf{LeakyReLU}}
\newcommand{\gelu}{\mathsf{GELU}}

\newcommand{\canonical}[1]{\be^{\rb{#1}}}
\newcommand{\uniform}{\cU}
\newcommand{\expectation}{\mathbb{E}}
\newcommand{\real}{\mathbb{R}}
\renewcommand{\natural}{\mathbb{N}}
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\Bernoulli}{\text{Bern}}
\newcommand{\Binomial}{\text{Binom}}
\newcommand{\indicator}{\mathbbm{1}}
\newcommand{\ones}{\mathbf{1}}
\newcommand{\zeros}{\mathbf{0}}
\newcommand{\identity}{\bm{I}}

\newcommand{\factorial}[1]{\lr{(}{#1}{)!}}
\newcommand{\inv}{^{-1}}
\newcommand{\pinv}{^\dagger}
\newcommand{\tin}{\text{in}}
\newcommand{\tout}{\text{out}}
\newcommand{\tdiag}[1]{\text{diag}\rb{#1}}
\newcommand{\trace}{\text{tr}}

\newcommand{\half}{\frac{1}{2}}
\newcommand{\True}{\textsc{True}\xspace}
\newcommand{\False}{\textsc{False}\xspace}

\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\concat}{\|}
\newcommand{\simtext}[1]{\ensuremath{\stackrel{\text{#1}}{\sim}}}

\newcommand{\transpose}{^T}
\newcommand{\innerprod}[2]{\lr{\langle}{#1, #2}{\rangle}}
\newcommand{\norm}[1]{\lr{\|}{#1}{\|}}
\renewcommand{\mod}[1]{\lr{|}{#1}{|}}