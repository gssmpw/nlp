\definecolor{mydarkblue}{RGB}{0,0,139} % This defines a dark blue color

\begin{figure*}
    \centering
\begin{tikzpicture}[
  block/.style={draw, rectangle, rounded corners, drop shadow, minimum width=2cm, minimum height=1cm, align=center},
  popblock/.style={draw, rectangle, rounded corners, line width=1.2pt, fill=mydarkblue, text=white, drop shadow={shadow xshift=0.8ex, shadow yshift=-0.8ex}, minimum width=2.2cm, minimum height=1.2cm, align=center},
  largeblock/.style={draw, rectangle, rounded corners, drop shadow, minimum width=1.5cm, minimum height=1.2cm, align=center}, % Style for a larger block
  dataset/.style={draw, cylinder, shape border rotate=90, aspect=0.25, minimum width=1.5cm, minimum height=1cm, drop shadow, align=center},
  largelabel/.style={font=\Large} % Style for large text
]

\node (x)   {$\X_i$};

\node (p) [below=of x]  {$\p$};

\node (u) [block, right=of x, yshift=-0.6cm,fill=green!45,text=black] {Physical Informed\\ Model $u(\p)$};  % Aligned with Block 1



% Larger Block 5 aligned with the start of Block 1
\node (block_backbone) [largeblock, right=of u,fill=cyan] {Likelihood\\ Backbone};  % Aligned with Block 1

% \node (block_prior) [largeblock, below=2cm of block_backbone] {Prior};  % Aligned with Block 1

\node () [block, right=of block_backbone, yshift=+0.6cm,fill=cyan] {Learned Score };  % Aligned 
\node (pin) [block, right=of block_backbone, yshift=-0.6cm,fill=cyan] {Physical Informed\\
Projection };  % Aligned with Block 1

\node (pin_matmat) [block, right=of pin,yshift=-0.6cm,fill=green!45,text=black] {Apply $\frac{\partial u (\p)}{\partial \p}$ };  % Aligned with Block 1

\node(Add) [circle,draw, above=of pin_matmat] {$+$}; 

\begin{pgfonlayer}{background}
         \node[draw,rounded corners,fit=(u) (pin) (pin_matmat) (Add),fill=black!20,inner sep=5pt,label={Physically Informed Liklihood Score}](fit1){};
         % \node[draw,rounded corners,fit=(bf),fill=yellow!30,inner sep=5pt,label={Generator}](fit2){};
         % \node[draw,rounded corners,fit=(score) (fim),fill=red!30,inner sep=5pt,label={Compute eGCRB}](fit3){};
         % \node[draw,rounded corners,fit=(trimming),fill=blue!30,inner sep=5pt,label={Trimming \\ (Optional)}](fit4){};
        \end{pgfonlayer}
\end{tikzpicture}

    \caption{Physical Informed Bayesian Score}
    \label{fig:main}
\end{figure*}