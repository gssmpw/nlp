    \begin{algorithm}[t]
    \footnotesize
        \caption{Width Estimation}
        \label{algo:width_estimation}
    \begin{algorithmic}[1]
    \State \textbf{Inputs:} Transformer-predicted $g_{m}^p$, $g_{ds}^p$, $C_{ds}^p$, $C_{gs}^p$ and current $I_d^{in}$ for a MOSFET; LUT for the device type (PMOS/NMOS); 
    % reference width, $W_{ref}$, used for recording the LUT; 
    tolerances $\alpha$ and $\epsilon$ 
    \State \textbf{Outputs:} Optimal width, $W$, of the MOSFET
    % DC operating points and width of the MOSFET, namely $V_{gs}^*$, $V_{ds}^*$ and $W^*$
    \State $V_{ds,curr} \gets V_{dd}/2$ , $cost_{curr} \gets \infty$, $\Delta \gets \infty$  \label{algo2:init}
    
    \State $g_m\_I_d  \gets g_{m}^p/I_d$ \textit{// Compute the $g_m\_I_d$ operating point}
    
    \While{$|\Delta| > \epsilon$} \textit{// until current cost $\approx$ previous cost}
        \State mincost$_{prev} \gets$ mincost$_{curr}$, $V_{ds,prev} \gets V_{ds,curr}$ \label{algo2:while_begin}
        % \Statex \hspace{1.3em} \textit{// Getting $V_{gs}$ from the LUT}
        \State Find LUT entry $[I_d \;\; g_m \;\; g_{ds} \;\; C_{ds} \;\; C_{gs}] = f(V_{gs}, V_{ds})$ \label{algo2:gmId}
        \Statex \hspace*{10mm} at which $g_m/I_d = g_m\_I_d$. Report $V_{gs}^p$ for this entry.

        \State At $V_{gs}^p$, the LUT for $[I_d \;\; g_m \;\; g_{ds} \;\; C_{ds} \;\; C_{gs}]$ is $f(V_{ds})$.
        \State \textit{// Find $w_1 \cdots w_5$ as functions of $V_{ds}$}
        \State $w_1$$\gets$$g_{m}^p/g_m$, $w_2$$\gets$$g_{ds}^p/g_{ds}$, $w_3$$\gets$$C_{ds}^p/c_{ds}$, 
        \Statex \hspace*{10mm} $w_4$$\gets$$C_{gs}^p/c_{gs}$, $w_5$$\gets$$I_d^{in}/I_d$
        

        \Statex \hspace{1.3em} \textit{// Find $V_{ds}$ at which $w_i$s are closest}
        \State cost$(V_{ds}) \gets \sum_{n=1}^{3} \sum_{m=n+1}^{4} |w_n - w_m|$   \label{algo2:wcalc_begin}
        \State mincost$_{curr} = \min_{V_{ds}}$ (cost)
        \State $\Delta \gets$ mincost$_{prev}$ $-$ mincost$_{curr}$ \label{algo2:wcalc_end}
        \Statex \hspace{1.3em} \textit{// Updating the initial guess $V_{ds}$ value}
        \State $V_{ds,curr} \gets V_{ds,curr} + \mbox{sgn}(\Delta).\alpha.V_{ds, prev}$ \label{algo2:while_end}
        
        % \State $g_m = f(V_{gs}) \gets \text{lookup}\_g_{m}(V_{ds,curr},L) $
        % \State $I_d = f(V_{gs}) \gets \text{lookup}\_I_{d}(V_{ds,curr},L) $
        % \State $V_{gs} \gets$ \text{get\ $V_{gs}$ where $g_{m}/I_{d}$ == $g_m\_I_d$} \redHL{Find Vgs corresponding to gm\_Id; lines 9 and 10 provide the function, line 5 provides the value to be looked up}
        % \Statex \hspace{1.3em} \textit{// Reading the four parameters as a function of $V_{ds}$}
        % \State $I_d,g_m,g_{ds},C_{ds} =\ f(V_{ds})\ \gets\ \text{lookup}(V_{gs},L)$   
        
        % \Statex \hspace{1.3em} \textit{// Normalizing the parameters with $W_{ref}$}
        % \State $I_d\_w,\ g_m\_w,\ g_{ds}\_w, c_{ds}\_w\gets f(V_{ds})/W_{ref}$
        % \Statex \hspace{1.3em} \textit{// Width calculation using the normalized functions}
        % \Statex \hspace{1.3em} \textit{// Each width is a function of $V_{ds}$}
        % \State $w_1 \gets g_{m}^p/g_m\_w$
        % \State $w_2 \gets g_{ds}^p/g_{ds}\_w$
        % \State $w_3 \gets C_{ds}^p/c_{ds}\_w$
        % \State $w_4 \gets I_d/I_d\_w$

        % \Statex \hspace{1.3em} \textit{// Determining cost function from the widths}
        % \State $cost\_func \redHL{(Vds)} \gets \sum_{n=1}^{3} \sum_{m=n+1}^{4} |w_n - w_m|$   
        % \State $min\_cost_{curr} = min_{\redHL{all Vds}} (cost\_func)$
        % \State $\Delta \gets min\_cost_{prev}-min\_cost_{curr}$
        % \Statex \hspace{1.3em} \textit{// Updating the initial guess $V_{ds}$ value}
        % \State $V_{ds,curr} \gets V_{ds,curr} + sgn(\Delta).\alpha.V_{ds, prev}$
    \EndWhile
    
    % \State $V_{ds}^* \gets \arg\min(cost\_func)$
    \State $W \gets\ w_1(V_{ds})$
    % \State $V_{gs}^* \gets V_{gs}$    

    \end{algorithmic}
    \end{algorithm}

