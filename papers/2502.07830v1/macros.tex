% include in main: \input{macros}

\usepackage{xparse}
\usepackage{xspace}
%\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
%\usepackage{algorithm}% http://ctan.org/pkg/algorithm
%\usepackage{algpseudocode}% http://ctan.org/pkg/algorithmicx
\usepackage{fixltx2e}
% \usepackage{amsmath}
\usepackage{tikz}
\usepackage{float}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{colortbl}
\usepackage{array}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{float}
\usepackage{subcaption}
\usepackage{booktabs} % for professional tables
\usepackage[shortlabels]{enumitem}

\usepackage{amssymb}% http://ctan.org/pkg/amssymb
\usepackage{pifont}% http://ctan.org/pkg/pifont

\usepackage{bbold}

\usepackage{hyperref,amssymb,enumitem}

% Attempt to make hyperref and algorithmic work together better:
% \newcommand{\theHalgorithm}{\arabic{algorithm}}

\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Symbols
\newcommand{\numneighbors}{k}
\newcommand{\test}{\tilde{\bm{x}}}
\newcommand{\Test}{\tilde{\bm{X}}}
\newcommand{\layer}{\lambda}
\newcommand{\numlayer}{L}
\newcommand{\class}{y}
\newcommand{\numclass}{C}
\newcommand{\dist}{\mu}
\newcommand{\bdist}{\bm{\mu}}
\newcommand{\vw}{\mathbf{w}}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{53}}%
\newcommand{\E}[1]{\operatorname{\mathbb{E}}[#1]}
\renewcommand{\P}[1]{\operatorname{\mathbb{P}}[#1]}
\newcommand*{\rej}{{\ooalign{\lower.3ex\hbox{$\sqcup$}\cr\raise.4ex\hbox{$\sqcap$}}}}

\newenvironment{proof}{\emph{Proof:}}{\hfill$\square$}

%%%%%%%%%%%%%%%%%%%%%%%%
% \makeatletter
% \def\underbar#1{\underline{\sbox\tw@{$#1$}\dp\tw@\z@\box\tw@}}
% \makeatother
% \renewcommand{\underbar}[1]{\text{\b{$#1$}}}
\usepackage{stackengine}
\renewcommand\underbar[1]{\stackunder[1pt]{$\operatorname{#1}$}{\rule{1.1ex}{.05ex}}}
\usepackage{xcolor}
\newcommand{\ind}[1]{\mathbb{1}_{\left[#1\right]}}

% \usepackage{accents}
% \newcommand\munderbar[1]{%
%   \underaccent{\bar}{#1}}

%\floatname{algorithm}{Procedure}
\renewcommand{\algorithmicrequire}{\textbf{Input: }}
\renewcommand{\algorithmicensure}{\textbf{Output: }}

\newcommand{\ie}{\textit{i.e.,}\@\xspace}
\newcommand{\eg}{\textit{e.g.,}\@\xspace}
\newcommand{\etal}{\textit{et al.}\@\xspace}
\newcommand{\capc}{CaPC\@\xspace}

% Secure Multi-party Computation
\newcommand{\smc}{MPC\xspace}
\newcommand{\single}{single-label\xspace}
\newcommand{\multi}{multi-label\xspace}
\newcommand{\softmax}{softmax\xspace}

\DeclareRobustCommand\encircle[1]{\tikz[baseline=(char.base)]{\node[shape=circle,fill,inner sep=1pt] (char) {\textcolor{white}{#1}}}}

%\DeclarePairedDelimiterX{\norm}[1]{\lVert}{\rVert}{#1}
   
% \usepackage[backend=biber,style=numeric,citestyle=numeric,sorting=none]{biblatex}
\DeclareMathOperator*{\Argmin}{argmin}
\DeclareMathOperator*{\Argmax}{argmax}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{repeatedtheorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}

\graphicspath{{images/}}

\newcommand\classratesize{0.8}

% \@ before punctuation says that the period does fall at the end of a sentence. 
% https://tex.stackexchange.com/questions/22561/what-is-the-proper-use-of-i-e-backslash-at
\newcommand{\dknn}{DkNN\@\xspace}
\newcommand{\pdknn}{$p$-DkNN\@\xspace}
\newcommand{\pvalue}{$p$-value\@\xspace}
\newcommand{\pvalues}{$p$-values\@\xspace}

\newcommand{\mnist}{MNIST\@\xspace}
\newcommand{\fashion}{FashionMNIST\@\xspace}
\newcommand{\cifarX}{CIFAR10\@\xspace}
\newcommand{\cifarC}{CIFAR100\@\xspace}
\newcommand{\rebel}{ReBeL\@\xspace}

% shortcuts for the main papers

\newcommand{\ours}{CLIPMem\@\xspace}
\newcommand{\ftxt}{f_{\text{txt}}}
\newcommand{\fimg}{f_{\text{img}}}


\newcommand{\mycolspace}{4pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% dashed line latex
%https://tex.stackexchange.com/questions/319198/why-is-it-so-difficult-to-generate-a-midrule-dashed-in-latex
\usepackage{booktabs,arydshln}
\makeatletter
\def\adl@drawiv#1#2#3{%
        \hskip.5\tabcolsep
        \xleaders#3{#2.5\@tempdimb #1{1}#2.5\@tempdimb}%
                #2\z@ plus1fil minus1fil\relax
        \hskip.5\tabcolsep}
\newcommand{\cdashlinelr}[1]{%
  \noalign{\vskip\aboverulesep
           \global\let\@dashdrawstore\adl@draw
           \global\let\adl@draw\adl@drawiv}
  \cdashline{#1}
  \noalign{\global\let\adl@draw\@dashdrawstore
           \vskip\belowrulesep}}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Clever referencing
%\usepackage{amsthm} % if you prefer, use "ntheorem" instead of "amsthm"
\usepackage{cleveref}
%\newtheorem{theorem}{Theorem}[Theorem]
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{prop}[theorem]{Proposition}
\crefalias{prop}{proposition} % <-- new

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\nlp}[1]{\textcolor{purple}{#1}}
\newcommand{\nlp}[1]{}
%\newcommand{\nlp}[1]{\textcolor{black}{#1}}
%\newcommand{\ie}{\textit{i.e.},\xspace}
\newcommand{\prob}{log-likelihood\xspace}
\newcommand{\probs}{log-likelihoods\xspace}

%centered column with width for tables
\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}
%\newcommand{\new}[1]{\textcolor{blue}{#1}}
\newcommand{\new}[1]{\textcolor{black}{#1}}

% COMMENTS
%\ifdraft
%\usepackage{todonotes}
\usepackage[textsize=tiny]{todonotes}
\newcommand\adam[1]{{\textcolor{blue}{[Adam: #1]}}}
\newcommand\franzi[1]{{\textcolor{red}{[Franzi: #1]}}}
\newcommand\wenhao[1]{{\textcolor{olive}{[Wenhao: #1]}}}
\newcommand\grace[1]{{\textcolor{green}{[Grace: #1]}}}

% \newcommand{\ahmad}[1]{\textcolor{darkpastelgreen}{[Ahmad: #1]}}
% \newcommand{\vinith}[1]{\textcolor{blue}{Vinith: #1}}
% \newcommand{\yunxiang}[1]{\textcolor{cyan}{Yunxiang: #1}}
% \newcommand{\xiao}[1]{\textcolor{blue}{xiao: #1}}
% \definecolor{chocolate(traditional)}{rgb}{0.48, 0.25, 0.0}
% \newcommand{\ali}[1]{\textcolor{chocolate(traditional)}{Ali: #1}}
% \definecolor{darkpastelgreen}{rgb}{0.01, 0.75, 0.24}
% \newcommand{\natalie}[1]{\textcolor{darkpastelgreen}{natalie: #1}}
% \definecolor{pistachio}{rgb}{0.58, 0.77, 0.45}
% \newcommand\lucy[1]{{\color{pistachio} [Lucy: #1]}}
% \newcommand{\jonas}[1]{\textcolor{violet}{[Jonas: #1]}}
% \newcommand{\my}[1]{\textcolor{teal}{[Mohammad: #1]}}
% \newcommand{\adelin}[1]{\textcolor{red}{[Adelin: #1]}}
% \newcommand{\mohammad}[1]{\textcolor{red}{[Mohammad: #1]}}
% \newcommand{\nick}[1]{\textcolor{brown}{[Nick: #1]}}
% \newcommand{\haonan}[1]{\textcolor{orange}{[Haonan: #1]}}
% \newcommand{\ilia}[1]{\textcolor{green}{[Ilia: #1]}}
% \definecolor{amber(sae/ece)}{rgb}{1.0, 0.49, 0.0}
% %\newcommand\adam[1]{{\color{amber(sae/ece)} [Adam: #1]}}
% \newcommand\adam[1]{{\textcolor{red}{[Adam: #1]}}}

\newcommand{\aug}{\text{Aug}}

\newcommand{\Aug}{\text{Aug}}

\newcommand{\lalign}{\mathcal{L}_{\text{align}}}
\newcommand{\Halign}{\mathcal{H}_{\text{align}}}

\newcommand{\alignexp}[2]%
{\underset{ {#2}', {#2}'' \sim \Aug(x) }{\mathbb{E}} [ d\left({#1}({#2}'), {#1}({#2}'')\right) ] }