\subsection{Efficient Computing $\Esim$}

\begin{algorithm}[htbp]
\caption{{\textsc{ConstructApproximateEsim}}$(G^+=(V, E^+), \phi)$\label{alg:main}\\
\textbf{Input}: A graph $G^{+}$ and a parameter $\phi$. \\
\textbf{Output}: A clustering $\mathcal{F} = \{L_i\}_{i=1}^{|\mathcal{L}|}$ of $\Vhigh$ such that $\mathcal{F} = \mathcal{L}$. }
%, where $x_{uv}$ is the positive edge value and $z_e$ is the negative edge value. 
%\\
%\textbf{Auxiliary Information}: $E^-:={\binom{V}{2}}\setminus E^+$;. 
%$c = \exp(\epsilon)$, where $e$ is the Euler's number.
\label{alg:constructesim}
\begin{algorithmic}[1]
\Function {\textsc{ConstructApproximateEsim}}{$G^+=(V, E^+), \phi$}
    \State $\Esim \leftarrow \{ \}$
    \For{$i \in [\log \big(\phi \epsilon^2 \big ), \log n]$}
    \State Sample each node from $V$ with probability $\min(\frac{\log n}{2^i}, 1)$, let the sampled set be $S(i)$
    \EndFor
    \For{$uv \in E^+$ such that $|d(u) - d(v)| \leq 2\phi$}
        \State Let $j \leftarrow \lceil \log \max(d(u), d(v)) + \log \epsilon \rceil$
        \If{$\max(d(u), d(v)) \leq \phi$}
            \State $\Esim \leftarrow \Esim \cup \{ uv \}$
        \ElsIf{$\max(d(u), d(v)) \leq 10\phi$ and $|S(u,  \log  \big(\phi \epsilon^2 \big )) \Delta S(v, \log  \big(\phi \epsilon^2 \big ))| \leq 2 (1 + \epsilon) \phi$}
        \State $\Esim \leftarrow \Esim \cup \{ uv \}$
        \ElsIf{$|S(u, j) \Delta S(v, j)| \leq 4\phi$}
        \State $\Esim \leftarrow \Esim \cup \{ uv \}$
        \EndIf
    \EndFor
    \Return $\Gsim = (V, \Esim)$
\EndFunction
\end{algorithmic}
\end{algorithm}

\begin{lemma}
Suppose that $\OPT \leq \phi$. \Cref{alg:constructesim} outputs a clustering $\mathcal{F}$ such that $\mathcal{F} = \mathcal{L}$.
\end{lemma}