\begin{algorithm}[H] % hbtp
\caption{A Fixed-capacity Arena Allocator (FAA).}
\label{alg:faa}
\begin{algorithmic}[1]
\Require{$\textsc{alloc\_size}_a$: Size of each allocation (constant)}
\Require{$\textsc{pool\_size}_a$: Size of the memory block/pool (constant)}
\Require{$pool_a$: A memory block for the pool}

\Statex

\State \textbf{struct} $FAA \langle \textsc{alloc\_size}_a, \textsc{pool\_size}_a \rangle (pool_a)$
\State \ \ $\textsc{alloc\_size} \gets \textsc{alloc\_size}_a$ \Comment{Size of each allocation} \label{alg:faa--init-const-begin}
\State \ \ $\textsc{pool\_size} \gets \textsc{pool\_size}_a$ \Comment{Size of the memory pool} \label{alg:faa--init-const-end}
\State \ \ $freed \gets \{\}$ \Comment{Freed allocations, can be reused} \label{alg:faa--init-begin}
\State \ \ $used \gets 0$ \Comment{Bytes used in the memory pool}
\State \ \ $pool \gets pool_a$ \Comment{The memory pool} \label{alg:faa--init-end}

\Statex

\State $\rhd$ Allocate memory, of size $A.\textsc{alloc\_size}$
\Function{allocate}{$ $} \textbf{of} FAA
  \State $\rhd$ Allocate from freed list, if available
  \If{$freed \neq \{\}$} \ReturnInline{$freed.pop()$} \label{alg:faa--allocate-freed}
  \EndIf
  \State $\rhd$ Allocate from pool
  \If{$used < \textsc{pool\_size}$} \label{alg:faa--allocate-pool-begin}
    \State $ptr \gets pool + used$
    \State $used \gets used + \textsc{alloc\_size}$
    \Return{$ptr$}
  \EndIf \label{alg:faa--allocate-pool-end}
  \Return{$\phi$} \label{alg:faa--allocate-phi}
\EndFunction

\Statex

\State $\rhd$ Free allocated memory
\Function{deallocate}{$ptr$} \textbf{of} FAA
  \State $freed.push(ptr)$ \label{alg:faa--deallocate-push}
\EndFunction

\Statex

\State $\rhd$ Free all allocated memory
\Function{reset}{$ $} \textbf{of} FAA
  \State $freed \gets \{\}$ \label{alg:faa--reset-begin}
  \State $used \gets 0$ \label{alg:faa--reset-end}
\EndFunction
\end{algorithmic}
\end{algorithm}
