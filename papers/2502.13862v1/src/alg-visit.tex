\begin{algorithm}[hbtp]
\caption{Perform reverse walk from each vertex.}
\label{alg:visit}
\begin{algorithmic}[1]
\Require{$G(V, E)$: Input graph}
\Ensure{$steps$: Number of reverse walks to perform}

\Statex

\Function{reverseWalk}{$G, steps$}
  \State $visits0 \gets \{1\}$ \label{alg:visit--init-begin}
  \State $visits1 \gets \{0\}$ \label{alg:visit--init-end}
  \ForAll{$i \in [0, steps)$} \label{alg:visit--steps-begin}
    \ForAll{$u \in V$ \textbf{in parallel}}
      \State $visits1[u] \gets 0$ \label{alg:visit--reset}
      \ForAll{$(v, \_) \in G.edges(u)$} \label{alg:visit--edges-begin}
        \State $visits[u] \gets visits[u] + visits0[v]$
      \EndFor \label{alg:visit--edges-end}
    \EndFor
    \State $swap(visits0, visits1)$ \label{alg:visit--swap}
  \EndFor \label{alg:visit--steps-end}
  \Return{$visits0$}
\EndFunction
\end{algorithmic}
\end{algorithm}
