\begin{algorithm}[hbtp]
\caption{Add a graph's edges to another graph.}
\label{alg:add}
\begin{algorithmic}[1]
\Require{$G(V, E)$: Input graph to add to}
\Require{$G_A(V_A, E_A)$: Graph containing the edges to add}
\Require{$G'(V', E')$: Output graph, with edges from $G_A$ added}
\Ensure{$\Delta N$: Number of vertices added from $G_A$}
\Ensure{$\Delta M$: Number of edges inserted from $G_A$}

\Statex

\Function{addGraphInplace}{$G, G_A$}
  \State $\Delta N \gets \Delta M \gets 0$ \label{alg:add--inplace-init}
  \State $\rhd$ Reserve space for vertices
  \State $G.reserve(maxVertexId(G, G_A) + 1)$ \label{alg:add--inplace-reserve}
  \State $\rhd$ Add new vertices
  \ForAll{$u \in G_A$ \textbf{in parallel}} \label{alg:add--inplace-add-vertices-begin}
    \If{$G.hasVertex(u)$} \textbf{continue}
    \EndIf
    \State $G.addVertex(u)$ \textbf{;} $\Delta N \gets \Delta N + 1$
  \EndFor \label{alg:add--inplace-add-vertices-end}
  \State $\rhd$ Add the edges in-place
  \ForAll{$u \in V$ \textbf{in parallel}} \label{alg:add--inplace-add-edges-begin}
    \State $\Delta M \gets \Delta M + G.addEdges(u, G_A.edges(u))$
  \EndFor \label{alg:add--inplace-add-edges-end}
  \State $\rhd$ Update the vertex and edge count
  \State $|V| \gets |V| + \Delta N$ \textbf{;} $|E| \gets |E| + \Delta M$ \label{alg:add--inplace-update}
  \Return{$G$} \label{alg:add--inplace-return}
\EndFunction

\Statex

\Function{addGraph}{$G, G_A$}
  \State $G' \gets \{\}$ \textbf{;} $\Delta N \gets \Delta M \gets 0$ \label{alg:add--init}
  \State $\rhd$ Reserve space for vertices
  \State $G'.reserve(maxVertexId(G, G_A) + 1)$ \label{alg:add--reserve}
  \State $\rhd$ Add vertices
  \ForAll{$u \in [0, maxVertexId(G, G_A)]$ \textbf{in parallel}} \label{alg:add--add-vertices-begin}
    \If{$G.hasVertex(u)$}
      \State $G'.addVertex(u)$
    \ElsIf{$G_A.hasVertex(u)$}
      \State $G'.addVertex(u)$ \textbf{;} $\Delta N \gets \Delta N + 1$
    \EndIf
  \EndFor \label{alg:add--add-vertices-end}
  \State $\rhd$ Reserve space for edges
  \ForAll{$u \in V'$ \textbf{in parallel}} \label{alg:add--reserve-edges-begin}
    \State $G'.allocateEdges(u, G.degree(u) + G_A.degree(u))$
  \EndFor \label{alg:add--reserve-edges-end}
  \State $\rhd$ Add edges of vertices that are untouched
  \ForAll{$u \in V'$ \textbf{in parallel}} \label{alg:add--add-edges-untouched-begin}
    \If{$G_A.hasVertex(u)$} \textbf{continue}
    \EndIf
    \State $G'.edges(u) \gets G.edges(u)$
    \State $G'.degree(u) \gets G.degree(u)$
  \EndFor \label{alg:add--add-edges-untouched-end}
  \State $\rhd$ Add edges of vertices that are touched
  \ForAll{$u \in V'$ \textbf{in parallel}} \label{alg:add--add-edges-touched-begin}
    \If{\textbf{not} $G.hasVertex(u)$} \textbf{continue}
    \EndIf
    \State $G'.edges(u) \gets G.edges(u) \cup G_A.edges(u)$
    \State $G'.degree(u) \gets |G'.edges(u)|$
    \State $\Delta M \gets \Delta M + |G'.edges(u)| - |G.edges(u)|$
  \EndFor \label{alg:add--add-edges-touched-end}
  \State $\rhd$ Update the vertex and edge count
  \State $|V'| \gets |V| + \Delta N$ \textbf{;} $|E'| \gets |E| + \Delta M$ \label{alg:add--update}
  \Return{$G'$} \label{alg:add--return}
\EndFunction
\end{algorithmic}
\end{algorithm}
