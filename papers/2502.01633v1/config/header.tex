\newcommand{\HH}[1]{\noindent{\textcolor{blue}{\textbf{\#\# HH:} #1 \#\#}}}
\newcommand{\AK}[1]{\noindent{\textcolor{pink}{\textbf{\#\# AK:} #1 \#\#}}}
\newcommand{\MS}[1]{\noindent{\textcolor{orange}{\textbf{\#\# MS:} #1 \#\#}}}
\newcommand{\PK}[1]{\noindent{\textcolor{teal}{\textbf{\#\# PK:} #1 \#\#}}}

\interfootnotelinepenalty=10000

\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;} 

\newtheoremstyle{slplain}% name
  {.4\baselineskip\@plus.1\baselineskip\@minus.1\baselineskip}% Space above
  {.3\baselineskip\@plus.1\baselineskip\@minus.1\baselineskip}% Space below
  {\itshape}% Body font
  {}%Indent amount (empty = no indent, \parindent = para indent)
  {\bfseries}%  Thm head font
  {.}%       Punctuation after thm head
  { }%      Space after thm head: " " = normal interword space;
        %       \newline = linebreak
  {}%       Thm head spec
\theoremstyle{slplain} % italics

\newcommand{\Eall}{\mathcal{E}_\text{all}}
\newcommand{\Etr}{\mathcal{E}_\text{tr}}
\newcommand{\Ete}{\mathcal{E}_\text{te}}

\newtheorem*{definition*}{Definition}
\newtheorem*{theorem*}{Theorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{unumproposition}{Proposition}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{fact}[theorem]{Fact}
\newenvironment{lyxgreyedout}
  {\textcolor{note_fontcolor}\bgroup\ignorespaces}
  {\ignorespacesafterend\egroup}

\makeatletter
\newtheorem*{rep@theorem}{\rep@title}
\newcommand{\newreptheorem}[2]{%
\newenvironment{rep#1}[1]{%
 \def\rep@title{#2 \ref{##1}}%
 \begin{rep@theorem}}%
 {\end{rep@theorem}}}
\makeatother

\newreptheorem{theorem}{Theorem}
\newreptheorem{lemma}{Lemma}
\newreptheorem{claim}{Claim}
\newreptheorem{corollary}{Corollary}
\newreptheorem{proposition}{Proposition}

\theoremstyle{definition}
\newtheorem{construction}[theorem]{Construction}
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{problem}[theorem]{Problem}

\theoremstyle{plain} % choose from plain/definition/remark
\newtheorem*{note}{Note}
\newtheorem{case}{Case}

\numberwithin{equation}{section}

% \newtheoremstyle{etplain}% name
%   {.0\baselineskip\@plus.1\baselineskip\@minus.1\baselineskip}% Space above
%   {.0\baselineskip\@plus.1\baselineskip\@minus.1\baselineskip}% Space below
%   {\itshape}% Body font
%   {}%Indent amount (empty = no indent, \parindent = para indent)
%   {\bfseries}%  Thm head font
%   {.}%       Punctuation after thm head
%   { }%      Space after thm head: " " = normal interword space;
%         %       \newline = linebreak
%   {}%       Thm head spec

\newcommand\sgn[1]{\textnormal{sgn}\left(#1\right)}
\newcommand\loss{L}
\newcommand\hood{\mathcal{S}}
\newcommand{\adv}{\ensuremath{\text{adv}}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand\AND{
    \end{tabular}\hfil\linebreak[4]\hfil%
    \begin{tabular}[t]{c}\ignorespaces%
}
\newcommand{\norm}[1]{\left|\left| #1 \right|\right|}
\newcommand{\Prob}{\mathbb{P}}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\var}{Var}
\DeclareMathOperator{\dkl}{D_{KL}}
\DeclareMathOperator{\one}{\mathbbm{1}}
\newcommand{\qedwhite}{\hfill \ensuremath{\Box}}

\newcommand{\bv}[1]{\mathbf{#1}}
\newcommand\mc[1]{\mathcal{#1}}
\renewcommand\bar\overline
\DeclareMathOperator{\Tr}{tr}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\minimize}{minimize \quad}
\DeclareMathOperator*{\maximize}{maximize \quad}
\DeclareMathOperator*{\st}{subject\,\, to \quad}

\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\renewcommand\cellgape{\Gape[4pt]}

% -- Colored text --
\newcommand{\blue}[1]{{\color{blue}#1}}
\newcommand{\red}[1]{{\color{red}#1}}
%\newcommand{\blue}[1]{#1}
%\newcommand{\red}[1]{#1}

% -- General --
%\let\Pr\relax
%\DeclareMathOperator{\Pr}{\mathbb{P}}

\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\kernel}{Ker}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\blkdiag}{blkdiag}
\DeclareMathOperator{\rank}{rank}
\newcommand{\kron}{\ensuremath{\otimes}}
\DeclareMathOperator{\lmin}{\lambda_\textup{min}}
\DeclareMathOperator{\lmax}{\lambda_\textup{max}}
\DeclareMathOperator{\smin}{\sigma_\textup{min}}
\DeclareMathOperator{\smax}{\sigma_\textup{max}}
\newcommand{\vect}[2]{\ensuremath{[\begin{array}{#1} #2 \end{array}]}}
\newcommand{\abs}[1]{\ensuremath{{\left\vert #1 \right\vert}}}

\let\Re\relax
\DeclareMathOperator{\Re}{\mathbb{R}e}
\let\Im\relax
\DeclareMathOperator{\Im}{\mathbb{I}m}

\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\sinc}{sinc}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\indicator}{\mathbb{I}}
\newcommand{\ceil}[1]{\left \lceil #1 \right \rceil}
\newcommand{\floor}[1]{\left \lfloor #1 \right \rfloor}

\DeclareMathOperator{\indeg}{deg_{in}}
\DeclareMathOperator{\outdeg}{deg_{out}}
\DeclareMathOperator{\degbar}{\overline{deg}}

\DeclareMathOperator{\subjectto}{subject\ to}
\DeclareMathOperator{\proj}{\raisebox{-.15\baselineskip}{\Large\ensuremath{\Pi}}}



% -- Calligraphic --
\newcommand{\calA}{\ensuremath{\mathcal{A}}}
\newcommand{\calB}{\ensuremath{\mathcal{B}}}
\newcommand{\calC}{\ensuremath{\mathcal{C}}}
\newcommand{\calD}{\ensuremath{\mathcal{D}}}
\newcommand{\calE}{\ensuremath{\mathcal{E}}}
\newcommand{\calF}{\ensuremath{\mathcal{F}}}
\newcommand{\calG}{\ensuremath{\mathcal{G}}}
\newcommand{\calH}{\ensuremath{\mathcal{H}}}
\newcommand{\calI}{\ensuremath{\mathcal{I}}}
\newcommand{\calJ}{\ensuremath{\mathcal{J}}}
\newcommand{\calK}{\ensuremath{\mathcal{K}}}
\newcommand{\calL}{\ensuremath{\mathcal{L}}}
\newcommand{\calM}{\ensuremath{\mathcal{M}}}
\newcommand{\calN}{\ensuremath{\mathcal{N}}}
\newcommand{\calO}{\ensuremath{\mathcal{O}}}
\newcommand{\calP}{\ensuremath{\mathcal{P}}}
\newcommand{\calQ}{\ensuremath{\mathcal{Q}}}
\newcommand{\calR}{\ensuremath{\mathcal{R}}}
\newcommand{\calS}{\ensuremath{\mathcal{S}}}
\newcommand{\calT}{\ensuremath{\mathcal{T}}}
\newcommand{\calU}{\ensuremath{\mathcal{U}}}
\newcommand{\calV}{\ensuremath{\mathcal{V}}}
\newcommand{\calW}{\ensuremath{\mathcal{W}}}
\newcommand{\calX}{\ensuremath{\mathcal{X}}}
\newcommand{\calY}{\ensuremath{\mathcal{Y}}}
\newcommand{\calZ}{\ensuremath{\mathcal{Z}}}

\newcommand{\calVbar}{\ensuremath{\overline{\calV}}}


% -- Boldface --
\newcommand{\bzero}{\ensuremath{\bm{0}}}
\newcommand{\bA}{\ensuremath{\bm{A}}}
\newcommand{\bB}{\ensuremath{\bm{B}}}
\newcommand{\bC}{\ensuremath{\bm{C}}}
\newcommand{\bD}{\ensuremath{\bm{D}}}
\newcommand{\bE}{\ensuremath{\bm{E}}}
\newcommand{\bF}{\ensuremath{\bm{F}}}
\newcommand{\bG}{\ensuremath{\bm{G}}}
\newcommand{\bH}{\ensuremath{\bm{H}}}
\newcommand{\bI}{\ensuremath{\bm{I}}}
\newcommand{\bJ}{\ensuremath{\bm{J}}}
\newcommand{\bK}{\ensuremath{\bm{K}}}
\newcommand{\bL}{\ensuremath{\bm{L}}}
\newcommand{\bM}{\ensuremath{\bm{M}}}
\newcommand{\bN}{\ensuremath{\bm{N}}}
\newcommand{\bO}{\ensuremath{\bm{O}}}
\newcommand{\bP}{\ensuremath{\bm{P}}}
\newcommand{\bQ}{\ensuremath{\bm{Q}}}
\newcommand{\bR}{\ensuremath{\bm{R}}}
\newcommand{\bS}{\ensuremath{\bm{S}}}
\newcommand{\bT}{\ensuremath{\bm{T}}}
\newcommand{\bU}{\ensuremath{\bm{U}}}
\newcommand{\bV}{\ensuremath{\bm{V}}}
\newcommand{\bW}{\ensuremath{\bm{W}}}
\newcommand{\bX}{\ensuremath{\bm{X}}}
\newcommand{\bY}{\ensuremath{\bm{Y}}}
\newcommand{\bZ}{\ensuremath{\bm{Z}}}

\newcommand{\bGamma}{\ensuremath{\bm{\Gamma}}}
\newcommand{\bDelta}{\ensuremath{\bm{\Delta}}}
\newcommand{\bLambda}{\ensuremath{\bm{\Lambda}}}
\newcommand{\bPi}{\ensuremath{\bm{\Pi}}}
\newcommand{\bPhi}{\ensuremath{\bm{\Phi}}}
\newcommand{\bPsi}{\ensuremath{\bm{\Psi}}}
\newcommand{\bXi}{\ensuremath{\bm{\Xi}}}
\newcommand{\bSigma}{\ensuremath{\bm{\Sigma}}}
\newcommand{\bTheta}{\ensuremath{\bm{\Theta}}}
\newcommand{\bOmega}{\ensuremath{\bm{\Omega}}}


\newcommand{\bfa}{\ensuremath{\mathbf{a}}}
\newcommand{\bfb}{\ensuremath{\mathbf{b}}}
\newcommand{\bfc}{\ensuremath{\mathbf{c}}}
\newcommand{\bfd}{\ensuremath{\mathbf{d}}}
\newcommand{\bfe}{\ensuremath{\mathbf{e}}}
\newcommand{\bfbf}{\ensuremath{\mathbf{f}}}
\newcommand{\bfg}{\ensuremath{\mathbf{g}}}
\newcommand{\bfh}{\ensuremath{\mathbf{h}}}
\newcommand{\bfi}{\ensuremath{\mathbf{i}}}
\newcommand{\bfj}{\ensuremath{\mathbf{j}}}
\newcommand{\bfk}{\ensuremath{\mathbf{k}}}
\newcommand{\bfl}{\ensuremath{\mathbf{l}}}
\newcommand{\bfm}{\ensuremath{\mathbf{m}}}
\newcommand{\bfn}{\ensuremath{\mathbf{n}}}
\newcommand{\bfo}{\ensuremath{\mathbf{o}}}
\newcommand{\bfp}{\ensuremath{\mathbf{p}}}
\newcommand{\bfq}{\ensuremath{\mathbf{q}}}
\newcommand{\bfr}{\ensuremath{\mathbf{r}}}
\newcommand{\bfs}{\ensuremath{\mathbf{s}}}
\newcommand{\bft}{\ensuremath{\mathbf{t}}}
\newcommand{\bfu}{\ensuremath{\mathbf{u}}}
\newcommand{\bfv}{\ensuremath{\mathbf{v}}}
\newcommand{\bfw}{\ensuremath{\mathbf{w}}}
\newcommand{\bfx}{\ensuremath{\mathbf{x}}}
\newcommand{\bfy}{\ensuremath{\mathbf{y}}}
\newcommand{\bfz}{\ensuremath{\mathbf{z}}}


\newcommand{\ba}{\ensuremath{\bm{a}}}
\newcommand{\bb}{\ensuremath{\bm{b}}}
\newcommand{\bc}{\ensuremath{\bm{c}}}
\newcommand{\bd}{\ensuremath{\bm{d}}}
\newcommand{\be}{\ensuremath{\bm{e}}}
\newcommand{\bbf}{\ensuremath{\bm{f}}}
\newcommand{\bg}{\ensuremath{\bm{g}}}
\newcommand{\bh}{\ensuremath{\bm{h}}}
\newcommand{\bi}{\ensuremath{\bm{i}}}
\newcommand{\bj}{\ensuremath{\bm{j}}}
\newcommand{\bk}{\ensuremath{\bm{k}}}
\newcommand{\bl}{\ensuremath{\bm{l}}}
\newcommand{\bbm}{\ensuremath{\bm{m}}}
\newcommand{\bn}{\ensuremath{\bm{n}}}
\newcommand{\bo}{\ensuremath{\bm{o}}}
\newcommand{\bp}{\ensuremath{\bm{p}}}
\newcommand{\bq}{\ensuremath{\bm{q}}}
\newcommand{\br}{\ensuremath{\bm{r}}}
\newcommand{\bs}{\ensuremath{\bm{s}}}
\newcommand{\bt}{\ensuremath{\bm{t}}}
\newcommand{\bu}{\ensuremath{\bm{u}}}
% \newcommand{\bv}{\ensuremath{\bm{v}}}
\newcommand{\bw}{\ensuremath{\bm{w}}}
\newcommand{\bx}{\ensuremath{\bm{x}}}
\newcommand{\by}{\ensuremath{\bm{y}}}
\newcommand{\bz}{\ensuremath{\bm{z}}}

\newcommand{\balpha}{\ensuremath{\bm{\alpha}}}
\newcommand{\bbeta}{\ensuremath{\bm{\beta}}}
\newcommand{\bgamma}{\ensuremath{\bm{\gamma}}}
\newcommand{\bdelta}{\ensuremath{\bm{\delta}}}
\newcommand{\bepsilon}{\ensuremath{\bm{\epsilon}}}
\newcommand{\bvarepsilon}{\ensuremath{\bm{\varepsilon}}}
\newcommand{\bphi}{\ensuremath{\bm{\phi}}}
\newcommand{\bvarphi}{\ensuremath{\bm{\varphi}}}
\newcommand{\bpsi}{\ensuremath{\bm{\psi}}}
\newcommand{\bmeta}{\ensuremath{\bm{\eta}}}
\newcommand{\biota}{\ensuremath{\bm{\iota}}}
\newcommand{\bupsilon}{\ensuremath{\bm{\upsilon}}}
\newcommand{\bkappa}{\ensuremath{\bm{\kappa}}}
\newcommand{\blambda}{\ensuremath{\bm{\lambda}}}
\newcommand{\bmu}{\ensuremath{\bm{\mu}}}
\newcommand{\bnu}{\ensuremath{\bm{\nu}}}
\newcommand{\bpi}{\ensuremath{\bm{\pi}}}
\newcommand{\bvarpi}{\ensuremath{\bm{\varpi}}}
\newcommand{\btheta}{\ensuremath{\bm{\theta}}}
\newcommand{\bvartheta}{\ensuremath{\bm{\vartheta}}}
\newcommand{\bchi}{\ensuremath{\bm{\chi}}}
\newcommand{\brho}{\ensuremath{\bm{\rho}}}
\newcommand{\bvarrho}{\ensuremath{\bm{\varrho}}}
\newcommand{\bsigma}{\ensuremath{\bm{\sigma}}}
\newcommand{\bvarsigma}{\ensuremath{\bm{\varsigma}}}
\newcommand{\btau}{\ensuremath{\bm{\tau}}}
\newcommand{\bxi}{\ensuremath{\bm{\xi}}}
\newcommand{\bzeta}{\ensuremath{\bm{\zeta}}}
\newcommand{\bomega}{\ensuremath{\bm{\omega}}}


% -- Blackboard --
\newcommand{\bbA}{\ensuremath{\mathbb{A}}}
\newcommand{\bbB}{\ensuremath{\mathbb{B}}}
\newcommand{\bbC}{\ensuremath{\mathbb{C}}}
\newcommand{\bbD}{\ensuremath{\mathbb{D}}}
\newcommand{\bbE}{\ensuremath{\mathbb{E}}}
\newcommand{\bbF}{\ensuremath{\mathbb{F}}}
\newcommand{\bbG}{\ensuremath{\mathbb{G}}}
\newcommand{\bbH}{\ensuremath{\mathbb{H}}}
\newcommand{\bbI}{\ensuremath{\mathbb{I}}}
\newcommand{\bbJ}{\ensuremath{\mathbb{J}}}
\newcommand{\bbK}{\ensuremath{\mathbb{K}}}
\newcommand{\bbL}{\ensuremath{\mathbb{L}}}
\newcommand{\bbM}{\ensuremath{\mathbb{M}}}
\newcommand{\bbN}{\ensuremath{\mathbb{N}}}
\newcommand{\bbO}{\ensuremath{\mathbb{O}}}
\newcommand{\bbP}{\ensuremath{\mathbb{P}}}
\newcommand{\bbQ}{\ensuremath{\mathbb{Q}}}
\newcommand{\bbR}{\ensuremath{\mathbb{R}}}
\newcommand{\bbS}{\ensuremath{\mathbb{S}}}
\newcommand{\bbT}{\ensuremath{\mathbb{T}}}
\newcommand{\bbU}{\ensuremath{\mathbb{U}}}
\newcommand{\bbV}{\ensuremath{\mathbb{V}}}
\newcommand{\bbW}{\ensuremath{\mathbb{W}}}
\newcommand{\bbX}{\ensuremath{\mathbb{X}}}
\newcommand{\bbY}{\ensuremath{\mathbb{Y}}}
\newcommand{\bbZ}{\ensuremath{\mathbb{Z}}}



% -- Fraktur --
\newcommand{\fkA}{\ensuremath{\mathfrak{A}}}
\newcommand{\fkB}{\ensuremath{\mathfrak{B}}}
\newcommand{\fkC}{\ensuremath{\mathfrak{C}}}
\newcommand{\fkD}{\ensuremath{\mathfrak{D}}}
\newcommand{\fkE}{\ensuremath{\mathfrak{E}}}
\newcommand{\fkF}{\ensuremath{\mathfrak{F}}}
\newcommand{\fkG}{\ensuremath{\mathfrak{G}}}
\newcommand{\fkH}{\ensuremath{\mathfrak{H}}}
\newcommand{\fkI}{\ensuremath{\mathfrak{I}}}
\newcommand{\fkJ}{\ensuremath{\mathfrak{J}}}
\newcommand{\fkK}{\ensuremath{\mathfrak{K}}}
\newcommand{\fkL}{\ensuremath{\mathfrak{L}}}
\newcommand{\fkM}{\ensuremath{\mathfrak{M}}}
\newcommand{\fkN}{\ensuremath{\mathfrak{N}}}
\newcommand{\fkO}{\ensuremath{\mathfrak{O}}}
\newcommand{\fkP}{\ensuremath{\mathfrak{P}}}
\newcommand{\fkQ}{\ensuremath{\mathfrak{Q}}}
\newcommand{\fkR}{\ensuremath{\mathfrak{R}}}
\newcommand{\fkS}{\ensuremath{\mathfrak{S}}}
\newcommand{\fkT}{\ensuremath{\mathfrak{T}}}
\newcommand{\fkU}{\ensuremath{\mathfrak{U}}}
\newcommand{\fkV}{\ensuremath{\mathfrak{V}}}
\newcommand{\fkW}{\ensuremath{\mathfrak{W}}}
\newcommand{\fkX}{\ensuremath{\mathfrak{X}}}
\newcommand{\fkY}{\ensuremath{\mathfrak{Y}}}
\newcommand{\fkZ}{\ensuremath{\mathfrak{Z}}}

\newcommand{\fka}{\ensuremath{\mathfrak{a}}}
\newcommand{\fkb}{\ensuremath{\mathfrak{b}}}
\newcommand{\fkc}{\ensuremath{\mathfrak{c}}}
\newcommand{\fkd}{\ensuremath{\mathfrak{d}}}
\newcommand{\fke}{\ensuremath{\mathfrak{e}}}
\newcommand{\fkf}{\ensuremath{\mathfrak{f}}}
\newcommand{\fkg}{\ensuremath{\mathfrak{g}}}
\newcommand{\fkh}{\ensuremath{\mathfrak{h}}}
\newcommand{\fki}{\ensuremath{\mathfrak{i}}}
\newcommand{\fkj}{\ensuremath{\mathfrak{j}}}
\newcommand{\fkk}{\ensuremath{\mathfrak{k}}}
\newcommand{\fkl}{\ensuremath{\mathfrak{l}}}
\newcommand{\fkm}{\ensuremath{\mathfrak{m}}}
\newcommand{\fkn}{\ensuremath{\mathfrak{n}}}
\newcommand{\fko}{\ensuremath{\mathfrak{o}}}
\newcommand{\fkp}{\ensuremath{\mathfrak{p}}}
\newcommand{\fkq}{\ensuremath{\mathfrak{q}}}
\newcommand{\fkr}{\ensuremath{\mathfrak{r}}}
\newcommand{\fks}{\ensuremath{\mathfrak{s}}}
\newcommand{\fkt}{\ensuremath{\mathfrak{t}}}
\newcommand{\fku}{\ensuremath{\mathfrak{u}}}
\newcommand{\fkv}{\ensuremath{\mathfrak{v}}}
\newcommand{\fkw}{\ensuremath{\mathfrak{w}}}
\newcommand{\fkx}{\ensuremath{\mathfrak{x}}}
\newcommand{\fky}{\ensuremath{\mathfrak{y}}}
\newcommand{\fkz}{\ensuremath{\mathfrak{z}}}


% -- Boldface bar/tilde/hat --
\newcommand{\bab}{\ensuremath{\bm{{\bar{a}}}}}
\newcommand{\bbb}{\ensuremath{\bm{{\bar{b}}}}}
\newcommand{\bcb}{\ensuremath{\bm{{\bar{c}}}}}
\newcommand{\bdb}{\ensuremath{\bm{{\bar{d}}}}}
\newcommand{\beb}{\ensuremath{\bm{{\bar{e}}}}}
\newcommand{\bbfb}{\ensuremath{\bm{{\bar{f}}}}}
\newcommand{\bgb}{\ensuremath{\bm{{\bar{g}}}}}
\newcommand{\bhb}{\ensuremath{\bm{{\bar{h}}}}}
\newcommand{\bib}{\ensuremath{\bm{{\bar{i}}}}}
\newcommand{\bjb}{\ensuremath{\bm{{\bar{j}}}}}
\newcommand{\bkb}{\ensuremath{\bm{{\bar{k}}}}}
\newcommand{\blb}{\ensuremath{\bm{{\bar{l}}}}}
\newcommand{\bbmb}{\ensuremath{\bm{{\bar{m}}}}}
\newcommand{\bnb}{\ensuremath{\bm{{\bar{n}}}}}
\newcommand{\bob}{\ensuremath{\bm{{\bar{o}}}}}
\newcommand{\bpb}{\ensuremath{\bm{{\bar{p}}}}}
\newcommand{\bqb}{\ensuremath{\bm{{\bar{q}}}}}
\newcommand{\brb}{\ensuremath{\bm{{\bar{r}}}}}
\newcommand{\bsb}{\ensuremath{\bm{{\bar{s}}}}}
\newcommand{\btb}{\ensuremath{\bm{{\bar{t}}}}}
\newcommand{\bub}{\ensuremath{\bm{{\bar{u}}}}}
\newcommand{\bvb}{\ensuremath{\bm{{\bar{v}}}}}
\newcommand{\bwb}{\ensuremath{\bm{{\bar{w}}}}}
\newcommand{\bxb}{\ensuremath{\bm{{\bar{x}}}}}
\newcommand{\byb}{\ensuremath{\bm{{\bar{y}}}}}
\newcommand{\bzb}{\ensuremath{\bm{{\bar{z}}}}}

\newcommand{\bAb}{\ensuremath{\bm{{\bar{A}}}}}
\newcommand{\bBb}{\ensuremath{\bm{{\bar{B}}}}}
\newcommand{\bCb}{\ensuremath{\bm{{\bar{C}}}}}
\newcommand{\bDb}{\ensuremath{\bm{{\bar{D}}}}}
\newcommand{\bEb}{\ensuremath{\bm{{\bar{E}}}}}
\newcommand{\bbFb}{\ensuremath{\bm{{\bar{F}}}}}
\newcommand{\bGb}{\ensuremath{\bm{{\bar{G}}}}}
\newcommand{\bHb}{\ensuremath{\bm{{\bar{H}}}}}
\newcommand{\bIb}{\ensuremath{\bm{{\bar{I}}}}}
\newcommand{\bJb}{\ensuremath{\bm{{\bar{J}}}}}
\newcommand{\bKb}{\ensuremath{\bm{{\bar{K}}}}}
\newcommand{\bLb}{\ensuremath{\bm{{\bar{L}}}}}
\newcommand{\bbMb}{\ensuremath{\bm{{\bar{M}}}}}
\newcommand{\bNb}{\ensuremath{\bm{{\bar{N}}}}}
\newcommand{\bOb}{\ensuremath{\bm{{\bar{O}}}}}
\newcommand{\bPb}{\ensuremath{\bm{{\bar{P}}}}}
\newcommand{\bQb}{\ensuremath{\bm{{\bar{Q}}}}}
\newcommand{\bRb}{\ensuremath{\bm{{\bar{R}}}}}
\newcommand{\bSb}{\ensuremath{\bm{{\bar{S}}}}}
\newcommand{\bTb}{\ensuremath{\bm{{\bar{T}}}}}
\newcommand{\bUb}{\ensuremath{\bm{{\bar{U}}}}}
\newcommand{\bVb}{\ensuremath{\bm{{\bar{V}}}}}
\newcommand{\bWb}{\ensuremath{\bm{{\bar{W}}}}}
\newcommand{\bXb}{\ensuremath{\bm{{\bar{X}}}}}
\newcommand{\bYb}{\ensuremath{\bm{{\bar{Y}}}}}
\newcommand{\bZb}{\ensuremath{\bm{{\bar{Z}}}}}

\newcommand{\bat}{\ensuremath{\bm{{\tilde{a}}}}}
\newcommand{\bbt}{\ensuremath{\bm{{\tilde{b}}}}}
\newcommand{\bct}{\ensuremath{\bm{{\tilde{c}}}}}
\newcommand{\bdt}{\ensuremath{\bm{{\tilde{d}}}}}
\newcommand{\bet}{\ensuremath{\bm{{\tilde{e}}}}}
\newcommand{\bbft}{\ensuremath{\bm{{\tilde{f}}}}}
\newcommand{\bgt}{\ensuremath{\bm{{\tilde{g}}}}}
\newcommand{\bht}{\ensuremath{\bm{{\tilde{h}}}}}
\newcommand{\bit}{\ensuremath{\bm{{\tilde{i}}}}}
\newcommand{\bjt}{\ensuremath{\bm{{\tilde{j}}}}}
\newcommand{\bkt}{\ensuremath{\bm{{\tilde{k}}}}}
\newcommand{\blt}{\ensuremath{\bm{{\tilde{l}}}}}
\newcommand{\bbmt}{\ensuremath{\bm{{\tilde{m}}}}}
\newcommand{\bnt}{\ensuremath{\bm{{\tilde{n}}}}}
\newcommand{\bbot}{\ensuremath{\bm{{\tilde{o}}}}}
\newcommand{\bpt}{\ensuremath{\bm{{\tilde{p}}}}}
\newcommand{\bqt}{\ensuremath{\bm{{\tilde{q}}}}}
\newcommand{\brt}{\ensuremath{\bm{{\tilde{r}}}}}
\newcommand{\bst}{\ensuremath{\bm{{\tilde{s}}}}}
\newcommand{\btt}{\ensuremath{\bm{{\tilde{t}}}}}
\newcommand{\but}{\ensuremath{\bm{{\tilde{u}}}}}
\newcommand{\bvt}{\ensuremath{\bm{{\tilde{v}}}}}
\newcommand{\bwt}{\ensuremath{\bm{{\tilde{w}}}}}
\newcommand{\bxt}{\ensuremath{\bm{{\tilde{x}}}}}
\newcommand{\byt}{\ensuremath{\bm{{\tilde{y}}}}}
\newcommand{\bzt}{\ensuremath{\bm{{\tilde{z}}}}}

\newcommand{\bAt}{\ensuremath{\bm{{\tilde{A}}}}}
\newcommand{\bBt}{\ensuremath{\bm{{\tilde{B}}}}}
\newcommand{\bCt}{\ensuremath{\bm{{\tilde{C}}}}}
\newcommand{\bDt}{\ensuremath{\bm{{\tilde{D}}}}}
\newcommand{\bEt}{\ensuremath{\bm{{\tilde{E}}}}}
\newcommand{\bbFt}{\ensuremath{\bm{{\tilde{F}}}}}
\newcommand{\bGt}{\ensuremath{\bm{{\tilde{G}}}}}
\newcommand{\bHt}{\ensuremath{\bm{{\tilde{H}}}}}
\newcommand{\bIt}{\ensuremath{\bm{{\tilde{I}}}}}
\newcommand{\bJt}{\ensuremath{\bm{{\tilde{J}}}}}
\newcommand{\bKt}{\ensuremath{\bm{{\tilde{K}}}}}
\newcommand{\bLt}{\ensuremath{\bm{{\tilde{L}}}}}
\newcommand{\bbMt}{\ensuremath{\bm{{\tilde{M}}}}}
\newcommand{\bNt}{\ensuremath{\bm{{\tilde{N}}}}}
\newcommand{\bOt}{\ensuremath{\bm{{\tilde{O}}}}}
\newcommand{\bPt}{\ensuremath{\bm{{\tilde{P}}}}}
\newcommand{\bQt}{\ensuremath{\bm{{\tilde{Q}}}}}
\newcommand{\bRt}{\ensuremath{\bm{{\tilde{R}}}}}
\newcommand{\bSt}{\ensuremath{\bm{{\tilde{S}}}}}
\newcommand{\bTt}{\ensuremath{\bm{{\tilde{T}}}}}
\newcommand{\bUt}{\ensuremath{\bm{{\tilde{U}}}}}
\newcommand{\bVt}{\ensuremath{\bm{{\tilde{V}}}}}
\newcommand{\bWt}{\ensuremath{\bm{{\tilde{W}}}}}
\newcommand{\bXt}{\ensuremath{\bm{{\tilde{X}}}}}
\newcommand{\bYt}{\ensuremath{\bm{{\tilde{Y}}}}}
\newcommand{\bZt}{\ensuremath{\bm{{\tilde{Z}}}}}

\newcommand{\bah}{\ensuremath{\bm{{\hat{a}}}}}
\newcommand{\bbh}{\ensuremath{\bm{{\hat{b}}}}}
\newcommand{\bch}{\ensuremath{\bm{{\hat{c}}}}}
\newcommand{\bdh}{\ensuremath{\bm{{\hat{d}}}}}
\newcommand{\beh}{\ensuremath{\bm{{\hat{e}}}}}
\newcommand{\bbfh}{\ensuremath{\bm{{\hat{f}}}}}
\newcommand{\bgh}{\ensuremath{\bm{{\hat{g}}}}}
\newcommand{\bhh}{\ensuremath{\bm{{\hat{h}}}}}
\newcommand{\bih}{\ensuremath{\bm{{\hat{i}}}}}
\newcommand{\bjh}{\ensuremath{\bm{{\hat{j}}}}}
\newcommand{\bkh}{\ensuremath{\bm{{\hat{k}}}}}
\newcommand{\blh}{\ensuremath{\bm{{\hat{l}}}}}
\newcommand{\bbmh}{\ensuremath{\bm{{\hat{m}}}}}
\newcommand{\bnh}{\ensuremath{\bm{{\hat{n}}}}}
\newcommand{\bboh}{\ensuremath{\bm{{\hat{o}}}}}
\newcommand{\bph}{\ensuremath{\bm{{\hat{p}}}}}
\newcommand{\bqh}{\ensuremath{\bm{{\hat{q}}}}}
\newcommand{\brh}{\ensuremath{\bm{{\hat{r}}}}}
\newcommand{\bsh}{\ensuremath{\bm{{\hat{s}}}}}
\newcommand{\bth}{\ensuremath{\bm{{\hat{t}}}}}
\newcommand{\buh}{\ensuremath{\bm{{\hat{u}}}}}
\newcommand{\bvh}{\ensuremath{\bm{{\hat{v}}}}}
\newcommand{\bwh}{\ensuremath{\bm{{\hat{w}}}}}
\newcommand{\bxh}{\ensuremath{\bm{{\hat{x}}}}}
\newcommand{\byh}{\ensuremath{\bm{{\hat{y}}}}}
\newcommand{\bzh}{\ensuremath{\bm{{\hat{z}}}}}

\newcommand{\bAh}{\ensuremath{\bm{{\hat{A}}}}}
\newcommand{\bBh}{\ensuremath{\bm{{\hat{B}}}}}
\newcommand{\bCh}{\ensuremath{\bm{{\hat{C}}}}}
\newcommand{\bDh}{\ensuremath{\bm{{\hat{D}}}}}
\newcommand{\bEh}{\ensuremath{\bm{{\hat{E}}}}}
\newcommand{\bbFh}{\ensuremath{\bm{{\hat{F}}}}}
\newcommand{\bGh}{\ensuremath{\bm{{\hat{G}}}}}
\newcommand{\bHh}{\ensuremath{\bm{{\hat{H}}}}}
\newcommand{\bIh}{\ensuremath{\bm{{\hat{I}}}}}
\newcommand{\bJh}{\ensuremath{\bm{{\hat{J}}}}}
\newcommand{\bKh}{\ensuremath{\bm{{\hat{K}}}}}
\newcommand{\bLh}{\ensuremath{\bm{{\hat{L}}}}}
\newcommand{\bbMh}{\ensuremath{\bm{{\hat{M}}}}}
\newcommand{\bNh}{\ensuremath{\bm{{\hat{N}}}}}
\newcommand{\bOh}{\ensuremath{\bm{{\hat{O}}}}}
\newcommand{\bPh}{\ensuremath{\bm{{\hat{P}}}}}
\newcommand{\bQh}{\ensuremath{\bm{{\hat{Q}}}}}
\newcommand{\bRh}{\ensuremath{\bm{{\hat{R}}}}}
\newcommand{\bSh}{\ensuremath{\bm{{\hat{S}}}}}
\newcommand{\bTh}{\ensuremath{\bm{{\hat{T}}}}}
\newcommand{\bUh}{\ensuremath{\bm{{\hat{U}}}}}
\newcommand{\bVh}{\ensuremath{\bm{{\hat{V}}}}}
\newcommand{\bWh}{\ensuremath{\bm{{\hat{W}}}}}
\newcommand{\bXh}{\ensuremath{\bm{{\hat{X}}}}}
\newcommand{\bYh}{\ensuremath{\bm{{\hat{Y}}}}}
\newcommand{\bZh}{\ensuremath{\bm{{\hat{Z}}}}}


% -- Shorthands --
%\def\st/{\textsuperscript{st}}
\def\nd/{\textsuperscript{nd}}
\def\rd/{\textsuperscript{rd}}
\def\th/{\textsuperscript{th}}

\newcommand{\setN}{\bbN}
\newcommand{\setZ}{\bbZ}
\newcommand{\setQ}{\bbQ}
\newcommand{\setR}{\bbR}
\newcommand{\setC}{\bbC}
\newcommand{\setS}{\bbS}
\newcommand{\setB}{\bbB}

\newcommand{\eps}{\ensuremath{\epsilon}}
\newcommand{\del}{\ensuremath{\partial}}
\newcommand{\zeros}{\ensuremath{\bm{0}}}
\newcommand{\ones}{\ensuremath{\bm{\mathds{1}}}}
\newcommand{\MSE}{\ensuremath{\textup{MSE}}}


\makeatletter
\def\nnil{\nil}
\newcounter{prob}
\newenvironment{prob}[1][\nil]{%
	\def\tmp{#1}
	\equation
	\ifx\tmp\nnil
		\refstepcounter{prob}
		\edef\@currentlabel{\theprob}\expandafter\ltx@label\expandafter{P\Roman{prob}-counter-number}
		\tag{P\Roman{prob}}
	\else
		\tag{\tmp}
	\fi
	\aligned%
}{%
	\endaligned\endequation%
}

\newcounter{dual}
\newenvironment{dual}[1][\nil]{%
	\def\tmp{#1}
	\equation
	\ifx\tmp\nnil
		\refstepcounter{prob}
		\tag{D\Roman{prob}}
	\else
		\ifcsname r@#1\endcsname
			\edef\tmp{\getrefnumber{#1}}
			\expandafter\def\expandafter\tmp\tmp
			\edef\tmp{\getrefnumber{\tmp-counter-number}}
			\setcounter{dual}{\tmp}
			\edef\tmp{D\Roman{dual}}% Strip number
			\tag{\tmp}
		\fi
	\fi
	\aligned%
}{%
	\endaligned\endequation%
}
\makeatother

\newenvironment{prob*}{%
	\csname equation*\endcsname%
	\aligned%
}{%
	\endaligned%
	\csname endequation*\endcsname%
}
