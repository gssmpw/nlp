\begin{tikzpicture}
  \begin{loglogaxis}[
    width=.95\columnwidth, 
    height=6cm,
    log basis x=2,
    log basis y=10,
    xlabel={Number of DOFs per subdomain},
    ylabel={Time per subdomain [ms]},
    % xticklabel={\xinttheiexpr[0]2^\tick\relax},
    % yticklabel={\xinttheiexpr[1]2^\tick\relax},
    xmajorgrids=true,
    ymajorgrids=true,
    every axis plot/.append style={line width=1.2pt},
    grid style=dotted,
    xmin=242,
    xmax=97469,
    ymin=94,
    ymax=50624,
    label style={font=\footnotesize},
    tick label style={font=\footnotesize},
    legend style={font=\footnotesize, draw=none, at={(0.95,0.05)}, anchor=south east, legend columns=1},
    legend cell align={left}
  ]
    \addplot[dashed, color={blue}, mark=none] coordinates {
      (  343 ,  921.132 )
      (  729 , 2950.456 )
      ( 1331 , 8080.394 )
      ( 2197 , 8767.602 )
    };
    \addplot[solid, color={blue}, mark=none] coordinates {
      (   343 ,   153.017 )
      (   729 ,   337.743 )
      (  1331 ,   820.683 )
      (  2197 ,  1055.936 )
      (  4913 ,  2862.325 )
      (  9261 ,  5725.716 )
      ( 19683 , 15992.118 )
      ( 35937 , 36759.575 )
    };
    \addplot[dashed, color={red}, mark=none] coordinates {
      (   343 ,   133.735 )
      (   729 ,   351.376 )
      (  1331 ,   964.267 )
      (  2197 ,  1163.215 )
      (  4913 ,  2727.881 )
      (  9261 ,  4686.846 )
      ( 19683 , 10529.750 )
      ( 35937 , 18646.731 )
      ( 68921 , 30323.116 )
    };
    \addplot[solid, color={red}, mark=none] coordinates {
      (   343 ,   151.081 )
      (   729 ,   338.697 )
      (  1331 ,   757.922 )
      (  2197 ,   984.992 )
      (  4913 ,  2705.722 )
      (  9261 ,  5504.220 )
      ( 19683 , 15722.003 )
      ( 35937 , 35797.209 )
    };
    \addlegendentry{sparse, modern}
    \addlegendentry{dense, modern}
    \addlegendentry{sparse, legacy}
    \addlegendentry{dense, legacy}
  \end{loglogaxis}
\end{tikzpicture}
