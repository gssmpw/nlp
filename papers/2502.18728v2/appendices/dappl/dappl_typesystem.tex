\subsection{A \dappl{} typesystem}
\label{appendix:typesystem}
The type system of \dappl{} has the types
$\Bool$, $\Giry{\Bool}$, and $\Choice{\alpha_1, \cdots, \alpha_n}$,
for nonempty sets of nonconflicting names
$\{\alpha_1, \cdots, \alpha_n\}$.
The typing is with respect to
a standard context $\Gamma := \cdot \ \| \ x: \tau, \Gamma$.

\begin{figure}[H]
\begin{mdframed}
{\centering
  \begin{align*}
    \infer[\texttt{tp/T}]
      {\cdot \proves \tt : \Bool}
      {}
    \qquad
    \infer[\texttt{tp/F}]
      {\cdot \proves \ff : \Bool}
      {}
    \qquad
    \infer[\texttt{tp/var}]
      {\Gamma \proves x : \tau}
      {x : \tau  \in \Gamma}
  \end{align*}
  \begin{align*}
    \infer[\texttt{tp/and}]
      {\Gamma \proves P_1  \land P_2 : \Bool}
      {\Gamma \proves P_1  : \Bool
      &
      \Gamma \proves P_2  : \Bool}
    \qquad
    \infer[\texttt{tp/or}]
      {\Gamma \proves P_1  \lor P_2 : \Bool}
      {\Gamma \proves P_1  : \Bool
      &
      \Gamma \proves P_2  : \Bool}
  \end{align*}
  \begin{align*}
    \infer[\texttt{tp/neg}]
      {\Gamma \proves \neg P: \Bool}
      {\Gamma \proves P : \Bool}
    \qquad
    \infer[\texttt{tp/ret}]
      {\Gamma \proves \return P : \Giry \Bool}
      {\Gamma \proves P : \Bool}
  \end{align*}
    \begin{align*}
      \infer[\texttt{tp/flip}]
        {\cdot \proves \flip \theta : \Giry \Bool}
        {}
      \qquad
      \infer[\texttt{tp/reward}]
        {\Gamma \proves \reward k e: \tau}
        {\Gamma \proves e : \tau}
    \end{align*}
    \begin{align*}
      \infer[\texttt{tp/ITE}]
        {\Gamma \proves \ite e {e_T} {e_E} : \tau}
        {\Gamma \proves e : \Bool
        & \Gamma \proves e_T : \tau
        & \Gamma \proves e_E : \tau}
    \end{align*}
    \begin{align*}
      \infer[\texttt{tp/<-/G}]
        {\Gamma \proves \bind x e {e'} : \tau}
        {\Gamma \proves e : \Giry \Bool
        & x : \Bool, \Gamma \proves e' : \tau}
    \end{align*}
    \begin{align*}
      \infer[\texttt{tp/<-/Choice}]
        {\Gamma \proves \bind x e {e'} : \tau}
        {\Gamma \proves e : \Choice{\alpha_1, \cdots, \alpha_n}
        & x : \Choice{\alpha_1, \cdots, \alpha_n}, \Gamma \proves e' : \tau}
    \end{align*}
    \begin{align*}
      \infer[\texttt{tp/obsT}]
        {\Gamma \proves \observe P e : \tau}
        {\Gamma \proves P : \Bool
        & \Gamma \proves e : \tau}
    \end{align*}
    \begin{align*}
    \infer[\texttt{tp/[]}]
      {\cdot \proves [\alpha_1, \cdots, \alpha_n] :
        \Choice{\alpha_1, \cdots, \alpha_n}}
      {}
    \end{align*}
    \begin{align*}
    \infer[\texttt{tp/choosewith}]
      {\Gamma \proves \choose{x}{\alpha_i \implies e_i} : \tau}
      {\Gamma \proves x : \Choice{\alpha_1,\cdots, \alpha_n}
      &\forall i \in [n]. \ \Gamma \proves e_i : \tau}
    \end{align*}}
\end{mdframed}
\caption{Typing rules of \dappl{}.
The typing rules of \util{} are all of the above
rules except for \texttt{tp/[]}, \texttt{tp/choosewith}, and \texttt{tp/<-Choice}.
}
\label{fig:dappl typing}

We prove a Lemma:

\begin{lemma}
  Let $\Gamma \proves e : \tau$ a $\util$ expression. Then $\tau$ must be of type $\Giry \Bool$.
\end{lemma}

\begin{proof}
  Induction on the typing rules.
\end{proof}
\end{figure}
