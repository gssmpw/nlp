\subsection{Proof of Theorem~\ref{thm:ub correctness}}
\label{appendix:proof ub correctness}

\begin{proof}
  We induct on $|X| - |P|$. In the base case, $|X| = |P|$, so $P$ is
  a policy and we are done. For our inductive argument, consider
  $P$ a partial policy such that for all $P' \supsetneq P$,
  Equation~\ref{eq:ub correctness} holds.
  We want to show that $P$ still satisfies Equation~\ref{eq:ub correctness}
  for all of its completions.

  So fix $T$ a completion. Simplifying Equation~\ref{eq:ub correctness}
  we observe it suffices to show
  \begin{equation}
    h(\varphi|_P, w) \sqsupseteq h(\varphi|_T,w)\prod_{x \in P} w(x).
  \end{equation}

  Let $x$ be the variable chosen first by line 4 of Algorithm~\ref{algorithm:h}
  when computing $h(\varphi|_P, w)$.
  We know $x$ must be either a choice (i.e., lie in $T \setminus P$) or not; we case.
  \begin{itemize}
    \item If $x \in T \setminus P$, 
    then in particular $x \in T$; 
    we take the join as per line 5. We observe
    \begin{align*}
      h(\varphi|_P, w)
        &= w(x)h(\varphi|_{P}|_x) 
          \sqcup w(\overline x)h(\varphi|_{P}|_{\overline x},w) \\ 
        &\sqsupseteq w(x)h(\varphi|_T,w)\prod_{y \in P\setminus \{x\}}w(y) 
          \sqcup w(\overline x)h(\varphi|_{P}|_{\overline x},w)&\text{(IH)}\\  
        &\sqsupseteq w(x)h(\varphi|_T,w)\prod_{y \in P\setminus \{x\}}w(x) 
        = \boxed{h(\varphi|_T,w)\prod_{y \in P}w(x),}    
    \end{align*}
    where (IH) can be used as $\varphi|_{P}|_x = \varphi|_{P \cup \{x\}}$,
    and $P \cup \{x\}$ is still a partial policy. The case for 
    $\varphi|_P|_{\overline x}$ is identical.
    \item If $x \notin T\setminus P$, 
    we take the sum as per line 6. 
    We continue recursing until we hit a variable $x' \in T \setminus P$; 
    then we reduce to case 1 and we are done.
  \end{itemize}
\end{proof}

\noindent
\textit{Remark.} 
It is important to note that the above theorem 
cannot be generalized to give a relation between 
any two partial policies $P \subsetneq P'$. 
This is because that the first inductive case 
crucially relies on the fact that 
we are not applying the IH twice. 
Indeed, in general,
\begin{align*}
   w(x)h(\varphi|_T,w)\prod_{y \in P\setminus \{x\}}w(y) 
    \sqcup w(\overline x)h(\varphi|_T,w)\prod_{y \in P\setminus \{\overline x\}} w(y) 
  \\\quad 
   \not\sqsupseteq 
  \prod_{y \in P } w(y) \paren{w(x)h(\varphi|_T,w) \sqcup w(\overline x) h(\varphi|_T,w)}
\end{align*}
when $x \notin P'$; this is a manifestation of the more general phenomena that
$$a(b \sqcup c) \not \sqsubseteq ab \sqcup ac.$$