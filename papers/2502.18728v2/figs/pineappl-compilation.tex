\begin{figure}
\begin{mdframed}
  {\footnotesize
  \begin{align*}
    \infer[\texttt{bc/mmap}]
    {
      (\vec{\texttt{m}}\texttt{ = mmap }\vec{\texttt{x}}, \mathcal{F}, w) \leadsto
      (\mathcal{F} \cup \{(m_i, k_i) \}, w \cup w_{M})
    }
    {
      \mathrm{fresh} \; k_i
      & \vec A = MMAP(\{\bigwedge_{(x, \varphi) \in \mathcal{F}} x \leftrightarrow \varphi, \eset\}, \vec{\texttt{x}}, w)
      &
      w_{M} = \{m_i \mapsto (1,1), k_i \mapsto A_i \}
    }
  \end{align*}
  \begin{align*}
    \infer[\texttt{bc/mmap/with}]
    {
      (\vec{\texttt{m}}\texttt{ = mmap }\vec{\texttt{x}} \ \pineapplcode{ with \{e\}}, \mathcal{F}, w) \leadsto
      (\mathcal{F} \cup \{(m_i, k_i) \}, w \cup w_{M})
    }
    {
      \mathrm{fresh} \; k_i
      & \texttt e \leadsto_E \psi
      & \vec A = MMAP(\{\bigwedge_{(x, \varphi) \in \mathcal{F}} x \leftrightarrow \varphi, \psi\}, \vec{\texttt{x}}, w)
      &
      w_{M} = \{m_i \mapsto (1,1), k_i \mapsto A_i \}
    }
  \end{align*}
  \begin{align*}
    \infer[\texttt{bc/pr}]
    {
      \texttt{s; Pr(e)} \leadsto_P (\chi \land \left( \bigwedge_{(x, \varphi) \in \mathcal{F}} x \leftrightarrow \varphi \right), \top,w)
    }
    {
      (\texttt{s}, \eset, \eset) \leadsto (\mathcal F, w)
      &
      \texttt{e} \leadsto_E \chi
    }
  \end{align*}
  \begin{align*}
    \infer[\texttt{bc/pr/with}]
    {
      \pineapplcode{s; Pr(e$_1$) with \{e$_2$\}} \leadsto_P (\chi \land \left(\bigwedge_{(x, \varphi) \in \mathcal{F}} x \leftrightarrow \varphi \right), \psi, w)
    }
    {
      (s, \eset, \eset) \leadsto (\mathcal F, w)
      &
      \texttt{e$_1$} \leadsto_E \chi
      &
      \texttt{e$_2$} \leadsto_E \psi
    }
  \end{align*}
  }
\end{mdframed}
\caption{Selected Boolean compilation rules for $\pineappl$. As shorthand, we write
$w \cup \{x \mapsto (a, b)\}$ instead of $w \cup \{(x \mapsto \top) \mapsto a, (x \mapsto \bot) \mapsto b\}$.
The $\leadsto_E$ relation translates expressions into Boolean formulae; explicit rules are given in~\cref{appendix:pineappl bc}. The symbol $\leftrightarrow$ denotes logical if-and-only-if.}
\label{fig:pineappl-compl}
\end{figure}

%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: "../oopsla-appendix"
%%% End:
