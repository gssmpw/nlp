\pdfoutput=1
%% For double-blind review submission, w/o CCS and ACM Reference (max submission space)
% \documentclass[acmsmall,review, anonymous]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review,anonymous]{acmart}\settopmatter{printfolios=true}
%% For single-blind review submission, w/o CCS and ACM Reference (max submission space)
\documentclass[acmsmall]{acmart}
%% For single-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true}
%% For final camera-ready submission, w/ required CCS and ACM Reference
%\documentclass[acmsmall]{acmart}\settopmatter{}


%%% The following is specific to OOPSLA1 '25 and the paper
%%% 'Scaling Optimization over Uncertainty via Compilation'
%%% by Minsung Cho, John Gouwar, and Steven Holtzen.
%%%
% \setcopyright{cc}
% \setcctype{by}
\acmDOI{10.1145/3720500}
\acmYear{2025}
\acmJournal{PACMPL}
\acmVolume{9}
\acmNumber{OOPSLA1}
\acmArticle{135}
\acmMonth{4}
\received{2024-10-15}
\received[accepted]{2025-02-18}
\setcopyright{cc}
\setcctype{by}

%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission;
%% use 'none' for review submission.
% \setcopyright{none}
% \setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
% \setcopyright{rightsretained}
%\copyrightyear{2018}           %% If different from \acmYear

%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
%% Note: author/year citations are required for papers published as an
%% issue of PACMPL.
\citestyle{acmauthoryear}   %% For author/year citations


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Note: Authors migrating a paper from PACMPL format to traditional
%% SIGPLAN proceedings format must update the '\documentclass' and
%% topmatter commands above; see 'acmart-sigplanproc-template.tex'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Some recommended packages.
\usepackage{booktabs}   %% For formal tables:
                        %% http://ctan.org/pkg/booktabs
\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
                        %% http://ctan.org/pkg/subcaption
\usepackage{meu, proof}

\newcommand{\diff}[1]{{\color{red} #1}}
% \newcommand{\appcite}[1]{#1}
\newcommand{\appcite}[1]{the appendix}
% \newcommand{\diff}[1]{#1}

\begin{document}

\pgfplotstableread[col sep = comma]{data/hmm-data.csv}\hmmdata
\pgfplotstableread[col sep = comma]{data/ladder-long.csv}\ladderlongdata
\pgfplotstableread[col sep = comma]{data/ladder4.csv}\ladderfour
\pgfplotstableread[col sep = comma]{nested-pineappl/pineappl-nested.csv}\Nested
\pgfplotstableread[col sep = comma]{nested-pineappl/pineappl-nested-fit.csv}\Nestedfit

%% Title information
\title{Scaling Optimization over Uncertainty via Compilation}
                                        %% when present, will be used in
                                        %% header instead of Full Title.
% \titlenote{with title note}             %% \titlenote is optional;
%                                         %% can be repeated if necessary;
%                                         %% contents suppressed with 'anonymous'
% \subtitle{Subtitle}                     %% \subtitle is optional
% \subtitlenote{with subtitle note}       %% \subtitlenote is optional;
%                                         %% can be repeated if necessary;
%                                         %% contents suppressed with 'anonymous'


%% Author information
%% Contents and number of authors suppressed with 'anonymous'.
%% Each author should be introduced by \author, followed by
%% \authornote (optional), \orcid (optional), \affiliation, and
%% \email.
%% An author may have multiple affiliations and/or emails; repeat the
%% appropriate command.
%% Many elements are not rendered, but should be provided for metadata
%% extraction tools.

%% Author with single affiliation.
% \author{First1 Last1}
% \authornote{with author1 note}          %% \authornote is optional;
%                                         %% can be repeated if necessary
% \orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
% \affiliation{
%   \position{Position1}
%   \department{Department1}              %% \department is recommended
%   \institution{Institution1}            %% \institution is required
%   \streetaddress{Street1 Address1}
%   \city{City1}
%   \state{State1}
%   \postcode{Post-Code1}
%   \country{Country1}                    %% \country is recommended
% }
% \email{first1.last1@inst1.edu}          %% \email is recommended

% %% Author with two affiliations and emails.
% \author{First2 Last2}
% \authornote{with author2 note}          %% \authornote is optional;
%                                         %% can be repeated if necessary
% \orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
% \affiliation{
%   \position{Position2a}
%   \department{Department2a}             %% \department is recommended
%   \institution{Institution2a}           %% \institution is required
%   \streetaddress{Street2a Address2a}
%   \city{City2a}
%   \state{State2a}
%   \postcode{Post-Code2a}
%   \country{Country2a}                   %% \country is recommended
% }
% \email{first2.last2@inst2a.com}         %% \email is recommended
% \affiliation{
%   \position{Position2b}
%   \department{Department2b}             %% \department is recommended
%   \institution{Institution2b}           %% \institution is required
%   \streetaddress{Street3b Address2b}
%   \city{City2b}
%   \state{State2b}
%   \postcode{Post-Code2b}
%   \country{Country2b}                   %% \country is recommended
% }
% \email{first2.last2@inst2b.org}         %% \email is recommended
\title{Scaling Optimization over Uncertainty via Compilation}

\author{Minsung Cho}
\orcid{0009-0006-6170-6033}
\affiliation{%
  \institution{Northeastern University}
  \city{Boston}
  \country{USA}
}
\email{minsung@ccs.neu.edu}

\author{John Gouwar}
\orcid{0000-0003-0494-7245}
\affiliation{%
  \institution{Northeastern University}
  \city{Boston}
  \country{USA}
}
\email{gouwar.j@northeastern.edu}

\author{Steven Holtzen}
\orcid{0000-0002-8190-5412}
\affiliation{%
  \institution{Northeastern University}
  \city{Boston}
  \country{USA}
}
\email{s.holtzen@northeastern.edu}
%% Abstract
%% Note: \begin{abstract}...\end{abstract} environment must come
%% before \maketitle command

%% 2012 ACM Computing Classification System (CSS) concepts
%% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10002950.10003648.10003649.10003653</concept_id>
       <concept_desc>Mathematics of computing~Decision diagrams</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10002950.10003648.10003662</concept_id>
       <concept_desc>Mathematics of computing~Probabilistic inference problems</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Mathematics of computing~Probabilistic inference problems}
\ccsdesc[500]{Mathematics of computing~Decision diagrams}
%% End of generated code


%% Keywords
%% comma separated list
\keywords{probabilistic programming languages, maximum expected utility, maximum marginal a posteriori.}  %% \keywords are mandatory in final camera-ready submission


%% \maketitle
%% Note: \maketitle command must come after title commands, author
%% commands, abstract environment, Computing Classification System
%% environment and commands, ana keywords command.

\begin{abstract}
Probabilistic inference is fundamentally hard, yet many tasks require
optimization on top of inference, which is even harder.  We present a new
\textit{optimization-via-compilation} strategy to scalably solve a certain
class of such problems.  In particular, we introduce a new intermediate
representation (IR), binary decision diagrams weighted by a novel notion of
\textit{branch-and-bound semiring}, that enables a scalable branch-and-bound
based optimization procedure. This IR automatically \textit{factorizes}
problems through program structure and \textit{prunes} suboptimal values via a
straightforward branch-and-bound style algorithm to find optima.
Additionally, the IR is naturally amenable to \textit{staged compilation},
allowing the programmer to query for optima mid-compilation to inform further
executions of the program.  We showcase the effectiveness and flexibility of
the IR by implementing two performant languages that both compile to it:
$\dappl$ and $\pineappl$.  $\dappl$ is a functional language that solves
maximum expected utility problems with first-class support for rewards,
decision making, and conditioning.  $\textsc{pineappl}$ is an imperative
language that performs exact probabilistic inference with support for nested
marginal maximum a posteriori (MMAP) optimization via staging.
\end{abstract}

\maketitle

\section{Introduction}\label{sec:introduction}

\input{sections/intro.tex}

\section{Overview}\label{sec:overview}

\input{sections/overview.tex}

\section{Optimization-via-Compilation}\label{sec:bbir}

\input{sections/optimization-by-compilation.tex}

\section{$\dappl$: A Language for Maximum Expected Utility}\label{sec:dappl}

\input{sections/dappl.tex}

\section{$\pineappl$: A Language for MMAP}\label{sec:pineappl}

\input{sections/pineappl.tex}

\section{Empirical Evaluation of $\dappl$ and $\pineappl$}\label{sec:eval}

\input{sections/eval.tex}

\section{Related Work}\label{sec:related-work}

\input{sections/related_work.tex}

\section{Conclusion and Future Work}

\input{sections/conclusion.tex}

\section*{Data Availability Statement}
The software that supports~\cref{sec:eval} is available on Zenodo~\citep{artifact}.

\section*{Acknowledgments}
We thank the anonymous reviewers for their helpful guidance.
This project was supported by the National Science Foundation under grant \#2220408.

\bibliography{meu.bib}


% Appendix
\appendix
\input{sections/appendix.tex}


\end{document}
%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: t
%%% End:
