\section{Details of experiments in \texorpdfstring{\cref{sec:experiments}}{reference}}\label{sec:details_experiments}
\subsection{Covariate shifts}

The parameters of Poisson distribution $\PP(X|E)$ for each env are:

Blue curve ($k=7$):  $[0.1,0.1,0.1,0.3,0.3 ,0.5,0.6,0.7,0.8,0.9]\times 20$.

Green curve ($k=4$): $[0.1,0.1,0.4,0.4,0.6, 0.6,0.6,0.9,0.9,0.9]\times 20$.
 
Red curve ($k=2$): $[0.1,0.1,0.1,0.1,0.1, 0.1,0.1,0.1,0.9,0.9]\times 20$.

We set the list of Poisson parameters for any env to choose from:

$[0.05, 0.1,0.15, 0.2, 0.25, 0.3, 0.35,0.4, 0.45, 0.5, 0.55, 0.6, 0.65,0.7, 0.75, 0.8, 0.85, 0.9]\times 20$.

For each $k\in [10]$, we use greedy search over all possible choices of $k$-many parameters, i.e. $\binom{18}{k}$. For each choice, we assign those $k$ parameters to the environment that has the closest estimated mean, which is the estimated $\lambda$ for Poisson distribution.

\subsection{Causal discovery without identifiability}

The 5-env data is generated by the following Gaussian parameters $(\sigma_1^2,\sigma_2^2,a)$:
\begin{align*}
    e=0:& [1, 16, 1],\\
    e=1:& [1, 16, 1],\\
    e=2:& [9, 16, 2],\\
    e=3:& [9, 25, 2.5],\\
    e=4:& [25, 25, 2.5].
\end{align*}

For the causal model $Y=a X + \epsilon$, we select the parameters from a uniformly distributed set of $8$ points spanning the range $[p_{\text{min}}, p_{\text{max}}]$ for each parameter $p\in\{(\sigma_1^2,\sigma_2^2,\gamma)\}$. For the anti-causal model $X=b Y+\epsilon$, we compute the corresponding parameters in each env that achieve the same likelihood as the ground truth causal model, and create the set of candidate parameters in the same way as the causal model.