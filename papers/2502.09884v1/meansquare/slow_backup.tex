\subsection{Slow Timescale Mean Square Convergence}\label{sec:slow_mse}
{\color{red}Make sure that the new cross analysis is reflected here. }
\begin{lemma}\label{lem:slow_mse}
    Define $\Sigma_{ss} \succ 0$ as the unique solution to the equation
    \begin{equation}
        % \Delta \Sigma_{ss} + \Sigma_{ss} \Delta^T - \bar{\gamma} \Sigma_{ss}
        \Delta \Sigma_{ss} + \Sigma_{ss} \Delta^T 
        = \Sigma_{fs} A_{fs}^T + A_{fs} \Sigma_{fs}^T + \Gamma_{ss} .         
    \end{equation}
    Under Assumptions \ref{assumption:first}--\ref{assumption:last}, there exists a problem-dependent constant $M_h > 0$ such that
    \begin{align*}
        \mathrm{Tr} Y_{t+1} 
        &
        \leq  
        % \prod_{k=1}^t \left(1 - \gamma_k \frac{\bar{\gamma}}{2}\right) \mathrm{Tr} Y_1
        % + \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} (\nu_\Delta - \bar{\gamma}) \mathrm{Tr} \Sigma_{ss} 
        % \prod_{k=1}^t \left(1 - \gamma_k \frac{\bar{\gamma}}{2}\right) \mathrm{Tr} Y_1
        % + \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} \nu_\Delta \mathrm{Tr} \Sigma_{ss} 
        % \\ & 
        % \prod_{k=1}^t \left(1 - \gamma_k \frac{\bar{\gamma}}{2}\right) \mathrm{Tr} Y_1
        % + \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} \nu_\Delta \mathrm{Tr} \Sigma_{ss} 
        % + M_h \gamma_1 \sum_{j=1}^t \alpha_j \frac{\gamma_j}{j} \left(\mathrm{Tr} C_j + \mathrm{Tr} X_j\right) .
        \prod_{k=1}^t \left(1 - \gamma_k \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_1
        + \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} \nu_\Delta \mathrm{Tr} \Sigma_{ss} 
        % \\ & 
        + M_h \gamma_1 \sum_{j=1}^t \alpha_j \frac{\gamma_j}{j} \left(\mathrm{Tr} A_{sf} C_j  + \mathrm{Tr} X_j\right) 
    \end{align*}
    In particular, we have from Lemmas \ref{lem:fast_mse} and \ref{lem:joint_mse} that there exists some $C_{ub}$ and $X_{ub}$ such that $\mathrm{Tr} C_t \leq \gamma_t \mathrm{Tr} C_{ub}$ and $\mathrm{Tr} X_t \leq \alpha_t \mathrm{Tr}X_{ub}$ and
    \begin{equation}
        % \mathrm{Tr} Y_{t+1} \leq \mathcal{O}\left(
        %     \prod_{k=1}^t \left(1 - \gamma_k \frac{\bar{\gamma}}{2}\right) \mathrm{Tr} Y_1
        %     + \gamma_t \mathrm{Tr} \Sigma_{ss} + \alpha_t \gamma_t \left(\gamma_t \mathrm{Tr}C_{ub} + \alpha_t \mathrm{Tr}X_{ub}\right) 
        % \right) .
        \mathrm{Tr} Y_{t+1} \leq \mathcal{O}\left(
            \prod_{k=1}^t \left(1 - \gamma_k \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_1
            + \gamma_t \frac{\nu_\Delta}{\mu_\Delta} \mathrm{Tr} \Sigma_{ss} + \alpha_t \gamma_t (\alpha_t \mathrm{Tr} \Sigma_{ff} + \gamma_t \mathrm{Tr} \Sigma_{fs} A_{sf}^T) 
        \right) .
    \end{equation}
\end{lemma}

Start from the same slow iterate's recursion as above:
\begin{equation}
    \hat{y}_{t+1} = (I - \gamma_t \Delta) \hat{y}_t + \gamma_t A_{sf} L_t \hat{y}_t - \gamma_t A_{sf} \tilde{x}_t + \gamma_t V_t .
\end{equation}
Expanding the covariance on both sides,
\begin{align*}
    Y_{t+1} &= Y_t - \gamma_t {\color{blue}(\Delta Y_t + Y_t \Delta^T)} + \gamma_t^2 (\Delta Y_t \Delta^T)
    \\
    &
    + \gamma_t \left((I - \gamma_t \Delta) Y_t L_t^T A_{sf}^T + ((I - \gamma_t \Delta) Y_t L_t^T A_{sf}^T)^T\right)
    \\ & 
    - \gamma_t \left( ({\color{blue}I} - \gamma_t \Delta) C_t^T A_{sf}^T + (({\color{blue}I} - \gamma_t \Delta) C_t^T A_{sf}^T)^T\right)
    \\
    &+ \gamma_t^2 A_{sf} L_t Y_t L_t^T A_{sf}^T
    - \gamma_t^2 \left(A_{sf} L_t C_t^T A_{sf}^T + (A_{sf} L_t C_t^T A_{sf}^T)^T\right) 
    \\
    &+ \gamma_t^2 A_{sf} X_t A_{sf}^T 
    + {\color{blue}\gamma_t^2 \Gamma_{ss} } .
\end{align*}
Grouping terms by magnitude as done previously, listed in decreasing size,
\begin{align*}
    Y_{t+1} &= Y_t
    - \gamma_t \left(\Delta Y_t + Y_t \Delta^T - (C_t^T A_{sf}^T + A_{sf} C_t) - \gamma_t \Gamma_{ss}  \right)
    + \frac{\gamma_t^2}{\alpha_t} H_t (Y_t) ,
\end{align*}
where $H_t$ is the remainder terms and is affine in $Y_t$.
Using the definition of $\Sigma_{ss}$ that solves Eq. \eqref{eq:slow_covariance} to substitute for $\Gamma_{ss}$, we have from Lemma \ref{lem:cross} that






{\color{red}Check transpose and ordering of matrices above, e..g dimension mismatch}
\begin{align*}
    C_t^T A_{sf}^T + A_{sf} C_t + \gamma_t \Gamma_{ss}
    = 
    \gamma_t \left(\Delta \Sigma_{ss} + \Sigma_{ss} \Delta^T\right) - (\gamma_t\Sigma_{fs} - C_t)^T A_{sf}^T - A_{sf} (\gamma_t \Sigma_{fs} - C_t) .
\end{align*}
Denoting $M_h > 0$ to be the constant such that
\begin{equation}
    \mathrm{Tr} H_t (Y_t) \leq M_h \left(\mathrm{Tr} Y_t + \alpha_t \mathrm{Tr} A_{sf} C_t  + \alpha_t \mathrm{Tr} X_t \right) ,
\end{equation}
we then have 
\begin{align*}
    \mathrm{Tr} Y_{t+1} 
    &\leq 
    \left(1 - \gamma_t \mu_\Delta + \frac{\gamma_t^2}{\alpha_t} M_h\right) \mathrm{Tr} Y_t 
    + \gamma_t^2 \nu_\Delta \mathrm{Tr} \Sigma_{ss}
    - 2 \gamma_t \mathrm{Tr} A_{sf} (\gamma_t \Sigma_{fs} - C_t)
    \\ &
    + \gamma_t^2 M_h \left( \mathrm{Tr} A_{sf} C_t + \mathrm{Tr} X_t\right) 
    \\ 
    & 
    \leq \left(1 - \gamma_t \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_t 
    + \gamma_t \nu_\Delta \mathrm{Tr} \Sigma_{ss}
    \\
    &+ 2\gamma_t d \lVert A_{sf} (\Sigma_{fs} - C_t)\rVert 
    +\gamma_t^2 M_h (d \lVert A_{sf} C_t \rVert + M_{f}''(\alpha_t \mathrm{Tr} \Sigma_{ff} + \gamma_t)
    .
\end{align*}
{\color{red}Plug in the appropriate bounds.
Here, I need to show that $\gamma_t \mathrm{Tr} A_{sf} (\gamma_t \Sigma_{fs} - C_t)$ decays faster than $\gamma_t^2$ so that we can an error on $Y_t$ to be dominant in $\mathrm{Tr} \Sigma_{ss}$.
Therefore, I need to use an upper bound on the difference, not just upper bound on $C_t$.
To do this, I need a refined bound on $C_t$.

Finish up below and remove unnecessary parts. 
}

By induction (up to multiplicative factors subsumed into $M_h$) and applying Proposition \ref{prop:induction_size},
\begin{align*}
    \mathrm{Tr} Y_{t+1} 
    &
    \leq  
    \prod_{k=1}^t \left(1 - \gamma_k \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_1
    + \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} \nu_\Delta \mathrm{Tr} \Sigma_{ss} 
    % \\ & 
    + M_h \gamma_1 \sum_{j=1}^t \frac{\gamma_j}{j} \left(\mathrm{Tr} A_{sf} C_j  + \mathrm{Tr} X_j\right) 
    \\
    & \leq 
    \prod_{k=1}^t \left(1 - \gamma_k \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_1
    + \gamma_t \frac{4\nu_\Delta}{b \mu_\Delta}  \mathrm{Tr} \Sigma_{ss} 
    % \\ & 
    + M_h \frac{4}{\mu_\Delta} \gamma_t \left(\gamma_t \mathrm{Tr} A_{sf} \Sigma_{fs}  + \alpha_t \mathrm{Tr} \Sigma_{ff} 
    % {\color{red}+\frac{\gamma_t^2}{\alpha_t} }
    \right) 
    ,
\end{align*}
The last step uses Lemmas \ref{lem:fast_mse} and \ref{lem:joint_mse} that $\mathrm{Tr} A_{sf} C_t , \mathrm{Tr} X_t$ are uniformly bounded by a constant multiple of $\gamma_t \mathrm{Tr} \Sigma_{fs}$ and $\alpha_t \mathrm{Tr} \Sigma_{ff}$.
Using the $\mathcal{O}$--notation to cover some constants,
\begin{equation}
    \mathrm{Tr} Y_{t+1} \leq \mathcal{O}\left(
        \prod_{k=1}^t \left(1 - \gamma_k \frac{\mu_\Delta}{2}\right) \mathrm{Tr} Y_1
        + \gamma_t \frac{\nu_\Delta}{\mu_\Delta} \mathrm{Tr} \Sigma_{ss} + \gamma_t (\alpha_t \mathrm{Tr} \Sigma_{ff} + \gamma_t \mathrm{Tr} A_{sf} \Sigma_{fs}
        % {\color{red}+\frac{\gamma_t^2}{\alpha_t} }         
        ) 
    \right) .
\end{equation}



\textbf{Lower Bound:} Holds for the same choice of step size. {\color{red}Refine below:}
We start from Eq. \eqref{eq:slow_identity}: Using that $h_t (Y_t) \leq M_h \mathrm{Tr} Y_t$ and that there exists a $\Sigma_t^{ss}$ that satisfies
\begin{align*}
    \mathrm{Tr}\left( \Delta Y_t + Y_t \Delta^T - (C_t A_{sf}^T + A_{sf} C^T + \gamma \Gamma)\right)
    \leq \nu_\Delta \mathrm{Tr} - \gamma_t \mu_\Delta \mathrm{Tr} \Sigma^t_{ss} 
\end{align*}
for every $t$.
Therefore,
\begin{align*}
    \mathrm{Tr}Y_{t+1} &= \mathrm{Tr} Y_t - \gamma_t \mathrm{Tr}\left(\Delta Y_t 
    + Y_t \Delta^T - (A_{sf} C_t + C_t^T A_{sf}^T) - \gamma_t \Gamma_{ss}  \right)
    + \frac{\gamma_t^2}{\alpha_t} h_t (Y_t) ,   
    \\ &
    \geq \left(1 - \gamma_t \nu_\Delta + \frac{\gamma_t^2}{\alpha_t} M_h \right) \mathrm{Tr} Y_t
    + \gamma_t \mu_\Delta \mathrm{Tr} \Sigma^{ss}_t 
    -  \gamma_t^2 \lvert M_h \left(\mathrm{Tr} A_{sf} C_t + \mathrm{Tr} X_t\right) \rvert .
\end{align*}
Again we assume WLOG that $\gamma_t \nu_\Delta - \frac{\gamma_t^2}{\alpha_t} M_h \geq \gamma_t \nu_\Delta / 2$ and use that $\mathrm{Tr} A_{sf} C_t + \mathrm{Tr} X_t = \mathcal{O}(\gamma_t + \alpha_t)$ to obtain
\begin{align*}
    \mathrm{Tr} Y_{t+1} \geq \left(1 - \gamma_t \frac{\nu_\Delta}{2}\right) \mathrm{Tr} Y_t + \gamma_t \mu_\Delta \mathrm{Tr} \Sigma_{ss}
    - \gamma_t \mu_\Delta \mathrm{Tr}(\Sigma_t^{ss} -  \Sigma_{ss}) - \gamma_t^2 \lvert M_h (\gamma_t C_\infty + \alpha_t X_\infty) \rvert ,
\end{align*}
where $C_\infty, X_\infty$ are uniform bounds on $\gamma_t \mathrm{Tr} C_t, \alpha_t \mathrm{Tr} X_t$.
{\color{red}If the above is correct, then we should get a lower bound that matches from this. }
