\subsection{Feature Extraction} \label{sec:feature}

The next step involves extracting relevant features from the superpixels, which will be used in the subsequent graph construction step. In this work, we adopt the feature extraction approach outlined by \citet{sellars2020} for superpixels.

For each superpixel \( S_i \), we extract three distinct types of features to enhance spatial and contextual information.  

1. \textbf{Mean Feature Vector (\(\vec{S}_i^m\))}:  
   To capture localized spatial information, we apply a mean filter to each superpixel, computing the mean feature vector as:  
   \begin{equation} \label{equ:mean_filter}
       \vec{S}_i^m = \frac{\sum_{j=1}^{n_i} \hat{I}(p_{i, j})}{n_i}.
   \end{equation}  

2. \textbf{Weighted Feature Vector (\(\vec{S}_i^w\))}:  
   To incorporate spatial relationships between neighboring superpixels, we compute a weighted combination of the mean feature vectors of adjacent superpixels. Adjacency is determined using 4-connectivity (left, right, up, and down) within the image grid. For each superpixel \( S_i \), let \( \zeta_i = \{z_1, z_2, \dots, z_J\} \) denote the set of indices of its \( J \) adjacent superpixels. The weighted feature vector is then given by:  
   \begin{equation} \label{equ:weighted_filter}
       \vec{S}_i^w = \sum_{j=1}^{J} w_{i, z_j} \vec{S}_{z_j}^m,
   \end{equation}  
   where the weight \( w_{i, z_j} \) between adjacent superpixels is computed using a softmax function:  
   \begin{equation} \label{equ:weight_softmax}
       w_{i, z_j} = \frac{\exp\left(-\|\vec{S}_{z_j}^m - \vec{S}_i^m\|_2^2 / h\right)}{\sum_{j=1}^{J} \exp\left(-\|\vec{S}_{z_j}^m - \vec{S}_i^m\|_2^2 / h\right)},
   \end{equation}  
   where \( h \) is a predefined scalar parameter.  

3. \textbf{Centroid Location (\(\vec{S}_i^p\))}:  
   Finally, to encode spatial positioning, we compute the centroid location of each superpixel as:  
   \begin{equation} \label{equ:centroid}
       \vec{S}_i^p = \frac{\sum_{j=1}^{n_i} p_{i, j}}{n_i}.
   \end{equation}