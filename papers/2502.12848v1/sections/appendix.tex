\input{sections/summary_tab}

We summarize the results we achieved on the various analyzed protocols.

\myparagraph{Simple authentication protocol} \cref{tab:simpleauth} reports the results on all the variants of the simple authentication protocol of \cref{ex:simpleprotocol}.
Variants subject to the same assumptions are grouped in the same row  of the table, with assumptions relating to three security properties: \lstinline|noninjective_agreement|, \lstinline|injectivity|, and \lstinline|injective_agreement|. We first notice that, for all protocol variants, \lstinline|injectivity| never depends on key secrecy, as it is solely related to nonce freshness. In fact, if \lstinline|Na| uniquely originates, then there exists only one unique initiator agreeing on \lstinline|Na|.

In the first row, we consider the protocol variants in which the responder is challenged to encrypt the nonce. They base \lstinline|noninjective_agreement| on the impossibility for the Dolev-Yao penetrator to forge the protocol key \lstinline|SK A B| and require nonce freshness only for \lstinline|injectivity| and \lstinline|injective_agreement|.

In the second row, we consider the proofs of security for \lstinline|SimpleAuth|, \lstinline|SimpleAuthWithB| and their composition, under the maximal penetrator. In this case, \lstinline|noninjective_agreement| holds for all penetrators that cannot forge either \lstinline|SK A B| or the ciphertext but can, for example, decrypt any ciphertexts even without knowing the encryption keys. Interestingly, this confirms that these protocols do not base their security on the secrecy of ciphertexts but only on their integrity. These security results are strictly stronger than the previous ones, which are based on the Dolev-Yao attacker, and for this reason, they enable compositional proofs of security. Nonce freshness is necessary for both \lstinline|injectivity| and \lstinline|injective_agreement|.

For the third and fourth rows, since \lstinline|SimpleAuthDual| and \lstinline|SimpleAuthDualBProtected| rely on decryption, nonce freshness is necessary even for \lstinline|noninjective_agreement| to prevent a trivial attack where the penetrator guesses the nonce and correctly responds to the challenge. As for the previous cases, nonce freshness is necessary for both \lstinline|injectivity| and \lstinline|injective_agreement|. Finally, for \lstinline|SimpleAuthDualBProtected|, the variant in which \lstinline|B| is sent in the clear together with the encrypted challenge in the initiator's message (see \cref{sec:newproofs}), we also need to assume that \lstinline|B <> Na|, since otherwise, the nonce would be leaked by the initiator, breaking authentication. Once again, this highlights the strength of the strand spaces model, which enables reasoning about protocol security and identifying the necessary assumptions for their security.



\myparagraph{Needham-Schroeder-Lowe protocol} \cref{tab:nsl} summarizes the assumptions for the NSL protocol, which align with those in the original paper \cite{FHG98}. Notice that the notion of injective agreement in \cite{FHG98}, noted as \lstinline|injective_agreement_orig| in the table, is in some sense dual to the standard formulation in the literature. For example, for the responder guarantee, it is required that exactly one initiator exists who agrees on \lstinline|A|, \lstinline|B|, \lstinline|Na|, and \lstinline|Nb| (see Proposition 4.8 in \cite{FHG98}). This requires the freshness of \lstinline|Na|, which should not be part of the responder guarantees and, in fact, is not necessary to prevent replay attacks.

Usual formalizations of injective agreement impose the opposite requirement: whenever the responder completes the protocol, at least one initiator must exist, and this initiator's run should match with only one responder run. In other words, there should be exactly one responder for each protocol session (see, e.g., \cite{tamarinmanual}). We have adopted this notion for the simple authentication protocol and have also proved it for NSL, with the corresponding proofs reported in the table under \lstinline|injectivity| and \lstinline|injective_agreement|.

In particular, we observe that \lstinline|injectivity| only requires the freshness of the corresponding nonce, whereas \lstinline|injective_agreement| requires the same assumptions as \lstinline|noninjective_agreement|, unlike \lstinline|injective_agreement_orig|, which is always more demanding. As observed in \cite{FHG98}, we also find that the authentication guarantee for the responder relies solely on the secrecy of the private key of $A$, while the authentication guarantee for the initiator requires the secrecy of both private keys. The same holds for secrecy.





