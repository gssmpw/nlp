\section{Case Study on SafeSPLE}
We now demonstrate via a case study one way to implement a SafeSPL and parameterized safety cases.  The first part of our process is a hazard analysis. We then build a feature model. The features are then used to parameterize our safety case. Lastly, we can generate safety-case instances as requested for any of the concrete combinations of features.  

\subsection{Hazard Analysis}
To begin the SafeSPLE process for a UAS flight, we analyze the hazards of that flight, which is an important first step before creating a safety case \cite{Knig12}. A hazard is a state or event that can potentially result in an accident \cite{ericson2015hazard}. In this work, we do not describe this part of the process in depth but rather list a few of the key hazards we identified. We utilized several sources to create our list of hazards. First, we referenced several papers describing hazard analysis or safety cases for sUAS flights \cite{denpai2016, clodenpai2017, sora}. Next, we discussed sUAS hazards with colleagues and experts who have studied sUAS and flown them. This investigation gave us an extensive list of hazards, which was too long and broad to include in this paper. We narrowed down this extensive list to focus on the following hazards. 

\begin{itemize}
    \item Too much precipitation
    \item Insufficient visibility
    \item Temperatures outside the operating specifications of the sUAS
    \item Wind gusts outside the operating specifications of the sUAS
    \item Insufficient battery for the mission
\end{itemize}

The hazards above are not intended to be fully described or defined, and we do not include prevention or recovery controls or escalation factors for any of these hazards (see \cite{denpai2016} for a more in-depth discussion of hazard analysis). The ultimate consequences of each of the above hazards are generally either loss of separation from the ground or loss of separation from other air traffic. Either of these consequences could lead to the destruction of property, injury, or death. A complete risk analysis of these consequences is likewise beyond the scope of this paper. We illustrate our family-based approach below using a subset of the identified hazards in order to show how the parameterized safety case addresses the hazards for different sUAS.       

\subsection{Feature Model}

\begin{figure}[ht]
    \centering
    \includegraphics[width=.8\textwidth]{Figures/safety-case-blow-up.pdf}
    \caption{Two parts of the feature model that we focus on for this case study.}
    \label{fig:feature_model_focus}
\end{figure}

The next step in the SafeSPLE process is to create a partial feature model that could apply to a wide variety of sUAS models and missions in controlled airspace as described in Section \ref{sec:SafeSPLE} and Figure \ref{fig:featuremodel}. Since this feature model includes information about the pilot, airspace, mission, vehicle, and weather (among other things), it allows for a wide variety of different types of parameters to be used in our parameterized safety case. In figure \ref{fig:feature_model_focus} we show the two parts of the feature model that are the focus of our safety cases here - the pilot and the weather. These parameterized safety cases are described in the next section. 


\subsection{Parameterized Safety Case}

\begin{figure}[ht]
    \centering
    \includegraphics[width=.7\textwidth]{Figures/pilot_only.pdf}
    \caption{Pilot Safety Case: A safety case based only on whether the pilot is certified and has sufficient experience.}
    \label{fig:pilot_only}
\end{figure}

The next step in our case study (based on SafeSPLE) is to create two illustrative parameterized safety cases for our controlled airspace. The first safety case, seen in Figure \ref{fig:pilot_only}, is based solely on the pilot. It checks whether the pilot is certified and has sufficient flight hours. We assume that in non-commercial airspaces, flight regulations would trust a certified pilot with sufficient reputation (i.e., no significant history of problems) to perform safety checks consistent with the lower-level details of our safety cases. In other words, the pilot is in charge of ensuring a safe flight in whatever airspace they are in. Regulators often do not exclude pilots legally allowed to be in the airspace unless there is some serious prior issue \cite{FAA_TRUST, FAA_part107}. So it is our belief that any UAS Traffic Management system will likely allow certified pilots to enter the airspace unless it has some reason not to.

As shown in Figure \ref{fig:pilot_only}, our safety case checks to see if the pilot is certified to fly their sUAS, here represented using the FAA's Part 107 certification \cite{FAA_part107}. We also check to see if the pilot has sufficient flight hours to be competent to complete this flight, which is something that our managed airspace should know.  In the future, this flight-hours check might be replaced or augmented with different checks, such as the pilot's score on a competency-reputation metric, future certifications, or temporary notices to pilots that the FAA might put out. If evidence of these checks confirms that the pilot is certified and has sufficient experience to enter the controlled airspace, the associated strategy node (S1) in the safety case is satisfied.

\begin{figure}[ht]
    \centering
    \includegraphics[width=\columnwidth]{Figures/wind_only.pdf}
    \caption{Wind Safety Case: A parameterized safety case based only on the weather and the drone's capabilities. This safety case creates the instances seen in Figures \ref{fig:instance_1} and \ref{fig:instance_2}.}
    \label{fig:wind_only}
\end{figure}

Our second safety case is relevant when the pilot lacks the evidence required to satisfy our initial safety case above. There needs to be an opportunity for newer pilots to learn and fly if such flights can be done safely. Thus, our second safety case focuses on giving such pilots the information that they will need in order to complete a safe flight. This second safety case (Figure \ref{fig:wind_only}) focuses on the weather because poor weather is a common reason for a pilot to decide that a flight will not be safe or for in-flight failures \cite{weather_hazards_for_UAV}. The weather portion of the feature model also has several parameters that can map to portions of our safety case. This sort of weather-focused safety case would normally involve far more attributes than we show in Figure \ref{fig:wind_only}, but we focus only on the weather and a small amount of information (evidence) about the battery here.

In the wind safety case from Figure \ref{fig:wind_only}, we constructed a general safety case that involves a number of parameters that are found in our feature model. These parameters are indicated using square brackets, such as [Precipitation] and [UASAllowedPrecipitation]. The data types of each parameter are left intentionally vague, as there are a number of ways for these parameters to be stored. We assume that information about each [Vehicle] is publicly available and that published sUAS specifications can be converted into the same data format and type that the feature model and safety case parameters have. If a [Vehicle] does not contain information in its specifications for certain parameters, then there is an option to assume some default values that could apply to almost all drones. 

For instance, most sUAS specifications will include information about the maximum allowed wind speed within which the manufacturer states the sUAS can operate. Likewise, most sUAS specifications include both maximum and minimum allowed temperatures in which to operate (often from -10 \textcelsius \;or 0 \textcelsius \;up to 40 \textcelsius) \cite{DEERCD20, DJI_MiniPro_4_Specs}. Fewer sUAS specifications contain specific information about visibility requirements since those depend on the type of mission being flown, especially whether it needs to be flown in a visual line of sight (VLOS) or beyond a visual line of sight (BVLOS). If the pilot does not provide visibility requirement information, we thus assume that the flight must take place VLOS and proceed accordingly. Similarly, if no information is provided about an sUAS's ability to fly in various forms of precipitation, we assume that the sUAS can only operate with no precipitation. 

Note that in the wind safety case (Figure \ref{fig:wind_only}), many of the goals share a similar structure. For instance, "The forecast precipitation is within acceptable level..." and "The forecast visibility is within acceptable levels...". The repetition of these elements is intentional and allows for greater ease of human understanding of the safety case, as well as for simpler extension of the safety case when we add additional hazards we need to mitigate. 

Some of the values of the parameters in the safety case may not be available at the time of a flight request. For instance, if a pilot is applying to complete a flight several weeks or months in the future, the forecast weather conditions will be unreliable. In such a case, the safety case might not contain concrete values until closer to the flight. The pilot could still access the parameterized safety case in order to study the safety requirements for the flight. As the time of the flight approaches, a more fully instantiated safety case could be sent to the pilot. 

The information for instantiating these parameterized safety cases will need to be pulled from a variety of sources, such as publicly available weather data and manufacturers' specifications for commercially available sUAS. However, some of the parameters' information will need to come from the pilot, including their certification status, the sUAS model they will fly, their flight plan, and any additional sUAS capabilities they have added (such as detect-and-avoid systems). 
In the event that the sUAS being flown was completely home-built, there may be no public documentation of its abilities, and all of its specifications will need to be provided (or inferred) by the pilot. 
Therefore, some of the individual safety cases will necessarily contain a fair amount of uncertainty while still serving as a guideline for the pilot. 


\subsection{Instances}
As a final step in our SafeSPLE process, we demonstrate how to create instances of our parameterized safety case. This process involves obtaining the information required for all parameters and checking if all the solution nodes of the safety case remain true. In all of the safety case diagrams in Figures \ref{fig:pilot_only}, \ref{fig:wind_only}, \ref{fig:instance_1}, \ref{fig:instance_2}, these solution nodes are the bottom nodes labeled E1-E6, and have propagated from the context. If any solution node becomes false, then we can say that the pilot should either reconsider the flight, or should implement further mitigations to reduce the risk from the relevant hazard. For instance, if the safety case shows that the current wind gusts are too high, the pilot might delay the flight until the wind calms, or the pilot might decide to make the flight with a larger and more capable UAS (if available).

\begin{figure}[ht]
    \centering
    \includegraphics[width=.95\textwidth]{Figures/Instance_1.pdf}
    \caption{Safety Case Instance 1: An instance of the wind safety case (Figure \ref{fig:wind_only}) based on a mission with a DJI Mini 4 Pro drone.}
    \label{fig:instance_1}
\end{figure}

The first instance of our parameterized safety case is shown in Figure \ref{fig:instance_1}. This mission will be performed by a DJI Mini 4 Pro, a widely available drone that currently sells for just over \$1000, depending on accessories. The Mini 4 Pro is fully charged, and the mission, as planned, should take 16 minutes, flown entirely within VLOS of the pilot. This information about battery charge and the mission plan is provided by the pilot. The wind is gusting up to 6 meters/sec, with temperatures in the mid 20s \textcelsius, unlimited visibility, and no precipitation. This weather information is provided to the safety case by a commercial or governmental weather service. 

Once we obtain the information about the make and model of the drone, we can look up the DJI's published specifications. According to DJI \cite{DJI_MiniPro_4_Specs}, the Mini 4 Pro is able to fly in wind speeds up to 10 m/s, and with a fully charged battery can fly up to 34 minutes. The Mini 4 Pro can operate in temperatures between -10 \textcelsius \;and 40 \textcelsius. Using all this information, we can instantiate the safety case seen in Figure \ref{fig:instance_1}. Note that every solution node 
(labeled E1-E6) is satisfied by the above information. There is no precipitation; visibility is unlimited; the temperatures are not too hot or cold; the wind gusts are below the max allowed for the drone; and the battery reserves are more than twice as much as needed. So in this instance of the safety case the the top-level goal is satisfied. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=.95\textwidth]{Figures/Instance_2.pdf}
    \caption{Safety Case Instance 2: An instance of the wind safety case (Figure \ref{fig:wind_only}) based on a mission with a DEERC D20 drone. Note that this instance fails to fulfill our safety requirements at node E4 (marked in darker red).}
    \label{fig:instance_2}
\end{figure}
%Nice examples!

In Figure \ref{fig:instance_2} we can see a second instance of our safety case. This mission will be performed by a DEERC D20 drone, another widely available drone that currently sells for around \$50. The D20 is also fully charged, and the planned mission will only take 5 minutes of flying, entirely within VLOS. The wind is gusting up to 8 m/s, with temperatures in the mid-30s \textcelsius, 3 km visibility, and no precipitation.

According to the DEERC documentation \cite{DEERCD20}, the D20 drone is capable of about 10 minutes of flight time in temperatures between 0 \textcelsius \ and 40 \textcelsius. However, the D20 documentation does not specify the maximum speed of the winds that the drone is capable of flying in. Instead, the documentation reads, "DO NOT use this drone in adverse weather conditions such as rain, snow, fog, and wind." Therefore the safety case takes a conservative approach and assigns a default value of 3 m/s to the variable [MaxAllowedWindSpd] (3 m/s is slightly less than 7 mph). This default value could, of course, be set to 0 m/s, although this seems unrealistic for most outdoor flying. Other default values might be justified.

Plugging in all of these values, we see that while most solution nodes are satisfied, the current wind conditions (gusts up to 8 m/s) do not allow for a safe flight with the D20 (default max wind speed of 3 m/s). In Figure \ref{fig:instance_2}, this is shown at solution node E4, which is colored a darker red than the other solution nodes. The safety case is designed to serve as input to the UTM on-entry decision. At this point there are two main options for how the UAS Traffic Manager could behave. The UTM could refuse entry to this pilot until the wind speed is lower, or the UTM could send the safety case to the pilot with the recommendation that the pilot make modifications to the flight plan while leaving the ultimate flight decision up to the pilot.

Creating instances of safety cases with SafeSPL should be quick and relatively straightforward, if the information it needs is available. If information on the drone's capabilities is lacking, default values can still allow the safety case to create a reasonable instance. If information about the weather is unknown, then those portions of the safety case can be left uninstantiated until more detailed information becomes available. At the very least, we can generate a partially instantiated safety case so the pilot can see the areas where information is lacking or is based on default values. This information could allow the pilot to focus on mitigation measures in those areas if needed. 

\subsection{Connecting to Safe Entry}
\label{sec:safe_entry}

The parameterized safety cases created by SafeSPLE and described above could play an important role in a to-be-developed UTM system. When a pilot requests permission to fly in the airspace controlled by the UTM, the information needed to instantiate the safety case is either submitted by the pilot or looked up by the UTM system. Once a safety case has been created for that flight, there are at least two options for what the UTM system might do with it. 

\begin{enumerate}
    \item Closed Access: The UTM system accepts or denies requests based on whether each generated safety case "passes" or "fails". In other words, if the safety case goals are not satisfied, the UTM system  denies the flight. 
    \item Open Access: The UTM system accepts or denies the flight based solely on whether the pilot is certified or trusted. The safety case then becomes a guideline that can be provided to the pilot as something of a checklist to encourage a safer flight.
\end{enumerate}

Which action the UTM should take is an ongoing discussion with no immediate correct answer.
Currently the regulations in the US appear to generally favor approach (2), the open-access model. Regardless of which approach is taken for a specific controlled airspace, we believe the use of SafeSPLE will generate valuable on-the-fly information.  This information may offer an effective and useful checklist for decision-making. 
