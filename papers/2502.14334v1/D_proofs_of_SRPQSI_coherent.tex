\section{Proof of Theorem \ref{thm:alg_SRPQSI_coherent}}
\label{sec:proof_alg_SRPQSI_coherent}

    By the definition of $w(\cdot,\cdot)$ and the definition of $\Delta_{(\cdot)}$, we have
    \begin{equation*}
        \begin{aligned}
            & \mathbb{P}(w({\rho^\star,k}) \leq w({\rho_{(i)},k})) \\
            = & \mathbb{P}\left( (w(\rho_{(i)},k) -  w(\rho^\star,k))  \geq \frac{\Delta_{(i)}}{2}\right).
        \end{aligned}
    \end{equation*}
    Since $x_{(\cdot,\cdot)} \in [0,1]$ and Hoeffding's inequality, we have
    \begin{equation}
        \begin{aligned}
            & \mathbb{P}\left( (w(\rho_{(i)},k) -  w(\rho^\star,k))  \geq \frac{\Delta_{(i)}}{2}\right) \\
            \leq & \exp\left(- \frac{N_k}{2} \left(\frac{\Delta_{(i)}}{2}\right)^2 \right) \\
            \leq & \exp\left( - \frac{N_k \Delta^2_{(i)}}{8}\right).
        \end{aligned}
    \end{equation}

    By a union bound of error probability, we have 

    \begin{equation} \label{eq2:err_upper1}
        \begin{aligned} 
            e_n & \leq \sum_{k=1}^{K-1}\sum_{i = K+1-k}^K \mathbb{P}(w({\rho^\star,k}) \leq w({\rho_{(i)},n_k})) \\
            & \leq \sum_{k=1}^{K-1}\sum_{i = K+1-k}^K \exp\left( - \frac{N_k \Delta^2_{(K+1-k)}}{8}\right) \\
            &  \leq \sum_{k=1}^{K-1} k \exp\left( - \frac{N_k \Delta^2_{(K+1-k)}}{8}\right). \\
        \end{aligned}
    \end{equation}
    By definition of $N_k$, we have
    \begin{equation} \label{eq2:err_upper2}
        \begin{aligned}
             N_k \Delta^2_{(K+1-k)} 
            =  \left\lceil \frac{1}{\overline{\log}(K)} \frac{N-K}{K+1-k}\right\rceil\Delta^2_{(K+1-k)} 
            \leq  \frac{N-K}{\overline{\log}(K)} \times \frac{\Delta^2_{(K+1-k)}}{K+1-k}. 
        \end{aligned}
    \end{equation}
    Combining equation \eqref{eq2:err_upper1} and \eqref{eq2:err_upper2}, we have
    \begin{equation*}
        \begin{aligned}
            e_n & \leq \sum_{k=1}^{K-1} k \exp\left( - \frac{N-K}{8\overline{\log}(K)} \times \frac{\Delta^2_{K+1-k}}{K+1-k}\right) \\
            & \leq \frac{K(K-1)}{2} \exp\left(-\frac{NH_2}{8\overline{\log}(K)}\right),
        \end{aligned}
    \end{equation*}
    where $H_2 = \min_{i \in \{1,...,K\}} \frac{\Delta^2_{(i)}}{i}$.