\input{plots/pgfplots-config.tex}
\noindent%
\begin{tikzpicture}
\pgfplotsset{cycle list/Set1-5}
\begin{groupplot}[
	group style = {
		group size = 3 by 1,
		horizontal sep=2mm,
		vertical sep=17mm,
	},
	colormap/Dark2,
	colormap/Paired,
	colormap/Set2,
	title style={at={(0.5,0.9)}},
	ymin=0, ymax=100,
]

\nextgroupplot[
	width={215pt}, 
	title={\mirage (top 10)},
	ybar=0.5pt, bar width=5pt, 
	legend columns=-1,
	legend style={fill=none, at={(1,1.2)}},
	xlabel={Question set},
	xlabel style={at={(1,-0.25)}},
	ylabel={Mean recall},
	y unit={\%},
	symbolic x coords={{pubmedqa},{medqa},{bioasq},{medmcqa},{mmlu}},
	xtick=data,
	xticklabels={{pubmedqa},{medqa},{bioasq},{medmcqa},{mmlu-med}},
	every axis plot/.append style={fill,draw=none,no markers},
	cycle list name=Paired,
	enlarge x limits=0.15,
]


\foreach \qa in {statpearls,wikipedia,textbooks,pubmed,routing}{
\addplot+[%
]
table[	col sep=comma, x={Corpus}, y={\qa}, 
]
{raw_data/recall_top_10_transpose.csv};
}

\legend{statpearls,wikipedia,textbooks,pubmed,\textbf{\sys}}


\nextgroupplot[
	width={215pt}, 
	title={\mirage (top 32)},
	ybar=0.5pt, bar width=5pt, 
	symbolic x coords={{pubmedqa},{medqa},{bioasq},{medmcqa},{mmlu}},
	xtick=data,
	xticklabels={{pubmedqa},{medqa},{bioasq},{medmcqa},{mmlu-med}},
	yticklabels={\empty},
	every axis plot/.append style={fill,draw=none,no markers},
	cycle list name=Paired,
	enlarge x limits=0.15,
]

\foreach \qa in {statpearls,wikipedia,textbooks,pubmed,routing}{
	\addplot+[%
	]
	table[	col sep=comma, x={Corpus}, y={\qa}, 
	]
	{raw_data/recall_top_32_transpose.csv};
}


\nextgroupplot[
	width={162.1pt},
	xshift={4mm},
	title={MMLU},
	ybar=0.5pt, bar width=5pt, 
	legend columns=-1,
	legend style={fill=none, at={(0.5,1.2)}},
	every axis plot/.append style={fill,draw=none,no markers},
	cycle list name=Dark2,
	enlarge x limits=0.3,
	xtick={0,3,6,9},
]

\foreach \qa in {{Node 0},{Node 1},{Node 2},{Node 3},{Node 4},{Node 5},{Node 6},{Node 7},{Node 8},{Node 9}}{
	\addplot+[index of colormap={1 of Paired}, forget plot,
	bar shift=0.4pt, 
	]
	table[	col sep=comma, x expr={\coordindex}, y expr={100*\thisrow{Recall}}, 
	discard if not={Cluster}{\qa},
	]
	{raw_data/recall_wiki.csv};
}

\foreach \qa in {{Node 9}}{
	\addplot+[index of colormap={1 of Paired}, 
	bar shift=0.4pt, 
	]
	table[	col sep=comma, x expr={\coordindex}, y expr={100*\thisrow{Recall}}, 
	discard if not={Cluster}{\qa},
	]
	{raw_data/recall_wiki.csv};
}
\addlegendentry{Data sources 0-9}

\foreach \qa in {{RagRoute}}{
	\addplot+[index of colormap={4 of Paired}, 
	bar shift=0.4pt, 
	]
	table[	col sep=comma, x expr={\coordindex}, y expr={100*\thisrow{Recall}}, 
	discard if not={Cluster}{\qa},
	]
	{raw_data/recall_wiki.csv};
	\addlegendentry{\textbf{\sys}}
}



\end{groupplot}


\end{tikzpicture}
