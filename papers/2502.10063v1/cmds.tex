\newcommand*{\fun}{\NewDocumentCommand}
\AtBeginDocument{
  \catcode`_=12
  \begingroup\lccode`~=`_
  \lowercase{\endgroup\let~}\sb
  \mathcode`_="8000
}


\newcommand{\orcid}[1]{\href{https://orcid.org/#1}{\textcolor[HTML]{A6CE39}{\includegraphics[width=1.7ex]{ORCID-iD_icon-128x128.eps}}}}

\newcommand*{\threefrac}[3]{%
  \begin{array}{@{\,}c@{\,}}%
    #1\\
    \hline
    #2\\
    \hline
    #3%
  \end{array}%
}

\newcommand*{\Figure}{Fig.\xspace}
\newcommand*{\figs}{Figs.\xspace}
\newcommand*{\fig}[1]{\Figure \ref{#1}}
\newcommand*{\subfig}[2]{\Figure \ref{#1} (#2)}
\fun{\secn}{m}{Section \ref{#1}\xspace}
\fun{\Secn}{m}{Section \ref{#1}\xspace}

\newcommand{\eq}[1]{(\ref{#1})\xspace}
\newcommand{\eqs}{}

\newcommand*{\spc}{\text{ }}

\newcommand*{\eALMs}{118K}
\newcommand*{\eRegs}{311K}
\newcommand*{\eMems}{1782}
\newcommand*{\eDSPs}{1072}
\newcommand*{\eFreq}{388}
\newcommand*{\eResNetAGOPS}{2529}
\newcommand*{\eResNetAGOPSAreaCC}{3.042}
\newcommand*{\eResNetBGOPS}{2752}
\newcommand*{\eResNetBGOPSAreaCC}{3.310}
\newcommand*{\eResNetCGOPS}{2838}
\newcommand*{\eResNetCGOPSAreaCC}{3.414}


\newcommand*{\x}{$\times$\xspace}
\newcommand*{\by}{$\times$}
\newcommand*{\ea}{et al.\xspace}
\newcommand*{\gx}{Arria 10 GX 1150\xspace}
\newcommand*{\sx}{Arria 10 SX 660\xspace}

\newcommand*{\lb}{\left(}
\newcommand*{\rb}{\right)}


\fun \fg{m}{\Figure \ref{#1}\xspace}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fun{\tabThpt}{}{Throughput (GOPS) \tnote{1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fun \winoConv{}{\cite{liu2021winocnn}, \cite{lavin2016fast}\xspace}
\fun \multDominant{}{\cite{liu2021winocnn}, \cite{jouppi2017datacenter}, \cite{norrie2021design}\xspace}
\fun \multComplexity{}{\cite{Lakshmi2022}, \cite{guo2019dl}, \cite{Pekmestzi1999}\xspace}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fun \bits{mo}{\IfNoValueTF{#2}{[#1]}{}}
\newcommand*{\algsize}{\small}
\fun \bld{}{\mathbf}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fun \win{}{w}
\fun \wm{}{m}
\fun \ww{}{w}
\fun \dw{}{\win}
\fun \dm{}{\wm}
\fun \zero{}{}

\fun \nn{}{n}
\fun \one{}{}
\fun \dPsSub{}{2}

\fun \eqFpSup{O{\dw}O{\dm}o}{\bits{#1}[#3]}
\fun \eqPsSup{O{\dw}O{\dm}o}{\bits{#1}[#3]}

\fun \sffip{}{FFIP+\SMM}

\fun \MM{}{MM}

\fun \fpW{O{\win}}{#1}
\fun \psW{O{\win}}{#1}

\fun \psPrefix{}{}
\fun \fpPrefix{}{}

\fun \eqTxtAlg{ooooooooo} {\IfBooleanTF {#8}
  {\IfBooleanTF {#5}
    {\tx{{#1}}_{#2}}
    {{#1}$_{#2}$\xspace}}
  {\IfBooleanTF {#5}
    {\tx{#9{#1}}_{#2}#6[#3][#4][#7]}
    {#9{#1}$_{#2}#6[#3][#4][#7]$\xspace}}}

\fun \PsFp{oooooooo} {\IfBooleanTF {#1}
  {\eqTxtAlg[#2][#3][#4][#5][#6][\eqFpSup][#7][#8][\fpPrefix]}
  {\eqTxtAlg[#2][#3][#4][#5][#6][\eqPsSup][#7][#8][\psPrefix]}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fun \nx{}{\nn}
\fun \nxT{}{2}

\fun \mm{E{/?}{{\ww}{\one}}s}{\IfBooleanTF{#3}
{\alg.\MM'*/{#1}?{#2}<{}}{\alg.\MM'/{#1}?{#2}<{}}}


\fun \sm{E{/?}{{\ww}{\nx}}s}{\IfBooleanTF{#3}
{\alg.\SM'*/{#1}?{#2}<{}}{\alg.\SM'/{#1}?{#2}<{}}}

\fun \alg{E{.}{{\SMM}}t'sE{?>/<}{{\dPsSub}{\dm}}t!}
     {\PsFp[#2][#1][#4][\dW[#6][#2]][#5][#3][#7][#8]}

\fun \dW{oo} {\IfBooleanTF {#2}
    {\fpW[#1]}
    {\psW[#1]}
}


\newcommand*{\n}{\xspace}




\newcommand*{\tx}[1]{\text{#1}}

\AtBeginDocument{
  \catcode`_=12
  \begingroup\lccode`~=`_
  \lowercase{\endgroup\let~}\sb
  \mathcode`_="8000
}

\fun{\smmMacUt}{}{$\frac{\tx{\n mults} / \tx{multiplier}} {\tx{clock cycle}}$  \tnote{2}}
\fun {\smmMacUtExpl}{}{Multiplier compute efficiency, defined in \secn{sec:mu}, measures how effectively the architecture utilizes its multipliers. It can surpass 1 in \smm architectures because the observed mults/s is equal to the number of multiplications required to carry out an execution using conventional algebra divided by the measured execution time.
For prior works that did not provide this metric, the value displayed here is reverse engineered based on other provided metrics and design choices as explained further in \secn{smm:sec:results-prior-work}.}
\fun {\matSzExpl}{}{Quantifies how much smaller the minimum supported matrix sizes of a multisystolic array design are relative to a single-systolic array design with the same throughput per clock cycle roof, definition and relevance provided in \secn{smm:sec:mat-sz}.}


\fun \sAlg{E{.}{{\SMM}}t'sE{?>/<}{{}{\dm}{}{r}}t!}
     {\PsFp[#2][#1][#4][\dW[#6][#2]][#5][#3][#7][#8]}

\fun \s{}{Strassen\xspace}
\fun \sa{}{Strassen's algorithm\xspace}

\fun \citeTPU{}{\cite{jouppi2017datacenter}, \cite{norrie2021design}, \cite{jouppi2023tpu}\xspace}
\fun \citeMultiSys{}{\cite{norrie2021design}, \cite{jouppi2023tpu}, \cite{kung2019maestro}, \cite{yuzuguler2023Scale}\xspace}
\fun \citeCpu{}{\cite{sun2023accelerate}, \cite{misra2022stark}, \cite{krishnan2021multi}, \cite{khaled2020applying}, \cite{huang2020strassen}, \cite{lai2013accelerating}, \cite{lipshitz2012communication}, \cite{ballard2012communication}}

\fun \seq{}{\eqs (\ref{smm:eq:strass-first})-(\ref{smm:eq:strass-last})\xspace}
\fun \seqA{}{\eq{smm:eq:strass-first}\xspace}
\fun \seqB{}{\eq{smm:eq:strass-last}\xspace}

\fun \An{sE{?'}{{ij}{}}}{\m.A?{#2}'{#3}}
\fun \Bn{sE{?'}{{ji}{}}}{\m.B?{#2}'{#3}}
\fun \Tn{sE{?'}{{x} {}}}{\m.T?{#2}'{#3}}
\fun \Sn{sE{?'}{{x} {}}}{\m.S?{#2}'{#3}}
\fun \Qn{sE{?'}{{x} {}}}{\m.Q?{#2}'{#3}}
\fun \Cn{sE{?'}{{ij}{}}}{\m.C?{#2}'{#3}}

\fun \Anv{sE{?'}{{ij}{i:m:,:}}}{\m.A?{#2}'{#3}}
\fun \Bnv{sE{?'}{{ji}{:,j:n:}}}{\m.B?{#2}'{#3}}
\fun \Tnv{sE{?'}{{x} {i:m:,:}}}{\m.T?{#2}'{#3}}
\fun \Snv{sE{?'}{{x} {:,j:n:}}}{\m.S?{#2}'{#3}}
\fun \Qnv{sE{?'}{{x} {i:k:,:}}}{\m.Q?{#2}'{#3}}
\fun \Cnv{sE{?'}{{ij}{i:k:,:}}}{\m.C?{#2}'{#3}}

\fun \Av{sE{?'}{{}{i:m:,:}}}{\m.A?{#2}'{#3}}
\fun \Bv{sE{?'}{{}{:,j:n:}}}{\m.B?{#2}'{#3}}
\fun \Tv{sE{?'}{{}{i:m:,:}}}{\m.T?{#2}'{#3}}
\fun \Sv{sE{?'}{{}{:,j:n:}}}{\m.S?{#2}'{#3}}
\fun \Qv{sE{?'}{{}{i:m:,:}}}{\m.Q?{#2}'{#3}}
\fun \Cv{sE{?'}{{}{i:m:,:}}}{\m.C?{#2}'{#3}}

\fun \m{sE{.?'}{{}{}{}}}{\IfBooleanTF {#1} {\bld{#2_{#3}}_{#4}} {$\bld{#2_{#3}}_{#4}$\xspace}}
\fun \A{s}{\IfBooleanTF {#1} {\bld{A}} {$\bld{A}$\xspace}}
\fun \B{s}{\IfBooleanTF {#1} {\bld{B}} {$\bld{B}$\xspace}}
\fun \AB{s}{\IfBooleanTF {#1} {\bld{AB}} {$\bld{A}$ and $\bld{B}$\xspace}}
\fun \C{s}{\IfBooleanTF {#1} {\bld{C}} {$\bld{C}$\xspace}}
\fun \T{s}{\IfBooleanTF {#1} {\bld{T}} {$\bld{T}$\xspace}}
\fun \Ss{s}{\IfBooleanTF {#1} {\bld{S}} {$\bld{S}$\xspace}}

\fun \SMM{}{SMM}
\fun \smm{E{/?}{{\ww}{r}}s}{\IfBooleanTF{#3}
  {\alg.\SMM'*/{#1}?{#2}<{}}{\alg.\SMM'/{#1}?{#2}<{}}}
\fun \smmArch{E{/?}{{\win}{r}}}{\alg.\SMM/{#1}?{#2}<{}}
\fun \mmArch{E{/?}{{\win}{r}}}{\alg.\MM/{#1}?{#2}<{}}
\fun{\macUtA}{}{$\tx{roof}\lb\frac{\tx{\n mults} / \tx{multiplier}} {\tx{clock cycle}}\rb$ \xspace}

\fun \block{}{block\xspace}
\fun \blocks{}{blocks\xspace}
\fun \subblock{}{sub-block\xspace}
\fun \subblocK{}{sub-block}
\fun \subblocks{}{sub-blocks\xspace}
\fun \gemmtile{}{GEMM tile\xspace}
\fun \gemmtiles{}{GEMM tiles\xspace}

\fun \minSzMetric{}{$\tx{roof}\lb\frac{\tx{mults}/\tx{clock cycle}}{\tx{min. mat. size (h\by w)}}\rb$ \xspace}

\newcommand*{\thpt}{GOPS \tnote{1}}
\newcommand*{\footNoteRefs}{\item[1-2] See the corresponding definitions from Table \ref{smm:tab:second}.}
