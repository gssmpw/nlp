\begin{figure}[t]
  \centering
\resizebox{.51\columnwidth}{!}{
\begin{minipage}[ht]{0.57\textwidth}
\vspace{-0.15in}
\begin{algorithm}[H] %
   \caption{\ourmodel Training}
   \label{alg:training}
    \begin{algorithmic}
    \State {\bfseries Input:} dataset $\mathcal{D}=\{(s,(a,z))\}$, neural network $f\left(\cdot;\vtheta\right)$, timesteps $T$.
    \State {\bfseries Output:} model parameters $\vtheta$.
    \State Denote state length $l=|s|$;
    \Repeat
        \State Draw $(s,(a,z)) \sim \mathcal{D}$ and obtain $\rvx_{0,1:N}= s\mid\mid a\mid\mid z$ ($\mid\mid$:  concat);
        \State Draw $t \in \operatorname{Uniform}(\{1,\dots,T\})$;
         \State Draw $\rvx_{t,n} \sim q(\rvx_{t,n} | \rvx_{0,n})$ for $n\in\{l+1,\dots,N\}$;
          \State $L(\vtheta) = -\lambda_t\sum_{n=l+1}^N 1_\mathrm{\rvx_{t,n}\neq\rvx_{0,n}} \rvx_{0,n}^\top \log f(\rvx_{t,n};\vtheta)$;
        \State Minimize $L(\vtheta)$ with respect to $\vtheta$;
    \Until{converged}
    \end{algorithmic}
\end{algorithm}
\end{minipage}}
\resizebox{.46\columnwidth}{!}{
\begin{minipage}[ht]{0.5\textwidth}
\vspace{-0.15in}
\begin{algorithm}[H] %
   \caption{\ourmodel Inference}
   \label{alg:inference}
    \begin{algorithmic}
    \State {\bfseries Input:} board state $s$, trained network $f\left(\cdot;\vtheta\right)$, timesteps $T$.
    \State {\bfseries Output:} next action $a$.
    \State Denote state length $l= |s|$;
    \State Initialize $\rvx_{T,1:l}=s$ and $\rvx_{T,l+1:N} \sim q_{\text{noise}}$;
    \For{$t = T,\dots,1$}
    \For{$n = l+1,\dots,N$}
    \State Draw $\widetilde{\rvx}_{0,n} \sim \operatorname{Cat}\left(f\!\left(\rvx_{t,n};\vtheta\right)\!\right)$ ;
    \State Draw $\rvx_{t-1,n}\sim q(\rvx_{t-1,n}\mid\rvx_{t,n},\widetilde{\rvx}_{0,n})$;
    \EndFor
    \EndFor
    \State {\bfseries Return} $a=\rvx_{0,l+1}$.
    \end{algorithmic}
\end{algorithm}
\end{minipage}}
\end{figure}

