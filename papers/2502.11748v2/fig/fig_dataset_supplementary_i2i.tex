
\newcommand{\imagebox}[9]{%
    \begin{tikzpicture}
        \node[inner sep=0pt, draw, line width=1mm, draw=#5, name=instance] (img) {
            \adjustbox{width=0.097\linewidth, height=0.097\linewidth}{
                \includegraphics{#1}
            }
        };
        \pgfmathsetmacro{\imgType}{#4}
        \pgfmathsetmacro{\rankText}{#4 == 2 ? "rank #2": (#4 == 3 ? "rank #2" : "AP: #3")}
        \pgfmathsetmacro{\shiftText}{#4 == 2 ? -0.8cm : (#4 == 3 ? -0.8cm : -0.8cm)}
        \pgfmathsetmacro{\isBold}{#4 < 2 ? 1 : 0}
        \node[anchor=west, text=black, font=\tiny, yshift=0.93cm, xshift=\shiftText, align=left] at (img) {{\ifnum\isBold=1 \textbf{\rankText} \else \textbf{\rankText} \fi}};
    \end{tikzpicture}
}


\begin{subfigure}{0.9\textwidth}
    \hspace{-20pt}
    \setlength{\tabcolsep}{0pt}
    \renewcommand{\arraystretch}{1.2} 
     \begin{tikzpicture}[remember picture]
         \node[anchor=north west, inner sep=0pt](tablepos) {
            \begin{tabular}{*{9}{c}}           

\imagebox{data/images/test/garcinoa-fork-2015-query-Q00129.jpg}{-1}{0.0}{1}{lightblue}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_1_8e699171527276e15926c8ce471a8a.jpg}{1}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_4_57ef0ffd78ceb95907bdf5c511a1d9a.jpg}{4}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_37_1e958b1bf155af7188938c1bccf9892e.jpg}{37}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_53_669ea4c8acce37e3a6f0d87eb1207775.jpg}{53}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_61_f2bbad6543b881c506e8d5730aa927.jpg}{61}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015_81_c9d454567b2b835d61901aa5256ebc5d.jpg}{81}{0.0}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015-pos-P00485.jpg}{$>$1000}{0.0}{3}{lightgreen}{0}{0}{0}{0.0} &
\imagebox{data/images/test/garcinoa-fork-2015-pos-P00486.jpg}{$>$1000}{0.0}{3}{lightgreen}{0}{0}{0}{0.0} \\

%--
\imagebox{data/images/difficult/laskazak-dumpling-2014+-query-Q00464.jpg}{-1}{0.0}{1}{lightblue}{0}{0}{0}{0} &
\imagebox{data/images/difficult/0_78e45845aceb1961f1182abd9032f184.jpg}{0}{0}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/8_12274e8c4382c93e86b9b34f2cd5d56.jpg}{8}{0}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+_19_e4bbd1664d1e4e449fe546c39c7726d5.jpg}{19}{0}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+_72_97f0b07c3651e6ada186279c3c78b52d.jpg}{72}{0}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+_85_aabc88782d54e7765b174e176f6c4a64.jpg}{85}{0}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+-pos-P01637.jpg}{$>$1000}{0}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+-pos-P01638.jpg}{$>$1000}{0}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/laskazak-dumpling-2014+-pos-P01639.jpg}{$>$1000}{0}{3}{lightgreen}{0}{0}{0}{0} \\

\imagebox{data/images/difficult/toliageo-building-zeitz-museum-query-Q00959.jpg}{-1}{1.7}{1}{lightblue}{0}{0}{0}{0} &
\imagebox{data/images/test/toliageo-building-zeitz-museum_0_55f79a24ad8c56366f46d354ef30bb3c.jpg}{0}{1.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/89_a19f9a20341ba4f7fcf2cbd55f1f526.jpg}{10}{1.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum_21_d0c6f370eb3f0b71952d3b87c70e16d.jpg}{21}{1.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum-pos-P03762.jpg}{39}{1.7}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum_62_cbc184852bc32ed31d7798da6c461bb.jpg}{62}{1.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum-pos-P03763.jpg}{75}{1.7}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum_98_27aba25beef08c96992563bb95ce2ac0.jpg}{98}{1.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-building-zeitz-museum-pos-P03764.jpg}{$>$1000 }{1.7}{3}{lightgreen}{0}{0}{0}{0} \\

%--
\imagebox{data/images/test/mankoann-bag-bird-query-Q00523.jpg}{-1}{16.8}{1}{lightblue}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird-pos-P01768.jpg}{0}{1}{3}{lightgreen}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird_4_6abac1f7c14519da5b3db5febf1f8dd.jpg}{4}{1}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird_38_295dee28ccfdc8be40954d28537049.jpg}{38}{16.8}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird_55_104baa975dd8319c67361ad5241f4b98.jpg}{55}{16.8}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird_99_8a32315ce78d467a29c7fc7b54d6668b.jpg}{99}{16.8}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/mankoann-bag-bird_92_ff866af8b971cb49391ac2cdb65089d5.jpg}{92}{16.8}{2}{lightred}{0}{0}{0}{0.0} &
 \imagebox{data/images/test/mankoann-bag-bird-pos-P01770.jpg}{273}{16.8}{3}{lightgreen}{0}{0}{0}{0.0} &
 \imagebox{data/images/test/mankoann-bag-bird-pos-P01769.jpg}{$>$1000}{16.8}{3}{lightgreen}{0}{0}{0}{0.0} \\

\imagebox{data/images/test/ypsilnik-zizkov_scale-query-Q01231.jpg}{-1}{19.9}{1}{lightblue}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale_1_f96ebdb91c2e78107b911bd54d1c4a43.jpg}{1}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale_3_462ab72e20671558f6a1f9ee622fcec1.jpg}{3}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test//ypsilnik-zizkov_scale_16_P04709.jpg}{16}{19.9}{3}{lightgreen}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale_26_418d568675acdf45dd3e32926297e445.jpg}{26}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale-pos-P04710.jpg}{43}{19.9}{3}{lightgreen}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale_91_b6691bc9fc75ebe134742952f320364e.jpg}{91}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale-pos-P04712.jpg}{202}{19.9}{3}{lightgreen}{0}{0}{0}{0.0} &
\imagebox{data/images/test/ypsilnik-zizkov_scale-pos-P04714.jpg}{202}{19.9}{3}{lightgreen}{0}{0}{0}{0.0} \\ 

\imagebox{data/images/examples/ypsilnik-miband3-query-Q01193.jpg}{-1}{26.2}{1}{lightblue}{99.1}{63.9}{275.9}{208.06} &
\imagebox{data/images/examples/ypsilnik-miband3-pos-P04580.jpg}{10}{-1.0}{2}{lightgreen}{107.3}{348.09}{47.4}{86.21} &
\imagebox{data/images/examples/ypsilnik-miband3_12_c40b924c45acc6d63f7a3bd38ef2f5.jpg}{12}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/examples/ypsilnik-miband3-pos-P04584.jpg}{37}{-1.0}{2}{lightgreen}{125.5}{335.9}{49.45}{88.86} &
\imagebox{data/images/examples/ypsilnik-miband3_41_a5d14d33b3be4d411b17ea61d4e39711.jpg}{41}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/examples/ypsilnik-miband3-pos-P04582.jpg}{45}{-1.0}{2}{lightgreen}{283.2}{72.8}{45.96}{66.94} &
\imagebox{data/images/examples/ypsilnik-miband3_90_e356606cee37c9f6d75c779696df2c.jpg}{90}{19.9}{2}{lightred}{0}{0}{0}{0.0} &
\imagebox{data/images/examples/ypsilnik-miband3-pos-P04581.jpg}{$>$1000}{-1.0}{2}{lightgreen}{44.1}{393.2}{63.52}{45.0} &
\imagebox{data/images/examples/ypsilnik-miband3-pos-P04583.jpg}{$>$1000}{-1.0}{2}{lightgreen}{212.0}{223.2}{54.04}{61.78} \\ 


\imagebox{data/images/difficult/stojnvla-lego-crab-2023-query-Q00747.jpg}{-1}{27.6}{1}{lightblue}{0}{0}{0}{0} &
\imagebox{data/images/difficult/1_3879f96f53ce32b276ac564ce8c5b23.jpg}{0}{27.6}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/stojnvla-lego-crab-2023-pos-P02896.jpg}{1}{27.6}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/stojnvla-lego-crab-2023_3_6ef35940b7dc565921cb2b9df0bbe37.jpg}{3}{27.6}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/stojnvla-lego-crab-2023-pos-P02895.jpg}{6}{-1.0}{2}{lightgreen}{206.1}{50.4}{197.63}{115.42} &
\imagebox{data/images/difficult/0_68772d38fb62752f96878d820e68.jpg}{8}{27.6}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/stojnvla-lego-crab-2023-pos-P02894.jpg}{9}{-1.0}{2}{lightgreen}{302.9}{167.2}{127.12}{87.88} &
\imagebox{data/images/difficult/stojnvla-lego-crab-2023_78_5c9c8348f96cac744cdc835ffd07c22.jpg}{78}{27.6}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/stojnvla-lego-crab-2023-pos-P02893.jpg}{197}{-1.0}{2}{lightgreen}{139.0}{271.2}{121.74}{80.25} \\ 

%--
\imagebox{data/images/difficult/kordogeo-big-dreams-agatha-christie-2020-query-Q00219.jpg}{-1}{28.7}{1}{lightblue}{0}{0}{0}{0} &
\imagebox{data/images/examples/kordogeo-big-dreams-agatha-christie-2020-pos-P00802.jpg}{0}{-1.0}{2}{lightgreen}{54.3}{89.9}{180.5}{223.9} &
\imagebox{data/images/examples/kordogeo-big-dreams-agatha-christie-2020-pos-P00803.jpg}{1}{-1.0}{2}{lightgreen}{0.0}{129.2}{170.9}{168.79} &
\imagebox{data/images/difficult/0_9c1dafa54e1d56b391e38638262c6ad.jpg}{6}{28.7}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/kordogeo-big-dreams-agatha-christie-2020-pos-P00804.jpg}{8}{28.7}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/21_a4682f6f9cbfe3599a9d43542f4971.jpg}{21}{28.7}{2}{lightred}{0}{0}{0}{0} & 
\imagebox{data/images/examples/kordogeo-big-dreams-agatha-christie-2020-pos-P00799.jpg}{$>$1000}{-1.0}{2}{lightgreen}{282.9}{128.6}{182.0}{121.27} &
\imagebox{data/images/examples/kordogeo-big-dreams-agatha-christie-2020-pos-P00800.jpg}{$>$1000}{-1.0}{2}{lightgreen}{265.1}{131.4}{170.8}{204.0} &
\imagebox{data/images/examples/kordogeo-big-dreams-agatha-christie-2020-pos-P00805.jpg}{$>$1000}{-1.0}{2}{lightgreen}{164.5}{0.44}{204.5}{149.06} \\ 

\imagebox{data/images/difficult/toliageo-painting-cak-query-Q01032.jpg}{-1}{33.3}{1}{lightblue}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-painting-cak-pos-P03964.jpg}{0}{33.3}{3}{lightgreen}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-painting-cak_3_62abffd125f8cc416ef9a648252a14.jpg}{3}{33.3}{2}{lightred}{0 }{0}{0}{0} &
\imagebox{data/images/difficult/41_8644563b3be8a083444fcfce1170d0de.jpg}{41}{33.3}{2}{lightred}{0 }{0}{0}{0} &
\imagebox{data/images/difficult/12_6d2fcec6e4cf92c939e814b22ff827}{51}{33.3}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-painting-cak_92_99bfa8ddc2caeea2129faf8be35b636a.jpg}{92}{33.3}{2}{lightred}{0 }{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-painting-cak_99_50cdc8af5698d6179f8e782539fe2394.jpg}{99}{33.3}{2}{lightred}{0 }{0}{0}{0} &
\imagebox{data/images/difficult/toliageo-painting-cak-pos-P03963.jpg}{$>$1000}{-1.0}{2}{lightgreen}{368.8}{0.0}{131.2}{361.4} &
\imagebox{data/images/difficult/toliageo-painting-cak-pos-P03962.jpg}{$>$1000}{33.3}{3}{lightgreen}{0}{0}{0}{0} \\

\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-query-Q00673.jpg}{-1}{38.1}{1}{lightblue}{15.29}{14.1}{472.19}{336.13} &
\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-pos-P02590.jpg}{0}{-1.0}{2}{lightgreen}{145.8}{97.5}{209.41}{215.31} &
\imagebox{data/images/test/mankoann-t-shirt-shevchenko-pink_1_b6ae941159bafb3da98b9b6af7ceb498.jpg}{1}{37.9}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-pos-P02593.jpg}{2}{-1.0}{2}{lightgreen}{136.5}{78.7}{262.97}{241.73} &
\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-pos-P02594.jpg}{12}{-1.0}{2}{lightgreen}{141.8}{61.8}{191.2}{262.01} &
\imagebox{data/images/test/mankoann-t-shirt-shevchenko-pink_46_dd21a112dbe022b1028e38061e7f528.jpg}{46}{37.9}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink_84_49504d1dfd52fad2c5563cc845f0a815.jpg }{46}{37.9}{2}{lightred}{0}{0}{0}{0} &

\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-pos-P02592.jpg}{$>$1000}{-1.0}{2}{lightgreen}{100.8}{173.33}{246.6}{159.67} &
\imagebox{data/images/examples/mankoann-t-shirt-shevchenko-pink-pos-P02591.jpg}{$>$1000}{-1.0}{2}{lightgreen}{168.83}{77.0}{227.27}{256.0} \\ 


\imagebox{data/images/examples/kordogeo-608-bottle-query-Q00200.jpg}{-1}{50.0}{1}{lightblue}{212.47}{0.0}{117.23}{280.7} &
\imagebox{data/images/examples/kordogeo-608-bottle-pos-P00727.jpg}{0}{-1.0}{2}{lightgreen}{62.0}{164.2}{391.2}{111.2} & 
\imagebox{data/images/examples/kordogeo-608-bottle-pos-P00731.jpg}{1}{-1.0}{2}{lightgreen}{0.0}{91.2}{374.12}{408.66} &
\imagebox{data/images/examples/kordogeo-608-bottle_12_a6115d14756bcbf9202add6477a11e.jpg}{2}{37.9}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/kordogeo-608-bottle-pos-P00732.jpg}{4}{-1.0}{2}{lightgreen}{200.5}{0.0}{106.9}{354.6} &
\imagebox{data/images/examples/kordogeo-608-bottle_17_b2dd21e165676823c8c41a9877531b0.jpg}{7}{37.9}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/kordogeo-608-bottle_95_6b3c5d6515666f91518a2b51c052df67.jpg}{95}{37.9}{2}{lightred}{0}{0}{0}{0} &
\imagebox{data/images/examples/kordogeo-608-bottle-pos-P00728.jpg}{$>$1000}{-1.0}{2}{lightgreen}{36.5}{19.0}{75.69}{233.5} &
\imagebox{data/images/examples/kordogeo-608-bottle-pos-P00730.jpg}{$>$1000}{-1.0}{2}{lightgreen}{246.9}{0.3}{60.1}{169.8} \\ 
    
            \end{tabular}
        };
    \end{tikzpicture}
\end{subfigure}