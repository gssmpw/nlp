\providecommand{\mycolorbar}[8]
{  
    \foreach \x [count=\c] in {#3}{ \xdef\numcolo{\c}}
    \pgfmathsetmacro{\pieceheight}{#1/(\numcolo-1)}
    \xdef\lowcolo{}
    \foreach \x [count=\c] in {#3}
    {   \ifthenelse{\c = 1}
        {}
        {   
            \fill[bottom color=\lowcolo,top color=\x] 
            (#7,{#8+(\c-2)*\pieceheight}) rectangle (#7+#2,{#8+(\c-1)*\pieceheight});
        }
        \xdef\lowcolo{\x}
    }
    \draw (#7,#8) rectangle (#7+#2,#8+#1);
    \pgfmathsetmacro{\secondlabel}{#4+#6}
    \pgfmathsetmacro{\lastlabel}{#5+0.01}
    \pgfkeys{/pgf/number format/.cd,fixed,precision=2}
    \foreach \x in {#4,\secondlabel,...,\lastlabel}{
        \draw (#7+#2,{(\x-#4)/(#5-#4)*#1+#8}) -- ++ (0.05,0.) node[right, font=\tiny] {
            \pgfmathprintnumber{\x}
        };
    }
}

\begin{tikzpicture}[scale=0.6]
    \pgfplotstableread[col sep=comma]{data/heatmap_db_rank_vs_positive_scale.csv}\datatable
    
    \pgfplotstablegetrowsof{\datatable}
    \pgfmathsetmacro{\numrows}{\pgfplotsretval}
    \pgfplotstablegetcolsof{\datatable}
    \pgfmathsetmacro{\numcols}{\pgfplotsretval}
    
    \pgfmathsetmacro{\numrowsi}{\numrows-1}
    \pgfmathsetmacro{\numcolsi}{\numcols-1}
    
    \pgfmathsetmacro{\cellspacing}{1.75}
    \pgfmathsetmacro{\cellsize}{10mm}
    \pgfmathsetmacro{\maxValue}{43}
    \pgfmathsetmacro{\minValue}{20.}

    \pgfmathsetmacro{\height}{\cellspacing*\numrows-0.1}



    \foreach \y in {0,...,\numrowsi} {
        \foreach \x in {0,...,\numcolsi} {
          \pgfplotstablegetelem{\y}{\x}\of{\datatable}
          \let\cellvalue\pgfplotsretval
    
          \pgfmathsetmacro{\cellColorValue}{((\cellvalue-\minValue)/(\maxValue-\minValue)*100}
          \colorlet{cellColor}{highe!\cellColorValue!white}
    
          \node[fill=cellColor, draw=black, minimum size=\cellsize, font=\scriptsize] at (\x*\cellspacing+1, -\y*\cellspacing-1) {\cellvalue};
        };
    }
    
    \node[font=\small] at (3.7, 0.8) {area coverage};
    \node[font=\small, rotate=90] at (-0.8, -3.7) {positive rank};
    
    \foreach \x [count=\i from 1] in {{(0.3-7]}, {(7-14]}, {(14-27]},  {(27-100]}} {             \node[minimum size=\cellsize, font=\scriptsize, scale=0.9] at (\i*\cellspacing-0.8, 0.1) {\x};
    }
    
    \node[minimum size=\cellsize, font=\scriptsize, anchor= east, align=right,rotate=90, scale=0.9] at (-0.15, -0.27) {{[0-10]}};
    \node[minimum size=\cellsize, font=\scriptsize, anchor= east, align=right,rotate=90, scale=0.9] at (-0.15, -1.9) {{(10-100]}};
    \node[minimum size=\cellsize, font=\scriptsize, anchor= east, align=right,rotate=90, scale=0.9] at (-0.15, -3.47) {{(100-1000]}};
    \node[minimum size=\cellsize, font=\scriptsize, anchor= east, align=right,rotate=90, scale=0.9] at (-0.15, -5.45) {{(1000+]}};
\end{tikzpicture}