\section{Join order validity as HUBO}

HUBO problems, like QUBO problems, are required to return valid solutions. In this case, validity means that the join tree adheres to the query graph. All valid solutions are usable, although they might not minimize the cost. In this section, we present two approaches to encoding the validity of solutions: cost function dependent and independent. A cost-function-dependent approach is easy to construct but produces a larger number of higher-order terms. The cost-function-independent approach is closer to the standard QUBO formulations and identifies a collection of constraints the formulation needs to satisfy. The advantage of the second formulation is that the terms are primarily quadratic, which is easier to optimize in practice.

\input{sections/join_order_selection_theory/dependent}
\input{sections/join_order_selection_theory/independent}

\textbf{Scaling cost and validity.} Finally, we have to scale cost HUBO $H_{\text{cost}}$ and validity objective $H_{\text{val}}$ properly so that we favor valid solutions over minimizing cost:
\begin{displaymath}
H_{\text{full}} = H_{\text{cost}} + CH_{\text{val}}.
\end{displaymath}
We noticed that a value that worked consistently in practice is $C = H_{\text{cost}}(x)$ where $x = (1, \ldots, 1)$ is a binary vector containing only ones and $H_{\text{cost}}$ is normalized so that the coefficients are in the interval $(0,1]$.