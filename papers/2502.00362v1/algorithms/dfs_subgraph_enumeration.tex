\begin{algorithm}
\caption{Construct Terms for Precise Cost Function HUBO}
\label{alg:hubo_term_construction}
\begin{algorithmic}[1]
\Require query\_graph
\Ensure terms for cost HUBO
\For{\textbf{each} $r$ \textbf{in} $0, \ldots, |V| - 2$}
    \For{edge \textbf{in} query\_graph}
        \State $R_i$, $R_j \gets$ edge[0], edge[1]
        \If{$r$ $=$ 0}
            \State HUBO[$\{R_i, R_j\}$] $\gets$ $x_{ij}^{0}$
        \Else
            \State joined\_tables $\gets$ [tables if $r - 1$ var in HUBO[tables]]
            \For{joined \textbf{in} joined\_tables}
                \State cond1 = $R_i \in$ joined and $R_j \notin$ joined
                \State cond2 = $R_j \in$ joined and $R_i \notin$ joined
                \If{cond1 \textbf{or} cond2}
                    \State new\_joined $\gets$ joined $\cup$ $\{R_i, R_j\}$
                    \State old\_terms $\gets$ HUBO[joined]
                    \State new\_terms $\gets$ multiply old\_terms with $x_{ij}^{r}$
                    \State HUBO[new\_joined] $\gets$ new\_terms
                \EndIf
            \EndFor
        \EndIf
    \EndFor
\EndFor
\end{algorithmic}
\end{algorithm}
