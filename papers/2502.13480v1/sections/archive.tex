\begin{figure}[htbp]
  \centering
    \subfloat{\includegraphics[width=0.35\textwidth]{figs/fig-system-legend.pdf}}\\
    \addtocounter{subfigure}{-1}
    
    \subfloat[Policy Number]{\includegraphics[width=0.24\textwidth]{figs/fig-system-policy_num.pdf}}
    \subfloat[End to end Time (/s)]{\includegraphics[width=0.24\textwidth]{figs/fig-system-time_cost.pdf}}
  \caption{
  The search space and the time cost for \sysname.
  For the pictures of time cost, the light color without hatches represents the time spent searching, while the deep color with hatches represents the time spent simulating.
  We can observe that it only takes \sysname\ about 1 second to complete the end-to-end search. 
  }
  \label{fig:exp:cost}
\end{figure}

For each micro-batch in the strategy, the computation cost is the time spent on performing operations such as matrix multiplications and forward/backward propagation. 
Let $n$ represent the batch number of micro-batches, it is computed as
\begin{equation}
    n=\frac{global\_batch\_size}{dp\times micro\_batch\_size}
\end{equation}
where $dp$ is the data parallel size.
Then we can compute the computation time as
\begin{equation}
    T_{comp}(s_i) = \sum_{j=1}^{n} C_j(s_i)
\end{equation}
and the bubble time as
\begin{equation}
    T_{bubble}(s_i) = \frac{pp-1}{n}\times (T_{comp}(s_i)+ T_{comm}(s_i))
\end{equation}
where $pp$ is the pipeline parallel size.

Similarly, the communication cost includes the overhead of data transfer between GPUs and synchronization of gradients. Let $Comm_j(s_i)$ represent the communication cost for stage $j$, and the total communication cost is:
\begin{equation}
    T_{comm}(s_i) = \sum_{j=1}^{n} Comm_j(s_i)
