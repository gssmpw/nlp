\begin{table*}[t]
\centering
\tiny
\begin{tabular}{|M{1.2cm}|M{0.7cm}|M{1cm}|M{1cm}|M{1cm}|M{0.8cm}|M{1.2cm}|M{0.7cm}|M{1cm}|M{1cm}|M{1cm}|M{0.8cm}|}
\hline\hline
Model & \#GPU & \#Strategies & Search Time(/s) & Simulation Time(/s) & E2E Time(/s) & Model & \#GPU & \#Strategies & Search Time(/s) & Simulation Time(/s) & E2E Time(/s) \\ \hline
\multirow{4}{*}{Llama-2-7B} & 64 & 23348 & 0.06 & 49.7 & 51.0 & \multirow{4}{*}{Llama-2-13B} & 64 & 23400 & 0.05 & 58.1 & 59.3 \\ \cline{2-6} \cline{8-12} 
 & 256 & 14372 & 0.05 & 43.5 & 44.4 &  & 256 & 13552 & 0.03 & 49.9 & 50.8 \\ \cline{2-6} \cline{8-12} 
 & 1024 & 8856 & 0.04 & 41.8 & 42.2 &  & 1024 & 8920 & 0.02 & 51.0 & 51.7 \\ \cline{2-6} \cline{8-12} 
 & 4096 & 4700 & 0.03 & 33.0 & 33.2 &  & 4096 & 4720 & 0.02 & 44.1 & 44.3 \\ \hline
\multirow{4}{*}{Llama-2-70B} & 64 & 53264 & 0.1 & 68.8 & 75.0 & \multirow{4}{*}{Llama-3-8B} & 64 & 23348 & 0.05 & 48.3 & 49.6 \\ \cline{2-6} \cline{8-12} 
 & 256 & 31440 & 0.06 & 57.7 & 60.9 &  & 256 & 14372 & 0.04 & 42.0 & 42.8 \\ \cline{2-6} \cline{8-12} 
 & 1024 & 20152 & 0.05 & 57.4 & 59.6 &  & 1024 & 8856 & 0.03 & 40.9 & 41.3 \\ \cline{2-6} \cline{8-12} 
 & 4096 & 10948 & 0.04 & 63.2 & 65.0 &  & 4096 & 4700 & 0.03 & 32.7 & 32.9 \\ \hline
\multirow{4}{*}{Llama-3-70B} & 64 & 53264 & 0.1 & 66.8 & 71.8 & \multirow{4}{*}{GLM-67B} & 64 & 20528 & 0.04 & 19.3 & 20.6 \\ \cline{2-6} \cline{8-12} 
 & 256 & 31440 & 0.07 & 56.3 & 59.6 &  & 256 & 12132 & 0.03 & 16.6 & 17.4 \\ \cline{2-6} \cline{8-12} 
 & 1024 & 20152 & 0.05 & 55.5 & 57.6 &  & 1024 & 7948 & 0.02 & 16.9 & 17.3 \\ \cline{2-6} \cline{8-12} 
 & 4096 & 10948 & 0.04 & 62.4 & 63.4 &  & 4096 & 4196 & 0.02 & 21.3 & 21.5 \\ \hline
\multirow{2}{*}{GLM-130B} & 64 & 33540 & 0.06 & 22.4 & 52.4 & \multirow{2}{*}{GLM-130B} & 1024 & 11976 & 0.03 & 16.7 & 18.2 \\ \cline{2-6} \cline{8-12} 
 & 256 & 18776 & 0.04 & 17.2 & 19.4 &  & 4096 & 6040 & 0.02 & 19.2 & 20.1 \\ \hline\hline
\end{tabular}%
\caption{
    The search space and the time cost for \sysname on Heterogeneous GPUs.
  For the pictures of time cost, the light color without hatches represents the time spent searching, while the deep color with hatches represents the time spent simulating.
  We can observe that it only takes \sysname\ about 1 minute to complete the end-to-end simulation. 
}
\label{tab:exp:cost}
\end{table*}

\section{Experiments}\label{sec:exp}


%In this section, we first evaluate \sysname's cost model accuracy under different settings to build the basis for the search in \S\ref{sec:exp:accuracy}.
%We show the search space of \sysname, and the search time cost for the search in \S\ref{sec:exp:cost}.
%Then, t
To prove \sysname's optimal search ability on MegatronLM, we did a comparative analysis between \sysname\ and experts on MegatronLM in \S\ref{sec:exp:expert}.
%After that, we compare \sysname with existing auto-parallel frameworks, including Alpa, Galvatron, etc., in \S\ref{sec:exp:comparison}.
Finally, we evaluate \sysname to search for the finance-optimal plan under different settings in \S\ref{sec:exp:finance}.

%\input{sections/5-evaluation-accuracy}
%\input{sections/5-evaluation-cost}

\begin{figure*}[thbp]
  \centering
    \subfloat{\includegraphics[width=0.4\textwidth]{figs/fig-expert-legend.pdf}}\\
    \addtocounter{subfigure}{-1}

    \begin{minipage}{\textwidth}
    {\centering{\hspace{2.8cm}A800\hspace{4cm}H100\hspace{4.2cm}H800}}
    \end{minipage}

    \raisebox{0.8cm}{\rotatebox[origin=c]{90}{Llama-2}}
    \subfloat[7B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-A800-llama2-7b.pdf}}
    \subfloat[13B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-A800-llama2-13b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-A800-llama2-70b.pdf}}
    \subfloat[7B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H100-llama2-7b.pdf}}
    \subfloat[13B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H100-llama2-13b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H100-llama2-70b.pdf}}
    \subfloat[7B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H800-llama2-7b.pdf}}
    \subfloat[13B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H800-llama2-13b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.106\textwidth]{figs/fig-expert-H800-llama2-70b.pdf}}
    \\
    \raisebox{0.8cm}{\rotatebox[origin=c]{90}{Llama-3}}
    \subfloat[8B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-A800-llama3-8b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-A800-llama3-70b.pdf}}
    \subfloat[8B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H100-llama3-8b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H100-llama3-70b.pdf}}
    \subfloat[8B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H800-llama3-8b.pdf}}
    \subfloat[70B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H800-llama3-70b.pdf}}
    \\
    \raisebox{0.8cm}{\rotatebox[origin=c]{90}{GLM}}
    \subfloat[67B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-A800-glm-67b.pdf}}
    \subfloat[130B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-A800-glm-130b.pdf}}
    \subfloat[67B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H100-glm-67b.pdf}}
    \subfloat[130B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H100-glm-130b.pdf}}
    \subfloat[67B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H800-glm-67b.pdf}}
    \subfloat[130B]{\includegraphics[width=0.16\textwidth]{figs/fig-expert-H800-glm-130b.pdf}}
  \caption{
  We compare \sysname's searched optimal plan's throughput with expert's proposed plan's throughput in single-GPU setting.
  }
  \label{fig:expert:throughput}
  \vspace{-10pt}
\end{figure*}

\input{sections/5-evaluation-expert}
%\input{sections/5-evaluation-comparison}

\input{sections/5-evaluation-heter}
\input{sections/5-evaluation-money}