\begin{algorithm}[h]
% \scriptsize
    \caption{ForwardExpandFrontier}
    \label{alg:expandFrontier}
    \KwIn{Frontier (vertex $v$, queries $B$), original graph $G$, \{$P$\}}
    % \textbf{InOut:} $undone$, $s$-$seen$, $s$-$queue$, $s$-$nextqueue$, $joint$, $pred$, $t$-$seen$ \textit{\color{gray} // Data structures for search and path record.} \\
    \textbf{InOut:} Data structures for searching and path recording. \\
    % \textit{\color{gray}/* Forward search. Backward search proceeds similarly. */} \\
    {
        $B = B \setminus undone$ \textit{\color{gray}// Skip queries that have already found the $i$th path.} \\
        \ForEach{($u$, $B'$) $\in$ GetOutNeighbors($v$, $B$, $G$, \{$P$\}) \textit{\color{gray}// See Alg.~\ref{alg:get_nbr}.}} 
        {
            $D = B' \setminus s$-$seen_u$ \textit{\color{gray}// Exclude queries that have already visited $u$.} \\
            $s$-$seen_u \cup= D$; $pred_{u, v} \cup= D$ \textit{\color{gray}// Mark visited and record predecessor.} \\
            $meet = D \cap t$-$seen_u$ 
            \textit{\color{gray}// The forward and backward searches meet.} \\
            % \textit{\color{gray}// Found a path} \\
            $joint_u \cup= meet$; $undone \setminus= meet$ \textit{\color{gray}// Mark queries as completed.} \\
            $s$-$nextqueue_u \cup= (D \setminus meet)$ 
            \textit{\color{gray}// Add to the queue.} \\
        }
    }
    
    % \vspace{-2pt}
\end{algorithm}

