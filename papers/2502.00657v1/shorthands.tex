\usepackage{xfrac}
\usepackage{bbm}
\usepackage{booktabs}
\usepackage{tabularray}
% \usepackage{environ}         % provides \BODY
% \usepackage{etoolbox}        % provides \ifdimcomp
% \usepackage{graphicx}        % provides \resizebox

% \newlength{\myl}
% \let\origequation=\equation
% \let\origendequation=\endequation

% \RenewEnviron{equation}{
%   \settowidth{\myl}{$\BODY$}                       % calculate width and save as \myl
%   \origequation
%   \ifdimcomp{\the\linewidth}{>}{\the\myl}
%   {\ensuremath{\BODY}}                             % True
%   {\resizebox{\linewidth}{!}{\ensuremath{\BODY}}}  % False
%   \origendequation
% }

\newcommand*{\myDots}{\ifmmode\mathellipsis\else.\kern-0.13em.\kern-0.13em.\fi} % touching at \kern-0.1725em


\newcommand{\on}[1]{#1_{\shortparallel}}
\newcommand{\off}[1]{#1_{\perp}}
\newcommand{\flt}[1]{#1_{\vdash}}
\newcommand{\bld}[1]{\mathbf{#1}}
\newcommand{\xt}{\Tilde{x}}
\newcommand{\wt}{\Tilde{w}}
\newcommand{\At}{\Tilde{\bld{A}}}
\newcommand{\at}{\Tilde{a}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\bXt}{\Tilde{\mathbf{X}}}
\newcommand{\bD}{\mathbf{D}}
\newcommand{\bE}{\mathbbm{E}}
\newcommand{\inner}[2]{ #1\odot #2}
\newcommand{\Inner}[2]{ \langle #1 \; , \; #2 \rangle}
\newcommand{\iter}[2]{ #1^{(#2)}}
\DeclareMathOperator{\vect}{vec}

\newcommand{\ba}{\mathbf{a}}
\newcommand{\be}{\mathbf{e}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bxt}{\Tilde{\bx}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bg}{\mathbf{g}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\bc}{\mathbf{c}}
\newcommand{\br}{\mathbf{r}}
\newcommand{\bd}{\mathbf{d}}
\newcommand{\bp}{\mathbf{p}}
\newcommand{\bh}{\mathbf{h}}

\newcommand{\bM}{\mathbf{M}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bP}{\mathbf{P}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bL}{\mathbf{L}}
%\newcommand{\bh}{{\mathbb H}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bn}{\mathbf{n}}
\newcommand{\bs}{\mathbf{s}}
\newcommand{\bq}{\mathbf{q}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\bmut}{\Tilde{\bmu}}
\newcommand{\bzeta}{\boldsymbol{\zeta}}
\newcommand{\bSigma}{\boldsymbol{\Sigma}}
\newcommand{\balpha}{\boldsymbol{\alpha}}
\newcommand{\bbeta}{\boldsymbol{\beta}}
\newcommand{\btau}{\boldsymbol{\tau}}
\newcommand{\bxi}{\boldsymbol{\xi}}
\newcommand{\bxit}{\Tilde{\bxi}}
\newcommand{\blambda}{\boldsymbol{\lambda}}
\newcommand{\bepsilon}{\boldsymbol{\epsilon}}
\newcommand{\bsigma}{\boldsymbol{\sigma}}
\newcommand{\btheta}{{\boldsymbol{\theta}}}
\newcommand{\bomega}{\boldsymbol{\omega}}
\newcommand{\Xcal}{\mathcal{X}}
\newcommand{\ex}{\epsilon_x}
\newcommand{\exi}{\epsilon_{\xi}}
\newcommand{\exxi}{\epsilon_{x \xi}}

\newcommand{\co}{{\cal O}}
\newcommand{\ca}{{\cal A}}
\newcommand{\cb}{{\cal B}}
\newcommand{\cd}{{\cal D}}
\newcommand{\cdb}{{\cal D}^{\rm b}}
\newcommand{\cc}{{\cal C}}
\newcommand{\ck}{{\cal K}}
\newcommand{\cq}{{\cal Q}}
\newcommand{\ce}{{\cal E}}
\newcommand{\ct}{{\cal T}}
\newcommand{\cg}{{\cal G}}
\newcommand{\ch}{{\cal H}}
\newcommand{\cm}{{\cal M}}
\newcommand{\ci}{{\cal I}}
\newcommand{\cj}{{\cal J}}
\newcommand{\cw}{{\cal W}}
\newcommand{\cl}{{\cal L}}
\newcommand{\cf}{{\cal F}}
\newcommand{\cv}{{\cal V}}
\newcommand{\cp}{{\cal P}}
\newcommand{\cu}{{\cal U}}
\newcommand{\cx}{{\cal X}}
\newcommand{\cy}{{\cal Y}}
\newcommand{\cz}{{\cal Z}}
\newcommand{\cs}{{\cal S}}
\newcommand{\cn}{{\cal N}}
\newcommand{\calr}{{\cal R}}

\DeclareMathOperator*{\sign}{sign}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\cluster}{cluster}


\newcommand{\bbs}{{\mathbb S}}
\newcommand{\reals}{{\mathbb R}}
\newcommand{\nat}{{\mathbb N}}
\newcommand{\integers}{{\mathbb Z}}
\newcommand{\complex}{{\mathbb C}}
%\newcommand{\zero}{{\vec 0}}
\newcommand{\zero}{{\mathbf{0}}}
\newcommand{\ndist}{\mathsf{N}}
\newcommand{\Dclust}{{\mathcal{D}_{\text{clusters}}}}



%\newcommand{\E}[1]{\mbox{E}\left[#1\right] }
%\newcommand{\prob}[1]{{\rm Prob}\left\{ #1 \right\} }

%\newcommand{\proofbox}{\begin{flushright}$\Box$\end{flushright}}
\newcommand{\proofbox}{\hfill $\Box$}

\newcommand{\commentjf}[1]{{\bf [#1]}}

\newcommand{\diag}{\mathrm{diag}}
\DeclareMathOperator{\poly}{poly}
\DeclareMathOperator{\polylog}{polylog}
\DeclareMathOperator*{\E}{\mathbb{E}}
\DeclareMathOperator{\bin}{bin}
\DeclareMathOperator{\betadist}{Beta}


\newcommand{\unifdist}[2]{\cu(#1,#2)}

%\newcommand{\D}{\mathcal{D}}
\newcommand{\tn}{{\tilde{n}}}
%\newcommand{\inner}[1]{\langle #1 \rangle}
\newcommand{\binner}[1]{\biggl< #1 \biggr>}
\newcommand{\norm}[1]{\left\|#1\right\|}
\newcommand{\snorm}[1]{\|#1\|} %small norm
\newcommand{\tbx}{{\tilde{\bx}}}
\newcommand{\tx}{{\tilde{x}}}
\newcommand{\rmax}{R_{\text{max}}}
\newcommand{\rmin}{R_{\text{min}}}

\newcommand{\pref}{\pi_{\text{ref}}}
\newcommand{\ppol}{\pi_{\theta}}
\newcommand{\ppolo}{\pi_{\theta^*}}
\DeclarePairedDelimiterX{\infdivx}[2]{(}{)}{%
  #1\;\delimsize\|\;#2%
}
\newcommand{\infdiv}{\mathbb{D}_{\text{KL}}\infdivx}
\newcommand{\fdiv}{\mathbb{D}_{f}\infdivx}
\newcommand{\tvdiv}{\mathbb{D}_{\text{TV}}\infdivx}
\newcommand{\jsdiv}{\mathbb{D}_{\text{JS}}\infdivx}
\newcommand{\dpodiv}{\mathbb{D}_{\text{DPO}}\infdivx}
\DeclareMathOperator{\const}{const}
\DeclareMathOperator{\effdom}{ED}
\DeclareMathOperator{\clip}{Clip}

\setlength{\textfloatsep}{8pt} % Adjust to your preference


