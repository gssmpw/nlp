\begin{figure*}[t!]
    \captionsetup[subfigure]{font=footnotesize,labelfont=footnotesize,aboveskip=0.05cm,belowskip=-0.15cm}
    \centering
    \begin{subfigure}[t]{.615\textwidth}
        \centering
        \begin{subfigure}{.48\linewidth}
            \centering
            \begin{tikzpicture}
                \pgfplotstableread[col sep=comma]{data/component_analysis.csv}{\datatable}
                \begin{axis}[
                    legend style={
                        nodes={scale=0.6}, 
                        at={(2.5, 1.14)}, 
                        legend columns=-1,
                    },
                    xlabel={Relative labeling cost (\%)},
                    ylabel={Accuracy (\%)},
                    width=1.0\linewidth,
                    height=1.04\linewidth,
                    ymin=40,
                    ymax=74,
                    ytick={40, 50, 60, 70},
                    xlabel style={yshift=0.25cm},
                    ylabel style={yshift=-0.6cm},
                    label style={font=\scriptsize},
                    tick label style={font=\scriptsize},
                    xticklabel={$\pgfmathprintnumber{\tick}$},
                    every axis plot/.append style={solid},
                    cycle list name=color list
                ]


                \addplot [
                    name path={ENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={ENT-COST},
                    y expr=\thisrow{ENT-ACC}+\thisrow{ENT-ACC-STD}
                ] {\datatable};
    
                \addplot [
                    name path={ENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={ENT-COST},
                    y expr=\thisrow{ENT-ACC}-\thisrow{ENT-ACC-STD}
                ] {\datatable};
    
                \addplot[cRed2, draw=none, forget plot, fill opacity=0.3] fill between[of={ENT-U} and {ENT-L}];
    
                \addplot[
                    cRed2,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    x dir=both, x explicit,
                    error bar style={line width=0.6pt, draw=cRed}, 
                    error mark=none, 
                ] table [
                    x={ENT-COST},
                    y={ENT-ACC}, 
                    x error={ENT-COST-STD},
                    y error={ENT-ACC-STD}
                ] {\datatable};
                \addlegendentry{\sftype{CQ+Ent}}

                \addplot [
                    name path={CFENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={CFENT-COST},
                    y expr=\thisrow{CFENT-ACC}+\thisrow{CFENT-ACC-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CFENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={CFENT-COST},
                    y expr=\thisrow{CFENT-ACC}-\thisrow{CFENT-ACC-STD}
                ] {\datatable};
    
                \addplot[cPurple, draw=none, forget plot, fill opacity=0.3] fill between[of={CFENT-U} and {CFENT-L}];
    
                \addplot[
                    cPurple,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    x dir=both, x explicit,
                    error bar style={line width=0.6pt, draw=cPurple}, 
                    error mark=none, 
                ] table [
                    x={CFENT-COST},
                    y={CFENT-ACC}, 
                    x error={CFENT-COST-STD},
                    y error={CFENT-ACC-STD}
                ] {\datatable};
                \addlegendentry{\sftype{CSQ}($\alpha=0.1$)+\sftype{Ent}}

                \addplot [
                    name path={CENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={CENT-COST},
                    y expr=\thisrow{CENT-ACC}+\thisrow{CENT-ACC-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={CENT-COST},
                    y expr=\thisrow{CENT-ACC}-\thisrow{CENT-ACC-STD}
                ] {\datatable};
    
                \addplot[cBlue6, draw=none, forget plot, fill opacity=0.3] fill between[of={CENT-U} and {CENT-L}];
    
                \addplot[
                    cBlue6,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    x dir=both, x explicit,
                    error bar style={line width=0.6pt, draw=cBlue6}, 
                    error mark=none, 
                ] table [
                    x={CENT-COST},
                    y={CENT-ACC}, 
                    x error={CENT-COST-STD},
                    y error={CENT-ACC-STD}
                ] {\datatable};
                \addlegendentry{\sftype{CSQ+Ent}}
                
                \addplot [
                    name path={CCENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={CCENT-COST},
                    y expr=\thisrow{CCENT-ACC}+\thisrow{CCENT-ACC-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CCENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={CCENT-COST},
                    y expr=\thisrow{CCENT-ACC}-\thisrow{CCENT-ACC-STD}
                ] {\datatable};
    
                \addplot[cBlue2, draw=none, forget plot, fill opacity=0.3] fill between[of={CCENT-U} and {CCENT-L}];
    
                \addplot[
                    cBlue2,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    x dir=both, x explicit,
                    error bar style={line width=0.6pt, draw=cBlue2}, 
                    error mark=none, 
                ] table [
                    x={CCENT-COST},
                    y={CCENT-ACC}, 
                    x error={CCENT-COST-STD},
                    y error={CCENT-ACC-STD}
                ] {\datatable};
                \addlegendentry{\sftype{CSQ+Cost(Ent)}}
    
                                \end{axis}                
                \end{tikzpicture}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\linewidth}
            \centering
            \begin{tikzpicture}
                \pgfplotstableread[col sep=comma]{data/component_analysis.csv}{\datatable}
                \begin{axis}[
                    xlabel={Round},
                    ylabel={Relative labeling cost (\%)},
                    width=1.0\linewidth,
                    height=1.04\linewidth,
                    xtick={1, 3, 5, 7, 9},
                    xlabel style={yshift=0.25cm},
                    ylabel style={yshift=-0.4cm},
                    xmin=0.5,
                    xmax=9.5,
                    ymin=15,
                    ymax=105,
                    label style={font=\scriptsize},
                    tick label style={font=\scriptsize},
                    xticklabel={$\pgfmathprintnumber{\tick}$},
                    yticklabel={$\pgfmathprintnumber{\tick}$},
                    every axis plot/.append style={solid},
                    cycle list name=color list
                ]

                \addplot [
                    name path={ENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{ENT-COST}+\thisrow{ENT-COST-STD}
                ] {\datatable};
    
                \addplot [
                    name path={ENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{ENT-COST}-\thisrow{ENT-COST-STD}
                ] {\datatable};
    
                \addplot[cRed2, fill opacity=0.3] fill between[of={ENT-U} and {ENT-L}];
    
                \addplot[
                    cRed2,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    error bar style={line width=0.6pt, draw=cRed}, 
                    error mark=none, 
                ] table [
                    x={round},
                    y={ENT-COST}, 
                    y error={ENT-COST-STD}
                ] {\datatable};

                \addplot [
                    name path={CFENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CFENT-COST}+\thisrow{CFENT-COST-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CFENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CFENT-COST}-\thisrow{CFENT-COST-STD}
                ] {\datatable};
    
                \addplot[cBlue5, fill opacity=0.3] fill between[of={CFENT-U} and {CFENT-L}];
    
                \addplot[
                    cBlue5,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    error bar style={line width=0.6pt, draw=cBlue5}, 
                    error mark=none, 
                ] table [
                    x={round},
                    y={CFENT-COST}, 
                    y error={CFENT-COST-STD}
                ] {\datatable};

                \addplot [
                    name path={CENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CENT-COST}+\thisrow{CENT-COST-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CENT-COST}-\thisrow{CENT-COST-STD}
                ] {\datatable};
    
                \addplot[cBlue6, fill opacity=0.3] fill between[of={CENT-U} and {CENT-L}];
    
                \addplot[
                    cBlue6,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    error bar style={line width=0.6pt, draw=cBlue6}, 
                    error mark=none, 
                ] table [
                    x={round},
                    y={CENT-COST}, 
                    y error={CENT-COST-STD}
                ] {\datatable};

                \addplot [
                    name path={CCENT-L}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CCENT-COST}+\thisrow{CCENT-COST-STD}
                ] {\datatable};
    
                \addplot [
                    name path={CCENT-U}, draw=none, forget plot, fill=none
                ] table [
                    x={round},
                    y expr=\thisrow{CCENT-COST}-\thisrow{CCENT-COST-STD}
                ] {\datatable};
    
                \addplot[cBlue2, fill opacity=0.3] fill between[of={CCENT-U} and {CCENT-L}];
    
                \addplot[
                    cBlue2,
                    thick,
                    mark=*,
                    mark options={scale=0.4, solid},
                    error bars/.cd,
                    y dir=both, y explicit, 
                    error bar style={line width=0.6pt, draw=cBlue2}, 
                    error mark=none, 
                ] table [
                    x={round},
                    y={CCENT-COST}, 
                    y error={CCENT-COST-STD}
                ] {\datatable};

                                
                \end{axis}
            \end{tikzpicture}
        \end{subfigure}
        \caption{Contribution of each component}
        \label{fig:comparison-(a)}
    \end{subfigure}
    \hspace{1cm} %
    \begin{subfigure}[t]{.295\textwidth}
        \centering
        \begin{tikzpicture}
            \pgfplotstableread[col sep=comma]{data/calibration_set_size.csv}{\datatable}
            \begin{axis}[
                legend style={
                    nodes={scale=0.6}, 
                    at={(0.5, 1.05)}, 
                    legend columns=-11,
                    anchor=south,
                },
                xlabel={\edited{Size of calibration set $n_\text{cal}$ (K)}},
                ylabel={Relative labeling cost (\%)},
                width=1.0\linewidth,
                height=1.04\linewidth,
                ymin=37,
                ymax=61,
                xtick={0.1, 0.5, 1, 2},
                ytick={40, 45, 50, 55, 60},
                xlabel style={yshift=0.25cm},
                ylabel style={yshift=-0.4cm},
                xmin=0.0,
                xmax=2.1,
                label style={font=\scriptsize},
                tick label style={font=\scriptsize},
                xticklabel={$\pgfmathprintnumber{\tick}$}
            ]

            \pgfmathsetmacro{\constantvalue}{58}
            \addplot [
                cRed2,
                dashed,
                thick, %
            ] coordinates {(-2, \constantvalue) (3, \constantvalue)};
            \addlegendentry{\sftype{CQ+Ent}}

            \addplot [
                name path={L}, draw=none, forget plot, fill=none
            ] table [
                x={size},
                y expr=\thisrow{COST}+\thisrow{COST-STD}
            ] {\datatable};

            \addplot [
                name path={U}, draw=none, forget plot, fill=none
            ] table [
                x={size},
                y expr=\thisrow{COST}-\thisrow{COST-STD}
            ] {\datatable};

            \addplot[cBlue2, fill opacity=0.3, forget plot] fill between[of={U} and {L}];

            \addplot[
                cBlue2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cBlue2}, 
                error mark=none, 
            ] table [
                x={size},
                y={COST}, 
                y error={COST-STD}
            ] {\datatable};
            \addlegendentry{\sftype{CSQ+Cost(Ent)}}
            
            \end{axis}
        \end{tikzpicture}
        \caption{Impact of calibration set size}
        \label{fig:comparison-(b)}
    \end{subfigure}
    \label{fig:comparison}
    \caption{(a) Contribution of each component of our method, measured by accuracy (\%) versus relative labeling cost (\%) (\textit{left}), and relative labeling cost (\%) versus AL rounds (\textit{right}) on CIFAR-100.
    The results compare the full method (\sftype{CSQ}+\sftype{Cost(Ent)}), the method without acquisition function in~\Eq{acquisition} (\sftype{CSQ}+\sftype{Ent}), without $\alpha$ optimization in~\Eq{optimize}, where $\alpha$ is fixed to 0.1 (\sftype{CSQ}($\alpha=0.1$)+\sftype{Ent}), and without CSQ (\sftype{CQ}+\sftype{Ent}).
    All components of our method lead to steady performance improvement over varying rounds.
    (b) Relative labeling cost (\%) at the fifth round with varying calibration set sizes $n_\text{cal}$ in~\Eq{quantile} on CIFAR-100.
    The dashed line indicates the relative labeling cost (\%) of \sftype{CQ+Ent}.
    Our method shows consistent performance with varying calibration set sizes.}
\end{figure*}

