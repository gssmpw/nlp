\begin{figure*}[t!]
    \captionsetup[subfigure]{font=footnotesize,labelfont=footnotesize,aboveskip=0.05cm,belowskip=-0.15cm}
    \hspace{-5mm}
    \centering
    \begin{subfigure}{.31\linewidth}
        \centering
        \begin{tikzpicture}
            \pgfplotstableread[col sep=comma]{data/query_design.csv}{\datatable}
            \begin{axis}[
                legend style={
                    nodes={scale=0.6}, 
                    anchor=north, 
                    at={(2.05, 1.15)}, 
                    /tikz/every even column/.append style={column sep=2mm},
                    legend columns=-1,
                },
                legend columns=-1,
                xlabel={Relative labeling cost (\%)},
                ylabel={Accuracy (\%)},
                width=1.0\linewidth,
                height=1.06\linewidth,
                ymin=32,
                ymax=74,
                xtick={0, 25, 50, 75, 100},
                ytick={30, 40, 50, 60, 70},
                xlabel style={yshift=0.25cm},
                ylabel style={yshift=-0.6cm},
                label style={font=\scriptsize},
                tick label style={font=\scriptsize},
                xticklabel={$\pgfmathprintnumber{\tick}$}
            ]

            \addplot [
                name path={CONVENTIONAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={CONVENTIONAL-COST},
                y expr=\thisrow{CONVENTIONAL-ACC}+\thisrow{CONVENTIONAL-ACC-STD}
            ] {\datatable};

            \addplot [
                name path={CONVENTIONAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={CONVENTIONAL-COST},
                y expr=\thisrow{CONVENTIONAL-ACC}-\thisrow{CONVENTIONAL-ACC-STD}
            ] {\datatable};

            \addplot[cRed2, draw=none, forget plot, fill opacity=0.3] fill between[of={CONVENTIONAL-U} and {CONVENTIONAL-L}];

            \addplot[
                cRed2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                x dir=both, x explicit,
                error bar style={line width=0.6pt, draw=cRed2}, 
                error mark=none, 
            ] table [
                x={CONVENTIONAL-COST},
                y={CONVENTIONAL-ACC}, 
                x error={CONVENTIONAL-COST-STD},
                y error={CONVENTIONAL-ACC-STD}
            ] {\datatable};
            \addlegendentry{\sftype{Conventional}}

            \addplot [
                name path={TOP1-L}, draw=none, forget plot, fill=none
            ] table [
                x={TOP1-COST},
                y expr=\thisrow{TOP1-ACC}+\thisrow{TOP1-ACC-STD}
            ] {\datatable};

            \addplot [
                name path={TOP1-U}, draw=none, forget plot, fill=none
            ] table [
                x={TOP1-COST},
                y expr=\thisrow{TOP1-ACC}-\thisrow{TOP1-ACC-STD}
            ] {\datatable};

            \addplot[cGreen, draw=none, forget plot, fill opacity=0.3] fill between[of={TOP1-U} and {TOP1-L}];

            \addplot[
                cGreen,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                x dir=both, x explicit,
                error bar style={line width=0.6pt, draw=cGreen}, 
                error mark=none, 
            ] table [
                x={TOP1-COST},
                y={TOP1-ACC}, 
                x error={TOP1-COST-STD},
                y error={TOP1-ACC-STD}
            ] {\datatable};
            \addlegendentry{\sftype{Top1}}

            \addplot [
                name path={TOP10-L}, draw=none, forget plot, fill=none
            ] table [
                x={TOP10-COST},
                y expr=\thisrow{TOP10-ACC}+\thisrow{TOP10-ACC-STD}
            ] {\datatable};

            \addplot [
                name path={TOP10-U}, draw=none, forget plot, fill=none
            ] table [
                x={TOP10-COST},
                y expr=\thisrow{TOP10-ACC}-\thisrow{TOP10-ACC-STD}
            ] {\datatable};

            \addplot[cGreen2, draw=none, forget plot, fill opacity=0.3] fill between[of={TOP10-U} and {TOP10-L}];

            \addplot[
                cGreen2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                x dir=both, x explicit,
                error bar style={line width=0.6pt, draw=cGreen2}, 
                error mark=none, 
            ] table [
                x={TOP10-COST},
                y={TOP10-ACC}, 
                x error={TOP10-COST-STD},
                y error={TOP10-ACC-STD}
            ] {\datatable};
            \addlegendentry{\sftype{Top10}}

            \addplot [
                name path={CONFORMAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={CONFORMAL-COST},
                y expr=\thisrow{CONFORMAL-ACC}+\thisrow{CONFORMAL-ACC-STD}
            ] {\datatable};

            \addplot [
                name path={CONFORMAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={CONFORMAL-COST},
                y expr=\thisrow{CONFORMAL-ACC}-\thisrow{CONFORMAL-ACC-STD}
            ] {\datatable};

            \addplot[cBlue2, draw=none, forget plot, fill opacity=0.3] fill between[of={CONFORMAL-U} and {CONFORMAL-L}];

            \addplot[
                cBlue2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                x dir=both, x explicit,
                error bar style={line width=0.6pt, draw=cBlue2}, 
                error mark=none, 
            ] table [
                x={CONFORMAL-COST},
                y={CONFORMAL-ACC}, 
                x error={CONFORMAL-COST-STD},
                y error={CONFORMAL-ACC-STD}
            ] {\datatable};
            \addlegendentry{\sftype{Conformal}($\alpha=0.1$)}

            \addplot [
                name path={ORACLE-L}, draw=none, forget plot, fill=none
            ] table [
                x={ORACLE-COST},
                y expr=\thisrow{ORACLE-ACC}+\thisrow{ORACLE-ACC-STD}
            ] {\datatable};

            \addplot [
                name path={ORACLE-U}, draw=none, forget plot, fill=none
            ] table [
                x={ORACLE-COST},
                y expr=\thisrow{ORACLE-ACC}-\thisrow{ORACLE-ACC-STD}
            ] {\datatable};

            \addplot[cPink, draw=none, forget plot, fill opacity=0.3] fill between[of={ORACLE-U} and {ORACLE-L}];

            \addplot[
                cPink,
                dashed,
                dash pattern=on 1.8pt off 1.2pt, 
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                x dir=both, x explicit,
                error bar style={line width=0.6pt, draw=cPink}, 
                error mark=none, 
            ] table [
                x={ORACLE-COST},
                y={ORACLE-ACC}, 
                x error={ORACLE-COST-STD},
                y error={ORACLE-ACC-STD}
            ] {\datatable};
            \addlegendentry{\sftype{Oracle}}
            
            \end{axis}
        \end{tikzpicture}
        \caption{Accuracy}
        \label{fig:candidate-(a)}
    \end{subfigure}
    \hspace{-2mm}
    \begin{subfigure}{.31\linewidth}
        \centering
        \begin{tikzpicture}
            \pgfplotstableread[col sep=comma]{data/query_design.csv}{\datatable}
            \begin{axis}[
                xlabel={Round},
                ylabel={Relative labeling cost (\%)},
                width=1.0\linewidth,
                height=1.06\linewidth,
                ymin=5,
                ymax=105,
                xtick={2, 4, 6, 8},
                ytick={20, 40, 60, 80, 100},
                xlabel style={yshift=0.25cm},
                ylabel style={yshift=-0.6cm},
                xmin=0.5,
                xmax=9.5,
                label style={font=\scriptsize},
                tick label style={font=\scriptsize},
                xticklabel={$\pgfmathprintnumber{\tick}$},
                yticklabel={$\pgfmathprintnumber{\tick}$}
            ]
            
            \addplot [
                name path={ORACLE-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{ORACLE-COST}+\thisrow{ORACLE-COST-STD}
            ] {\datatable};

            \addplot [
                name path={ORACLE-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{ORACLE-COST}-\thisrow{ORACLE-COST-STD}
            ] {\datatable};

            \addplot[cPink, fill opacity=0.3] fill between[of={ORACLE-U} and {ORACLE-L}];

            \addplot[
                cPink,
                dashed,
                dash pattern=on 1.8pt off 1.2pt, 
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cPink}, 
                error mark=none, 
            ] table [
                x={round},
                y={ORACLE-COST}, 
                y error={ORACLE-COST-STD}
            ] {\datatable};

            \addplot [
                name path={TOP1-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP1-COST}+\thisrow{TOP1-COST-STD}
            ] {\datatable};

            \addplot [
                name path={TOP1-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP1-COST}-\thisrow{TOP1-COST-STD}
            ] {\datatable};

            \addplot[cGreen, fill opacity=0.3] fill between[of={TOP1-U} and {TOP1-L}];

            \addplot[
                cGreen,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cGreen}, 
                error mark=none, 
            ] table [
                x={round},
                y={TOP1-COST}, 
                y error={TOP1-COST-STD}
            ] {\datatable};

            \addplot [
                name path={TOP10-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP10-COST}+\thisrow{TOP10-COST-STD}
            ] {\datatable};

            \addplot [
                name path={TOP10-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP10-COST}-\thisrow{TOP10-COST-STD}
            ] {\datatable};

            \addplot[cGreen2, fill opacity=0.3] fill between[of={TOP10-U} and {TOP10-L}];

            \addplot[
                cGreen2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cGreen2}, 
                error mark=none, 
            ] table [
                x={round},
                y={TOP10-COST}, 
                y error={TOP10-COST-STD}
            ] {\datatable};

            \addplot [
                name path={CONVENTIONAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONVENTIONAL-COST}+\thisrow{CONVENTIONAL-COST-STD}
            ] {\datatable};

            \addplot [
                name path={CONVENTIONAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONVENTIONAL-COST}-\thisrow{CONVENTIONAL-COST-STD}
            ] {\datatable};

            \addplot[cRed2, fill opacity=0.3] fill between[of={CONVENTIONAL-U} and {CONVENTIONAL-L}];

            \addplot[
                cRed2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cRed2}, 
                error mark=none, 
            ] table [
                x={round},
                y={CONVENTIONAL-COST}, 
                y error={CONVENTIONAL-COST-STD}
            ] {\datatable};

            \addplot [
                name path={CONFORMAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONFORMAL-COST}+\thisrow{CONFORMAL-COST-STD}
            ] {\datatable};

            \addplot [
                name path={CONFORMAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONFORMAL-COST}-\thisrow{CONFORMAL-COST-STD}
            ] {\datatable};

            \addplot[cBlue2, fill opacity=0.3] fill between[of={CONFORMAL-U} and {CONFORMAL-L}];

            \addplot[
                cBlue2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cBlue2}, 
                error mark=none, 
            ] table [
                x={round},
                y={CONFORMAL-COST}, 
                y error={CONFORMAL-COST-STD}
            ] {\datatable};

            \end{axis}
        \end{tikzpicture}
        \caption{Relative labeling cost}
        \label{fig:candidate-(b)}
    \end{subfigure}
    \hspace{3mm}
    \begin{subfigure}{.31\linewidth}
        \centering
        \begin{tikzpicture}
            \pgfplotstableread[col sep=comma]{data/query_design.csv}{\datatable}
            \begin{axis}[
                xlabel={Round},
                ylabel={GT inclusion rate (\%)},
                width=1.0\linewidth,
                height=1.06\linewidth,
                ymin=0,
                ymax=105,
                xtick={2, 4, 6, 8},
                ytick={20, 40, 60, 80, 90, 100},
                xlabel style={yshift=0.25cm},
                ylabel style={yshift=-0.6cm},
                xmin=0.5,
                xmax=9.5,
                label style={font=\scriptsize},
                tick label style={font=\scriptsize},
                xticklabel={$\pgfmathprintnumber{\tick}$}
            ]
            
            \addplot [
                name path={ORACLE-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{ORACLE-IR}+\thisrow{ORACLE-IR-STD}
            ] {\datatable};

            \addplot [
                name path={ORACLE-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{ORACLE-IR}-\thisrow{ORACLE-IR-STD}
            ] {\datatable};

            \addplot[cPink, fill opacity=0.3] fill between[of={ORACLE-U} and {ORACLE-L}];

            \addplot[
                cPink,
                dashed,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cPink}, 
                error mark=none, 
            ] table [
                x={round},
                y={ORACLE-IR}, 
                y error={ORACLE-IR-STD}
            ] {\datatable};
            
            \addplot [
                name path={TOP1-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP1-IR}+\thisrow{TOP1-IR-STD}
            ] {\datatable};

            \addplot [
                name path={TOP1-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP1-IR}-\thisrow{TOP1-IR-STD}
            ] {\datatable};

            \addplot[cGreen, fill opacity=0.3] fill between[of={TOP1-U} and {TOP1-L}];

            \addplot[
                cGreen,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cGreen}, 
                error mark=none, 
            ] table [
                x={round},
                y={TOP1-IR}, 
                y error={TOP1-IR-STD}
            ] {\datatable};

            \addplot [
                name path={TOP10-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP10-IR}+\thisrow{TOP10-IR-STD}
            ] {\datatable};

            \addplot [
                name path={TOP10-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{TOP10-IR}-\thisrow{TOP10-IR-STD}
            ] {\datatable};

            \addplot[cGreen2, fill opacity=0.3] fill between[of={TOP10-U} and {TOP10-L}];

            \addplot[
                cGreen2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cGreen2}, 
                error mark=none, 
            ] table [
                x={round},
                y={TOP10-IR}, 
                y error={TOP10-IR-STD}
            ] {\datatable};

            \addplot [
                name path={CONVENTIONAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONVENTIONAL-IR}+\thisrow{CONVENTIONAL-IR-STD}
            ] {\datatable};

            \addplot [
                name path={CONVENTIONAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONVENTIONAL-IR}-\thisrow{CONVENTIONAL-IR-STD}
            ] {\datatable};

            \addplot[cRed2, fill opacity=0.3] fill between[of={CONVENTIONAL-U} and {CONVENTIONAL-L}];

            \addplot[
                cRed2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cRed2}, 
                error mark=none, 
            ] table [
                x={round},
                y={CONVENTIONAL-IR}, 
                y error={CONVENTIONAL-IR-STD}
            ] {\datatable};

            \addplot [
                name path={CONFORMAL-L}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONFORMAL-IR}+\thisrow{CONFORMAL-IR-STD}
            ] {\datatable};

            \addplot [
                name path={CONFORMAL-U}, draw=none, forget plot, fill=none
            ] table [
                x={round},
                y expr=\thisrow{CONFORMAL-IR}-\thisrow{CONFORMAL-IR-STD}
            ] {\datatable};

            \addplot[cBlue2, fill opacity=0.3] fill between[of={CONFORMAL-U} and {CONFORMAL-L}];

            \addplot[
                cBlue2,
                thick,
                mark=*,
                mark options={scale=0.4, solid},
                error bars/.cd,
                y dir=both, y explicit, 
                error bar style={line width=0.6pt, draw=cBlue2}, 
                error mark=none, 
            ] table [
                x={round},
                y={CONFORMAL-IR}, 
                y error={CONFORMAL-IR-STD}
            ] {\datatable};
            \end{axis}
        \end{tikzpicture}
        \caption{\edited{GT inclusion rate}}
        \label{fig:candidate-(c)}
    \end{subfigure}
    \caption{Impact of the candidate set design evaluated on CIFAR-100 using conventional query with all classes (\sftype{Conventional}),
    top-1 prediction from model (\sftype{Top1}), top-10 prediction from model (\sftype{Top10}),
    our method with conformal prediction with fixed $\alpha=0.1$ (\sftype{Conformal}($\alpha=0.1$)), and the smallest top-k prediction sets always including ground-truth class (\sftype{Oracle}).
    For comparison, the same entropy sampling is used to keep the accuracy at each round constant, focusing solely on the labeling cost and isolating the effect of the candidate set design.
    (a) Our method constantly outperforms the baselines in accuracy (\%) relative to labeling cost (\%).
    (b) Our design achieves a greater reduction in labeling cost compared to the baselines.
    (c) Our candidate set effectively includes the ground-truth class in over 90\% of cases ($=1-\alpha$), even when model accuracy is low.}
    \label{fig:candidate}
\end{figure*}
