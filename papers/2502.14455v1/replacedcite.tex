\section{Related works}
In this section, we first go over insect detection and control and then focus on the problem of routing in autonomous vehicles.

\subsection{Pest detection and control}

% Standard farming methods rely on the heavy use of pesticides to avoid pest diffusions, which are among the most dangerous events that can destroy cultivated fields, with the downside of potential health issues and environmental impact____.
% Modern approaches use smart traps____ to monitor insects such as Cydia pomonella____ or Popillia japonica____ and then rely on humans____ or autonomous ground robots____ to actuate pest control on the area that is affected by the pest diffusion.
% This trap-based system allows a reduction in the use of the pesticide compared to the coarse-grained strategy of spraying over the entire field.
% However, trap-based insect monitoring cannot guarantee complete field coverage. 
% This results in non-minimal use of pesticides and ground pest control robot time due to the need to spray pesticides in a broader area w.r.t. the one strictly required.

\begin{table*}[t]
    \small
    % \centering
    \caption{Network survey (number of parameters, operations, throughput, and mAP) on the models used in____ and extended with an additional one introduced in our work (\textbf{in bold}). The GPU employed is an Nvidia GeForce RTX 2080. The number of operations is measured with multiply-accumulate operations (MACs).}
    \label{tab:other_models_params}
    %\addtolength{\tabcolsep}{15pt}
    \resizebox{\linewidth}{!}{%
    \begin{tabular}{llcccccc}
    \toprule
    \textbf{Network} & \textbf{Input size} & \textbf{\# Param. [\SI{}{\mega\nothing}]} & \textbf{\# Op. [\SI{}{\giga MAC}]} & \textbf{Device} & \textbf{Frame-rate [\SI{}{\hertz}]} & \textbf{mAP}\\
    \toprule
    FasterRCNN-VGG16-FPN & $800\times800\times3$ & 31.90 & 275.23 & GPU & 11.90 & 0.92\\
    % \midrule
    FasterRCNN-ResNet101-FPN & $800\times800\times3$ & 60.20 & 167.41 & GPU & 11.23 & 0.92\\
    % \midrule
    FasterRCNN-DenseNet169-FPN & $800\times800\times3$ & 30.00 & 73.99 & GPU & 7.59 & 0.91\\
    % \midrule
    FasterRCNN-MobileNetV3-FPN & $800\times800\times3$ & 18.90 & 18.41 & GPU & 60.92 & 0.93\\
    \midrule
    % \midrule
    RetinaNet-VGG16-FPN & $800\times800\times3$ & 22.90 & 270.06 & GPU & 12.37 & 0.91\\
    % \midrule
    RetinaNet-ResNet101-FPN&$800\times800\times3$&51.20&174.85 &GPU&11.83&0.93\\
    % \midrule
    RetinaNet-DenseNet169-FPN&$800\times800\times3$&21.00&65.10 &GPU&18.49&0.92\\
    % \midrule
    RetinaNet-MobileNetV3-FPN&$800\times800\times3$&10.60&11.09 &GPU&48.91&0.91\\
    \midrule
    % \midrule
    SSD-VGG16&$300\times300\times3$&12.10&26.58 &GPU&42.58&0.56\\
    % \midrule
    SSD-ResNet101&$300\times300\times3$&32.30&42.39 &GPU&29.76&0.87\\
    % \midrule
    SSD-DenseNet169&$300\times300\times3$&11.80&24.51&GPU&28.59&0.92\\
    % \midrule
    SSD-MobileNetV3&$300\times300\times3$&7.50&3.42&GPU&33.20&0.80\\
    % \midrule
    \midrule
    \textbf{SSDLite-MobileNetV3}&\textbf{$\mathbf{320\times240\times3}$}&\textbf{3.44}&\textbf{0.58}&\textbf{GAP9}&\textbf{6.8}&\textbf{0.79}\\
    % \midrule
    %\textbf{FOMO-MobileNetV2}&\textbf{160$\times$160$\times$3}&\textbf{0.02}&\textbf{0.02}&\textbf{STM32}&\textbf{--- }&\textbf{0.78}\\
    \bottomrule
    % \vspace{0.1pt}
    \end{tabular}
    }
\end{table*}

%Farms are changing the way they perform pest detection and control.
%Originally, standard techniques relied on generalized pesticide use on the entire fields to avoid pest diffusions with the downside of potential health issues, environmental impact____, and waste of resources.
%Recently, with the development of smart farms, the focus has switched to the localized use of pesticides____.
%In order to do so, currently available techniques rely on smart traps____ to monitor insects such as Cydia pomonella____ or %Popillia japonica____ and then rely on humans____ or autonomous ground robots____ to treat the area that is affected by the pest diffusion thus reducing the use of pesticides if compared to standard techniques.
%Smart trap-based insect detectors mostly leverage image-based deep learning models, as surveyed by~\cite {PestDetectionSurvey}. 
%For example, the work by____ adopts a FasterRCNN-based detector____, while____ uses a Single Shot Multibox Detector (SSD)____, ____ uses RetinaNet____, and ____ employs R-FCN____, for detecting small insects.
%In Table~\ref{tab:other_models_params} we report the models studied by____, together with a MobileNet-based model____ we adopt in this work (last \textbf{bold} line).
%It appears clear how these models require desktop-class, power-hungry computational devices to achieve a throughput higher than $1$ or $2$ frames per second. 
%\firstreviewer{Even though smart traps work properly with reduced frame rates ($\sim$\SI{0.2}{frame/\second}____) they still run on battery and, as such, they need to limit the power consumption avoiding the use of power-hungry GPUs onboard ($\sim$\SI{100}{\watt}), and as such, they rely on cloud-based platforms for image processing to perform pest detection____.
%Nano-UAVs have a three-fold limit. 
%In fact, they can not afford to host a desktop-class GPU onboard due to the power demand ($\sim$\SI{100}{\watt}) and the payload available onboard ($\sim$\SI{20}{\gram}), which is insufficient for the hardware ($\sim$\SI{1}{\kilo\gram}).
%Furthermore, a low frame rate, suitable for smart traps, limits UAVs. They have a limited battery lifetime for exploration and pest detection, i.e., \SI{6}{\minute}, and a reduced frame rate will result in the UAV hovering while processing the captured frame, thus wasting exploration time.}

Traditional techniques to avoid spreading dangerous insects in cultivated fields have employed coarse-grained use of pesticides spraying entire fields, with the downside of potential health issues, environmental impact____, and waste of resources.
More fine-grained control of pest outbreaks can be achieved by relying on humans to visually inspect crops and manually treat only where needed, but this approach is expensive and potentially dangerous for human operators.
An important step forward in the precise treatment of pests has been achieved by introducing insect traps, originally monitored by humans____ and later on, thanks to the advent of battery-powered embedded systems featuring automatic bug detection capabilities.
This novel technology, also called \textit{smart traps}____, has been successfully utilized against the Cydia pomonella____ and the Popillia japonica____, leaving the final chemical treatment either to humans____ or by autonomous ground robots____.

SoA insect detectors, employed in combination with smart traps, leverage image-based computationally intensive deep learning models____, as surveyed by____.
Table~\ref{tab:other_models_params} presents a broad overview of SoA models for pest detection, based on____, with the addition (last row) of our proposed model, which is based on a MobileNet CNN____.
As surveyed in Table~\ref{tab:other_models_params}, SoA algorithms require a significant amount of computational and memory resources in the order of high-end GPUs.
For this reason, smart traps rely on remote powerful servers to perform pest detection____ on streamed images, which \textit{i}) hinges on the power consumption of smart trap due to radio transmission, \textit{ii}) requires additional infrastructure, e.g., 4G/5G radio modules, and \textit{iii}) raises cyber-security concerns on the communication channel, requiring further complexity to implement robust security features. 
These limitations can be overcome using standalone smart traps or autonomous nano-UAVs to perform pest detection, but introduce the challenge of accurate detection within the limited power envelope of MCU-class processors, i.e., sub-\SI{100}{\milli\watt} computational power.
Finally, in the case of autonomous nano-UAVs
However, nano-UAVs have the additional requirements of real-time onboard inference, as we want to explore the largest area possible in their limited lifetime, i.e., $\sim$\SI{6}{\minute}, meanwhile inspecting the cultivated field.

Recent works allow the deployment of object detection algorithms on the edge.
Squeezed edge YOLO____ performs object detection within less than 1 million parameters and can be deployed on parallel ultra-low power SoC.
The work by____ introduces a Viola-Jones-based algorithm for detecting Cydia pomonella.
This algorithm runs on a battery-powered embedded system mounted on sticky pad-based traps.
Despite the simplicity of this approach, which uses pre-trained visual patches on a reduced amount of data, it peaks at \SI{2.5}{frame/\second} on a GWT GAP8 SoC. 
The approach, however, does not allow for the classification of different insects, which is part of our task.
____ adopts a YOLO network to detect insects in aerial UAV images. 
The method is accurate (up to 0.92 of mAP), but struggles with clusters of insects, as non-maximum suppression removes detections with high intersection over union.
Finally, ____ presents an SSD-MobileNetV2 object detection algorithm fully deployed on the GAP8 SoC running aboard an autonomous nano-UAV to detect tin cans and bottles.
This system reaches up to \SI{1.6}{frame/\second} with an mAP of 0.5.
Similarly, in the work by____, a GAP8 SoC is employed for automatic license plate recognition, using a MoileNetV2 with an SSDLite detector.
In this work, we employ MobileNets____ and pair them with an SSDLite detector head on the GAP9 SoC, achieving a peak throughput of~\SI{6.8}{frames/second}. 
This approach enables precise insect detection and classification on resource-constrained devices, making it suitable for deployment on autonomous nano-UAVs.
As such, w.r.t. currently available object detection algorithm running on resource-constrained platforms that can fit the power envelope of our nano-UAV, we improve the mAP by $\sim$0.3, reaching an mAP of 0.79 with our onboard running CNN, allowing real-world applicability of our system.

\subsection{Routing for autonomous transportation systems}

In our scenario, vehicle routing must be addressed at two different levels: global and local.  
Global routing consists of defining the overall path to follow in order to completely explore an area or visit a set of points of interest, while minimizing some cost metric. 
This problem is widely known in literature as the traveling salesman problem (TSP).  
Local routing, instead, consists of reactive planning of a local path, following some goal while avoiding unexpected obstacles the vehicle might encounter.  
The work by____, similarly to ours, presents a partitioning of the routing problem between global routing, for the overall path, and local routing, for obstacle avoidance. 
However, they focus on a setting with a single land vehicle.

\paragraph{Global routing}
The TSP is a well-known optimization problem: the objective is to find the route the salesman has to travel to visit a set of destinations, represented as nodes in a graph, which minimizes some cost metrics. 
Our global routing scenario falls within the category of multiple traveling salesman problem (MTSP), which is a generalization of TSP to the multiple agent setting~\cite {cheikhrouhou2021comprehensive}, generally cooperative.
In this scenario, common metrics to minimize are the total path length among agents (Min-Sum) or the maximum path length (Min-Max). 
Variations of MTSP may involve multiple depots from which the salesman can depart or arrive, as well as constraints on departing and arriving at the same depot. 
Moreover, specific applications may adopt additional optimization objectives, like travel time or resource consumption minimization. 

In some cases (e.g., UAVs), additional constraints might be considered, like fuel or physical maneuverability. 
The MTSP problem can be decomposed into a node assignment part, in which each node in the exploration graph is assigned to a specific agent, and a path planning part, in which the path over the assigned sub-graph is computed independently for each agent. 
Exact methods for the multiple depots MTSP have been proposed____. 
However, these are computationally expensive in general. 
The most widely adopted approaches are so-called meta-heuristics, which use optimization algorithms to find near-optimal solutions with less computational demands. 
In this category, evolutionary approaches, such as genetic algorithms (GA), have been widely adopted____, while also particle swarm optimization (PSO)____, ant colony optimization (ACO)____ and artificial bee colonies (ABC)____ have been proposed to address the task. 

Market-based approaches have also been explored to a lesser extent____. 
These techniques treat the optimization process as an auction, in which tasks (nodes) are assigned based on the agent's bidding. 
In recent years, research on the MTSP has moved to take UAVs into account.
____ proposed an approach based on location clustering for task assignment and GA to path definition in the context of wireless sensory networks and mobile sinks. 
____, proposes a classical GA algorithm with a time minimization objective for UAVs in search and rescue missions, while____ proposes GA combined with a hierarchical approach to solving the planning task in the context of pesticide spraying in precision agriculture.
____ specifically addresses the problem of energy constraints in UAVs, in the context of coverage path planning, using a modified GA which explicitly considers the resource limitations of such vehicles. 
Conversely, ____ proposed a routing algorithm that accounts for explicit constraints in task execution time (i.e., travel time) by using task clustering and a modified GA for constrained path planning. 
____, differently from previous work, proposes the usage of reinforcement learning (RL) for task (node) assignment, while single path planning can be handled by any available solver.  

\paragraph{Local routing}
Local routing consists of solving the problem of finding an optimal local path (i.e., a path relative to the robot's vicinity w.r.t. its speed and distance from objects), which minimizes deviation from the global path, while avoiding collisions. 
Usually, this is implemented by minimizing some cost function that accounts for real-time information coming from onboard sensors (e.g., LIDAR, sonar, and cameras).  
Overall, these algorithms modify the robot's planned path to implement reactive behavior in the autonomous vehicle while still reaching some goal.  
____, adopts the time elastic band (TEB) algorithm____, which formulates the local routing problem as finding the optimal sub-path in a dynamic hyper-graph which jointly represents the global path (as a sequence of vehicle states) and feasibility constraints (e.g., velocity, obstacles). 
The optimization problem is then solved by a non-linear programming solver, and the hyper-graph's sparsity plays an important role in terms of computation time.  

____ propose a local routing algorithm based on combining the dynamic window approach (DWA)____, for optimal velocity planning, with an improved follow the gap method (FGM)____, for obstacle avoidance.  
DWA tries to find the optimal velocity, given the robot's physical constraints, to reach the goal while avoiding static obstacles, resulting in non-reactive behavior.  
FGM, on the other hand, determines the optimal approach angle to avoid collision by fitting in the largest gap between observed obstacles. 
This approach is strongly geared towards safety rather than optimal task execution time, i.e., it favors avoiding collisions, even if it means selecting a longer path.
____ originally proposed the artificial potential fields (APF) approach, which models goals as attractive fields and obstacles as repulsive fields guiding the robot. 
This approach, however, has difficulties handling local minima and is not guaranteed to reach the goal.  
Another known approach to local routing is that of vector field histograms (VFH)____, which statistically models the surrounding environment in the form of histogram grids, whose values are based on sensor readings. 
This approach then selects the local path to go towards regions of low collision probability that are headed in the goal's direction.  

In choosing routing algorithms, we must consider two peculiar aspects of our setting: UAVs will always explore the same area, while land robots will explore different areas based on the information provided by UAVs. 
Given this, exact algorithms can be used for global routing, as computation is sporadic and can be carried out on unconstrained devices.
Conversely, to avoid unexpected obstacles, such as workers or animals, which are not known when the global path is computed, we need a local planner running in real time onboard the robots.
This demands short execution time, thus heuristic techniques that do not explore all possible paths.

In this work, we are focusing on proposing a novel combination of known concepts (e.g., object detection and autonomous transportation) to enable optimized, fully autonomous pest control in the open field.
We adopt the classic A*____ algorithm for both global and local routing.
A* is a graph-based path planning algorithm that has a computational cost dependent on the cost metrics used to compute the path.
The cost metric that we use, i.e., Euclidean distance and the Euclidean distance weighted with the type of destination node (as explained in Section~\ref{subsec:routing}), are lightweight and, as such, allow the real-time computation onboard each \SI{50}{\gram} nano-UAV of our swarm in the local routing version, thus, using the 4$\times$\SI{4}{\meter} local occupancy map.
Our approach provides a solution for obstacle avoidance that can run on resource-constrained nano-UAVs in real-time, allowing the detection of static and dynamic obstacles with maximum speeds that range from~\SI{4.5}{\meter/\second} to ~\SI{19.5}{\meter/\second} depending on the dimension and distance of the obstacle.
To the best of our knowledge, this work provides the first graph-based solution for obstacle avoidance on nano-UAVs relying only on onboard computations.


Furthermore, our work also provides novel solutions if we consider the complete transportation system composed of the nano-UAVs and the ground robot. 
The only prior work that considers the task of carrying out pest control using autonomous vehicles is____. 
In such work, standard-sized quadcopters follow a pre-computed route, optimized offline, to spray an area with pesticides. 
Even though our specific task differs, our approach's innovations can be transferred to the setting in____. 
In particular, instead of spraying an entire area with pesticides, we autonomously detect locations that require intervention using fast and effective nano-UAVs. 
The actual intervention is carried out only when and where it is required by a large and slow ground vehicle, resulting in a drastic reduction of time, particularly for early detected insect hotspots.