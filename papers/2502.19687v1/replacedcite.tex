\section{Related Work}
\label{related_work}
\subsection{Security of ADS}
The significance of ensuring the security of ADS cannot be overstated, as it directly impacts public safety, industry development, and societal acceptance of the technology. ____ highlights the critical role of safety research in autonomous driving, acknowledging the presence of safety and security issues that regulatory bodies must address. The operational safety of AVs in real traffic environments and the types of security-related vulnerabilities are also emphasized, underscoring the pivotal nature of safety in public trust. Furthermore, advances in cloud services and big data analytics for enhancing traffic efficiency and safety, as mentioned by____, can be instrumental in bolstering the performance and security of ADS. Currently, data privacy protection and advanced data security technologies are gaining attention, especially in the context of vehicle communication networks____. Moreover, research on enhancing system robustness, such as through the application of Named Data Networking (NDN) in Vehicular Ad Hoc Networks (VANETs), is proved as essential for maintaining stability and resilience against dynamic changes and attacks____. The integration of Internet of Things (IoT) in intelligent transportation systems, as explored by____, further emphasizing the need for robust data handling and analysis to ensure reliability and security.

However, various security threats pose challenges to the integrity and functionality of vehicles. These include AI safety issues % in self-driving cars should be addressed, as they 
being exploited by malicious actors, physical attacks on sensors, software vulnerabilities leading to system failures, and data pollution that can mislead decision-making processes____. %Additionally, data pollution and potential software flaws are touched upon by
And ____ especially highlighted the importance of %data security in 
preventing adversarial attacks based on data pollution and potential software flaws. %While the role of NDN is primarily discussed in enhancing communication security, implying strategies that could counteract physical and software-based threats____.
____ further expanded on the security challenges in vehicular networks, including data privacy and protection against a spectrum of attacks. Meanwhile, a comprehensive study on software defects in AVs was conducted, analyzing 499 defects from two leading open-source ADS--Apollo and Autoware--and providing a classification system____. However, similarly to many other studies, these researches focused on commits rather than directly examining the codebase. It was limited to vulnerabilities that had already been discovered and resolved, without offering warnings for potential, undiscovered vulnerabilities, and required a significant expenditure of human labor for analysis. Our research leverages CodeQL to systematically analyze vulnerabilities in ADS (examples can be found in Section \ref{examples}), contributing to a more detailed and comprehensive vulnerability distribution.


\subsection{Life Cycle and Duration of Vulnerabilities}
Researches have delved into the dynamics of how vulnerabilities are introduced, their causes, distribution, duration, and the typical methods employed for their detection and remediation. A significant finding from a large-scale analysis on open-source JavaScript projects revealed that vulnerabilities are often introduced during maintenance activities, such as bug fixes, and can persist in the codebase for an extended period, with an average lifetime of 511 days, increasing the window of opportunity for potential exploitation____. And the study further underscores the criticality of the remediation phase, noting that in 90\% of the projects analyzed, commits fixing existing vulnerabilities inadvertently introduced new ones. These statistics underscore the complexity of the remediation process and the potential for new security issues to arise from attempted fixes. 

And the vulnerabilities that persist in the software can have significant implications beyond the immediate security risks. Undetected vulnerabilities lead to data breaches and system compromises, and in turn can erode trust among users____.____ highlighted the concerns of industry security practitioners about the lack of success in fixing vulnerabilities. %due to various reasons, including a lack of management attention and developer knowledge. 
This emphasizes the need for a robust vulnerability management process that includes not only the technical aspects of detection and remediation but also the organizational and procedural elements that support timely and effective responses. Our research builds upon this understanding, applying CodeQL to analyze the persistence and remediation of vulnerabilities in ADS, aiming to get a more targeted result of their life cycle, and thus enhance the efficacy of vulnerability management practices.



\subsection{Methods for Testing and Validating ADS}

Various testing methodologies have been employed to ensure the reliability and safety of complex technologies. Simulation testing, as discussed in many studies____, is crucial for identifying potential vulnerabilities and system failures in a risk-free setting. Automated vulnerability report analysis and genetic algorithms like AV-FUZZER have proven effective in simulating various traffic behaviors and identifying vulnerabilities____. Meanwhile, real-world testing entails deploying actual vehicles or devices in operational settings to collect data and analyze behaviors under naturalistic conditions____. The collected data also contributes to the foundation and baseline for simulation testing____. These methods help to understand the prevalence of IoT device vulnerabilities and their exploitation in real attacks, but cannot be performed very often because of their costs and dependencies on ADS as a whole.


The adoption of automated testing methods is further exemplified by____, who used static analysis to increase testing efficiency and reduce the reliance on expert human analysis as an approach to detect vulnerabilities in IoT devices. Static code analysis has also been recognized for other advantages, such as the ability to examine code systematically, allowing the identification of vulnerabilities that could potentially be missed during runtime testing____. The method faces challenges as being resource-intensive, and its complexity may lead to a high rate of false positives, which can undermine the confidence of developers in the efficacy of the tools____. This is partly because Rice's Theorem tells us that there are inherent limits to predicting program behavior perfectly. Due to the fact that non-trivial semantic properties of programs are undecidable, there is no algorithm that can determine them for all possible programs____. However, despite these limitations, attention is increasingly being paid in scenarios where code integrity and security are paramount, such as in the development of IoT systems, in which vulnerabilities can have severe consequences____. CodeQL, by monitoring the compilation process to perform static scans, possesses a degree of dynamism that mitigates some of the traditional issues associated with static analysis, offering a more reliable understanding of code behavior.

The empirical study conducted by____ reveals that among the top repositories on GitHub, only a fraction - 37\% for workflows and 7\% for security policies - is actively employing these critical security measures, indicating a significant room for improvement in the adoption of static analysis tools. The study also found that only 13.5\% of the top repositories that support CodeQL had it enabled, while the outcomes turned out to be beneficial____. In Table \ref{tool_comparison}, while there are many static analysis tools like Snyk, Flawfinder, and SonarQube, they are limited by their language support, customization degree, and detection cost. Their scanning coverage does not fully satisfy our research requirements____. And the experience of developers on some of these tools (specifically, Snyk and SonarQube) also shows a significant decrease in accuracy compared to CodeQL%, but also a tendency to induce bugs (specifically, SonarQube) from the suggested repairs in their bug reports
____. CodeQL, developed by GitHub, stands out for its ability to perform customized deep semantic analysis in the context of multilingual software systems____, underscoring its practical value. Therefore, its effectiveness was evaluated and further utilized in our study to help bridge the gap between low cost and high quality of the testing approach.

% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table*}[]
\caption{Comparison of Different Static Analysis Tools for Security}
\label{tool_comparison}
\scalebox{1}{%
\begin{tabular}{llllllll}
\hline
\multirow{2}{*}{TOOLS} &
  \multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}LANGUAGE\\ SUPPORT\end{tabular}} &
  \multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}CUSTOMIZATION\\ DEGREE\end{tabular}} &
  \multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}DETECTION\\ COST\end{tabular}} &
  \multirow{2}{*}{\begin{tabular}[c]{@{}l@{}}FULL CWE\\ COVERAGE\end{tabular}} &
  \multicolumn{3}{l}{\begin{tabular}[c]{@{}l@{}}SCANNING\\ COVERAGE\end{tabular}} \\ \cline{6-8} 
                &                                    &               &                 &              & cpp & py & js \\ \hline
Snyk            & C/C++, JavaScript, Python          & Medium        & Medium          & 106          & 14  & 15 & 14 \\ \hline
Flawfinder      & C/C++                              & Low           & Low             & 20           & 9   & 0  & 0  \\ \hline
SonarQube       & C/C++, JavaScript, Python          & High          & High            & 178          & 13  & 17 & 15 \\ \hline
\textbf{CodeQL} & \textbf{C/C++, JavaScript, Python} & \textbf{High} & \textbf{Medium} & \textbf{323} & \textbf{27} & \textbf{18} & \textbf{23} \\ \hline
\multicolumn{8}{p{450pt}}{Note. The `LANGUAGE SUPPORT' does not represent languages the tool able to scan, but lists the languages predominantly used in ADS that supported by it. The `SCANNING COVERAGE' means how many CWE categories can be detected through these tools in our planned testing list.% The customization degree of Snyk is rated as `Medium' because it is still a preview feature under test. And scanning cost of SonarQube is `High' 
} \\
\end{tabular}%
}
\end{table*}


\subsection{Conclusive Summary}

% The existing researches on the security of ADS highlight the importance of robust safety measures and advanced data security technologies to ensure public trust and social acceptance. Studies such as those by____ and____ emphasize the need for addressing safety and security issues in ADS through enhanced operational safety and data privacy protection. The role of NDN in improving communication security and the integration of IoT in intelligent transportation systems are also identified as essential for maintaining system stability and resilience____. However, despite these advancements, various security threats continue to pose challenges to the integrity and functionality of vehicles.

% Recent research has shown that vulnerabilities in ADS can persist for extended periods, often introduced during maintenance activities and challenging to remediate effectively____. Various testing methodologies, including simulation and real-world testing, have been employed to identify and mitigate these vulnerabilities____. Static code analysis, particularly tools like CodeQL, has emerged as an effective method for systematic vulnerability detection, offering a more reliable and efficient approach compared to traditional testing methods____. However, the adoption of static analysis tools in open-source projects remains limited, indicating a significant room for improvement in vulnerability management practices.

% Our study builds upon these findings by leveraging CodeQL to systematically analyze vulnerabilities in ADS, aiming to provide a more detailed and comprehensive understanding of their distribution and persistence. This approach not only enhances the security of ADS but also contributes to the development of more effective vulnerability management practices, bridging the gap between low-cost and high-quality testing approaches. By integrating empirical research with actionable strategies, our work aspires to advance the field of autonomous driving and bolster the security and reliability of ADS.

The security of ADS is foundational to public trust and system integrity, yet it faces persistent challenges from AI exploits, sensor attacks, software flaws, and data pollution. Existing research, while highlighting critical vulnerabilities and remediation strategies, often lacks comprehensive codebase analysis or overlooks undiscovered risks. Vulnerabilities in ADS often emerge during maintenance and persist for extended periods% (e.g., 511 days on average)
, underscoring the complexity of remediation and the risk of introducing new flaws. This necessitates robust vulnerability management that integrates technical, organizational, and procedural measures.

Testing methodologies, including simulation, real-world trials, and static analysis, are vital for identifying vulnerabilities. While simulation and real-world testing provide more direct links between security and ADS, their cost and static limitations hinder scalability. Static analysis tools have offered a more cost-effective choice, but they face limitations in language support and accuracy. CodeQL emerges as a superior solution, enabling deep semantic analysis across multilingual systems, bridging the gap between cost efficiency and high-quality testing. Its adoption, however, remains limited, signaling untapped potential in preemptive threat modeling. Our study leverages CodeQL to address these gaps, offering a granular view of vulnerability distribution and lifecycle dynamics. We advance the field of autonomous driving by systematically analyzing vulnerabilities, reinforcing the need for proactive, integrated security practices to enhance ADS resilience and reliability.

%\vspace*{-3pt}