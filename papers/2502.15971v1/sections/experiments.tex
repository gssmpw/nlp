The first task in any neuroendovascular surgery is reaching the brain vessels from the aorta through the carotid arteries. In clinical practice, multiple trials may be necessary for a surgeon to identify an optimal path that bypasses certain branches and reaches the target branch. 

For validation of the planner presented in Section \ref{sec:planning}, an experimental setup was designed to simulate this navigation task. We built a robotic platform (Fig. \ref{fig:actuation_system}a), described in Section \ref{subsect:actuation_system}, to actuate the tools as commanded by the planner. The objective is to guide the tools through a model of the aorta and into the \gls{lcca}, avoiding the \gls{lsa}. A phantom model of the aorta (Fig. \ref{fig:actuation_system}b), from blenderkit library (blenderkit.com), was printed using a stereolithography (SLA) printer. The tools used in this setup (Fig. \ref{fig:actuation_system}c) include a Radifocus Glidewire Guidewire (Tool 1) with a 0.035\,inch diameter, 260\,cm length, and a 3\,cm angled tip, and a straight Terumo Radifocus Glidecath Catheter (Tool 2) with a 1.70\,mm diameter and 100\,cm length. The guidewire used for the experiments consists of a nitinol core, and for modeling purposes, the Young's modulus was taken primarily as that of NiTi (70\,GPa), as it dominates over the guidewireâ€™s coating material. The catheter's Young's modulus was assumed negligible, given its much more flexible nature when compared to the NiTi guidewire. 

The planner was applied to this setup to identify a feasible path for the guidewire from the initial configuration to the target location (the \gls{lcca}) while avoiding the \gls{lsa}. 
The results are shown in Fig. \ref{fig:plan}. We ran the algorithm for 100 configurations (Explored Configurations in Fig. \ref{fig:plan}) and found the shortest path from the initial configuration \circled{1}, where both tools are inserted of 12.5\,mm inside the aorta, to the target \circled{6} in the \gls{lcca}. For this task, the planner only required actuation of the guidewire. Hence, we built a robot for only guidewire actuation, as described in Section \ref{subsect:actuation_system}.


\begin{figure}[t] 
    \centering
    \includegraphics[width=\columnwidth]{figures/actuation_system.png}
    \caption{Components of the experimental setup. a) Actuation system for controlling guidewire translation and rotation; b) Guidewire and Catheter system inside anatomy; c) Tools configuration parameters.}
    \label{fig:actuation_system}
\end{figure}


\begin{figure}[t] 
    \centering
    \includegraphics[width=\columnwidth]{figures/plan.png}
    \caption{Contact-aware planned path from base of descending aorta to \gls{lcca}, avoiding \gls{lsa}. \circled{1} Start configuration, \circled{6} End configuration.}
    \label{fig:plan}
\end{figure}


\subsection{Actuation System}

\label{subsect:actuation_system}
Fig. \ref{fig:actuation_system}a, illustrates an actuation system designed to control the translation and rotation of the guidewire. For translation of the guidewire along its axis, a 100\,mm linear stage with a T6$\times$1 lead screw driven by Nema 11 stepper motor is used. For the rotation of the guidewire around its axis, a gear assembly was designed, including a driver gear and a driven gear to transmit controlled rotational motion to the guidewire. The driver gear (Gear 1), connected to a Nema 17 stepper motor, has a pitch diameter of 41\,mm with 80 teeth, while the driven gear (Gear 2) has a pitch diameter of 7\,mm and 12 teeth, allowing the rotational control. 

The catheter is held in place using a catheter holder, while the two guidewire holders keep the guidewire stable and aligned, preventing it from moving off-axis. These holders help keep the guidewire straight and avoid any twisting, coiling, or folding back of the guidewire into the catheter.

An arduino Uno REV3 along with a CNC shield V3 extension board and A4988 stepper motor drivers are used are used to control the actuation system.

As discussed in Section \ref{sec:planning}, the planner commands number of segments inserted for the guidewire, $M \triangleq M_1$. Given the length of each infinitesimal element $l$, we compute the insertion of the linear stage $\delta = M \cdot l$.

In this experiment, $l$ was set to $1.25$\,mm. Thus, each insertion step defined by the planner corresponds to an insertion length of $\delta = 1.25$\,mm in the physical setup.

In addition to insertion, the planner specifies rotational adjustments of the guidewire along its longitudinal axis $\theta \triangleq \theta_1$, as shown in Fig. \ref{fig:actuation_system}c. This parameter ensures that the guidewire is oriented correctly to follow the planned path through the aorta phantom. For the experiments, it was assumed that the rotation produced by the gear mechanism is fully transferred to the guidewire base. 


\subsection{Results}
\begin{figure}[t] 
    % \centering
    \includegraphics[width=\columnwidth]{figures/results_ap_lateral.png}
    \caption{Guidewire navigation in the phantom of the arteries in antero/posterior and lateral views; a) initial configuration; b) guidewire avoiding \gls{lsa}; c) guidewire entering \gls{lcca}; d) end configuration.}
    \label{fig:results}
\end{figure}
The pre-operative path generated by the planner (see Fig. \ref{fig:plan}) was executed by the actuation unit in Fig. \ref{fig:actuation_system}a in the anatomy in Fig. \ref{fig:actuation_system}b. Validation was performed by observing the guidewire's navigation through the aorta, past the \gls{lsa} (branch to avoid), to reach the \gls{lcca} (target branch). Navigation was considered successful when the guidewire reached the end of the section of the \gls{lcca} represented in the phantom.

We ran the experiment 50 times with 100\% success rate. We show two of the trials in the Supplementary Video. We captured the navigation using single plane fluoroscopy and repeated it twice to collect antero-posterior (A/P) and lateral view images. Screenshots from the videos are reported in Fig. \ref{fig:results}.

In both view sequences, the guidewire begins from the descending aorta in its initial configuration (Fig. \ref{fig:results}a). The guidewire proceeds along the descending aorta and avoids to enter the \gls{lsa}, as seen in Fig. \ref{fig:results}b. By guiding itself along the walls of the anatomy, the guidewire reaches the based of the \gls{lcca}, shown in Fig. \ref{fig:results}c, via an axial rotation, it enters the \gls{lcca} and extends into the artery (Fig. \ref{fig:results}d) until its end, i.e. the target area. In all 50 independent executions, the guidewire follows the planned path using contact-aware motion planner presented in Section \ref{sec:planning}, from the aorta to the \gls{lcca} while successfully avoiding the \gls{lsa}.

\begin{figure}[t] 
    \centering
    \includegraphics[width=0.65\columnwidth]{figures/robustness_figure.png}
    \caption{Configurations of the aorta considered to test the robustness of the pre-operative plan.}
    \label{fig:robustness}
\end{figure}

In the clinical settings, minor misalignment of the guidewire or slight movements of the anatomy can occur, and might affect the planner's performance. To test the robustness of the planner under these conditions, we ran the experiments while varying the placement of the phantom with respect to it's nominal configuration (Fig. \ref{fig:robustness_flou}a) - i.e. the one the planner was run on. This included adjustments in axial displacement, lateral displacement, and rotation of the phantom on the coronary plane. The tools where fixed in placed to emulate misplacement with respect of the anatomy or anatomical motion.

The configurations we considered are shown in Fig. \ref{fig:robustness}. They include displacement and rotation on the coronal plane, defined as: $a\in \mathbb{R}$ for lateral displacement, $b\in \mathbb{R}$ for axial displacement, and  $\alpha\in \mathbb{R}$ as the rotation orthogonal to the coronal plane. These parameters represent common misalignments that can occur due to slight guidewire shifts or patient movements. The planner demonstrated robustness against these parameters with tolerance ranges of $a \in [-5, +10]$\,mm for lateral displacement, $b \in [-7.5, +10]$\,mm for axial displacement, and $\alpha \in [-5, +10]^\circ$. 

In Fig. \ref{fig:robustness_flou}, we report A/P fluoroscopy scans to show the largest positional and angular displacements which does not affect the planner's performances: $b = 10$\,mm (Fig. \ref{fig:robustness_flou}b); $a = 10$\,mm (Fig. \ref{fig:robustness_flou}c); $\alpha = 10^\circ$ (Fig. \ref{fig:robustness_flou}d). Despite these variations in position and orientation, the guidewire consistently reached the target branch (\gls{lcca}) while avoiding the undesired branch (\gls{lsa}). 
These findings indicate that the path provided by the planner can effectively adapt to misalignment of the catheter and movements of the anatomy.

\begin{figure}[t] 
    \centering
    \includegraphics[width=\columnwidth]{figures/robutsness_flou.png}
    \caption{Results of planner robustness towards anatomical motion.}
    \label{fig:robustness_flou}
\end{figure}


