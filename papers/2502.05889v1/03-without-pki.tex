\section{Solvability in Unauthenticated Settings} \label{section:no-pki}
In this section, we describe tight conditions for solving $\byzantineSM$ in unauthenticated settings (no cryptographic assumptions). In the following, we first present our findings in the fully-connected network case. Afterwards, we focus on the one-sided and bipartite network cases.

\subsection{Fully-Connected Network}

The conditions for the fully-connected network case are presented in \cref{theo:pki-complete}, stated below.
\begin{theorem} \label{theo:pki-complete}
$\byzantineSM$ is solvable in a fully-connected unauthenticated network if and only if $t_L < k/3$ or $t_R < k/3$.
\end{theorem}

We first focus on the feasibility part, for which we recall \cref{lemma:broadcast-easy}: if $\bb$ can be achieved in a setting, then $\byzantineSM$ also can. As stated in the lemma below, $\bb$ is, in fact, solvable for our conditions.
Hence, the two lemmas together enable us to conclude that $\byzantineSM$ is solvable in a fully-connected unauthenticated network whenever  $t_L < k / 3$ or $t_R < k / 3$, as desired. 
\cref{lemma:general-adversaries} is a corollary of \cite[{Theorem 2}]{DISC:FitMau98}. We note that \cite{DISC:FitMau98} focuses on \emph{general adversaries}.
Roughly, this is an adversarial model where the adversary has to choose which parties to corrupt from a predefined subset-closed list of options. We provide a detailed discussion, along with the proof of \cref{lemma:general-adversaries}, in Appendix \ref{appendix:general-adversaries}.


\begin{restatable}{lemma}{GeneralAdversaries} \label{lemma:general-adversaries}
    $\bb$ is solvable in a fully-connected network if $t_L < k/3$ or $t_R < k/3$.
\end{restatable}


We now show that at least one of the conditions $t_L < k / 3$ and $t_R < k / 3$ holding is necessary. To do so, we prove this property for the special case $n=6$ for $\simplifiedSM$. One of our proof's ingredients is a technique from \cite{PODC:FisLynMer85}, i.e., defining a \emph{larger} system to reach a contradiction. 
Then, \cref{lemma:reduce-number} enables us to conclude that for arbitrary $n$, $\simplifiedSM$ is not solvable if  $t_L \geq k/3$ and $t_R \geq k/3$. Finally, Lemma~\ref{coro:to-simplified} lifts this impossibility result to $\byzantineSM$, completing the proof of \cref{theo:pki-complete}.
\begin{lemma}\label{lemma:pki-6}
Assume a fully-connected unauthenticated network and $n = 6$. Then, no protocol achieves $\simplifiedSM$ for $t_L = t_R = 1$.
\end{lemma}
\begin{proof}
Assume for a contradiction that $\Pi$ achieves $\simplifiedSM$ in this setting.
We start with a high-level outline of the proof. We will construct a larger system (i.e., for 12 parties) by `duplicating' the communication graph and consider running $\Pi$ in this new system, with each party following the intended behavior of the corresponding party in the original system. By choosing specific pairs of byzantine parties and their strategies in the original system, the adversary will be able to simulate being in the new system towards the honest parties. Going even further, we will present three different setups of the original system where the adversary can achieve this simulation. Each setup will provide different insights into how the parties should behave in the larger system, leveraging that $\Pi$ is correct for any setup of the original system. However, these findings will ultimately be contradictory, proving that $\Pi$ cannot exist.


\begin{figure}[h]
    \centering
    \include{figures/no-pki-figure}
    \vspace{-1cm}
    \setlength{\belowcaptionskip}{-10pt}
    \caption{(i) Top left: system constructed in the proof of \cref{lemma:pki-6}; (ii) Top right: indistinguishable execution where $a_2, b_2, u_2$ and $v_2$ are correct while the remaining nodes are simulated by the byzantine parties; (iii) Bottom right: indistinguishable execution where $b_1, c_1, v_1$ and $w_1$ are correct; (iv) Bottom right: indistinguishable execution where $c_1, a_2, u_2$ and $w_1$ are correct.}
    \label{fig:no-pki-fully-model}
\end{figure}

We denote the three parties in $L$ by $a, b, c$, and the three parties in $R$ by $u, v, w$.
By duplicating each party, we obtain a graph with $12$ nodes such that each node is connected to $3$ parties on the opposite side, as depicted in \cref{fig:no-pki-fully-model} (i). 
Consider an execution of $\Pi$ in the new system with the following inputs: $c_1$ and $v_1$ have each other as their favorite, $a_2$ and $v_2$ have each other as their favorite, and all other inputs are arbitrary.
So far, because $\Pi$ is running in a non-standard network, we cannot say anything about the output of the parties (or even whether they terminate or not). 
However, using indistinguishability arguments,
we will prove that there exists a normal-operation scenario for $\Pi$ where two honest parties match the same party, giving a contradiction:

\begin{itemize}[nosep,leftmargin=*]    
    \item First, we consider the setting where $a_2, b_2, u_2$ and $v_2$ are honest while all the remaining nodes are being simulated (internally) by $c$ and $w$, which are byzantine. This matches \cref{fig:no-pki-fully-model} (ii). This setting is valid for $\Pi$: there is at most one byzantine party in $L$ and one byzantine party in $R$. As such, $a_2, b_2, u_2$ and $v_2$ must terminate. Moreover using the simplified stability property, because $a_2$ and $v_2$ prefer each other, we get that $a_2$ decides to match party $v_2$. 
    % (more precisely $v_2$).

    \item Then, we consider the setting where $b_1, c_1, v_1$ and $w_1$ are honest, while the remaining nodes are being simulated by two byzantine parties $a$ and $u$. This matches \cref{fig:no-pki-fully-model} (iii). Similarly to before, we get that $c_1$ must terminate and decide to match party $v_2$.
    % (more precisely, $v_1$).

    \item The last setting is where $c_1, a_2, u_2$ and $w_1$ are honest, while the remaining nodes are being simulated by two byzantine parties $b$ and $v$. This matches \cref{fig:no-pki-fully-model} (iv). We remark that $a_2$ (resp.~$c_1$) cannot distinguish between this setting and \cref{fig:no-pki-fully-model} (ii) (resp.~(iii)). As such, as we proved above, $a_2$ and $c_1$ will both decide to match $v$ (previously we had written $v_1$ and $v_2$ to distinguish between the two copies, but here there is only one). Moreover, this setting is valid for $\Pi$, which means that its output should satisfy the properties of stable matching. However, $a_2$ and $c_1$ are both honest and decide to match the same party $v$, breaking the non-competition rule, hence we obtain a contradiction. \qedhere
\end{itemize}
\end{proof}


\subsection{Bipartite and One-Sided Networks}

The theorems below give the necessary and sufficient conditions for the bipartite and one-sided communication cases. Note that, in contrast to the fully-connected case, each theorem requires one additional condition (i) to hold on top of the previous condition (ii) that was already required for the fully-connected case.

\begin{theorem}\label{theorem:main:no-pki-bipartite}
$\byzantineSM$ is solvable in a bipartite unauthenticated network if and only if both of these conditions are satisfied: (i) $t_L, t_R < k/2$; (ii) $t_L < k/3$ or $t_R < k/3$.
\end{theorem}

\begin{theorem}\label{theorem:main:no-pki-one-sided} $\byzantineSM$ is solvable in a one-sided unauthenticated network if and only if both of these conditions are satisfied: (i) $t_R < k/2$; (ii)  $t_L < k/3$ or $t_R < k/3$.
\end{theorem}


The main idea we will use to get the feasibility parts of the previous theorems 
is that for the stated conditions, we may actually return to assuming
a fully-connected network.
In particular, two parties $u, v$ on the same side that do not share a communication channel may simulate such a channel between them by using the parties on the opposite side as a proxy: $u$ sends the desired message to all parties on the other side, who in turn forward it to $v$, which takes a majority vote to decide on the sent message. This works as long as there is an honest majority on the other side, giving us the following lemma (formal proof in 
Appendix~\ref{appendix:complete-bipartite-graph-without-pki}).
\begin{restatable}{lemma}{BipartiteCommunicationNoPKI}\label{lemma:pki-bipartite}
Let $S$ and $S'$ denote the two sides.
If the parties in $S$ are disconnected and $t_{S'} < k /2$, we may assume the parties in $S$ are fully-connected.
\end{restatable}

This provides us with the corollaries below, enabling us to prove the stated conditions to be sufficient when combined with \cref{theo:pki-complete}, which has assumed a fully-connected network.
\begin{corollary}\label{lemma:pki-one-sided}
In a one-sided network, we may assume a fully-connected network if $t_L < k / 2$.
\end{corollary}
\begin{corollary}\label{lemma:pki-complete}
In a bipartite network, we may assume a fully-connected network if $t_L, t_R < k/2$.
\end{corollary}

To prove that the conditions in \cref{theorem:main:no-pki-bipartite,theorem:main:no-pki-one-sided} are also necessary, we make use of the lemma below. Similarly to the proof of \cref{lemma:pki-6}, our argument includes a technique from \cite{PODC:FisLynMer85} that enables us to reach a contradiction by working with a non-standard system.
\begin{lemma} \label{lemma:pki-4}
Assume a one-sided unauthenticated network and $n = 4$. Then, no protocol achieves $\simplifiedSM$ for $t_L = 0$ and $t_R = 1$.
\end{lemma}
\begin{proof}
Write $a, b$ for the nodes in $L$ and $c, d$ for the nodes in $R$. All nodes are connected in the communication network except $a$ and $b$. We will prove that no such protocol exists even in the no-harder setting where \emph{exactly} one party in $R$ is corrupted, which we henceforth assume.

It will suffice to prove the impossibility for the bipartite network case, i.e., without the edge $c$-$d$.
In particular, we claim that messages sent across this edge cannot be helpful. To see this intuitively, recall our assumption that \emph{exactly} one party in $R$ is byzantine, say $d$. Party $c$ knows that $d$ is byzantine, meaning any messages received from $d$ could be completely arbitrary. Therefore, $c$ may as well simulate receiving them by replacing them with a default value. Henceforth, we assume that the communication network is bipartite.

Assume for a contradiction that $\Pi$ is a protocol achieving $\simplifiedSM$ for $n = 4$ parties $L = \{a, b\}$ and $R = \{c, d\}$ in a bipartite unauthenticated network given that no party in $L$ is corrupted and \emph{exactly} one party in $R$ is corrupted. 

The key insight in our proof is that the bipartite communication network actually forms the undirected cycle $a$-$c$-$b$-$d$-$a$. We construct a larger system by duplicating each party and linking them into a cycle twice as long: $a_1$-$c_1$-$b_1$-$d_1$-$a_2$-$c_2$-$b_2$-$d_2$-$a_1$. This is depicted in the first row of \cref{fig:cycle}.
We consider running $\Pi$ in this setting by running the protocol used for $a$ on $a_1$ and $a_2$, the protocol used for $b$ on $b_1$ and $b_2$, and so on. We will now assign favorites (inputs) to the vertices: we make $a_1$ and $c_1$ each other's favorites and $b_2$ and $c_2$ each other's favorites. Other vertices are assigned favorites arbitrarily. We will show that by running protocol $\Pi$ in this setting, we get a contradiction.

\begin{figure}[t]
\centering
\includegraphics[scale=0.49]{figures/party2_cropped.pdf}
\setlength{\belowcaptionskip}{-10pt}
\caption{The eight parties in a cycle.
In the first case, $a_1$ and $c_1$ are both honest and each other's favorites. Therefore, they must match each other. In the second case, we similarly get that $b_2$ and $c_2$ must match. Finally, in the last case, we get that both $a_1$ and $b_2$ try to match party $c$ which is byzantine, but the non-competition property does not allow this.}
\label{fig:cycle}
\end{figure}

First (second row in \cref{fig:cycle}), we consider the case where $a_1$, $c_1$ and $b_1$ are honest while $d$ is byzantine and simulating $d_1$-$a_2$-$\dots$-$d_2$. In this case, because $a_1$ and $c_1$ are honest and both each other's favorites, by simplified stability, they must match each other.

By symmetry (third row in \cref{fig:cycle}), $b_2$ and $c_2$ must match each other.

Last (forth row in \cref{fig:cycle}), we consider the case where $b_2$, $d_2$ and $a_1$ are honest while $c$ is byzantine and simulating $c_1$-$b_1$-$\dots$-$c_2$. In this case, $a_1$ and $b_2$ are both honest and both decide to match the same party $c$ (by the previous two cases), which is prohibited by non-competition, giving us a contradiction.
\end{proof}

We conclude the section by presenting the proofs of \cref{theorem:main:no-pki-bipartite}, giving the conditions for bipartite networks, and \cref{theorem:main:no-pki-one-sided}, providing the conditions for one-sided networks.
\begin{proof}[Proof of \cref{theorem:main:no-pki-bipartite}]
\cref{lemma:pki-bipartite} implies that the bipartite communication model is weaker than the one-sided communication model, and therefore \cref{theorem:main:no-pki-one-sided} enables us to conclude that the conditions in our Theorem's statement are necessary. Note that, for the condition $t_L < k / 2$ we need to apply \cref{lemma:pki-bipartite} for $S = L$ and $S' = R$, while for $t_R < k / 3$ we need $S = R$ and $S' = L$. For sufficiency, the condition $t_L, t_R < k/2$ enables us to apply \cref{lemma:pki-complete} and assume a fully-connected network. Afterwards, \cref{theo:pki-complete} ensures that $\byzantineSM$ is solvable.
\end{proof}


\begin{proof}[Proof of \cref{theorem:main:no-pki-one-sided}]
\cref{lemma:pki-4} proves that for $n = 4$ parties, $\simplifiedSM$ cannot be achieved in this setting if $t_R \geq 1$.
Then, using \cref{lemma:reduce-number}, this proves that for an arbitrary $n$, $\simplifiedSM$ cannot be achieved if $t_R \geq k/2$ in a one-sided network. Therefore, using \cref{coro:to-simplified}, this proves that $t_R < k/2$ is necessary for $\byzantineSM$ as well.
When $t_R < k / 2$ holds, \cref{lemma:pki-complete} enables us to assume a fully-connected network. Then, we may conclude using \cref{theo:pki-complete} that it is both necessary and sufficient that one of the conditions $t_L < k/3$, $t_R < k/2$ holds.
\end{proof}
