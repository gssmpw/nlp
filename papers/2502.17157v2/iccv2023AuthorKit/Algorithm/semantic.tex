\begin{algorithm}
\newcommand{\STATEB}[1]{\STATE \parbox[t]{0.7\linewidth}{#1}}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\caption{Segmentation Post-processing}
\begin{algorithmic}[1]
\label{alg:segmentation}
\REQUIRE RGB segmentation mask $\mathbf{m}$, RGB tolerance $\sigma$, area threshold $\xi$, kernel size $k$, connected components number threshold $\eta$, duplicate mask threshold $\beta$
\ENSURE extracted masks $\mathbb M_{pred}$

\STATE{Get the number of peaks $p$ of the histogram of $\mathbf{m}$}
\STATE{Get the number of clusters $n = Mean(p)$}
\STATE{Get the clustered colors by $\mathbb{C} = \operatorname{KMeans}(\mathbf{m}, n)$}
\STATE{$\mathbb M_{pred} = \varnothing$}

\FOR{$c \in \mathbb{C}$}
    \IF{$\operatorname{IsCloseToBlack(c, \sigma)}$ }
        \STATE{\textbf{continue}}
    \ENDIF
    \STATE{$\mathbf{m}' = \operatorname{GetMaskByRGB}(\mathbf m, c, \sigma)$}
    \STATE{$\mathbf{m}' = \operatorname{BinaryFillHoles}(\mathbf m')$}
    \STATE{$\mathbf{m}' = \operatorname{RefineWithMorphology}(\mathbf m',k)$}
    \STATE{$a = \operatorname{GetArea}(\mathbf m')$}
    \IF{$a<\xi$}
        \STATE{\textbf{continue}}
    \ENDIF
    \STATE{$y = \operatorname{GetConnectedComponentsNumber}(\mathbf m')$}
    \IF{$y>\eta$}
        \STATE{\textbf{continue}}
    \ENDIF
    
    \STATE{$\mathbb M_{pred} = \mathbb M_{pred} \cup \{ \mathbf m'\}$}
\ENDFOR

\STATE{$\mathbb M_{pred} = \operatorname{RemoveDuplicateMasks}(\mathbb M_{pred}, \beta)$}

\RETURN $\mathbb{M}_{pred}$
\end{algorithmic}
\end{algorithm}