\begin{table*}[t]
\caption{Test Results of Different Models on the Close-Ended Task. The results are presented for both open-source and closed-source models. “w/o d.” denotes the absence of the tool demo in our method. In the Agent task, “base.” represents ReAct~\citep{yao2022react}, “Refl.” represents Reflexion~\citep{shinn2023reflexion}, and “Plan.” represents Plan-Execution~\citep{shridhar2023art, yang2023intercode}. In the Single-turn Code Tasks, “base.” represents POT~\citep{chen2022program}, and “Crea.” represents CREATOR~\citep{qian2023creator}. $\text{MATH}_{alg}$ represents the algebra subset of MATH, with a difficulty level of 4-5. TabMWP has a difficulty level of 7-8.}
\label{tab:Agent-Ended and signal Task}
\vskip -0.1in
\setlength{\tabcolsep}{3.9pt} % 调整列间距
\renewcommand{\arraystretch}{1} % 调整行间距
\begin{center}
% \resizebox{\textwidth}{!}{ % 自动调整表格宽度以适应页面
\begin{small}
\begin{sc}
\begin{tabular}{lccccc|lccccccc} % 确保列数与标题一致
\toprule

\multicolumn{6}{c|}{\textnormal{\textbf{Multi-turn Agent Tasks}}} & \multicolumn{8}{c}{\textnormal{\textbf{Single-turn Code Tasks}}} \\

\hline

\textnormal{\textit{DS/Mthds}} & \textnormal{\textit{Base.}} & \textnormal{\textit{Refl.}} & \textnormal{\textit{Plan.}} & \textnormal{\textit{Ours}} & \textnormal{\textit{w/o d.}} & \textnormal{\textit{DS/Mthds}} & \textnormal{\textit{Base.}} & \textnormal{\textit{Crea.}} & \textnormal{\textit{Craft}} & \textnormal{\textit{Latm}} & \textnormal{\textit{Regal}} & \textnormal{\textit{Ours}} & \textnormal{\textit{w/o d.}}  \\

% \midrule
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Qwen2.5-7B-Instruct}} \\

\hline
% \midrule
\normalfont TextCraft & 32.90 & 37.60 & 14.53 & \textbf{44.02} & \underline{42.31} & \normalfont $\text{MATH}_{alg}$ & 59.42 & 59.75 & 50.86 & 33.33  & 58.02 & \textbf{73.00} & \underline{69.63} \\ 
\normalfont DA-Bench & 75.77 & \underline{77.78} & 57.99 & \textbf{83.54} & 73.00 & \normalfont Date & 57.59 & 58.33 & 62.45 & 61.57  & 74.81 & \textbf{78.33} & \underline{78.15} \\ 
& & & & & & \normalfont TabMWP
 & 80.57 & 86.38 & 70.32 & 40.72 & 80.91 & \textbf{89.78} & \underline{88.51} \\ 
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Qwen-Coder-7B-Instruct}} \\
\hline
\normalfont TextCraft & 9.40 & 17.52 & 12.82 & \underline{22.22} & \textbf{23.08} & \normalfont $\text{MATH}_{alg}$ & 52.02 & 50.94 & 49.47 & 55.17 & 54.07 & \textbf{69.54} & \underline{63.86} \\
\normalfont DA-Bench & 75.89 & 73.58  & 42.34 & \textbf{81.22} & \underline{76.22} & \normalfont Date  & 61.48 & 57.41 & 61.74 & 52.22 & 74.63 & \underline{78.33} & \textbf{80.55} \\
& & & & & & \normalfont TabMWP & 92.70 & 89.86 & 87.52 & 26.01 & 83.46 & \textbf{95.11} & \underline{93.26} \\ 
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Deepseeker-Coder-6.7B-Instruct}} \\
\hline
\normalfont TextCraft & 2.56 & 11.10 & 6.41 & \textbf{15.38} & \underline{14.10} & \normalfont $\text{MATH}_{alg}$ & 23.95 & 14.34 & 18.52 & 20.38 & 12.10 & \textbf{27.57} & \underline{24.86} \\
\normalfont DA-Bench & 0.63 & 1.27 & 7.59 & \underline{16.78} & \textbf{18.76} & \normalfont Date & 58.89 & 43.88 & 46.85 & 29.61 & 53.89 & \textbf{67.78} & \underline{63.89} \\
& & & & & & \normalfont TabMWP & 70.14 & 81.94 & 66.45  &13.19 & 52.48 & \textbf{87.80} & \underline{82.23} \\ 
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Qwen2.5-14B-Instruct}} \\
\hline
\normalfont TextCraft & 71.79 & 68.37 & 44.87 & \underline{73.93} & \textbf{76.92} & \normalfont $\text{MATH}_{alg}$ & 63.54 & 63.46 & 61.52 & 70.67 & 61.40 & \textbf{77.16} & \underline{74.57} \\
\normalfont DA-Bench & 85.44 & 86.58  & 61.51 & \textbf{87.97} & \underline{86.97} & \normalfont Date & 84.44 & 79.44 & 81.30 & 46.27 & 86.48 & \textbf{88.70} & \underline{87.22} \\
& & & & & & \normalfont TabMWP & 93.19 & 90.49 & 73.29 & 45.58 & 91.13 & \underline{94.68} & \textbf{95.19} \\ 
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Deepseeker-Coder-33B-Instruct}} \\
\hline
\normalfont TextCraft & 8.90 & 12.06 & 2.63 & \textbf{16.67} & \underline{15.28} & \normalfont $\text{MATH}_{alg}$ & 27.45 & 30.62 & 22.13  & \underline{31.90} & 22.13 & \textbf{35.06} & 30.12 \\
\normalfont DA-Bench & 38.46 & 53.79 & 8.22 & \textbf{60.00} & \underline{57.05} & \normalfont Date & 65.00 & 61.85 & 60.00 & 38.43 & 61.11 & \textbf{74.16} & \underline{70.95} \\
& & & & & & \normalfont TabMWP & 83.69 & 89.72 & 80.92 & 22.10 & 80.92 & \textbf{92.76} & \underline{87.45} \\ 
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{GPT-3.5-turbo-1106}} \\
\hline
\normalfont TextCraft & 26.92 & 43.59 & 10.27 & \underline{52.85} & \textbf{59.33} & \normalfont $\text{MATH}_{alg}$ & 29.22 & \underline{39.17} & 19.71 & 19.49 & 22.97 & \textbf{42.39} & 34.32 \\
\normalfont DA-Bench & 67.30 & 55.06 & 16.24 & \textbf{72.15} & \underline{71.52} & \normalfont Date  & 71.67 & 66.49 & 61.11 & 55.49 & 73.33 & \textbf{76.85} & \underline{74.44} \\
& & & & & & \normalfont TabMWP & 75.32 & 80.00 & 69.51  & 49.35 & 76.17 & \textbf{83.83} & \underline{82.34} \\
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{Claude-3-haiku}} \\
\hline
\normalfont TextCraft & 57.69 & 46.54 & 16.02 & \underline{62.73} & \textbf{66.87}  & \normalfont $\text{MATH}_{alg}$ & 26.34 & 34.16 & \underline{32.59} & 19.05 & 28.48 & \textbf{34.24} & 32.02 \\
\normalfont DA-Bench & 74.68 & 76.16  & 37.39 & \textbf{82.28} & \underline{81.01}  & \normalfont Date & \underline{81.67} & 45.56&74.63&53.33&70.56&\textbf{82.78}& 80.37\\
& & & & & & \normalfont TabMWP & 70.56 & 72.24 & 82.37 & 38.55 & 78.37 & \textbf{90.78} & \underline{90.21} \\
\hline

\multicolumn{14}{>{\columncolor{gray!30}}l}{\normalfont \textit{GPT-4o}} \\
\hline
\normalfont TextCraft & 90.79 & 92.11 & 62.34 & \textbf{96.15} & \underline{94.87}  & \normalfont $\text{MATH}_{alg}$ & 60.98 & 69.13 & 62.22 & 61.94 & 61.73 & \underline{69.80} & \textbf{74.28} \\
\normalfont DA-Bench & 90.16 & 89.69  & 81.43 & \textbf{91.60} & \underline{90.41}  & \normalfont Date & 94.44 & 77.78 &88.33&77.06&93.89&\textbf{95.00}& \underline{95.00}\\
& & & & & & \normalfont TabMWP & 96.60 & 92.98 & 88.96 & 76.74 & \underline{97.66} & \underline{97.66} & \textbf{97.86} \\
\bottomrule
\end{tabular}
\end{sc}
\end{small}
\end{center}
% \end{resizebox}
\vskip -0.2in
\end{table*}





% \begin{table*}[!ht]
% \caption{The test results of different models on the Agent Task. The test results are primarily on open-source and closed-source models. "Acc" represents the accuracy of solving the task, and "Acc In" indicates the improvement relative to the baseline.}
% \label{tab:Agent-Ended and signal Task}
% \vskip 0.1in
% \setlength{\tabcolsep}{4pt} % 调整列间距
% \renewcommand{\arraystretch}{1} % 调整行间距
% \begin{center}
% % \resizebox{\textwidth}{!}{ % 自动调整表格宽度以适应页面
% \begin{small}
% \begin{sc}
% \begin{tabular}{lccc|lcccc} % 确保列数与标题一致
% \toprule

% \multirow{2}{*}{\textnormal{\textbf{Method}}} & \multicolumn{3}{c}{\textnormal{\textbf{Agent Tasks}}} & \multirow{2}{*}{\textnormal{\textbf{Method}}} & \multicolumn{4}{c}{\textnormal{\textbf{Single-turn Code Tasks}}} \\

% & \textnormal{\textbf{TextCraft}} & \textnormal{\textbf{DA-Bench}} & \textnormal{\textit{Avg In }} & & \textnormal{\textbf{MATH}} &\textnormal{\textbf{Date}} &\textnormal{\textbf{TabMWP}} & \textnormal{\textit{Avg In }}\\

% % \multirow{2}{*}{\textnormal{\textbf{Method}}} & \textnormal{\textbf{TextCraft}} & \textnormal{\textbf{DA-Bench}} & \textnormal{\textit{Avg In }} & \multirow{2}{*}{\textnormal{\textbf{Method}}} & \textnormal{\textbf{MATH}} & \textnormal{\textbf{Date}} & \textnormal{\textbf{TabMWP}} & \textnormal{\textit{Avg In }}\\



% % \midrule
% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\

% \hline
% % \midrule
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \hline

% \multicolumn{9}{>{\columncolor{gray!30}}l}{\normalfont Qwen2.5-7B-Instruct} \\
% \hline
% \normalfont Baseline & 38.46 & +0.00  & +0.00 & \normalfont Baseline & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \normalfont Reflection & 38.46 & +0.00  & +0.00 & \normalfont CREATOR  & 38.46 & +0.00 & 76.29   & +0.00\\
% \normalfont Plan-Execution & 38.46 & +0.00  & +0.00 & \normalfont CRAFT & 38.46 & +0.00 & 76.29  & +0.00 \\ 
%  &  & & +0.00 & \normalfont LATM & 38.46 & +0.00 & 76.29  & +0.00 \\
%  &  &  & +0.00 & \normalfont Trove  & 38.46 & +0.00 & 76.29  & +0.00 \\
%   &  &  & +0.00 & \normalfont REGAL  & 38.46 & +0.00 & 76.29  & +0.00 \\
% \hline
% \textit{Ours (after pruning)} & 38.46 & +0.00  & +0.00 & \textit{Ours (after pruning)} & 38.46 & +0.00 & 76.29  & +0.00 \\
% \textit{\hfill $--$w/o demo} & 38.46 & +0.00  & +0.00 & \textit{\hfill $--$w/o demo} & 38.46 & +0.00 & 76.29  & +0.00 \\

% \bottomrule
% \end{tabular}
% \end{sc}
% \end{small}
% % }
% \end{center}
% \vskip -0.1in
% \end{table*}

