\begin{algorithm}[t]
    % \footnotesize
    \small
    \SetInd{0.4em}{1.0em}
    \DontPrintSemicolon
    \SetKwInOut{Input}{Input}
    \SetKwInOut{Output}{Output}
    \Input{
        ~$\real$: original dataset;~~
        $[\boldsymbol{G}, \textbf{U}, \textbf{T}, \textbf{V}]$: core tensor and tucker factors for generating synthetic summary;~~
        $\Theta$: pretrained model parameters;~~
        $\textbf{N}$: total unrolling steps for BPTT;~~
        $\textbf{W}$: truncated window size;~~
        $\alpha$: learning rate for the synthetic data;~~
        $\eta$: learning rate for the learner model;
    }
    \tcp{Outer loop: update synthetic sequences summary}
    \While{not converged} {
        {$\vartriangleright$ Initialize learner's parameter $\theta_0 \sim \Theta$} \\
        {$\vartriangleright$ Sample a mini-batch of original data $\mathcal{B}^{\real} \sim \real$} \\
        {$\vartriangleright$ Uniformly sample the ending unrolling step $\textbf{M} \sim U(\textbf{W}, \textbf{N})$} \\
        \tcp{Inner loop: update learner model parameters}
        \For{$n \leftarrow 1$, \dots, $M$} {
            {$\vartriangleright$ Sample a mini-batch of synthetic user~: \\
            \qquad $\mathcal{B}^{\textbf{U}} \sim \textbf{U}$} \\
            {$\vartriangleright$ Generate a mini-batch of synthetic summary~: \\
            \qquad $\mathcal{B}^{\syn} = \boldsymbol{G} \times_{1} \mathcal{B}^{\textbf{U}} \times_{2} \textbf{T} \times_{3} \textbf{V}$} \\
            \tcp{Start Random Truncked Backpropagation Through time}
            \If{n = \textbf{M} - \textbf{W} - 1}{
                {$\vartriangleright$ start accumulating gradients} \\
            }
            {$\vartriangleright$ Update learner's parameter by gradient descent~:} \\
            \qquad $\theta_n = \theta_{n-1} - \eta~\nabla\mathcal{L}^{\syn}(\mathcal{B}^{\syn};\theta_{n-1})$ \\
        }
        {$\vartriangleright$ Compute test loss and feature space alignment loss~:} \\
        $\mathcal{L}(\theta_M) = \mathcal{L}^{\real}(\theta_{M}) + \dfrac{1}{2}~\Vert~\Phi_{\theta^{\real}} (\mathcal{B}^{\real}) - \Phi_{\theta^{S}_{M}}(\mathcal{B}^{\real})~\Vert_{F}^{2}$ \\
        {$\vartriangleright$ Update synthetic data summary $\syn = \syn - \alpha~\nabla_{\syn}\mathcal{L}(\theta_{M})$}
    }
    \Output{~~synthetic sequence summary $\syn$.}
    \caption{Optimization for TD3}
    \label{alg:alg}
\end{algorithm}
