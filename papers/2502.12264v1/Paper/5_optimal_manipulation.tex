\section{Sequential  versus simultaneous mechanisms}\label{sec: general costs}

In this section, we ask whether the simpler class of mechanisms, i.e., simultaneous mechanisms, can be as good as sequential mechanisms. 
To answer this question, we can consider a broader class of cost functions.

\subsection{Manipulation}
 \citet{zigzag} has also studied the comparison between fixed-order mechanism and simultaneous mechanism under the manipulation setting and additive Euclidean distance cost.
 We first state a similar result and then we generalize it to a broader class of cost functions in \cref{thm:opt_manipulation}.\footnote{We view our \cref{lem:fix-simultaneous-distance cost} as a correction of Theorem 4.4 in \citet{zigzag}. 
The main issue there is that they first show the optimal tests for both simultaneous mechanisms and fixed order mechanisms must use shifted parallel tests.
\cref{fig:cheap-talk} serves as a counterexample to illustrate a fixed-order mechanism that uses shifted non-parallel tests could dominate one that uses shifted parallel tests under some distribution.
}
%------------------------------------
\begin{proposition}\label{lem:fix-simultaneous-distance cost}
Consider the manipulation setting and additive Euclidean distance cost.
    The optimal fixed-order mechanism dominates the optimal simultaneous mechanism. Moreover, it uses stringent tests $\classifier_A^+, \classifier_B^+$, i.e., $\classifier_A^+  \cap \classifier_B^+ \subsetneq \classifier_A\cap \classifier_B$.
\end{proposition}
This result is implied by \cref{thm:opt_manipulation}.
The proof idea  is to first show that the optimal simultaneous mechanism uses shifted tests that are parallel to the principal's initial requirements.
This is because shifted non-parallel tests are either not feasible or not optimal (See \cref{fig:non-parallel tests not optimal}).
And then we show that one fixed order mechanism that uses the same tests weakly increases the chance of selecting an agent. 


\begin{figure}
\centering 
    \begin{subfigure}{0.45\textwidth}
\centering 
\begin{tikzpicture}[xscale=4,yscale=4]

\draw [thick] (1,0.65) -- (1,1.8);
\node [right] at (1, 1.9 ) {$\classifier_A$};
\node [right] at (1, 1.75 ) {$+$};

\draw [domain=0.6:2, thick] plot (\x, {3/4*\x+1/4});
\node [right] at (2, 1.75 ) {$\classifier_B$};
\node [left] at (2,1.75) {$+$};


\draw [ultra thick, red] (1.25,0.65) -- (1.25,1.88);
\node [right, red] at (1.25, 1.8 ) {$\classifier_A^{+}$};
% \draw [<->, red, densely dashed] (1,1.5) -- (1+0.25,1.5);
% \node [above, red] at (1+0.125, 1.5 ) {$1$};
\draw [domain=0.35:1.8, ultra thick, red] plot (\x, {2.5/4*(\x-5/4)+3/2});
\node [left, red] at (1.64, 3/4*1.66+1/4+5/16 ) {$\widehat\classifier_B$};


\draw[red, densely dashed] (1,3/4*1.25+1/4+5/16) arc (180:360-53.1:0.25);

\fill [blue!60,nearly transparent]  
(1.8,{2.5/4*(1.8-5/4)+3/2}) --
(1.25,3/4*1.25+1/4+5/16) -- (1.25+0.25*0.6,3/4*1.25+0.25*0.6*3/4+1/4 ) --(2,6.5/4)-- cycle;

\fill [blue!60,nearly transparent]  (1,3/4*1.25+1/4+5/16) -- (1.25,3/4*1.25+1/4+5/16) -- (1.25,1.88) -- (1,1.88)-- cycle;

\fill [blue!60,nearly transparent] (1,3/4*1.25+1/4+5/16) -- (1.25,3/4*1.25+1/4+5/16) -- (1.25+0.25*0.6,3/4*1.25+0.25*0.6*3/4+1/4 )-- cycle;

\fill [blue!60,nearly transparent](1,3/4*1.25+1/4+5/16) coordinate (a) arc (180:360-53.1:0.25) -- cycle;

\end{tikzpicture}
\caption{Not feasible non-parallel tests}
\end{subfigure}
\begin{subfigure}{0.45\textwidth} 
\centering 
\begin{tikzpicture}[xscale=4,yscale=4]

\draw [thick] (1,0.65) -- (1,1.8);
\node [right] at (1, 1.9 ) {$\classifier_A$};
\node [right] at (1, 1.75 ) {$+$};

\draw [domain=0.6:2, thick] plot (\x, {3/4*\x+1/4});
\node [right] at (2, 1.75 ) {$\classifier_B$};
\node [left] at (2,1.75) {$+$};


\draw [ultra thick, red] (1.25,0.65) -- (1.25,1.88);
\node [right, red] at (1.25, 1.8 ) {$\classifier_A^{+}$};
% \draw [<->, red, densely dashed] (1,1.5) -- (1+0.25,1.5);
% \node [above, red] at (1+0.125, 1.5 ) {$1$};
\draw [domain=0.35:1.76, ultra thick, red] plot (\x, {3.5/4*(\x-5/4)+3/2});
\node [left, red] at (1.63, {3.5/4*(1.65-5/4)+3/2} ) {$\widetilde \classifier_B$};

% \draw [<->, red, densely dashed] (1.25,3/4*1.25+1/4+5/16) -- (1.25+0.25*0.6,3/4*1.25+0.25*0.6*3/4+1/4 );
% \node [right, red] at (1.25+0.125*0.6,3/4*1.25+3/4*0.125*0.6+7/16) {$1$};


\draw[red, densely dashed] (1,3/4*1.25+1/4+5/16) arc (180:360-53.1:0.25);

\fill [blue!60,nearly transparent]  
((1.76, {3.5/4*(1.76-5/4)+3/2}) --
(1.25,3/4*1.25+1/4+5/16) -- (1.25+0.25*0.6,3/4*1.25+0.25*0.6*3/4+1/4 ) --(2,{3.5/4+1})-- cycle;

\fill [blue!60,nearly transparent]  (1,3/4*1.25+1/4+5/16) -- (1.25,3/4*1.25+1/4+5/16) -- (1.25,1.88) -- (1,1.88)-- cycle;

\fill [blue!60,nearly transparent] (1,3/4*1.25+1/4+5/16) -- (1.25,3/4*1.25+1/4+5/16) -- (1.25+0.25*0.6,3/4*1.25+0.25*0.6*3/4+1/4 )-- cycle;

\fill [blue!60,nearly transparent](1,3/4*1.25+1/4+5/16) coordinate (a) arc (180:360-53.1:0.25) -- cycle;

\end{tikzpicture}
 \caption{Not optimal non-parallel tests}  
 \end{subfigure}
 \caption{Shifted non-parallel tests are not optimal}
 \label{fig:non-parallel tests not optimal}
\end{figure}
% In a sequential test, the agent's decisions are an ordered sequence of attributes provided for these tests. Thus, we use $s = (\orifeatures, \firstfeatures, \secondfeatures)$ to denote the agent's decisions, where $\orifeatures$ is the agent's true attributes and $\features^i$, for $i\in \{1,2\}$ is the attributes provided for the $i$-th test.
% Let $\calS$ be the space of all ordered sequences of attributes of length 3. 
% Thus, we use the function $c: \calS \to \bbR$ to denote the cost of the manipulation effort for any sequence of attributes. 

% \begin{definition}[translation invariance]\label{def: translation invariant}
%     The cost function $c : \calS \to \bbR$ is \emph{translation invariant} if for any sequence of attributes $s = (\orifeatures, \firstfeatures,  \secondfeatures)$ and any shift vector $\genericfeatures\in \bbR^2$ such that $s' = (\orifeatures + \genericfeatures, \firstfeatures + \genericfeatures,  \secondfeatures + \genericfeatures) \in \calS$, it satisfies $c(s) = c(s')$.
% \end{definition}


\begin{assumption}[translation invariance]\label{def: translation invariant}
    The cost function $c : \bbR^6 \to \bbR$ is \emph{translation invariant} if for any attributes $\orifeatures, \firstfeatures,\secondfeatures$ and any shift vector $\genericfeatures\in \bbR^2$, $c(\orifeatures, \firstfeatures,\secondfeatures) = c(\orifeatures+\genericfeatures, \firstfeatures+\genericfeatures,\secondfeatures+\genericfeatures)$.
\end{assumption}

\begin{assumption}[absolute homogeneity]\label{def: absolute homogenous c}
    The cost function $c : \bbR^6 \to \bbR$ is \emph{absolute homogeneous} if for any attributes $\orifeatures, \firstfeatures,\secondfeatures$, and any $\alpha\in \bbR$, $c(\alpha\orifeatures, \alpha\firstfeatures,\alpha\secondfeatures) = |\alpha|c(\orifeatures, \firstfeatures,\secondfeatures)$.
\end{assumption}
This assumption can also be easily extended to homogeneity of any degree $m$ for $m\in \bbR_+$, i.e., $c(\alpha\orifeatures, \alpha\firstfeatures,\alpha\secondfeatures) = |\alpha|^m c(\orifeatures, \firstfeatures,\secondfeatures)$.

\begin{assumption}[triangle inequality]\label{def: trainagle inequality}
    The cost function $c : \bbR^6 \to \bbR$ satisfies triangle inequality if for any attributes $\features,  \boldsymbol{y}, \genericfeatures$, 
    $$\cost(\features, \boldsymbol{y}, \genericfeatures)\geq \onecost(\features,  \genericfeatures).$$ 
\end{assumption}

\begin{assumption}[monotonicity]\label{def: monotone}
    The cost function $c : \bbR^6 \to \bbR$ is monotone if for any attributes $\features, \boldsymbol{y}, \genericfeatures$, 
    $$\cost(\features, \boldsymbol{y}, \genericfeatures)\geq \onecost(\features,  \boldsymbol{y}).$$ 
\end{assumption}


\begin{assumption}[regular]\label{def: existence of minimum cost}
    The cost function $\onecost: \bbR^4 \to \bbR$ is regular if for any attributes $\features$ and any half plane $\classifier$, there exists some $\boldsymbol{y}\in \classifier$ such that 
    $$\onecost(\features, \boldsymbol{y})=\inf_{\genericfeatures\in \classifier}\onecost(\features,\genericfeatures).$$    
\end{assumption}





If the cost function only depends on the differences between the $i$-th attributes and $(i-1)$-th attributes, for $i\in \{1,2\}$, i.e., 
$\cost(\orifeatures,\firstfeatures,\secondfeatures)=c(\firstfeatures-\orifeatures,\secondfeatures -\orifeatures, \secondfeatures-\firstfeatures)$, then the cost function is translation invariant. 


Triangle inequality is reminiscent of the upward triangle inequality in \citet{perez2022test}.
The main difference is that in \citet{perez2022test}, the three attributes lie on the same line, while here, the three attributes lie on the same plane.
It means that the cost of changing from any initial attributes $\orifeatures$ to any $\secondfeatures$ would increase if the agent takes an extra middle step.
This is consistent with our applications where changing attributes require either physical effort or forgone profitability.

Monotonicity rules out transient cost or negative cost. 
Consider a scenario where the agent has to purchase extra equipment to pass the first test but afterwards he is free to sell the equipment.
This would result in $\cost(\orifeatures, \firstfeatures,\secondfeatures)<\onecost(\orifeatures, \firstfeatures)$, which violates monotonicity.
This is a reasonable condition in the manipulation setting. 
In the hiring example, $\firstfeatures$ and $\secondfeatures$ represent how the profile of a candidate appears to be in a job interview.
The cost of changing the candidate's profile represents the cost of actual effort.
Once the effort is exerted, it is sunk.
In the bank regulation example, $\firstfeatures$ and $\secondfeatures$ represent the balance sheet positions of a bank.
Adjusting the balance sheet usually incurs transaction costs.



We cover the extreme case where the cost of modifying attributes is infinity, i.e., the hard evidence environment. In this extreme case, no agent is able to change their attributes. Our results show that the fixed-order mechanism with the original two tests $\classifier_A$ and $\classifier_B$ is still optimal. Moreover, it accepts all qualified agents and no unqualified agent. 



Here are two classes of additive cost functions that satisfy \cref{def: translation invariant}-\ref{def: existence of minimum cost}.
\begin{itemize}
    \item  $
c(\orifeatures,\firstfeatures,\secondfeatures)= \onecost(\orifeatures,\firstfeatures) + \onecost(\firstfeatures,\secondfeatures) 
$, where $\onecost(\cdot,\cdot)$ is a metric.
% \item $
% c(s)= \eta \cdot (d((\firstfeatures-\orifeatures)^+,\boldsymbol{0}) + d((\secondfeatures-\firstfeatures)^+,\boldsymbol{0}) ),
% $ for $\mc>0$, where $(\genericfeatures-\features)^+=((\genericfeature_A-\feature_A)^+,(\genericfeature_B-\feature_B)^+)$.
    \item $
\cost(\orifeatures,\firstfeatures,\secondfeatures) =\onecost(\orifeatures,\firstfeatures) + \onecost(\orifeatures,\secondfeatures),
 $ where  $\onecost(\cdot,\cdot)$ is a metric.
\end{itemize}






\begin{proposition}\label{thm:opt_manipulation}
    Suppose the cost function $c$ satisfies \cref{assump: cost function one step}-\ref{def: existence of minimum cost}.
    Consider manipulation setting.
    For any distribution $\dist$, there exists a fixed-order sequential mechanism that outperforms the optimal simultaneous mechanism. Moreover, this fixed-order sequential mechanism 
    uses two stringent tests $\classifier_A^+, \classifier_B^+$, i.e., $\classifier_A^+  \cap \classifier_B^+ \subsetneq \classifier_A\cap \classifier_B$
\end{proposition}


To prove this theorem, we first establish that the optimal simultaneous mechanism is the one described in \cref{prop:optimal simultaneous manipulation general cost}.
Second, we show that the fixed-order mechanisms that use the same tests as in the optimal simultaneous mechanism are also feasible 
 and select more qualified agents than the optimal simultaneous mechanism (\cref{lem:fix-simul}).
These two together imply that the optimal mechanism must be sequential.
Third, we show that any feasible mechanism must use stringent tests (\cref{lem:stringent tests}).
Hence we conclude that the optimal mechanism has the described properties.
All omitted proof can be found in \cref{appendix:general costs}.



 \begin{proposition}\label{prop:optimal simultaneous manipulation general cost}
 Consider the manipulation setting.
    Suppose the one-step cost function $\onecost : \bbR^4 \to \bbR$  satisfies \cref{def: translation invariant} ( translation invariant),\cref{def: absolute homogenous c} (absolute homogeneous) and \cref{def: existence of minimum cost}.
    For any distribution $\dist$, the optimal simultaneous mechanism uses two stringent tests $\classifier_A^{+},\classifier_B^{+}$ where $\classifier_i^{+}\subset \classifier_i$ for $i\in \{A,B\}$.
    \end{proposition}

To understand this proposition, suppose for a moment that $\onecost(\cdot,\cdot)$ is the Euclidean distance and the test $h_{A}\cap h_{B}$ is used in the simultaneous mechanism. Recall that $%
h_{A}\cap h_{B}$ is the region of qualified attributes.
This implies that any agent with true attributes $\orifeatures\in h_{A}\cap h_{B}$
will not manipulate and will be selected. In addition, agents with true
features $\orifeatures\notin h_{A}\cap h_{B}$ will be selected only if they pay a
 cost to adopt attributes that are in the qualified region. Since
the benefit of doing so (i.e., getting selected) is 1, only those with cost
no greater than 1 will be willing to do so. The set of candidates who are
willing to do such preparation is 
\[
\manipulation=\left\{ \orifeatures\notin h_{A}\cap h_{B}:\min_{\features\in h_{A}\cap
h_{B}}\onecost(\orifeatures,\features)\leq 1\right\} \text{.}
\]%
This set $\manipulation$ comprises all points whose distance to either the two edges of
the qualified region $h_{A}\cap h_{B}$ is no greater than 1.

The simultaneous mechanism that passes agents in the qualified region $%
h_{A}\cap h_{B}$ selects some unqualified agents, so does not satisfy
the principal's objective. In order not to select any unqualified agents,
the principal must choose a more stringent test. For example, under Euclidean distance cost, such a more
stringent test would be $h_{A}^{+}\cap h_{B}^{+}$, where $h_{i}^{+}$ is
obtained by a parallel shift of $h_{i}$ by a distance of 1. It turns out $h_{A}^{+}\cap
h_{B}^{+}$ is the optimal simultaneous mechanism.
As alluded before, this is because shifted non-parallel tests are either not feasible or not optimal (See \cref{fig:non-parallel tests not optimal}).
 It also turns out that although the exact optimal stringent tests depend on the cost function, this reasoning is not confined to Euclidean cost function and can be extended to cost functions that are translation invariant, absolute homogeneous, and regular.

Next, we compare the optimal simultaneous mechanisms and the fixed-order mechanisms that use the same tests. 
\begin{lemma}\label{lem:fix-simul}
    Given the optimal simultaneous mechanism  $(\classifier_A^{+},\classifier_B^{+})$, the two  fixed-order mechanisms $(\classifier_A^{+},\classifier_B^{+},1)$ and $(\classifier_A^{+},\classifier_B^{+},0)$ are also \emph{feasible} and  are weakly better than the simultaneous mechanism. 
\end{lemma}

% To understand this lemma, suppose now the principal uses a sequential mechanism that offers test $h_{A}$ at the first stage, and (2) among those
% selected in (1), those whose attributes belong to $h_{B}$ will be eventually
% selected.

% As before, any agent with true attributes $\orifeatures\in h_{A}\cap h_{B}$ will
% not manipulate and will be selected. However, the sequential mechanism with
% fixed order of tests has enriched the agents' strategy space. Consider
% any agent with unqualified true attributes $\orifeatures\notin h_{A}\cap h_{B}$.
% He has now two options of getting selected: (1) to adopt attributes that are in
% the qualified region, and (2) to adopt attributes $\firstfeatures\in h_{A}$ for the
% first test, and after passing the first test, to adopt yet other attributes $%
% \secondfeatures\in h_{B}$. To illustrate the two types of strategies, consider an agent with attributes $\orifeatures$ in \cref{fig: zig zag}. The least costly one-step
% strategy that guarantees selection is to move to the  point $O$, at which
% the boundaries of $h_{A}$ and $h_{B}$ intersect. The utility of adopting
% this one-step strategy is $1-\onecost(\orifeatures,O)$.

% \begin{figure}[t]
% \centering
% \begin{tikzpicture}[xscale=10,yscale=10]

% \draw [domain=0.66:1.36, thick] plot (\x, {3/4*\x+1/4});
% \node [left] at (1.32, 1.25 ) {$\classifier_B$};%:\feature_2\geq \frac34 \feature_1 +\frac14
% \draw [thick] (1,0.66) -- (1,1.25);
% \node [right] at (1, 1.25 ) {$\classifier_A$};%: \feature_1 \geq 1$
% \node [left] at (1.27,1.2) {$+$};
% \node [right] at (1, 1.2) {$+$};

% \draw [domain=1+0.25*0.6:1.45, loosely dashed] plot (\x, {3/4*\x+1/4-5/16}); % 1/c = 1/4
% \draw [red,ultra thick] (1,1) -- (1+0.25*0.6,1-0.25*0.8);
% \node [right] at (1+0.25*0.6,1-0.25*0.8) {\footnotesize$B$};
% \node [left] at (1-0.25*0.6,1-0.25*0.8) {\footnotesize$B'$};

% \draw [loosely dashed] (1-0.25,1) -- (1-0.25,1.25);

% \draw [loosely dashed] (1-0.25,1) -- (1,1);
% \node [left] at (1-0.25, 1 ) {\footnotesize$A$};

% \draw[blue,ultra thick] (1-0.25,1) arc (180:233.1:0.25);
% \draw[blue,ultra thick] (1,1) -- ++(180:0.25);
% \draw[blue,ultra thick] (1,1) -- ++(233.1:0.25) ;

% \draw [red,ultra thick] (1,1) -- (1-0.25*0.6,1-0.25*0.8);
% \draw [ red,ultra thick] (1,11/16) -- (1-0.25*0.6,1-0.25*0.8);
% \node [left] at (0.98,11/16) {\footnotesize$C$};
% \draw [ red,ultra thick] (1,11/16) -- (1+0.25*0.6,1-0.25*0.8);

% \draw [dotted, ultra thick] (1-0.1,1-0.2) -- (1+0.1,1-0.2);
% \node [below] at (1-0.1, 1-0.2 ) {\footnotesize$\orifeatures$};
% \draw [dotted,ultra thick]  (1+0.1,1-0.2) -- (1+0.1-5.45/24*0.6,1-0.2+5.45/24*0.8);
% \node [below] at (1+0.1,1-0.2) {\footnotesize$\tilde\features$};
% \node [left] at  (1+0.1-5.5/24*0.6,1-0.2+5.5/24*0.8) {\footnotesize$\secondfeatures$};
% \draw [dotted,ultra thick] (1-0.1,1-0.2) -- (1,1-0.072);
% \node [right] at (1, 1-0.072 ) {\footnotesize$\firstfeatures$};

% \node [above] at (1.016, 1 ) {\footnotesize$O$};
% \end{tikzpicture}
% \caption{Two-step strategy: $\orifeatures\rightarrow \firstfeatures\rightarrow \secondfeatures$}
% \label{fig: zig zag}
% \end{figure}


% What is the least costly two-step strategy such that first attributes $%
% \firstfeatures\in h_{A}$ and next attributes $\secondfeatures\in h_{B}$ are attained? This question has been solved by \citet{zigzag} under additive Euclidean cost function.  Here we provide a geometric intuition for  additive Euclidean cost function. Observe that
% the two chosen attributes $\firstfeatures$ and $\secondfeatures$ must belong to the boundary of $%
% h_{A}$ and $h_{B}$, respectively. Reflect point $\orifeatures$ over line $h_{A}$.
% This gives point $\widetilde{\features}$ in \cref{fig: zig zag}. Under the additive costs $%
% \cost(\orifeatures,\firstfeatures,\secondfeatures)=\onecost(\orifeatures,\firstfeatures)+\onecost(\firstfeatures,\secondfeatures)$, where $\onecost(\features^{k},x^{l})$
% is equal to the Euclidean distance between $\features^{k}$ and $\features^{l}$, 
% \[
% \cost(\orifeatures,\firstfeatures,\secondfeatures)=\cost(\widetilde{\features},\firstfeatures,\secondfeatures)\text{,}
% \]%
% and by the triangle inequality, $\cost(\widetilde{\features},\firstfeatures,\secondfeatures)$ is the
% shortest when $\widetilde{\features}$, $\firstfeatures$ and $\secondfeatures$ are co-linear.\footnote{This is also equivalent to the following shortest path problem in optics.
% Suppose there is a light emitting from point $\orifeatures$.
% The light has to first reach mirror $A$ (line $A$) before it reaches mirror $B$ (line $A$). We find the shortest path in a similar way.}

To understand this lemma, suppose now the principal uses a sequential mechanism that offers test $h_{A}$ at the first stage, and (2) among those
selected in (1), those whose attributes belong to $h_{B}$ will be eventually
selected. Using the same intuition we discussed before, we can characterize the set of attributes that get selected under such a fixed-order mechanism (see for instance \cref{fig: zig zag} and discussions in \cref{sec: distance cost}).

In order not to select any unqualified agent, the principal needs to choose
more stringent tests instead of $h_{A}$ and $h_{B}$. One obvious candidate is the same stringent tests  in the optimal simultaneous mechanism: $%
h_{A}^{+}$ and $h_{B}^{+}$.
It remains to check that all agents selected by the fixed-order sequential mechanism are qualified under tests $%
h_{A}^{+}$ and $h_{B}^{+}$.
It turns out that this is indeed the case here.
However, in general, even under additive Euclidean cost function, there are tests that are feasible under simultaneous mechanisms but are not feasible under fixed-order sequential mechanisms.

Which mechanism: the optimal simultaneous mechanism  $h_{A}^{+}\cap h_{B}^{+}$ or fixed-order sequential $%
h_{A}^{+}$ and $h_{B}^{+}$ is preferred by the principal? This
problem has been posed by \citet{zigzag} under additive Euclidean cost; however, there is an error in the proof of their main result (Theorem 4.4), which we correct here. 
Observe that by using the fixed-order sequential mechanism $%
h_{A}^{+}$ and $h_{B}^{+}$, the principal selects more agents than
by using the simultaneous mechanism $h_{A}^{+}\cap h_{B}^{+}$ under the additive Euclidean distance cost. This is
because the fixed-order sequential mechanism enables agents to use two-step
strategies, which are cheaper (sometimes strictly) than the best one-step
strategy. It turns out that this reasoning is quite general and not confined to the additive Euclidean distance cost.



\begin{lemma}\label{lem:stringent tests}
    Any feasible mechanism uses stringent tests, i.e., the two tests the mechanism announces $\tilde\classifier_A$ and $\tilde\classifier_B$  satisfies $\tilde\classifier_A\cap\tilde\classifier_B\subsetneq \classifier_A\cap\classifier_B$.
\end{lemma}



Now, we prove the main theorem.

\begin{proof}[Proof of \cref{thm:opt_manipulation}]
    % % If there is no feasible simultaneous testing mechanism for~\ref{max qualified}, then there is no feasible sequential mechanism for~\ref{max qualified}. 
    % For any sequential mechanism, the agent can always move to the attributes used in the simultaneous mechanism in the first test. 
    % Thus, the sequential mechanism will accept the unqualified agent accepted by the simultaneous mechanism with the same two tests. 

    % Suppose there exist feasible simultaneous mechanisms for~\ref{max qualified}. 
    % Then, by \cref{lem:fix-simul}, there exists a feasible fixed-order mechanism that is no worse than this simultaneous mechanism. 
    % % By Lemma~\ref{lem:fix-rand}, the optimal fixed-order mechanism is no worse than the optimal random-order mechanism. Thus, the optimal mechanism is a fixed-order mechanism. 
    % By \cref{lem:stringent tests}, the optimal mechanism uses stringent tests.

    \cref{prop:optimal simultaneous manipulation general cost} and  \cref{lem:fix-simul} together imply that there exists a feasible fixed-order mechanism that is no worse than the optimal simultaneous mechanism. Hence the optimal mechanism must be a sequential one.
    \cref{lem:stringent tests} shows that the optimal mechanism must use stringent tests.
\end{proof}


% Note that we consider the informed setting in Theorem~\ref{thm:opt_manipulation}. We use the informed setting to analyze the agent's expected utility in Lemma~\ref{lem:fix-rand}. It is straightforward to extend it to the uninformed setting since the agent's expected utility in the random-order mechanism is getting smaller.\xqcomment{need to add the uninformed setting too, since we have expanded the definition of sequential mechanisms}
% \cref{thm:opt_manipulation} can be generalized to the case where the qualified region is the intersection of multiple linear classifiers and the sequential testing mechanism with multiple linear tests.  

% \paragraph{Other objectives}
% construct examples 



% \xqcomment{add the theorem where we can rule out the case where there is no feasible candidates}

% \xqcomment{add intuition of theorem 5.3, cost properties simplify and intuition}

% \xqcomment{connection to another triangle inequality used in \citet{perez2022test}.}


% \xqcomment{add example(s) with distance cost}

% \xqcomment{add discussions on how the cost functions is meaningful in different applications.}

\input{Paper/5b_optimal_investment}





