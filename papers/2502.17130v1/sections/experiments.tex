\section{Experiments}
\label{sec:experiments}
\vspace{-0.1cm}

\subsection{Ablations}
\vspace{-0.1cm}
\paragraph{Minimal angle maximization.}
To test how well the proposed methods for hyperspherical separation perform, we generate points $\bfw_{1}, \ldots, \bfw_k$ on an 8-dimensional hypersphere for various numbers of points $k$ and compute the minimal pairwise angle $\min_{i \neq j} \angle (\bfw_i, \bfw_j)$. We compare to the Hadamard generation method from \citep{sala2018representation} and the method that is used in their implementation, which precomputes 1000 points using the method from \citep{lovisolo2001uniform} and samples from these precomputed points. Note that a power of 2 is chosen for the dimension to be able to make a fair comparison to the Hadamard construction, since this method cannot be used otherwise. The results are shown in Figure \ref{fig:hyperspherical_separation}. These results show that our MAM indeed leads to high separation in terms of the minimal pairwise angle, that the precomputed approach leads to poor separation and that the Hadamard method only performs moderately well when the number of points required is close to the dimension of the space.

To verify that this minimal pairwise angle is important for the quality of the construction, we perform the construction on a binary tree with a depth of 8 edges using each of the hypersphere generation methods. The construction is performed in 10 dimensions except for the Hadamard method, since this cannot generate 10 dimensional points. Additional results for dimensions 4, 7 and 20 are shown in Appendix \ref{sec:bin_tree_dim_res}. Each method is applied using float32 representations and a scaling factor of $\tau = 1.33$. The results are shown in Table \ref{tab:hyperspherical_ablation}. These findings support our hypothesis that the minimal pairwise angle is important for generating high quality embeddings and that the MAM is an excellent objective function for performing the separation.

\input{figures/combined_ablations_hmds_distortion}

\input{tables/hyperspherical_energy_minimization_ablation}

\vspace{-0.1cm}

\paragraph{FPEs versus standard floating points.}
To demonstrate the importance of using FPEs for increasing precision, we perform the construction on a phylogenetic tree expressing the genetic heritage of mosses in urban environments \citep{hofbauer2016preliminary}, made available by \mbox{\citep{sanderson1994treebase}}, using various precisions. This tree has a maximum path length $\ell = 30$, which imposes sharp restrictions on the value of $\tau$ that we can choose before encountering numerical errors. We perform the construction either with normal floating point arithmetic using the usual GPU-supported float formats or with FPEs, using multiple float64 terms. The scaling factor $\tau$ is chosen to be close to the threshold where numerical problems appear in order to obtain optimal results for the given precision.
The results in terms of $D_{wc}$ are shown in Figure \ref{fig:fpe_ablation}. As can be seen from these results, around 100 bits of precision are needed to obtain decent results, which can be achieved using FPEs with 2 float64 terms. Without FPE expansions, the largest GPU-compatible precision is 53 bits, obtained by using float64. This precision yields a $D_{wc}$ of 9.42, which is quite poor. These results illustrate the importance of FPEs for high quality GPU-compatible embeddings.
\vspace{-0.1cm}

\subsection{Embedding complete \texorpdfstring{$m$}{m}-ary trees}
\vspace{-0.2cm}
To demonstrate the strong performance of the combinatorial constructions compared to other methods, we perform embeddings on several complete $m$-ary trees with a max path length of $\ell = 8$ and branching factors $m = 3, 5, 7$. Due to the small $\ell$, each experiment can be performed with normal floating point arithmetic using float64 representations. We compare our method with Poincar√© embeddings (PE) \citep{nickel2017poincare}, hyperbolic entailment cones (HEC) \citep{ganea2018hyperbolic}, distortion optimization (DO) \citep{sala2018representation,yu2022skin}, h-MDS \citep{sala2018representation} and the combinatorial method with Hadamard \citep{sala2018representation} or precomputed hyperspherical points \citep{lovisolo2001uniform}. For the constructive methods and for h-MDS, a larger scaling factor improves performance, so we use $\tau = 5$. For DO we find that increasing the scaling factor does not improve performance, so we use $\tau = 1.0$. PE and HEC are independent of the scaling factor.

\input{tables/n_h_tree_comparison_v2}

The results on the various trees in 10 dimensions are shown in table \ref{tab:n_h_tree_comp} and additional results for dimensions 4, 7 and 20 are shown in Appendix \ref{sec:m_tree_dim_res}. These illustrate the strength of the combinatorial constructions. The optimization methods PE, HEC and DO perform relatively poor for all evaluation metrics. This performance could be increased through hyperparameter tuning and longer training. However, the results will not come close to those of the other methods. The h-MDS method performs well in terms of $D_{ave}$, but very poorly on $D_{wc}$ and MAP. This is because h-MDS collapses leaf nodes, leading to massive local distortion within the affected subtrees. However, between subtrees this distortion is much smaller, explaining the low $D_{ave}$. Figure \ref{fig:hmds_vs_ms_dte} illustrates the issue with h-MDS and the superiority of our approach.
Each of the white squares in the h-MDS plot corresponds to a collapsed subtree, which renders the embeddings unusable for downstream tasks since nearby leaf nodes cannot be distinguished.
We conclude that HS-DTE obtains the strongest embeddings overall.

\vspace{-0.2cm}


\input{tables/phylogenetic_trees}

\subsection{Embedding phylogenetic trees}
\vspace{-0.2cm}
Lastly, we compare hyperbolic embeddings on phylogenetic trees. Moreover, we show how adding HypFPE to our method and the other combinatorial methods increases the embedding quality when requiring GPU-compatibility. The phylogenetic trees describe mosses \citep{hofbauer2016preliminary}, weevils \citep{marvaldi2002molecular}, the European carnivora \citep{roquet2014one}, and lichen \citep{zhao2016towards}, obtained from \citep{mctavish2015phylesystem}. The latter two trees are weighted trees which can be embedded by adjusting the scaling in step \ref{ln:constr_scale} of Algorithm \ref{alg:sarkar}. Each of the embeddings is performed in 10-dimensional space. Other dimensions are given in Appendix \ref{sec:phylo_tree_dim_res}. The h-MDS method and the combinatorial constructions are performed with the largest $\tau$ that can be used with the given precision. 
The results are shown in Table \ref{tab:tree_embeddings}. When using float64, HS-DTE outperforms each of the optimization-based methods and the other combinatorial approaches from \citep{sala2018representation}. While h-MDS obtains high average distortion, it collapses entire subtrees, leading to massive local distortion. Therefore, the HS-DTE embeddings are of the highest quality. When adding HypFPE on top of the combinatorial approaches, all performances go up, with the combination of HS-DTE and HypFPE leading to the best performance on both $D_{ave}$ and $D_{wc}$. Additional results on graph-like data are shown in Appendix \ref{sec:graphs}.
