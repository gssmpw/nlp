\documentclass[journal,twoside,web]{ieeecolor}
\usepackage{generic}
% \usepackage[outdir=./figs]{epstopdf}
% \usepackage{epstopdf}
%\usepackage{cite}
\let\proof\relax
\let\endproof\relax
\let\labelindent\relax
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage[font=small]{caption}
\usepackage[font=small]{subcaption}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage[ruled]{algorithm2e}
\SetKw{Break}{break}
\SetKw{Continue}{continue}
\setlength{\marginparwidth}{2cm}
% \usepackage{todonotes}
%\usepackage{sample_complexity_hanchmin/hanch_sty}
\usepackage{cuted}
\usepackage{enumitem}
\setitemize{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}
\usepackage{dsfont}
%\usepackage{xstring}
\usepackage{orcidlink}
\usepackage[backend=biber,style=numeric-comp,sorting=none,natbib=true,doi=false,isbn=false,url=false,eprint=false,giveninits=true]{biblatex}
\addbibresource{references.bib}
\usepackage{tikz}
\usetikzlibrary{automata, positioning}
\usepackage{pgfplots}
\usepackage{pgfplotstable} % For reading CSV files

\usepgfplotslibrary{fillbetween} 
\pgfplotsset{compat=1.17}
\usepgfplotslibrary{colormaps}
%\definecolor{mycolorZ0}{RGB}{100,50,50}%brown
%\definecolor{mycolorZ2}{RGB}{255,0,0}%red
%\definecolor{mycolorZ4}{RGB}{255,200,200}%pink
%\definecolor{mycolorZ5}{RGB}{200,80,200}%magenta
%\definecolor{mycolorZ1}{RGB}{255,150,0}%orange
%\definecolor{mycolorZ3}{RGB}{100,30,255}%purple

\definecolor{mycolorZ0}{named}{red}%red
\definecolor{mycolorZ1}{named}{green}%green
\definecolor{mycolorZ2}{named}{blue}%blue
\definecolor{mycolorZ3}{named}{orange}%orange
\definecolor{mycolorZ4}{named}{cyan}%cyan
\definecolor{mycolorZ5}{named}{magenta}%magenta


\definecolor{mycolorA0}{RGB}{0,0,255}%blue
\definecolor{mycolorA3}{RGB}{0,200,0}%light green
\definecolor{mycolorA2}{RGB}{0,100,0}%dark green
\definecolor{mycolorA1}{RGB}{0,200,200}%cyan
\definecolor{mycolorA4}{RGB}{50,50,50}%grey

%\usepackage{natbib}
% \usepackage{academicons}
% \newcommand{\orcidlogo}{\href{https://orcid.org/0009-0000-4783-0632}{\textsuperscript{\includegraphics[scale=0.08]{TAC_journal/logo-orcid-eps-converted-to.pdf}}}}
%\usetikzlibrary{external}
%\tikzexternalize[prefix=./]
% \theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{lemma}{Lemma}
\newtheorem{claim}{Claim}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\newtheorem{assumption}{Assumption}
\newtheorem{innercustomthm}{Theorem}
\newenvironment{customthm}[1]
  {\renewcommand\theinnercustomthm{#1}\innercustomthm}
  {\endinnercustomthm}
 \newtheorem{innercustomlem}{Lemma}
\newenvironment{customlem}[1]
  {\renewcommand\theinnercustomlem{#1}\innercustomlem}
  {\endinnercustomlem}
  
% \renewcommand{\baselinestretch}{.985}
\renewcommand{\baselinestretch}{1}

\DeclareMathOperator*{\argmax}{argmax} \allowdisplaybreaks
  
\include{edits}
  
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\markboth{\journalname, VOL. XX, NO. XX, XXXX}
{Leopoldo Agorio \MakeLowercase{\textit{et al.}}: 
Cooperative Multi-Agent Assignment over Stochastic Graphs via Constrained Reinforcement Learning
}

\begin{document}
\title{
Cooperative Multi-Agent Assignment over Stochastic Graphs via Constrained Reinforcement Learning
}

%\author{Leopoldo Carlos Agorio Grove\orcidlink{XXXX-XXXX-XXXX-XXXX}, \IEEEmembership{Student Member, IEEE}, Santiago Paternain\orcidlink{XXXX-XXXX-XXXX-XXXX}, \IEEEmembership{Member, IEEE},\\
 %Miguel Calvo-Fullana\orcidlink{XXXX-XXXX-XXXX-XXXX},\IEEEmembership{Member, IEEE} , and Juan Andres Bazerque\orcidlink{0000-0001-9950-1208},
 %\IEEEmembership{Member, IEEE}
%\thanks{}\thanks{}\thanks{}\thanks{}\thanks{}
%
%\author{Leopoldo Agorio\href{https://orcid.org/0009-0000-4783-0632}{\includegraphics[scale=0.08]{logo-orcid-eps-converted-to.pdf}}, \IEEEmembership{Student Member, IEEE}, Sean Van Alen\href{https://orcid.org/0009-0000-4783-0632}{\includegraphics[scale=0.08]{logo-orcid-eps-converted-to.pdf}}, \IEEEmembership{Student Member, IEEE}, 
 %       Santiago Paternain\href{https://orcid.org/0009-0000-4783-0632}{\includegraphics[scale=0.08]{logo-orcid-eps-converted-to.pdf}}, \IEEEmembership{Member, IEEE},
  %      Miguel Calvo-Fullana\href{https://orcid.org/0009-0000-4783-0632}{\includegraphics[scale=0.08]{logo-orcid-eps-converted-to.pdf}}, \IEEEmembership{Member, IEEE}, and 
   %     Juan Andres Bazerque\href{https://orcid.org/0009-0000-4783-0632}{\includegraphics[scale=0.08]{logo-orcid-eps-converted-to.pdf}}, \IEEEmembership{Member, IEEE}
%}


\author{Leopoldo Agorio, Sean Van Alen, 
         Santiago Paternain,
        Miguel Calvo-Fullana, and 
        Juan Andres Bazerque      
        % <-this % stops a space
\thanks{Leopoldo Agorio, Sean Van Allen, and Juan Andres Bazerque are with the Dept. of Electrical and Computer Engineering, Univ. of Pittsburgh, Pittsburgh, PA, USA  (emails: lca31@pitt.edu, sgv13@pitt.edu, juanbazerque@pitt.edu). \\
%
Santiago Paternain is with the 
Dept. of Electrical Computer and Systems Engineering, Rensselaer Polytechnic Institute, Troy, NY, USA (e-mail: paters@rpi.edu).\\
%
Miguel Calvo-Fullana is with the Dept of Engineering,  Universitat Pompeu Fabra, Barcelona, Spain (email: miguel.calvo@upf.edu). }}
\maketitle

\begin{abstract}
  Constrained multi-agent reinforcement learning offers the framework to design scalable and almost surely feasible solutions for teams of agents operating in dynamic environments to carry out conflicting tasks. We address the challenges of multi-agent coordination through an unconventional formulation in which the dual variables are not driven to convergence but are free to cycle, enabling agents to adapt their policies dynamically based on real-time constraint satisfaction levels. The coordination relies on a light single-bit communication protocol over a network with stochastic connectivity. Using this gossiped information, agents update local estimates of the dual variables. Furthermore, we modify the local dual dynamics by introducing a contraction factor, which lets us use finite communication buffers and keep the estimation error bounded. Under this model, we provide theoretical guarantees of almost sure feasibility and corroborate them with numerical experiments in which a team of robots successfully patrols multiple regions, communicating under a time-varying ad-hoc network. 
\end{abstract}

\section{Introduction}
\input{sections/01_intro}

\section{Problem Formulation}
\input{sections/02_problem_formulation}

\section{Offline Training and Online Execution}
\input{sections/03_offline_training}

\input{sections/04_gossiping}

 \section{Feasibility Analysis}\label{sec:feasibility}
 \input{sections/05_convergence_analysis}

\section{Numerical Experiments}\label{sec_numerical}
\input{sections/06_numericals}

\section{Conclusion}
\label{sec:conclusion}
In this work, we demonstrated the effectiveness of CMARL in complex coordination problems in which agents must solve competing tasks. By employing a state augmentation framework with non-convergent dual variables, we enabled agents to dynamically adapt their policies based on real-time constraint satisfaction levels. The integration of a gossiping protocol allowed agents to share local reward estimations across a stochastic network with one-bit communication, eliminating the need for direct state access and ensuring robust coordination. Our proposed contractive update rule for dual variables further enhanced scalability and feasibility without relying on exponentially growing memory buffers. We established theoretical guarantees of almost sure feasibility, as formalized in our main theorem, and validated our approach through  numerical experiments. In these experiments, a team of robots successfully patrolled multiple regions under realistic communication constraints and intermittent connectivity, showcasing the practical applicability of our framework.

\appendix
\input{sections/07_appendix}
%\bibliography{references}

%\newpage
\printbibliography
\begin{IEEEbiography}
[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{photos/agorio}}]
{Leopoldo Agorio} received the B.Sc. degree in physics, and the B.Sc. and M.Sc. degrees in electrical engineering in 2018, 2019 and 2020 respectively, from the Universidad de la República (UdelaR) Montevideo, Uruguay.   He is currently pursuing the Ph.D. degree at the University of Pittsburgh (Pitt), Pittsburgh, PA.
He served as a teaching and research assistant at the Department of Applied Optics and the Department of Systems and Control at the School of Engineering, UdelaR, and at the Department of Electrical and Computer Engineering at Pitt. His current research interests include mobile robotics, multi-agent reinforcement learning, graph signal processing and quantum computing. Leopoldo has also industry experience as an integrator engineer in electronics and  robotics as well as applying computer vision technologies for  quality control.
\end{IEEEbiography}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{photos/sean}}]
{Sean Van Alen} received the B.Sc. degree in Electrical and Computer Engineering from the University of Pittsburgh (Pitt) in May 2025. Sean received the 2024 Scholarship for Undergraduate Research from the department of Biomedical Engineering at Pitt, under the supervision of Dr. Bazerque.
\end{IEEEbiography}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{photos/paternain}}]
{Santiago Paternain }
received the B.Sc. degree in electrical engineering from Universidad de la República Oriental del Uruguay, Montevideo, Uruguay in 2012, the M.Sc. in Statistics from the Wharton School in 2018 and the Ph.D. in Electrical and Systems Engineering from the Department of Electrical and Systems Engineering, the University of Pennsylvania in 2018. He is currently an Assistant Professor in the Department of Electrical Computer and Systems Engineering at the Rensselaer Polytechnic Institute. Prior to joining Rensselaer, Dr. Paternain was a postdoctoral Researcher at the University of Pennsylvania. His research interests lie at the intersection of machine learning and control of dynamical systems. Dr. Paternain was the recipient of the 2017 CDC Best Student Paper Award and the 2019 Joseph and Rosaline Wolfe Best Doctoral Dissertation Award from the Electrical and Systems Engineering Department at the University of Pennsylvania. 
\end{IEEEbiography}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{photos/calvofullana}}]
{Miguel Calvo-Fullana} received the B.Sc. degree in electrical engineering from the Universitat de les Illes Balears (UIB) in 2010 and the M.Sc. and Ph.D. degrees in electrical engineering from the Universitat Polit\`ecnica de Catalunya (UPC) in 2013 and 2017, respectively. He joined Universitat Pompeu Fabra (UPF) in 2023, where he is a Ram\'on y Cajal fellow. Prior to joining UPF, he held postdoctoral appointments at the University of Pennsylvania and the Massachusetts Institute of Technology, and during his Ph.D., he was a research assistant at the Centre Tecnol\`ogic de Telecomunicacions de Catalunya (CTTC). His research interests lie in the broad areas of learning and optimization for autonomous systems, with a particular emphasis on multi-agent systems, wireless communication and networks connectivity. He is the recipient of best paper awards at ICC 2015, GlobalSIP 2015, and ICASSP 2020.
\end{IEEEbiography}

\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{photos/bazerque}}]
{Juan Andr\'es Bazerque} received a B.Sc. degree in electrical engineering from Universidad
de la Republica (UdelaR), Montevideo, Uruguay, in 2003, and the M.Sc. and Ph.D. degrees in
electrical engineering from the University of Minnesota (UofM), Minneapolis, in 2010 and 2013,
respectively. 
After his Ph.D., he joined the Department of Electrical Engineering, UdelaR, as an Assistant Professor. In 2022, he  joined the Department of Electrical and Computer Engineering at the University of Pittsburgh. In 2024, he became Associate Editor for the Transactions on Signal Processing. His research interests include stochastic optimization and networked systems, focusing on reinforcement learning and algebraic signal processing. 
Dr. Bazerque was the recipient of the UofM’s Master Thesis Award 2009–2010, and a co-recipient of the best paper award at the 2nd International Conference on Cognitive Radio Oriented Wireless Networks and Communication in 2007. 
\end{IEEEbiography}
\end{document}