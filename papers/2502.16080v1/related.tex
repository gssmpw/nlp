\section{Related Work}
\label{sec:related}

Beyond the works mentioned earlier, our paper is close to two literature on stochastic economies, one in financial economics which theoretical and focuses on understanding mathematical properties of general equilibrium competitive equilibrium in incomplete markets \cite{duffie1987stochastic, duffie1990stochmodels, duffie1985equilibrium,duffie1986equilibrium}, and another one in macroeconomics which focuses on the computation of sequential or recursive competitive equilibrium in incomplete stochastic economies to simulate various macroeconomic issues; see, for instance, \citeauthor{kydland1982time} (\citeyear{kydland1982time}) and \citeauthor{lucas1971investment} (\citeyear{lucas1971investment}).%
\footnote{Since the 90s, a sizable body of work in financial economics (see for instance \cite{fernandez1016solve, auclert2021using} has considered computational approaches to solving general equilibrium models of financial markets; however, much of this work can be seen as extension of the macroeconomics literature.} 

\paragraph{Financial economics}
Regarding the literature in financial economics, we refer the reader to the survey work of \citet{magill2002theory}, and mention here only a few of some the influential models for the development of stochastic economies. Following the initial interest of the early 1970, the literature on stochastic economies in financial economics mostly focused on stochastic economies with two time-periods up to the end of the 1980s. In the early 1980s, there was an explosion of option pricing studies and arbitrage pricing in the early 1980s (See, for
example, \citet{cox1976valuation, ross1976options}  \citet{cox1979option}, \citet{cox1985intertemporal}, and \citet{huberman1982simple}.] 
By the mid-1980s, the theory of stochastic economies made great strides, with two influential papers, \citeauthor{cass1984competitive} (\citeyear{cass1984competitive, cass1985number}) showing that existence of a general equilibrium could be guaranteed if all the assets promise delivery
in fiat money, and he showed that with such financial assets there could be a multiplicity of equilibrium. In contrast, our existence result does not assume the existence of fiat money. Almost simultaneously \citet{werner1985equilibrium} also gave a proof of existence of equilibrium with financial assets, and \citet{geanakoplos1986walrasian} showed the same for economies with real assets that promise delivery in the same consumption good.\citet{duffie1987stochastic} then extended the existence results for purely financial assets to arbitrary finite horizon stochastic economies. As stochastic economies with incomplete asset markets have been shown to not satisfy a first welfare theorem of economics, following preliminary insight from \citet{diamond1967incompletege} the literature turned its attention definine notions of constrained efficiency. Successive refinements of the definition were given by \citet{diamond1980income}, \citet{loong1982pecuniary}, \citet{newbery1982theory}, \citet{stiglitz1982self}, and \citet{greenwald1986externalities} with a mostly accepted definition of constrained efficiency becoming becoming clear by the late 1980, with \citet{geanakoplos1990introduction} eventually proving that sequential competitive equilibrium are is constrained efficient inefficient.
 


%Beyond \citeauthor{lucas1978asset}'s \cite{lucas1978asset} restricted setting, it is virtually impossible to solve DSGE models in closed form.
%%, and hence make any inferences based on the model's solution.\amy{i think by now the reader should know why we care about solving DSGE. so maybe say something about what you do with solutions to DSGE models much earlier.}

% As stochastic economies are both sequential and stochastic in nature, computing sequential competitive equilibrium involves the exploration of continuous state and action spaces. 
% In other words, computing equilibrium in such models amounts to a multiagent learning problem.
% In this paper, we propose solutions to DSGE models via reinforcement learning.
%\mydef{economic reinforcement learning}.

%This gap in the literature points to a need for efficient learning methods to solve incomplete market models.

% \deni{Have to cite the following which suggests there is a need to understand the tradeoff between speed and accuracy: }
% \amy{i don't think you can just jump to RL without first explaining why dynamic programming is insufficient. e.g., state space is too big, or whatever!}

% \textcolor{cyan}{Alec says: I think the introduction is too long-winded. Somehow we need to build to the persistent gap in the aforementioned works more quickly in order to motivate what this work does}
% \amy{Deni's intros are always long winded. i can see that some people might like that, others not. they often have to be shortened to meet the space constraints of a conference publication. but...in this case, since he is initiating literature on using RL-type methods to solve macro models, i think the historical perspective on macro models is helpful. but of course only to the extent that there will be space for it in the conference proceedings.}

% \deni{The first DSGE model which is solved in closed form, is this:\cite{lucas1978asset}}
% \deni{???? These refs are the ones that are representative and stationary agent????}
% \deni{start of RBC models attributed to: \cite{kydland1982time, long1983real}}
% \deni{Talk about new keynesian, and then go into HANK}

% \deni{Need to cite this paper that how inaccurate solutions may cause
% spurious welfare reversal \cite{kim2003spurious}}



% That is,  on \mydef{complete markets}, i.e., economies in which there exist a complete set of state-contingent financial contracts, often referred to as \mydef{Arrowâ€“Debreu securities}, e.g., futures contracts, which price commodities in all future states of the world.
% In a complete market, all economic activity could be viewed as taking place during a single time period, as\amy{i don't understand the rest of this sentence:}  that there exists a complete set of of  for all commodities throughout time and space.
% \deni{incomplete because state space is strictly larger than asset market dimension}
% \deni{Note, recursive competitive equilibrium was originall defined for a representative agent model.}
% Unfortunately, it is unrealistic to view real-world markets as complete, e.g., one could have not envisioned selling Arrow-Debreu securities for electric cars before the invention of fossil fuel cars.
% Any economy in which uncertainty \samy{}{about the future must be resolved to} determine the market state is an \mydef{incomplete market}  



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \deni{TO REMOVE BUT REVISIT AND INCORPORATE SOMEWHERE MAYBE: A popular class of incomplete markets models, known nowadays as the \mydef{standard incomplete markets model} (or the \mydef{Bewley-Huggett-Aiyagari} model \cite{bewley1983difficulty, huggett1993risk,aiyagari1994uninsured}), features one-shot markets, linked over time by imperfectly and incomplete asset markets,\amy{didn't understand this last phrase?}
% and characterized by (1) borrowing constraints, i.e., agents can borrow and save across time/markets, and (2)  lack of insurance against stochastic realizations of future states of the economy, i.e., agents cannot purchase Arrow-Debreu securities to ensure themselves across time/markets. A large literature has been devoted to the use of variants of the standard incomplete markets model to model various macroeconomic and financial problems, primary amongst them being asset pricing.}




 


% \deni{Saving is often interpretted from the lens of risk-free bond.}

\paragraph{Macroeconomics}

The literature on stochastic economies in macroeconomics is known under the name of \mydef{dynamic stochastic general equilibrium (DSGE) models}. Stochastic economies have received interest in macroeconomics after \citeauthor{lucas1978asset}'s (\citeyear{lucas1978asset}) seminal work, in which he derived a recursive competitive equilibrium in closed form in a stochastic economy with one commodity and and one consumer allowing him to analyze asset prices in his model. Unfortunately, beyond Lucas' simpler model, it became apparent that analyzing the solutions of stochastic economies required the use computation. 
One of the earliest popular stochastic economy models in economics which was solved via computational methods is the \mydef{Real Business Cycle (RBC)} model \cite{kydland1982time, long1983real}. The RBC model is a parameterized stochastic economy whose parameters are calibrated to accurately model the US economy. RBC models are characterized by demand generated by a representative infinitely-lived agent, with supply generated exogeneously by a standard (or Solow) growth model \cite{acemoglu2008introduction}, or by a representative firm.
These models have fallen out of favor, because some of their assumptions were invalidated by data (see, for example, Section 2 of \citet{christiano2018dsge}).
They were replaced by a class of DSGE models known as \mydef{Representative Agent New Keynesian (RANK)} models (see, for instance, \citet{clarida2000monetary}). As RBC and RANK models derive their modelling assumptions from two different schools of macroeconomic thought (i.e., the New Keynesian and New Classical schools, respectively),%
from a mathematical and computational perspective they can be seen as the same, as both are characterized by a representative consumer and an exogenous growth model, or a representative firm.

Following the financial crisis of 2008, these representative-agent models, too, fell out of favor, and the literature turned to modeling heterogeneity, because of its importance in understanding inequality, in particular across consumers.
\mydef{Heterogeneous agent new Keynesian models (HANK)} are stochastic economies which 
% \amy{mean field, with representative agents. dist'n over types and endowments. aggregate maximization (integrate over dist'n).}
are built on top \mydef{Bewley-Huggett-Aiyagari} models \cite{bewley1983difficulty, huggett1993risk,aiyagari1994uninsured}, and are characterized by demand and supply generated by an infinite population of agents with differing characteristics. These models are mathematically and computationally much more different than the RBC and RANK models and have been shown to be possible to model as single population mean-field games \cite{achdou2022income}, i.e., games with an infinite population of players. 
More recently, a new class of stochastic economies called \mydef{Many Agent New Keynesian (MANK)} has emerged. This class of models bridges the gap between the infinite population regime of heterogeneous agent models and the single agent regime of representative agent models. These models are characterized by a demand and a supply generated by multiple consumers and firms, but are arguably more interpretable \cite{eskelinen2021monetary} (see, for instance, \citet{cloyne2020monetary, eskelinen2021monetary}) and have shown to approximate the solutions of heterogeneous agent models effectively when the number of agents in the economy is large enough \cite{han2021deepham}.
That is MANK models are sufficiently expressive to capture a range of models, corresponding to RANK at one extreme, and to HANK at the other.
Ignoring the stylized details of the aforementioned stochastic economies, all of them feature static markets, linked over time, often although not always, by incomplete financial asset markets, and differ in the number and heterogeneity of the agents, firms and good in the economy, as well as the types of transitions they employ, whether it be transition functions which model \mydef{aggregate shocks} (i.e., transitions functions which change the state of each consumer and firm in the economy in the same way)  or \mydef{idiosyncratic shock} (i.e. transition function which model transition the state of each consumer in the economy in distinct way).
\emph{The infinite horizon Markov exchange economy that we develop in this paper corresponds to a many agent stochastic economy model, and can be coupled with either the New Keynesian or New Classical paradigm to capture most of the models proposed in the literature.}


%\footnote{Although we do not touch upon it due to it being out of the scope of this paper, the estimation and/or calibration of stochastic economies has been extensively studied. For a review of this literature see, for instance, \cite{fernandez1016solve}.} 
%\amy{richer, i assume?}\deni{you had added richer here, I removed it because if we use it we will be in the middle of an ongoing macroeconomic controversy.}
%which came to existence around the same time as RBC models. 
% \deni{Add more HANK citations.}
% \amy{only one good: capital}


% After substantial interest in the analysis of stochastic economies among microeconomists through the 1970s, the literature seemed to trail off, 
% %for half a decade 
% perhaps due to a seeming difficulty in proving existence of a general equilibrium in simple economies with incomplete asset markets that allow assets to be sold short \cite{geanakoplos1990introduction}, or to the lack of a second welfare theorem \cite{dreze1974investment, hart1975optimality}.%
% \amy{don't you kind of need a GE existence result to have a first welfare theorem. so it seems like we might be able to say even in simpler models (no short selling) where GE exist, there is no 1st welfare them} \deni{You do not need a GE existence result to prove a 1st welfare theorem. In fact, AD prove the welfare theorems in 1951 while they proved existed in 1954. If anything the welfare theorems indicate why one should prove the existence of GE, because they are efficient!} \amy{then what was the object of study in those early first welfare theorems, if CE allocations were not known to exist!?}
% \footnote{\amy{this is a total aside. definite candidate for deletion!} Following these initial negative results on incomplete markets, the last decade or so of the ``glory'' years of general equilibrium theory were dedicated to understanding the optimal provision of public commodities \cite{samuelson1954pure,foley1966resource, foley1970lindahl} using general equilibrium tools, e.g., Lindahl-Foley equilibrium, leading to the birth of mechanism design \cite{hurwicz1960optimality, hurwicz1972informationally, hurwicz1979outcome}.} 
% %As such, interest in general equilibrium theory, formerly the purview of microeconomists, was taken up by macro and financial economics.
% In spite of the theoretical obstacles, interest in incomplete stochastic economies was picked up by the finance and macroeconomics communities.
%Much of this literature concerns incomplete stochastic economies, as it is unrealistic to model real-world markets as complete, e.g., one could probably not have envisioned selling securities for electric cars before the invention of gasoline-powered cars.

\deni{Revisit this paragraph to add references.}

% \amy{here's where you can say something about the markets clearing!}\deni{I agree, although rn not sure how to phrase it!}

% Foremost to the development of this theory was the introduction of a broad economic framework, known as the \mydef{Arrow-Debreu model of a competitive economy} \cite{arrow-debreu}, for which competitive equilibrium prices would exist. The Arrow-Debreu model comprises a set of commodities; a set of firms, each deciding what quantity of each commodity to supply; and a set of consumers, each choosing a quantity of each commodity to demand in exchange for their endowment \cite{arrow-debreu}. 
% \deni{Make this more succint!}\citeauthor{arrow-debreu} define a \mydef{competitive equilibrium} as a collection of consumptions, one per consumer, a collection of productions, one per firm, and prices, one per commodity, such that fixing equilibrium prices: (1) no consumer can increase their utility by deviating to an alternative affordable consumption, (2) no firm can increase profit by deviating to another production in their production set, and (3) the \mydef{aggregate demand} for each commodity (i.e., the sum of the commodity's consumption across all consumers) does not exceed to its \mydef{aggregate supply} (i.e., the sum of the commodity's production and endowment across firms and consumers, respectively), while the total value of the aggregate demand is equal to the total value of the aggregate supply, i.e., \mydef{Walras' law} holds.

\if 0
Going beyond static economies, this paper concerns questions of existence and efficient computation of competitive equilibria in stochastic economies, a class of economic models which have come to be known%
\footnote{in particular in macroeconomics' circles}
as dynamic stochastic general equilibrium (DSGE) models, which, as the name suggests, model both time and uncertainty \samy{}{over a continuous-state, continuous-action multiagent interaction}.
\fi

% \deni{Maybe add a (foot)note on why we describe the stochastic economy in terms of financial contract instead of commodities being sold at a future state at this current period in time.} 

%\amy{why do we care about DSGE models? what are they used for? what does it mean to ``make inferences'' in these models? i.e., why do we want to solve them -- and what does it mean to solve them? it's okay to use the term sequential CE in this paragraph, and then define it two paragraphs down.}

%\deni{make \samy{inferences}{predictions} \amy{?} about how economic outcomes vary when a model transitions from one state of the economy to another.}

%\textcolor{red}{Alec says: there are a lot of concepts being introduced in rapid succession here. For non-experts, it may be helpful to include some sort of directed graph representation of how market participants interact, and who holds which utility function (Cobb-Douglas), which notion of price gets determined by who, and who demand figures into this price-setting/supply creation. Then, each concept can be introduced as either a node or a directed edge (arrow) of a particular graphical model in a figure.}

\if 0
The canonical solution concept for stochastic economies is \mydef{sequential competitive equilibrium} (also called \mydef{Radner equilibrium}%
\footnote{Although \citet{arrow1964role, radner1972sequentualeqm} and \citet{diamond1967incompletege} had both considered economies with uncertainty, perhaps because \citet{radner1972sequentualeqm} had introduced a much broader model and proven existence of an equilibrium in his model, much of the progress in developing the theory of stochastic economies is attributed to him.}): a collection of per-state and per-time prices for commodities and Arrow securities, as well as per-state and per-time consumptions of commodities and portfolios of Arrow securities such that for all states and time-steps, 1) the aggregate demand for commodities is less than the aggregate supply at, 2) the \mydef{aggregate demand for Arrow securities}, i.e., the total number of Arrow securities bought, is equal to \amy{less than?} the \mydef{aggregate supply of Arrow securities}, i.e., total number of Arrow securities sold, and 3) Walras' law holds, i.e., the total value of the aggregate demand for commodities and Arrow securities is equal to the total value of the aggregate supply for commodities and Arrow securities.
\fi

% \deni{ADD THESE refs. These are not representative. they are micro papers, that have two-time period and extending AD to incomplete settings: 
% \cite{diamond1967incompletege,radner1974note, hart1975optimality}} \deni{NOTE: Radner introduced the first asset market model with the radner eqm as the solution.}

% \deni{This whole paragraph needs the citations of the works from the 60s and 70s. Maybe rephrase it within the Arrow-Debreu framework.}
%\textcolor{cyan}{Alec says: what do these theorems mean? Something about fair allocation of commodities?}


\paragraph{Computation of competitive equilibrium}
The study of the computational complexity of competitive equilibria was initiated by \citet{devanur2002market}, who provided a polynomial-time method for computing competitive equilibrium in a special case of the Arrow-Debreu (exchange) market model, namely Fisher markets, when buyers utilities are linear.
\citet{jain2005market} subsequently showed that a large class of Fisher markets with homogeneous utility functions could be solved in polynomial-time using interior point methods.
\citet{gao2020polygm} studied an alternative family of first-order methods for solving Fisher markets, assuming linear, quasilinear, and Leontief utilities, as such methods can be more efficient when markets are large. 
More recently, \citet{goktas2023tatonn} showed that t\^atonnement converges to competitive equilibrium in homothetic Fisher markets, assuming bounded elasticity of Hicksian demand.

Devising algorithms for the computation of competitive equilibrium in general Arrow-Debreu markets is still an active area of research.
While the computation of competitive equilibrium is PPAD-hard in general \cite{chen2006settling, daskalakis2009complexity}, the computation of competitive equilibrium in Arrow-Debreu markets with Leontief buyers is equivalent to the computation of Nash equilibrium in bimatrix games \cite{codenotti2006leontief, deng2008computation}, and hence PPAD-hard as well, there exist polynomial-time algorithms to compute competitive equilibrium in special cases of Arrow-Debreu markets, including markets whose excess demand satisfies the weak gross substitutes condition \cite{codenotti2005market, bei2015tatonnement} and Arrow-Debreu markets with buyers whose utilities are linear \cite{garg2004auction, branzei2021proportional} or satisfy constant elasticity of substitution, which gives rise to weak gross substitute demands \cite{branzei2021proportional}.

%\textcolor{cyan}{Alec says: why is the area important, and what is the nature of the impossibility results? Are the structural approximations people consider reasonable/descriptive to problems in practice?}


\paragraph{Solution methods in macroeconomics.}

As stochastic economies can be analytically intractable to solve without restrictive assumptions, such as homogeneous consumers (e.g., representative agent new Keynesian models  models, for a survey, see \citet{sargent2000recursive}), researchers have attempted to solve them via dynamic programming.
These methods often discretize the continuous state and action spaces, and then apply variants of value and policy iteration \cite{stokey1989recursive, sargent2000recursive, auclert2021using}. 
Unfortunately, this approach is unwieldy when applied to incomplete markets with multiple commodities and/or heterogeneous consumers \cite{fernandez1016solve}.
As a result, many of these methods lack optimality guarantees, and thus might not produce correct solutions, which may lead to drastically different policy recommendations, as inaccurate solutions to stochastic economies have been known to cause spurious welfare reversal \cite{kim2003spurious}.
Perhaps even more importantly, while static markets afford efficient, i.e., polynomial-time, algorithms for computing competitive equilibrium under suitable assumption (see, for instance \citet{jain2005market} or \citet{goktas2023tatonn} for a more recent survey), to the best of our knowledge, there is no known class of stochastic economies (excluding the special case of static economies) for which the computation of a sequential or recursive competitive equilibrium is polynomial-time. 
% in theory, and models that can be solved with heuristic methods do not scale to more expressive market models
Yet the macroeconomics literature speaks to the need for efficient methods to solve these models, or at least better understand the trade-offs between the speed and accuracy of proposed solution techniques \cite{fernandez1016solve}.

We describe only a few of the most influential computational approaches to solving stochastic economies in macroeconomics, and refer the reader to \citet{fernandez1016solve} for a detailed survey.
\citeauthor{durbin2012time} \citeyear{durbin2012time} developed an extended path algorithm.
The idea was to solve, for a terminal date sufficiently far into the future, the path of endogenous variables using a shooting algorithm. 
% \amy{a shooting algorithm?} 
Recently, \citeauthor{maliar2015tractable} (\citeyear{maliar2015tractable}) extended this idea, developing the extended function path (EFP) algorithm, applicable to models that do not admit stationary Markov equilibria.
\citeauthor{kydland1982time} (\citeyear{kydland1982time}) exploit the fact that their model admits a Pareto-optimal recursive equilibrium, and thus they solve the social planner's problem, instead of solving for an equilibrium.
To do so, they rely on a linear quadratic approximation, and exploit the fast algorithms known to solve that class of optimization problems. 
\citeauthor{king2002production} (\citeyear{king2002production}) (in the widely disseminated technical appendix, not published until 2002), building on \citeauthor{blanchard1980solution} (\citeyear{blanchard1980solution})'s approach, linearized the equilibrium conditions of their model (optimality conditions, market clearing conditions, etc.), and solved the resulting system of stochastic linear difference equations.
More recently, a growing literature has been applying deep learning methods in attempt to stochastic economies (see, for instance, \citet{curry2023learning, han2021deepham, childers2022differentiable}).
%
There also exists a large literature in macroeconomics on solution methods in continuous rather than discrete time, which is out of the scope of this paper.
We refer the interested reader to \citet{parra2015solution}.
