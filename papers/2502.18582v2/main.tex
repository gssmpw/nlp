%--------------------
% Packages
% -------------------
\documentclass[11pt]{article}

\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{booktabs} % For formal tables

\usepackage[vlined,ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}

\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}
\IncMargin{-\parindent}


\usepackage{xcolor}         % colors
\usepackage{hyperref}

\newcommand{\declarecolor}[2]{\definecolor{#1}{RGB}{#2}\expandafter\newcommand\csname #1\endcsname[1]{\textcolor{#1}{##1}}}
\declarecolor{White}{255, 255, 255}
\declarecolor{Black}{0, 0, 0}
\declarecolor{Maroon}{128, 0, 0}
\declarecolor{Coral}{255, 127, 80}
\declarecolor{Red}{182, 21, 21}
\declarecolor{LimeGreen}{50, 205, 50}
\declarecolor{DarkGreen}{0, 80, 0}
\declarecolor{Purple}{146, 42, 158}
\declarecolor{Navy}{0, 0, 128}
\declarecolor{LightBlue}{84, 101, 202}
\definecolor{mydarkblue}{rgb}{0,0.08,0.45}
\hypersetup{ %
    pdftitle={},
    pdfkeywords={},
    pdfborder=0 0 0,
    pdfpagemode=UseNone,
    colorlinks=true,
    linkcolor=Navy,
    citecolor=DarkGreen,
    filecolor=Purple,
    urlcolor=Purple,
}


\usepackage{fullpage}

%\usepackage{gentium}
% \usepackage{mathptmx} % Use Times Font
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{thm-restate}
% \usepackage{amssymb}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows, positioning}

\usepackage{multirow}

%\usepackage{complexity}

\usepackage{nicefrac}

% \usepackage[swedish]{babel} % Swedish translations
\usepackage{enumitem} % Includes lists

\frenchspacing % No double spacing between sentences
% \linespread{1.2} % Set linespace
% \usepackage[a4paper, lmargin=0.1666\paperwidth, rmargin=0.1666\paperwidth, tmargin=0.1111\paperheight, bmargin=0.1111\paperheight]{geometry} %margins
% \usepackage{parskip}

% \makeatletter
% \def\thm@space@setup{%
%   \thm@preskip=\parskip \thm@postskip=0pt
% }
% \makeatother

\usepackage[all]{nowidow} % Tries to remove widows

\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template

\usepackage[numbers]{natbib}
\bibliographystyle{plainnat}

\input{commands}

\usepackage[capitalize,noabbrev,nameinlink]{cleveref}

\usepackage{MnSymbol}

\renewcommand\vec\bm

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{example}[theorem]{Example}
% \theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage{autonum}

\newcommand{\bhz}[1]{{ {\color{magenta}{[BZ:~#1]}}}}
\newcommand{\et}[1]{{ {\color{olive}{[ET:~#1]}}}}
\newcommand{\emin}[1]{{ {\color{orange}{[EB:~#1]}}}}
\newcommand{\ioannis}[1]{{ {\color{blue}{[IA:~#1]}}}}
\newcommand{\gabri}[1]{{ {\color{red}{[GF:~#1]}}}}

\usepackage{authblk}

\title{Learning and Computation of $\Phi$-Equilibria \\at the Frontier of Tractability}

\author[1]{Brian Hu Zhang\thanks{Equal contribution.}}
\author[1]{Ioannis Anagnostides$^*$}
\author[1,2]{Emanuel Tewolde}
\author[1,2]{Ratip Emin Berker}
\author[3]{Gabriele Farina}
\author[1,2,4]{Vincent Conitzer}
\author[1,5]{Tuomas Sandholm}
\renewcommand\Affilfont{\small}
\affil[1]{Carnegie Mellon University}
\affil[2]{Foundations of Cooperative AI Lab (FOCAL)}
\affil[3]{Massachusetts Institute of Technology}
\affil[4]{University of Oxford}
\affil[5]{Additional affiliations: Strategy Robot, Inc., Strategic Machine, Inc., Optimized Markets, Inc.}
\affil[ ]{}
\affil[ ]{\texttt{\{bhzhang,ianagnos,etewolde,rberker,conitzer,sandholm\}}\texttt{@cs.cmu.edu}, \texttt{gfarina}\texttt{@mit.edu}}

\begin{document} 

\maketitle

\pagenumbering{gobble}

\begin{abstract}
\emph{$\Phi$-equilibria}---and the associated notion of \emph{$\Phi$-regret}---are a powerful and flexible framework at the heart of online learning and game theory, whereby enriching the set of deviations $\Phi$ begets stronger notions of rationality. Recently, Daskalakis, Farina, Fishelson, Pipis, and Schneider (STOC '24)---abbreviated as DFFPS---settled the existence of efficient algorithms when $\Phi$ contains only linear maps under a general, $d$-dimensional convex constraint set $\mathcal{X}$. In this paper, we significantly extend their work by resolving the case where $\Phi$ is $k$-dimensional; degree-$\ell$ polynomials constitute a canonical such example with $k = d^{O(\ell)}$. In particular, positing only oracle access to $\cX$, we obtain two main positive results:
\begin{itemize}
    \item a $\text{poly}(n, d, k, \text{log}(1/\epsilon))$-time algorithm for computing $\epsilon$-approximate $\Phi$-equilibria in $n$-player multilinear games, and
    \item an efficient online algorithm that incurs  average $\Phi$-regret at most $\epsilon$ using $\text{poly}(d, k)/\epsilon^2$ rounds.
\end{itemize}
We also show nearly matching---up to constant factors in the exponents---lower bounds parameterized by $k$ in the online learning setting, thereby obtaining for the first time a family of deviations that captures the 
learnability of $\Phi$-regret.

From a technical standpoint, we extend the framework of DFFPS from linear maps to the more challenging case of maps with polynomial dimension. At the heart of our approach is a polynomial-time algorithm for computing an \emph{expected fixed point} of any $\phi: \cX \to \cX$---that is, a distribution $\mu \in \Delta(\cX)$ such that $\E_{\vec{x} \sim \mu}[ \phi(\vx) - \vx ] \approx 0$---based on the seminal \emph{ellipsoid against hope (EAH)} algorithm of Papadimitriou and Roughgarden (JACM '08). In particular, our algorithm for computing $\Phi$-equilibria is based on executing EAH in a nested fashion---each step of EAH itself being implemented by invoking a separate call to EAH.
\end{abstract}

\clearpage

\tableofcontents

\clearpage

\pagenumbering{arabic}

\input{text/intro}
\input{text/prelim}
\input{text/deviations}
\input{text/semi_separation}
\input{text/poly-EAH}
\input{text/regret_min}
\input{text/conclusion}

\section*{Acknowledgments}
T.S. is supported by the Vannevar Bush Faculty Fellowship ONR N00014-23-1-2876, National Science Foundation grants RI-2312342 and RI-1901403, ARO award W911NF2210266, and NIH award A240108S001. B.H.Z. is supported 
by the CMU Computer Science Department Hans Berliner
PhD Student Fellowship. E.T, R.E.B., and V.C. thank the Cooperative AI Foundation, Polaris Ventures (formerly the Center for
Emerging Risk Research) and Jaan Tallinnâ€™s donor-advised fund at Founders Pledge for financial
support. E.T. and R.E.B. are also supported in part by the Cooperative AI PhD Fellowship. G.F is supported by the National Science Foundation grant CCF-2443068. We are indebted to Constantinos Daskalakis and Noah Golowich for many insightful discussions concerning the complexity of computing expected fixed points.

\bibliography{dairefs}

\clearpage
\appendix

\input{text/appendix_isotropic}
\input{text/appendix_wellbounded}
\input{text/appendix_aux}

\end{document}
