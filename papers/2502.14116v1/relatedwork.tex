\section{Related Works}
\label{sec:background} 

% This section presents essential background information on hardware Trojan attacks, along with strategies for countermeasuring such attacks.

% What's HT, detection, detection using ML 
A hardware Trojan (HT) is a malicious alteration or addition to a hardware design during its creation or assembly. These Trojans compromise the hardware by creating vulnerabilities or unintended functions, ranging from small circuits leaking data to system-disrupting modifications. Their stealth and dormancy make detection and mitigation difficult. 
% Detecting hardware Trojans involves identifying deviations from expected behavior or structural anomalies within hardware designs. Traditional hardware Trojan detection methods include functional testing, side-channel analysis, and golden model comparison. Functional testing identifies unintended behavior, side-channel analysis examines anomalies in physical parameters like power and timing, and golden model comparison validates designs against trusted references. These methods face challenges with scalability, data dependency, and detecting advanced Trojans in complex circuits, highlighting the need for more advanced, data-driven techniques.
% In recent years, machine learning (ML) has proven to be a potent method for detecting hardware Trojans. Using data-driven algorithms, ML models can identify patterns and abnormalities from training datasets, facilitating automated, scalable, and precise detection. Graph-based methods, such as Graph Neural Networks (GNNs), have gained particular attention because of their ability to model hardware structures as graphs, capturing complex interdependencies within circuits. These ML approaches offer significant advancements in Trojan detection by addressing limitations of scalability, adaptability, and golden-model dependency.
Detecting hardware Trojans (HTs) remains a crucial research focus, prompting the development of various frameworks and methods to tackle this issue. In this section, we examine significant progress made in the domain, particularly emphasizing machine learning and graph-based approaches, and discuss their advantages and drawbacks. 

% Machine Learning-Based Detection Frameworks
% The authors in~\cite{gaikwad2023hardware} present VIPR, a novel machine learning-based framework to verify the trust of third-party hardware IPs, eliminating the need for golden models. The framework employs pseudo-self-referencing training and post-processing algorithms to enhance hardware Trojan detection accuracy and reduce false positives. However, its dependency on synthetic Trojan insertion and feature selection limits its applicability to real-world designs with diverse Trojan structures. The authors in~\cite{li2020xgboost} propose a hybrid detection framework that uses XGBoost, combining static and dynamic analysis to improve the detection accuracy at the gate level. While effective, the framework's reliance on labeled datasets and its computational complexity hinder its scalability and generalization to diverse hardware designs.


Various frameworks that leverage machine learning have been developed to detect hardware Trojans, each offering its advantages and drawbacks. VIPR \cite{gaikwad2023hardware} improves detection accuracy without relying on golden models through pseudo-self-referencing and post-processing, yet it is limited by its dependence on synthetic Trojans and feature selection. A hybrid XGBoost framework \cite{li2020xgboost} integrates static and dynamic analysis but faces issues with scalability and generalizability due to computational demands and dataset reliance. Graph Neural Networks (GNNs) effectively represent circuits as graphs, facilitating accurate detection. TrojanSAINT \cite{lashen2023trojansaint} breaks circuits into subgraphs to extract features, although it experiences challenges with reduced accuracy and scalability. GNN4Gate \cite{cheng2022gnn4gate} facilitates automatic Trojan detection without the need for golden models; however, it necessitates the manual design of various features, which complicates its application to real-world scenarios. GNN4HT \cite{chen2024gnn4ht} expands detection to gate-level and RTL designs, but is hampered by high interclass similarity and limited generalization due to insufficient data set augmentation. FAST-GO \cite{imangholi2024fast} employs Graph Convolutional Networks (GCNs) enhanced with improved features and dynamic thresholds for scalable detection. R-HTDetector \cite{hasegawa2022r} boosts robustness through adversarial training. NHTD-GL \cite{hasegawa2023node} automates feature extraction to detect threats at the node level. These methods operate at the net level and encounter difficulties with imbalanced datasets and feature initialization, while also lacking the ability to localize Trojans. 

 % In \cite{gaikwad2023hardware}, VIPR is introduced as a machine learning framework for verifying third-party hardware IPs without golden models, using pseudo-self-referencing and post-processing to improve Trojan detection, though limited by synthetic Trojan reliance and feature selection. Similarly, \cite{li2020xgboost} presents a hybrid XGBoost-based framework for gate-level detection, combining static and dynamic analysis, but faces challenges in scalability and generalization due to dataset dependency and computational complexity.

% Authors in~\cite{gaikwad2023hardware} presents a machine-learning-based framework for trust verification of third-party hardware IPs, eliminating the need for golden models. It leverages pseudo-self-referencing training and post-processing algorithms to enhance hardware Trojan detection accuracy and reduce false positives. The framework's dependency on synthetic Trojan insertion and feature selection limits its applicability to real-world designs with diverse Trojan structures.
% Authors in~\cite{li2020xgboost}, proposes a hybrid detection framework that uses XGBoost to enhance the accuracy of gate-level hardware Trojan detection by combining static and dynamic analysis. However, its reliance on labeled datasets and computational complexity limits its scalability and generalization to diverse hardware designs.

% Graph Neural Network (GNN)-Based Approaches
% Graph neural networks (GNNs) have emerged as a promising tool for hardware Trojan detection, enabling the modeling of circuit structures as graphs for more accurate analysis. The TrojanSAINT framework employs GNNs in gate-level netlists~\cite{lashen2023trojansaint}. It simplifies large circuits into smaller subgraphs using GraphSAINT~\cite{zeng2019graphsaint} and extracts features such as gate types and input/output distances. TrojanSAINT achieves a high true positive rate, but misclassifies many normal nodes, reducing recognition accuracy. The authors in~\cite{cheng2022gnn4gate} propose GNN4Gate, a bidirectional GNN framework to model circuit graphs and integrate signal features, achieving automated, golden-free detection and localization of Trojan gates. The authors in ~\cite{chen2024gnn4ht} introduce GNN4HT, a two-stage GNN framework to detect hardware Trojans and classify their functionalities. Both works have average true positive and true negative rates that are acceptable but fall short of state-of-the-art performance, limiting their effectiveness in diverse Trojan detection scenarios. 

% Graph neural networks (GNNs) are effective for hardware Trojan detection by modeling circuits as graphs. TrojanSAINT~\cite{lashen2023trojansaint} leverages GNNs to analyze gate-level netlists, using subgraph sampling and feature extraction, but faces scalability issues and reduced accuracy from graph simplifications. GNN4Gate employs bidirectional GNNs for automated, golden-free Trojan detection, but reliance on extensive training data and local feature characteristics limits its scalability. The authors in~\cite{chen2024gnn4ht} present GNN4HT, a two-stage GNN framework for gate-level and RTL designs that faces challenges with high inter-class similarity and limited data due to its reliance on dataset augmentation. 

% TrojanSAINT is a hardware Trojan detection framework using Graph Neural Networks (GNNs) on gate-level netlists. It simplifies large circuits into smaller subgraphs with GraphSAINT and extracts features such as gate types and input/output distances. To address dataset imbalance, it adjusts classification thresholds for better detection. However, despite threshold tuning, it can struggle with extreme imbalances, and simplifying netlists into undirected, unweighted graphs can reduce detection accuracy. Scalability is also a challenge because of the computational expense of handling very large circuits. Furthermore, using the same benchmark for validation and testing can lead to biased or overly optimistic results.
% \cite{cheng2022gnn4gate} introduces a new method for detecting gate-level hardware Trojans using a bidirectional GNN framework. This approach, which models circuit graphs and integrates signal features, allows for accurate, automated, golden-free detection and localization of Trojan gates. However, its reliance on extensive training data and local feature focus limits its scalability and adaptability to incomplete netlists or varied Trojan designs, challenging its broader use in complex hardware.
% A study in~\cite{chen2024gnn4ht} presents a two-stage Graph Neural Network framework for detecting hardware Trojans and classifying functionalities. The first stage uses graph modeling for precise localization, while the second applies data augmentation and classification to identify Trojan functionalities, achieving better accuracy at gate-level and RTL designs. However, its reliance on dataset augmentation may hinder performance with limited or diverse data, and it struggles with high inter-class similarity or underrepresented functionalities.     
\input{Table/Data_Splitting}

% Further improvements in Graph-Based Methods
% Recent studies have further refined graph-based approaches to enhance detection capabilities. The~\cite{imangholi2024fast} present FAST-GO, a graph-convolutional network-based framework that combines optimized feature selection and dynamic thresholding for efficient and scalable detection. However, its dependency on imbalanced datasets and the lack of output post-processing limit its adaptability to varied benchmarks and complex Trojan designs. The R-HTDetector~\cite{hasegawa2022r} work presents a resilient detection framework using adversarial training to counter gate modification attacks. Although robust against specific attack scenarios, its dependence on adversarial training metrics restricts its flexibility for diverse architectures and novel attack vectors. In~\cite{hasegawa2023node}, the authors introduce NHTD-GL, a graph-based learning framework for the node-level detection of hardware Trojans. By automating the extraction of structural and functional features, the framework achieves scalability and precision. However, its reliance on precise initial feature representation and imbalanced datasets may impact its adaptability in diverse or real-world applications.

% Recent studies enhance graph-based hardware Trojan detection. FAST-GO~\cite{imangholi2024fast} leverages GCNs with refined feature selection and dynamic thresholds for scalable detection but lacks adaptability due to imbalanced datasets and absence of post-processing. R-HTDetector uses adversarial training for robustness against gate modification attacks, but it does not offer native hardware Trojan localization~\cite{hasegawa2022r}. NHTD-GL automates feature extraction for node-level detection but faces challenges from imbalanced datasets and feature initialization, affecting real-world use \cite{hasegawa2023node}.

% In ~\cite{imangholi2024fast} a graph-convolutional network-based framework is presented in~\cite{imangholi2024fast} for detecting hardware Trojans in gate-level netlists, combining high precision, scalability, and efficiency through optimized feature selection and dynamic thresholding. However, its dependence on imbalanced datasets and lack of output post-processing limit its adaptability to varied benchmarks and complex Trojan designs.
% The authors in~\cite{hasegawa2022r} present "R-HTDetector," a resilient hardware Trojan detection framework that utilizes adversarial training to boost resistance to gate modification attacks. The approach generates adversarial examples in the training phase, which strengthens the model's robustness while ensuring high detection accuracy on various circuit benchmarks. Nonetheless, its dependence on particular adversarial training metrics and specific scenarios might restrict its flexibility when dealing with highly varied circuit architectures and novel attack vectors.
% The study detailed in~\cite{hasegawa2023node} introduces "NHTD-GL," a graph-based learning framework designed for accurate node-level detection of hardware Trojans in gate-level netlists. This framework leverages sophisticated graph modeling and domain expertise to automate the extraction of both structural and functional features, providing a scalable and precise method for identifying malicious nodes without requiring extensive manual feature engineering. However, its reliance on precise initial feature representation and imbalanced datasets could restrict its scalability and resilience in diverse or real-world applications.

% \subsection{GNN: Graph Neural Network}

%Pravin
% Graph Neural Networks (GNNs) efficiently represent a graph's structural characteristics by enabling the exchange of information among its nodes. A directed graph \( G(V, E) \) consists of a set of nodes \( V \) and edges \( E \), where each node \( v \in V \) is associated with a feature vector \( f_v \). The initial embedding, also known as the feature vector, encapsulates the distinctive attributes of the node. Graph Neural Networks (GNNs) function by collecting data from the local neighborhood \( N(v) \) of a node, so that each node acquires embeddings from its adjacent nodes through the connecting edges. The update function, which can be learned, merges the node's present embedding with the compiled embeddings of its neighbors to calculate a new embedding. Through this iterative process, nodes gather information about both their characteristics and those of neighboring nodes. At the level of graphs, representations are generally formed by combining, averaging, or using a max operation across all node embeddings. \textcolor{blue}{Need to add info related what is used in methodology at high level. Like a high level intro to GNN + GNN intro diagram if you want it}

% Different DFS techniques have been proposed over the years for thwarting diverse IC and supply chain attacks. However, to the best of our knowledge, there does not exist an explainable Artificial Intelligence (XAI) framework that can automatically search the DFS solution space towards finding the optimal solution and at the same time provide human-understandable reasoning behind the said solution choice. 

%Tanzim
% Graph Neural Networks (GNNs) have emerged as powerful tools for processing graph-structured data because they effectively capture complex relationships through message passing mechanisms \cite{wu2020comprehensive}. This capability makes GNNs particularly suitable for tasks where understanding the topology and connectivity patterns is essential, such as hardware Trojan detection, where structural relationships between components can indicate malicious modifications. In our work, we employ Graph Attention Networks (GATs) \cite{velickovic2017graph}, which enhance standard GNNs by incorporating attention mechanisms to assign different weights to neighboring nodes.