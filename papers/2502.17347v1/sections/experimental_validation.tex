% Sensorization
To demonstrate the consistency of the proposed methodology, we conducted an experimental validation using the H-Support prototype (Fig. \ref{fig:h_support_prototype}).
% % H-Support Prototype
% \begin{figure}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/experiments/hsupport_real.svg}
%     \caption{The H-Support prototype is a cylindrical robot with 3 longitudinal pneumatic chambers and 4 tendons arranged with a helicoidal path. The VICON system sensorizes the \ac{CSR}, measuring the positions of the cross-sections each $\lambda_s = \SI{0.032}{\meter}$.}
%     \label{fig:h_support_prototype}
% \end{figure}
% H-Support Prototype
\begin{figure}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/experiments/hsupport_real.pdf}
    \caption{The H-Support prototype is a cylindrical robot with 3 longitudinal pneumatic chambers and 4 tendons arranged with a helicoidal path. The VICON system sensorizes the \ac{CSR}, measuring the positions of the cross-sections each $\lambda_s = \SI{0.032}{\meter}$.}
    \label{fig:h_support_prototype}
\end{figure}
% Actuation
This robot is actuated by three longitudinal pneumatic-driven actuators and four helicoidal tendon-driven actuators. Due to the physical constraints of the actuation sources, the input signals are bounded by \(\bm{\tau}_{1:3} \geq \bm{0}_3\) and \(\bm{\tau}_{4:7} \leq \bm{0}_4\). 
To enforce these constraints, we applied the absolute value operation to the standard signals, yielding the modified input 
$\bm{\tau} = \begin{bmatrix} |\bm{\tau}_{1:3}^{\top}| &  -|\bm{\tau}_{4:7}^{\top}|\end{bmatrix}^{\top}$.
% Justifying the application of absolute value
This modification slightly shifts the spectrum of standard signals, mainly affecting the average value. Applying the absolute value doubles the frequency rate for the chirp signal while preserving the spectrum's characteristics.

Concerning sensing, the H-Support is equipped with a Motion Capture system (VICON), which measures the roto-translation of sensorized cross-sections. 
Markers are placed at equal intervals of $\lambda_s = \SI{0.032}{\meter}$ along the robot's length, providing a sampling wavenumber of $\nu_s = \SI{31.25}{\meter^{-1}}$. Based on these measurements, the strain field samples can be calculated as:  
\begin{equation} \label{eq:vicon2strain}
    \bm{\xi}(n \lambda_s) = \frac{1}{\lambda_s}
    \left(\log_{SE(3)}\left(\bm{g}^{-1}\left(n \lambda_s\right) \bm{g}\left((n + 1) \lambda_s\right)\right)\right)^{\vee} ,
\end{equation}
where $\log_{SE(3)}(\cdot)$ represents the logarithmic map in the $SE(3)$ group \eqref{eq:logSE3_definition}. 
The relation \eqref{eq:vicon2strain} is derived by inverting the forward kinematics of a generic \ac{GVS} model \cite{mathew2024reduced}, considering a second-order Zanna collocation \cite{zanna1999collocation}.

Concerning time samples, the VICON system provides the measures at $f_s = \SI{100}{\hertz}$.

\subsection{Spectrum Analysis}
From the samples $\bm{\xi}\left(n \lambda_s, \, m T_s\right)$, it is possible to compute the \ac{STFT} through the \ac{FFT} algorithm. Fig. \ref{fig:stft_exp} shows the spectra of the experimental data, where zero-padding was applied to increase the resolution of the wavenumbers. 
% X(\cdot, j \omega)
\subsubsection{Time spectrum of the Spatial Harmonics}
%% Angular Strain Modes
% Torsion
The torsion spectrum reveals differences when compared to the \ac{STFT} obtained through simulation. The constant component at $\nu = \SI{0}{\meter^{-1}}$ is significantly less pronounced than the others, in contrast to the strain analysis presented in \eqref{eq:implicit_strain}. This can be attributed to the friction between the cables and the rod, which asymmetrically distributes the torsion along its length. At higher spatial frequencies, the torsion exhibits anti-resonance peaks accompanied by rapid phase transitions.

Specifically, the harmonics at $\nu = 7.8125, \, \SI{11.7188}{\meter^{-1}}$ demonstrate anti-resonance at $\SI{0.641}{\hertz}$, while the spatial component at $\nu = \SI{15.625}{\meter^{-1}}$ shows anti-resonance at $\SI{0.798}{\hertz}$. This shift in the frequency of peaks across spatial harmonics, also observed in the case of the Gaussian basis function, can again be attributed to friction between the robot and the cables. 
% Therefore, common friction models, such as the Capstan model \cite{alkayas2024soft, rone2013continuum}, typically include exponential terms.

% Bending y
For $\kappa_y$, the spatial harmonics $\nu = 0, \, 3.9062, \, \SI{7.8125}{\meter^{-1}}$ exhibit similar profiles. The magnitude gradually decreases until reaching anti-resonance peaks in the range of $0.797$ to $\SI{0.982}{\hertz}$. In the same range, the phase diagram shows a rapid increase in phase.
Similar to the torsion case, the peaks are slightly shifted between spatial components. At higher harmonics, a rapid decrease in magnitude is observed around $\SI{0.2991}{\hertz}$.

% Bending z
The bending component $\kappa_z$ exhibits a sequence of resonance and anti-resonance peaks, characterized by rapid phase changes. The harmonics at $\nu = 0, \, \SI{3.9062}{\meter^{-1}}$ initially display an anti-resonance peak at $\SI{0.3703}{\hertz}$, followed by a rapid phase decrease. Subsequently, a resonance peak occurs at $\SI{0.741}{\hertz}$, accompanied by another rapid phase transition.

% Linear Strain Modes

% % Experimental STFT
% \begin{figure*}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/experiments/stft_exp.svg}
%     \caption{The \ac{STFT} of experimental data from the H-Support prototype. The magnitude values are normalized to $|\Xi_i(j 0, \, j 0)|$. Moreover, zero-padding is applied to increase the resolution of the spatial frequencies.}
%     \label{fig:stft_exp}
% \end{figure*}
% Experimental STFT
\begin{figure*}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/experiments/stft_exp.pdf}
    \caption{The \ac{STFT} of experimental data from the H-Support prototype. The magnitude values are normalized to $|\Xi_i(j 0, \, j 0)|$. Moreover, zero-padding is applied to increase the resolution of the spatial frequencies.}
    \label{fig:stft_exp}
\end{figure*}
% % Space-Time fitting
% \begin{figure*}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/experiments/st_fitting.svg}
%     \caption{Comparison between the reconstructed strain through \ac{BPD} and the experimental strain. In grey the experimental strain samples.}
%     \label{fig:bpd_st}
% \end{figure*}
% Space-Time fitting
\begin{figure*}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/experiments/st_fitting.pdf}
    \caption{Comparison between the reconstructed strain through \ac{BPD} and the experimental strain. In grey the experimental strain samples.}
    \label{fig:bpd_st}
\end{figure*}

% X(jk, \cdot)
\subsubsection{Spatial spectrum of the Time Harmonics}
The curves \(\bm{\Xi}(jk, \, \cdot)\) provide insights into the spatial spectrum when the \ac{CSR} is subjected to a specific time-frequency input. A common feature across all strain modes is the prominence of the constant time-harmonic (i.e., \(f = \SI{0}{\hertz}\)), which arises from the mechanical nature of the \acp{CSR}. Below, we discuss the spectra of the different strain modes in detail.

% Torsion
For torsion ($\kappa_x$), the magnitude increases slightly up to $\SI{5}{\meter^{-1}}$ at the time harmonics $f = 0, \, 12.4929, \, \SI{25}{\hertz}$. Beyond that, the magnitude decreases until $\nu = \SI{10}{\meter^{-1}}$, where an anti-resonance appears in space. The higher harmonics exhibit a smoother spectrum, both in terms of magnitude and phase.

% Bending
In contrast, the magnitude of the constant component ($f = \SI{0}{\hertz}$) for $\kappa_y$ and $\kappa_z$ decreases smoothly, reaching values of $\SI{-0.5}{\decibel}$ and $\SI{-0.25}{\decibel}$ at $\nu = \SI{0}{\meter^{-1}}$, respectively. After this point, the negative slope of the magnitude increases. The $\kappa_z$ mode shows an anti-resonance peak in space at $\nu = \SI{13.4277}{\meter^{-1}}$, which is accompanied by a rapid shift in phase. Higher time harmonics display similar behavior, with anti-resonance peaks occurring at different wavenumbers.

% Linear strain modes
The linear strain modes show distinct spectra. The constant component (\(f = \SI{0}{\hertz}\)) increases the magnitude, highlighting predominant spatial harmonics. Specifically, the stretch ($\sigma_x$) shows the highest magnitude ($\SI{9}{\decibel}$) at $\nu = \SI{3.906}{\meter^{-1}}$. The shear along the $y$-axis ($\sigma_y$) exhibits the highest magnitude at $\nu = \SI{6.5918}{\meter^{-1}}$ with a value of $\SI{20.4274}{\decibel}$. In contrast, the shear along the $z$-axis shows a negative slope in magnitude, similar to the spectrum of bending around the $y$-axis.


\subsection{Strain Fitting}
 From the experimental samples, the strain field can be reconstructed using the \ac{BPD} algorithm. The signal dictionary $\bm{B}_{\bm{q}}$ is composed of the polynomial and trigonometric bases.
 Fig. \ref{fig:bpd_st} shows the result of the fitting, both in space and in time. The \ac{BPD} reduces the noise from the strain samples, allowing an accurate representation, and leveraging the signal's sparsity. 
 The displayed results are obtained for the sparsity vector $\bm{\gamma} = [0.5, \,  0.5, \,  0.5, \, 0.07, \,  0.05, \,  0.05]^{\top}$.

The first row of Fig. \ref{fig:bpd_q} shows the evolution of the coefficients $\bm{q}$ over time, providing insight into the relevance of each basis. As detailed in Sec. \ref{spectrum_extraction:bpd}, the energy ratio for each basis is calculated and presented in the second row of Fig. \ref{fig:bpd_q}. The third row depicts the average truncation index over time, emphasizing the most significant bases. Lastly, the fourth row illustrates the total energy of the reconstructed signal over time.

%% Discussion %%
% Angular Strain Mode
The torsion exhibits a diverse combination of basis functions, including both polynomial and trigonometric components, consistent with the spectrum analysis.
For $\kappa_y$, the most dominant basis polynomial, specifically the constant and first-order terms. The second-order trigonometric basis ($\nu = \SI{2}{\meter^{-1}}$) plays a notable role, particularly in the first 10 seconds.
Regarding $\kappa_z$, the constant term and the first-order trigonometric basis are the most significant contributors.

% Linear Strain Mode
The trigonometric bases are mostly used to reconstruct the linear strain modes. 
For the stretch component $\sigma_x$, the constant term is zero, with the first-order trigonometric basis dominating the reconstruction. The shear components $\sigma_y$ and $\sigma_z$ are accurately approximated by first- and second-order trigonometric terms. Unlike the other linear modes, $\sigma_z$ exhibits a significant constant component.
These results align with the previously discussed spectra, where the curves $\bm{\Xi}(jk, \, \cdot)$ exhibit an increase in magnitude corresponding to these wavenumbers.

% % q of BPD
% \begin{figure*}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/experiments/bpdn.svg}
%     \caption{Application of \ac{BPD} to the experimental data. The coefficients $\bm{q}(t)$ are displayed over time in the first row. The energy contribution of each basis over time is shown in the second row, and the average energy contribution value is shown in the third. The total energy of the reconstructed strain is shown in the final row.}
%     \label{fig:bpd_q}
% \end{figure*}
% q of BPD
\begin{figure*}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/experiments/bpdn.pdf}
    \caption{Application of \ac{BPD} to the experimental data. The coefficients $\bm{q}(t)$ are displayed over time in the first row. The energy contribution of each basis over time is shown in the second row, and the average energy contribution value is shown in the third. The total energy of the reconstructed strain is shown in the final row.}
    \label{fig:bpd_q}
\end{figure*}

\subsection{Comparison between the measured and reconstructed Backbone}
To evaluate the accuracy of the proposed method, we compare the reconstructed backbone with experimental data obtained from the VICON system. Figure \ref{fig:bpd_se3} shows the reconstructed backbone without truncation (colored) alongside the corresponding experimental pose (gray) for the sensorized cross-sections at eight distinct time instants.

Below each time instant, the orientation and position errors are reported for three truncation thresholds—no truncation ($0\%$), $1\%$, and $5\%$—with all bases below the corresponding truncation index discarded.
The position error is defined as the Euclidean distance between the centers of the reconstructed and experimental cross-sections, while the orientation error is computed using the $\textnormal{dist}_{SO(3)}$ operator \eqref{eq:distso3_definition}. Without truncation, the maximum position error reaches $\SI{7.190}{m\meter}$ (i.e., $3.7448 \% L$), while the maximum orientation error is $6.284^{\circ}$.

Regardless of the truncation threshold, the errors exhibit an increasing trend, which can be attributed to the propagation of fitting errors in the forward kinematics. As these errors accumulate through the integration of the reconstructed strain field, the tip pose is the most affected, reflecting the cumulative effect of all preceding inaccuracies.

In terms of truncation, applying a $1\%$ threshold eliminates $11$ \ac{DoFs}, resulting in a maximum position error of $\SI{7.0872}{m\meter}$ and an orientation error of $6.484^{\circ}$. Increasing the truncation to $5\%$ reduces the model by $23$ \ac{DoFs}, but leading to a higher position error of $\SI{9.076}{m\meter}$ (i.e., $4.7271 \% L$) and a orientation error of $6.443^{\circ}$.

% % Fitting in SE(3)
% \begin{figure*}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/experiments/hsupport_fitted.svg}
%     \caption{Comparison between the experimental and reconstructed backbone using \ac{BPD}. The last row presents the position and orientation errors, which exhibit an increasing trend along the length of the rod. The errors are computed with the truncation index of $0\%$, $1\%$, and $5\%$.}
%     \label{fig:bpd_se3}
% \end{figure*}
% Fitting in SE(3)
\begin{figure*}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/experiments/hsupport_fitted.pdf}
    \caption{Comparison between the experimental and reconstructed backbone using \ac{BPD}. The last row presents the position and orientation errors, which exhibit an increasing trend along the length of the rod. The errors are computed with the truncation index of $0\%$, $1\%$, and $5\%$.}
    \label{fig:bpd_se3}
\end{figure*}
%
% \subsection{Parametric Identification}
% % Parameters
% \input{tables/exp_table}
% % Method and Results
% To compare the effectiveness of the \ac{BPD} algorithm on the dynamic model, we applied a parametric identification to fit the dynamic model that best matches the experimental data.
% Let the parameter vector be $\bm{\pi} = \left[\rho, \, E, \, \beta\right]^{\top} \in \mathbb{R}^3$. The best set of parameters is $\bm{\pi}^{*} = \underset{\bm{\pi}}{\arg \min} \left\{\frac{1}{M} \sum_m \textnormal{MSE}_{SE(3)}(m T_s)\right\}$, where
% \begin{equation} \label{eq:mse3_definition}
% \textnormal{MSE}_{SE(3)} = \frac{1}{N} \sum_n \textnormal{dist}^{2}_{SE(3)}\left(\bm{g}_{\textnormal{exp}}(n \lambda_s), \bm{g}_{\textnormal{sim}}(n \lambda_s)\right) \, .
% \end{equation}
% In \eqref{eq:mse3_definition}, $\bm{g}_{\textnormal{exp}}(n \lambda_s, \, m T_s) \in SE(3)$ is the measured pose of the $n$-th sensorized cross-section, while $\bm{g}_{\textnormal{sim}}(n \lambda_s, \, m T_s) \in SE(3)$ is the simulated correspondent. Finally, the $\textnormal{dist}_{SE(3)}$ operator evaluates the distance in the $SE(3)$ group and is defined in \eqref{eq:distse3_defintion}.