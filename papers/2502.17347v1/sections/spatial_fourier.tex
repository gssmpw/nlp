As seen in Sec. \ref{background:cosserat_rod_theory}, the backbone of a \ac{CSR} can be completely described by the strain field $\bm{\xi}: [0, \, L] \times [0, \, +\infty) \rightarrow \mathbb{R}^6$. The main idea of this work is to consider it as a signal in space and time, applying the \ac{FT} to analyze the robotâ€™s deformation.

% Domain Adaption
To apply it, we must adapt the strain field's domain. Hence, let us assume to extend the domain of $s$ extends to $\mathbb{R}$ and that $\bm{\xi}: \mathbb{R} \times [0, \, +\infty) \rightarrow \mathbb{R}^{6}$, where the strain field is null for all $s \notin [0, \, L]$. This assumption is equivalent to applying a spatial window over the interval $[0, \, L]$.

To formalize this, let $\bm{\Phi}(s): \mathbb{R} \rightarrow \mathbb{R}^6$ be a function such that $\bm{\xi}(s) = \bm{\Phi}(s) \, \forall s \in [0, \, L]$. 
The previous assumption is equivalent to stating that $\bm{\xi}(s, t) = \bm{\Phi}(s) \cdot \Pi_L(s)$, where
\begin{equation} \label{eq:length_space_window}
    \Pi_L(s) = \rect{\frac{s - L/2}{L}} \, ,
\end{equation}
is the window function in the range $[0, \, L]$ and $\rect{\cdot}$ is the rectangular function \cite[Ch. 4]{bracewell2007fourier}.
% % Curvature Example
% \begin{figure}
%     \centering
%     \includesvg[width=0.9\linewidth]{imgs/space_shift_example.svg}
%     \caption{Impact of the phase in a planar rod with a sinusoidal curvature function. Varying the phase, the deformation is distributed differently along the rod.}
%     \label{fig:space_shift_example}
% \end{figure}
% Curvature Example
\begin{figure}
    \centering
    \includegraphics[width=0.9\linewidth]{imgs/space_shift_example.pdf}
    \caption{Impact of the phase in a planar rod with a sinusoidal curvature function. Varying the phase, the deformation is distributed differently along the rod.}
    \label{fig:space_shift_example}
\end{figure}
%
\subsection{Continous \ac{SFT}} \label{spatial_ft:csft}
The Continous \ac{SFT} of the strain field $\bm{\xi}$ is defined as
\begin{equation} \label{eq:continous_spatial_fourier_transform}
    \bm{\Xi}\left(jk, \, t\right) = \fourier{\bm{\xi}(s, t)} = \int_{0}^{L} \bm{\xi}(s, \, t) \, e^{-jks} \, \textnormal{d} s \, ,
\end{equation}
where $k = 2 \pi \nu \in \mathbb{R}$ is the angular wavenumber, $\nu \in \mathbb{R}$ is the wavenumber (i.e., spatial frequency), and $j = \sqrt{-1}$ the imaginary unity. In this case, the signal $\bm{\xi}(s, t)$ is a signal limited in space ($s \in [0, L]$) and aperiodic. Hence, the spatial spectrum 
$\bm{\Xi}(j k, t)$ will be infinite, composed of all the spatial frequencies, as shown in Fig. \ref{fig:concept}(a). 
This consideration is coherent with the infinite \ac{DoFs} of a \ac{CSR}, considering the strain field generated by an infinite-dimension trigonometric functional basis.

% Magnitude and Phase of the Strain Field
Moreover, the \ac{SFT} of the strain field $\bm{\Xi}(jk) \in \mathbb{C}^{6}$ can be analyzed by examining its magnitude and phase. 
The magnitude $\abs{\bm{\Xi}(jk)}$ quantifies the extent of deformation of the slender body, whereas the phase $\angle\bm{\Xi}(jk)$ indicates how the deformation is distributed along the rod, impacting with the rod's shape.
Consider, for instance, a planar backbone characterized by a sinusoidal curvature $\kappa = \sin\left(\pi s + \phi \right) \in \mathbb{R}$.
As illustrated in Fig. \ref{fig:space_shift_example}, this sinusoidal curvature generates a backbone shape that changes as the phase $\phi$ varies. Although the magnitude of the curvature remains constant, the deformation is differently distributed along the rod, leading to variations in the overall shape of the backbone.

\subsection{Statics of a Cosserat Rod in the Spatial Frequency Domain}
We can exploit the properties of \ac{FT} \eqref{eq:fourier_definition}-\eqref{eq:fourier_conv} in the case of the Spatial Spectrum $\bm{\Xi}(jk)$, allowing us to rewrite \eqref{eq:crt_statics} in the spatial frequency domain, such as
\begin{equation} \label{eq:static_ft}
    jk \, \left(\bm{F}_i(jk) - \bm{F}_a(jk)\right) + \textnormal{ad}_{\bm{\Xi}}^{*} \ast \left(\bm{F}_i(jk) - \bm{F}_a(jk)\right) = \bm{0} \, ,
\end{equation}
where $\bm{F}_i(jk) = \fourier{\bm{\mathcal{F}}_i(s)}$, $\bm{F}_a(jk) = \fourier{\bm{\mathcal{F}}_a(s)}$, and $\ast$ is the convolution in the spatial frequency domain.

In the case of internal passive wrench $\bm{\mathcal{F}}_i(s)$, the \ac{FT} can be expressed as
\begin{equation} \label{eq:internal_passive_static_ft}
    \bm{F}_i(j k) = \bm{\Sigma}(jk) \ast \left(\bm{\Xi}(jk) - \bm{\Xi}^{*}(jk) \right) \, ,
\end{equation}
where $\bm{\Sigma}(jk) = \fourier{\bm{\Sigma}(s)}$ is the \ac{SFT} of the stiffness matrix. It is worth highlighting that the stiffness matrix $\bm{\Sigma}(s)$ acts as a convolutional filter applied to the strain field in the spatial frequency domain.

In the case of internal active wrench $\bm{\mathcal{F}}_a(s)$, the \ac{SFT} can be expressed as
\begin{equation}
    \bm{F}_a(j k) = \bm{B}_{\bm{\tau}}(\bm{\Xi}, jk) \, \bar{\bm{\tau}} \, ,
\end{equation}
where $\bm{B}_{\bm{\tau}}(\bm{\Xi}, jk) = \fourier{\bm{B}_{\bm{\tau}}(\bm{\xi}, s)}$ is the \ac{SFT} of the actuation matrix, and $\bar{\bm{\tau}} \in \mathbb{R}^{n_a}$ a generic constant input.

\subsection{Discrete \ac{SFT} and Sampled Strain Field}
For each time instant, let us assume to have $N$ samples of the strain field equally spaced along the rod $\bm{\xi}(n \lambda_s, t)$, where $n \in [0, N - 1]$, and $\lambda_s = L / N$ is the sampling wavelength. These samples can be directly measured using shape sensors \cite{floris2021fiber}, motion capture systems \cite{field2009motion}, or estimated using shape estimation algorithms (e.g., \cite{lilge2022continuum}).
%
In the discrete case, we can define Discrete \ac{SFT} of the strain field as
\begin{equation} \label{eq:discrete_spatial_fourier_transform}
    \bm{\Xi}(jk, t) = \sum_{n = 0}^{N - 1} \bm{\xi}(n \lambda_s, t) \, e^{-jk n \lambda_s} \, . 
\end{equation}
%
Moreover, the sampled signal $\bm{\xi}(n \lambda_s, t)$ in the spatial spectrum can be expressed as
\begin{equation} \label{eq:repetition_spectrum}
    \bm{\Xi}_{\textnormal{d}}(jk, t) = \frac{1}{\lambda_s} \sum_{n = - \infty}^{+ \infty} \, \bm{\Xi}\left(jk - j n k_s, \, t\right) \, ,
\end{equation}
where $k_s = \frac{2 \pi}{\lambda_s}$ denotes the sampling angular wavenumber. Coherently with time-varying signals, the spatial spectrum of the discretized strain field consists of an infinite series of replicas of the \ac{SFT}, each shifted by a multiple of $k_s$. Since the spatial spectrum of $\bm{\xi}$ is unlimited, the aliasing effect is inevitable, as illustrated in Fig. \ref{fig:concept}(b). 
 To address this, we can select the last most significant component $k_{\textnormal{max}} \in \mathbb{R}$ and apply the Nyquist-Shannon theorem \cite{shannon1949communication}, resulting in $k_s > 2 \, k_{\textnormal{max}}$.

In the context of modeling \acp{CSR}, it can be more meaningful to express the previous relation in terms of the wavelength, such as
\begin{equation} \label{eq:nyquist_wavelength}
    \lambda_{s} < \frac{\lambda_{\textnormal{max}}}{2} \rightarrow N > \frac{2}{\lambda_{\textnormal{max}}} L \, ,
\end{equation}
where $\lambda_{\textnormal{max}} = \frac{2 \pi}{k_{\textnormal{max}}}$. Eq. \eqref{eq:nyquist_wavelength} provides useful information about the minimum number of pieces a \ac{CSR}, assuming that most of the signal's energy is concentrated up to $k_{\textnormal{max}}$.
This result supports the intuitive and heuristic understanding that more segments are needed for longer rods, as $\lambda_s = L / N$.

\subsection{Energy-based Criterion for Truncation} \label{spatial_ft:truncation}
To determine $k_{\textnormal{max}}$, it is possible to compute the quantity of the signal energy contained up the component $k_{\textnormal{max}}$ and compare it to the total energy of the signal.
Recalling \eqref{eq:discrete_spatial_fourier_transform} and the Parseval identity \eqref{eq:fourier_parseval} in the discrete domain, the truncation index $E_{\textnormal{tr}, \xi_i}$ can be defined as
\begin{equation} \label{eq:discrete_truncation_criterion}
    E_{\textnormal{tr}, \xi_i}\left(k_{\textnormal{max}}\right) = \frac{N}{N_{\textnormal{max}}} \left(\frac{\sum_{n = 0}^{N_{\textnormal{max}} - 1} |\Xi_{i}(n)|^{2}}{\sum_{n = 0}^{N - 1} |\Xi_{i}(n)|^{2}}\right) \, ,
\end{equation}
where $N_{\textnormal{max}} < N$ is the number of the sample associated with the angular wavenumber $k_{\textnormal{max}}$. 
The truncation index is the ratio of the energy accumulated up to the spectral component $k_\textnormal{max}$ to the total energy of the signal, giving a measure of the truncation accuracy.
% It is worth highlighting that this ratio corresponds to the \ac{SNR}, considering the components $k > k_{\textnormal{max}}$ as noise.

Moreover, the truncation index can assume an interesting physical interpretation. By rewriting \eqref{eq:discrete_truncation_criterion} in terms of internal passive wrench \eqref{eq:internal_passive_static_ft}, the truncation index represents the ratio between the deformation energy stored up to $k_{\textnormal{max}}$ and the total deformation energy of the \ac{CSR}. 
Furthermore, the stiffness matrix differentiates between strain modes, leveraging the robot's geometric and physical characteristics.

\subsection{Interpretation of Spatial Discretization Techniques in the Spatial Frequency Domain}
%  % Spatial Discretization Comparison Image
% \begin{figure*}
%     \centering
%     \includesvg[width=1.0\linewidth]{imgs/spectra.svg}
%     \caption{Comparison of the different spatial discretization methodologies. By treating the strain field as a signal, existing modeling approaches can be interpreted as reconstructors.}
%     \label{fig:spectra}
% \end{figure*}
% %
 % Spatial Discretization Comparison Image
\begin{figure*}
    \centering
    \includegraphics[width=1.0\linewidth]{imgs/spectra.pdf}
    \caption{Comparison of the different spatial discretization methodologies. By treating the strain field as a signal, existing modeling approaches can be interpreted as reconstructors.}
    \label{fig:spectra}
\end{figure*}
%
From the samples $\bm{\xi}(n \lambda_s)$, the spatial discretization techniques exposed in the Sec. \ref{background:soa} can be seen as signal reconstructors.

%% PCS %%
The \ac{PCS} method reconstructs the sampled strain, assuming constant strain along the single piece. Assuming $n_p$ pieces with the same length $\lambda_p = L / n_p$, the strain field can be written as
\begin{equation} \label{eq:pcs_strain}
    \xi_i(s, t) = \sum_{h = 0}^{n_{p} - 1} q_h(t) \, \Pi_h\left(s\right) \, ,
\end{equation}
where $\xi_i \in \mathbb{R}$ is the $i$-th element of the strain field,
$\Pi_h\left(s\right) =  \rect{\frac{s - \left(h + \frac{1}{2}\right) \lambda_p}{\lambda_p}}$, and $q_h \in \mathbb{R}$ is the constant value assumed in the $h$-th piece by $\xi_i$.

We can operate the \ac{SFT} of \eqref{eq:pcs_strain}, resulting in 
\begin{equation}
    \Xi_{i, \textnormal{PCS}}(jk, t) = \sum_{h = 0}^{n_p - 1} q_i(t) \, \Pi_h\left(jk\right) \, ,
\end{equation}
where $\Pi_h\left(jk\right) = \lambda_p \, \sinc{k \frac{\lambda_p}{2}} e^{-j k \left(h + \frac{1}{2}\right)\lambda_p}$, and $\sinc{\cdot}$ is the cardinal sine.
If the coefficients $q_h$ correspond to the $\xi_i(h \lambda_p)$, the \ac{PCS} approach can be interpreted as a spatial \ac{ZOH} of the discrete signal $\bm{\xi}$. The reconstructed signal through \ac{PCS} can be expressed as $\bm{\Xi}_{\textnormal{PCS}}(jk) = \bm{H}_0 (jk)  \, \bm{\Xi}_d(jk)$, where
\begin{equation}
    \bm{H}_0(jk) =  \lambda_p \left(\sinc{k \frac{\lambda_p}{2}} e^{-j k \frac{\lambda_p}{2}}\right) \bm{I}_{6} \, .
\end{equation}

Similar to the time \ac{ZOH}, the \ac{PCS} approach provides a shift in space of $\lambda_p / 2$, as evident in Fig. \ref{fig:spectra}. Furthermore, for any multiple of $2 \pi / \lambda_p$, the magnitude of $\bm{H}_0(jk)$ falls to 0. Note that these considerations are valid also for the \ac{PCC} case, due to the generality of \ac{PCS} method.

%% PAS %%
Concerning the \ac{PAS} method, we can write the reconstructed strain as
\begin{equation} \label{eq:pas_strain}
    \xi_i(s, t) = \sum_{h = 0}^{n_p - 1} \left(q_{h, 0}(t) + q_{h, 1}(t) s \right) \Pi_h\left(s\right) ,
\end{equation}
where $q_{h, \, 0}, \, q_{h, \, 1} \in \mathbb{R}$ are the time-varying coefficients of the $i$-th element of the strain field.
In the case of \ac{PLS}, it coincides with the \ac{FOH} reconstructor in space. The reconstructed spectrum can be written as $\bm{\Xi}_{\textnormal{PLS}}(jk) = \bm{H}_1(jk) \, \bm{\Xi}_d(jk)$, where
\begin{equation}
    \bm{H}_1(jk) =  \lambda_p \left(\sinc{k \frac{\lambda_p}{2}}\right)^2 \left(1 + jk \lambda_p\right) e^{-j k \frac{\lambda_p}{2}} \bm{I}_{6} \, .
\end{equation}

Differently from the piecewise methods, the \ac{GVS} can be seen as a fitting of the samples $\bm{\xi}(n \lambda_s)$ with specific functional bases, such as
\begin{equation} \label{eq:gvs_strain}
    \bm{\xi}(s, t) = \bm{B}_{\bm{q}}(s) \, \bm{q}(t) + \bm{\xi}^{*}(s) \, ,
\end{equation}
where $\bm{B}_{\bm{q}}(s) \in \mathbb{R}^{6 \times n_q}$ is the functional basis matrix and $\bm{q} \in \mathbb{R}^{n_q}$ is the time-dependent coefficients, considered as a vector of virtual joint variables.

The \ac{SFT} of the \ac{GVS} can be expressed as
\begin{equation} \label{eq:gvs_sft}
    \bm{\Xi}_{\textnormal{GVS}}(jk, t) = \left(\bm{B}_{\bm{q}}\left(jk\right) \, \bm{q}(t) + \bm{\Xi}^{*} \right) \ast \Pi_{L}\left(jk\right)\, , 
\end{equation}
where $\bm{B}_{\bm{q}}\left(jk\right) = \fourier{\bm{B}_{\bm{q}}(s)}$, and $\Pi_{L}\left(jk\right) = L \, \sinc{k \frac{L}{2}} e^{-j k \pi L}$ is the \ac{SFT} of \eqref{eq:length_space_window}. The convolution with the \ac{SFT} of the window function is necessary due to the domain adaption (Sec. \ref{sec:spatial_ft}). 
Eq. \eqref{eq:gvs_sft} states also in the \ac{ISP} case, requiring a numerical solution as in the space-domain.