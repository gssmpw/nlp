
\section{Details on Bracha-layer Byzantine behavior\label{anx:detail_bracha_layer_attack}}



Because Bracha's Byzantine Reliable Broadcast algorithm \cite{asynchronous_byzantine_agreement_protocols} relies on collecting (and thus waiting for) a certain number of ECHO and READY messages from other nodes, the adversary can statistically delay this $\mathtt{rdlver}$ operation on all nodes via infecting a minority of nodes.
In this scenario, infected nodes will not emit ECHO and READY messages for vertices that contain transactions from the target client.

Let us indeed suppose that the probability to receive an emitted ECHO before timestamp $z$ is given by variable $X$.
Among $n$ trials, the probability of having collected exactly $k \leq n$ such messages before $z$ is:
\[
\binom{n}{k} * X^k * (1-X)^{n - k}
\]

For vertices that contain transactions from the target client, sabotaged nodes never send these ECHO messages (we always have $X=0$ for any timestamp $z$) and can therefore be ignored when counting the numbers of messages.
Therefore, given $b \leq f$ the number of sabotaged nodes, the probability of having collected at least $\lfloor \frac{n+f}{2} \rfloor + 1$ ECHO messages from distinct nodes before $z$ is:
\[
Y = \sum_{k = \lfloor \frac{n+f}{2} \rfloor + 1}^{n-b} \binom{n - b}{k} * X^k * (1-X)^{n - b - k}
\]


$\mathtt{rdlver}$ then requires collecting at least $2*f+1$ READY messages, which probability we can approximate as follows:
\[
Z = \sum_{k = 2*f + 1}^{n-b} \binom{n - b}{k} * Y^k * (1-Y)^{n - b - k}
\]



\begin{figure}[h!]
\vspace*{-.25cm}
    \centering

\scalebox{.85}{
\input{figures/bracha_sabotage/theory_plot}
}

    \caption{Theoretical effect of Bracha sabotage for $n=25$}
    \label{fig:bracha_sabotage_theory}
\vspace*{-.25cm}
\end{figure}


Via plotting this probability $Z$ w.r.t.~$X$ on Fig.\ref{fig:bracha_sabotage_theory} (with $n=25$ and $f=8$), we observe that the more nodes are sabotaged, the less likely is the occurrence of the delivery $\mathtt{rdlver}$ operation before timestamp $z$.
Consequently, even if we stay below the maximum number $f$ of Byzantine nodes, sabotage can still result in the delivery of vertices to be delayed (statistically).
In turn, if the delivery of vertices that contain transactions from the target client is delayed, this makes them less likely to be the target of strong edges (which may result in situations such as the one described in Sec.\ref{ssec:attack_bracha} and Fig.\ref{fig:dag_attacked_bracha_layer}).
This can be partly mitigated by DagRider supporting weak edges.
The mitigation is only partial because for the delayed vertex to be included in the next wave $w$, it still requires to be targeted (via a weak edge) by a vertex in the causal subgraph of $w$'s leader. Otherwise it won't be included until at least wave $w+1$.

