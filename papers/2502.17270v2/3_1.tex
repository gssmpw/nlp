

\subsection{DAGs \& Blockchains\label{ssec:dags_and_blockchains}}

\begin{wrapfigure}{r}{.25\textwidth}
\vspace*{-.9cm}
    \centering
    \scalebox{.75}{\input{figures/principle/dag}}
    \caption{Simplified example}
    \label{fig:distributed_ledger_dag_and_blockchains}
\vspace*{-.4cm}
\end{wrapfigure}



DAG-based DL such as \cite{all_you_need_is_dag,narwhal_and_tusk,bullshark} rely on a Directed Acyclic Graph which vertices contain batches of transactions.
These graphs are structured in rows, corresponding to individual nodes that author vertices, and columns, representing the passing of time.
Fig.\ref{fig:distributed_ledger_dag_and_blockchains} represents a snapshot of such a DAG, built by a ledger that contains 3 nodes $A$, $B$ and $C$.
In the following we may use such simplified diagrammatic examples (with $n=3$) for didactic purposes.
The top/middle/bottom row represents vertices added by node $A$/$B$/$C$. 
We denote by $v_c^r$ the vertex at column $c \in \mathbb{N}$ and row $r \in \{A,B,C\}$.
Each node adds new vertices sequentially.
As in Blockchains, all nodes start with a common genesis state. 
In DAG-based ledgers this corresponds to a set of genesis vertices (in purple on Fig.\ref{fig:distributed_ledger_dag_and_blockchains}).
Then, so as to ensure consistency, new vertices contain hash references to previous vertices (found in previous columns).
Unlike Blockchains, in which there is a unique hash reference in each block, here, a vertex contains multiple references that are called {\em edges}.
\textbf{Strong} (resp.~\textbf{weak}) edges relate vertices of column $c$ to vertices of column $c-1$ (resp.~$c' < c-1$).
On Fig.\ref{fig:distributed_ledger_dag_and_blockchains} the only weak edge corresponds to the dashed arrow from $v_3^A$ to $v_1^C$.
To be able to broadcast a new vertex at column $c+1$, a node must have knowledge of a sufficient number of vertices at a column $c$, a well formed vertex having a minimum number of strong edges.
Weak edges are not required but can be used to allow vertices from ``slow'' nodes to be finalized.
The order with which vertices are ordered is inferred deterministically from the structure of the DAG.
So-called {\em leader vertices} are selected regularly (at fixed intervals of columns, a node/row is selected).
The causal sub-graphs of leader vertices are then ordered deterministically and finalized in \textit{waves}.





In \cite{all_you_need_is_dag}, columns are called rounds and a wave has $4$ rounds.
Also, the leader of a wave $w$ is defined as a vertex on the first round of the wave, that is elected retrospectively once the wave is complete (i.e., at the fourth round of the wave). It is therefore the leader of wave $w+1$ which determines the content of wave $w$ as its causal sub-graph.
In classical Blockchains, the notion of ``round'' is prevalent and refers to steps that can be repeated multiple times inside a cryptographic or consensus algorithm.
To avoid potential confusions, in the following, we will use the term ``column'' exclusively.
Also, it is generally the leader at a height $h$ that determines the content of the $h^{th}$ block.
In order to more easily juxtapose notions of waves and blocks\footnote{and to highlight that if the height $h$ leader is Byzantine, the adversary may more easily reorder transactions in the $h^{th}$ block}, in the following, we consider that ``the leader of wave $w$'' ($w$ starting at $0$) refers to the vertex at column $1 + 4*w$, that determines the wave's content as its causal sub-graph.


On Fig.\ref{fig:distributed_ledger_dag_and_blockchains}, we identify 2 waves of size $2$ (simplified illustrations use smaller waves), the first in cyan and the second in red .
Here, vertex $v_2^B$ (the right-most cyan vertex) is selected as leader for column $2$. 
The first wave, in cyan, therefore correspond to the causal sub-graph of $v_2^B$. 
In this simplified example, a wave's vertices are ordered from top to bottom and left to right. The final order then ignores duplicated transactions.
This yields $\lbrack x_1,x_2,x_3 \rbrack$ being finalized. 
Then, $v_4^A$ is selected as leader of column $4$, determining the second wave in red, which yields $\lbrack x_4,x_5 \rbrack$ being finalized.
Matching waves of vertices to blocks, we may obtain the same ordering of transactions in a traditional Blockchain as is illustrated on the bottom right of Fig.\ref{fig:distributed_ledger_dag_and_blockchains}.
In both cases, $\lbrack x_1, x_2, x_3 \rbrack$ and then $\lbrack x_4,x_5 \rbrack$ are finalized.
Even though Blockchains can provide the same service as DAG-based ledgers, the latter claim a better decentralization (due to a less obvious dependency on selected leader nodes) and a higher throughput at the price of a higher latency.
DAG-based ledgers may also arguably be less vulnerable to order-fairness attacks, which evaluation is the object of this present paper.

