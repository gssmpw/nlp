\begin{tikzpicture}[%
    every node/.style={align=center}]

    \node[anchor=north west, draw=black, thick, minimum height=0.05\linewidth, minimum width=0.65\linewidth, rounded corners]
        (L) at (0,0) {\textsf{L}};

    \node[anchor=north west, draw=black, thick, minimum height=0.29\linewidth, minimum width=0.65\linewidth, rounded corners]
        (TA) at (0,-0.1\linewidth) {};

    \node[draw, diamond, aspect=2, scale=0.65] (D2) at (0.21\linewidth,-0.275\linewidth) {$\exists\,w'\alphaequiv w:$\\ $w'\in L_0(\H)$?};
    \node[anchor=south west,text=lipicsGray] at ($(D2.north east) + (-1pt,-1pt)$) {\bfseries\textsf{2}};
    
    \node[anchor=south west] at ($(D2.south west) + (-1.05,-0.5)$) {\textsf{TA}};
    
    \node[draw, trapezium, trapezium left angle=70, trapezium right angle=110,
            scale=0.65] (COR) at ($(D2.east) + (2.25,0)$) {Compute $w \alphaequiv w_\teach$\\over $\barNames_0$};
            
    \node[anchor=north west,text=lipicsGray] at ($(COR.south east) + (14pt,1pt)$) {\bfseries\textsf{1}};
    

    \node[anchor=north, inner sep=0] (GL) at ($(TA.south) + (0,-0.1)$) {$\learn_\alpha$};
    \node[fit=(TA)(L)(GL), draw=black, thick, rounded corners, dotted] (BOXGENLEARN) {};

    \node[anchor=west, draw=black, thick, minimum height=0.05\linewidth, minimum width=0.2\linewidth, rounded corners] (T)
        at (0.75\linewidth, -0.21\linewidth) {\textsf{T}};

    \draw[rounded corners, -latex, ultra thick] ($(L.south east) + (-0.05\linewidth,0)$)
    -- node[scale=0.65, pos=0.2, right] {(\textsf{MQ})} node[scale=0.65, pos=0.4, right] {$w$} ++(0,-0.07\linewidth) 
    -| node[scale=0.65, pos=0.6, right] {($\textsf{MQ}_\alpha$)}
    node[scale=0.65,pos=0.75,right] {$w$}($(T.north west) + (0.1\linewidth,0)$);
    \draw[rounded corners, dashed, -latex, very thick] 
        let \p1 = (L.south), \p2 = ($(T.north) + (0,0.045\linewidth)$) in
        ($(T.north) + (-0.025\linewidth,0)$) -- ++(0,0.045\linewidth) -- node[pos=0.165, below, scale=0.65] {\textsc{Yes}/\textsc{No}} (\x1,\y2)
        -- (L.south);

    \draw[rounded corners, -latex, ultra thick]
        ($(L.south west) + (0.095\linewidth, 0)$) |-
        node[pos=0.045, scale=0.65, right] {(\textsf{EQ})}
        node[pos=0.1, scale=0.65, right] {$\H$}
        node[pos=0.96,above,scale=0.65] {($\textsf{EQ}_\alpha$)} node[pos=0.96,below,scale=0.65] {$\H$} (T.west);

    

    \draw[very thick, rounded corners, dashed] (T.south) |- 
        node[pos=0.25, right, scale=0.65] {\textsc{Yes}/$w_{\textsf{T}}$} ($(COR.east) + (3,0)$);
    \draw[very thick, rounded corners, dashed] ($(COR.east) + (3,0)$) -| ($(COR.east) + (2.5,-0.5)$);
    \draw[-latex, very thick, rounded corners, dashed] 
        let \p1 = (BOXGENLEARN.east), \p2 = ($(COR.east) + (0,-0.75)$) in ($(COR.east) + (2.5,-0.5)$) |- 
        node[pos=0.7, above, scale=0.65] {\textsc{Yes}} (\x1,\y2);
    
    \draw[-latex, very thick, rounded corners, dashed] ($(COR.east) + (3,0)$) -- node[pos=0.75, above, scale=0.65] {$w_{\textsf{T}}$} (COR.east);

    \draw[-latex, very thick, rounded corners, dashed]
        (COR.west) -- node[midway, above, scale=0.65] {$w$} (D2.east);
    
    \coordinate (AAAA) at ($(D2.west) + (-0.75,0)$);
    \coordinate (AAAB) at ($(COR.east) + (0,2)$);

    
    \draw[-latex, dashed, rounded corners, very thick]
        let \p1 = (AAAA), \p2 = (AAAB), \p3 = (L.south) in
        (D2.west) -| node[pos=0.15, above, scale=0.65] {\textsc{false}} node[pos=0.15, below, scale=0.65] {$w$}
        node[pos=0.93,right,scale=0.65] {$w$} (\x1,\y3);
    
    
    \draw[dashed, rounded corners, very thick]
        (D2.south) |- node[pos=0.175, left, scale=0.65] {\textsc{true}}
        node[pos=0.15, right, scale=0.65] {$w'$} ($(D2.south) + (-1,-0.5)$);
    
    \draw[dashed, rounded corners, very thick, -latex] 
        let \p1 = ($(D2.west) + (-1.15,0)$), \p2 = (L.south) in
        ($(D2.south) + (-1,-0.5)$) -| node[pos=0.95,left,scale=0.65] {$w'$} (\x1,\y2);
\end{tikzpicture}%
