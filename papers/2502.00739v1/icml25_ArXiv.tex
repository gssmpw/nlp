%%%%%%%% ICML 2024 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
%\usepackage{subfigure}
\usepackage{booktabs} % for professional tables

% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2024} with \usepackage[nohyperref]{icml2024} above.
\usepackage{hyperref}



% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}


%\usepackage{algorithmic}

%\usepackage{algolyx}
%\usepackage{algpseudocode}
%\usepackage[algo2e,linesnumbered,ruled,vlined]{algorithm2e}

% Use the following line for the initial blind version submitted for review:
%\usepackage{icml2024}

% If accepted, instead use the following line for the camera-ready submission:
%\usepackage[accepted]{icml2024}

% Use the following line for the initial blind version submitted for review:
%\usepackage{icml2025}

% If accepted, instead use the following line for the camera-ready submission:
%\usepackage[accepted]{icml2025}

\usepackage[accepted]{icml2024_ArXiv}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}
\usepackage[textsize=tiny]{todonotes}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Figures
%\usepackage{graphicx}
%\usepackage{subfigure}
% for captions
%\bibliographystyle{abbrv}
%\usepackage{caption}

\usepackage{subcaption}
\usepackage{epsf}
\usepackage{fancyhdr}
\usepackage{graphics}
\usepackage{psfrag}

\usepackage{wrapfig}
%\usepackage{wraptable}

%\usepackage{wrapfig}
\usepackage{float}
%\usepackage{subcaption}
%\usepackage{graphicx}

%\usepackage{xr-hyper}
%\usepackage{hyperref}


%%% For algorithms
%\usepackage{algorithm}

%%%\usepackage{algorithmic}
%%%
%%%\usepackage{algolyx}
%%%\usepackage{algpseudocode}
%%%\usepackage[algo2e,linesnumbered,ruled,vlined]{algorithm2e}

% For mathematics
%\usepackage{color,xcolor}
\usepackage{color}

%\usepackage{bm,bbm}
%\usepackage{multirow}
%%\usepackage{flushend}
%\usepackage{balance}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\def\TW{\textsf{TW}}
\def\RT{\textsf{RT}}
\def\dlambda{d_{\lambda}}

\def\calGS{\mathcal{GS}}
\def\calUGS{\mathcal{UGS}}
\def\calOS{\mathcal{OS}}

\def\calOE{\mathcal{OE}}

\def\calET{\mathcal{ET}}
\def\calKT{\mathcal{KT}}
\def\calW{\mathcal{W}}

\def\calSO{\mathcal{SO}}


\def\dx{\mathrm{d}x}
\def\dy{\mathrm{d}y}
\def\dz{\mathrm{d}z}
\def\supp{\mathrm{supp}}

\def\OrliczSobolev{W\!L}
\def\OrliczSobolevPhi{W\!L_{\Phi}}
\def\OrliczSobolevPsi{W\!L_{\Psi}}

\def\OrliczSobolevPsiOne{W\!L_{\Psi_1}}
\def\OrliczSobolevPsiTwo{W\!L_{\Psi_2}}

\usepackage{verbatim}

\renewcommand{\qedsymbol}{\rule{0.7em}{0.7em}}

\newcommand{\mytodo}[1]{\textcolor{red}{[Todo: #1]}}
%\newcommand{\note}[1]{\textbf{{\color{red}(#1)}}}
%\newcommand{\note}[1]{\textcolor{red}{[Notes: #1]}}
\newcommand{\note}[1]{{\color{red}(Notes: #1)}}
\newcommand{\tam}[1]{{\color{blue}(Tam: #1)}}

%\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand*\rfrac[2]{{}^{#1}\!/_{#2}}

%\usepackage{hyperref}
\let\oldemptyset\emptyset
\let\emptyset\varnothing

%%%%%%%%
%\input{style}
\input{comments}


\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\icmltitlerunning{Orlicz-Sobolev Transport for Unbalanced Measures on a Graph}

\begin{document}

% \twocolumn[
% \icmltitle{Orlicz-Sobolev Transport for Unbalanced Measures on a Graph}

\onecolumn
\begin{center}
{\bf{\Large{Orlicz-Sobolev Transport for Unbalanced Measures on a Graph}}}

\vspace*{.1in}
    {
 \begin{tabular}{cccc}
  Tam Le$^{*, \dagger, \ddagger}$ & Truyen Nguyen$^{*, \diamond}$ & Hideitsu Hino$^{\dagger, \ddagger}$ & Kenji Fukumizu$^{\dagger}$ \\
 \end{tabular}
 }

\vspace*{.1in}

 \begin{tabular}{c}
 The Institute of Statistical Mathematics (ISM)$^\dagger$ \\
 The University of Akron$^\diamond$\\
 RIKEN AIP$^\ddagger$
 \end{tabular}
\vspace*{.2in}

%\today

\vspace*{.2in}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2024
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.

% \icmlsetsymbol{equal}{*}

% \begin{icmlauthorlist}
% \icmlauthor{Firstname1 Lastname1}{equal,yyy}
% \icmlauthor{Firstname2 Lastname2}{equal,yyy,comp}
% \icmlauthor{Firstname3 Lastname3}{comp}
% \icmlauthor{Firstname4 Lastname4}{sch}
% \icmlauthor{Firstname5 Lastname5}{yyy}
% \icmlauthor{Firstname6 Lastname6}{sch,yyy,comp}
% \icmlauthor{Firstname7 Lastname7}{comp}
% %\icmlauthor{}{sch}
% \icmlauthor{Firstname8 Lastname8}{sch}
% \icmlauthor{Firstname8 Lastname8}{yyy,comp}
% %\icmlauthor{}{sch}
% %\icmlauthor{}{sch}
% \end{icmlauthorlist}

% \icmlaffiliation{yyy}{Department of XXX, University of YYY, Location, Country}
% \icmlaffiliation{comp}{Company Name, Location, Country}
% \icmlaffiliation{sch}{School of ZZZ, Institute of WWW, Location, Country}

% \icmlcorrespondingauthor{Firstname1 Lastname1}{first1.last1@xxx.edu}
% \icmlcorrespondingauthor{Firstname2 Lastname2}{first2.last2@www.uk}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document

% \icmlkeywords{Machine Learning, ICML}

% \vskip 0.3in
% ]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution

% \printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

Moving beyond $L^p$ geometric structure, Orlicz-Wasserstein (OW)\blfootnote{$^*$: equal contribution} leverages a specific class of convex functions for Orlicz geometric structure. While OW
remarkably helps to advance certain machine learning approaches, it has a high computational complexity due to its two-level optimization formula. Recently,~\citet{le2024generalized} exploits graph structure to propose generalized Sobolev transport (GST), i.e., a scalable variant for OW. However, GST assumes that input measures have the same mass. Unlike optimal transport (OT), it is nontrivial to incorporate a mass constraint to extend GST for measures on a graph, possibly having different total mass. In this work, we propose to take a step back by considering the entropy partial transport (EPT) for nonnegative measures on a graph. By leveraging~\citet{CM}'s observations, EPT can be reformulated as a standard complete OT between two corresponding balanced measures. Consequently, we develop a novel EPT with Orlicz geometric structure, namely Orlicz-EPT, for unbalanced measures on a graph. Especially, by exploiting the dual EPT formulation and geometric structures of the graph-based Orlicz-Sobolev space, we derive a novel regularization to propose Orlicz-Sobolev transport (OST). The resulting distance can be efficiently computed by simply solving a univariate optimization problem, unlike the high-computational two-level optimization problem for Orlicz-EPT. Additionally, we derive geometric structures for the OST and draw its relations to other transport distances. We empirically show that OST is several-order faster than Orlicz-EPT. We further illustrate preliminary evidences on the advantages of OST for document classification, and several tasks in topological data analysis.

%for unbalanced measures on a graph

%We study the optimal transport (OT) problem for measures supported on a graph metric space. Recently,~\citet{le2022st} leverage the graph structure and propose a variant of OT, namely Sobolev transport (ST), which yields a closed-form expression for a fast computation. However, ST is essentially coupled with the $L^p$ geometric structure within its definition which  makes it  nontrivial to utilize ST for other prior structures. In contrast, the classic OT has the flexibility to adapt to various geometric structures by modifying the underlying cost function. An important instance is the Orlicz-Wasserstein (OW) which moves beyond the $L^p$ structure by leveraging the \emph{Orlicz geometric structure}. Comparing to the usage of standard $p$-order Wasserstein, OW remarkably helps to advance certain machine learning approaches. Nevertheless, OW brings up a new challenge on its computation due to its two-level optimization formulation. In this work, we leverage a specific class of convex functions for Orlicz structure  to propose the generalized Sobolev transport (GST). GST encompasses the ST as its special case, and  can be utilized for prior structures  beyond  the $L^p$ geometry. In connection with the OW, we show that one only needs to simply solve a univariate optimization problem to compute the GST, unlike the complex two-level optimization problem in OW. We empirically illustrate that GST is several-order faster than the OW. Moreover, we provide preliminary evidences on the advantages of GST for document classification and for several tasks in topological data analysis.


%Optimal transport (OT) is a popular and powerful tool for comparing probability measures. However, OT suffers a few drawbacks: (i) input measures required to have the same mass, (ii) a high computational complexity, and (iii) indefiniteness which limits its applications on kernel-dependent algorithmic approaches. To tackle issues (ii)--(iii),~\cite{le2022st} recently proposed Sobolev transport for measures on a graph  having the \emph{same total mass} by leveraging the graph structure over supports. In this work, we consider measures that may have \emph{different total mass} and are supported on a graph metric space. To alleviate the disadvantages (i)--(iii) of OT,  we propose a novel and scalable approach to extend Sobolev transport for this \emph{unbalanced} setting where measures may have different total mass. 

%We show that the proposed \emph{unbalanced Sobolev transport} (UST) admits a closed-form formula for fast computation, and it is also negative definite. Additionally, we derive geometric structures for the UST and establish relations between our UST and other transport distances. We further exploit the negative definiteness to design positive definite kernels and evaluate them on various simulations to illustrate their fast computation and comparable performances against other transport baselines for unbalanced measures on a graph.



\end{abstract}

\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}

Moving beyond $L^p$ geometric structure, Orlicz-Wasserstein (OW) leverages a specific class of convex functions for Orlicz geometric structure. Intuitively, OW is an instance of optimal transport (OT), which utilizes Orlicz metric as its ground cost~\citep{sturm2011generalized, kell2017interpolation, GuhaHN23, altschuler2023faster, le2024generalized}. Notably, OW remarkably helps to advance certain machine learning approaches. For examples,~\citet{altschuler2023faster} recently leverage OW as a metric shift for R\'enyi divergence and propose novel differential-privacy-inspired techniques to overcome longstanding challenges for proving fast convergence of hypocoercive differential equations. Additionally,~\citet{GuhaHN23} leverage OW metric to alleviate several raised concerns caused from the usage of classical OT with Euclidean ground cost for quantifying the rates of parameter convergence within infinite Gaussian mixtures to significantly improve the Bayesian contraction rate of parameters arising from hierarchical Bayesian nonparametric models. However, OW has a high computational complexity steaming from its two-level optimization problem, i.e., one level for optimization plan, and the other level for an extra scalar in Orlicz metric structure. Recently,~\citet{le2024generalized} propose generalized Sobolev transport, which is a scalable variant of OW for probability measures on a graph, for practical applications, especially for large-scale settings. Besides that, Orlicz geometric structure has been also applied for several machine learning problems, e.g., linear regression~\citep{andoni2018subspace, song2019efficient}, scalable approaches for reinforcement learning, kernelized support vector machine, and clustering~\citep{deng2022fast}. Orlicz metric is also used to derive a finite-sample deviation bound for a general class of polynomial-growth functions to approximate high-order derivatives for arbitrary kernel~\citep{chamakh2020orlicz}, and as an OT regularization~\citep{lorenz2022orlicz}.

When input measures have different total mass, several proposals have been developed in the literature~\citep{hanin1992kantorovich, guittet2002extended, benamou2003numerical, CM, figalli2010optimal, lellmann2014imaging, P1, P2, frogner2015learning, kondratyev2016new, Liero2018, chizat2018unbalanced, bonneel2019spot, gangbo2019unnormalized, sejourne2019sinkhorn, pmlr-v151-sejourne22a, pham2020unbalanced, sato2020fast, chapel2020partial, balaji2020robust, mukherjee2021outlier,le2021ept, le2023scalable, nguyen2023unbalanced}, to name a few. The unbalanced setting for nonnegative measures has several applications, e.g., for color transfer and shape matching~\citep{bonneel2015sliced}; multi-label learning~\citep{frogner2015learning}; positive-unlabeled learning~\citep{chapel2020partial}; natural language processing and topological data analysis~\citep{le2021ept, le2023scalable}; robust approaches for applications with noisy supports or outliers~\citep{frogner2015learning, balaji2020robust, mukherjee2021outlier}.  

In this work, we focus on OT problem with Orlicz geometric structure for unbalanced measures supported on a graph metric space~\citep{le2022st}. Although GST~\citep{le2023scalable} provides a scalable variant for OW, GST assumes that input measures have the same mass as in OW. Unlike OT, it is nontrivial to incorporate a mass constraint to extend GST for general nonnegative measures on a graph. To address this challenge, our key insight is to take a step back to leverage~\citet{CM}'s observations, which allows  to reformulate unbalanced optimal transport (UOT) problem as corresponding standard complete OT problem
%, i.e., EPT on a graph~
\citep{le2023scalable}, to propose Orlicz-EPT for unbalanced measures on a graph with Orlicz geometric structure. Furthermore, by exploiting the graph structure, we propose Orlicz-Sobolev transport, which scales Orlicz-EPT for practical applications.

\textbf{Contribution.} In summary, our contributions are two-fold as follows:

%\begin{itemize}
%\item 

i) We propose to take a detour, and leverage EPT problem on a graph for unbalanced measures on a graph. By exploiting~\citet{CM}'s observations, we reformulate it as a corresponding standard complete OT to derive the proposed Orlicz-EPT. By further exploiting the graph structure, we develop a novel regularization and propose Orlicz-Sobolev transport (OST) which scales Orlicz-EPT for practical applications by showing that OST can be computed by solving a univariate optimization problem.

%\item 

ii) We derive theoretical results for OST and draw its connections to other transport distances. We empirically illustrate that OST is several-order faster than Orlicz-EPT, and show preliminary evidences on the advantages of OST for document classification and topological data analysis.

%\end{itemize}


\paragraph{Organization.} We briefly review related notions for our proposals in~\S\ref{sec:preliminaries}. In \S\ref{sec:OST}, we describe our proposed Orlicz-EPT and Orlicz-Sobolev transport (OST) based on EPT problem for unbalanced measures on a graph. Then, we derive theoretical properties for OST and draw its connections to other transport distances in~\S\ref{sec:properties_OrliczSobolevTransport}. In \S\ref{sec:related_works}, we discuss relations of the proposed approaches with other transport distances in the literature. We provide experimental results in~\S\ref{sec:experiments}, and conclude our work in~\S\ref{sec:conclusion}.

%\paragraph{Notations.} Let $\supp(\mu)$ be the set of supports of measure $\mu$, and denote $\bf{1}$ for the indicator function.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
\label{sec:preliminaries}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Graph.} We use the same graph setting as in~\citep{le2022st}. Specifically, let $V$ and $E$ be respectively the sets of nodes and edges. We consider a connected, undirected, and physical\footnote{In the sense that $V$ is a subset of Euclidean space $\R^n$, and each edge $e \in E$ is the standard line segment in $\R^n$ connecting the two vertices  of the edge $e$.} graph $\G = (V,E)$ with positive edge lengths $\{w_e\}_{e\in E}$. Following the convention in~\citep{le2022st} for continuous graph setting, $\G$ is regarded as the set of all nodes in $V$ together with all points forming the edges in $E$. Also,  $\G$ is equipped with the graph metric $d_{\G}(x,y)$  which equals to the length of the shortest path in $\G$ between $x$ and $y$. Additionally, we assume that there exists a fixed root node $z_0 \in V$ such that the shortest path connecting $z_0$ and $x$ is unique for any $x \in \G$, i.e., the uniqueness property of the shortest paths~\citep{le2022st}. 

%\Let or :=
Let $[x, z]$ denote the shortest path connecting $x$ and $z$ in $\G$. For $x \in \G$, edge $e \in E$, define the sets $\Lambda(x)$, $\gamma_e$ as follows: 
\begin{eqnarray}\label{sub-graph}
 && \Lambda(x) := \big\{y\in \G: \, x\in [z_0,y]\big\}, \nonumber \\
 && \gamma_e := \big\{y\in \G: \, e\subset  [z_0,y]\big\}.
\end{eqnarray}
Denote $\calP(\G)$ (resp.$\,\calP(\G \times\G)$) as the set of all nonnegative Borel measures on $\G$
(resp.$\,\G\times\G$) with a finite mass. 

%Additionally, let $\calP(\G)$ represent the  set  of all Borel probability measures on $\G$.

% \begin{equation}\label{sub-graph}
%  \Lambda(x) \hspace{-0.2em} \Let \hspace{-0.2em} \big\{y\in \G: \, x\in [z_0,y]\big\}; \gamma_e \hspace{-0.2em} \Let \hspace{-0.2em} \big\{y\in \G: \, e\subset  [z_0,y]\big\}.
% \end{equation}


%Denote $\calP(\G)$ as the set of all nonnegative Borel measures on $\G$ with a finite mass, similarly for $\calP(\G \times \G)$ on $\G \times \G$. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Functions on graph.} By a continuous function $f$ on $\G$, we mean that  $f: \G\to \R$ is continuous w.r.t.~the topology on $\G$ induced by the Euclidean distance. Henceforth, $C(\G)$ denotes the set of all continuous functions on $\G$.
Similar notation is used for continuous functions on $\G \times \G$. 

Given a scalar $b>0$, then a function $f:\G\to\R$ is called $b$-Lipschitz w.r.t.~the graph metric $d_\G$ if 
\[
|f(x) - f(y)|\leq b \, d_\G(x,y), \,\, \forall x, y \in \G.
\]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{A family of convex functions.} We consider the collection  of  $N$-functions~\citep[\S8.2]{adams2003sobolev} which are special convex functions on $\R_+$. Hereafter, a strictly increasing and   convex function $\Phi: [0, \infty)\to [0, \infty)$ is called an $N$-function if  $\lim_{t \to 0} \frac{\Phi(t)}{t} = 0$ and $\lim_{t \to +\infty} \frac{\Phi(t)}{t} = +\infty$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Orlicz functional space.} Given an  $N$-function $\Phi$ and  
a nonnegative Borel measure $\omega$ on $\G$, let $L_{\Phi}(\G, \omega)$ be the linear hull of the set of all Borel measurable functions $f: \G \to \R$ satisfying $\int_{\G} \Phi(|f(x)|) \omega(\text{d}x) < \infty$. Then, $L_{\Phi}(\G, \omega)$ is a normed space with the Luxemburg norm, defined as 
\begin{equation}\label{eq:Luxemburg_norm}
\hspace{-0.2em}\norm{f}_{L_\Phi} \! \coloneqq \! \inf \left\{t > 0 \mid \int_{\G} \Phi\left(\frac{|f(x)|}{t}\right)\omega(\text{d}x) \le 1 \right\}.
\end{equation}

% \begin{remark}
% Another popular norm for $L_{\Phi}(\G, \omega)$ is the Orlicz norm~\citep[\S3.3]{rao1991theory}.
% \end{remark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Orlicz-Sobolev Transport}
\label{sec:OST}

% \begin{itemize}
%     \item For unbalanced measures on a graph, we leverage the entropy partial transport (EPT) on a graph approach~\citep{le2023scalable}.

%     \item Next, we formulate Orlicz-EPT on a graph. (i.e., unbalanced approach for the Orlicz-Wasserstein)

%     \item Then, Orlicz-Sobolev transport as the regularized approach.

% \end{itemize}


%\mytodo{Extend the EPT on graph with Orlicz structure}

In this section, for completeness, we briefly review the entropy partial transport (EPT) problem for unbalanced measures on a graph~\citep[\S3]{le2023scalable}. We extend it for Orlicz geometric structure. Then, we describe our proposed Orlicz-Sobolev transport.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Orlicz-EPT: EPT on a Graph with Orlicz Structure}\label{subsec:OrlicEPT}

\paragraph{EPT on a graph.} Let $\gamma_1, \gamma_2$ respectively be the first and second marginals of $\gamma \in \calP(\G \times \G)$. For unbalanced measures $\mu, \nu \in \calP(\G)$, we consider the set $\Pi_{\leq}(\mu,\nu) := \left\{ \gamma :  \, \gamma_1\leq \mu, \, \gamma_2\leq \nu \right\}$ where $\gamma_1 \le \mu$ means $\gamma_1(B) \le \mu(B)$ for all Borel set $B \subset \G$, similarly for $\gamma_2 \le \nu$. Additionally, let $f_1, f_2$ respectively be the Radon-Nikodym derivatives of $\gamma_1$ w.r.t. $\mu$ and of $\gamma_2$ w.r.t. $\nu$, i.e., $\gamma_1=f_1 \mu$ ($0\leq f_1 \leq 1$, $\mu$-a.e.) and $\gamma_2 = f_2 \nu$ ($0\leq f_2 \leq 1$, $\nu$-a.e.). 

For convex and lower semicontinuous entropy functions $F_1, \, F_2: [0,1]\to (0,\infty)$, and nonnegative weight functions $w_1, w_2:\G \to [0,\infty)$, we consider the weighted relative entropies  of $\gamma_1$ w.r.t. $\mu$ and of $\gamma_2$ w.r.t. $\nu$ as follows:
\begin{eqnarray}
\calF_1(\gamma_1| \mu) &:= \int_\G w_1(x) F_1(f_1(x) ) \mu(\dd x), \\
\calF_2(\gamma_2| \nu) &:= \int_\G w_2(x) F_2(f_2(x) ) \nu(\dd x).
\end{eqnarray}

We consider the graph metric $d_{\G}$ for the ground cost function. For a positive scalar $b > 0$, and scalar $m\in [0,\bar m]$ where $\bar m := \min\{\mu(\G), \nu(\G) \}$, the EPT problem on $\G$ is
\begin{eqnarray}\label{original}
\hspace{-0.1em} \mathrm{W}_{m}(\mu,\nu) 
 := \hspace{-1.5em} \inf_{\gamma \in \Pi_{\leq}(\mu,\nu), \, \gamma(\G\times \G)=m}
\hspace{-0.2em} \Big[ \calF_1(\gamma_1| \mu )  + \calF_2(\gamma_2| \nu )  + \, b \int_{\G \times \G} d_{\G}(x,y) \gamma(\dd x, \dd y) \Big]. \hspace{0.2em}
\end{eqnarray}

As in~\citet[\S3]{le2023scalable}, by using the entropy functions $F_1(s)=F_2(s)=|s-1|$ and considering a Lagrange multiplier $\lambda\in\R$ conjugate to the constraint $\gamma(\G\times \G)=m$, we instead study the problem
\begin{eqnarray}\label{P1}
\mathrm{ET}_{\lambda}(\mu,\nu) 
= \inf_{\gamma \in \Pi_{\leq}(\mu,\nu)} \mathcal{C}_\lambda(\gamma),
\end{eqnarray}
where $\mathcal{C}_\lambda(\gamma) = \int_\G  \hspace{-0.1 em} w_1 \mu(\dd x) + \int_\G  \hspace{-0.1 em} w_2  \nu(\dd x) -\int_\G  \hspace{-0.1 em} w_1 \gamma_1(\dd x) - \int_\G  \hspace{-0.1 em} w_2\gamma_2(\dd x)+ b  \int_{\G \times \G} [d_{\G}(x,y)-\lambda]\gamma(\dd x, \dd y)$. 

By leveraging the observation of \citet{CM}, we reformulate problem~\eqref{P1} as the standard complete OT problem. More specifically, we consider a point $\hat s$ outside graph $\G$ (i.e., $\hat s \notin \G$). We then extend the graph metric ground cost $d_{\G}$ to a new cost function $\hat c$ with $b\lambda$-deviation for its nonnegativity on the set $\hat\G:= \G \cup \{\hat s\}$ as follows:
\begin{equation}\label{eq:c_hat_cost}
\hat c(x,y) :=
\left\{\begin{array}{lr}
\!\!bd_{\G}(x,y) \hspace{2.9 em} \mbox{ if } x,y\in \G,\\
\!\!w_1(x) + b\lambda \hspace{2.0 em} \mbox{ if }  x\in \G \mbox{ and } y=\hat s,\\
 \!\! w_2(y) + b\lambda \hspace{2.0 em}  \mbox{ if }  x=\hat s \mbox{ and } y\in \G,\\
  \!\! b\lambda \hspace{5.7 em} \mbox{ if }  x=y=\hat s.
\end{array}\right.
\end{equation}

%\todo{in addition to the same mass of $\hat\mu$ and $\hat\nu$, for simplicity, we will consider their unit-mass normalization, and keep track the constant-mass. It will be helpful when we extend it for Orlicz geometric structure.}

For unbalanced measures $\mu, \nu$, by adding a Dirac mass at point $\hat s$, we construct corresponding balanced unit-mass measures $\hat\mu = \frac{\mu +\nu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$ and $\hat\nu = \frac{\nu +\mu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$. Consequently, we consider the standard complete OT problem between $\hat\mu, \hat\nu$ with cost $\hat c$ as follows
\begin{eqnarray}\label{P2}
\mathrm{KT}(\mu, \nu) := \left(\mu(\G) + \nu(\G)\right)\left(\calW_{\hat c}(\hat \mu,\hat \nu) - b\lambda\right),
\end{eqnarray}
where $\calW_{\hat c}(\hat \mu,\hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat\mu,\hat \nu)}  \int_{\hat \G\times \hat \G} \hat c(x,y) \tilde\gamma(\dd x, \dd y)$, and $\Pi(\hat \mu,\hat \nu) := \Big\{ \hat\gamma \in \calP( \hat\G \times \hat \G): \hat \mu(U) =\hat\gamma(U\times \hat \G),\, \hat\nu(U)= \hat\gamma(\hat \G\times U) \mbox{ for all Borel sets } U\subset \hat \G\Big\}$.

% \begin{equation}\label{P2_OT}
% \mathrm{OT}(\hat \mu,\hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat\mu,\hat \nu)}  \int_{\hat \G\times \hat \G} \hat c(x,y) \tilde\gamma(\dd x, \dd y),
% \end{equation}

Therefore, one can reformulate an unbalanced OT problem~\eqref{P1} into a corresponding standard complete OT~\eqref{P2}. Consequently, we not only bypass all the technical challenges in the unbalanced setting but also utilize abundant existing results and approaches in the standard balanced setting for OT problem with unbalanced measures on a graph. 

\begin{remark}[Nonnegativity]
The nonnegativity of the cost function $\hat{c}$~\eqref{eq:c_hat_cost} for standard OT~\eqref{P1} is essential for the development of EPT with Orlicz geometric structure. We remark that such nonnegativity is not guaranteed in~\citet{le2023scalable}.
\end{remark}

\paragraph{Orlicz-EPT.}

Following the approaches in~\citet{sturm2011generalized, kell2017interpolation, GuhaHN23, chewi2023optimization}, we define \emph{Orlicz-EPT}, i.e., EPT with Orlicz geometric structure, upon the corresponding standard OT problem~\eqref{P2} as follows:
\begin{eqnarray}\label{eq:OrliczEPT}
\calOE_{\Phi}(\mu, \nu) := \left(\mu(\G) + \nu(\G)\right)(\calW_{\Phi}(\hat \mu,\hat \nu) - b\lambda),
\end{eqnarray}
where $\calW_{\Phi}(\hat \mu,\hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \inf \Big[ t > 0 : \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t}\right) \text{d}\tilde\gamma(x, y) \le 1\Big]$.

We next show that the objective function of Orlicz-EPT w.r.t. $t$ is monotonically non-increasing.
\begin{proposition}[Monotonicity]\label{prop:monotonicity_OT}
For unbalanced measures $\mu, \nu \in \calP(\G)$, construct corresponding $\hat \mu, \hat \nu, \hat c$. For an $N$-function $\Phi$, let 
\begin{equation}\label{eq:OW_t}
\mathcal{A}(t; \hat \mu, \hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t}\right) \dd\tilde\gamma(x, y).
\end{equation}%\label{eq:Aobj}
Then, $\mathcal{A}(t; \hat \mu, \hat \nu)$ is monotonically non-increasing w.r.t. $t$.
\end{proposition}

Proof is placed in Appendix \S\ref{appsubsec:Monotonicity_OT}.

\paragraph{Computation.} Observe that for a fixed $t$, $\mathcal{A}$ is a standard OT problem between $\hat\mu$ and $\hat\nu$ with the cost function $\Phi\!\left(\frac{\hat{c}(\cdot, \cdot)}{t}\right)$. We show that the monotonicity is preserved for its corresponding entropic regularization.
\begin{proposition}[Entropic regularization]\label{prop:monotonicity_regOT}
Define the entropic regularization of $\mathcal{A}$ as   
\begin{equation}\label{eq:regOW_t}
\mathcal{A}_{\varepsilon}(t; \hat \mu, \hat \nu) \! := \! \hspace{-1em} \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \hspace{-0.1em} \! \left[ \int_{\hat \G \times \hat \G} \hspace{-1.2em} \Phi\left( \! \frac{\hat{c}(x, y)}{t} \! \right)\! \dd\tilde\gamma(x, y) \!-\! \varepsilon H(\tilde\gamma) \right],
\end{equation}
where $\varepsilon \ge 0$ and $H$ is Shannon entropy defined as $H(\tilde\gamma) := -\int_{\hat\G \times \hat \G} (\log\tilde\gamma(x, y) - 1)\dd\tilde\gamma(x, y)$. Then, $\mathcal{A}_{\varepsilon}(t; \hat \mu, \hat \nu)$ is monotonically non-increasing w.r.t. $t$.
\end{proposition}

Proof is placed in Appendix \S\ref{appsubsec:Monotonicity_regOT}.

Additionally, we derive the upper and lower bounds for $\mathcal{A}_{\varepsilon}$.
\begin{proposition}[Bounds]\label{prop:limits_regOT}
We have
\[
\hspace{-0.5em} \mathcal{A}_{\varepsilon} \! \left(\frac{\calW_{\hat c}(\hat \mu, \hat \nu)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}; \hat \mu, \hat \nu  \right) \ge  1,
\]
\[
\mathcal{A}_{\varepsilon} \! \left(\frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}; \hat \mu, \hat \nu\right) \le 1,
\]
where $L_{\hat \mu, \hat \nu} = \max_{x \in \supp(\hat \mu), y \in \supp(\hat \nu)} \hat{c}(x, y)$, and $\supp(\cdot)$ is a set of supports of a measure.
\end{proposition}

Proof is placed in Appendix \S\ref{appsubsec:limits_regOT}.

%\mytodo{Check proof!}

From the monotonicity of $\mathcal{A}_{\varepsilon}$ in Proposition~\ref{prop:monotonicity_regOT}, and the limits of $\mathcal{A}_{\varepsilon}$ in Proposition~\ref{prop:limits_regOT}, we can leverage the binary search to compute the entropic regularized Orlicz-EPT (corresponding to the original Orlicz-EPT~\eqref{eq:OrliczEPT}), defined as:
\begin{eqnarray}\label{eq:regOrliczEPT}
\calOE_{\Phi, \varepsilon}(\mu, \nu) := \left(\mu(\G) + \nu(\G)\right)(\calW_{\Phi, \varepsilon}(\hat \mu,\hat \nu) - b\lambda),
\end{eqnarray}
where $\calW_{\Phi, \varepsilon}(\hat \mu,\hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \inf \Big[ t > 0 : \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t}\right) \text{d}\tilde\gamma(x, y) - \varepsilon H(\tilde \gamma) \le 1\Big]$.

Although the entropic regularized Orlicz-EPT $\calOE_{\Phi, \varepsilon}$~\eqref{eq:regOrliczEPT} scales up the computation of the original Orlicz-EPT $\calOE_{\Phi}$~\eqref{eq:OrliczEPT} by leveraging binary search on the quadratic-complexity $\mathcal{A}_{\varepsilon}$~\eqref{eq:regOW_t} instead of the super-cubic-complexity $\mathcal{A}$~\eqref{eq:OW_t}, the nature two-level optimization complexity of $\calOE_{\Phi, \varepsilon}$ still remains, which hinders its practical applications, especially in large-scale settings. To tackle this computational challenge, we next leverage a collection of special convex functions (i.e., $N$-functions) to propose the \emph{Orlicz-Sobolev transport}, which can adopt Orlicz geometric structure in the same sense as the Orlicz-EPT, and especially, it is much more efficient for computation. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Orlicz-Sobolev Transport}
We recall the dual formula of EPT, and the graph-based Orlicz-Sobolev space which play as the key components for our proposed \emph{Orlicz-Sobolev transport} (OST) for unbalanced measures on a graph.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Dual formula of EPT on a graph~\citep{le2023scalable}.} Assume that  $\lambda \geq 0$ and the nonnegative weight functions $w_1, w_2$ are $b$-Lipschitz w.r.t. $d_\G$. Following~\citet[Corollary 3.2]{le2023scalable}, the dual EPT on a graph is as follows:
\begin{eqnarray}\label{equ:ETlambda}
\mathrm{ET}_\lambda(\mu,\nu) = \sup_{f\in \mathbb{U}} \int_\G f (\mu - \nu) - \frac{b\lambda}{2}\big[ \mu(\G) +  \nu(\G)\big],
\end{eqnarray}
where $ \mathbb{U} := \big\{f\in C(\G) :
 -w_2 - \frac{b\lambda}{2}\leq f \leq w_1  + \frac{b\lambda}{2}, \, |f(x)-f(y)|\leq b \, d_\G(x,y)\big\}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{definition}[Graph-based Orlicz-Sobolev space~\citep{le2024generalized}] \label{def:OrliczSobolev}
\paragraph{Graph-based Orlicz-Sobolev space~\citep{le2024generalized}.} Let $\Phi$ be an  $N$-function and $\omega$ be a nonnegative Borel measure on graph $\G$. A continuous function $f: \G \to \R$ is said to belong to the graph-based Orlicz-Sobolev space $\OrliczSobolevPhi(\G, \omega)$ if there exists a function $h\in L_{\Phi}( \G, \omega) $ satisfying 
\begin{equation}\label{eq:OrliczSobolevFunction}
f(x) - f(z_0) =\int_{[z_0,x]} h(y) \omega(\mathrm{d}y),  \quad \forall x\in \G.
\end{equation}
Such function $h$ is unique in $L_{\Phi}(\G, \omega)$ and is called the generalized graph derivative of $f$ w.r.t.~the measure $\omega$. Henceforth, this generalized graph derivative of $f$ is denoted $f'$.
%\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Orlicz-Sobolev transport (OST).} Inspired by the generalized Sobolev transport~\citep{le2024generalized}, we exploit the dual EPT on a graph. We then replace the Lipschitz constraint for the critic function $f$ in $\mathbb{U}$ by a constraint involving the graph-based Orlicz-Sobolev space, i.e., $f \in \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \le b$ where $\Psi$ is the complement $N$-function of $\Phi$. Moreover, thanks to the observation in~\citet{le2021ept}, from Equation~\eqref{eq:OrliczSobolevFunction} and $\norm{f'}_{L_{\Psi}} \le b$, we employ the generalized H\"older inequality w.r.t. Luxemburg norm in Orlicz space $L_{\Psi}(\G, \omega)$~\citep[\S8.11]{adams2003sobolev}, then $\int_{[z_0,x]} f'(y) \omega(\mathrm{d}y)$ is controlled by $2b/ \Phi^{-1}\!\left(\omega([z_0, x])^{-1} \right)$. Therefore, instead of the bounded constraint on the critic function $f$ in $\mathbb{U}$, we constraint only on $f(z_0)$.     

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{definition}[Orlicz-Sobolev transport]\label{def:OST}
Let $\omega$ be a nonnegative Borel measure on graph $\G$, and $\calI_{\alpha} := \left[-w_2(z_0) - \frac{b\lambda}{2} + \alpha, w_1(z_0)  + \frac{b\lambda}{2} - \alpha \right]$ where $\alpha \in [0, \frac{1}{2}(b\lambda + w_1(z_0) + w_2(z_0))]$. Given a pair of complementary $N$-functions $\Phi, \Psi$,\footnote{We give a review of complementary $N$-functions in \S\ref{appsubsec:Orlicz_functions}.} and for $\mu, \nu\in \calP(\G)$, the Orlicz-Sobolev transport is defined as follows 
\begin{eqnarray}\label{equ:OST}
\calOS_{\Phi, \alpha}(\mu,\nu ) \hspace{-0.2em} := \hspace{-0.6em} \sup_{f\in \mathbb{U}_{\Psi, \alpha}} \hspace{-0.3em} \left[ \int_\G \hspace{-0.4em} f(x)\mu(\dd x) - \int_\G \hspace{-0.4em} f(x)\nu(\dd x) \right]\!,
\end{eqnarray}
where $\mathbb{U}_{\Psi, \alpha} \! := \! \big\{f \! \in \! \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \! \le \! b, f(z_0) \! \in \! \calI_{\alpha}\big\}$.
\end{definition}
Intuitively, $\mathbb{U}_{\Psi, \alpha}$ is the collection of all functions $f$, expressed by $f(x) = s + \int_{[z_0, x]} h(y) \omega(\dd y), \forall x \in \G$, where $s \in \calI_{\alpha}$, and $\norm{h}_{L_{\Psi}} \le b$. The upper bound constraint on $\alpha$ is to ensure that $\calI_{\alpha}$ is nonempty. When $\alpha = 0$, the interval $\calI_{\alpha}$ is the largest. Additionally, OST for unbalanced measures on a graph is an instance of the integral probability metric~\citep{muller1997integral}.


% \begin{eqnarray}\label{equ:OST}
% \calOS_{\Phi, \alpha}(\mu,\nu ) \hspace{-0.2em} := \hspace{-0.6em} \sup_{f\in \mathbb{U}_{\Psi, \alpha}} \hspace{-0.2em} \int_\G  \hspace{-0.3em} f (\mu - \nu) \!-\! \frac{b\lambda}{2}\big[ \mu(\G) +  \nu(\G)\big],
% \end{eqnarray}


% \begin{remark}
%     Instead of $\norm{f'}_{L_{\Psi}} \le b$ for $f \in \mathbb{U}_{\Psi, \alpha}$, one can leverage the Orlicz norm for $f \in \OrliczSobolevPhi(\G, \omega)$ as a variant of the Orlicz-Sobolev transport.
% \end{remark}

\paragraph{Computation.} We show that OST can be efficiently computed by simply solving a corresponding univariate optimization problem.
\begin{theorem}[OST as a univariate optimization problem]\label{thm:OST_computation} Given two unbalanced measures $\mu, \nu \in \calP(\G)$, define
\begin{align}\label{def:Theta}
    \Theta :=  \left\{\begin{array}{lr}
     w_1(z_0) + \frac{b\lambda}{2} -\alpha \hspace{1.2em} &\mbox{if}\quad\mu(\G)\geq \nu(\G),\\
    w_2(z_0) + \frac{b\lambda}{2} -\alpha \hspace{1.2em} &\mbox{if}\quad\mu(\G)< \nu(\G).
    \end{array}\right.
    \end{align}
Then, Orlicz-Sobolev transport can be computed as follows:
\begin{eqnarray}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + 
    \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right)\!. 
\end{eqnarray}
\end{theorem}
%\mytodo{Adapt to $b$-norm instead of unit ball}

The proof is placed in Appendix \S\ref{appsubsec:thm:OST_computation}.

%The integral in Equation~\ref{eq:OrliczSobolevFunction} can be expressed explicitly when input measures are supported on nodes (i.e., in the node set $V$) of graph $\G$.

%Assume that $\omega(\{x\}) = 0$, $\forall x\in \G$

We next derive the discrete case for the OST. Especially, we provide an explicit expression for the integral in Equation~\eqref{eq:OrliczSobolevFunction}.
\begin{corollary}[Discrete case]\label{cor:OST_1d_optimization_discrete}
Let $\omega$ be the length measure of graph $\G$, and input measures $\mu,\nu$ are supported on nodes in $V$ of graph $\G$.\footnote{It can be extended for measures supported in $\G$ (see \S\ref{app:subsec:further_discussions}).} Then, we have
\begin{eqnarray}\label{eq:OST_1d_opt_discrete}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| 
    + \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \sum_{e \in E} \hspace{-0.1em} w_e \Phi\!\left(kb \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right|\right) \right), 
\end{eqnarray}
\end{corollary}
The proof is placed in Appendix~\S\ref{app:subsec:cor:OST_1d_optimization_discrete}.

%\footnote{\citet[Theorem 13]{rao1991theory} derived the necessary and sufficient conditions to obtain the infimum for problem~\eqref{equ:GST_1d_optimization_discrete}.}

Therefore, the OST (Definition~\ref{def:OST}) can be efficiently computed by simply solving the univariate optimization problem~\eqref{eq:OST_1d_opt_discrete} (e.g., by second-order methods).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{remark}[Non-physical graph]
Although $\G$ is assumed to be a physical graph (\S\ref{sec:preliminaries}), Corollary~\ref{cor:OST_1d_optimization_discrete} implies that OST only depends on the graph structure $(V, E)$ and edge weights $w_e$ when measures are supported on nodes in $V$ of graph $\G$, i.e., OST is applicable for non-physical graph $\G$.  
\end{remark}

\begin{remark}[Complementary pairs of $N$-functions]
Corollary~\ref{cor:OST_1d_optimization_discrete} also implies that one can compute OST with $N$-function $\Phi$ without involving its complementary $N$-function $\Psi$ (Equation~\eqref{eq:OST_1d_opt_discrete}), unlike its definition (Equation~\eqref{equ:OST}). It requires that $\Psi$ is finited-value to derive the univariate optimization formula~\eqref{eq:OST_1d_opt_discrete}), which is satisfied for any $N$-function $\Phi$, i.e., growing faster than linear.
\end{remark}

\textbf{Preprocessing for $\gamma_e$.} Following the observation in~\citet{le2024generalized}, we precompute set $\gamma_e$ (Equation~\eqref{sub-graph}) for all edge $e$ in $\G$. More concretely, we apply the Dijkstra algorithm to recompute the shortest paths from the root node $z_0$ to all other vertices in $V$ with complexity $\mathcal{O}(|E| + |V| \log{|V|})$, where $|\cdot|$ is the set cardinality. 

\begin{remark}[Sparsity] Observe that $\forall x \in \text{supp}(\mu)$, its mass is gathered into $\mu(\gamma_e)$ if and only if $e \subset [z_0, x]$~\citep{le2024generalized}. Therefore, by defining set $E_{\mu, \nu} \subset E$ as
\[
E_{\mu, \nu} \hspace{-0.2em}:=\hspace{-0.2em} \left\{e \! \in \! E \mid \exists z \! \in \! (\text{supp}(\mu) \cup \text{supp}(\nu)), e \subset [z_0, z] \right\}\!,
\]
it suffices to compute the summation only over edges $e \in E_{\mu, \nu}$ in Equation~\eqref{eq:OST_1d_opt_discrete} for OST, i.e., screening all edges $e \in E \setminus E_{\mu, \nu}$.
\end{remark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theoretical Properties}
\label{sec:properties_OrliczSobolevTransport}

Orlicz-EPT has its own interesting characteristics. However, it has a high computational complexity due to its two-level optimization formula, which hinders its practical applications. Thus, in this section, we mainly focus on theoretical properties for Orlicz-Sobolev transport (OST).\footnote{See \S\ref{app:subsec:further_discussions} for Orlicz-EPT.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Geometric Structure of Orlicz-Sobolev Transport} 
We derive the geometric structure of OST. Under certain conditions, we prove that OST is a metric.
\begin{proposition}[Geometric structures of OST]\label{prop:OST_geodesic_space} 
Let $\omega$ be a nonnegative Borel measure on graph $\G$. Assume that $\lambda, w_1(z_0), w_2(z_0) \ge 0$, and $0\leq \alpha< \frac{b\lambda}{2} +\min\{w_1(z_0), w_2(z_0)\}$. Then, $\forall \mu, \nu, \sigma \in \calP(\G)$, we have
%\begin{enumerate}
%\begin{itemize}

%\item 
i) $\calOS_{\Phi, \alpha}(\mu +\sigma,\nu +\sigma) = \calOS_{\Phi, \alpha}(\mu,\nu)$.

%\item 

ii) $\calOS_{\Phi, \alpha}$ is a divergence.\footnote{$\calOS_{\Phi, \alpha}(\mu,\nu) \geq 0$; $\calOS_{\Phi, \alpha}(\mu,\nu) = 0$ if and only if $\mu=\nu$.}
It also satisfies the triangle inequality:
$\calOS_{\Phi, \alpha}(\mu,\nu)\leq \calOS_{\Phi, \alpha}(\mu,\sigma) + \calOS_{\Phi, \alpha}(\sigma, \nu)$.

%\item 

iii) With an additional assumption $w_1(z_0)=w_2(z_0)$, then $\calOS_{\Phi, \alpha}$ is a metric.

% and  $(\calP(\G), \calOS_{\Phi, \alpha})$ is a complete metric space. Furthermore, it is a geodesic space in the sense that for every two measures $\mu, \nu \in \calP(\G)$, there exists a path $\varphi: [0,a ]\to \calP(\G)$ with $a := \calOS_{\Phi, \alpha}(\mu,\nu)$ s.t. $\varphi(0)=\mu$, $\varphi(a)=\nu$, and
% \[
% \calOS_{\Phi, \alpha}(\varphi(t), \varphi(s)) = |t-s|, \, \forall t,s\in [0,a].
% \]

%\end{enumerate}
%\end{itemize}

\end{proposition}
The proof is placed in Appendix~\S\ref{app:subsec:prop:OST_geodesic_space}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Relations to Other Transport Distances}

We draw several connections for OST with other transport distances on graph $\G$, including generalized Sobolev transport (GST)~\citep{le2024generalized}, Sobolev transport (ST)~\citep{le2022st}, unbalanced Sobolev transport (UST)~\citep{le2023scalable}, Orlicz-EPT (\S3.1), a variant of regularized EPT~\citep{le2021ept}, and standard optimal transport (OT). Additionally, we consider the limit case $\Phi(t) = t$ for $N$-function, and the special case when graph $\G$ is a tree.

\paragraph{Connection with generalized Sobolev transport.}
\begin{proposition}\label{prop:relation_OST_GST}
    Assume that $\mu(\G) = \nu(\G)$, $b=1$, and denote $\mathcal{GS}_{\Phi}$ for the GST with $N$-function $\Phi$,\footnote{See \S\ref{appsubsec:GST} for a review on GST $\mathcal{GS}_{\Phi}$.} then we have
    \[
        \calOS_{\Phi, \alpha}(\mu,\nu) = \mathcal{GS}_{\Phi}(\mu,\nu).
    \]
\end{proposition}
The proof is placed in Appendix~\S\ref{app:subsec:prop:relation_OST_GST}.

\paragraph{Connection with Sobolev transport.}
\begin{proposition}\label{prop:relation_OST_ST}
    Assume that $\mu(\G) = \nu(\G)$, $b=1$, and denote $\mathcal{S}_p$ for the $p$-order Sobolev transport\footnote{See \S\ref{appsubsec:ST} for a review on $p$-order ST $\mathcal{S}_p$.}. Then, for $1 < p < \infty$ and $N$-function $\Phi(t) = \frac{(p-1)^{p-1}}{p^p} t^p$, we have
    \[
        \calOS_{\Phi, \alpha}(\mu,\nu) = \mathcal{S}_{p}(\mu,\nu).
    \]
\end{proposition}
The proof is placed in Appendix~\S\ref{app:subsec:prop:relation_OST_ST}.

\paragraph{Connection with unbalanced Sobolev transport.}

\begin{proposition}\label{prop:relation_OST_UST}
    For $N$-function $\Phi(t) = \frac{(p-1)^{p-1}}{p^p} t^p$ with $1 < p < \infty$, and denote $\mathcal{US}_{p, \alpha}$ for the unbalanced Sobolev transport,\footnote{See \S\ref{appsubsec:UST} for a review on $p$-order UST $\mathcal{US}_{p, \alpha}$.} then we have
    \[
    \calOS_{\Phi, \alpha}(\mu,\nu) = \mathcal{US}_{p, \alpha}(\mu,\nu).
    \]
\end{proposition}

The proof is placed in Appendix~\S\ref{app:subsec:prop:relation_OST_UST}.

\paragraph{For the limit case\footnote{Notice that $\Phi(t) = t$ is not an $N$-function due to its linear growth. It can be considered as the limit $p \to 1^+$ of the $N$-function $\Phi(t) = t^p$ with $p>1$.}: $\Phi(t) = t$}.

\begin{proposition}[Limit case for OST]\label{prop:limit_OST}
    For $\Phi(t) = t$, and with the same assumptions in Corollary~\ref{cor:OST_1d_optimization_discrete}, then OST yields a closed-form expression as follows:
    \begin{eqnarray}\label{eq:OST_1d_opt_discrete_limit}
    \hspace{-0.3em} \calOS_{\Phi, \alpha}(\mu,\nu ) \!=\! b\!\sum_{e \in E} \hspace{-0.1em} w_e \! \left| \mu(\gamma_{e}) \!-\! \nu(\gamma_{e}) \right| \!+\! \Theta |\mu(\G) \!-\! \nu(\G)|. 
\end{eqnarray}
Moreover, it is equal to the $1$-order unbalanced Sobolev transport~\citep{le2023scalable}.
\end{proposition}

The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_OST}.

\begin{proposition}[Limit case for Orlicz-EPT]\label{prop:limit_OrliczEPT}
    For $\Phi(t) = t$, and $\mu, \nu \in \calP(\G)$, then Orlicz-EPT is equal to EPT on a graph~\citep{le2023scalable}, i.e.,
    \begin{eqnarray}\label{eq:OrliczEPT_limit}
    \calOE_{\Phi}(\mu, \nu) = \mathrm{KT}(\mu, \nu).
    \end{eqnarray}    
\end{proposition}
The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_OrliczEPT}.

\begin{proposition}[Relation of OST and Orlicz-EPT]\label{prop:limit_OST_OrliczEPT}
Assume that $\Phi(t) = t$, $\omega$ is the length measure on $\G$, $\lambda \ge 0$, nonnegative weight functions $w_1, w_2$ are $b$-Lipschitz w.r.t. $d_{\G}$, $\alpha = 0$, $p = 1$. Then we have
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) \ge \calOE_{\Phi}(\mu, \nu) + \frac{b\lambda}{2}(\mu(\G) + \nu(\G)). 
\]
\end{proposition}

The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_OST_OrliczEPT}.

\paragraph{For the special cases when graph $\G$ is a tree.}

\begin{proposition}[Relation of OST and a variant of regularized EPT]\label{prop:limit_OST_dalpha}
    Under the same assumptions as in Proposition~\ref{prop:limit_OST}, and assume in addition that graph $\G$ is a tree, then we have
    \[
    \calOS_{\Phi, \alpha}(\mu,\nu ) = d_{\alpha}(\mu, \nu),
    \]
    where $d_{\alpha}$ is a variant of the regularized EPT, defined in~\citet[Equation (9)]{le2021ept}. 
\end{proposition}

The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_OST_dalpha}.

\begin{proposition}[Relation of OST and OT]\label{prop:limit_OST_OT}
Under the same assumptions as in Proposition~\ref{prop:limit_OST_dalpha}, and assume in addition that $\mu(\G) = \nu(\G)$ and $b=1$, then we have
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) = \calW_{d_{\G}}(\mu, \nu),
\]
where $\calW_{d_{\G}}$ is the standard optimal transport with graph metric ground cost $d_{\G}$.
\end{proposition}


The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_OST_OT}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Related Works and Discussions}
\label{sec:related_works}

The proposed Orlicz-Sobolev transport (OST) generalizes GST~\citep{le2024generalized} for unbalanced measures supported on a graph (see Proposition~\ref{prop:relation_OST_GST}). We emphasize that unlike OT, it is nontrivial to incorporate mass constraints for GST, since as its root, the definition of GST is steamed from the Kantorovich duality of $1$-order Wasserstein, and it optimizes the critic function  with constraints in the graph-based Orlicz-Sobolev space. Therefore, it is essential to take a detour to consider EPT problem for unbalanced measures on a graph~\citep{le2023scalable}, then leverage~\citet{CM}'s observations to derive a corresponding standard complete OT problem, and incorporate back the Orlicz geometric structure for the proposed Orlicz-EPT. We further note that \citet{CM}'s observations may not be applicable for some other certain formulations of unbalanced optimal transport (UOT) such as those in~\citet{frogner2015learning, chizat2018unbalanced, sejourne2019sinkhorn}.


Moreover, Orlicz-EPT is formulated as a two-level optimization problem (Equation~\eqref{eq:OrliczEPT}) which leads to a high-computational cost and hinders its practical applications, similar to OW for the case of balanced measures. By leveraging~\citet{le2021ept}'s observations and exploiting graph structure, we propose novel regularization for critic function within the Orlicz-Sobolev space, and develop OST. Our key result is to show that one can simply solving a univariate optimization problem (Theorem~\ref{thm:OST_computation}) for OST computation, and make it more practical for applications. 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiments}
\label{sec:experiments}

In this section, we illustrate that the computation of Orlicz-EPT with $N$-function $\Phi$ is very costly. Especially, the Orlicz-Sobolev transport (OST) is several-order faster than Orlicz-EPT. Following the setup simulations in~\citet{le2023scalable}, we evaluate OST for unbalanced measures supported a given graph, and show preliminary evidences on its advantages for document classification and TDA. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Document classification.} Following~\citet{le2023scalable}, we use four document datasets: \texttt{TWITTER}, \texttt{RECIPE}, \texttt{CLASSIC}, and \texttt{AMAZON}. We summarize these dataset characteristics in Figure~\ref{fg:DOC_LLE_10K}. By regarding each word in a document as a support with a unit mass, we represent each document as a nonnegative measure. Consequently, the representations of documents with different lengths are \emph{measures with different total mass}. We apply the same word embedding procedure in~\citet{le2023scalable} to map words into vectors in~$\R^{300}$ (i.e., word2vec~\citep{mikolov2013distributed} pretrained on Google News).

% \begin{table}[]
\begin{wraptable}{r}{0.22\textwidth}
\vspace{-14pt}
\caption{The number of pairs for SVM.}
\label{tb:numpairs}
    \centering
\begin{tabular}{|l|c|}%{|l|l|}
\hline
Datasets & \#pairs \\ \hline
\texttt{TWITTER}  & 4394432 \\ \hline
\texttt{RECIPE}   & 8687560      \\ \hline
\texttt{CLASSIC}  & 22890777       \\ \hline
\texttt{AMAZON}   & 29117200      \\ \hline
\texttt{Orbit}    & 11373250   \\ \hline
\texttt{MPEG7}    & 18130     \\ \hline
\end{tabular}
\vspace{-10pt}
\end{wraptable}
% \end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{TDA.}  As in \citet{le2023scalable}, we consider orbit recognition on \texttt{Orbit} dataset~\citep{adams2017persistence}, and object shape classification on \texttt{MPEG7} dataset~\citep{latecki2000shape}. We summarize these dataset characteristics in Figure~\ref{fg:TDA_LLE_10K1K}. We use persistence diagrams (PD)\footnote{PD are multisets of data points in $\R^2$, containing the birth and death time respectively of topological features (e.g., connected component, ring, or cavity), extracted by algebraic topology methods (e.g., persistence homology)~\citep{edelsbrunner2008persistent}.} to represent objects of interest. We then consider each $2$-dimensional data point in PD as a support with a unit-mass, and represent PD as nonnegative measures. As a result, PD having different numbers of topological features are presented as \emph{measures with different total mass}.\footnote{In our setup simulations, objects of interests are represented as \emph{nonnegative measures}, as considered in~\citet{le2023scalable}. We distinguish it with the setup in~\citet{le2024generalized}, where objects of interest are represented as \emph{probability measures}.}

\textbf{Graph.} Following~\citet{le2023scalable}, we use the graphs $\G_{\text{Log}}$\footnote{Experimental results for graph $\G_{\text{Log}}$ are placed in \S\ref{app:subsec:further_experimental_results}.} and $\G_{\text{Sqrt}}$~\citep[\S5]{le2022st} for our simulations, which empirically satisfy the assumptions in \S\ref{sec:preliminaries}. Additionally, we set $M=10^4$ for the number of nodes for these graphs, except experiments on \texttt{MPEG7} dataset with $M=10^3$ due to its small size.

\textbf{$N$-function.} Following~\citet{le2024generalized}, we consider two $N$-functions: $\Phi_1(t) = \exp(t) - t - 1$, and $\Phi_2(t) = \exp(t^2) - 1$, and the limit case: $\Phi_0(t) = t$.

\textbf{Parameters.} For simplicity, we follow the same setup as in~\citet{le2023scalable}. We set $\lambda = b = 1$, $\alpha=0$, and consider the weight functions $w_1(x) \!=\! w_2(x) \!=\! a_1 d_{\G}(z_0, x) + a_0$ where $a_1\!=\! b$ and $a_0\!=\!1$. The entropic regularization $\varepsilon$ is chosen $\left\{0.01, 0.1, 1, 10\right\}$, e.g., via cross validation.

\textbf{Optimization algorithm.} For OST computation, we apply a second-order method, e.g., \texttt{fmincon} Trust Region Reflective solver in MATLAB, for solving the \emph{univariate} optimization problem. 


%\citet{Cuturi-2013-Sinkhorn, ref:le2019tree}
\textbf{SVM classification.} For document classification and TDA, we use support vector machine (SVM) with kernels $\exp(-\bar{t} \bar{d}(\cdot, \cdot))$, where $\bar{d}$ is a distance/discrepancy (e.g., OST, Orlicz-EPT) for unbalanced measures supported on a graph, and $\bar{t} > 0$. Additionally, following~\citet{Cuturi-2013-Sinkhorn}, we regularize Gram matrices by adding a sufficiently large diagonal term for indefinite kernels. In Table~\ref{tb:numpairs}, we summarize the number of pairs which we need to evaluate distances/discrepancies for SVM in each run to illustrate the experimental scale. 

\textbf{Set up.} We randomly split each dataset into $70\%/30\%$ for training and test, and use $10$ repeats. Basically, we choose hyper-parameters via cross validation. More concretely, we choose kernel hyperparameter from $\{1/q_{s}, 0.5/q_{s}, 0.2/q_{s}\}$ with $s = 10, 20, \dotsc, 90$, where $q_s$ is the $s\%$ quantile of a subset of distances observed on a training set; SVM regularization hyperparameter from $\left\{0.01, 0.1, 1, 10\right\}$; root node $z_0$ from a random $10$-root-node subset of $V$ in graph $\G$. We note that reported time consumption includes all preprocessing procedures, e.g., preprocessing for $\gamma_e$ for OST.


%($M=10^3$)
% with different $\Phi(\cdot)$ functions on $10^4$ pairs of measures supported 
\begin{figure}[h]
%\begin{wrapfigure}{r}{0.22\textwidth}
%  \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.5\textwidth]{Fig/Time_OST_OrliczEPT_10K_SLE_AMAZON_opt.pdf}
  \end{center}
%  \vspace{-14pt}
  \caption{Time consumption on graph $\G_{\text{Sqrt}}$.}
  \label{fg:Time_OST_OrliczEPT_10K_SLE}
% \vspace{-14pt}
\end{figure}
%\end{wrapfigure}

% ----------------------------------



% ($M=10^4$)
\begin{figure*}[ht]
%\begin{wrapfigure}{r}{0.22\textwidth}
 % \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.95\textwidth]{Fig/OST_DOC_10K_SLE_opt.pdf}
  \end{center}
%  \vspace{-14pt}
  \caption{Document classification on graph $\G_{\text{Sqrt}}$. For each dataset, the numbers in the parenthesis are respectively the number of classes; the number of documents; and the maximum number of unique words for each document.}
  \label{fg:DOC_SLE_10K}
% \vspace{-10pt}
\end{figure*}
%\end{wrapfigure}


% ($M=10^4$ for \texttt{Orbit}, and $M=10^3$ for \text{MPEG7})
\begin{figure}[h]
%\begin{wrapfigure}{r}{0.22\textwidth}
%  \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.55\textwidth]{Fig/OST_TDA_10K1K_SLE_opt.pdf}
  \end{center}
%  \vspace{-14pt}
  \caption{TDA on graph $\G_{\text{Sqrt}}$. For each dataset, the numbers in the parenthesis are respectively the number of PD; and the maximum number of points in PD.}
  \label{fg:TDA_SLE_10K1K}
% \vspace{-16pt}
\end{figure}
%\end{wrapfigure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computation}\label{subsec:computation}

We compare the time consumption of OST and Orlicz-EPT with $N$-functions $\Phi_1, \Phi_2$, and the limit case $\Phi_0$.

\textbf{Set up.} We randomly sample $10^4$ pairs of nonnegative measures on \texttt{AMAZON} dataset for evaluation. We $M=10^3$ for graphs, and $\varepsilon = 0.1$ for Orlicz-EPT.

\textbf{Results.} In Figure~\ref{fg:Time_OST_OrliczEPT_10K_SLE}, we illustrate the time consumptions on $\G_{\text{Sqrt}}$. OST is several-order faster than Orlicz-EPT, i.e., at least $250\times, 13800\times, 11200\times$ for $\Phi_0, \Phi_1, \Phi_2$ respectively. Notably, for $N$-functions $\Phi_1, \Phi_2$, Orlicz-EPT takes at least \emph{$2.6$ days}, while OST takes less than \emph{$21$ seconds}. Note that for the limit case $\Phi_0$, Orlicz-EPT is equal to EPT on a graph (Proposition~\ref{prop:limit_OrliczEPT}), and OST admits a closed-form expression (Proposition~\ref{prop:limit_OST}). Consequently, Orlicz-EPT and OST with $\Phi_0$ is more computationally efficient than those with $\Phi_1, \Phi_2$. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Document classification}

\textbf{Set up.} We carry out OST with $\Phi_0, \Phi_1, \Phi_2$ (\S\ref{subsec:computation}), and denote them as OST-$\Phi_i$ for $i = 0, 1, 2$. We exclude Orlicz-EPT due to their heavy computations (\S\ref{subsec:computation}). Additionally, following~\citet{le2023scalable}, we consider unbalanced optimal transport (UOT)~\citep{frogner2015learning, sejourne2019sinkhorn} with ground cost $d_{\G}$, and special cases with tree-structure graph. More concretely, we randomly sample a tree from the given graph $\G$, then consider the regularized EPT and $d_{0}$, denoted as $d_0$-Tree and regEPT-Tree, for unbalanced measures with the sampled tree~\citep[Proposition 3.8, and Equation (9) respectively]{le2021ept}.  


\textbf{Results.} In Figure~\ref{fg:DOC_SLE_10K}, we show SVM results and time consumptions of kernels on graph $\G_{\text{Sqrt}}$. The performances of OST with all $\Phi$ functions are comparable to UOT, but the computation of UOT is more costly than OST. Additionally, OST outperforms $d_0$-Tree and regEPT-Tree. However, the computations of OST-$\Phi_1$, OST-$\Phi_2$ are more expensive while the computation of OST-$\Phi_0$ is comparative to those fast-computational variants of UOT on tree (i.e., $d_0$-Tree and regEPT-Tree). Moreover, OST-$\Phi_1$ and OST-$\Phi_2$ improve performances of OST-$\Phi_0$, but their computational time is several-order higher. It may imply that Orlicz geometric structure in OST may be helpful for document classification. UOT performs well on \texttt{RECIPE}, but worse on $\texttt{TWITTER}$ which agrees with observations in~\citet{le2023scalable}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Topological Data Analysis}

\textbf{Set up.} Similarly, we also evaluate OST-$\Phi_0$, OST-$\Phi_1$, OST-$\Phi_2$, UOT, $d_0$-Tree, and regEPT-Tree for TDA.

\textbf{Results.} In Figure~\ref{fg:TDA_SLE_10K1K}, we illustrate SVM results and time consumptions of kernels on graph $\G_{\text{Sqrt}}$. Performances of OST with all $\Phi$ functions compare favorably with other transport distance approaches. Especially, performances of OST-$\Phi_1$ and OST-$\Phi_2$ compare favorably with those of OST-$\Phi_0$, but it comes with higher computational cost (i.e., OST-$\Phi_0$ has a closed-form expression for a fast computation (Proposition~\ref{prop:limit_OST})). Therefore, Orlicz geometric structure is also helpful for TDA.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion}
\label{sec:conclusion}

In this work, we propose novel approaches to extend generalized Sobolev transport, i.e., a scalable variant of Orlicz-Wasserstein, for nonnegative measures on a graph. More specifically, based on entropy partial transport (EPT) for unbalanced measures, we leverage~\citet{CM}'s observations to develop Orlicz-EPT. Furthermore, by exploiting a special family of convex functions (i.e., the set of $N$-functions) and geometric structure of the graph-based Orlicz-Sobolev space, we propose Orlicz-Sobolev transport (OST) with efficient computation. Note that it suffices to compute OST by simply solving a univariate optimization problem while one needs to solve a complex two-level optimization problem to compute Orlicz-EPT.

%%%%%%%%%%%%%%%
%\newpage

%% Acknowledgements should only appear in the accepted version.
%\section*{Acknowledgements}
%
%\textbf{Do not} include acknowledgements in the initial version of
%the paper submitted for blind review.
%
%If a paper is accepted, the final camera-ready version can (and
%usually should) include acknowledgements.  Such acknowledgements
%should be placed at the end of the section, in an unnumbered section
%that does not count towards the paper page limit. Typically, this will 
%include thanks to reviewers who gave useful comments, to colleagues 
%who contributed to the ideas, and to funding agencies and corporate 
%sponsors that provided financial support.

%\newpage
%\clearpage

\section*{Impact Statement}

% This paper presents work whose goal is to advance the field of Machine Learning. There are many potential societal consequences of our work, none which we feel must be specifically highlighted here.

The paper proposes novel approaches for optimal transport problem with Orlicz geometric structure for unbalanced measures on a graph. Especially, our proposed Orlicz-Sobolev transport can be computed efficiently by simply solving a univariate optimization problem, which paves a way for its usages in practical applications, especially for large-scale settings. To our knowledge, there are no foresee potential societal consequences of our work.

% Authors are \textbf{required} to include a statement of the potential 
% broader impact of their work, including its ethical aspects and future 
% societal consequences. This statement should be in an unnumbered 
% section at the end of the paper (co-located with Acknowledgements -- 
% the two may appear in either order, but both must be before References), 
% and does not count toward the paper page limit. In many cases, where 
% the ethical impacts and expected societal implications are those that 
% are well established when advancing the field of Machine Learning, 
% substantial discussion is not required, and a simple statement such 
% as the following will suffice:

% ``This paper presents work whose goal is to advance the field of 
% Machine Learning. There are many potential societal consequences 
% of our work, none which we feel must be specifically highlighted here.''

% The above statement can be used verbatim in such cases, but we 
% encourage authors to think about whether there is content which does 
% warrant further discussion, as this statement will be apparent if the 
% paper is later flagged for ethics review.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\bibliographystyle{apalike}

\bibliographystyle{icml2024}
\bibliography{bibEPT21, bibSobolev22}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix
\onecolumn

%\renewcommand\thesection{\Alph{section}}
%\renewcommand{\theequation}{A.\arabic{equation}}
%\renewcommand{\thefigure}{A.\arabic{figure}}
%\renewcommand{\thetable}{A.\arabic{table}}
	
\begin{center}
{\bf{\Large{\textit{Supplement to}  ``Sobolev-Orlicz Transport for Unbalanced Measures on a Graph"}}}
\end{center}

In this appendix, we describe detailed proofs in \S\ref{appsec:detailed_proofs}. Further results and discussions are placed in \S\ref{appsec:further_results_discussions}.

\paragraph{Notations.} The indicator function $\bf{1}$ of a set $X$ is defined as follows:
\begin{equation}\label{eq:Indicator}
{\bf{1}}_{X}(x) = 
  \begin{cases} 
   1 & \text{if } x\in X \\
   0 & \text{otherwise}.
  \end{cases}
\end{equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Detailed Proofs}\label{appsec:detailed_proofs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:monotonicity_OT}}\label{appsubsec:Monotonicity_OT}
\begin{proof}
    From the definition, we have
    \begin{equation}
\mathcal{A}(t; \hat \mu, \hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t}\right) \dd\tilde\gamma(x, y).
\end{equation}
Let $0 < t_1 \le t_2 < \infty$, denote $\widetilde{\gamma^*_{t_1}}, \widetilde{\gamma^*_{t_2}}$ as the optimal transport plans of $\mathcal{A}(t_1; \hat \mu, \hat \nu), \mathcal{A}(t_2; \hat \mu, \hat \nu)$ respectively. Then, we have
\begin{align*}
    \mathcal{A}(t_2; \hat \mu, \hat \nu) &=  \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_2}\right) \dd\widetilde{\gamma^*_{t_2}}(x, y) \\
    &\le \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_2}\right) \dd\widetilde{\gamma^*_{t_1}}(x, y) \\
    &\le \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_1}\right) \dd\widetilde{\gamma^*_{t_1}}(x, y) \\
    &= \mathcal{A}(t_1; \hat \mu, \hat \nu),
\end{align*}
where the second inequality is due to the strictly increasing property of the $N$-function $\Phi$. 

Hence, the proof is completed.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:monotonicity_regOT}}\label{appsubsec:Monotonicity_regOT}

\begin{proof}
    
The result is followed by the same reasoning as in the proof for Proposition~\ref{prop:monotonicity_OT} where we leverage the strictly increasing property of the $N$-function $\Phi$ and the optimal transport plans for $\mathcal{A}_{\varepsilon}$. 

More concretely, let $0 < t_1 \le t_2 < \infty$, denote $\widetilde{\gamma^*_{t_1}}, \widetilde{\gamma^*_{t_2}}$ as the optimal transport plans of $\mathcal{A}_{\varepsilon}(t_1; \hat \mu, \hat \nu), \mathcal{A}_{\varepsilon}(t_2; \hat \mu, \hat \nu)$ respectively. Then, we have
\begin{align*}
    \mathcal{A}_{\varepsilon}(t_2; \hat \mu, \hat \nu) &=  \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_2}\right) \dd\widetilde{\gamma^*_{t_2}}(x, y) - \varepsilon H(\widetilde{\gamma^*_{t_2}}) \\
    &\le \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_2}\right) \dd\widetilde{\gamma^*_{t_1}}(x, y) - \varepsilon H(\widetilde{\gamma^*_{t_1}}) \\
    &\le \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t_1}\right) \dd\widetilde{\gamma^*_{t_1}}(x, y) - \varepsilon H(\widetilde{\gamma^*_{t_1}}) \\
    &= \mathcal{A}_{\varepsilon}(t_1; \hat \mu, \hat \nu).
\end{align*}
Hence, the proof is completed.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limits_regOT}}\label{appsubsec:limits_regOT}

\begin{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{For lower limit.} From the definition in Equation~\eqref{eq:regOW_t}, we have
\begin{equation*}
\mathcal{A}_{\varepsilon}\left(\frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}; \hat \mu, \hat \nu \right) = \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \left[ \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{\frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}}\right) \dd\tilde\gamma(x, y) - \varepsilon H(\tilde\gamma) \right].
\end{equation*}
Additionally, since $N$-function $\Phi$ is strictly increasing, we have
\begin{equation*}
\Phi\left(\frac{\hat{c}(x, y)}{\frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}}\right) \le \Phi(\Phi^{-1}(1 + \varepsilon)) = 1 + \varepsilon.
\end{equation*}
For convenience, given any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$, we define
\begin{equation}\label{eq:entropy_def}
\bar{\mathcal{H}}(\gamma) := -\int_{\hat\G \times \hat \G} \log\tilde\gamma(x, y)\dd\tilde\gamma(x, y).
\end{equation}

From the definition of $H$ in Proposition~\ref{prop:monotonicity_regOT}, for any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$, we have
\begin{equation*}
    H(\tilde \gamma) = -\int_{\hat\G \times \hat \G} \log\tilde\gamma(x, y)\dd\tilde\gamma(x, y) + 1 \ge 1,
\end{equation*}
where the inequality is followed by using \citep[Lemma 2.1.1]{cover1999elements} (i.e., $\bar{\mathcal{H}}(\gamma) \ge 0$). 

Thus, we have
\begin{equation}
\mathcal{A}_{\varepsilon}\left(\frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}; \hat \mu, \hat \nu \right) \le (1 + \varepsilon) - \varepsilon \le 1.
\end{equation}
The proof for the lower limit is completed.

%\[\]
%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{For upper limit.} For any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$, we have
\begin{align*}
\mathcal{T} &:= \int_{\hat \G \times \hat \G} \Phi\left(\frac{\hat{c}(x, y)}{t}\right) \dd\tilde\gamma(x, y) - \varepsilon H(\tilde\gamma) \\
&\ge \Phi \left( \int_{\hat \G \times \hat \G} \left(\frac{\hat{c}(x, y)}{t}\right) \dd\tilde\gamma(x, y)\right) - \varepsilon H(\tilde\gamma) \\
&= \Phi \left( \frac{1}{t} \int_{\hat \G \times \hat \G} \hat{c}(x, y) \dd\tilde\gamma(x, y) \right) - \varepsilon H(\tilde\gamma),
\end{align*}
where we use the Jensen's inequality for the second row.

Additionally, for any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$, we have
\begin{align*}
 H(\tilde\gamma) &= \bar{\mathcal{H}}(\tilde\gamma) + 1  \\
 &\le \bar{\mathcal{H}}(\hat\mu) + \bar{\mathcal{H}}(\hat\nu) + 1 \\
 &= H(\hat \mu) + H(\hat \nu) - 1,
\end{align*}
where we apply \citep{cover1999elements}[Theorem 2.2.1 and Theorem 2.6.5] for the inequality in the second row.

Thus, we have
\begin{equation}\label{eq:upperbound_objFunc_OT}
\mathcal{T} \ge \Phi \left( \frac{1}{t} \int_{\hat \G \times \hat \G} \hat{c}(x, y) \dd\tilde\gamma(x, y) \right) - \varepsilon \left( H(\hat \mu) + H(\hat \nu) - 1 \right)
\end{equation}
Taking the infimum of $\tilde \gamma$ in $\Pi(\hat \mu, \hat \nu)$, we obtain
\begin{align}
\mathcal{A}_{\varepsilon}\left(t; \hat \mu, \hat \nu \right) \ge \Phi \left( \frac{1}{t} \mathcal{W}_{\hat c}(\hat\mu, \hat\nu) \right) - \varepsilon \left( H(\hat \mu) + H(\hat \nu) - 1 \right)
\end{align}

Therefore, by choosing $t = \frac{\calW_{\hat c}(\hat \mu, \hat \nu)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}$, then we have
\[
\mathcal{A}_{\varepsilon} \! \left(\frac{\calW_{\hat c}(\hat \mu, \hat \nu)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}; \hat \mu, \hat \nu\right) \ge 1.
\]
The proof for the upper limit is completed.

\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Theorem~\ref{thm:OST_computation}}\label{appsubsec:thm:OST_computation}

\begin{proof}
    For $f \in \OrliczSobolevPhi(\G, \omega)$, as in Equation~\eqref{eq:OrliczSobolevFunction}, we have
    \[
    f(x) = f(z_0) + \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y),  \quad \forall x\in \G.
    \]
    Thus, following the Definition~\ref{def:OST}, we have
    \begin{eqnarray}%\label{equ:OST}
    \calOS_{\Phi, \alpha}(\mu,\nu ) = \sup_{f(z_0) \in \calI_{\alpha}} f(z_0) (\mu(\G) - \nu(\G)) + \sup_{f \in \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \le b} \int_{\G} \left( \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y) \right) \left(\mu(x) - \nu(x)\right) \dd x \nonumber
    \end{eqnarray}
    Thus, we can rewrite $\calOS_{\Phi, \alpha}(\mu,\nu )$ as follows:
    \begin{align}\label{equ:OST_tmp1}
    \calOS_{\Phi, \alpha}(\mu,\nu ) &= \sup_{f \in \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \le b} \int_{\G} \left( \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y) \right) \left(\mu(x) - \nu(x)\right) \dd x + \Theta |\mu(\G)-\nu(\G)| \nonumber \\
    &= \sup_{f \in \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \le b} \int_{\G} \left( \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y) \right) \left(\mu(x) - \nu(x)\right) \dd x + \Theta |\mu(\G)-\nu(\G)|,
    \end{align}
    where recall that $\Theta$ is defined in Equation~\eqref{def:Theta}. 
    
    Additionally, we define the indicator function of the shortest path $[z_0,x]$ as follows:
\begin{equation}\label{eq:Indicator}
{\bf{1}}_{[z_0,x]}(y) = 
  \begin{cases} 
   1 & \text{if } y\in [z_0,x] \\
   0 & \text{otherwise}.
  \end{cases}
\end{equation}
We rewrite the objective function for the first term of $\calOS_{\Phi, \alpha}(\mu,\nu )$ in Equation~\eqref{equ:OST_tmp1} as follows:
\begin{align}
    \int_{\G} \left( \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y) \right) \left(\mu(x) - \nu(x)\right) \dd x \nonumber &= \int_\G  \int_{\G}  {\bf{1}}_{[z_0,x]}(y) \, f'(y) \left(\mu(x) - \nu(x)\right) \omega(\mathrm{d}y) \mathrm{d}x \\
    &= \int_\G  \left[ \int_{\G}  {\bf{1}}_{[z_0,x]}(y) \,  \left(\mu(x) - \nu(x)\right)  \mathrm{d}x \right] f'(y)\omega(\mathrm{d}y) \\
    &= \int_\G  \left[ \mu(\Lambda(y)) -  \nu(\Lambda(y)) \right] f'(y)\omega(\mathrm{d}y),
\end{align}
where we apply the Fubini's theorem to interchange the order of integration for the second row, and use the definition of $\Lambda$ in Equation~\eqref{sub-graph} for the last row. Consequently, following~\citet[Proposition 10, pp.81]{rao1991theory} and notice that $\norm{bf'}_{L_{\Psi}} = b \norm{f'}_{L_{\Psi}}$ for $b>0$, we have
\begin{align}\label{eq:OST_1st_term}
    & \hspace{-8em} \sup_{f \in \OrliczSobolevPsi(\G, \omega), \norm{f'}_{L_{\Psi}} \le b} \int_{\G} \left( \int_{[z_0,x]} f'(y) \omega(\mathrm{d}y) \right) \left(\mu(x) - \nu(x)\right) \dd x \nonumber \\
    &= \sup_{f \in \OrliczSobolevPsi(\G, \omega), \norm{\frac{1}{b}f'}_{L_{\Psi}} \le 1} \int_\G  b \left[ \mu(\Lambda(y)) -  \nu(\Lambda(y)) \right] \left[\frac{1}{b}f'(y) \right]\omega(\mathrm{d}y) \nonumber \\
    &= \norm{\tilde{f}}_{\Phi},
\end{align}
where $\tilde{f}(x) := b\left(\mu(\Lambda(x)) - \nu(\Lambda(x))\right), \forall x \in \G$, and we write $\norm{\tilde{f}}_{\Phi}$ for the Orlicz norm of $\tilde{f}$ with $N$-function $\Phi$~\citep[Definition~2, pp.58]{rao1991theory} (i.e., see a review in Equation~\eqref{eq:OrliczNorm} in \S\ref{appsubsec:Orlicz_functions}). 


Moreover, following~\citet[Theorem 13, pp.69]{rao1991theory}, we also have 
\begin{equation}\label{eq:Orlicz_Amemiyanorm}
\|\tilde{f}\|_{\Phi}  =  
\inf_{k > 0} \frac{1}{k}\left( 1 + \int_{\G} \Phi\left(k \left| \tilde{f}(x) \right|\right) \omega(\text{d}x) \right).
\end{equation}

Hence, putting these Equations~\eqref{equ:OST_tmp1},~\eqref{eq:OST_1st_term},~\eqref{eq:Orlicz_Amemiyanorm} together, we have
\begin{eqnarray}
    \calOS_{\Phi, \alpha}(\mu,\nu ) = \inf_{k > 0} \frac{1}{k}\left( 1 + \int_{\G} \Phi\left(k b \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right) + \Theta |\mu(\G)-\nu(\G)|. 
\end{eqnarray}
The proof is completed.

\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Corollary~\ref{cor:OST_1d_optimization_discrete}}\label{app:subsec:cor:OST_1d_optimization_discrete}
\begin{proof}
Following Theorem~\ref{thm:OST_computation}, we have
\begin{eqnarray}\label{eq:fromTheorem_OST_computation}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right), 
\end{eqnarray}

We next follow the same reasoning as in~\citet[Corollary 3.4]{le2024generalized} to compute the integral in~\eqref{eq:fromTheorem_OST_computation} by an explicit expression. 

For an edge $e$ between two nodes $u, v \in V$ of graph $\G$, then $u, v$ are also two data points in $\R^n$ as $\G$ is a physical graph. For convenience, denote $\langle u,  v\rangle$ as the line segment in $\R^n$ connecting the two data points $u, v$, and $(u, v)$ as the same line segment but without its two end-points. Therefore, we have $e=\langle u,v\rangle$. 

Additionally, for any $x\in (u,v)$, we have $y\in \G\setminus (u,v)$ belongs to $\Lambda(x)$ if and only if $y\in \gamma_e$ (see Equation~\eqref{sub-graph} for the definitions of $\Lambda(x)$ and $\gamma_e$). Thus, we have 
\begin{equation}\label{eq:relation_Lambda_gamma}
\Lambda(x)\setminus (u,v) =\gamma_e.
\end{equation}

Consider the case where $\omega$ is the length measure of graph $\G$, we have $\omega(\{x\})= 0$ for every $x\in\G$. Consequently,
\begin{equation}\label{eq:int_sum_edges}
\int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) = \sum_{e=\langle u,v\rangle\in E}   \int_{(u,v)} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x).
\end{equation}

Additionally, for measures $\mu, \nu$ supported on nodes $V$ of $\G$, and using Equation~\eqref{eq:relation_Lambda_gamma}, then we have
\[
\left| \mu(\Lambda(x)) -  \nu(\Lambda(x)) \right| = \left| \mu(\Lambda(x)\setminus (u,v)) -  \nu(\Lambda(x)\setminus (u,v)) \right| = \left| \mu(\gamma_e) - \nu(\gamma_e) \right|,
\]
for every edge $e=\langle u,v\rangle\in E$ of graph $\G$.

Therefore, we can rewrite the identity~\eqref{eq:int_sum_edges} as follows:
\begin{align*}
\int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) &= \sum_{e=\langle u,v\rangle\in E}   \int_{(u,v)} \hspace{-0.3em} \Phi\left(kb \left| \mu(\gamma_e) - \nu(\gamma_e) \right|\right) \omega(\text{d}x). \\
&= \sum_{e=\langle u,v\rangle\in E} \Phi\left(kb \left| \mu(\gamma_e) - \nu(\gamma_e) \right|\right) \int_{(u,v)} \omega(\text{d}x)\\
&= \sum_{e \in E} w_e \, \Phi\left(kb \left| \mu(\gamma_e) - \nu(\gamma_e) \right|\right). \label{app:eq:sum_edge_on_graph}
\end{align*}
By combining it with \eqref{eq:fromTheorem_OST_computation}, we obtain
\begin{equation*}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + \sum_{e \in E} w_e \, \Phi\left(kb \left| \mu(\gamma_e) - \nu(\gamma_e) \right|\right).
\end{equation*}
Hence, the proof is completed. 
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:OST_geodesic_space}}\label{app:subsec:prop:OST_geodesic_space}

\begin{proof}
%------------------------
i) The result is directly followed from Equation~\eqref{equ:OST} in Theorem~\ref{thm:OST_computation} with the observation that $|\mu(\G)-\nu(\G)| = |(\mu + \sigma)(\G)-(\nu + \sigma)(\G)|$ and $\left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right| = \left| (\mu + \sigma)(\Lambda(x)) - (\nu + \sigma)(\Lambda(x)) \right|$. 

%------------------------
ii) From Definition~\ref{def:OST}, choosing $f=0$, then $f \in \mathbb{U}_{\Psi, \alpha}$, and for any $\mu, \nu \in \calP(\G)$, we have that 
\[
\calOS_{\Phi, \alpha}(\mu,\nu) \ge 0.
\]
%%%%%%%%%

Assume that $\calOS_{\Phi, \alpha}(\mu,\nu)(\mu,\nu)=0$. Then, from Theorem~\ref{thm:OST_computation}, we obtain
\[
 \Theta |\mu(\G)-\nu(\G)| + 
    \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right)  = 0.
\]
Additionally, for $0\leq \alpha< \frac{b\lambda}{2} +\min\{w_1(z_0), w_2(z_0)\}$, we have $\Theta > 0$. Consequently, we must have 
\[
\mu(\G) =\nu(\G)  \quad\mbox{and}\quad  \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \int_{\G} \hspace{-0.3em} \Phi\left(kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right)
 =0.   
 \]
Thus, $\mu(\Lambda(x)) = \nu(\Lambda(x)), \forall x\in\G$. By applying the Lemma A.9 in~\citet{le2023scalable},\footnote{In \S\ref{appsubsec:UST} (Lemma~\ref{lem:equal-measure}), we review the Lemma A.9 in~\citet{le2023scalable}.}  it leads to $\mu=\nu$. 

Moreover, from Definition~\ref{def:OST}, we also have $\calOS_{\Phi, \alpha}(\mu,\mu) = 0$.


%%%%%%%%%
Furthermore, for any feasible function $f \in \mathbb{U}_{\Psi, \alpha}$, we have
\begin{align*}
\int_\G f(x) \mu(\mathrm{d}x) - \int_\G f(x) \nu(\mathrm{d}x) &= \Big[ \int_\G f(x) \mu(\mathrm{d}x) - \int_\G f(x) \sigma(\mathrm{d}x)\Big]  + \Big[\int_\G f(x) \sigma(\mathrm{d}x) - \int_\G f(x) \nu(\mathrm{d}x)\Big]\\
&\leq \calOS_{\Phi, \alpha}(\mu,\sigma ) + \calOS_{\Phi, \alpha}(\sigma,\nu ).
\end{align*}
Therefore, by taking the infimum for $f \in \mathbb{U}_{\Psi, \alpha}$, it implies that
\[
\calOS_{\Phi, \alpha}(\mu,\nu )\leq \calOS_{\Phi, \alpha}(\mu,\sigma ) + \calOS_{\Phi, \alpha}(\sigma,\nu ).
\]
Hence, $\calOS_{\Phi, \alpha}$ satisfies the triangle inequality.

%------------------------
iii) With an additional assumption $w_1(z_0) = w_2(z_0)$, then for any function $f \in \mathbb{U}_{\Psi, \alpha}$, we also have $(-f) \in \mathbb{U}_{\Psi, \alpha}$.

Therefore, from Definition~\ref{def:OST}, we obtain $\calOS_{\Phi, \alpha}(\mu,\nu ) = \calOS_{\Phi, \alpha}(\nu,\mu)$. 

Thus, together with results in ii), we have $\calOS_{\Phi, \alpha}$ is a metric.
 


% Its completeness follows from \cite[Proposition 4]{P1}.  As a complete metric space, it is well known that $(\calP(\G), \mathrm{US}_p^\alpha)$ is a geodesic space if and only if for every $\mu,\nu \in\calP(\G)$ there exists $\sigma\in \calP(\G)$ such that 
% \[
% \mathrm{US}_p^\alpha(\mu,\sigma)= \mathrm{US}_p^\alpha(\nu,\sigma) =\frac12 \mathrm{US}_p^\alpha(\mu,\nu).
% \]
% To verify the latter, take $\sigma :=\frac{\mu +\nu }{2}$. Then using Definition~\ref{def:discrepancy}  in the main text, we  obtain 
% \[
% \mathrm{US}_p^\alpha(\mu,\sigma)= \frac12 \sup_{f\in \mathbb U_{p'}^{\alpha} } \int_\G f(\mu-\nu) = \frac12 \mathrm{US}_p^\alpha(\mu,\nu)
% \]
% and
% \[
% \mathrm{US}_p^\alpha(\nu,\sigma)= \frac12 \sup_{f\in \mathbb U_{p'}^{\alpha}} \int_\G f(\nu-\mu) = \frac12 \mathrm{US}_p^\alpha(\nu,\mu)= \frac12 \mathrm{US}_p^\alpha(\mu,\nu).
% \]

\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:relation_OST_GST}}\label{app:subsec:prop:relation_OST_GST}

\begin{proof}
    For $\mu(\G) = \nu(\G)$ and $b = 1$, then following Theorem~\ref{thm:OST_computation} for OST and the result in~\citet[Theorem 3.3]{le2024generalized} for GST, we have
    \[
    \calOS_{\Phi, \alpha}(\mu,\nu) = \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \int_{\G} \hspace{-0.3em} \Phi\left(k \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|\right) \omega(\text{d}x) \right) =  \mathcal{GS}_{\Phi}(\mu,\nu).
    \]
\end{proof}
The proof is completed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:relation_OST_ST}}\label{app:subsec:prop:relation_OST_ST}

\begin{proof}
For $\mu(\G) = \nu(\G)$, $b=1$, by applying Proposition~\ref{prop:relation_OST_GST}, we have
\begin{equation}\label{eq:OST-GST}
\calOS_{\Phi, \alpha}(\mu,\nu) =  \mathcal{GS}_{\Phi}(\mu,\nu),
\end{equation}
where we recall that $\mathcal{GS}_{\Phi}$ is the GST for balanced measures on a graph.

Additionally, for $1 < p < \infty$ and $N$-function $\Phi(t) = \frac{(p-1)^{p-1}}{p^p} t^p$, by leveraging the result in~\citet[Proposition 4.4]{le2024generalized} for the connection between GST and ST, we have
\begin{equation}\label{eq:GST-ST}
\mathcal{GS}_{\Phi}(\mu,\nu) = \calS_{p}(\mu,\nu).
\end{equation}
Therefore, by combining Equations~\eqref{eq:OST-GST} and~\eqref{eq:GST-ST}, we obtain
\[
\calOS_{\Phi, \alpha}(\mu,\nu) = \calS_{p}(\mu,\nu).
\]
The proof is completed.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:relation_OST_UST}}\label{app:subsec:prop:relation_OST_UST}

\begin{proof}
For $N$-function $\Phi(t) = \frac{(p-1)^{p-1}}{p^p} t^p$ with $1 < p < \infty$, from Theorem~\ref{thm:OST_computation}, we have
\begin{eqnarray}\label{eq:limT}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k}\left( 1 + \int_{\G} \frac{(p-1)^{p-1}}{p^p} k^p b^p \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p  \omega(\text{d}x) \right). 
\end{eqnarray}

For convenience, let $T(k) := \frac{1}{k} + \frac{(p-1)^{p-1}}{p^p} k^{p-1} b^p \int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)$ for $k>0$, i.e., the objective function of the univariate optimization problem for $\calOS_{\Phi, \alpha}$.

We next consider two cases:

{\bf Case 1:} $\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x) = 0$. Then, we have
\[
\inf_{k > 0} T(k) = \inf_{k > 0} \frac{1}{k} = 0.
\]
Consequently, from Equation~\eqref{eq:limT}, we have
\begin{align*}
\calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| = b\, \Big[\int_{\G} | \mu(\Lambda(x)) -  \nu(\Lambda(x))|^p \, \omega(\dd x)\Big]^\frac{1}{p} + \, \Theta |\mu(\G)-\nu(\G)| = \mathcal{US}_{p, \alpha}(\mu, \nu).
\end{align*}

{\bf Case 2:} $\int_{\G} \left| h(x) \right|^p \omega(\text{d}x) \neq 0$.
Then, we have  
\[
\lim_{k\to 0^+} T(k) = \lim_{k\to +\infty} T(k) = +\infty.
\]
Therefore, Equation~\eqref{eq:limT}, we have
\begin{align}\label{eq:OST_k0}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + T(k_0),
\end{align}
for some finite number $k_0 \in (0, +\infty)$ satisfying $T'(k_0) =0$.

Additionally, we have
\[
T'(k)= -\frac{1}{k^2} + \Big(\frac{p-1}{p}\Big)^p k^{p-2} b^p \int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x).
\]
Consequently, by solving the equation $T'(k_0) =0$ w.r.t. $k_0$, we obtain
\begin{align*}\label{eq:k_opt}
k_0 = \frac{1}{ \frac{p-1}{p} b \left(\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)\right)^{\frac{1}{p}} }. 
\end{align*}

Therefore, by plugging this value of $k_0$ into $T$, we have
\begin{align*}
T(k_0) &= \frac{1}{k_0}\left( 1  + \frac{(p-1)^{p-1}}{p^p} k_0^p b^p \int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x) \right)\\
&= \frac{p-1}{p} b \left(\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)\right)^{\frac{1}{p}} \times \\
& \hspace{6em} \left( 1 + \frac{(p-1)^{p-1}}{p^p} \frac{1}{ \frac{(p-1)^p}{p^p}  b^p \left(\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)\right) } b^p \int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x) \right) \\
&= b \left(\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)\right)^{\frac{1}{p}}.
\end{align*}
Thus, by plugging this value of $T(k_0)$ into Equation~\eqref{eq:OST_k0}, we obtain
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + b \left(\int_{\G} \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right|^p \omega(\text{d}x)\right)^{\frac{1}{p}} = \mathcal{US}_{p, \alpha}(\mu, \nu).
\]

Hence, we have shown that $\calOS_{\Phi, \alpha}(\mu,\nu )  = \mathcal{US}_{p, \alpha}(\mu, \nu)$ in both cases. 

The proof is completed.

\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_OST}}\label{app:subsec:prop:limit_OST}

\begin{proof}
Following Corollary~\ref{cor:OST_1d_optimization_discrete}, we have
\begin{eqnarray*}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \sum_{e \in E} \hspace{-0.1em} w_e \Phi\!\left(kb \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right|\right) \right). 
\end{eqnarray*}
For $\Phi(t) = t$, then we have
\begin{align*}
    \calOS_{\Phi, \alpha}(\mu,\nu ) &=  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k}\left( 1 + \hspace{-0.3em} \sum_{e \in E} \hspace{-0.1em} w_e kb \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right|\right) \\
    &=  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k} + \sum_{e \in E} w_e b \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right| \\
    &=  \Theta |\mu(\G)-\nu(\G)| + b\sum_{e \in E} w_e \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right|.
\end{align*}

Hence, the proof is completed.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_OrliczEPT}}\label{app:subsec:prop:limit_OrliczEPT}

\begin{proof}
From Equation~\eqref{eq:OrliczEPT}, we have
\begin{eqnarray*}
\calOE_{\Phi}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)(\calW_{\Phi}(\hat \mu,\hat \nu) - b\lambda).
\end{eqnarray*}
For $\Phi(t) = t$, we further have
\[
\calW_{\Phi}(\hat \mu,\hat \nu) = \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \inf \Big[ t > 0 : \int_{\hat \G \times \hat \G} \left(\frac{\hat{c}(x, y)}{t}\right) \text{d}\tilde\gamma(x, y) \le 1\Big]
\]
Then, the infimum $(t^*, \tilde{\gamma}^*)$ satisfies
\[
\int_{\hat \G \times \hat \G} \left(\frac{\hat{c}(x, y)}{t^*}\right) \text{d}\tilde\gamma^{*}(x, y) = 1.
\]
Therefore, we obtain $t^* = \int_{\hat \G \times \hat \G} \hat{c}(x, y) \text{d}\tilde\gamma^{*}(x, y) = \calW_{\hat c}(\hat \mu,\hat \nu)$.

Hence, we have
\[
\calOE_{\Phi}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)\left(\calW_{\hat c}(\hat \mu,\hat \nu) - b\lambda\right) = \mathrm{KT}(\mu, \nu).
\]

The proof is completed.

\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_OST_OrliczEPT}}\label{app:subsec:prop:limit_OST_OrliczEPT}

\begin{proof}

For $\Phi(t) = t$, $p = 1$, from Theorem~\ref{thm:OST_computation}, we have
\begin{align*}
    \calOS_{\Phi, \alpha}(\mu,\nu ) &=  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k}\left( 1 +  \int_{\G}  kb \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right| \omega(\text{d}x) \right) \\
    &=  \Theta |\mu(\G)-\nu(\G)| + \inf_{k > 0} \frac{1}{k} + b \int_{\G}  \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right| \omega(\text{d}x) \\
    &=  \Theta |\mu(\G)-\nu(\G)| + b \int_{\G}  \left| \mu(\Lambda(x)) - \nu(\Lambda(x)) \right| \omega(\text{d}x) \\
    &= \mathcal{US}_{p, \alpha}(\mu, \nu).
\end{align*}
Additionally, for $\Phi(t) = t$, from Proposition~\ref{prop:limit_OrliczEPT}, we have
\[
 \calOE_{\Phi}(\mu, \nu) = \mathrm{KT}(\mu, \nu).
\]
With additional assumptions that $\lambda \geq 0$ and the nonnegative weight functions $w_1, w_2$ are $b$-Lipschitz w.r.t. $d_\G$, then by applying~\citet[Corollary 3.2]{le2023scalable}, we have
\[
 \calOE_{\Phi}(\mu, \nu) = \mathrm{KT}(\mu, \nu) = \mathrm{ET}_\lambda(\mu,\nu).
\]
Consequently, for $\alpha = 0$, and the length measure $\omega$ on $\G$, then following~\citet[Proposition 5.2]{le2023scalable}, we have
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) \ge \calOE_{\Phi}(\mu, \nu) + \frac{b\lambda}{2}(\mu(\G) + \nu(\G)). 
\]

The proof is completed.
\end{proof}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_OST_dalpha}}\label{app:subsec:prop:limit_OST_dalpha}

\begin{proof}
From Proposition~\ref{prop:limit_OST}, we have
\begin{align}\label{eq:OST_UST_1}
    \calOS_{\Phi, \alpha}(\mu,\nu ) =  \Theta |\mu(\G)-\nu(\G)| + b\sum_{e \in E} w_e \left| \mu(\gamma_{e}) - \nu(\gamma_{e}) \right| = \mathcal{US}_{1, \alpha}(\mu, \nu).
\end{align}
For the case when $\G$ is a tree, then following~\citep[Proposition 5.3 i)]{le2023scalable}, we further have
\begin{align}\label{eq:UST_dalpha_1}
\mathcal{US}_{1, \alpha}(\mu, \nu) = d_{\alpha}(\mu, \nu).
\end{align}
Thus, from Equations~\eqref{eq:OST_UST_1} and~\eqref{eq:UST_dalpha_1}, we have
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) = d_{\alpha}(\mu, \nu).
\]

The proof is completed.

\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_OST_OT}}\label{app:subsec:prop:limit_OST_OT}

\begin{proof}
From Equation~\eqref{eq:OST_UST_1} in the proof of Proposition~\ref{prop:limit_OST_dalpha}, we have
\begin{align}\label{eq:OST_UST_1_new}
    \calOS_{\Phi, \alpha}(\mu,\nu ) = \mathcal{US}_{1, \alpha}(\mu, \nu).
\end{align}
Additionally, when $\G$ is a tree, and with an additional assumption that $\mu(\G) = \nu(\G)$, by applying~\citep[Proposition 5.3 ii)]{le2023scalable}, and notice that $p=1$ and $b=1$, we obtain
\begin{equation}\label{eq:UST_OT_1}
  \mathcal{US}_{1, \alpha}(\mu, \nu) = \calW_{d_{\G}}(\mu, \nu),
\end{equation}
where recall that $\calW_{d_{\G}}$ is the standard optimal transport with graph metric ground cost $d_{\G}$.

Hence, from Equations~\eqref{eq:OST_UST_1_new} and~\eqref{eq:UST_OT_1}, we get
\[
\calOS_{\Phi, \alpha}(\mu,\nu ) = \calW_{d_{\G}}(\mu, \nu).
\]

The proof is completed.

\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Remark~\ref{rm:upperlimit_regOT}}\label{appsubsec:rm:upperlimit_regOT}

\begin{proof}
Following~\citep[Theorem 2.2.1]{cover1999elements} and definition of conditional entropy~\citep[Equation 2.10]{cover1999elements}, for any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$, we have
\begin{align}
\bar{\mathcal{H}}(\tilde\gamma) &\ge \frac{1}{2}(\bar{\mathcal{H}}(\hat\mu) + \bar{\mathcal{H}}(\hat\nu)) \\
\bar{\mathcal{H}}(\tilde\gamma) + 1 &\ge \frac{1}{2}(\bar{\mathcal{H}}(\hat\mu) + \bar{\mathcal{H}}(\hat\nu)) + 1 \\
H(\tilde\gamma) &\ge \frac{1}{2}(H(\hat\mu) + H(\hat\nu)),
\end{align}
where we recall that $\bar{\mathcal{H}}$ and $H$ are defined in Equation~\eqref{eq:entropy_def} and in Proposition~\ref{prop:monotonicity_regOT} respectively.

Therefore, as in the proof for Proposition~\ref{prop:limits_regOT} in \S\ref{appsubsec:limits_regOT}, from Equation~\eqref{eq:upperbound_objFunc_OT}, we have
\begin{align}
    \mathcal{T} &\ge \Phi \left( \frac{1}{t} \int_{\hat \G \times \hat \G} \hat{c}(x, y) \dd\tilde\gamma(x, y) \right) - \varepsilon \left( H(\hat \mu) + H(\hat \nu) - 1 \right) \\
    &\ge \Phi \left( \frac{1}{t} \left[ \int_{\hat \G \times \hat \G} \hat{c}(x, y) \dd\tilde\gamma(x, y) - \varepsilon H(\tilde\gamma) + \frac{\varepsilon}{2}\left(H(\hat\mu) + H(\hat\nu)\right) \right] \right) - \varepsilon \left( H(\hat \mu) + H(\hat \nu) - 1 \right) \label{eq:assumption_nonnegativity_Phi}
\end{align}
where we assume that the entropic regularized input of $N$-function $\Phi$ is nonnegative in the second row (Equation~\eqref{eq:assumption_nonnegativity_Phi}), i.e., $ \int_{\hat \G \times \hat \G} \hat{c}(x, y) \dd\tilde\gamma(x, y) - \varepsilon H(\tilde\gamma) + \frac{\varepsilon}{2}\left(H(\hat\mu) + H(\hat\nu)\right) \ge 0$ for any $\tilde \gamma \in \Pi(\hat \mu, \hat \nu)$.

Taking the infimum of $\tilde \gamma$ in $\Pi(\hat \mu, \hat \nu)$, we obtain
\begin{align}
\mathcal{A}_{\varepsilon}\left(t; \hat \mu, \hat \nu \right) \ge \Phi \left( \frac{1}{t} \left[ \mathcal{W}_{\varepsilon}(\hat\mu, \hat\nu) + \frac{\varepsilon} {2}\left(H(\hat\mu) + H(\hat\nu)\right) \right] \right) - \varepsilon \left( H(\hat \mu) + H(\hat \nu) - 1 \right)
\end{align}

Therefore, by choosing $t = \frac{\mathcal{W}_{\varepsilon}(\hat\mu, \hat\nu) + \frac{\varepsilon} {2}\left(H(\hat\mu) + H(\hat\nu)\right)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}$, then we have
\[
\mathcal{A}_{\varepsilon} \! \left(\frac{\mathcal{W}_{\varepsilon}(\hat\mu, \hat\nu) + \frac{\varepsilon} {2}\left(H(\hat\mu) + H(\hat\nu)\right)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}; \hat \mu, \hat \nu\right) \ge 1.
\]

The proof is completed.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Proof for Proposition~\ref{prop:limit_regOrliczEPT}}\label{app:subsec:prop:limit_regOrliczEPT}

\begin{proof}
We use the same reason as in the proof for Proposition~\ref{prop:limit_OrliczEPT}. From Equation~\eqref{eq:regOrliczEPT}, we have
\begin{eqnarray*}
\calOE_{\Phi, \varepsilon}(\mu, \nu) := \left(\mu(\G) + \nu(\G)\right)(\calW_{\Phi, \varepsilon}(\hat \mu,\hat \nu) - b\lambda).
\end{eqnarray*}
For $\Phi(t) = t$, we further have
\[
\calW_{\Phi, \varepsilon}(\hat \mu,\hat \nu) = \inf_{\tilde \gamma \in \Pi(\hat \mu, \hat \nu)} \inf \Big[ t > 0 : \int_{\hat \G \times \hat \G} \left(\frac{\hat{c}(x, y)}{t}\right) \text{d}\tilde\gamma(x, y) - \varepsilon H(\tilde \gamma) \le 1\Big]
\]
Then, let $\tilde{\gamma}^*_{\varepsilon}$ is the optimal solution for the entropic regularized OT 
$\calW_{\hat{c},\varepsilon}(\hat \mu,\hat \nu) = \inf_{\tilde \gamma \in \Pi(\hat\mu,\hat \nu)} \big[  \int_{\hat \G\times \hat \G} \hat c(x,y) \tilde\gamma(\dd x, \dd y) - \varepsilon H(\tilde \gamma) \big]$. Thus, for the infimum $(t^*, \tilde{\gamma}^{*}_{\varepsilon})$, we have
\[
\int_{\hat \G \times \hat \G} \left(\frac{\hat{c}(x, y)}{t^*}\right) \text{d}\tilde\gamma^{*}_{\varepsilon}(x, y) = 1.
\]
Therefore, we obtain $t^* = \int_{\hat \G \times \hat \G} \hat{c}(x, y) \text{d}\tilde\gamma^{*}_{\varepsilon}(x, y) = \calW_{\hat c, \varepsilon}(\hat \mu,\hat \nu)$.

Hence, we have
\[
\calOE_{\Phi, \varepsilon}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)\left(\calW_{\hat c, \varepsilon}(\hat \mu,\hat \nu) - b\lambda\right).
\]

The proof is completed.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Further Results and Discussions}\label{appsec:further_results_discussions}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sobolev transport (ST)~\citep{le2022st}}\label{appsubsec:ST}

\textbf{$\boldsymbol{L^{p}}$ functional space.} For a nonnegative Borel measure $\omega$ on $\G$, denote $L^p( \G, \omega)$ as the space of all Borel measurable functions $f:\G\to \R$ such that $\int_\G |f(y)|^p \omega(\mathrm{d}y) <\infty$. For $p=\infty$, we instead assume that $f$ is bounded $\omega$-a.e. Then, $L^p( \G, \omega)$ is a normed space with the norm defined by
\[
\|f\|_{L^p(\G, \omega)} := \left(\int_\G |f(y)|^p \omega(\dd y)\right)^\frac{1}{p} \text{ for } 1\leq p < \infty, \text{ and}
\]
\[
\|f\|_{L^{\infty}(\G, \omega)} := \inf\left\{t \in \R:\, |f(x)|\leq t \mbox{ for $\omega$-a.e. } x\in\G\right\}.
\]

%Functions $f_1, f_2 \in L^p( \G, \omega)$ are considered to be the same if $f_1(x) =f_2(x)$ for $\omega$-a.e. $x\in\G$. 

\paragraph{Graph-based Sobolev space~\citep{le2022st}.} Let $\omega$ be a nonnegative Borel measure on $\G$, and let  $1\leq p\leq \infty$. A continuous function $f: \G \to \R$ is said to belong to the Sobolev space $W^{1,p}(\G, \omega)$ if there exists a  function $h\in L^p( \G, \omega) $ satisfying 
\begin{equation}\label{FTC}
f(x) -f(z_0) =\int_{[z_0,x]} h(y) \omega(\mathrm{d}y)  \quad \forall x\in \G.
\end{equation}
Such function  $h$ is unique in $L^p(\G, \omega) $ and is called the graph derivative of $f$ w.r.t.~the measure $\omega$. The graph derivative of $f \in W^{1,p}(\G, \omega)$ is denoted $f' \in L^p( \G, \omega)$.


\paragraph{Sobolev transport~\citep{le2022st}.} Let $\omega$ be a nonnegative Borel measure on $\G$. Given $1\leq p\leq \infty$, and let  $p'$ be its conjugate, i.e., the number $p'\in [1,\infty]$ satisfying $\frac1p +\frac{1}{p'}=1$. For $\mu, \nu \in \calP(\G)$, the $p$-order Sobolev transport (ST)~\citep[Definition 3.2]{le2022st} is defined as 
\begin{equation} \label{eq:distance}
\hspace{-0.5em} \calS_p(\mu,\nu ) \! \coloneqq \! \left\{
\begin{array}{cl}
\hspace{-0.8em} \sup \Big[\int_\G f(x) \mu(\mathrm{d}x) - \int_\G f(x) \nu(\mathrm{d}x)\Big] \\
\hspace{-0.5em} \mathrm{s.t.} \, f \hspace{-0.2em} \in W^{1,p'} \hspace{-0.3em} (\G, \omega),  \, \|f'\|_{L^{p'}\hspace{-0.2em} (\G, \omega)}\leq 1,
\end{array}
\right.
\end{equation}
where we write $f'$ for the generalized graph derivative of $f$, $W^{1,p'} \hspace{-0.3em} (\G, \omega)$ for the graph-based Sobolev space on $\G$ (see \S \ref{appsec:reviews}), and $L^{p'}\hspace{-0.2em} (\G, \omega)$ for the $L^p$ functional space on $\G$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Length measure~\citep{le2022st}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{definition}[Length measure~\citep{le2022st}] \label{def:measure} 
Let $ \omega^*$ be the unique Borel measure on $\G$ such that the restriction of $\omega^*$ on any edge is the length measure of that edge. That is, $\omega^*$  satisfies:
\begin{enumerate}
\item[i)] For  any edge $e$ connecting two nodes $u$ and $v$, we have 
 $\omega^*(\langle x,y\rangle) = (t-s) w_e$ 
 whenever $x = (1-s) u + s v$ and $y = (1-t)u + t v$ for $s,t \in [0,1)$ with $s \leq t$. Here, $\langle x,y\rangle$ is the line segment in $e$ connecting $x$ and $y$.
 \item[ii)] For any Borel set $F \subset \G$, we have
 \[
 \omega^*(F) = \sum_{e\in E} \omega^*(F\cap e).
 \]
\end{enumerate}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{lemma}[$\omega^*$ is the length measure on graph~\citep{le2022st}] \label{lem:length-measure}
Suppose that $\G$ has no short cuts, namely, any edge $e$ is a shortest path connecting its two end-points. Then, $\omega^*$ is a length measure in the sense that
\[
\omega^*([x,y]) = d_\G(x,y)
\]
for  any  shortest path   $[x,y]$ connecting $x, y$. Particularly, $\omega^*$ has no atom in the sense that $\omega^*(\{x\})=0$ for every $x \in \G$. 
\end{lemma}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Orlicz functions}\label{appsubsec:Orlicz_functions}

For completeness, we recall a review on Orlicz functions as described in~\citet{le2024generalized}.

\textbf{A family of convex functions.} We consider the collection  of  $N$-functions~\citep[\S8.2]{adams2003sobolev} which are special convex functions on $\R_+$. Hereafter, a strictly increasing and   convex function $\Phi: [0, \infty)\to [0, \infty)$ is called an $N$-function if  $\lim_{t \to 0} \frac{\Phi(t)}{t} = 0$ and $\lim_{t \to +\infty} \frac{\Phi(t)}{t} = +\infty$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Examples.} Some popular examples for $N$-functions are (i) $\Phi(t) = t^p$ with $1 < p < \infty$; (ii) $\Phi(t) = \exp(t) - t- 1$; (iii) $\Phi(t) = \exp(t^p) - 1$ with $1 < p < \infty$; and (iv) $\Phi(t) = (1+t) \log(1+t) - t$~\citep[\S8.2]{adams2003sobolev}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{For Luxemburg norm.} The infimum in Equation~\eqref{eq:Luxemburg_norm} for $\norm{f}_{L_\Phi}$ is attained~\citep[\S8.9]{adams2003sobolev}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Complementary function.}
For the given $N$-function $\Phi$, its complementary function $\Psi : \R_+ \to \R_+$~\citep[\S8.3]{adams2003sobolev} is the $N$-function, defined as follows
\begin{equation}\label{eq:complementary_func}
\Psi(t) = \sup \left[at - \Phi(a) \, \mid \, a \ge 0  \right], \quad\mbox{for}\,\,\, t\geq 0.
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Young inequality.} Let $\Phi, \Psi$ be a pair of complementary $N$-functions, then
\[
	st \le \Psi(s) + \Phi(t).
\]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Orlicz norm.} Besides the Luxemburg norm, the Orlicz norm~\citep[\S3.3, Definition 2]{rao1991theory} is also a popular norm for $L_{\Phi}(\G, \omega)$, defined as
\begin{equation}\label{eq:OrliczNorm}
\|f\|_{\Phi} := \sup{\Big\{ \int_{\G} | f(x) g(x)| \omega(\text{d}x) \, \mid \, \int_{\G} \Psi(|g(x)|) \omega(\text{d}x) \leq 1\Big\} }, 
\end{equation}
where $\Psi$ is the complementary $N$-function of $\Phi$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Computation for Orlicz norm.} By applying~\citep[\S3.3, Theorem 13]{rao1991theory}, we can rewrite the Orlicz norm as follows: 
\begin{align*}
\|f\|_{\Phi}  =  
\inf_{k > 0} \frac{1}{k}\left( 1 + \int_{\G} \Phi(k \left| f(x) \right|) \omega(\text{d}x) \right).
\end{align*}

%Given $N$-function $\Phi$, for Orlicz norm $\norm{\cdot}_{\Phi}$, 
Therefore, one can use second-order method, e.g., fmincon Trust Region Reflective solver in MATLAB, for solving the \emph{univariate} optimization problem. 

%For Luxemburg norm $\norm{\cdot}_{L_{\Phi}}$, we use bisection optimization method (e.g., we may expect that it can be more efficient for computation).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Equivalence~\citep[\S8.17]{adams2003sobolev}~\citep[\S13.11]{musielak2006orlicz}.} The Luxemburg norm is equivalent to the Orlicz norm. In fact, we have
\begin{equation}\label{eq:LuxemburgOrlicz}
\norm{f}_{L_\Phi} \le \norm{f}_{\Phi} \le 2 \norm{f}_{L_\Phi}.
\end{equation}

%where we recall that the Luxemburg norm $\norm{\cdot}_{L_\Phi}$ is defined in Equation~\eqref{eq:Luxemburg_norm}, and the Orlicz norm $\norm{\cdot}_{\Phi}$ is defined in Equation~\eqref{eq:OrliczNorm} (see \citep[Definition~2, pp.58]{rao1991theory}).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Connection between $\boldsymbol{L^{p}}$ and $\boldsymbol{L_{\Phi}}$ functional spaces.} When the convex function $\Phi(t) = t^p$, for $1 < p < \infty$, we have 
\[
L^{p}(\G, \omega) = L_{\Phi}(\G, \omega).
\]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Generalized H\"older inequality.} Let $\Phi, \Psi$ be a pair of complementary $N$-functions, then H\"older inequality w.r.t. Luxemburg norm~\citep[\S8.11]{adams2003sobolev} is as follows:
\begin{equation}\label{eq:Holder-Luxemburg2}
\left| \int_{\G} f(x)g(x) \omega(dx) \right| \le 2 \norm{f}_{L_\Phi} \norm{g}_{L_\Psi}.
\end{equation}
Additionally, H\"older inequality w.r.t. Luxemburg norm and Orlicz norm~\citep[\S13.13]{musielak2006orlicz} is as follows:
\begin{equation}\label{eq:Holder-LuxemburgOrlicz}
\left| \int_{\G} f(x)g(x) \omega(dx) \right| \le \norm{f}_{L_\Phi} \norm{g}_{\Psi}.
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Wasserstein distance and Orlicz Wasserstein (OW)}

We briefly review the definition of the $p$-Wasserstein distance with graph metric cost, and the Orlicz Wasserstein for measures on graph $\G$ as used in~\citet{le2024generalized}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Wasserstein distance with graph metric cost.} Let $1\leq p <\infty$, suppose that  $\mu$ and $\nu$ are  two nonnegative Borel measures on $\G$ satisfying $\mu(\G) =\nu(\G)=1$. Then, the $p$-order Wasserstein distance between $\mu$ and $\nu$ is defined as follows:
\begin{align*}
\calW_p(\mu,\nu) 
&= \left( \inf_{\gamma \in \Pi(\mu,\nu)}\int_{\G\times\G} d_\G(x,y)^p \gamma(\dd x, \dd y) \right)^{\frac{1}{p}},
\end{align*}
where $\Pi(\mu,\nu) := \Big\{ \gamma \in \calP(\G \times \G): \, \gamma_1= \mu, \, \gamma_2= \nu \Big\}$, and $\gamma_1, \gamma_2$ are the first and second marginals of $\gamma$ respectively.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{Orlicz Wasserstein (OW).} Following~\citet[Definition 3.2]{GuhaHN23}, the OW with the $N$-function $\Phi$ for measures $\mu, \nu \in \calP(\G)$ is defined as follows:
\begin{eqnarray}\label{eq:OrliczWasserstein}
W_{\Phi}(\mu, \nu) = \inf_{\pi \in \Pi(\mu, \nu)} \inf \Big[ t > 0 : \int_{\G \times \G} \Phi\left(\frac{d_{\G}(x, z)}{t}\right) \text{d}\pi(x, z) \le 1\Big],
\end{eqnarray}
where recall that $\Pi(\mu, \nu)$ is the set of all  couplings between $\mu$ and $\nu$. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Generalized Sobolev transport (GST)~\citep{le2024generalized}}\label{appsubsec:GST}

Let $\Phi$ be an $N$-function and $\omega$ be a nonnegative Borel measure on $\G$. For $\mu, \nu\in \calP(\G)$, we define the generalized Sobolev transport as follows:
\begin{equation} \notag \label{eq:distance_gst}
%\vspace{-0.8em}
\calGS_{\Phi}(\mu,\nu) \! \coloneqq \! \left\{
\begin{array}{cl}
\hspace{-0.4em} \sup &  \Big| \int_\G f(x) \mu(\mathrm{d}x) - \int_\G f(x) \nu(\mathrm{d}x)  \Big| \\
\hspace{-0.4em} \mathrm{s.t.} & f \in {\OrliczSobolevPsi}(\G, \omega),  \, \|f'\|_{L_{\Psi}}\leq 1,
\end{array}
\right.
\end{equation}
where $\Psi$ is the complementary function of $\Phi$ (see \eqref{eq:complementary_func}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Unbalanced Sobolev transport (UST)~\citep{le2023scalable}}\label{appsubsec:UST}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{The regularized set $\mathbb U_{p'}^\alpha$ for critic function~\citep{le2023scalable}.} For $1\leq p\leq \infty$ and $0\leq \alpha\leq \frac12 [b\lambda + w_1(z_0) + w_2(z_0)]$,  let  $\mathbb U_{p'}^{\alpha}$ be  the collection of all functions $f\in W^{1,p'}(\G, \omega)$ satisfying 
\[
f(z_0) \in I_\alpha = \Big[  -w_2(z_0)- \frac{b\lambda}{2}+\alpha, w_1(z_0) + \frac{b\lambda}{2} -\alpha\Big]
\]
and 
\[
\|f'\|_{L^{p'}(\G, \omega)}\leq b.
\]
Equivalently,  $\mathbb U_{p'}^{\alpha}$ is  the collection of all functions $f$ of the form
 \begin{equation}\label{alternative_representation}
  f(x)= s +  \int_{[z_0,x]} h(y) \omega(\dd y)
 \end{equation}
with $s\in I_\alpha$ and with $h:\G \to \R$ being some function satisfying 
\[
\|h\|_{L^{p'}(\G, \omega)}\leq b.
\]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Unbalanced Sobolev transport~\citep{le2023scalable}.} Let $\omega$ be a nonnegative Borel measure on graph $\G$. Given $1\leq p\leq \infty$ and $0\leq \alpha\leq \frac12 [b\lambda + w_1(z_0) + w_2(z_0)]$. For $\mu, \nu\in \calP(\G)$, the unbalanced Sobolev transport is defined as follows 
\[
\mathcal{US}_{p,\alpha}(\mu,\nu ) :=
 \sup_{f\in \mathbb U_{p'}^{\alpha}} \Big[\int_\G f(x) \mu(\mathrm{d}x) - \int_\G f(x) \nu(\mathrm{d}x)\Big]. 
\]
For simplicity, we also use $\mathcal{US}_{p}$ for the $p$-order unbalanced Sobolev transport when the context for $\alpha$ is clear.

\paragraph{Equal measures on a graph~\citep{le2023scalable}.}
\begin{lemma}[Lemma A.9 in~\citet{le2023scalable}]\label{lem:equal-measure}
Let $\mu,\nu\in \calP(\G)$. Then, $\mu=\nu$ if and only if  $\mu(\Lambda(x)) = \nu(\Lambda(x))$ for every $x$ in $\G$.
\end{lemma}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Further computation for Orlicz-EPT and Orlicz-Sobolev transport (OST)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Orlicz-EPT.} We give the pseudo-code for the binary search algorithm to compute the entropic regularized Orlicz-EPT in Algorithm~\ref{alg:bs_OrliczEPT}. Additionally, we derive an alternative upper limit of $\mathcal{A}_{\varepsilon}$ w.r.t. entropic regularized OT as summarized in the following remark. 
\begin{remark}[Upper bound w.r.t. entropic regularized OT]\label{rm:upperlimit_regOT}
We have
\[
\mathcal{A}_{\varepsilon} \! \left( \frac{\mathcal{W}_{\hat{c},\varepsilon}(\hat\mu, \hat\nu) + \frac{\varepsilon} {2}\left(H(\hat\mu) + H(\hat\nu)\right)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}; \hat \mu, \hat \nu \right) \ge 1,
\]
where $\calW_{\hat{c},\varepsilon}(\hat \mu,\hat \nu) := \inf_{\tilde \gamma \in \Pi(\hat\mu,\hat \nu)} \big[  \int_{\hat \G\times \hat \G} \hat c(x,y) \tilde\gamma(\dd x, \dd y) - \varepsilon H(\tilde \gamma) \big]$.\footnote{With a technical assumption that entropic regularized input is nonnegative for $N$-function $\Phi$, specified in the proof.}
\end{remark}

Proof is placed in Appendix \S\ref{appsubsec:rm:upperlimit_regOT}.

Therefore, we can leverage Remark~\ref{rm:upperlimit_regOT} to alternatively set the initial value for $t_{\ell}$ in Algorithm~\ref{alg:bs_OrliczEPT} (line 3).

%%% ALGORITHM
%%\newcommand\mycommfont[1]{\footnotesize\ttfamily\textcolor{blue}{#1}}
%%\SetCommentSty{mycommfont}
%%
%%\begin{algorithm*}\label{alg:bs_OrliczEPT}
%%
%%\DontPrintSemicolon
%%\caption{Compute entropic regularized Orlicz-EPT $\calOE_{\Phi,\varepsilon}$}  \label{alg:bs_OrliczEPT} 
%%
%%%by binary search algorithm
%%
%%\textbf{Input:} Input measures $\mu, \nu$, function $\Phi$, graph $\G$, parameters $b, \lambda, \varepsilon$, and stopping threshold $\bar{\varepsilon}$
%% 
%%\textbf{Output:} entropic regularized Orlicz-EPT $\calOE_{\Phi,\varepsilon}(\mu, \nu)$
%%
%%\nl Construct $\hat\G = \G \cup \{\hat s\}$ and cost function $\hat c$ (\S\ref{subsec:OrlicEPT})
%%
%%\nl Construct $\hat\mu = \frac{\mu +\nu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$ and $\hat\nu = \frac{\nu +\mu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$.
%%
%%%\nl Compute $L_{\hat \mu, \hat \nu} = \max_{x \in \supp(\hat \mu), y \in \supp(\hat \nu)} \hat{c}(x, y)$
%%
%%\nl Set $t_{r} = \frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}$ and $t_{\ell} = \frac{\calW_{\hat c}(\hat \mu, \hat \nu)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}$ 
%%
%%%\tcp{Option: alternatively set $t_r = \frac{\mathcal{W}_{\varepsilon}(\hat\mu, \hat\nu) + \frac{\varepsilon} {2}\left(H(\hat\mu) + H(\hat\nu)\right)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - (\mu(\G) + \nu(\G)) \right])}$}
%%
%%%\nl Compute $f_{\ell} = \mathcal{A}_{\varepsilon} \! \left(t_{\ell}; \hat \mu, \hat \nu\right)$ and $f_{r} = \mathcal{A}_{\varepsilon} \! \left(t_{r}; \hat \mu, \hat \nu\right)$ 
%%
%%\nl \While{$t_r - t_{\ell} > \bar{\varepsilon}$} 	
%%{
%%    \nl Set $t_m = \frac{t_{\ell} + t_r}{2}$
%%    
%%    \nl Compute $f_m = \mathcal{A}_{\varepsilon} \! \left(t_m; \hat \mu, \hat \nu\right)$
%%
%%    \nl \If{$f_m \le 1$} 	
%%    {
%%        \nl Set $t_r = t_m$ %and $f_r = f_m$
%%        
%%        \nl \If{$f_m == 1$}
%%        {
%%            \nl Break
%%        }
%%    }
%%    \Else
%%    {
%%        \nl Set $t_{\ell} = t_m$ %and $f_{\ell} = f_m$ 
%%    }
%%}
%%
%%\nl Return $\calOE_{\Phi,\varepsilon}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)(t_r - b\lambda)$
%%
%%\end{algorithm*}


\begin{algorithm} % enter the algorithm environment
\caption{Compute entropic regularized Orlicz-EPT $\calOE_{\Phi,\varepsilon}$}
\label{alg:bs_OrliczEPT} 
\begin{algorithmic}[1] % enter the algorithmic environment
    \REQUIRE Input measures $\mu, \nu$, function $\Phi$, graph $\G$, parameters $b, \lambda, \varepsilon$, and stopping threshold $\bar{\varepsilon}$.
    \ENSURE entropic regularized Orlicz-EPT $\calOE_{\Phi,\varepsilon}(\mu, \nu)$
    \STATE Construct $\hat\G = \G \cup \{\hat s\}$ and cost function $\hat c$ (\S\ref{subsec:OrlicEPT}). 
     \STATE Construct $\hat\mu = \frac{\mu +\nu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$ and $\hat\nu = \frac{\nu +\mu(\G) \delta_{\hat s}}{\mu(\G) + \nu(\G)}$.
     \STATE Set $t_{r} = \frac{L_{\hat \mu, \hat \nu}}{\Phi^{-1}(1 + \varepsilon)}$ and $t_{\ell} = \frac{\calW_{\hat c}(\hat \mu, \hat \nu)}{\Phi^{-1}(1 + \varepsilon\left[ H(\hat \mu) + H(\hat \nu) - 1 \right])}$.
 
 %%\nl \While{$t_r - t_{\ell} > \bar{\varepsilon}$} 	
%%{
%%    \nl Set $t_m = \frac{t_{\ell} + t_r}{2}$
%%    
%%    \nl Compute $f_m = \mathcal{A}_{\varepsilon} \! \left(t_m; \hat \mu, \hat \nu\right)$
%%
%%    \nl \If{$f_m \le 1$} 	
%%    {
%%        \nl Set $t_r = t_m$ %and $f_r = f_m$
%%        
%%        \nl \If{$f_m == 1$}
%%        {
%%            \nl Break
%%        }
%%    }
%%    \Else
%%    {
%%        \nl Set $t_{\ell} = t_m$ %and $f_{\ell} = f_m$ 
%%    }
%%}
    
     	\WHILE{$t_r - t_{\ell} > \bar{\varepsilon}$}
		\STATE Set $t_m = \frac{t_{\ell} + t_r}{2}$
		\STATE Compute $f_m = \mathcal{A}_{\varepsilon} \! \left(t_m; \hat \mu, \hat \nu\right)$
		\IF{$f_m \le 1$}
    			\STATE Set $t_r = t_m$  %and $f_r = f_m$
			
			\IF{$f_m == 1$} 
    				\STATE Break
			\ENDIF
		\ELSE
    			\STATE Set $t_{\ell} = t_m$ %and $f_{\ell} = f_m$ 
		\ENDIF
	\ENDWHILE


     \STATE Return $\calOE_{\Phi,\varepsilon}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)(t_r - b\lambda)$.	
\end{algorithmic}
\end{algorithm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Orlicz-Sobolev transport.} For popular $N$-function, it is easy to derive its gradient and Hessian for the objective function of the univariate optimization problem. Therefore, in our experiments, we leverage the \texttt{fmincon} in MATLAB with the \emph{trust-region-reflective} algorithm to solve the univariate optimization problem for OST computation.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Further discussions}\label{app:subsec:further_discussions}

\paragraph{Limit case for entropic regularized Orlicz-EPT.} We consider $\Phi(t) = t$ for $\calOE_{\Phi, \varepsilon}$.
\begin{proposition}[Limit case for entropic regularized Orlicz-EPT]\label{prop:limit_regOrliczEPT}
    For $\Phi(t) = t$, and $\mu, \nu \in \calP(\G)$, we have
    \begin{eqnarray}\label{eq:regOrliczEPT_limit}
    \calOE_{\Phi, \varepsilon}(\mu, \nu) = \left(\mu(\G) + \nu(\G)\right)(\calW_{\hat{c},\varepsilon}(\hat \mu,\hat \nu) - b\lambda),
    \end{eqnarray}
    where $\calW_{\hat{c}, \varepsilon}$ is the entropic regularized optimal transport.\footnote{We recall its formulation in Remark~\ref{rm:upperlimit_regOT}.}
\end{proposition}

The proof is placed in Appendix~\S\ref{app:subsec:prop:limit_regOrliczEPT}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Further experimental results}\label{app:subsec:further_experimental_results}

We provide corresponding results as in \S\ref{sec:experiments} for graph~$\G_{\text{Log}}$.

\begin{itemize}
    \item In Figure~\ref{fg:Time_OST_OrliczEPT_10K_LLE}, we compare the time consumption of OST and Orlicz-EPT with $\Phi_0, \Phi_1, \Phi_2$ on graph~$\G_{\text{Log}}$.

    \item In Figure~\ref{fg:DOC_LLE_10K}, we illustrate the SVM results and time consumptions of kernels on document classification with graph~$\G_{\text{Log}}$.

    \item In Figure~\ref{fg:TDA_LLE_10K1K}, we illustrate the SVM results and time consumptions of kernels on TDA with graph~$\G_{\text{Log}}$.
\end{itemize}

%($M=10^3$)
% with different $\Phi(\cdot)$ functions on $10^4$ pairs of measures supported 
\begin{figure}[h]
%\begin{wrapfigure}{r}{0.22\textwidth}
%  \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.5\textwidth]{Fig/Time_OST_OrliczEPT_10K_LLE_AMAZON_opt.pdf}
  \end{center}
  \vspace{-14pt}
  \caption{Time consumption on graph $\G_{\text{Log}}$.}
  \label{fg:Time_OST_OrliczEPT_10K_LLE}
 \vspace{-6pt}
\end{figure}
%\end{wrapfigure}


% ($M=10^4$)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 10K
\begin{figure*}[ht]
%\begin{wrapfigure}{r}{0.22\textwidth}
%  \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.95\textwidth]{Fig/OST_DOC_10K_LLE_opt.pdf}
  \end{center}
  \vspace{-14pt}
  \caption{Document classification on graph $\G_{\text{Log}}$.}
  \label{fg:DOC_LLE_10K}
 \vspace{-6pt}
\end{figure*}
%\end{wrapfigure}

% ($M=10^4$ for \texttt{Orbit}, and $M=10^3$ for \text{MPEG7})
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 10K1K
\begin{figure}[h]
%\begin{wrapfigure}{r}{0.22\textwidth}
%  \vspace{-6pt}
  \begin{center}
    \includegraphics[width=0.55\textwidth]{Fig/OST_TDA_10K1K_LLE_opt.pdf}
  \end{center}
  \vspace{-14pt}
  \caption{TDA on graph $\G_{\text{Log}}$.}
  \label{fg:TDA_LLE_10K1K}
 \vspace{-6pt}
\end{figure}
%\end{wrapfigure}

\end{document}


% This document was modified from the file originally made available by
% Pat Langley and Andrea Danyluk for ICML-2K. This version was created
% by Iain Murray in 2018, and modified by Alexandre Bouchard in
% 2019 and 2021 and by Csaba Szepesvari, Gang Niu and Sivan Sabato in 2022.
% Modified again in 2023 and 2024 by Sivan Sabato and Jonathan Scarlett.
% Previous contributors include Dan Roy, Lise Getoor and Tobias
% Scheffer, which was slightly modified from the 2010 version by
% Thorsten Joachims & Johannes Fuernkranz, slightly modified from the
% 2009 version by Kiri Wagstaff and Sam Roweis's 2008 version, which is
% slightly modified from Prasad Tadepalli's 2007 version which is a
% lightly changed version of the previous year's version by Andrew
% Moore, which was in turn edited from those of Kristian Kersting and
% Codrina Lauth. Alex Smola contributed to the algorithmic style files.
