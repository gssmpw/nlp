\begin{table*}[t]
    \centering
    \caption{Average Performances (\%) of all considered baselines with and without our proposed OP and CWH, in the \textit{clear} setting.
    Results are displayed for different datasets and LR values. We also report the average across LR. We used 3 runs and reported the average and standard deviations. Values in blue are the best for each column. Bold are the best on average. Best viewed in color.}
    \resizebox{\textwidth}{!}{
    \begin{tabular}{l|llla|llla|llla} \multicolumn{1}{c}{Dataset} & \multicolumn{4}{c}{CIFAR100} & \multicolumn{4}{c}{Imagenet-R} & \multicolumn{4}{c}{CUB} \\
    \midrule
    \multicolumn{1}{c}{Learning Rate} & \multicolumn{1}{c}{$5 \times 10^{-5}$} & \multicolumn{1}{c}{$5 \times 10^{-4}$} & \multicolumn{1}{c}{$5 \times 10^{-3}$} & \multicolumn{1}{c}{Avg.} & \multicolumn{1}{c}{$5 \times 10^{-5}$} & \multicolumn{1}{c}{$5 \times 10^{-4}$} & \multicolumn{1}{c}{$5 \times 10^{-3}$} & \multicolumn{1}{c}{Avg.} &  \multicolumn{1}{c}{$5 \times 10^{-5}$} & \multicolumn{1}{c}{$5 \times 10^{-4}$} & \multicolumn{1}{c}{$5 \times 10^{-3}$} & \multicolumn{1}{c}{Avg.} \\
\midrule\midrule
L2P                                          & 67.86{\scriptsize±2.12}                      & 78.18{\scriptsize±1.29}                           & 68.54{\scriptsize±0.98}                    & 71.53{\scriptsize±1.46}  & 25.93{\scriptsize±3.87}                   & 55.56{\scriptsize±1.81}                   & 50.18{\scriptsize±1.36}                       & 43.89{\scriptsize±2.35}   & 20.15{\scriptsize±2.69}                   & 55.21{\scriptsize±2.22}                   & 51.27{\scriptsize±2.09}                       & 42.21{\scriptsize±2.33} \\  
\ \  $\hookrightarrow$ + OP                  & 80.74{\scriptsize±1.08}                      & \textcolor{blue}{85.73{\scriptsize±0.06}}         & \textcolor{blue}{79.11{\scriptsize±0.87}}  & \textbf{\textcolor{blue}{81.86{\scriptsize±0.67}}}  & 47.96{\scriptsize±1.2}                    & 68.68{\scriptsize±1.13}                   & \textcolor{blue}{60.57{\scriptsize±0.96}}     & 59.07{\scriptsize±1.1}    & 48.20{\scriptsize±0.84}                   & 83.51{\scriptsize±1.49}                   & \textcolor{blue}{73.29{\scriptsize±1.2}}      & 68.33{\scriptsize±1.18} \\    
\ \ \ \ \ \ $\hookrightarrow$ + CWH          & \textcolor{blue}{81.73{\scriptsize±0.93}}    & 85.52{\scriptsize±0.1}                            & 78.16{\scriptsize±1.43}                    & 81.80{\scriptsize±0.82}  & \textcolor{blue}{53.18{\scriptsize±1.68}} & \textcolor{blue}{68.89{\scriptsize±1.11}} & 58.38{\scriptsize±2.01}                       & \textbf{\textcolor{blue}{60.15{\scriptsize±1.6}}}    & \textcolor{blue}{58.84{\scriptsize±0.9}}  & \textcolor{blue}{83.98{\scriptsize±1.3}} & 72.78{\scriptsize±2.1}                         & \textbf{\textcolor{blue}{71.87{\scriptsize±1.43}}} \\  
\hline
DualPrompt                                   & 62.21{\scriptsize±1.21}                      & 77.36{\scriptsize±0.46}                           & 65.10{\scriptsize±0.92}                    & 68.22{\scriptsize±0.86}  & 25.34{\scriptsize±1.32}                   & 59.11{\scriptsize±0.54}                   & 53.15{\scriptsize±3.01}                       & 45.87{\scriptsize±1.62}   & 21.77{\scriptsize±3.13}                   & 65.34{\scriptsize±1.22}                   & 53.59{\scriptsize±2.17}                       & 46.90{\scriptsize±2.17} \\  
\ \  $\hookrightarrow$ + OP                  & 78.16{\scriptsize±1.31}                      & \textcolor{blue}{85.35{\scriptsize±0.76}}         & \textcolor{blue}{68.28{\scriptsize±1.95}}  & 77.26{\scriptsize±1.34}  & 49.10{\scriptsize±1.36}                   & \textcolor{blue}{67.68{\scriptsize±0.37}} & \textcolor{blue}{57.40{\scriptsize±2.1}}      & 58.06{\scriptsize±1.28}   & 55.06{\scriptsize±1.34}                   & 86.13{\scriptsize±0.84}                   & \textcolor{blue}{69.72{\scriptsize±1.69}}     & 70.30{\scriptsize±1.29} \\    
\ \ \ \ \ \ $\hookrightarrow$ + CWH          & \textcolor{blue}{79.78{\scriptsize±1.29}}    & 85.08{\scriptsize±0.68}                           & 67.27{\scriptsize±1.77}                    & \textbf{\textcolor{blue}{77.38{\scriptsize±1.25}}}  & \textcolor{blue}{54.59{\scriptsize±1.07}} & 67.55{\scriptsize±0.51}                   & 55.03{\scriptsize±4.77}                       & \textbf{\textcolor{blue}{59.06{\scriptsize±2.12}}}   & \textcolor{blue}{66.71{\scriptsize±0.95}} & \textcolor{blue}{86.67{\scriptsize±0.91}} & 69.10{\scriptsize±3.73}                       & \textbf{\textcolor{blue}{74.16{\scriptsize±1.86}}} \\  
\hline
CODA                                         & 73.36{\scriptsize±1.88}                      & 81.69{\scriptsize±1.48}                           & 64.98{\scriptsize±3.47}                    & 73.34{\scriptsize±2.28}  & 24.62{\scriptsize±1.67}                   & 64.03{\scriptsize±1.81}                   & 33.18{\scriptsize±3.59}                       & 40.61{\scriptsize±2.36}   & 22.06{\scriptsize±0.87}                   & 65.28{\scriptsize±3.07}                   & 40.25{\scriptsize±12.5}                       & 42.53{\scriptsize±5.48} \\  
\ \  $\hookrightarrow$ + OP                  & 85.74{\scriptsize±0.7}                       & \textcolor{blue}{86.16{\scriptsize±0.64}}         & \textcolor{blue}{72.42{\scriptsize±0.8}}   & \textbf{\textcolor{blue}{81.44{\scriptsize±0.71}}}  & 49.39{\scriptsize±0.87}                   & \textcolor{blue}{72.30{\scriptsize±1.7}}  & 38.72{\scriptsize±3.57}                       & 53.47{\scriptsize±2.05}   & 55.35{\scriptsize±1.66}                   & 81.21{\scriptsize±2.33}                   & 59.59{\scriptsize±8.63}                       & 65.38{\scriptsize±4.21} \\    
\ \ \ \ \ \ $\hookrightarrow$ + CWH          & \textcolor{blue}{86.92{\scriptsize±0.66}}    & 85.45{\scriptsize±1.37}                           & 70.11{\scriptsize±0.49}                    & 80.83{\scriptsize±0.84}  & \textcolor{blue}{55.63{\scriptsize±0.97}} & 70.12{\scriptsize±2.17}                   & \textcolor{blue}{41.32{\scriptsize±5.62}}     & \textbf{\textcolor{blue}{55.69{\scriptsize±2.92}}}   & \textcolor{blue}{66.74{\scriptsize±1.79}} & \textcolor{blue}{81.78{\scriptsize±2.28}} & \textcolor{blue}{60.26{\scriptsize±3.09}}     & \textbf{\textcolor{blue}{69.59{\scriptsize±2.39}}} \\  
\hline
ConvPrompt                                   & 78.61{\scriptsize±1.25}                      & 85.76{\scriptsize±0.43}                           & 74.40{\scriptsize±0.69}                    & 79.59{\scriptsize±0.79}  & 30.98{\scriptsize±0.97}                   & 66.66{\scriptsize±1.33}                   & 17.45{\scriptsize±27.19}                      & 38.36{\scriptsize±9.83}   & 31.16{\scriptsize±1.04}                   & 70.78{\scriptsize±2.65}                   & 34.13{\scriptsize±16.8}                       & 45.36{\scriptsize±6.83} \\  
\ \  $\hookrightarrow$ + OP                  & 88.70{\scriptsize±0.77}                      & \textcolor{blue}{90.41{\scriptsize±0.54}}         & 78.59{\scriptsize±6.67}                    & 85.90{\scriptsize±2.66}  & \textcolor{blue}{53.82{\scriptsize±1.41}} & \textcolor{blue}{74.79{\scriptsize±1.13}}                   & 21.60{\scriptsize±26.5}                       & 50.07{\scriptsize±9.68}   & 57.42{\scriptsize±3.4}                    & \textcolor{blue}{86.66{\scriptsize±1.35}} & 42.19{\scriptsize±29.36}                      & 62.09{\scriptsize±11.37} \\    
\ \ \ \ \ \ $\hookrightarrow$ + CWH          & \textcolor{blue}{88.86{\scriptsize±0.63}}    & 90.16{\scriptsize±0.21}                           & \textcolor{blue}{80.94{\scriptsize±5.31}}  & \textbf{\textcolor{blue}{86.65{\scriptsize±2.05}}}  & 53.17{\scriptsize±1.0}                    & 72.94{\scriptsize±1.31} & \textcolor{blue}{34.90{\scriptsize±28.87}}    & \textbf{\textcolor{blue}{53.67{\scriptsize±10.39}}}  & \textcolor{blue}{65.02{\scriptsize±3.77}} & 84.56{\scriptsize±0.75}                   & \textcolor{blue}{65.42{\scriptsize±19.02}}    & \textbf{\textcolor{blue}{71.67{\scriptsize±7.85}}} \\  
\hline
MVP                                          & 49.64{\scriptsize±0.92}                      & 57.63{\scriptsize±2.13}                           & 43.40{\scriptsize±1.02}                    & 50.22{\scriptsize±1.36}  & 28.75{\scriptsize±0.42}                   & 38.25{\scriptsize±0.54}                   & 28.87{\scriptsize±0.79}                       & 31.96{\scriptsize±0.58}   & 28.39{\scriptsize±0.81}                   & 44.10{\scriptsize±1.63}                   & 29.96{\scriptsize±0.81}                       & 34.15{\scriptsize±1.08} \\  
\ \  $\hookrightarrow$ + OP                  & 82.63{\scriptsize±0.91}                      & \textcolor{blue}{85.61{\scriptsize±0.12}}         & 56.16{\scriptsize±1.3}                     & 74.80{\scriptsize±0.78}  & 58.04{\scriptsize±1.05}                   & 62.08{\scriptsize±0.29}                   & 47.50{\scriptsize±1.9}                        & 55.87{\scriptsize±1.08}   & 72.06{\scriptsize±2.05}                   & \textcolor{blue}{85.86{\scriptsize±1.63}} & 59.64{\scriptsize±4.41}                       & 72.52{\scriptsize±2.7}\\    
\ \ \ \ \ \ $\hookrightarrow$ + CWH          & \textcolor{blue}{83.64{\scriptsize±0.59}}    & 85.44{\scriptsize±0.11}                           & \textcolor{blue}{61.60{\scriptsize±1.27}}  & \textbf{\textcolor{blue}{76.89{\scriptsize±0.66}}}  & \textcolor{blue}{60.39{\scriptsize±0.74}} & \textcolor{blue}{62.25{\scriptsize±0.35}} & \textcolor{blue}{50.09{\scriptsize±3.7}}      & \textbf{\textcolor{blue}{57.58{\scriptsize±1.6}}}    & \textcolor{blue}{77.15{\scriptsize±2.0}}  & 85.21{\scriptsize±1.44}                   & \textcolor{blue}{70.49{\scriptsize±3.35}}     & \textbf{\textcolor{blue}{77.62{\scriptsize±2.26}}} \\  
\bottomrule
    \end{tabular}}
    \label{tab:clear_all}
    \vspace{-0.05cm}
\end{table*}
