%!TeX spellcheck = en_US
% !TeX root = ../main.tex
\section{Discussion}
\label{sec:discussion}
The results demonstrate the effectiveness of our LLM-based scenario analysis framework. Furthermore, this framework accurately identifies safety-critical scenarios across models and templates. Overall, GPT-4o offers the best overall balance between accuracy and efficiency.
Additionally, based on the safety-critical metrics template, the LLM's reasoning capabilities are comparable to human experts, especially in showcasing its potential for autonomous scenario analysis.

However, one of the powerful abilities of LLMs is counterfactual reasoning, which allows them to suggest modifications that could increase safety-criticality in scenarios. By leveraging this capability, we can obtain feedback on modifying a non-critical scenario into a safety-critical one.

\subsection{Feedback}
Firstly, we use our proposed LLM-based scenario analysis framework to analyze the non-critical scenario called \texttt{BEL\_Antwerp-1\_14\_T-1.XML} of the 4700 scenarios where the Frenetix motion planner indeed finds an optimal trajectory.

Since in Figure~\ref{fig:plot} the combination between LLMs-GPT-4o with safety-critical metrics prompt templates performs better than the others,  we use this combination to get the feedback by adding a new following requirement in the output format of safety-critical metrics templates:
{\small
\begin{verbatim}
### Safety analysis for timestep <timesteps>: 
Obstacle Analysis: ......
### Summary in JSON Format: ......
***If no collision risk is detected, suggest 
modifications to the obstacleâ€™s motion to 
induce a collision by adjusting the Distance
to Collision or Time to Collision. 
For example: "For Obstacle 1, reducing the 
lateral DTC to 0.5 m or the TTC to 0.5s 
would lead to a collision." Additionally, 
identify the obstacle ID for which a collision 
can be most easily achieved by modifying its 
motion, and outline the reasoning process.***
\end{verbatim}
}
After that, we got a report for this scenario about the risk score for every obstacle ID at each timestep and also one of the following suggestions for modification
{\small
\begin{verbatim}
##Advice for Modifying Obstacle for Collision:
To achieve a collision, consider Obstacle 30762
where the longitudinal DTC is already zero. 
By reducing the lateral Distance to collision 
(DTClat) to 0.5 or reducing the lateral time 
to collision (TTClat) to 0.5, a collision 
scenario can be simulated.
\end{verbatim}
}
\subsection{Scenario modification}
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.48\textwidth]{figures/collision.jpg} 
        \caption{
        Adversarial Scenario Generation Using LLMs: A Case Study on CommonRoad BEL Antwerp-1\_14\_T-1\\
        The top row depicts the original non-critical scenario, while the bottom row showcases a modified safety-critical scenario generated using zero-shot prompts. The trajectory of obstacle 30762 is modified by LLMs-based on Cartesian, Frenet coordinate information and LLMs feedback, demonstrating the effectiveness of the LLMs-based adversarial framework for generating safety-critical driving scenarios.
    }
    \label{fig:collison} % Optional: for referencing the figure
\end{figure}
Now, we use simplified zero-shot prompts to modify this CommonRoad \texttt{BEL\_Antwerp-1\_14\_T-1.XML} file. In this prompt, we provide the context about the Cartesian coordinates information for obstacle 30762 and ego vehicle, as well as the relative information from Frenet coordinates of obstacle 30762, including the above suggestions. Although it is not a systematical template, after trying different zero-shot prompts, we generate a new safety-critical scenario as shown in Figure~\ref{fig:collison}. Indeed, this is a new LLMs-based adversarial method for safety-critical scenario generation which integrate our LLMs-based scenario analysis framework.


