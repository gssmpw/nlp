\chapter{Optimal control for electromagnetic haptic guidance systems}
\label{ch:control:optimal}
\contribution{
In \chapref{ch:shared:contact} and \chapref{ch:shared:volumetric}, we introduced novel actuator and sensing techniques for electromagnetic haptic devices. However, the challenge of effectively controlling the actuator given the sensor input remains unresolved. In this chapter, we address this by exploring an optimal control method for electromagnetic haptic guidance systems. Our approach assists users in pen-based tasks such as drawing, sketching, and designing, while ensuring that user agency is maintained.
%
Traditional methods force the stylus to follow a continuously advancing setpoint on a target trajectory, often resulting in loss of haptic guidance or unintended snapping. In contrast, our control approach gently pulls users towards the target trajectory, allowing for spontaneous adaptation and drawing at their own speed. To achieve this flexible guidance, we iteratively predict the motion of an input device (such as a pen) and dynamically adjust the position and strength of an underlying electromagnetic actuator.
%
To enable real-time computation, we introduce a novel, fast approximate model of an electromagnet. We validate our approach on a prototype hardware platform featuring an electromagnet on a bi-axial linear stage and demonstrate its effectiveness through various applications. Experimental results indicate that our method is more accurate and preferred by users compared to open-loop and time-dependent closed-loop approaches.
}


\begin{figure}
    \centering
  \includegraphics[width=\textwidth]{\dir/figures/teaser_new-02.pdf}
  \caption{We propose an optimal control scheme for electromagnetic guidance systems (\textit{left}). A target trajectory is provided, on which users are guided. They can always adapt the trajectory, our optimization then guides users back to the target (\textit{offset between target and drawing for illustration purposes}).}
  \label{fig:teaser_mpc}
\end{figure}

\input{\dir/sections/01_introduction}
\input{\dir/sections/02_method-00-overview}
\input{\dir/sections/03_method-01-control}
\input{\dir/sections/04_implementation}
\input{\dir/sections/05_evaluation}
\input{\dir/sections/06_applications.tex}
\input{\dir/sections/07_discussion}