% ABSTRACT DL V2
We introduce an optimal control method for electromagnetic haptic guidance systems. 
Our real-time approach assists users in pen-based tasks such as drawing, sketching or designing. 
The key to our control method is that it guides users, yet does not take away agency. 
Existing approaches force the stylus to a continuously advancing setpoint on a target trajectory, leading to undesirable behavior such as loss of haptic guidance or unintended snapping. 
Our control approach, in contrast, gently pulls users towards the target trajectory, allowing them to always easily override the system to adapt their input spontaneously and draw at their own speed. 
To achieve this flexible guidance, our optimization iteratively predicts the motion of an input device such as a pen, and adjusts the position and strength of an underlying dynamic electromagnetic actuator accordingly. 
To enable real-time computation, we additionally introduce a novel and fast approximate model of an electromagnet. 
We demonstrate the applicability of our approach by implementing it on a prototypical hardware platform based on an electromagnet moving on a bi-axial linear stage, as well as a set of applications. 
Experimental results show that our approach is more accurate and preferred by users compared to open-loop and time-dependent closed-loop approaches.

% ABSTRACT DL V1
% We introduce an optimal control method for electromagnetic haptic feedback systems.
% Our real-time approach enables assisting users in tasks such as drawing, sketching or designing \textit{without taking away agency}.
% Users can always easily override the system to adapt their trajectory.
% Our closed-loop time-free approach then gently pulls them back to the desired trajectory. 
% In contrast, existing approaches force the stylus to a continuously advancing setpoint, leading to undesirable behavior such as loss of haptic guidance or unintended snapping.
% To achieve this flexible guidance, our optimization only assumes a dynamic electromagnetic actuator underneath a drawing surface or display and an input device such as a stylus with an embedded permanent magnet. 
% We additionally introduce a novel fast and well-fitting approximate model of an electromagnet to enable real-time computation.
% We demonstrate the applicability of our approach by implementing it on a prototypical hardware platform based on an electromagnet moving on a bi-axial linear stage, as well as a set of applications.
% Experimental results show that our approach is more accurate and preferred by users compared to open-loop and time-dependent closed-loop approaches.


% Our experimental results show that the system can control the pen position with a very low dispersion of \unit[2.8]{mm} ($\pm$\unit[0.8]{mm}), and that our approach is more accurate and preferred by users compared to  open-loop and time-dependent closed-loop approaches.