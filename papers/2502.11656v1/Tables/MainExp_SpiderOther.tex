\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
\begin{adjustbox}{max width=\textwidth}
    \begin{tabular}{c  c | c c | c c | c c | c}
        \toprule
         & \multirow{3}{*}{\textbf{Model}} & \multicolumn{6}{c}{\textbf{Spider Variants Dev (EX)}} & \\ \cline{3-9}
         & & \multicolumn{2}{c}{Greedy} & \multicolumn{2}{c}{Pass@1} & \multicolumn{2}{c |}{Maj@16} & \multirow{2}{*}{$\Delta$EX} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO & \\ \midrule
        \multicolumn{9}{c}{\textbf{Spider-Syn}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 73.8 & 73.5 (\textcolor{darkgreen}{-0.3}) & 72.5 & 72.4 (\textcolor{darkgreen}{-0.1}) & 75.2 & \text{75.5} (\textcolor{red}{+0.3}) & -\\ 
        & Qwen2.5-7B-Instruct & 71.5 & 72.0 (\textcolor{red}{+0.5}) & 69.6  & 69.8 (\textcolor{red}{+0.2}) & \text{73.7} & 73.6 (\textcolor{darkgreen}{-0.1}) & -\\ 
        \multirow{-3}{*}{\textbf{Vanilla}} & CodeS-7b & 69.1 & 69.4 (\textcolor{red}{+0.3}) & 67.1  & 67.6 (\textcolor{red}{+0.5}) & 71.1 & \text{71.2} (\textcolor{red}{+0.1}) & - \\
 
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 70.7 & 71.7 (\textcolor{red}{+1.0}) & 70.1  & 71.3 (\textcolor{red}{+1.2}) & 76.7 & \text{76.8} (\textcolor{red}{+0.1}) & 75.2 $\rightarrow$ 76.8 (\textbf{\textcolor{red}{+1.6}}) \\ 
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 69.7 & 71.2 (\textcolor{red}{+1.5}) & 67.9 & 70.5 (\textcolor{red}{+2.6}) & 74.1 & \text{76.2} (\textcolor{red}{+2.1}) & 73.7 $\rightarrow$ 76.2 (\textbf{\textcolor{red}{+2.5}})\\ 
        \rowcolor{cyan!20}
        \multirow{-3}{*}{\textbf{Syn CoT}} & CodeS-7b & 64.4 & 69.1 (\textcolor{red}{+4.7}) & 63.6  & 67.5 (\textcolor{red}{+3.9}) & 69.8 & \text{71.4} (\textcolor{red}{+1.6}) & 71.1 $\rightarrow$ 71.4 (\textbf{\textcolor{red}{+0.3}}) \\
        
        \midrule
        \multicolumn{9}{c}{\textbf{Spider-Realistic}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 77.2 & 77.2 \phantom{(\textcolor{red}{+0.2})} & 77.0 & 76.5 (\textcolor{darkgreen}{-0.5}) & \text{78.9} & 78.3 (\textcolor{darkgreen}{-0.6}) & - \\
        & Qwen2.5-7B-Instruct & 75.4 & 75.4 \phantom{(\textcolor{red}{+0.4})}& 73.7 & 74.2 (\textcolor{red}{+0.5})& 76.6 & \text{77.4} (\textcolor{red}{+0.8}) & - \\
        \multirow{-3}{*}{\textbf{Vanilla}} & CodeS-7b & 73.8 & 74.0 (\textcolor{red}{+0.2}) & 73.0 & 72.9 (\textcolor{darkgreen}{-0.1}) & \text{76.4} & 75.8 (\textcolor{darkgreen}{-0.6}) & - \\
        
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 79.7 & 80.7 (\textcolor{red}{+1.0}) & 77.4 & 78.7 (\textcolor{red}{+1.3}) & 80.9 & \text{82.7} (\textcolor{red}{+1.8}) & 78.9 $\rightarrow$ 82.7 (\textbf{\textcolor{red}{+3.8}}) \\
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 76.0 & 77.4 (\textcolor{red}{+1.4})& 73.9 & 75.1 (\textcolor{red}{+1.2})& 78.3 & \text{79.1} (\textcolor{red}{+0.8}) & 76.6 $\rightarrow$ 79.1 (\textbf{\textcolor{red}{+2.5}})\\
        \rowcolor{cyan!20}
        \multirow{-3}{*}{\textbf{Syn CoT}} & CodeS-7b & 73.8 & 76.4 (\textcolor{red}{+2.6}) & 71.5 & 73.3 (\textcolor{red}{+1.8}) & 76.6 & \text{78.5} (\textcolor{red}{+1.9}) & 76.4 $\rightarrow$ 78.5 (\textbf{\textcolor{red}{+2.1}}) \\

        \midrule
        \multicolumn{9}{c}{\textbf{Spider-DK}} \\ \midrule

        & Deepseek-coder-6.7b-instruct & 69.0 & 69.8 (\textcolor{darkgreen}{-0.2}) & 68.2 & 68.5 (\textcolor{red}{+0.3}) & \text{70.3} & 70.1 (\textcolor{darkgreen}{-0.2}) & - \\
        & Qwen2.5-7B-Instruct & 70.5 & 70.3 (\textcolor{darkgreen}{-0.2})& 69.0 & 69.4 (\textcolor{red}{+0.4})& \text{73.8} & 73.6 (\textcolor{darkgreen}{-0.2}) & - \\
        \multirow{-3}{*}{\textbf{Vanilla}} & CodeS-7b & 67.5 & 67.5 \phantom{(\textcolor{red}{+0.2})} & 66.3 & 66.6 (\textcolor{red}{+0.3}) & \text{69.2} & 68.6 (\textcolor{darkgreen}{-0.6}) & - \\

        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 69.7 & 72.1 (\textcolor{red}{+2.4}) & 68.4 & 71.2 (\textcolor{red}{+2.8}) & 72.9 & \text{75.1} (\textcolor{red}{+2.2}) & 70.3 $\rightarrow$ 75.1 (\textbf{\textcolor{red}{+4.8}}) \\
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 67.5 & 69.0 (\textcolor{red}{+1.5})& 65.1 & 67.2 (\textcolor{red}{+2.1})& 70.7 & \text{72.9} (\textcolor{red}{+2.2}) & 73.8 $\rightarrow$ 72.9 (\textbf{\textcolor{darkgreen}{-0.9}})\\
        \rowcolor{cyan!20}
        \multirow{-3}{*}{\textbf{Syn CoT}} & CodeS-7b & 62.6 & 67.7 (\textcolor{red}{+5.1}) & 61.9 & 67.0 (\textcolor{red}{+5.1}) & 67.5 & \text{72.1} (\textcolor{red}{+4.6}) & 69.2 $\rightarrow$ 72.1 (\textbf{\textcolor{red}{+2.9}}) \\
        
        \bottomrule
    \end{tabular}
\end{adjustbox}
    \caption{Model performance on Spider's variants (Spider-Syn, Spider-Realistiv, Spider-DK). \textbf{Vanilla}: SFT and DPO on the original Spider training set; \textbf{Syn CoT}: SFT and DPO on the CoT-enhanced training set; \textbf{$\Delta$EX}: The performance difference in EX between ``Syn CoT + DPO'' and ``Vanilla + SFT'' when using the same base model. \textbf{In this setting, we directly assess best checkpoint on Spider Dev.}}
    \label{tab:spiderVariants}
\end{table*}