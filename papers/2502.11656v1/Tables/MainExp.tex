%\begin{table*}[t!]
%    \centering
%    \begin{tabular}{ c c c c }
%        \hline
%        \multirow{3}{*}{\textbf{Model}} & \multicolumn{3}{c|}{\textbf{Bird Dev}} \\ \cline{2-4}
%         & greedy & pass@1 & maj@1k \\ \cline{2-4}
%         & SFT \quad DPO & SFT \quad DPO & SFT \quad DPO \\ \hline
%        \multicolumn{4}{|c|}{\textbf{General Models}} \\ \hline
%        Deepseek-coder-7b & 58 & 62 (\textcolor{red}{+4.0}) & \\ \hline
%        \multicolumn{4}{|c|}{\textbf{Coder Models}} \\ \hline
%         & & & \\ \hline
%        \multicolumn{4}{|c|}{\textbf{SQL-Specialized Models}} \\ \hline
%         & & & \\ \hline
%    \end{tabular}
%    \caption{Model Comparison Table}
%    \label{tab:model-comparison}
%\end{table*}
\iffalse
\begin{table*}[t!]
    \centering
    \begin{tabular}{c c c c}
        \hline
        \multirow{3}{*}{\textbf{Model}} & \multicolumn{3}{c}{\textbf{Bird Dev}} \\ \cline{2-4}
         & Greedy & Pass@1 & Maj@1k \\ \cline{2-4}
         & SFT \quad DPO & SFT \quad DPO & SFT \quad DPO \\ \hline
        \multicolumn{4}{c}{\textbf{General Models}} \\ \hline
        Deepseek-coder-7b & 58 \quad 62 (\textcolor{red}{+4.0}) & 2 & \\ \hline
        \multicolumn{4}{c}{\textbf{Coder Models}} \\ \hline
         & & & \\ \hline
        \multicolumn{4}{c}{\textbf{SQL-Specialized Models}} \\ \hline
         & & & \\ \hline
    \end{tabular}
    \caption{Model Comparison Table}
    \label{tab:model-comparison}
\end{table*}
\fi


% Single Version
\iffalse
\begin{table*}[t!]
    \centering
    \begin{tabular}{c | c c | c c | c c}
        \toprule
        \multirow{3}{*}{\textbf{Model}} & \multicolumn{6}{c}{\textbf{Bird Dev}} \\ \cline{2-7}
         & \multicolumn{2}{c}{Greedy} & \multicolumn{2}{c}{Pass@1} & \multicolumn{2}{c}{Maj@16} \\ \cline{2-7}
         & SFT & DPO & SFT & DPO & SFT & DPO \\ \midrule
        \multicolumn{7}{c}{\textbf{General Models}} \\ \midrule
        Deepseek-llm-7b & 54.3 &  & 51.9  & & 59.1 & \\ 
        Meta-Llama-3.1-8B-Instruct & 58.8 & 61.2 (\textcolor{red}{+2.4}) & 57.5  & & 62.8 & \\ 
        Qwen2.5-chat-7b & 57.4 & 61.9 (\textcolor{red}{+4.5}) & 54.8  & 59.2 (\textcolor{red}{+4.4}) & 63.0 & 64.9 (\textcolor{red}{+1.9}) \\ 
        Qwen2.5-chat-14b & 63.2 & 65.3 (\textcolor{red}{+2.1}) & 61.8  & 64.7 (\textcolor{red}{+2.9}) &  65.4 & 67.1 (\textcolor{red}{+1.7})\\ \midrule
        \multicolumn{7}{c}{\textbf{Coder Models}} \\ \midrule
        Deepseek-coder-7b & 61.5 & 63.8 (\textcolor{red}{+2.3}) & 59.9 & 62.3 (\textcolor{red}{+4.5}) & 64.3 & 65.4 (\textcolor{red}{+1.1}) \\ 
        CodeLlama-instruct-7b & 58.2 & 61.3 (\textcolor{red}{+3.1}) & 56.9 & 60.4 (\textcolor{red}{+3.5}) & 60.2 & 61.9 (\textcolor{red}{+1.7})\\ 
        CodeLlama-instruct-13b & 62.0 & & 59.8  & & 63.6 & 65.8 (\textcolor{red}{+2.2})\\
        Qwen2.5-Coder-7b & 60.8 & 63.4 (\textcolor{red}{+2.6}) & 59.1 & 62.8 (\textcolor{red}{+3.7}) & 62.5 & 64.1 (\textcolor{red}{+1.6})\\ \midrule
        \multicolumn{7}{c}{\textbf{SQL-Specialized Models}} \\ \midrule
        CodeS-7b & 56.7 & 57.5 (\textcolor{red}{+0.8}) & 54.2 & 55.3 (\textcolor{red}{+1.1}) & 60.2 & 61.7 (\textcolor{red}{+1.5})\\ 
        CodeS-15b & 58.6 & 61.1 (\textcolor{red}{+2.5}) & 56.6 & 60.5 (\textcolor{red}{+3.9}) & 62.4 & 63.2 (\textcolor{red}{+0.8})\\
        \bottomrule
    \end{tabular}
    \caption{Model Comparison Table}
    \label{tab:model-comparison}
\end{table*}
\fi

\iffalse
% Non-CoT and CoT in same page
\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
    \begin{tabular}{c | c | c c | c c | c c}
        \toprule
         & \multirow{3}{*}{\textbf{Model}} & \multicolumn{6}{c}{\textbf{Bird Dev}} \\ \cline{3-8}
         & & \multicolumn{2}{c}{Greedy} & \multicolumn{2}{c}{Pass@1} & \multicolumn{2}{c}{Maj@16} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO \\ \midrule
        \multicolumn{8}{c}{\textbf{General Models}} \\ \midrule
        
        & Deepseek-llm-7b-chat & 51.8 & 51.2 (\textcolor{darkgreen}{-0.6})& 47.9  & 49.1 (\textcolor{red}{+1.3})& 54.5 & 54.3 (\textcolor{darkgreen}{-0.3}) \\ 
        & Meta-Llama-3.1-8B-Instruct & 59.0 & 59.8 (\textcolor{red}{+0.8}) & 56.1  & 57.2 (\textcolor{red}{+1.1}) & 61.4 & 60.8 (\textcolor{darkgreen}{-0.6}) \\ 
        & Qwen2.5-7B-Instruct & 58.8 & 59.0 (\textcolor{red}{+0.2}) & 55.1  & 55.7 (\textcolor{red}{+0.6}) & 61.4 & 60.6 (\textcolor{darkgreen}{-0.8}) \\ 
        \multirow{-4}{*}{\textbf{Vanilla}} & Qwen2.5-14B-Instruct & 64.3 & 63.5 (\textcolor{darkgreen}{+0.8}) & 62.3  & 62.6 (\textcolor{red}{+0.3}) &  64.6 & 65.1 (\textcolor{red}{+0.5}) \\
        
        \rowcolor{cyan!20}
        & Deepseek-llm-7b-chat & 54.3 & 55.9 (\textcolor{red}{+1.6})& 51.9  & 54.8 (\textcolor{red}{+2.9})& 59.1 & 61.0 (\textcolor{red}{+1.9}) \\ 
        \rowcolor{cyan!20}
        & Meta-Llama-3.1-8B-Instruct & 56.8 & 61.2 (\textcolor{red}{+4.4}) & 57.5  & 59.0 (\textcolor{red}{+1.5}) & 60.2 & 61.9 (\textcolor{red}{+1.7}) \\ 
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 57.4 & 61.9 (\textcolor{red}{+4.5}) & 54.8  & 59.2 (\textcolor{red}{+4.4}) & 63.0 & 64.9 (\textcolor{red}{+1.9}) \\ 
        \rowcolor{cyan!20}
        \multirow{-4}{*}{\textbf{CoT}} & Qwen2.5-14B-Instruct & 63.2 & 65.3 (\textcolor{red}{+2.1}) & 61.8  & 64.7 (\textcolor{red}{+2.9}) &  65.4 & 67.1 (\textcolor{red}{+1.7}) \\
        
        \midrule
        \multicolumn{8}{c}{\textbf{Coder Models}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 60.6 & 60.9 (\textcolor{red}{0.3}) & 56.9 & 58.8 (\textcolor{red}{+1.9}) & 59.8 & 61.0 (\textcolor{red}{+1.2}) \\
        & CodeLlama-7b-Instruct-hf & 57.0 & 55.7 (\textcolor{darkgreen}{-1.3}) & 54.3 & 55.5 (\textcolor{red}{+1.2}) & 59.1 & 58.5 (\textcolor{darkgreen}{-0.6})\\ 
        & CodeLlama-13b-Instruct-hf & 60.0 & 60.2 (\textcolor{red}{+0.2})& 56.7  & 57.9 (\textcolor{red}{+1.2})& 61.9 & 62.0 (\textcolor{red}{+0.1})\\
        \multirow{-4}{*}{\textbf{Vanilla}} & Qwen2.5-Coder-7B-Instruct & 61.6 & 61.3 (\textcolor{darkgreen}{-0.3}) & 59.4 & 60.6 (\textcolor{red}{+1.2}) & 61.3 & 62.7 (\textcolor{red}{+1.4})\\
        
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 61.5 & 63.8 (\textcolor{red}{+2.3}) & 59.9 & 62.3 (\textcolor{red}{+4.5}) & 64.3 & 65.4 (\textcolor{red}{+1.1}) \\
        \rowcolor{cyan!20}
        & CodeLlama-7b-Instruct-hf & 58.2 & 61.3 (\textcolor{red}{+3.1}) & 56.9 & 60.4 (\textcolor{red}{+3.5}) & 60.2 & 61.9 (\textcolor{red}{+1.7})\\ 
        \rowcolor{cyan!20}
        & CodeLlama-13b-Instruct-hf & 62.0 & 63.9 (\textcolor{red}{+1.9})& 59.8  & 62.5 (\textcolor{red}{+2.7})& 63.6 & 65.8 (\textcolor{red}{+2.2})\\
        \rowcolor{cyan!20}
        \multirow{-4}{*}{\textbf{CoT}} & Qwen2.5-Coder-7B-Instruct & 60.8 & 63.4 (\textcolor{red}{+2.6}) & 59.1 & 62.8 (\textcolor{red}{+3.7}) & 62.5 & 64.1 (\textcolor{red}{+1.6})\\ \midrule
        
        \multicolumn{8}{c}{\textbf{SQL-Specialized Models}} \\ \midrule
        
        & CodeS-7b & 56.8 & 56.6 (\textcolor{darkgreen}{-0.2}) & 53.7 & 54.6 (\textcolor{red}{+0.9}) & 58.1 & 58.0 (\textcolor{darkgreen}{-0.1})\\ 
        \multirow{-2}{*}{\textbf{Vanilla}} & CodeS-15b & 58.3 & 58.2 (\textcolor{darkgreen}{-0.1}) & 55.6 & 56.2 (\textcolor{red}{+0.6}) & 60.2 & 59.1 (\textcolor{darkgreen}{-1.1})\\
        
        \rowcolor{cyan!20}
        & CodeS-7b & 56.7 & 57.5 (\textcolor{red}{+0.8}) & 54.2 & 55.3 (\textcolor{red}{+1.1}) & 60.2 & 61.7 (\textcolor{red}{+1.5})\\ 
        \rowcolor{cyan!20}
        \multirow{-2}{*}{\textbf{CoT}} & CodeS-15b & 58.6 & 61.1 (\textcolor{red}{+2.5}) & 56.6 & 60.5 (\textcolor{red}{+3.9}) & 62.4 & 63.2 (\textcolor{red}{+0.8})\\
        \bottomrule
    \end{tabular}
    \caption{Model Comparison Table}
    \label{tab:model-comparison}
\end{table*}
\fi

% additional difference comparison
\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
\begin{adjustbox}{max width=0.85\textwidth}
    \begin{tabular}{c  c | c c | c c | c c | c}
        \toprule
         & \multirow{3}{*}{\textbf{Model}} & \multicolumn{6}{c}{\textbf{Bird Dev}} & \\ \cline{3-9}
         & & \multicolumn{2}{c}{Greedy} & \multicolumn{2}{c}{Pass@1} & \multicolumn{2}{c |}{Maj@16} & \multirow{2}{*}{$\Delta$EX} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO & \\ \midrule
        \multicolumn{9}{c}{\textbf{General Models}} \\ \midrule
        
        & Deepseek-llm-7b-chat & 51.8 & 51.2 (\textcolor{darkgreen}{-0.6})& 47.9  & 49.1 (\textcolor{red}{+1.3})& \text{54.5} & 54.3 (\textcolor{darkgreen}{-0.3}) & -\\ 
        & Meta-Llama-3.1-8B-Instruct & 59.0 & 59.8 (\textcolor{red}{+0.8}) & 56.1  & 57.2 (\textcolor{red}{+1.1}) & \text{61.4} & 60.8 (\textcolor{darkgreen}{-0.6}) & -\\ 
        & Qwen2.5-7B-Instruct & 58.8 & 59.0 (\textcolor{red}{+0.2}) & 55.1  & 55.7 (\textcolor{red}{+0.6}) & \text{61.4} & 60.6 (\textcolor{darkgreen}{-0.8}) & -\\ 
        \multirow{-4}{*}{\textbf{Vanilla}} & Qwen2.5-14B-Instruct & 64.3 & 63.5 (\textcolor{darkgreen}{-0.8}) & 62.3  & 62.6 (\textcolor{red}{+0.3}) &  64.6 & \text{65.1} (\textcolor{red}{+0.5}) & - \\
        
        \rowcolor{cyan!20}
        & Deepseek-llm-7b-chat & 54.3 & 55.9 (\textcolor{red}{+1.6})& 51.9  & 54.8 (\textcolor{red}{+2.9})& 59.1 & \text{61.0} (\textcolor{red}{+1.9}) & 54.5 $\rightarrow$ 61.0 (\textbf{\textcolor{red}{+6.5}})\\ 
        \rowcolor{cyan!20}
        & Meta-Llama-3.1-8B-Instruct & 56.8 & 61.2 (\textcolor{red}{+4.4}) & 57.5  & 59.0 (\textcolor{red}{+1.5}) & 60.2 & \text{61.9} (\textcolor{red}{+1.7}) & 61.4 $\rightarrow$ 61.9 (\textbf{\textcolor{red}{+0.5}}) \\ 
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 57.4 & 61.9 (\textcolor{red}{+4.5}) & 54.8  & 59.2 (\textcolor{red}{+4.4}) & 63.0 & \text{64.9} (\textcolor{red}{+1.9}) & 61.4 $\rightarrow$ 64.9 (\textbf{\textcolor{red}{+3.5}})\\ 
        \rowcolor{cyan!20}
        \multirow{-4}{*}{\textbf{Syn CoT}} & Qwen2.5-14B-Instruct & 63.2 & 65.3 (\textcolor{red}{+2.1}) & 61.8  & 64.7 (\textcolor{red}{+2.9}) &  65.4 & \text{67.1} (\textcolor{red}{+1.7}) & 64.6 $\rightarrow$ 67.1 (\textbf{\textcolor{red}{+2.5}})\\
        
        \midrule
        \multicolumn{9}{c}{\textbf{Coder Models}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 60.6 & 60.9 (\textcolor{red}{+0.3}) & 56.9 & 58.8 (\textcolor{red}{+1.9}) & 59.8 & \text{61.0} (\textcolor{red}{+1.2}) & - \\
        & CodeLlama-7b-Instruct-hf & 57.0 & 55.7 (\textcolor{darkgreen}{-1.3}) & 54.3 & 55.5 (\textcolor{red}{+1.2}) & \text{59.1} & 58.5 (\textcolor{darkgreen}{-0.6}) & - \\ 
        & CodeLlama-13b-Instruct-hf & 60.0 & 60.2 (\textcolor{red}{+0.2})& 56.7  & 57.9 (\textcolor{red}{+1.2})& 61.9 & \text{62.0} (\textcolor{red}{+0.1}) & - \\
        \multirow{-4}{*}{\textbf{Vanilla}} & Qwen2.5-Coder-7B-Instruct & 61.6 & 61.3 (\textcolor{darkgreen}{-0.3}) & 59.4 & 60.6 (\textcolor{red}{+1.2}) & 61.3 & \text{62.7} (\textcolor{red}{+1.4}) & - \\
        
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 61.5 & 63.8 (\textcolor{red}{+2.3}) & 59.9 & 62.3 (\textcolor{red}{+4.5}) & 64.3 & \text{65.4} (\textcolor{red}{+1.1}) & 59.8 $\rightarrow$ 65.4 (\textbf{\textcolor{red}{+5.6}}) \\
        \rowcolor{cyan!20}
        & CodeLlama-7b-Instruct-hf & 58.2 & 61.3 (\textcolor{red}{+3.1}) & 56.9 & 60.4 (\textcolor{red}{+3.5}) & 60.2 & \text{61.9} (\textcolor{red}{+1.7}) & 59.1 $\rightarrow$ 61.9 (\textbf{\textcolor{red}{+2.8}}) \\ 
        \rowcolor{cyan!20}
        & CodeLlama-13b-Instruct-hf & 62.0 & 63.9 (\textcolor{red}{+1.9})& 59.8  & 62.5 (\textcolor{red}{+2.7})& 63.6 & \text{65.8} (\textcolor{red}{+2.2}) & 61.9 $\rightarrow$ 65.8 (\textbf{\textcolor{red}{+3.9}})\\
        \rowcolor{cyan!20}
        \multirow{-4}{*}{\textbf{Syn CoT}} & Qwen2.5-Coder-7B-Instruct & 60.8 & 63.4 (\textcolor{red}{+2.6}) & 59.1 & 62.8 (\textcolor{red}{+3.7}) & 62.5 & \text{64.1} (\textcolor{red}{+1.6}) & 61.3 $\rightarrow$ 64.1 (\textbf{\textcolor{red}{+2.8}}) \\ \midrule
        
        \multicolumn{9}{c}{\textbf{SQL-Specialized Models}} \\ \midrule
        
        & CodeS-7B & 56.8 & 56.6 (\textcolor{darkgreen}{-0.2}) & 53.7 & 54.6 (\textcolor{red}{+0.9}) & \text{58.1} & 58.0 (\textcolor{darkgreen}{-0.1}) & -\\ 
        \multirow{-2}{*}{\textbf{Vanilla}} & CodeS-15B & 58.3 & 58.2 (\textcolor{darkgreen}{-0.1}) & 55.6 & 56.2 (\textcolor{red}{+0.6}) & \text{60.2} & 59.1 (\textcolor{darkgreen}{-1.1}) & -\\
        
        \rowcolor{cyan!20}
        & CodeS-7B & 56.7 & 57.5 (\textcolor{red}{+0.8}) & 54.2 & 55.3 (\textcolor{red}{+1.1}) & 60.2 & \text{61.7} (\textcolor{red}{+1.5}) & 58.1 $\rightarrow$ 61.7 (\textbf{\textcolor{red}{+2.6}}) \\ 
        \rowcolor{cyan!20}
        \multirow{-2}{*}{\textbf{Syn CoT}} & CodeS-15B & 58.6 & 61.1 (\textcolor{red}{+2.5}) & 56.6 & 60.5 (\textcolor{red}{+3.9}) & 62.4 & \text{63.2} (\textcolor{red}{+0.8}) & 60.2 $\rightarrow$ 63.2 (\textbf{\textcolor{red}{+3.0}})\\
        \bottomrule
    \end{tabular}
\end{adjustbox}
    \caption{Model performance on the Bird development set. \textbf{Vanilla}: SFT and DPO on the original Bird training set; \textbf{Syn CoT}: SFT and DPO on the CoT-enhanced training set; \textbf{$\Delta$EX}: The performance difference in EX between ``Syn CoT + DPO'' and ``Vanilla + SFT'' when using the same base model.}
    \label{tab:model-comparison}
\end{table*}