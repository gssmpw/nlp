\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
\begin{adjustbox}{max width=\textwidth}
    \begin{tabular}{c  c | c c | c c | c c | c}
        \toprule
         & \multirow{3}{*}{\textbf{Model}} & \multicolumn{6}{c}{\textbf{Spider Dev}} & \\ \cline{3-9}
         & & \multicolumn{2}{c}{Greedy} & \multicolumn{2}{c}{Pass@1} & \multicolumn{2}{c |}{Maj@16} & \multirow{2}{*}{$\Delta$} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO & \\ \midrule
        \multicolumn{9}{c}{\textbf{Execution Accuracy (EX)}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 81.6 & 81.0 (\textcolor{darkgreen}{-0.6}) & 80.0  & 80.4 (\textcolor{red}{+0.4}) & \text{82.5} & 81.9 (\textcolor{darkgreen}{-0.6}) & -\\ 
        & Qwen2.5-7B-Instruct & 79.8 & 79.7 (\textcolor{darkgreen}{-0.1}) & 78.4  & 78.6 (\textcolor{red}{+0.2}) & \text{81.8} & 81.6 (\textcolor{darkgreen}{-0.2}) & -\\ 
        \multirow{-3}{*}{\textbf{Vanilla}} & CodeS-7b & 79.3 & 79.4 (\textcolor{red}{+0.1}) & 78.0  & 78.2 (\textcolor{red}{+0.2}) & \text{80.9} & 80.4 (\textcolor{darkgreen}{-0.5}) & - \\
        
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 80.0 & 82.1 (\textcolor{red}{+2.1}) & 79.4  & 81.3 (\textcolor{red}{+1.9}) & 82.8 & \text{83.8} (\textcolor{red}{+1.0}) & 82.5 $\rightarrow$ 83.8 (\textbf{\textcolor{red}{+1.3}}) \\ 
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 79.1 & 80.5 (\textcolor{red}{+1.4}) & 76.8 & 78.9 (\textcolor{red}{+2.1}) & 80.4 & \text{82.6} (\textcolor{red}{+2.2}) & 81.8 $\rightarrow$ 82.6 (\textbf{\textcolor{red}{+0.8}})\\ 
        \rowcolor{cyan!20}
        \multirow{-3}{*}{\textbf{Syn CoT}} & CodeS-7b & 76.7 & 80.0 (\textcolor{red}{+3.3}) & 75.5  & 78.8 (\textcolor{red}{+3.3}) &  78.3 & \text{82.3} (\textcolor{red}{+4.0}) & 80.9 $\rightarrow$ 82.3 (\textbf{\textcolor{red}{+1.4}}) \\
        
        \midrule
        \multicolumn{9}{c}{\textbf{Test Suite (TS)}} \\ \midrule
        
        & Deepseek-coder-6.7b-instruct & 80.5 & 80.7 (\textcolor{red}{+0.2}) & 79.1 & 79.6 (\textcolor{red}{+0.5}) & \text{81.1} & 80.7 (\textcolor{darkgreen}{-0.4}) & - \\
        & Qwen2.5-7B-Instruct & 78.5 & 78.9 (\textcolor{red}{+0.4})& 77.2 & 77.1 (\textcolor{darkgreen}{+0.1})& \text{79.5} & 79.3 (\textcolor{darkgreen}{-0.2}) & - \\
        \multirow{-3}{*}{\textbf{Vanilla}} & CodeS-7b & 76.9 & 77.1 (\textcolor{red}{+0.2}) & 75.4 & 75.7 (\textcolor{red}{+0.3}) & \text{78.1} & 77.7 (\textcolor{darkgreen}{-0.4}) & - \\
        
        \rowcolor{cyan!20}
        & Deepseek-coder-6.7b-instruct & 78.3 & 80.3 (\textcolor{red}{+2.0}) & 76.9 & 78.9 (\textcolor{red}{+2.0}) & 79.7 & \text{81.6} (\textcolor{red}{+1.9}) & 81.1 $\rightarrow$ 81.6 (\textbf{\textcolor{red}{+0.5}}) \\
        \rowcolor{cyan!20}
        & Qwen2.5-7B-Instruct & 77.5 & 77.9 (\textcolor{red}{+0.4})& 75.0 & 76.6 (\textcolor{red}{+1.6})& 78.6 & \text{80.2} (\textcolor{red}{+1.6}) & 79.5 $\rightarrow$ 80.2 (\textbf{\textcolor{red}{+0.7}})\\
        \rowcolor{cyan!20}
        \multirow{-3}{*}{\textbf{Syn CoT}} & CodeS-7b & 74.8 & 77.0 (\textcolor{red}{+2.2}) & 73.1 & 75.3 (\textcolor{red}{+2.2}) & 76.1 & \text{77.8} (\textcolor{red}{+1.7}) & 78.1 $\rightarrow$ 77.8 (\textbf{\textcolor{darkgreen}{-0.3}}) \\
        \bottomrule
    \end{tabular}
\end{adjustbox}
    \caption{Model performance on the Spider development set. \textbf{Vanilla}: SFT and DPO on the original Spider training set; \textbf{Syn CoT}: SFT and DPO on the CoT-enhanced training set; \textbf{$\Delta$}: The performance difference in EX/TS between ``Syn CoT + DPO'' and ``Vanilla + SFT'' when using the same base model.\textbf{We make preference dataset with EX since TS in not available to train set.}}
    \label{tab:spiderDev}
\end{table*}

%Model performance on Spider development set. \textbf{Vanilla}: SFT on original Spider train set; \textbf{Syn CoT}: SFT on synthetic chain-of-thought solutions generated from our pipeline; \textbf{$\Delta$}: The difference between best EX/TS score of Syn CoT (regardless of training stage and inference strategy) and its vanilla counterpart when built on same base model.\textbf{We make preference dataset with EX since TS in not available to train set.}