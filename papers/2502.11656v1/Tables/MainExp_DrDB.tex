% Syn CoT Table
\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
\begin{adjustbox}{max width=\textwidth}
    \begin{tabular}{c | l | c c | c c | c c }
        \toprule
         \multirow{3}{*}{\textbf{Type}} & \multirow{3}{*}{\textbf{Metrics}} & \multicolumn{6}{c}{\textbf{Syn CoT Models}} \\ \cline{3-8}
         & & \multicolumn{2}{c}{DSC (6.7B)} & \multicolumn{2}{c}{Qwen (7B)} & \multicolumn{2}{c}{CodeS (7B)} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO \\ \midrule
        \multicolumn{8}{c}{\textbf{DB Perturbations}} \\ \midrule

        \multirow{3}{*}{schema-synonym} & Greedy & 66.6 & 68.8 (\textcolor{red}{+2.2}) & 63.1 & 65.1 (\textcolor{red}{+2.0}) & 57.5 & 62.2 (\textcolor{red}{+4.7}) \\
        & Pass@1 & 63.8 & 66.7 (\textcolor{red}{+2.9}) & 60.7 & 63.3 (\textcolor{red}{+2.6}) & 55.0 & 60.8 (\textcolor{red}{+5.8}) \\
        & Maj@K & 69.7 & 71.7 (\textcolor{red}{+2.0}) & 68.1 & 69.3 (\textcolor{red}{+1.2}) & 63.7 & 66.2 (\textcolor{red}{+2.5}) \\
         \midrule

        \multirow{3}{*}{schema-abbreviation} & Greedy & 74.8 & 77.9 (\textcolor{red}{+3.1}) & 70.7 & 73.3 (\textcolor{red}{+2.6}) & 69.4 & 74.9 (\textcolor{red}{+5.5}) \\
        & Pass@1 & 73.0 & 76.1 (\textcolor{red}{+3.1}) & 68.1 & 71.2 (\textcolor{red}{+3.1}) & 66.8 & 73.2 (\textcolor{red}{+6.4}) \\
        & Maj@K & 76.7 & 79.8 (\textcolor{red}{+3.1}) & 75.3 & 77.6 (\textcolor{red}{+2.3}) & 73.6 & 77.1 (\textcolor{red}{+3.5}) \\
        \midrule


        \multirow{3}{*}{DBcontent-equivalence} & Greedy & 61.5 & 63.1 (\textcolor{red}{+1.6}) & 52.1 & 50.8 (\textcolor{darkgreen}{-1.3}) & 56.0 & 59.2 (\textcolor{red}{+3.2}) \\
        & Pass@1 & 59.5 & 60.3 (\textcolor{red}{+0.8}) & 49.2 & 49.4 (\textcolor{red}{+0.2}) & 56.4 & 56.8 (\textcolor{red}{+0.4}) \\
        & Maj@K & 61.8 & 63.1 (\textcolor{red}{+1.3}) & 55.5 & 55.0 (\textcolor{darkgreen}{-0.5}) & 61.5 & 62.6 (\textcolor{red}{+1.1}) \\
      \midrule

        \multirow{3}{*}{\textbf{Average}} & Greedy & 67.6 & 69.9 (\textcolor{red}{+2.3}) & 62.0 & 63.1 (\textcolor{red}{+1.1}) & 61.0 & 65.4 (\textcolor{red}{+4.4}) \\
& Pass@1 & 65.4 & 67.7 (\textcolor{red}{+2.3}) & 59.3 & 61.3 (\textcolor{red}{+2.0}) & 59.4 & 63.6 (\textcolor{red}{+4.2}) \\
& Maj@K & 69.4 & 71.5 (\textcolor{red}{+2.1}) & 66.3 & 67.3 (\textcolor{red}{+1.0}) & 66.3 & 68.6 (\textcolor{red}{+2.3}) \\

        
        \bottomrule
    \end{tabular}
\end{adjustbox}
    \caption{Syn CoT model performance on DB perturbations of Dr.Spider dataset. Names of base models are abbreviated. \textbf{DSC (6.7B)}: Deepseek-coder-6.7b-instruct; \textbf{Qwen (7B)}: Qwen2.5-7B-Instruct; \textbf{CodeS (7B)}: CodeS-7b. \textbf{In this setting, we directly assess best checkpoint on Spider Dev.}}
    \label{tab:drSpiderDBCoT}
\end{table*}

% Vanilla Table
\definecolor{darkgreen}{RGB}{0,150,0}
\begin{table*}[t!]
    \centering
\begin{adjustbox}{max width=\textwidth}
    \begin{tabular}{c | l | c c | c c | c c }
        \toprule
         \multirow{3}{*}{\textbf{Type}} & \multirow{3}{*}{\textbf{Metrics}} & \multicolumn{6}{c}{\textbf{Vanilla Models}} \\ \cline{3-8}
         & & \multicolumn{2}{c}{DSC (6.7B)} & \multicolumn{2}{c}{Qwen (7B)} & \multicolumn{2}{c}{CodeS (7B)} \\ \cline{3-8}
         & & SFT & DPO & SFT & DPO & SFT & DPO \\ \midrule
        \multicolumn{8}{c}{\textbf{DB Perturbations}} \\ \midrule

        \multirow{3}{*}{schema-synonym} & Greedy & 66.3 & 66.4 (\textcolor{red}{+0.1}) & 63.3 & 63.5 (\textcolor{red}{+0.2}) & 62.0 & 62.2 (\textcolor{red}{+0.2}) \\
        & Pass@1 & 65.6 & 65.6 (\textcolor{red}{+0.0}) & 61.1 & 61.2 (\textcolor{red}{+0.1}) & 59.7 & 60.5 (\textcolor{red}{+0.8}) \\
        & Maj@K & 69.0 & 68.6 (\textcolor{darkgreen}{-0.4}) & 67.9 & 67.8 (\textcolor{darkgreen}{-0.1}) & 65.7 & 65.9 (\textcolor{red}{+0.2}) \\ \midrule

        \multirow{3}{*}{schema-abbreviation} & Greedy & 77.0 & 77.3 (\textcolor{red}{+0.3}) & 75.3 & 75.7 (\textcolor{red}{+0.4}) & 71.3 & 71.3 \phantom{(+0.3)} \\
        & Pass@1 & 75.4 & 75.4 \phantom{(+0.3)} & 73.3 & 73.5 (\textcolor{red}{+0.2}) & 69.8 & 70.1 (\textcolor{red}{+0.3}) \\
        & Maj@K & 78.2 & 77.9 (\textcolor{darkgreen}{-0.3}) & 77.1 & 77.7 (\textcolor{red}{+0.6}) & 74.2 & 74.2 \phantom{(+0.3)} \\ \midrule

        \multirow{3}{*}{DBcontent-equivalence} & Greedy & 52.9 & 52.4 (\textcolor{darkgreen}{-0.5}) & 63.4 & 63.4 \phantom{(+0.3)} & 62.0 & 62.3 (\textcolor{red}{+0.3}) \\
        & Pass@1 & 54.1 & 53.9 (\textcolor{darkgreen}{-0.2}) & 61.6 & 61.6 \phantom{(+0.3)} & 61.0 & 61.0 \phantom{(+0.3)} \\
        & Maj@K & 53.4 & 53.4 \phantom{(+0.3)} & 69.1 & 69.1 \phantom{(+0.3)} & 64.4 & 63.6 (\textcolor{darkgreen}{-0.8}) \\ \midrule

        \multirow{3}{*}{\textbf{Average}} & Greedy & 65.4 & 65.4 \phantom{(+0.3)} & 67.3 & 67.5 (\textcolor{red}{+0.2}) & 65.1 & 65.3 (\textcolor{red}{+0.2}) \\
& Pass@1 & 65.0 & 65.0 \phantom{(+0.3)} & 65.3 & 65.4 (\textcolor{red}{+0.1}) & 63.5 & 63.9 (\textcolor{red}{+0.4}) \\
& Maj@K & 66.9 & 66.6 (\textcolor{darkgreen}{-0.3}) & 71.4 & 71.5 (\textcolor{red}{+0.1}) & 68.1 & 67.9 (\textcolor{darkgreen}{-0.2}) \\

        
        \bottomrule
    \end{tabular}
\end{adjustbox}
    \caption{Vanilla model performance on DB perturbations of Dr.Spider dataset. Names of base models are abbreviated. \textbf{DSC (6.7B)}: Deepseek-coder-6.7b-instruct; \textbf{Qwen (7B)}: Qwen2.5-7B-Instruct; \textbf{CodeS (7B)}: CodeS-7b. \textbf{In this setting, we directly assess best checkpoint on Spider Dev.}} 
    \label{tab:drSpiderDBVanilla}
\end{table*}