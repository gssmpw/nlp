\begin{abstract}

DeFi (Decentralized Finance) is one of the most important applications of today's cryptocurrencies and smart contracts.
It manages hundreds of billions in Total Value Locked (TVL) on-chain, yet it remains susceptible to common DeFi price manipulation attacks.
Despite state-of-the-art (SOTA) systems like DeFiRanger and DeFort, we found that they are less effective to non-standard price models in custom DeFi protocols, which account for 44.2\% of the 95 DeFi price manipulation attacks reported over the past three years.
% 42 / 95 = 44.2%

In this paper, we introduce the first LLM-based approach, \tool, for detecting DeFi price manipulation attacks in both standard 
% price models, such as CPMM (Constant Product Market Makers) and Stableswap Invariant, }\juantao{Change to this}
% CPMM (Constant Product Market Makers) 
and custom price models.
Our insight is that large language models (LLMs) have certain intelligence to abstract price calculation from code and infer the trend of token price changes based on the extracted price models.
To further strengthen LLMs in this aspect, we leverage Foundry to synthesize on-chain data and use it to fine-tune a DeFi price-specific LLM. %an LLM specifically for price change inference.
Together with the high-level DeFi operations recovered from low-level transaction data, \tool detects various DeFi price manipulations according to systematically mined patterns.
Experimental results show that \tool achieves a high precision of 96\% and a recall rate of 80\%, significantly outperforming SOTA approaches.
%147 / 153 = 96%ï¼Œ 76 / 95 = 80%
%Moreover, \tool has successfully detected three latest price manipulation attacks during real-time monitoring.
Moreover, we evaluate \tool's cost-effectiveness and demonstrate its practicality by helping our industry partner confirm 147 real-world price manipulation attacks, including discovering 81 previously unknown historical incidents.
%and detecting three latest manipulation attacks in August 2024.

%\juantao{I think we could have a shorter abstract and save some space}
% Our evaluation of the 95 past real-world attacks shows that \tool achieves a superior detection accuracy of 80.0\%, significantly higher than 51.6\% with DeFiRanger, 35.8\% with DeFiTainter, and 52.6\% with DeFort.
% Moreover, our fine-tuning increases the detection accuracy by 19.0\% compared to the original GPT-3.5-based \name.
% \fixme{Additionally, we run \name on 968 suspicious transactions collected from our industry partner...} \dao{TODO}

\end{abstract}

% https://defillama.com/protocols