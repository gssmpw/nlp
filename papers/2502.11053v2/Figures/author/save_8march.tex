% \newcommand{\CLASSINPUTbottomtextmargin}{1in}
% \newcommand{\CLASSINPUTtoptextmargin}{2.4cm}
 %\documentclass[journal, a4paper]{IEEEtran}
\documentclass[journal]{IEEEtran}
%\usepackage{flushend}
\usepackage{verbatim}
\usepackage{amsmath,amssymb,amsfonts}
% \usepackage{algorithmic}
% \usepackage{algorithm}
\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
\usepackage{algorithm2e}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\usepackage{array}
\usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\usepackage{textcomp}
%\usepackage[latin]{babel}
%\usepackage[latin]{babel}
%\usepackage{stfloats}
% macro in aux fileb
%\usepackage{hyperref}
\usepackage[T1]{fontenc}
%\usepackage{libertine}
\usepackage{balance}
\usepackage{enumitem}
\usepackage{url}
\usepackage{cuted}%w<<<<<<<<<<
\usepackage[makeroom]{cancel}
\usepackage{lipsum}
%\usepackage{url}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{pdfpages}
\usepackage{mathrsfs}
\usepackage{bm}
%\usepackage{float}
% \usepackage{dblfloatfix}%% float equations
% \usepackage{multicol}
% \usepackage{multicol}
%\usepackage{caption}
%\usepackage{subcaption}
%\usepackage{appendix}
\usepackage[caption=false]{subfig}
\captionsetup[subfigure]{font=footnotesize,labelfont=footnotesize}
%\usepackage{subfigure}

% \ifCLASSOPTIONcompsoc
%     \usepackage[caption=false, font=normalsize, labelfont=sf, textfont=sf]{subfig}
% \else
% \usepackage[caption=false, font=footnotesize]{subfig}
% \fi

\usepackage{mathrsfs}
\hyphenation{op-tical net-works semi-conduc-tor}
%\usepackage[toc,page]{appendix}


\def\BibTeX{{\rm B\kern-.05emb{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\newcommand{\diag}[1]{\mathrm{diag}({#1})}


% Pie chart drawing library
%\usepackage{pgf-pie}

\usepackage{tikz}
\usepackage{circuitikz}
\usetikzlibrary{positioning}
%\usepackage{pgf}
\usepackage{pgfkeys}
\usetikzlibrary{spy}

\usepackage{pgfplots}

\usepgfplotslibrary{groupplots} % LATEX and plain TEX 
\usepgfplotslibrary[groupplots] % ConTEXt 
\usetikzlibrary{pgfplots.groupplots} % LATEX and plain TEX 
\usetikzlibrary[pgfplots.groupplots] % ConTEXt


% and optionally (as of Pgfplots 1.3):
\pgfplotsset{compat=newest}
\pgfplotsset{plot coordinates/math parser=false}
\usepackage{pgfplotstable}
\newlength\figureheight
\newlength\figurewidth

\usetikzlibrary{positioning}
\usetikzlibrary{patterns}

\usetikzlibrary{arrows.meta,positioning}
\tikzset{block/.style={draw, rectangle, fill=cyan!90,
        minimum height=2em, minimum width=3em},
    sum/.style={draw, circle, node distance=1cm},
    input/.style={coordinate},
    output/.style={coordinate},
    pinstyle/.style={pin edge={to-,thin,black}},
        saturation block/.style={%
            draw,
            path picture={
                % Get the width and height of the path picture node
                \pgfpointdiff{\pgfpointanchor{path picture bounding box}{south west}}%
                {\pgfpointanchor{path picture bounding box}{north east}}
                \pgfgetlastxy\x\y
                % Scale the x and y vectors so that the range
                % -1 to 1 is slightly shorter than the size of the node
                \tikzset{x=\x*.4, y=\y*.4}
                %
                % Draw annotation
                \draw [very thin] (-1,0) -- (1,0) (0,-1) -- (0,1);
                \draw [very thick] (-1,-.7) -- (-.7,-.7) -- (.7,.7) -- (1,.7);
            },
        }
    }

\tikzset{%
        rateLimit block/.style={%
            draw,
            path picture={
                % Get the width and height of the path picture node
                \pgfpointdiff{\pgfpointanchor{path picture bounding box}{south west}}%
                {\pgfpointanchor{path picture bounding box}{north east}}
                \pgfgetlastxy\x\y
                % Scale the x and y vectors so that the range
                % -1 to 1 is slightly shorter than the size of the node
                \tikzset{x=\x*.4, y=\y*.4}
                %
                % Draw annotation
                %\draw [very thin] (-1,-1) -- (-1,1) (-1,-1) -- (1,-1);
                \draw [very thin] (-1,0) -- (1,0) (0,-1) -- (0,1);
                \draw [very thick] (-1,-1) -- (1, 1);
            },
        }
    }

     %\usetikzlibrary{svg.path}
     \usepackage{scalerel}
\usepackage{hyperref}
    \definecolor{orcidlogocol}{HTML}{A6CE39}
    \tikzset{
      orcidlogo/.pic={
        \fill[orcidlogocol] svg{M256,128c0,70.7-57.3,128-128,128C57.3,256,0,198.7,0,128C0,57.3,57.3,0,128,0C198.7,0,256,57.3,256,128z};
        \fill[white] svg{M86.3,186.2H70.9V79.1h15.4v48.4V186.2z}
                     svg{M108.9,79.1h41.6c39.6,0,57,28.3,57,53.6c0,27.5-21.5,53.6-56.8,53.6h-41.8V79.1z M124.3,172.4h24.5c34.9,0,42.9-26.5,42.9-39.7c0-21.5-13.7-39.7-43.7-39.7h-23.7V172.4z}
                     svg{M88.7,56.8c0,5.5-4.5,10.1-10.1,10.1c-5.6,0-10.1-4.6-10.1-10.1c0-5.6,4.5-10.1,10.1-10.1C84.2,46.7,88.7,51.3,88.7,56.8z};
      }
    }

    \newcommand\orcidicon[1]{\href{https://orcid.org/#1}{\mbox{\scalerel*{
    \begin{tikzpicture}[yscale=-1,transform shape]
    \pic{orcidlogo};
    \end{tikzpicture}
    }{|}}}}


\begin{document}

%{\eem Ultra-Reliable Low-Latency Short Data Communications}(URLLSDC)
%\title{Ultra-Reliable Short Data Communications: Pushing Boundaries in BICM Receiver Algorithm Designs}
%\title{BICM Receiver Algorithm Designs for Ultra-)Reliable Short Block-Length Communications}
%\title{Novel BICM Receiver Algorithm Designs for Ultra-)Reliable Low-Latency Short Data Communications}
\title{Enhanced BICM Receiver Metrics for Ultra-Reliable\\Low-Latency Short Block Channel Communications}
%\title{Enhanced BICM Receiver Metrics for Reliable Short BlockLength Channel Communications}
 %\author{\IEEEauthorblockN{ Mody~Sy~}$\textsuperscript{\orcidicon{0000-0003-2841-2181}}$,~\IEEEmembership{}~and~ Raymond~Knopp$\textsuperscript{\orcidicon{0000-0002-6133-5651}}$~\IEEEmembership{}
\author{\IEEEauthorblockN{ Mody~Sy},~\IEEEmembership{Member IEEE}~and~ Raymond~Knopp,~\IEEEmembership{Fellow IEEE}
}
\makeatletter
\patchcmd{\@maketitle}
  {\addvspace{0.5\baselineskip}\egroup}
  {\addvspace{-1\baselineskip}\egroup}
  {}
  {}
\makeatother
        % <-this % stops a space
%\thanks{This paper was produced by the IEEE Publication Technology Group. They are in Piscataway, NJ.}% <-this % stops a space
%\thanks{Manuscript received April 19, 2021; revised August 16, 2021.}}

% The paper headers
%\markboth{IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS,~Vol.~14, No.~8, August~2021}%
%\markboth{IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS,~Vol.~x, No.~x, January~20xx}%
%{Shell \MakeLowercase{\textit{et al.}}: A Sample Article Using IEEEtran.cls for IEEE Journals}
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2021 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.

\maketitle
%\balance
\begin{abstract}
This paper presents BICM metrics for joint estimation and detection in short blocklength channels, addressing scenarios with unknown channel state information and low training dimension density. Leveraging a complete 5G transmitter-receiver setup with Polar and LDPC coded transmissions, we focus on interleaved reference signals and data over a limited OFDM symbol set, suitable for mini-slot transmissions in ultra-reliable, low-latency communications and short packet random access use cases. 
Performance evaluation spans SIMO and SU-MIMO configurations, emphasizing the efficacy of BICM detection in realistic base station receiver scenarios. Our findings indicate that BICM metrics, using four-symbol detection windows, achieve detection performance akin to coherent receivers with perfect channel state information for both polar and LDPC coded configurations.
\end{abstract}

\begin{IEEEkeywords}
Bit-Interleaved Coded Modulation, 5G NR Polar code, 5G NR LDPC Code, 5G NR Physical Uplink Channels, Short Data Transmission, Unknown Channel State Information, Joint Estimation and Detection.
\end{IEEEkeywords}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\balance
%\subsection{Motivations}
\IEEEPARstart{I}{t is  expected} that the 6G air-interface will build upon the 5G standard and address new pardigms for feedback-based cyber-physical systems combining
communications and sensing. In particular, there will be a need for tight control loops using the air-interface to control 6G-enabled objects with
high-reliability, perhaps even requiring lower latencies than those achieved by current 5G technology, for example sub-1ms uplink application-layer latency in  microwave spectrum. Although 5G transmission formats can provide very short-packet transmission through the use of mini-slots, the ratio of tranining
information to data is not necessarily adapted to extremely short data transmission. Moreover,
the transmission formats are designed with conventional quasi-coherent receivers which can be quite sub-optimal in such scenarios where accurate
channel estimation is impossible because of sporadic transmission of short packets. One such instance is because of stringent decoding latency
constraints such as those emerging in so-called {\em Ultra-Reliable-Low-Latency Communication} (URLLC) industrial IoT applications. 
This would be similar for evolved channel state information (CSI) feedback control channels or future combined-sensing and communication paradigms requiring rapid sensory feedback to the network. One of the main applications is in the field of mission-critical communications, such as those used by emergency services or in industrial control systems that require extremely high levels of reliability and low latencies.


In this work we investigate {\em bit-interleaved coded modulation} (BICM) and detection strategies for packets in the range of 20-100 bits for these envisaged beyong 5G/6G signaling scenarios. 
Furthermore, BICM stands as a ubiquitous coding paradigm in wireless communication channels, serving as a cornerstone for contemporary high spectral efficiency systems and low spectral efficiency orthogonal modulation systems.
The significance of BICM becomes especially evident in scenarios marked by error-prone communication channels, necessitating a heightened level of reliability. Its efficacy depends on detection and decoding metrics, requiring a nuanced equilibrium between enhanced performance and low complexity, especially in  URLLC scenarios. Noteworthy is the historical integration of BICM into 3GPP systems, a practice dating back to the 3G-era. 
\subsection{Relevant prior  of art}
There is a wealth of literature on {\em bit-interleaved coded modulation} (BICM) receivers from various perspectives \cite{zehavi92,  Fabregas08, CTB98} demonstrating their potential impact and importance in wireless communication.  Among the pioneers who sparked interest in BICM was the seminal work conducted by Caire et al. \cite{CTB98}, wherein they provided a comprehensive analysis of BICM in terms of information rate and probability of error, encompassing both coherent and non-coherent detection. Additionally, we express a specific interest in BICM {\em Multiple Input Multiple Output} (MIMO) receivers, emphasizing a focused inquiry into this area. This is particularly relevant as BICM MIMO OFDM emerges as an appealing prospect for future wireless networks, wherein MIMO enhances spectrum efficiency, OFDM reduces equalization complexity, and BICM provides reliable coded-modulations. In the initial years of the 21st century, noteworthy advancements were put forth in the design of maximum likelihood receivers tailored for MIMO systems \cite{Hochwald2003, Marzetta1999, Hochwald2000}. Afterwards, numerous research inquiries have been directed towards the design of low-complexity receivers for BICM MIMO systems, with a particular focus on low-dimensional and high-dimensional MIMO systems, but primarily restricted to coherent communication and more recently, particular attention has been paid to machine-learning-based MIMO receiver designs \cite{Carrera2021,
Cammerer2023}. Upon revisiting the core of this investigation, specifically short packet transmission, it becomes apparent that this area has garnered noteworthy scholarly attention in recent years. Considerable research efforts have been dedicated to various facets, including the design of signal codes, receiver designs \cite{Lee2018, sy2023_1, sy2023_2, Doan2022, Yue2023, Vu2023}, and the establishment of state-of-the-art converse and achievability bounds for coherent and non-coherent communications \cite{Xhemrishi2019, Polyanskiy2010, Durisi2016, Ostman2019jrnal, Martinez2011, Erseghe2016}.
%The literature review encompasses an assortment of finite block length information theoretic tools utilized in assessing coding schemes. 
%For the derivation of outer bounds (converse), reference is made to the metaconverse theorem \cite[Th. 28]{Polyanskiy2010}. Additionally, for the inner bound (achievability), a relaxed rendition of the random coding union (RCU) bound \cite[Th. 5]{Polyanskiy2010}, widely recognized as the RCUs bound \cite[Th. 1]{Martinez2011}, is provided.
%Another pertinent study by Xhemrishi et al. \cite{Xhemrishi2019} evaluates the receiver's performance concerning the list decoding of short codes for communication over unknown fading channels, with specific regard to the MC and RCU bounds.
\subsection{Contribution}
This study departs from preceding literature by introducing a novel BICM receiver design within the imperfect {\em Channel State Information} (CSI) scenario.
%, aiming to assess the impact of various channel conditions, particularly in the absence of precise CSI. 
Hence, we present enhanced receiver  metrics for short data in the range of \texttt{20-100} bits for the envisaged beyong 5G/6G signaling scenarios by evaluating their performance over  5G short block channels, utilizing  Polar and {\em Low-Density Parity-Check} (LDPC) coded formats.  We look into  receiver  metrics exploiting {\em Joint Estimation and Detection} (JED) which is amenable to situations where low-density {\em Demodulation Reference Signals} (DMRS) are interleaved with coded data symbols.
We specifically address situations where accurate channel estimation is impossible, demonstrating that a well-conceived metric exploiting interleaved DMRS in the detection metric computation achieves performance comparable to a receiver with perfect channel state information.  Remarkably, this approach demonstrates substantial performance gains when compared to conventional 5G {\em Orthogonal Frequency Division Multiplexing} (OFDM) receivers applicable to both uplink and downlink transmission scenarios. The proposed scheme conducts detection across contiguous sets of modulated symbols, including those derived from DMRS, to furnish soft metrics for the bits within each set to the channel decoder.\\
 Explicitly, our main proposal consists in the non-coherent metric design/use in which channel estimation based on averaging/smoothing over an appropriate number of dimensions exhibiting channel coherence, constitutes a part of the metric for generating the {\em log likelihood ratio} (LLR) outputs. In the process of short-block detection, we can make use of such a channel estimate that. In general, the channel estimation procedure will work as usual and the resulting channel estimates are fed into the proposed metrics.
Our contributions span the following principal  avenues.\\
Firstly, we proposed BICM metrics for general non-Coherent fading channels within a {\em Single-Input Multiple-Output} (SIMO) transmission that cater to the challenges posed by {\em line-of-sight} (LOS) channels paired with {\em non-line-of-sight} (NLOS) fading channels.
 Secondly, we extend  BICM metrics to accommodate the challenges posed by block fading channel, particularly within the context of  a $(\mathsf{N_ R}\times \mathsf{N_ T})$ {\em Single User}-MIMO.\\
Thirdly, we proposed  BICM metrics over LOS channels  within a $(\mathsf{N_R}\times 2)$ SU-MIMO transmission.
Finally, we introduce a new joint estimation and detection approach suitable for the proposed innovative receiver architectures, resulting in a notable enhancement in overall performance. 

 Collectively, these contributions propel the state-of-the-art in BICM, pushing the boundaries of receiver algorithm designs for the evolving landscape of future wireless communication systems.
\subsection{Paper Outline}
The article  is structured as follows. Section II lays out the system model and the foundations of NR polar and LDPC coded modulations, Section III focuses on the proposed BICM metrics, Section IV presents the results and performance analysis, and finally Section V concludes the paper.


{\em Notation :}
Scalars are denoted by italic letters, vectors and matrices are denoted by bold-face lower-case and upper-case letters, respectively.
 For a complex-valued vector $\mathbf x$, $|\lvert \mathbf x |\rvert$ denotes its Euclidean norm, $| \cdot |$  denotes the absolute value.  $\| \cdot \|_\mathsf{F}$ is the Frobenius norm of matrix.  $ \operatorname{tr}\{\cdot\}$ denotes the trace of matrix.
   $ \mathbb E\{\cdot\}$ denotes the statistical expectation. $\operatorname{Re}(\cdot)$ denotes the real part of a complex number. $\operatorname{I_0}(\cdot)$ is the zero-th order modified Bessel function of the first kind.
 %$diag(\mathbf A)$ denotes a diagonal matrix with each diagonal element being the corresponding element in $\mathbf A$.
$\mathbf I$ is  an identity matrix with appropriate dimensions.
Galois field  is denoted by $GF(2)$ or $\mathbb F_2$.
%$m\;s.t.\;e_j=b$ means the set of the constellation symbols  \emph{such that} bit $j-th$ bit $e$ is equal to $b$.
 $\mathbf x \in \chi^j_b=\left\{ \mathbf x: e_j=b\right\}$ is the subset of symbols $\{\mathbf x\}$ for which the $j-th$  bit of the label $e$ is  equal to $b=\{0,1\}$.  At the $j-th$ bit location or position and the number of bits required to a symbol is denoted by $m\triangleq \log_2\left(\mathcal M\right)$.
 The cardinality of $\chi$ is given by $\mathcal M\triangleq |\chi|$.
$ \Lambda^j\left(\cdot\right)$ denotes log likelihood ratio, with $j=1,2, \ldots, m$.
The superscripts  $^T$  and  $^\dag$ denote the transpose and  the complex conjugate transpose or Hermitian.
\section{General Framework}
\subsection{ Bit-Interleaved Polar-coded Modulation (BIPCM)}
 Bit Interleaved Polar Coded Modulation is referred to as BIPCM. In this instance we are dealing with the CRC-aided Polar (CA-Polar) coding scheme, one of the basic code construction techniques established by the 3GPP Standard\cite{3GPP38212}. Using polar codes as a channel coding scheme for 5G control channels has demonstrated the significance of Arikan's invention \cite{Arikan2009}, and its applicability in commercial systems has been  proven. This new coding family achieves capacity rather than merely approaching it as it is based on the idea of channel polarization. Polar codes can be used for any code rate and for any code length shorter than the maximum code length due to their adaptability.
They are the first kind of forward error correction codes that achieve symmetric capacity for any binary-input discrete memoryless channel under low-complexity encoding and low-complexity successive cancelation (SC) decoding with quasi-linear order for infinite length codes. In NR, the polar code is used to encode broadcast channel as well as DCI and uplink control information (UCI).

Furthermore, 3GPP NR uses a combination of \emph{CRC-assisted and {\em Polar Codes} (PC)}, which interleaves a CRC-concatenated block and relocates some of the PC bits into the middle positions of this block prior to performing the conventional polar encoding\cite{Ahmadi2018}. This allows a decoder to early terminate the decoding process as soon as any parity check is not successful.

Assume that the input message ({\em UL/DL Control Information}) before CRC attachment is $a(0), a(1),\ldots, a(A-1)$, where $A$ is input sequence,  parity bits are  $p(0), p(1),\ldots, p(L-1)$, $L$ is the number of parity bits. For the downlink, a CRC of length $L=24$ bits is used, and for the uplink, depending on the quantity of $A$, CRCs of length $L=6$ and $L=11$ bits are used.
The message bits after attaching CRC are $b(0), b(1),\ldots, b(B-1)$, where  $B$ is the size of control information with CRC bits:  $B = A + L$.\\
The input bit sequence to the code block segmentation is denoted $a(0), a(1),\ldots, a(A-1)$, where  value of $A$ is no larger than $1706$.
Assume that the maximum code block size is $A^{\prime}$ and $C$  the number of existing code blocks, the sequence
$c_r(0), c_r(1),\ldots, c_r(A^{\prime}/C-1)$ is used to calculate the CRC parity bits $p_r(0), p_r(1),\ldots, p_r(L-1)$. The sequence of bits resulting after attaching a CRC to the $r-th$ code block is denoted by $c_r(0), c_r(1),\ldots, c_r(K_r-1)$ , where $K_r$ is the number of bits in the $r-th$ code block to be fed to the channel encoder. Then, the coded bit are denoted by $d(0), d(1), \ldots,  d(N_r-1)$  where $N_r = 2^n$. %(code length of the polar code).
Denote by $E_r$ the rate matching output sequence length of the $r-th$ coded-block: \textit{if} $E_r \leq(9 / 8) \cdot 2^{\left(\left\lceil\log _2 E_r\right\rceil-1\right)}$ and $K / E_r<9 / 16$
$n_1=\left\lceil\log _2 E_r\right\rceil-1$, \textit{else} $n_1=\left\lceil\log _2 E_r\right\rceil$. And then,
$R_{\min }=1 / 8$;
$n_2=\left\lceil\log _2\left(K / R_{\text {min }}\right)\right\rceil$;
$n=\max \left\{\min \left\{n_1, n_2, n_{\max }\right\}, n_{\text {min }}\right\}$ )
where $n_{\min }$ and $n_{\max }$ provide a lower and an upper bound on the code length, respectively. In particular, and $n_{\min }= 5$  and $n_{\max }=9$ for the downlink control channel, whereas $n_{\max }=10$ for the uplink control channel.
%
% UE is not expected to be configured with $K + n_{PC} > E$ , where $n_{PC}$ is the number of parity check bits.
The polar encoding process is based on a well-defined procedure outlined in \cite{3GPP38212}:

\begin{itemize}
  \item  The sequence $c(0) , c(1), \ldots, c(K_r-1)$ is interleaved into bit sequence $c^\prime(0) ,c^\prime(1), \ldots,  c^\prime(K_r-1)$  via a definite interleaving pattern  \cite{3GPP38212}.
  \item  The interleaved vector $\mathbf c^\prime$ is assigned to the information set along with the PC bits, while the remaining bits in the $N$-bit vector $\mathbf u$ are frozen. Hence,
$\mathbf u= u(0), u(1),\ldots, u(N_r-1)$ is generated according to the clause 5.3.1.2 \cite{3GPP38212}.
% u = Subchannel allocation + PC bits calculation
  \item  Denote $\mathbf{G}_{N_r}=\left(\mathbf{G}_2\right)^{\otimes n}$ as the $n-th$ Kronecker power of matrix $\mathbf G_2$ , where $\mathbf{G}_2=\left[\begin{array}{ll}1 & 0 \\ 1 & 1\end{array}\right]$,
the output after encoding $\mathbf d=d(0), d(1), \ldots,  d(N_r-1)$ is obtained by $\mathbf d=\mathbf u\mathbf G_{N_r}$, where encoding is performed in $\mathbb{F}_2$.
\end{itemize}
Subsequently, a rate matching process is performed per coded block, involving sub-block interleaving, bit collection, and bit interleaving. The output bit sequence after rate matching consists of sequences $e_{r,k} $, where $r = 0,\ldots, C-1$ and $k = 0,\ldots, E_r -1$, with $E_r$ being the number of rate-matched bits for the $r$-th code block. Different techniques such as perforation, shortening, or repetition ($E_r \geq N_r$) may be applied during rate matching to convert a vector of $N_r$ bits into a vector of $E_r$ bits. Following rate matching, code block concatenation is performed to convert all code block messages into a sequence of transport block messages. The output bit sequence after code block concatenation is denoted as $f(0), f(1),\ldots,f(E-1)$.
Regarding the decoding process, several main polar code decoding algorithms are currently used, including the SC algorithm \cite{Arikan2009}, the SCL algorithm \cite{Stimming2014, Tal_vardy2015}, the CA-SCL algorithm \cite{Zhang2017, Niu2012}, the {\em belief propagation} (BP) algorithm \cite{Arikan2008}, and the {\em successive cancellation with adaptive node} (SCAN) algorithm \cite{Fayyaz2013}. These algorithms, along with simplified versions, have been extensively researched in the literature. The SC algorithm, initially proposed by Arikan, exhibits suboptimal performance for finite-length codes. The SCL algorithm improves upon the SC algorithm by providing multiple paths and outperforms it in terms of performance. The CA-SCL algorithm incorporates a high-rate CRC code to assist in selecting the correct codeword from the final list of paths in the SCL decoder, effectively enhancing its reliability. It has been observed that the right codeword is usually included in the list every time the SCL decoder fails. \\
The performance ranking of the decoding algorithms is as follows: \texttt{CA-SCL$ > $ state-of-the-art SCL$>$BP=SCAN$>$SC}. Therefore, for improved performance, the channel decoder technique should utilize CRC-Aided Successive Cancellation List decoding for downlink (DCI or BCH) or uplink (UCI) messages. The adoption of polar codes by 3GPP was partly due to the well-acknowledged potential of CA-SCL decoding to outperform Turbo or LDPC codes.\\
Figure~\ref{fig:bicm_polar_ldpc} presents an overview of the BIPCM/BILCM process, spanning from the medium access control (MAC) layer to the physical layer processing, specifically for uplink channels. The transmit-end procedure includes several steps such as adding a transport block CRC, segmenting code blocks with additional CRC attachment, channel encoding, rate matching, code block concatenation, and modulation. It is important to emphasize that the receiving chain simply follows the reverse flow of the transmitting chain.
\begin{figure*}[ht]\centering
  \includegraphics[width=0.78\linewidth]{figures/sdt/dmrs_density/tikz/tx_chain.pdf}
      \caption{Bit-Interleaved Polar/LDPC coded Modulation (BIPCM/BILCM) : Transmitter end.}
      \label{fig:bicm_polar_ldpc}
\end{figure*}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bit-Interleaved LDPC-coded Modulation (BILCM)}
Bit-Interleaved LDPC-Coded Modulation is referred to as BILCM. First proposed by Gallager in the early 1960s \cite{Gallager63}, LDPC coding has proven to be highly suitable for 5G NR due to its advantages such as high throughput, low latency, efficient decoding complexity, and rate compatibility. The performance of LDPC codes in 5G NR is impressive, exhibiting an error floor at or below the $10^{-5}$ {\em block error rate} (BLER), a significant improvement over traditional coding techniques. The QC-LDPC family forms the basis for 5G NR LDPC codes.

The construction of an NR LDPC code involves a base graph matrix ($\mathbf{BG}$) of dimension $M \times N$, denoted as $\mathbf H_{\mathsf{BG}}$. The choice of $\mathbf H_{\mathsf{BG}}$ matrices in the 5G NR coding process depends on the coding rate and the length of the transport block or code block. Two base graphs are commonly used: $\mathbf{BG}_1$ with dimensions $N = 68$ and $M = 46$, optimized for large information block sizes ($K \leq 8448$) and high coding rates ($1/3 \leq R \leq 8/9$), and $\mathbf{BG}_2$ with dimensions $N = 52$ and $M = 42$, optimized for small information block sizes ($K \leq 3840$) and lower coding rates ($1/5 \leq R \leq 2/3$).
These LDPC codes are particularly well-suited for scenarios requiring high reliability, as they offer additional coding gain at low code rates. The maximum number of information bits for $\mathbf{BG}_1$ is $K=22Z_c$, and for $\mathbf{BG}_2$ it is $K=10Z_c$, where $Z_c$ represents the lifting size. Each base graph has 51 different lifting sizes, ranging from 2 to 384.

The parity check matrix $\mathbf{H}$ is derived from $\mathbf H_{\mathsf{BG}}$ by replacing each element with a cyclic permutation identity matrix, denoted as $\mathbf I(\mathrm {p_{ij}})$. In this process, each element of $\mathbf H_{\mathsf{BG}}$ is substituted with the corresponding {\em cyclic permutation matrix} (CPM), along $\mathrm {p_{ij}}$ times. The resulting matrix $\mathbf{H}$ has a size of $m\times n$, with $m = M \times Z_c$, $n = N \times Z_c$, and $k = n - m = (N-M) \times Z_c$. Both $\mathbf{BG}_1$ and $\mathbf{BG}_2$ share similar structures.

Due to the specific structure and features of these base graphs, various effective LDPC encoding techniques have been developed. Recently, a novel and efficient encoding technique was proposed in \cite{Nguyen2019}, which offers high throughput and low complexity, making it an attractive option for LDPC coding architecture.


Futhermor, the transmission process begins by attaching a CRC to the transport block. The CRC is an error detection code used to measure the Block Error Rate (BLER) after decoding. The entire transport block is used to calculate the CRC parity bits. Let the transport message before CRC attachment be denoted as $a(0), a(1),\ldots, a(A-1)$, where $A$ is the size of the transport block message. The parity bits are represented as $p(0), p(1),\ldots, p(L-1)$, where $L$ is the number of parity bits. If $A > 3824$, $L$ is set to $24$, otherwise, it is set to $16$.

The message bits after attaching CRC are denoted as $b(1), b(2),\ldots, b(B)$, where $B$ is the size of the transport block information with CRC bits, and $B = A + L$.

The LDPC base graph is selected based on the size of the transport block message $A$ and the transport block coding rate $R$. If $A\leq 292$, or if $A\leq 3824$ and $R\leq0.67$, or if $R \leq 0.25$, LDPC $\mathbf{BG}_2$ is used. Otherwise, LDPC $\mathbf{BG}_1$ is used.

The output of code block segmentation and CRC attachment is denoted as $c_r(1), c_r(2),\ldots, c_r(K_r)$, where $K_r = K^{\prime}_r+ L$, and $K^{\prime}$ represents the number of bits in the $r$-th code block, and $L$ is the number of attached CRC bits on the $r$-th code block. Each code block message is encoded independently.

In 3GPP NR, the input bit sequence is represented as $\mathbf c = [c(0), c(1),\ldots, c(K_r-1)]^T$, where $K_r$ is the number of information bits in a code block, and the redundant bits are called parity bits, denoted by $\mathbf w=[w(0), w(1),\ldots, w(N_r+2 Z_c-K_r+1)]^T$. The LDPC-coded bits are denoted by $d(0), d(1),\ldots, d(N_r-1)$.

A code block is encoded by the LDPC encoder based on the following procedure \cite{3GPP38212}:
\begin{enumerate}
  \item Find the set with index iLS  which contains $Z_c$ in \cite{3GPP38212}.
  \item Set $d_{k-2 Z_c}=c_k, \forall k=2 Z_c, \ldots, K_r-1$
  \item Generate $N_r+2 Z_c-K_r$ parity bits $\mathbf w=[w(0), w(1),\ldots, w(N_r+2 Z_c-K_r+1)]^T$ such that $\mathbf H \times \left[ \mathbf c \ \mathbf w \right]^T=\mathbf{\mathbf 0}$
  \item The encoding is performed in $\mathbb F_2$.
  \item Set $d_{k-2 Z_c}=w_{k-K_r}, \forall k=K_r, \ldots, N_r+2 Z_c-1$
\end{enumerate}
The subsequent steps involve rate matching and code block concatenation. At the receiver, the LDPC decoding is performed on each code block individually. For LDPC decoding, various techniques can be implemented, with belief propagation (BP) methods being the most commonly used. BP methods rely on iterative message exchange between bit nodes and check nodes, offering near-optimal decoding performance at the cost of computational complexity.
To strike a better balance between performance and complexity, several effective decoding algorithms have been proposed in the scientific literature. Among these, layered message passing decoding stands out as a promising approach for URLLCs due to its ability to accelerate convergence time. As a result, it is a suitable candidate for investigation in our study.
The layered decoding principle can be illustrated using the following principles, as described in the work of Wang et al. \cite{wang2021}:
\begin{itemize}
  \item Each layer independently processes variable node operations and checks node operations.
  \item Current layer's input LLR is the prior layer's output LLR.
  \item The output LLR of the decoding algorithm, which is the output LLR of the last layer, will be used to make the decision.
  \item The input LLR of the current layer can be updated according to the equation  $\mathcal L_{k+1, i}= \mathcal L_{k, i} - \mathcal L_{k+1, i'}$
  where  $\mathcal L_{k+1, i}$ is the updated input LLR of layer $k+1$, $\mathcal L_{k, i}$ is the output LLR of previous layer $\mathcal L_{k+1, i'}$ and is the old input LLR of layer $k+1$.
\end{itemize}

\subsection{Modulation and Resource Mapping}
In both scenarios, the encoded payload undergoes rate-matching and block concatenation prior to being fed to a QPSK modulator. This process yields a set of complex-valued modulation symbols. Subsequently, the resource allocation process is executed, where one or multiple OFDM symbols are used to allocate the modulated symbols to resource blocks and insert the  DMRS resources. The number of resource blocks is determined by the payload size and coding settings. When the payload size is small, fewer resource blocks are required, thereby maintaining a constant effective coding rate.

The resource mapping process depicted in Figure~\ref{fig:bicm_polar_ldpc} follows a similar approach to the resource mapping used in 3GPP \textit{physical uplink control channel} (PUCCH) formats 2 transmission\cite{3GPP38211}.
% \begin{figure}[!ht]
%         \centering
%         %\includegraphics[width=0.5\linewidth]{figures/sdt/DMRS_density/4DMRS.pdf}
%         \input{figures/sdt/dmrs_density/tikz/4dmrs.tex}
%         \caption{General resource mapping: 1 OFDM  symbol.}
%         \label{fig:re_mapp_pucch2_1symb}
% \end{figure}

Phrased directly, the transmitted signal $\mathbf{x}$ typically consists of data-dependent $\left(\mathbf{x}^{(\mathsf d)}\right)$ and data-independant $\left(\mathbf{x}^{(\mathsf p)}\right)$ components known as pilot or reference signals. The reference signals are used to mitigate channel ambiguity in time, frequency, and space.  Specifically, they are employed to estimate the channel.
In practice, the reference  signals are commonly interleaved among the data-dependent components. It is notably the case in current OFDM systems. In earlier CDMA systems, reference  signals were sometimes superimposed on top of data-dependent signals.
The number of data dimensions is denoted by $N_d$, and the number of reference signal dimensions is denoted by $N_p$, where $N_d+N_p=N$.
In 3GPP standard, $N$ is typically equal to $12\mathcal{K}\mathcal{L}$. This represents the number of complex dimensions or resource elements in the physical resource blocks. The number of physical resource blocks, $\mathcal{K}$ ranges from $1$ to $16$, while the number of symbols, $\mathcal{L}$, ranges from $1$ to $14$, and can be increased if multiple slots are used for signaling the channel bits.
The assumption in this work is that the data-dependent components of $\mathbf{x}$ are generated from a binary code whose output is interleaved and mapped to an $M$-ary modulation symbol alphabet. We will assume that the binary code generates $E$ bits and the interleaver mapping is one-to-one so that $E$ bits are also fed to the modulator. The binary-code and interleaver combination can thus be seen as a $(E,B)$ binary block code. Denote the $E$ coded bits as $e_k,k=0,1,\cdots, E-1$. Adjacent $\log_2 M$ bit-tuples are used to select the $N_E$ modulated symbols in the symbol alphabet. Typically, we will assume that a Gray mapping is used in the case of non-binary modulation.
\subsection{Pilot allocation procedure within the spatial dimension}
It should be stressed that MIMO systems must take into account the way in which pilot symbols are allocated in the spatial dimension, in addition to the time and/or frequency dimension. Precisely, the transmission of training symbols must be executed in a manner that prevents interference, ensuring the accurate estimation of channel state information.
This consideration involves the exploration of pilot allocation methodologies that leverage frequency orthogonality, time orthogonality, and signal orthogonality.% (i.e., pertains to the design of sequences based on mutual orthogonality, incorporating  the utilization of Zadoff-Chu sequences  for instance).
The most straightforward method for interleaving pilot symbols and data is arguably through time and/or frequency insertion, although other approaches such as superposition or code-division multiplexing are also possible\cite{Hampton2013}.
In the instance of block fading, at least $N_\mathsf{T}$ pilot symbols must be inserted in each coherence block, one per antenna, with $N_\mathsf{p} \geq N_\mathsf{T}$ pilot symbols per coherence block \cite{Heath2018}.
Widely adopted in today's emerging communication standards, frequency orthogonality seems to have more merit and is particularly well suited to OFDM-type systems.
Here, frequency orthogonality is used to transmit pilot symbols simultaneously, thereby preventing interference at the receiver. This is achieved by mapping the pilot symbols onto distinct subcarriers within the transmit antenna streams, as illustrated in Figure~\ref{fig:ref_orthogonality}.
\begin{figure}[!ht]
        \centering
        \includegraphics[width=0.7\linewidth]{figures/sdt/dmrs_density/tikz/orthoganity_in_freq.pdf}
        \caption{Spatial pilot allocation via frequency-based pilot orthogonality}
        \label{fig:ref_orthogonality}
\end{figure}
\section{BICM Receiver Design}
\subsection{A \texorpdfstring{$(\mathsf{N_R} \times 1)$} \ ~SIMO within Non-Coherent Fading Channel}
Considering a SIMO OFDM BICM system with a single antenna element on the transmit array and multiple element receive arrays. The system dimensions are defined as $\mathsf{N_R} \times (\mathsf{N_T}=1) $, The transmitted and received signals are $N$-dimensional column vectors, and thus a system is designed in such a way that the relationship between the transmitted and received signals is as follows: $\mathbf{y}_i = \mathbf h_i\mathbf{x}+ \mathbf{z}_i, \quad i=0,1,\cdots,\mathsf{N_R}-1$.
where $\mathbf{y}_i$  represents an observed vector in $N$ complex dimensions, $\mathbf{x}$  is and  $N$-dimensional transmitted vector,  $z$ is additive white Gaussian noise whose  real and imaginary components are independent and have variance $\sigma^2$ in each dimension.
\subsubsection{Perfect Channel State Information}~\\
 In the instance of perfect channel state information, the set of observed random vectors needs to be augmented by the set of channel vectors $\{\mathbf{h}_i\}$ in equations (\ref{eqn:lf_simo}-\ref{eqn:llr_simo}).

 
 The likelihood function  is
 \begin{equation}\label{eqn:lfpcsi1}
 \begin{gathered}
   \mathrm q\left(\mathbf{x},\left\{\mathbf{y}_i, \mathbf h_i\right\}\right)=p\left(\left\{\mathbf{y}_i, \mathbf h_i\right\} \mid \mathbf{x}\right)=
   p\left(\left\{\mathbf{y}_i\right\} \mid \mathbf{x}, \mathbf h_i\right) p\left(\left\{\mathbf h_i\right\} \mid \mathbf{x}\right)
   \end{gathered}
   \end{equation}
   If the transmitted signal ${\mathbf x}$ is independent of the channel realization $\{\mathbf h_i\}$,  the term $p\left(\left\{{\mathbf h}_i\right\}\mid\mathbf{x}\right)$ in (\ref{eqn:lfpcsi1}) can be dropped since it will disappear in (\ref{eqn:lfpcsi}). The likelihood function is equivalent to
   % \begin{equation}\label{eqn:lfpcsi}
   % \begin{gathered}
   % \mathrm q\left(\mathbf{x},\left\{\mathbf{y}, \mathbf h\right\}\right)=\prod_{i=0}^{\mathsf{N_R}-1}\frac{1}{(\pi \mathrm {N}_0)^N} \exp \left(-\frac{\lvert|\mathbf y_i-\mathbf h_i \mathbf x\rvert|^2}{\mathrm {N}_0}\right)
   % \end{gathered}
   % \end{equation}
   \begin{equation}\label{eqn:lfpcsi}
   \begin{gathered}
   \mathrm q\left(\mathbf{x},\left\{\mathbf{y}, \mathbf h\right\}\right)\propto \prod_{i=0}^{\mathsf{N_R}-1}\exp \left(-\frac{\lvert|\mathbf y_i-\mathbf h_i \mathbf x\rvert|^2}{\mathrm {N}_0}\right)
   \end{gathered}
   \end{equation}
   %\textbf{Definition 1 :}  Norm extension.)
Using the norm extension property, ignoring terms that are independent of $\mathbf x$,
   %It's well known that :
   % \begin{equation}\label{eqn:decomp}
   % \lvert|\mathbf{y}_{i} -  h_i  \mathbf x \rvert|^2 =\lvert| \mathbf{y}_{i} \rvert|^2 +  \lvert|h_i  \mathbf x \rvert|^2 - 2\mathrm{Re}\left(\mathbf y_ih_i^\dag \mathbf x^\dag\right)\nonumber
   % \end{equation}
   % %\subsubsection*{Corollary 1}
   % Then the likelihood function after removing multiplicative terms independent of $\mathbf x$ is
then the likelihood function is
   \begin{equation}\label{eqn:lfpcsi3}
   \begin{aligned}
   &\mathrm q\left(\mathbf{x},\left\{\mathbf{y}, \mathbf{h}\right\}\right) \propto
   &\prod_{i=0}^{\mathsf{N_R}-1}\exp \left(\frac{ 2\operatorname{Re}\left(\mathbf{y}_i \mathbf h_i^\dag \mathbf{x}^\dag\right) -\lvert|\mathbf h_i \mathbf{x}\rvert|^2}{\mathrm {N}_0}\right)
   \end{aligned}
   \end{equation}

The likelihood of coded bit $e_j\in\{0,1\}$ is
   \begin{equation}\label{eqn:lf_simo}
   q_{j,b}\left(\mathbf y_i\right)=\sum_{\mathbf x \ \in \ \chi_b^j}\mathrm q\left(\mathbf{x}, \mathbf y_i\right).
   \end{equation}
   % $e_j$ is the $j-th$ bit of symbol $x$, $m\;s.t.\;e_j=b$ is the set of the constellation symbols  such that bit $b = \{0, 1\}$.
   % and $m\;s.t.\;e_j=1$  is the set of the constellation symbols  such that  bit $e_j = 1$.
As is common in the case of BICM-based systems, the soft input to the binary channel decoder is given as the log-likelihood ratio (LLR) for coded bit $j$.
\begin{equation}\label{eqn:llr_simo}
   \Lambda^j\left(\mathbf y_i\right)=\log\frac{q_{j,0}\left(\mathbf y_i\right)}{q_{j,1}\left(\mathbf y_i\right)}.
\end{equation}

We  simplify (\ref{eqn:llr_simo}) via a \emph{max-log approximation}
$\log \left\{\sum_{i} \exp \left(\lambda_{i}\right)\right\} \sim \max _{i}\left\{\lambda_{i}\right\}$ letting (\ref{eqn:llr_simo}) to be simplified as
 \begin{equation}\label{eqn:maxlog_simo_conv_rx}
 \begin{aligned}
\Lambda^j\left(\mathbf y\right)&=  \displaystyle \max _{\mathbf x \ \in \ \chi_0^j}\frac{1}{\mathrm {N}_0} \sum_{i=0}^{\mathsf{N_R}-1}2\operatorname{Re}\left(\mathbf{y}_i \mathbf h_i^\dag \mathbf{x}^\dag\right) -\lvert|\mathbf h_i \mathbf{x}\rvert|^2 )\\&-\displaystyle \max _{\mathbf x \ \in \ \chi_1^j} \frac{1}{\mathrm {N}_0} \sum_{i=0}^{\mathsf{N_R}-1}2\operatorname{Re}\left(\mathbf{y}_i \mathbf h_i^\dag \mathbf{x}^\dag\right) -\lvert|\mathbf h_i \mathbf{x}\rvert|^2.
 \end{aligned}
 \end{equation}
We consider the ideal receiver, referred to as {\em Perfect CSI}, as a benchmark for comparison with the subsequent receiver architectures. This above metric is typically employ in conventional quasi-coherent receivers based on a separate least-squares channel estimation method by substituting $\mathbf{h}$, with the corresponding estimated channel $\hat{\mathbf h}$.
For the primary case of interest here, namely transmission without channel state information, single symbol detection is impossible. At the very least, the observation of one reference symbol must be used to generate likelihoods of the coded bits of a data symbol, thus warranting the study of block detection.
Moreover, within the framework of a conventional receiver, it is presupposed that, at the very least, the observation of a single reference signal spans the entirety of a {\em Physical Resource Block} (PRB) to generate the coded bit corresponding to each data symbol within that PRB. Consequently, a block is construed as comprising a singular data symbol. We will note this case throughout this manuscript as {\em No CSI} ($N_d=1$).
\subsubsection{Non-Coherent Fading Channels}~\\
We describe BICM metrics for a general non-coherent fading channel with unknown phase on the line-of-sight (LOS) components
and fully unknown diffuse (Non-LOS) components. The overall unknown channel gain is given by
$\mathbf {h}_i=\left(\sqrt{\alpha}e^{j\theta_i}+\sqrt{1-\alpha}\mathrm h_i^{(f)}\right)\mathbf{I}$ where $\theta_i$ is assumed to
be i.i.d. uniform random variables on $[0,2\pi)$, $\mathrm h_i^{(f)}$ is a zero-mean, unit-variance, circularly-symmetric complex Gaussian random variable and $\alpha$ is the relative strength of the LOS component.
The amplitude $|\mathrm h_i|$ on each receiver is thus Ricean distributed. It is worth noting that
the i.i.d. assumption for the ${\theta_i}$ is somewhat unrealistic for a modern array receiver with accurate calibration.
The phase differences would be more appropriately characterized by two random-phases, one originating from the time-delay between transmitter and receiver and the other from the angle of arrival of the incoming wave. The phase differences of individual
antenna elements for a given carrier frequency could then be determined from the angle of arrival and the particular
geometry of the array. To avoid assuming a particular array geometry, the i.i.d. uniform model provides a simpler and universal means to derive a receiver metric.\\
\textbf{Proposition 1}:
After neglecting multiplicative terms independent of the transmitted message, the likelihood function can be expressed as follows:

\begin{equation}\label{eqn:llrfunction_simplified}
\begin{aligned}
\mathrm q\left(\mathbf{x},\mathbf y\right)&= \prod_{i=0}^{\mathsf{N_R}-1} \frac{1}{\mathbf L_{\mathsf x}}\exp \left(  -\frac{ \alpha \left\|\mathbf x \right\|^2 }{\mathbf L_{\mathsf x}}  + \right. \\& \left. \beta_x \left| \mathbf x^\dag \mathbf y_i\right|^2\right)\times\operatorname{I_0}\left(  \frac{2\sqrt{\alpha}}{\mathbf L_{\mathsf x}}\left|\mathbf x^\dag\mathbf y_i\right|\right),
\end{aligned}
\end{equation}
where
$\mathbf L_{\mathsf x} = \mathrm {N}_0+ 2(1-\alpha) \left\|\mathbf x \right\|^2$,  $\mathbf \beta_x = \frac{2(1-\alpha)}{\mathrm {N}_0(\mathrm {N}_0 +2(1-\alpha) \left\|\mathbf x \right\|^2)}$ and $\operatorname{I_0}(\cdot)$ is the zero-order
modified Bessel function. The proof can be found in section A of the appendix.


Note that in the resulting expressions  of  LLR of coded bit, we do not limit the dimensionality of the observations when computing likelihoods of particular bits. In the original work of Caire {\em et al}\cite{CTB98} the authors assume an ideal interleaving model which allows limiting the observation interval of a particular coded bit to the symbol in which it is conveyed. For long blocks this assumption is realistic for arbitrary modulation signal sets and is sufficient for BPSK and QPSK irrespective of the block length when the channel is known perfectly. Nevertheless, practical systems usually apply single symbol likelihood functions for short blocks and high-order modulations.\\
% \subsubsection*{Proof}
% See appendix in  Section A.\\
\textbf{Corollary 1}: 
Metric calculations based on equation (\ref{eqn:llrfunction_simplified}) can be computationally complex to implement. To simplify the calculations, the \emph{max-log approximation} is commonly used. First, an exponential approximation is applied to the modified Bessel function of the first kind $\operatorname{I_0}(z)$, which results in the approximation $\operatorname{I_0}(z) \sim \frac{e^z}{\sqrt{2\pi z}} \sim e^z$. Using this approximation, the log-likelihood ratio (LLR) for coded bit $j$ is given by (\ref{eqn:maxlog_llr_simo}).
 \begin{figure*}%[!ht]
 \hrulefill
\begin{align}\label{eqn:maxlog_llr_simo}
 %\resizebox{\textwidth}{!}{$
\begin{array}{r}
\Lambda^j\left(\mathbf y\right)= \displaystyle\max _{\mathbf x \ \in \ \chi_0^j}\left( \displaystyle\sum_{i=0}^{\mathsf{N_R}-1}-\frac{\alpha\left\|\mathbf{x}\right\|^2}{\mathbf L_\mathsf x}+\mathbf{\beta}_x\left|\mathbf{x}^\dag \mathbf{y}_i\right|^2+\frac{2 \sqrt{\alpha}}{\mathbf L_\mathsf x}\left|\mathbf{x}^\dag\mathbf{y}_i\right|\right)-\sum_{\mathbf x \ \in \ \chi_0^j} \displaystyle \mathsf{N_R}\log \left(\mathbf L_\mathsf x\right)\\
\quad- \displaystyle\max _{\mathbf x \ \in \ \chi_1^j}\left( \displaystyle\sum_{i=0}^{\mathsf{N_R}-1}-\frac{\alpha\left\|\mathbf{x}\right\|^2}{\mathbf L_\mathsf x}+\mathbf{\beta}_x\left|\mathbf{x}^\dag \mathbf{y}_i\right|^2+\frac{2 \sqrt{\alpha} }{\mathbf L_\mathsf x}\left|\mathbf{x}^\dag\mathbf{y}_i\right|\right)+  \displaystyle\sum_{\mathbf x \ \in \ \chi_1^j}\mathsf{N_R}\log\left(\mathbf L_\mathsf x\right).
 \end{array}
 %$}
  \end{align}
  \hrulefill
 \end{figure*}
\textbf{Remark 1}: Please note that in equation (\ref{eqn:maxlog_llr_simo}), several terms can be omitted when the magnitude of vector $\mathbf{x}$ remains constant, as is the scenario in BPSK or QPSK modulation, for example. Additionally, in the presence of strong line-of-sight (LOS) channels, the quadratic terms in equation (\ref{eqn:maxlog_llr_simo}) can also be disregarded.

Furthermore, the computational complexity of the LLR metric in a BICM SIMO system is typically on the order of $\mathcal O(\mathsf{N_R} \times N_d \times \log_2 \mathcal M)$. This complexity exhibits linearity with respect to the number of received data symbols ($N_d$), the number of receiving ($\mathsf{N_R}$) antennas , as well as the size of the modulation alphabet ($\mathcal M$). Consequently, an increase in the number of symbols or receiving antennas results in a linear escalation of computational complexity.
\subsubsection{Joint Estimation and Detection}~\\
For the case of polar or LDPC-coded data, there is a compelling motivation to divide the coded streams into smaller blocks for detection due to complexity reasons. 
Furthemore, assuming an ideal interleaving scenario with known channels \cite{CTB98}, detection can be performed on individual modulated symbols. However, in the presence of joint detection and estimation, where interleaved DMRS and data symbols are considered, we need to deal with short blocks that encompass both data and DMRS symbols. To achieve this, the $N$-dimensional vectors $\mathbf{y}$ and $\mathbf{x}$ are subdivided into smaller, more manageable  segments of blocks. Subsequently, the detection metric is applied to each of these underlying segments.\\
\textbf{Proposition 2}: Observing the structure of the metrics and the absence of overlap between the data and DMRS symbols,
we can easily see that the estimated {\em channel impulse response} (CIR) is part of the metric.
By writing $\mathbf x = \mathbf{x^{(\mathsf p)}} + \mathbf{x^{(\mathsf d)}} $
where  $d$ and $p$ are subscripts representing data, DMRS components, respectively, we can
reveal $\hat{\mathbf h}^{\mathrm{LS}}$ in the metrics:
\begin{align}
\left|{\mathbf x}^\dag{\mathbf y_i}\right| &= \left|\underbrace{{\mathbf x^{(\mathsf p)}}^\dag\mathbf{y}^{(\mathsf p)}_{i}}_{\text {channel estimate}}  + \ {\mathbf x^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right|=\left|N_p \hat{\mathrm h}^{{\text{\tiny{LS}}}}_i +  \ {\mathbf x^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right|.
\label{eqn:joint_estim_simo}
\end{align}
%The estimation of the channel's characteristics is achievable through the computing of the correlation between the reference transmitted signal and the reference received signal.

Mathematically, we can deduce the following relationship: $\mathbf {x^{(\mathsf p)}}^\dag y^{(\mathsf p)}_{i}=\left(\mathbf{x^{(\mathsf p)}}^\dag\mathbf y_{p}\right) \hat{\mathrm h}_i^{{\text{\tiny{LS}}}}=\|\mathbf{x^{(\mathsf p)}}\|^2\hat{\mathrm h}_i^{{\text{\tiny{LS}}}}= N_p\rho\hat{\mathrm h}_i^{{\text{\tiny{LS}}}}$
where $N_p$ number of pilots and $\rho$ is the reference signal  power and is typically normalized to unity.

The channel impulse response $\hat{\mathrm h}_i^{{\text{\tiny{LS}}}}$ is  obtained via a joint  least-squares (LS) channel estimation using averaging or smoothing over an appropriate number of dimensions exhibiting channel coherence as illustrated in Figure~\ref{fig:joint_estim_princi}.
In the process of short-block detection, we can make use of such a channel estimate that. In general, the channel estimation procedure will work as usual and the resulting estimates are fed into the metrics considered here.
\begin{figure}[!ht]
        \centering
        \includegraphics[width=1\linewidth]{figures/sdt/dmrs_density/tikz/joint_estim_principle_b5.pdf}
        \caption{Conceptual illustration of JED principle with detection windows of order $N_d=4$.}
        \label{fig:joint_estim_princi}
\end{figure}\\
\textbf{Corollary 2}:  Considering an iterative JED for more reliable output LLRs, the estimation-detection process based on the proposed metric in (\ref{eqn:joint_estim_simo}) can be extended to include iterative steps to enhance transmission quality. Here, we focus specifically on the estimation-detection aspect of the receiver. In general, the choice of where to apply the iterative process depends on the specific system requirements, complexity, available resources, transmission channel conditions, and performance goals.
Each step has different implications in terms of complexity and efficiency. Moreover, the number of iterations possible in a communication system typically depends on specific design requirements and system constraints. In the case of sporadic transmission of short packets, strict latency constraints limit the number of iterations. Therefore, the number of iterations to be implemented must be finely adjusted to strike a balance between complexity, performance, and efficiency, aiming to achieve the desired transmission quality goals. Additionally, a minimal number of iterations can be used for basic adjustments, while more complex scenarios may implement multiple iterative processes for progressive optimization.

%Taking into account the detection strategy proposed earlier, the estimation-detection incorporating multiple iterations is given in (\ref{eqn:joint_estim_simo_iterativ}), which we will discuss further in the sections dedicated to numerical results.
Indeed, the iterative process of the JED receiver comprises two successive stages. Firstly, the initial iterative process pertains to channel estimation, continuing until the maximum required number of iterations is reached. Subsequently, the second iterative process, related to the detector, follows suit until the maximum required number of iterations is attained. It is worth noting that the channel estimate involved in LLR detection corresponds to the channel estimate resulting from the last iteration or the maximum iteration in the joint channel estimation phase. This process can be viewed as a {\em 2-layer iterative JED process}, with the first layer being iterative joint channel estimation and the second layer pertaining to iterative joint detection.

\input{figures/algorithms/iterative_jed}

\subsection{A \texorpdfstring{$(\mathsf{N_R} \times\mathsf{N_T})$} \ ~MIMO Within Rayleigh Block Fading Channel}
Consider a SU-MIMO transmission model featuring multiple antenna elements in both transmitter and receiver arrays. The system's dimensions are defined by parameters $\mathsf {N_R} \times \mathsf{N_T}$, where $\mathsf{N_T}$ and $\mathsf {N_R}N_\mathsf R$ denote the numbers of antennas in the transmitter and receiver arrays, respectively. We operate under the assumption of an absence of intersymbol interference (ISI) and consider a time-invariant configuration. These assumptions facilitate the utilization of the standard complex-valued baseband representation of narrowband signals expressed discretely.
Let $\mathrm h_{i,j}$ represent the complex-valued path gain, serving as the fading coefficient from transmit antenna $j$ to receive antenna $i$. At any given time instance when the complex-valued signals ${\mathrm x_1, \mathrm x_2, \ldots, \mathrm x_{\mathsf{N_T}}}$ are transmitted through the $\mathsf{N_T}$ respective antennas, the received signal at antenna $i$ can be mathematically expressed as follows :
\begin{equation}\label{eqn:sysmodel0}
\mathrm y_i = \sum_{j=1}^{N_{\mathsf T}} \mathrm 
 h_{i,j} \mathrm x_j + \mathrm z_i, \quad i = 1, 2, \ldots, \mathsf {N_R} \ .
\end{equation}
The model incorporates additive white Gaussian noise, denoted as $z_i$, with independent real and imaginary components, each having a variance of $\sigma^2$ in every dimension. For clarity and convenience, we employ a matrix framework. Thus, we define $\mathbf{x}$ as a vector of size $\mathsf{N_T}$ representing the transmitted values, and $\mathbf{y}$ as a vector of size $\mathsf{N_R}$ representing the received values. In this context, $\mathbf{x}$ belongs to the complex vector space $\mathbb{C}^{\mathsf{N_T}}$, $\mathbf{y}$ belongs to the complex vector space $\mathbb{C}^{\mathsf{N_R}}$, and the channel transfer matrix is denoted as $\mathrm{\bf H} \in \mathbb{C}^{\mathsf{N_R} \times \mathsf{N_T}}$.
%The MIMO channel model is succinctly expressed as $\mathbf{y}=\mathbf{H}\mathbf{x}+ \mathbf{z}$.
However, the system model described by equation (\ref{eqn:sysmodel0}), which represents transmission within a single symbol interval, can be readily extended to accommodate the transmission of several consecutive vectors $\{\mathbf x_1, \mathbf x_2, \ldots, \mathbf x_N\}$ over the channel. Here, $N$ denotes the total number of symbol intervals utilized for transmission. As a result, we organize the transmitted, received, and noise vectors into matrices,
 $\mathbf{X}=\left[\mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x}_N\right], \quad \mathbf{Y}=\left[\mathbf{y}_1, \mathbf{y}_2, \ldots, \mathbf{y}_N\right], \quad \mathbf{Z}=\left[\mathbf{z}_1, \mathbf{z}_2, \ldots, \mathbf{z}_N\right]$,
respectively. 
% The associated block transmission model is given by
% \begin{equation}\label{eqn:sysmodel2}
% \mathbf{Y}=\mathbf{H}\mathbf{X}+ \mathbf{Z} = \mathbf{H}\left(\mathbf{X}^{(\mathsf d)} + \mathbf{X}^{(\mathsf p)}\right)+ \mathbf{Z}  \ .
% \end{equation}
The elements within the matrix $\mathbf H$ represent the complex-valued channel gains between each transmit and receive antenna. We adopt a widely assumption regarding the channel matrix $\mathbf H$, which is that its elements, $\mathrm {h_{i,j}}$, are statistically independent for the sake of simplicity. In practical settings, the complex path gains ${\mathrm {h_{i,j}}}$ exhibit correlations influenced by factors such as the propagation environment, antenna element polarization, and their spacing.
As a result, the entries of $\mathbf H$ can be treated as independent zero-mean complex Gaussian random variables with unit variance. This channel model is often referred to as the {identically and independently distributed} (IID) \textit{Rayleigh fading MIMO channel model}, or more precisely, the Rayleigh block-fading channel.
 \subsubsection{Perfect Channel State Information}~\\
 The channel matrix $\mathbf{H}$ is assumed to be perfectly known at the receiver.
 The likelihood function or conditional probability density is approximately given by:
  \begin{equation}
 \mathrm q\left(\mathbf X,\{\mathbf Y, \mathbf H\}\right) \propto  \exp\left(-\frac{1}{\mathrm {N}_0}\operatorname{tr}\left\{ \left(\mathbf{Y}- \mathbf{H X}\right)\left(\mathbf{Y}- \mathbf{H X}\right)^\dag\right\} \right).
 \end{equation}
 Using the norm extention property $ \left\|\mathbf{Y}- \mathbf{H X}\right\|^2_\mathsf{F}=\left\| \mathbf{Y} \right\|^2_\mathsf{F} + \left\| \mathbf{HX}\right\|^2_\mathsf{F} - 2 \operatorname{Re}\left(\operatorname{tr}\left\{\mathbf Y\mathbf{H}^\dag\mathbf{X}^\dag\right\}\right)$ and neglecting terms that are independant of $\mathbf{X}$,
 it comes,
 \begin{equation}
 \mathrm q\left(\mathbf X,\{\mathbf Y, \mathbf H\}\right) \propto \exp\left(\frac{2 \operatorname{Re}\left(
 \operatorname{tr}\left\{\mathbf Y\mathbf{H}^\dag\mathbf{X}^\dag\right\}\right) -\left\| \mathbf{
 HX} \right\|^2_\mathsf{F} }{\mathrm {N}_0}   \right).
 \end{equation}
 The LLR bit metric  for the $j-th$ bit in BICM receiver  is
 % \begin{equation}
 % \begin{aligned}
 % \Lambda^j\left(\mathbf Y\right)
 % %&=\mathcal L\left(e_j=b|\mathbf{Y,H}\right))
 % &=\log \frac{p\left(e_j=1|\mathbf{Y,H}\right)}{p\left(e_j=0|\mathbf{Y,H}\right)},
 % \end{aligned}
 % \end{equation}
 \begin{equation}
 \begin{aligned}
 \Lambda^j\left(\mathbf Y\right)&=\log \frac{\mathrm q\left(e_j(\mathbf X)=0,\{\mathbf{Y,H}\}\right)}{\mathrm q\left(e_j(\mathbf X)=1,\{\mathbf{Y,H}\}\right)}.
 \end{aligned}
 \end{equation}
and the corresponding max-log approximation (i.e., $\log \sum_i \exp(-\lambda_i) \approx -\min(\lambda_i)$) of the above metric is shown to be
 \begin{equation}
 \begin{aligned}
 \Lambda^j\left(\mathbf Y\right)&=
 \max_{\mathbf X \in \chi_0^j}  \frac{1}{\mathrm {N}_0}\left(2\operatorname{Re}\left(
 \operatorname{tr}\left\{\mathbf Y\mathbf{H}^\dag\mathbf{X}^\dag\right\}\right) -\left\| \mathbf{
 HX} \right\|^2_\mathsf{F}\right) \\& -  \max_{\mathbf X \ \in \ \chi_1^j} \frac{1}{\mathrm {N}_0}\left(2\operatorname{Re}\left(
 \operatorname{tr}\left\{\mathbf Y\mathbf{H}^\dag\mathbf{X}^\dag\right\}\right) -\left\| \mathbf{
 HX} \right\|^2_\mathsf{F}\right).
 \end{aligned}
\end{equation}\\
\textbf{Remark 2}:
We consider the ideal receiver, denoted as {\em Perfect CSI} to be a benchmark for comparison with the subsequent receiver architectures. These subsequent architectures typically employ a separate least-squares channel estimation method by substituting the actual channel matrix, denoted as $\mathbf{H}$, with an estimated channel matrix $\hat{\mathbf{H}}$. The separate least-squares channel estimation aims to independently estimate the channel characteristics for each antenna, disregarding inter-antenna correlation considerations. %Specifically, for the antenna pair $(i, j)$, the element of the matrix channel is computed as follows:
%  $\widehat{\mathbf h}_{ij} = \left(\mathbf x_j^\dag  \mathbf y_i\right) \left(\mathbf x_j^\dag \mathbf x_j\right)^{-1}$.
%  This method finds frequent application in scenarios where the antennas of the MIMO system exhibit sufficient isolation from one another, and there is no substantial correlation between the channels of different antennas.


%%%%%%%%%%%%%%%
 % For comparison, the sphere decoding metric proposed by Hochwald et al. \cite{Hochwald2003} can be used, which can be equivalently expressed as follows:
 % \begin{equation}
 % \begin{aligned}
 % \left\|\mathbf Y-\mathbf H \mathbf X\right\|^2 &= (\mathbf X-\widehat{\mathbf X})^\dag \mathbf H^\dag \mathbf H(\mathbf X-\widehat{\mathbf X}) )& +  \mathbf{Y}^\dag\left(\mathbf{I}-\mathbf{H}\left(\mathbf{H}^\dag\mathbf{H}\right)^{-1} \mathbf{H}^\dag\right) \mathbf{Y}.
 % \end{aligned}
 % \end{equation}

 % By ignoring the terms independent of $\mathbf X$, we obtain the approximation:

 % \begin{equation}
 % \left\|\mathbf Y-\mathbf H \mathbf X\right\|^2_F \approx (\mathbf X-\widehat{\mathbf X})^\dag \mathbf H^\dag  \mathbf H(\mathbf X-\widehat{\mathbf X})
 % \end{equation}

 % where $ \widehat{\mathbf{X}}=\mathbf{W Y} \text { s.t. }$
 % \begin{equation}
 % \left\{\begin{array}{l}
 % \mathbf{W}=\left(\mathbf{H}^\dag\mathbf{H}\right)^{-1}\mathbf{H} : \text { zero forcing (ZF) equalization } )
 % \mathbf{W}=\left(\mathbf{H}^\dag\mathbf{H}+\mathbf{I}\right)^{-1} \mathbf{H}^\dag: \text { MMSE equalization }
 % \end{array}\right.
 % \end{equation}
 % % This sphere decoding metric offers a comparison between the received signal $\mathbf Y$ and the transmitted signal $\mathbf H \mathbf X$ based on different equalization schemes, specifically zero-forcing (ZF) and minimum mean square error (MMSE) equalization.
 \subsubsection{Rayleigh Block Fading Channel With No CSI}~\\
 As described earlier, the block fading channel $\mathbf H$ is assumed to be a complex-valued random unitary matrix, i.e., $\mathbf H \sim \mathbb C\mathcal N(0, \mathbf I)$. The complex-valued fading coefficient $\mathrm {h_{i,j}}$ represents the channel gain between the $j$-th transmit antenna and the $i$-th receive antenna. These fading coefficients are assumed to be constant over the $N$ symbol periods and are independent. Therefore, the probability density function of $\mathrm {h_{i,j}}$ can be expressed as $\mathrm p\left(\mathrm {h_{i,j}}\right) = \frac{1}{\pi}\exp\left(|\mathrm {h_{i,j}}|^2\right)$.

Both the fading coefficients and the noise follow complex Gaussian distributions. Thus, conditioned on the transmitted signal, the received signals are jointly complex Gaussian. The received signal is zero mean ($\mathbb E\{\mathbf Y|\mathbf X\}=0$), circularly symmetric complex Gaussian with an $N\times N$ covariance matrix $\mathbf \Phi_\mathsf Y$, concretely.\\
\textbf{Definition 1}: {\em Complex-valued Gaussian distribution.\\
 Let $\mathbf x \in \mathbb C^{\mathsf{N_T}}$, then the probability density function $f_{\mathbf{x}}(\mathbf{\upsilon})$ of $\mathbf x$ is given by:}
 \begin{equation}
 f_{\mathbf{x}}(\mathbf{\upsilon})=\frac{1}{\pi \operatorname{det}\left(\mathbf{\Phi_{x}}\right)} \exp \left[-\left(\mathbf{\upsilon}-\mathbf{\mu}_{\mathbf{x}}\right)^\dag \mathbf{\Phi}_{\mathbf{x}}^{-1}\left(\mathbf{\upsilon}-\mathbf{\mu}_{\mathbf{x}}\right)\right]\ .
 \end{equation}
 Using the above definition, the likelihood function or conditional probability density is given by:
 \begin{equation}
 \mathrm q\left(\mathbf X,\mathbf Y\right) = \frac{ \exp\left(-\operatorname{tr}\left\{ \mathbf{Y}\mathbf{\Phi}_{Y}^{-1} \mathbf{Y}^\dag\right\}\right)}{\pi^{N\times \mathsf{N_R}} \operatorname{det}^{\mathsf{N_R}}\left(\mathbf{\Phi}_{Y}\right)}\ .
 \end{equation}
 We will proceed by following the steps below to derive the  detection metric. Consequently, to ascertain the formulation for the covariance matrix, denoted as $\mathbf{\Phi}_{Y}$, we shall invoke the subsequent \textit{Theorem}.\\
 \textbf{Theorem 1}:\cite[Sec. 2, Th. 2]{Gallager2008}\\ {\em Let $\mathbf A$ be an arbitrary $m$ by $n$ complex matrix, and let $\mathbf R = \mathbf{AW}$, where $\mathbf W \sim \mathbb C \mathcal N (0,\mathbf I_m)$, meaning that $W_1, \ldots ,W_m$ are independent and identically distributed (i.i.d.) with independent real and imaginary parts. In that case, $\mathbf \Phi = \mathbb E\{\mathbf{AW}\mathbf W^\dag \mathbf A^\dag\}=\mathbf{AA}^\dag$. Therefore, $\mathbf R$ is circularly symmetric and denoted by $\mathbb C \mathcal N (0,\mathbf{AA}^\dag)$.}

 Stated directly, the covariance matrix can be expressed as follows:
 \begin{equation}
 \begin{aligned}
 \mathbf{\Phi}_{Y} &\triangleq \mathbb E\{\mathbf{Y} \mathbf{Y}^\dag\}\\
 &\triangleq \mathbb E\{\left(\mathbf{H X} + \mathbf{Z}\right)\left(\mathbf{H X} + \mathbf{Z}\right)^\dag\}\\
 &\triangleq \mathbb E\{\mathbf{H X}\mathbf{X}^\dag\mathbf{H}^\dag\}+\mathbb E\{ \mathbf{Z}\mathbf{Z}^\dag\}\\
 &\triangleq \mathbf{X}\mathbf{X}^\dag+ 2\sigma^2\mathbf I \triangleq \mathbf{X}\mathbf{X}^\dag+ \mathrm {N}_0\mathbf I\ .
 \end{aligned}
 \end{equation}
This expression for the covariance matrix is commonly encountered in the literature, particularly in the influential works authored by Marzetta et al. \cite{Marzetta1999} and Hochwald et al. \cite{Hochwald2000}.\\
\textbf{Definition 2:}
Let's now introduce some relevant mathematical properties in the derivation steps of the metrics 
   \begin{enumerate}
   \item  $\operatorname{det} \left(\mathbf I +  \mathbf{A}\mathbf{B} \right)= \operatorname{det} \left(\mathbf I +  \mathbf{B}\mathbf{A} \right) $, \cite{Sylvester1851}
   \item $\operatorname{det} \left(\mathbf I +  \rho\mathbf{A}\right)\approx 1 + \operatorname{tr} \left\{\rho\mathbf{A} \right\} $
   %\item $\operatorname{tr}\left\{\mathbf{A}\mathbf{A}^\dag \right\} =\operatorname{tr}\left\{\mathbf{A}^\dag\mathbf{A} \right\}=\|\mathbf A\|^2_F$
   \item  $ \left(\mathbf{A}\mathbf{B} \right)^\dag= \mathbf{B}^\dag\mathbf{A}^\dag $,\quad  $ \left(\mathbf{A}^\dag\right)^\dag= \mathbf{A}$
   %\item $ \left(\mathbf{A}^\dag\right)^\dag= \mathbf{A}$
   %\item $\operatorname{tr}\left\{\mathbf{A}\mathbf{A}^\dag \right\} =\operatorname{tr}\left\{\mathbf{A}^\dag\mathbf{A} \right\}$
   \item $\operatorname{tr}\left\{\mathbf{A}\mathbf{B} \right\} =\operatorname{tr}\left\{\mathbf{B}\mathbf{A} \right\},  \quad \operatorname{tr}\left\{\mathbf{A}+\mathbf{B} \right\} =\operatorname{tr}\left\{\mathbf{A} \right\}+\operatorname{tr}\left\{\mathbf{B} \right\}
   $
     \item $\operatorname{tr}\left\{\mathbf{A}^{-1}\mathbf{B}\mathbf{B}^\dag \right\} =\operatorname{tr}\left\{\mathbf{B}^\dag\mathbf{A}^{-1}\mathbf{B} \right\}$
 \end{enumerate}
 Next, the determinant of $\mathbf{\Phi}_{Y}$ is shown to be:
 \begin{align}
 \operatorname{det} \mathbf{\Phi}_{Y} =  \mathrm {N}_0 +  \operatorname{tr}\{\mathbf{X}^\dag\mathbf{X}\}=  \mathrm {N}_0 +\|\mathbf X\|^2_\mathsf{F}.
 \end{align}
Furthermore, the covariance matrix $\mathbf{\Phi}$ involves the addition of two matrices, which leads us to consider the use of matrix inversion lemmas. Among these lemmas, the most widely used and significant is the Woodbury Matrix identity, also known as the matrix inversion lemma, Sherman-Morrison-Woodbury formula, or simply the Woodbury formula.\\
 \textbf{Lemma 1}: The Woodbury Matrix identity \cite{Woodbury1950}.
 \begin{equation}
 (\mathbf A+\mathbf U \mathbf C \mathbf V)^{-1}=\mathbf A^{-1}-\mathbf A^{-1} \mathbf U\left(\mathbf C^{-1}+\mathbf{V A}^{-1} \mathbf U\right)^{-1} \mathbf {V A}^{-1},
 \end{equation}
 {\em where $\mathbf A$, $\mathbf U$, $\mathbf C$, and $\mathbf V$ are matrices with  confortable dimensions: $\mathbf A$ is an $n\times n$ matrix, $\mathbf C$ is a $k\times k$ matrix, $\mathbf U$ is an $n\times k$ matrix, and $\mathbf V$ is a $k\times n$ matrix.
 }

 The expression for the inverse of the covariance matrix is as follows: $\mathbf{\Phi}_{Y}^{-1} =  \left(\mathrm {N}_0\mathbf I +  \mathbf{X}\mathbf{X}^\dag\right)^{-1}$.\\

 Saying $  \mathbf A= \mathrm {N}_0 \mathbf I, \quad \mathbf C =\mathbf I, \quad \mathbf U= \mathbf X, \quad \mathbf V= \mathbf X^\dag$, then,
 % \left\{\begin{array}{l}
 %  \displaystyle \mathbf A= \mathrm {N}_0 \mathbf I\\
 %   \displaystyle \mathbf C =\mathbf I\\
 %   \displaystyle \mathbf U= \mathbf X\\
 %   \displaystyle \mathbf V= \mathbf X^\dag
 % \end{array}\right.$\\
\begin{equation}
\begin{aligned}
\mathbf \Phi^{-1} &= \left (\mathbf A+\mathbf U \mathbf C \mathbf V\right)^{-1}\\&
=\mathrm {N}_0^{-1}\mathbf I- \mathrm {N}_0^{-1}\mathbf  X
  \left[\mathbf I + \mathbf X^\dag \mathbf X \right]^{-1}\mathbf X^\dag\\&
  =\mathrm {N}_0^{-1}\mathbf I- \mathrm {N}_0^{-1}\mathbf X \mathbf D\mathbf X^\dag, \quad \text{where} \quad  \mathbf D= \left[\mathbf I + \mathbf X^\dag \mathbf X \right]^{-1}.
\end{aligned}
\end{equation}
 Thus, the likelihood function can be straightforwardly stated as:
 \begin{equation}
  \mathrm p\left(\mathbf Y| \mathbf X\right) = \frac{\exp\left(-\operatorname{tr}\left\{ \mathbf{Y}\mathbf{\Phi}_{Y}^{-1} \mathbf{Y}^\dag\right\}\right)}{\pi^{N\times \mathsf{N_R}}\left(\mathrm {N}_0 +  \operatorname{tr}\{\mathbf{X}^\dag\mathbf{X}\}\right)^{\mathsf{N_R}}}\ .
 \end{equation}\\
\textbf{Proposition 3}: The proposed likelihood function $\mathrm q\left( \mathbf X, \mathbf Y \right)$, commonly referred to as the symbol decoding metric, can be expressed as follows:
 \begin{equation}\label{eqn:mimo_lf}
 \begin{aligned}
   \mathrm p\left(\mathbf Y| \mathbf X\right) &=
   %\frac{1}{\mathbf L_{\mathsf X}}\exp\left(-\operatorname{tr}\left\{ \mathbf{Y}\mathbf{\Phi}_{Y}^{-1} \mathbf{Y}^\dag\right\}\right\mathbf H_{\mathsf{BG}}&
  \frac{1}{\mathbf L_{\mathsf X}}\exp\left(-\operatorname{tr}\left\{ \mathbf{Y}^\dag\mathbf{\Phi}_{Y}^{-1} \mathbf{Y}\right\}\right)\\&
 = \frac{1}{\mathbf L_{\mathsf X}}\exp\left(-\operatorname{tr}\left\{ \mathbf{Y}^\dag\left(\frac{1}{\mathrm {N}_0}\mathbf I- \frac{1}{\mathrm {N}_0}\mathbf X \mathbf D\mathbf X^\dag \right) \mathbf{Y}\right\}\right),
  \end{aligned}
 \end{equation}
 where $\mathbf L_\mathsf{X}= \pi^{N \times \mathsf{N_R}}\left(\mathrm {N}_0 +  \operatorname{tr}\{\mathbf{X}^\dag\mathbf{X}\}\right)^{\mathsf{N_R}}$.

 Ignoring the multiplicative terms independent of $\mathbf X$, (\ref{eqn:mimo_lf}) reduces to:
 \begin{equation}
 \begin{aligned}
   \mathrm q\left(\mathbf X, \mathbf Y\right) \approx
   %\frac{1}{\mathbf L_{\mathsf X}} \exp\left(\frac{1}{\mathrm {N}_0} \operatorname{tr}\left\{\mathbf{Y}^\dag\mathbf X \mathbf D\mathbf X^\dag \mathbf{Y}\right\}\right\mathbf H_{\mathsf{BG}}&
 %\approx \frac{1}{\mathbf L_{\mathsf X}} \exp\left(\frac{1}{\mathrm {N}_0} \operatorname{tr}\left\{\mathbf X\mathbf{Y}^\dag\mathbf D\mathbf X^\dag \mathbf{Y}\right\}\right\mathbf H_{\mathsf{BG}}&
 \frac{1}{\mathbf L_{\mathsf X}} \exp\left(\frac{1}{\mathrm {N}_0} \operatorname{tr}\left\{\left(\mathbf X^\dag\mathbf{Y}\right)^\dag \mathbf D\left(\mathbf X^\dag \mathbf{Y}\right)\right\}\right).
  \end{aligned}
 \end{equation}\\
\textbf{Corollary 3}:
 As described in the above sections, we can incorporate the channel estimate into the metric to take full merit of the JED principle. For this purpose, we simply rewrite $\mathbf X =  \mathbf X^{(\mathsf d)} + \mathbf X^{(\mathsf p)}$.
 Then, we can reveal $\widehat{\mathbf H}^{\mathrm{LS}}$ in the metrics:
 \begin{equation}\label{joint_estim_mimo}
 \begin{aligned}
 \mathbf X^\dag \mathbf Y = \underbrace{{\mathbf X^{(\mathsf p)}}^\dag\mathbf Y^{(\mathsf p)} }_{\text{channel estimate  }}  + \ {\mathbf X^{(\mathsf d)}}^\dag\mathbf Y^{(\mathsf d)}= \mathbf\eta_{\mathsf p}\widehat{\mathbf H}_{\mathrm{LS}} + {\mathbf X^{(\mathsf d)}}^\dag\mathbf Y^{(\mathsf d)}\ ,
 \end{aligned}
 \end{equation}
 where $\mathbf\eta_{\mathsf p} ={\mathbf {X}^{(\mathsf p)}}^\dag\mathbf X^{(\mathsf p)}$ given that
 $\widehat{\mathbf H}_{\mathrm{LS}}  = \frac{{\mathbf {X}^{(\mathsf p)}}^\dag\mathbf Y^{(\mathsf p)}}{{\mathbf {X}^{(\mathsf p)}}^\dag\mathbf X^{(\mathsf p)}}$. This channel estimate is obtained via a joint  least-squares (LS) channel estimation using averaging or smoothing over an appropriate number of dimensions exhibiting channel coherence.

 Note that reference signal power is typically normalized to unity.
 The joint least squares method enables the consideration of spatial correlation between the receiving and transmitting antennas, resulting in a more accurate estimation of the channel.
%In general, the channel estimation procedure will work as usual and the resulting estimates are fed into the metrics considered here.
% \begin{equation}
% \begin{aligned}\label{eqn:_jed_lf_mimo}
%  q(\mathbf{X}, \mathbf{Y}) & =\frac{1}{\mathbf L_\mathsf X} \exp \left(\frac { 1 } { N _ { 0 } } \operatorname { t r } \left\{\left(\widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)^\dag \right.  \right. \\
%  &\hspace{6.5em}\left. \left.\mathbf{D}\left(\widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)\right\} \right) .
% \end{aligned}
% \end{equation}
% The likehihood of the coded bit $e_j$ s.t $b \in \{0,\ 1\}$ is given  by
% \begin{equation}
% \begin{aligned}
% &\mathrm q\left(e_j(\mathbf{X})=b ,\mathbf Y\right) = \displaystyle \sum_{\mathbf X \ \in \ \chi_b^j} \mathrm q\left(\mathbf X, \mathbf Y\right).
% \end{aligned}
% \end{equation}
% Then, the log likelidood ratio (LLR) bit metric for the $j-th$ $e$  in BICM receiver is as follow
% \begin{equation}
% \begin{aligned}
% \Lambda^j\left(\mathbf Y\right)&=\log \frac{\mathrm q\left(e_j(\mathbf X)=0,\mathbf{Y}\right)}{\mathrm q\left(e_j(\mathbf X)=1,\mathbf{Y}\right)}.
% \end{aligned}
% \end{equation}
In the process of short-block detection, we can make use of such a channel estimate that. In general, the channel estimation procedure will work as usual and the resulting estimates are fed into the metrics considered here.\\
 Consistent with this proposition, the introduced likelihood function enables advanced joint estimation and detection.\\
 Consequently, it can be formulated as follows.
\begin{equation}
 \begin{aligned}\label{eqn:_jed_lf_mimo}
   \mathrm q(\mathbf{X}, \mathbf{Y}) & =\frac{1}{\mathbf L_\mathsf X} \exp \left(\frac { 1 } { N _ { 0 } } \operatorname { t r } \left\{\left(\mathbf\eta_{\mathsf p} \widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)^\dag \right.  \right. \\
   &\hspace{6.5em}\left. \left.\mathbf{D}\left(\mathbf\eta_{\mathsf p}\widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)\right\} \right).
  \end{aligned}
 \end{equation}
  Then, the likehihood of the coded bit $e_j$ s.t $b \in \{0,\ 1\}$ is give  by
 \begin{equation}
 \begin{aligned}
 &\mathrm q\left(e_j(\mathbf{X})=b ,\mathbf Y\right) = \displaystyle \sum_{\mathbf X \ \in \ \chi_b^j} \mathrm q\left(\mathbf X, \mathbf Y\right).
 %&q_{i,b}\left(\mathbf Y\right) = \displaystyle \sum_{\mathbf X \  \text{s.t.}\ e_j=b} \mathrm q\left(\mathbf X, \mathbf Y\right)
 \end{aligned}
 \end{equation}
 % where  $e_j$ is mapped to $\chi$ (i.e., set of constellation symbol) at the $j-th$ bit location or position and the number of bits reqired to a symbol is denoted by $m\triangleq \log_2\left(M\right)$. Whenever $|\chi|<\infty$, the cardinality of $\chi$ is given by $M\triangleq |\chi|$. $\chi_b^j$ is the set of constellation symbol from $\chi$ having the $j-th$ equal to $b$ where $j=1,2, \ldots, m$.\\
 The LLR bit metric  for the $j-th$  bit in BICM receiver  is
 \begin{equation}
 \begin{aligned}
 \Lambda^j\left(\mathbf Y\right)&=\log \frac{\mathrm q\left(e_j(\mathbf X)=0,\mathbf{Y}\right)}{\mathrm q\left(e_j(\mathbf X)=1,\mathbf{Y}\right)}.
 \end{aligned}
 \end{equation}\\
 \textbf{Corollary 4:}
 To alleviate the complexity  of implementing the  above LLR bit metric, one can use its {\em max-log approximation} version.  The LLR bit metric is then equivalent to (\ref{eqn:maxlog_llr_mimo}).\\
 \textbf{Remark 3}:
  Furthermore, the computational complexity of the LLR metric in a BICM MIMO system is typically on the order of $\mathcal O\left(\mathsf{N_T} \times \mathsf{N_R} \times N_d \times \log_2 \mathcal M\right)$. This complexity exhibits linearity with respect to the number of received data symbols ($N_d$), the number of transmitting ($\mathsf{N_T}$), and receiving ($\mathsf{N_R}$) antennas , as well as the size of the modulation alphabet ($\mathcal M$). Consequently, an increase in the number of symbols or transmitting/receiving antennas results in a linear escalation of computational complexity.\\
 Considering $N_\mathsf T=1$, we revert to the SIMO scenario, which is similar to the metric we presented in \cite{sy2023_2} for the general non-coherent fading channel by setting the relative magnitude of the LOS component $\alpha=0$, which brings the metric back to the pure Rayleigh fading case.
   \begin{figure*}%[!ht]
 \hrulefill
\begin{align}\label{eqn:maxlog_llr_mimo}
 \resizebox{0.90\textwidth}{!}{$
 \begin{array}{r}
     \Lambda^j\left(\mathbf Y\right)= \displaystyle\max_{\mathbf X  \ \in \ \chi_0^j}\left( \frac{1}{\mathrm {N}_0}\operatorname{tr}\left\{\left(\mathbf\eta_{\mathsf p}\widehat{\mathbf{H}}_{\mathrm{LS}}+\mathbf{X}^{(\mathsf d)}{ }^\dag \mathbf{Y}^{(\mathsf d)}\right)^\dag \mathbf D\left(\mathbf\eta_{\mathsf p} \widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)\right\}\right)- \displaystyle\sum_{\mathbf X \ \in \ \chi_0^j}\log\left(\mathbf L_\mathsf X\right)\\
     -  \displaystyle\ \max_{\mathbf X \ \in \ \chi_1^j}\left( \frac{1}{\mathrm {N}_0} \operatorname{tr}\left\{\left(\mathbf\eta_{\mathsf p}\widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)^\dag \mathbf D\left(\mathbf\eta_{\mathsf p} \widehat{\mathbf{H}}_{\mathrm{LS}}+{\mathbf{X}^{(\mathsf d)}}^\dag \mathbf{Y}^{(\mathsf d)}\right)\right\}\right) + \displaystyle\sum_{\mathbf X \ \in \ \chi_1^j}\log\left(\mathbf L_\mathsf X\right).
 \end{array}
 $}
  \end{align}
  \hrulefill
 \end{figure*}
Please note that in equation (\ref{eqn:maxlog_llr_mimo}), the terms $\sum_{\mathbf X \ \in \ \chi_b^j}\log\left(\mathbf L_\mathsf X\right)$  can be neglected when ${|\lvert \mathbf{X}|\rvert }^2_{\mathsf F}$ remains constant, as is the scenario in BPSK or QPSK modulation, for instance.
 \subsection{A \texorpdfstring{($\mathsf{N_R}\times 2)$} \ ~MIMO within Line-Of-Sight Channel}
 For the sake of simplicity, let's consider a MIMO configuration of $({\mathsf N_R} \times 2)$ due to the complexity of deriving MIMO metrics of spatial dimension ${\mathsf N_T}>2$ under the LOS channel conditions with unknown phases.

 Assuming a Los $\mathbf H$ channel with coherence blocks covering $N$ symbols and no antenna correlation, the relationship between receiver and transmitter is such that :
 \begin{equation}
\mathbf y_i=\mathrm h_{i,1} \mathbf x_1+ \mathrm h_{i,2} \mathbf x_2 + \mathbf z_i, \quad i=1,2 \ldots, \mathsf{N_R}. %\left. \right|_{i=1}^{\mathsf{N_R}}.
\end{equation}
Explicitly, it can be expanded as follows
\begin{equation}
\begin{aligned}
\left\{\begin{array}{l}
\mathbf y_1=\mathrm h_{1,1} \mathbf x_1 + \mathrm h_{1,2} \mathbf x_2 + \mathbf z_1 \\
\mathbf y_2=\mathrm h_{2,1} \mathbf x_2 + \mathrm h_{2,2} \mathbf x_2 + \mathbf z_2 \\
\quad \vdots \hspace{3.em} \vdots \hspace{3.em} \vdots  \hspace{3.em} \vdots \\
\mathbf y_\mathsf{N_R}=\mathrm h_{\mathsf{N_R,1}} + \mathrm h_{\mathsf{N_R, 2}} \mathbf x_2 + \mathbf z_{\mathsf{N_R}}
\end{array}\right.
\end{aligned}
\end{equation}
% The LOS channel matrix is considered to be :
% \begin{equation}
% \mathbf H =\left[\begin{array}{ll}
% e^{j \mathrm \theta_{1,1}} & e^{j \mathrm \theta_{1,2}} \\
% e^{j \mathrm \theta_{2,1}} & e^{j \mathrm \theta_{2,2}} \\
% \quad \vdots & \quad \vdots \\
% e^{j \mathrm \theta_{N_R,1}} & e^{j \mathrm \theta_{N_R,2}}
% \end{array}\right].
% \end{equation},
where $\mathbf y_i \sim \mathbb C^{N\times i}$, $\mathbf \{\mathbf x_1, \mathbf x_2\} \sim \mathbb C^{N\times 1}$  and $\mathbf H \sim \mathbb C^{\mathsf{N_R}\times 2}$.

The receiver signal is then modelled as
\begin{equation}
\mathbf y_i=e^{j \mathrm \theta_{i,1}} \mathbf x_1+ e^{j \mathrm \theta_{i,2}}  \mathbf x_2 + \mathbf z_i, \quad i=1, 2, \ldots, N_\mathsf R.
\end{equation}
Following the same principle as in the previous sections, we can establish the conditional probability density in order to determine the BICM metric corresponding to this typical scenario.
It should be recalled that $\mathrm{\theta}_{i,1}$ and $\mathrm{\theta}_{i,2}$ are unknown to the receiver and are assumed to
be i.i.d. uniform random variables on $[0,2\pi)$.
After neglecting multiplicative terms independent of the transmitted message, the likelihood function can be expressed as follows:
\begin{equation}\label{eqn:llrfunction_mimolos}
\begin{array}{r}
\mathrm{q}\left(\left\{\mathbf{x}_1, \mathbf{x}_2\right\}, \mathbf{y}_i\right) \propto \displaystyle\int_{\theta_{i, 1}} \int_{\theta_{i, 2}} \exp \left(-\frac{1}{\mathrm{~N}_0} \| \mathbf{y}_i-e^{j \theta_{i, 1}} \mathbf{x}_1\right. \\
\left.-e^{j \theta_{i, 2}} \mathbf{x}_2 \|^2\right) \mathrm{d} \theta_{i, 2} \mathrm{~d} \theta_{i, 1} .
\end{array}
\end{equation}
By expanding the $\ell^2$-norms term constituting the expression of the conditional density probability, we obtain :
\begin{equation}\label{eqn:llrfunction_mimolos_norm extension}
\resizebox{0.5\textwidth}{!}{$
\begin{array}{l}
\left\|\mathbf y_i-e^{j \mathrm \theta_{i,1}} \mathbf{x}_1-e^{j \mathrm \theta_{i,2}}\mathbf{x}_2\right\|^2
=\left\|\mathbf y_i\right\|^2+\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2
+ 2\operatorname{Re}\\\left(e^{j(\mathrm \theta_{i,1}-\mathrm \theta_{i,2})}\mathbf{x}_1\mathbf{x}_2^\dag \right)-2\operatorname{Re}\left( e^{-j\mathrm \theta_{i,1}}\mathbf{x}_1^\dag\mathbf{y}_i \right)-2\operatorname{Re}\left( e^{-j\mathrm \theta_{i,2}}\mathbf{x}_2^\dag\mathbf{y}_i \right)
\end{array}
$}
\end{equation}
Saying : $
\left\{\begin{array}{l}
\mathbf{x}_1\mathbf{x}_2^\dag=\left|\mathbf{x}_1\mathbf{x}_2^\dag\right| e^{j\angle\mathbf{x}_1\mathbf{x}_2^\dag} \\
\mathbf{x}_1^\dag\mathbf{y}_i=\left|\mathbf{x}_1^\dag\mathbf{y}_i\right|e^{j\angle\mathbf{x}_1^\dag\mathbf{y}_i} \\
\mathbf{x}_2^\dag\mathbf{y}_i=\left|\mathbf{x}_2^\dag\mathbf{y}_i\right| e^{j\angle\mathbf{x}_2^\dag\mathbf{y}_i}
\end{array}\right.
$\\
Then,
\begin{equation}
\resizebox{0.5\textwidth}{!}{$
\begin{array}{l}
=\left\|\mathbf y_i\right\|^2+\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2
+ 2\operatorname{Re}\left( e^{j(\mathrm \theta_{i,1}-\mathrm \theta_{i,2}+\angle\mathbf{x}_1\mathbf{x}_2^\dag)}|\mathbf{x}_1\mathbf{x}_2^\dag| \right)\\-2\operatorname{Re}\left( e^{-j(\mathrm \theta_{i,1}-\angle\mathbf{x}_1^\dag\mathbf{y}_i)}|\mathbf{x}_1^\dag\mathbf{y}_i| \right)-2\operatorname{Re}\left(e^{-j(\mathrm \theta_{i,2}-\angle\mathbf{x}_2^\dag\mathbf{y}_i)}|\mathbf{x}_2^\dag\mathbf{y}_i| \right)
\end{array}
$}
\end{equation}
Disregarding terms that are independent of $\mathbf x_1$ and  $\mathbf x_2$,
thus:
\begin{align}
&=\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2
+ 2|\mathbf{x}_1\mathbf{x}_2^\dag|\cos\left(\mathrm \theta_{i,1}-\theta_{i,2}+\angle\mathbf{x}_1\mathbf{x}_2^\dag \right)-\nonumber\\&2|\mathbf{x}_1^\dag\mathbf{y}_i|\cos\left(\mathrm \theta_{i,1}-\angle\mathbf{x}_1^\dag\mathbf{y}_i \right)-2|\mathbf{x}_2^\dag\mathbf{y}_i|\cos\left(\mathrm \theta_{i,2}-\angle\mathbf{x}_2^\dag\mathbf{y}_i \right)\nonumber.
\end{align}
For reasons of simplicity, an assumption of orthogonality between the modulated symbols $\mathbf x_1$ and $\mathbf x_2$ is necessary. Actually, in MIMO systems, it is practicable or desired that the modulated symbols of distinguish antennas be orthogonal to each other.
%It should be stressed, however, that orthogonality is a stricter condition than independence, even though they are related concepts. 
Thus, assuming orthogonality between $\mathbf x_1$ and $\mathbf x_2$, this means that $\langle \mathbf x_1,\mathbf x_2\rangle=\mathbf 0$.
%hence $\mathbf x_1 \mathbf x_2^\dag$.
Therefore, we can proceed with successive integration with respect to $\mathrm \theta_{i,1}$ and $\mathrm \theta_{i,2}$ using the {\em Fubini's Theorem}\cite{Fubini1907}
\begin{align}\label{eqn:maxlog_llr_mimo_los_}
%\resizebox{0.50\textwidth}{!}{$
\begin{array}{r}
\mathrm q\left(\left\{\mathbf{x}_1, \mathbf{x}_2\right\}, \mathbf{y}_i\right)  \propto\exp \left(-\frac{\left\|\mathbf{x}_1\right\|^2+\left\|\mathbf{x}_2\right\|^2}{\mathrm {N}_0}\right) \int_{\theta_{i, 1}} \exp \left(\frac{2}{\mathrm {N}_0}\right.\\ \left. \left|\mathbf{x}_1^{\dagger} \mathbf{y}_i\right|  \cos \left( \theta_{i, 1}\nonumber-\angle \mathbf{x}_1^{\dagger} \mathbf{y}_i\right)\right) \int_{\theta_{i, 2}} \exp \left(\frac{2}{\mathrm {N}_0}\right.\\ \left.  \left|\mathbf{x}_2^{\dagger} \mathbf{y}_i\right|\cos \left(\theta_{i, 2}-\angle \mathbf{x}_2^{\dagger} \mathbf{y}_i\right)\right) \mathrm{d} \theta_{i, 2} \mathrm{~d} \theta_{i, 1}
\end{array}
%$}
\end{align}\\
\textbf{Proposition 4}:
The likelihood function is shown to be
% \begin{equation}\label{eqn:llr_mimo_los}
% \begin{array}{r}
% \mathrm q\left(\{\mathbf{x}_1, \mathbf{x}_2\}, \mathbf y\right)
% \propto  \displaystyle \prod_{i=0}^{\mathsf{N_\mathsf R}-1} \xi\left(\mathbf{x}_1, \mathbf{x}_2\right) \times\operatorname{I_0}{\left(
% \frac{2}{\mathrm {N}_0}|\mathbf{x}_1^\dag\mathbf{y}_i|\right)}\\ \times \operatorname{I_0}{\left(
% \frac{2}{\mathrm {N}_0}|\mathbf{x}_2^\dag\mathbf{y}_i|\right)},
% \end{array}
% \end{equation}

\begin{equation}\label{eqn:llr_mimo_los}
\begin{array}{r}
\mathrm q\left(\{\mathbf{x}_1, \mathbf{x}_2\}, \mathbf y\right)
\propto  \displaystyle \prod_{i=0}^{\mathsf{N_\mathsf R}-1} \exp{\left(-\frac{\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2}{\mathrm {N}_0} \right)}\times\\ \displaystyle \operatorname{I_0}{\left(
\frac{2}{\mathrm {N}_0}|\mathbf{x}_1^\dag\mathbf{y}_i|\right)}\times\operatorname{I_0}{\left(
\frac{2}{\mathrm {N}_0}|\mathbf{x}_2^\dag\mathbf{y}_i|\right)},
\end{array}
\end{equation}\\
%where $\xi\left(\mathbf{x}_1, \mathbf{x}_2\right)= \exp{\left(-\frac{\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2}{\mathrm {N}_0} \right)}$.\\
\textbf{Corollary 5:}
 For simpler processing, the \emph{max-log approximation}, the log-likelihood ratio (LLR) for the $j$-th coded bit is provided in (\ref{eqn:maxlog_llr_mimo_los}). 
\begin{figure*}[!ht]
%\begin{multicols}{2}
\hrulefill
\begin{align}\label{eqn:maxlog_llr_mimo_los}
 \resizebox{.90\textwidth}{!}{$
\begin{array}{r}
\Lambda^j\left(\mathbf y\right)= \displaystyle\max _{\{\mathbf{x}_1, \mathbf{x}_2\} \ \in \ \chi_0^j} \displaystyle\sum_{i=0}^{\mathsf{N_\mathsf R}-1} 
\frac{2}{\mathrm {N}_0}\left(\left|N_p \hat{\mathrm h}^{{\text{\tiny{LS}}}}_{i,1} +  \ {\mathbf x_1^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right| +\left|N_p \hat{\mathrm h}^{{\text{\tiny{LS}}}}_{i,2} +  \ {\mathbf x_2^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right|-\frac{\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2}{2}\right) \\
\quad- \displaystyle\max _{\{\mathbf{x}_1, \mathbf{x}_2\} \ \in \ \chi_1^j} \displaystyle\sum_{i=0}^{\mathsf{N_\mathsf R}-1}
\frac{2}{\mathrm {N}_0}\left(\left|N_p \hat{\mathrm h}^{{\text{\tiny{LS}}}}_{i,1} +  \ {\mathbf x_1^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right| +\left|N_p \hat{\mathrm h}^{{\text{\tiny{LS}}}}_{i,2} +  \ {\mathbf x_2^{(\mathsf d)}}^\dag\mathbf{y}^{(\mathsf d)}_{i}\right| -\frac{\left\|\mathbf x_1\right\|^2 + \left\|\mathbf x_2\right\|^2}{2}\right).
\end{array}
$}
\end{align}
\hrulefill
\end{figure*}\\
\textbf{Remark 4}:
The computational complexity of the LLR metric in such a BICM system is typically on the order of $\mathcal O\left((2\times \mathsf{N_\mathsf R} \times N_d \times \log_2 \mathcal M\right)$.
 Considering $\mathsf{N_T}=1$, we revert to the SIMO scenario, which is similar to the metric we presented in (\ref{eqn:maxlog_llr_simo}) for the general non-coherent fading channel by setting the relative magnitude of the LOS component $\alpha=0$, which is amenable to the pure LOS scenario.)
Futhermore, if the orthogonality between $\mathbf{x}_1, \mathbf{x}_2$ is not assumed, it would be quite challenging to establish a metric for such a LOS channel when $\mathrm \theta_{i,j}$ is unknown.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\balance
\section{Numerical Results}
\subsection{Performance Analysis}
For illustrative purposes, we consider three distinct configurations: $(4 \times 1)$ SIMO BICM,  $(2 \times 2)$ and  $(4 \times 2)$  MIMO BICM. The subsequent figures show the performance of BIPCM/BILCM with joint estimation and detection under various channel conditions. The evaluation discerns performance disparities across three scenarios: \textit{Perfect CSI}, \textit{No CSI} ($N_d=4$), and \textit{No CSI} ($N_d=1$).
The simulations employ NR POLAR and NR LDPC coding schemes, coupled with QPSK modulation. The transmission process encompasses a transport block length of 48 bits.The resource allocation procedure employs a singular OFDM symbol with either 4 PRBs or 48 resource elements (comprising 32 REs for data components and 16 REs for DMRS components). The DMRS sequences occupy 4 REs per PRB. This transmission framework, featuring joint transmission of reference and data components within shared OFDM symbols, adheres to the standard practice in the PUCCH or {\em physical uplink shared channel} (PUSCH), as well as in some downlink control channels. Hence, from the perspective of 5G NR PHY layers,  the transmission employing BICPM aligns with a PUCCH format 2 transmission, while that employing BILCM corresponds to a PUSCH transmission.


The results illustrated in Figure~\ref{fig:simo_los_polar_full} delineate the performance of the ($[8, 4, 2] \times 1$) SIMO BICM, with joint estimation and detection, over a LOS channel. This evaluation is conducted with a focus on the scenario where $\alpha=1$, aiming to discern the performance disparity between the \textit{Perfect CSI} and \textit{No CSI} conditions, particularly in coverage scenarios marked by low signal-to-noise ratios.

   \begin{figure}[!ht]
      \centering
    %\input{figures/comp/polar_simo_los.tex}
    \input{figures/comp/graph_retaked/polar_full_los}
    %\includegraphics[width=.9\linewidth]{figures/comp/polar_full_simo.pdf}
    \caption{Block Error Rate, 48 bits(TBs+CRC), NR POLAR BICM, R=48/64, (CRC)-aided successive-cancellation list decoder(List length=8), QPSK modulation, 1 OFDM symbol, 4 PRBs, 48 REs (32 data, 16 DMRS), ($[8, 4, 2] \times 1$) SIMO, vs outer (MC) and inner (RCUs) bounds, $\alpha=1$, Line-of-Sight (LOS) channel.}
    \label{fig:simo_los_polar_full}
  \end{figure}
Note that the {\em No CSI}($N_d=1$) case also  refers to the conventional receiver and {\em No CSI JED}($N_d=4$) corresponds to the proposed receiver based on {\em joint estimation and detection}($N_d=4$). The  JED-based receiver yields a perfomance gain of  $1.25$ dB, $1.5$ dB and $1.75$ dB  with respect to the conventional receiver over $2$, $4$ and $8$ receive antennas respectively at a  BLER threshold of $1\%$.
From this insight, it is apparent  that when the number of antennas increases, the performance gap between the \textit{Perfect CSI} and the \textit{No CSI} situations (e.g., JED-based receiver) expands.
Additionally, the max-log metric performs nearly as well as the accurate metric(i.e, Log-based LLRs) since Gray-mapped constellations are in use. Thus, the max-log metric seems to have minimal impact on receiver performance, as we operate with low modulation orders.

In addition, to conduct a comprehensive comparative analysis of our findings, we have employed finite block length bounds, integrating  both converses and achievability results as established in the scientific literature \cite{Xhemrishi2019, Polyanskiy2010, Durisi2016, Ostman2019jrnal, Martinez2011}. For a more insight into the {\em metaconverse} (MC) and {\em Random Coding Union}(RCU) bounds used in the aforementioned figures, reference can be made to the appendix Section B. Figure~\ref{fig:simo_4x1_polar_ldpc_ray_mc} shows that using the joint estimation and detection (JED) approach enhances performance by $1.5$ dB and $0.75$ dB for polar and LDPC coded configurations in a $(4 \times 1)$ SIMO system with Rayleigh block fading channel.  Additionally, a performance difference of approximately $1.25$ dB is observed between our JED-based receiver $(N_d = 4)$ utilizing BIPCM and the metaconverse bound. Interestingly, this difference diminishes to only $0.5$ dB when compared to the performance of the coherent receiver with \textit{Perfect CSI}. Conversely, referring to Figure~\ref{fig:simo_4x1_polar_ldpc_los_mc}, which illustrates $(4 \times 1)$ BIPCM SIMO and BILCM SIMO configurations over a LOS channel scenario. In the first configuration, at a $1\%$ BLER, the performance gap between the metaconverse bound and the JED-based receiver $(N_d = 4)$ is $0.7$ dB. This stands in contrast to a $2.2$ dB difference observed within the \emph{No-CSI}$(N_d = 1)$. Despite having similar code rates transmission parameters, BIPCM consistently outperforms BILCM. This is attributed, in part, to the optimization of the 3GPP polar code for short block lengths, whereas the 3GPP LDPC code is designed for longer transport block lengths.
\begin{figure*} [!ht]
    \centering
  \subfloat[\scriptsize {Rayleigh Block Fading channel.}\label{fig:simo_4x1_polar_ldpc_ray_mc}]{\input{figures/comp/graph_retaked/ray_simo_mc_rcu}}
    \hfill
  \subfloat[\scriptsize {Line-of-Sight (LOS) channel.}\label{fig:simo_4x1_polar_ldpc_los_mc}]{%
   \input{figures/comp/graph_retaked/los_simo_mc_rcu}}
  \caption{Block Error Rate, 48 bits(TBs+CRC), NR POLAR BICM (CRC-aided successive-cancellation list decoder, List length=8), NR LDPC BICM (belief propagation decoder, iteration=30) QPSK modulation, 1 OFDM symbol, 4 PRBs, 48 REs (32 data, 16 DMRS), ($4\times1$) SIMO, vs outer (MC) and inner (RCUs) bounds.}
  \label{fig:simo} 
\end{figure*}


Furthermore, the results illustrated in Figure~\ref{fig:mimo_22_ray_polar_ldpc}, representative of a $(2 \times 2)$ spatially multiplexed MIMO configuration, align with the trends observed in the preceding figures. Accordingly, the notable performance enhancements are significant, indicating improvements of $0.6$ dB and $0.3$ dB with JED-based receivers $(N_d = 4)$ when employing BIPCM and BILCM, respectively.

Likewise, figure~\ref{fig:mimo_42_los_polar_ldpc} illustrates the $(4 \times 2)$ BIPCM and BILCM MIMO configurations over LOS channel. At $1\%$ of BLER, the performance comparison in the first configuration indicates a gain of $1$ dB with the JED-based receiver over the conventional receiver. Hence, there is a gap of $0.6$ dB between the JED-based receiver $(N_d = 4)$ and the \textit{Perfect CSI}-based receiver. In the second configuration, namely the $(4 \times 2)$ BILCM MIMO, there is a $0.75$ dB improvement with the JED-based receiver $(N_d = 4)$ compared to the conventional receiver, and a $0.5$ dB gap between the \textit{Perfect CSI}-based receiver and the JED-based receiver $(N_d = 4)$.

\begin{figure*} [!ht]
    \centering
  \subfloat[\scriptsize {($2\times2$) SU-MIMO, vs outer (MC) bound,  Rayleigh Block Fading channel.}\label{fig:mimo_22_ray_polar_ldpc}]{\input{figures/comp/graph_retaked/mimo_ray_polar_ldpc_bound_3}}
    \hfill
  \subfloat[\scriptsize {($4\times2$) SU-MIMO, vs outer (MC) bound, Line-of-Sight (LOS) channel.}\label{fig:mimo_42_los_polar_ldpc}]{%
   \input{figures/comp/graph_retaked/mimo_los_polar_ldpc_bound_3}}
  \caption{Block Error Rate, 48 bits(TBs+CRC), NR POLAR BICM (CRC-aided successive-cancellation list decoder, List length=8), NR LDPC BICM (belief propagation decoder, iteration=30) QPSK modulation, 1 OFDM symbol, 4 PRBs, 48 REs (32 data, 16 DMRS).}
  \label{fig:mimo} 
\end{figure*}


Remarkably, it can be contended that the advanced receiver outperforms the conventional counterpart and demonstrates greater resilience in the face of inaccurate channel estimation.

\subsection{Metric Performance Extra Enhancement}
\subsubsection{DMRS Power Boosting}~\\
DMRS power boosting was extensively discussed in our prior correspondence \cite{sy2023_2}, particularly in scenarios where reference and data symbols are jointly conveyed in common OFDM symbols. Conceptually, envision the signal as comprising a data component and a data-independent component, or pilots, in a frequency-interleaved fashion.

To enhance the power of pilot signals within an interleaved set, scaling the power of DMRSs while keeping the data signals unchanged or constant is crucial. Put simply, the boosted transmitted signal, denoted as $\mathbf{x}_{\texttt{boosted}}$, is then defined as $\mathbf{x}_{\texttt{boosted}} = \mathbf{x}^{(\mathsf d)} + \beta \ \mathbf{x}^{(\mathsf p)}$. 
The adaptive power adjustment procedure depends contingent on $\beta$ values and aims to increase the power or strength of the pilot signals within the composite signal. Care should be taken to select an appropriate value for $\beta$ to achieve the desired power augmentation without introducing distortion or signal saturation. To comply with potential radio frequency constraints, $\beta$ must be perfectly calibrated.
Optimal performance enhancement is achieved when $\beta$ is set to $1.75$ (representing a $75\%$ increase in DMRS power compared to its initial value). In Figure~\ref{fig:dmrspower_boosting}, it is apparent to see that the proposed JED-based receiver yields an additional gain of approximately $0.5$ dB.

This improvement consistently converges towards an ever-closer alignment with the performance benchmarks set by the ideal or coherent receiver, mainly through adaptive DMRS/data power adjustment. In this spirit, we can even prioritise transmission with fewer DMRS in order to {\em bootstrap} the advance receiver, therefore reducing some transmission overhead.

The implications of slightly adjusting the DMRS power within the 3GPP standard are significant. Specifically, it is feasible to allow the {\em user equipment} (UE) to adjust the power allocation between the DMRS and data transmission. This flexibility in adaptive DMRS power adjustment is somewhat transparent to the receiver.
\subsubsection{Iterative Advanced Joint Estimation Detection}~\\
Iterative channel estimation detection is extensively investigated in the literature under various facets \cite{Jiao2021, Yuan2018, Jiang2007, Guo2021, Song2022}, showing the merits of the iterative process in achieving progressive performance. Considering recent advances in this field, in \cite{Jiao2021} Jiao et al.  introduce a joint channel estimation and decoding scheme for polar coded {\em sparse code multiple access} (SCMA) systems over fading channels in the wake of enhancing 5G communications for {\em massive machine-type communications} (mMTC) within the {\em Internet of Things} (IoT). Their proposed joint estimation-decoding scheme relies on {\em sparse Bayesian learning} (SBL) for initial CSI measurements, iteratively refines channel estimation and detection for enhanced system performance. Hence, the iterative joint estimation and detection procedure aiming to be put forward in this work aligns with existing literature, underscoring the importance of iterative strategies in both channel estimation and detection stages. Particularly, within BICM receiver framework, the iterative process is employed initially to enhance channel estimation quality and subsequently applied to the soft-detector to achieve superior and high-quality LLRs. This iterative iterative process spreads over two layers, as depicted in Algorithm~\ref{alg:2-laye_jed}.
Merely through the iterative channel estimation process, one can achieve a gain of few dBs. The iterative procedure, when applied to an advanced detector leading to a fully iterative receiver, further enhances these gains by a few additional dBs.
Nevertheless, it is noteworthy that the proposed JED-based receiver without iteration and with iteration exhibit a considerable degree of similarity in terms of performance as  depicted in  Figure~\ref{fig:iterative_jed}. Specifically, there is an approximate difference of $0.15$ dB when considering 10 iterations. This observation underscores the robustness of the proposed JED-based receiver in terms of channel estimation and detection, even in the absence of an iterative process. Indeed, the estimated channel and the employed detection strategy appear to be robust to a certain extent. In some scenarios, relying solely on the advanced JED without introducing an iterative process may be sufficient. This approach offers added value in terms of reducing receiver complexity, as introducing excessive operations at the receiver level could incur additional overhead and latency.
 
\begin{figure*} [!ht]
    \centering
  \subfloat[\scriptsize {DMRS power Boosting via a scaling factor $\beta$.}\label{fig:dmrspower_boosting}]{\input{figures/comp/state_of_art_analysis/dmrs_power_boosting}}
    \hfill
  \subfloat[\scriptsize {Iterative estimation-detection spanning from 5 and 10 iterations.}\label{fig:iterative_jed}]{%
    \input{figures/comp/state_of_art_analysis/iterative_jed_1510}}
  \caption{Block Error Rate, 48 bits(TBs+CRC), NR POLAR BICM, (CRC)-aided successive-cancellation list decoder, QPSK modulation, 1 OFDM symbol, 4 PRBs, 48 REs, ($40$REs= data, $8$REs= DMRS),  proposed JED-based receiver$(N_d = 4)$ over ($4\times1$) SIMO, on Line-of-Sight (LOS) Channel.}
  \label{fig:extra_enh} 
\end{figure*}


 \subsection{Complexity Analysis}
The complexity of the detection metrics is analysed using Monte Carlo simulation. The execution time highlights the time elapsed between the input and output of the demodulator, concisely, until the LLRs are generated.  It is relevant to ascertain the block size range wherein complexity is comparatively diminished when contrasted with traditional metrics to establish a better trade-off between performance and complexity.
Analytically, within a very short block regime, the standard and advanced receiver metrics exhibit near equivalence, as illustrated in Figure~\ref{fig:complexity_analysis}. However, as the block size increases, the complexity of the advanced receiver becomes greater than that of the conventional receiver, hence the need for block detection to break down this increasing complexity.
By harnessing parallel processing and assuming independence among the ($N_d$)-dimensional blocks constituting the detection windows, the detection complexity can be reduced compared to conventional receivers. This reduction is directly correlated with the degree of parallelism, which is contingent not only upon the quantity of processing nodes but also on the efficient distribution of the detection window processing among these nodes. Consequently, this approach unquestionably accelerates the overall detection process at the receiver level. 
Table~\ref{tab:poweer_ajust} depicts the average time complexity of the LLR bit metrics within $10,000$ iterations,  using a short block-width of 32 symbols, comparing the conventional metric with that proposed in log and max-log domain paired with block detections spanning  the detections windows(($N_d$=4) over $4$ parallel processing nodes within ($4\times1$) SIMO, ($4\times2$) SU-MIMO on Line-of-Sight (LOS) Channel, and ($2\times2$) SU-MIMO  on Rayleigh Block Fading (RBF) channels.
\begin{table}[htbp]
  \centering
  \caption{Average time complexity of the LLR bit metrics within $10,000$ iterations using a short block-size of 32 symbols wherein the JED-based receiver performs block detection strategy within  $4$ parallel $(\parallel)$ processing nodes.} 
   %\scalebox{0.8}{
    \begin{tabular}{l||c c c}
    %\toprule
    \hline
    Metrics & Conv. & JED. $(N_d=4)$. & JED. $(N_d=4)$\\
    \hline
    Domain & log. & log. & max-log. \\
    \hline
    $(4\times1)$ LOS. & $7.69$ \texttt{msec.} & $10.63$ \texttt{msec.} & $ 5.41$ \texttt{msec.} \\
    \hline
    $(4\times2)$ LOS. & $11.63$ \texttt{msec.} & $9.84$ \texttt{msec.} & $7.67$ \texttt{msec.} \\
    \hline
    $(2\times2)$ RBF. & $14.22$ \texttt{msec.} & $15.25$ \texttt{msec.} & $12.45$  \texttt{msec.}\\
   % \hline
   % Avg Exec. time  &  $2.2952$ & $4.4629$ & $8.1093$   \\
    \hline
    %\bottomrule
    \end{tabular}%
    \label{tab:poweer_ajust}%
  \end{table}%
  \begin{figure*} [!ht]
    \centering
  \subfloat[\scriptsize {Block detections spanning  the detections windows(($N_d$=4) within sequential processing.}\label{fig:complexity_analysis}]{ \input{figures/comp/complexity/complexity_full}}
    \hfill
  \subfloat[\scriptsize {Block detections spanning  the detections windows(($N_d$=4) over $4$ parallel processing nodes.}\label{fig:complexity_analysis_break}]{%
    \input{figures/comp/complexity/complexity_full_block_detection}}
  \caption{Average time complexity of the LLR bit metrics within $10,000$ iterations in the short block-length regime ($12-100$ bits) comparing the conventional metric with that proposed in log and max-log domain within ($4\times1$) SIMO, ($4\times2$) SU-MIMO on Line-of-Sight (LOS) Channel, and ($2\times2$) SU-MIMO  on Rayleigh Block Fading (RBF) channels.}
  \label{fig:complexity_anal} 
\end{figure*}


\subsection{LLR Outputs Quality Analysis}
  \begin{figure*} [!ht]
    \centering
  \subfloat[\scriptsize {Coherent receiver vs \{Conventional and  JED-based receivers.\} }\label{fig:llr_ananalysis_wrt_chan_cond}]{\input{figures/comp/llrsanalysis/llr_analysis.tex}}
    \hfill
  \subfloat[\scriptsize {JED-based receiver within  Log-based LLRs vs  MaxLog-based LLRs. }\label{fig:llr_ananalysis_wrt_log_maxlog}]{%
  \input{figures/comp/llrsanalysis/llr_analysis_log_maxlog}}
   % \input{figures/comp/llrsanalysis/3D_graph/llr_maxlog_f_snr}}
   %\includegraphics[width=.48\linewidth]{figures/comp/llrsanalysis/3D_graph/2_2.pdf}}
   %}
  \caption{Squared Relative Errors (RE) within $10000$ iterations, data symbole size=$32$, comparing the  output LLRs  at SNR level=\{$-5, 0, +5$ dB\}, ($4\times1$) SIMO on Line-of-Sight (LOS) Channel.}
  \label{fig:LLR_qual_anal} 
\end{figure*}
 Figure~\ref{fig:llr_ananalysis_wrt_chan_cond}  show {\em Squared Relative Errors} (SRE) over $10,000$ iterations in the short block-length regime ($12-100$ bits) is conducted to establish the relative similarity and/or disparity between the ideal or \textit{Perfect CSI}-based receiver and the other receivers under consideration, i.e. the JED-based receiver and the conventional receiver. This analysis focuses on the comparison of \textit{Perfect CSI}-based receiver LLR outputs with respect to that from the JED-based receiver and the conventional one. We consider a ($4\times1$) SIMO on LOS channel at low, moderate and high SNR regions and  operate with a  QPSK-based demodulator with an input data symbol width of  order $N_d$=$32$. The considered  SRE metric is defined as $ \zeta^2 = \frac{|\Lambda(\texttt{PSCI})-\Lambda(\texttt{JED/CONV})|^2}{| \Lambda(\texttt{PSCI})|^2}$.
Hence, from the depicted curves in  Figure~\ref{fig:llr_ananalysis_wrt_log_maxlog}, it is evident that  the relative error is lower for the JED receiver than for the conventional receiver across various SNR regions. Notably, in the low SNR region, the relative error significantly amplifies for the conventional receiver, while the JED receiver demonstrates a greater resilience to errors in such scenarios, as the LLRs of the JED receiver seem  reliable and close to the LLRs resulting from the coherent {Perfect CSI}-based receiver. This is particularly noteworthy in the low SNR region where channel estimates are somewhat worse due to inherent noise effects and low channel conditions. In practical terms, the relative error tends to increases considerably in low SNR environments, but the JED receiver exhibits increased robustness against such unsuitable channel conditions. 
Conversely, in regions characterized by high SNR, an acceptably high match threshold  can be achieved between the ideal receiver and JED-based receiver.

In the same spirit, looking at Figure~\ref{fig:llr_ananalysis_wrt_log_maxlog}, we can then assess the qualities of the LLR outputs in terms of relative error $(\zeta^2 = \frac{|\Lambda(\texttt{Log})-\Lambda(\texttt{MaxLog})|^2}{| \Lambda(\texttt{Log})|^2})$, involving the generation of log-based and max-log-based LLRs across the considered SNR regions(i.e., low, medium, and high). Notably, in high SNR areas, there's a more noticeable error due to increased sensitivity to small variations where the signal is already strong compared to the noise. This can lead to rounding and accuracy issues in LLR calculations. On the flip side, in low SNR areas, signal variations are hidden in the noise, making errors from approximating metrics in the log domain with the max-log version less noticeable. Therefore, when operating in low SNR areas with a low modulation order, the max-log approach could be a suitable choice, balancing performance and complexity.

 
\section{Conclusions}
This paper presented novel bit-interleaved coded modulation metrics for joint estimation detection using a training or reference signal transmission strategy for medium to long block length channels. We showed that it is possible to enhance the performance and sensitivity of advanced receivers, especially when channel state information is unknown and the density of training dimensions is low. The proposed techniques take advantage of joint estimation/detection. The performance analysis made use of a full 5G transmitter and receiver chain for both Polar and LDPC coded transmissions paired with with M-ary QPSK  modulation schemes. We considered transmissions where reference signals are interleaved with data and both are transmitted over a small number of OFDM symbols so that near-perfect channel estimation cannot be achieved. This is particularly adapted to mini-slot transmissions for ultra-reliable low-latency communications or short-packet random-access use-cases. We characterized the performance for up to SIMO and MIMO  configurations in order to determine the performance gain offered by the proposed BICM detection in realistic basestation receiver scenarios. Our findings demonstrated that when the detection windows used in the metric units is on the order of four modulated symbols the proposed BICM metrics can be used to achieve detection performance that is close to that of a coherent receiver with perfect channel state information for both polar and LDPC coded configurations.
%\section*{Acknowledgment}
%This work has been supported by Qualcomm.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix
\label{appendix:llrfading}
\renewcommand{\thesection}{\Alph{section}.\arabic{subsection}}
\setcounter{section}{0}
\subsection{Metric derivation for general non-coherent fading channel: \texorpdfstring{$(\mathsf{N_R}\times 1)$} \ ~ SIMO}
Since $\theta_i$ is unknown and randomly distributed over $[0, 2\pi)$, the conditional probability density function can be written as follows:
\begin{align}
\begin{array}{r}
\mathrm q\left(\mathbf{x}, \mathbf{y}_i \right)
=\displaystyle\frac{1}{2 \pi \operatorname{det} \Phi} \displaystyle\int_0^{2 \pi}
\exp \left(-\frac{1}{2}\left(\mathbf{y}_i-\ \mu\{\mathbf x, \theta_i\} \right)^{\dagger}\right. \\
\left.\Phi^{-1}\left(\mathbf{y}_i-\mu\{\mathbf x, \theta_i\}\right)\right) \mathrm{d} \theta_i \ .
\end{array}
\end{align}


Saying  $\mu\{\mathbf x, \theta_i\}=  \sqrt{\alpha} e^{j \theta_i}\mathbf x$, then
\begin{equation}
\begin{aligned}
\mathrm q\left(\mathbf{x}, \mathbf{y}_i \right)
=\displaystyle\frac{1}{2 \pi \operatorname{det} \Phi} \displaystyle\int_0^{2 \pi}
\exp \left(-\frac{1}{2}\left(\mathbf{y}_i-\sqrt{\alpha} e^{j \theta_i} \mathbf{x}\right)^{\dagger}\right. \\
\left.\Phi^{-1}\left(\mathbf{y}_i-\sqrt{\alpha} e^{j \theta_i} \mathbf{x}\right)\right) \mathrm{d} \theta_i  \ .
\end{aligned}
\end{equation}

\subsubsection*{\bf \small{Covariance Matrix }}
Knowing that
\begin{equation}
  \mathbf y_i - \sqrt{\alpha} e^{j \theta_i} \mathbf x = \sqrt{1-\alpha} \mathrm h_{i,f}\mathbf x + \mathbf z_i,
\end{equation}
then
\begin{equation}
\begin{aligned}
\Phi&\triangleq
\frac{1}{2}\mathbb{E}\left[\left(\sqrt{1-\alpha} \mathrm h_{i}^{(f)}\mathbf x + \mathbf z_i \right)\left(\sqrt{1-\alpha}\mathrm h_{i}^{(f)}\mathbf x + \mathbf z_i\right)^\dag\right]\\
%&=\frac{1}{2}\mathbb{E}\left[\left(\sqrt{1-\alpha} A_i \mathbf h_{i,f}\mathbf x + \mathbf z_i \right)\left(\sqrt{1-\alpha} A_i \mathbf h^\dag_{r,f}\mathbf x^\dag + \mathbf z^\dag_i\right)\right]\\
%&=  (1-\alpha)  \mathbf x\mathbf x^\dag \times   \frac{1}{2}\mathbb{E}\left[\mathbf h_{i,f} \mathbf h^\dag_{r,f}\right] + \frac{1}{2}\mathbb{E}\left[ \mathbf z_i \mathbf z^\dag_i\right]\\
&\triangleq  (1-\alpha)  \mathbf x\mathbf x^\dag \sigma^2_h + \sigma^2_z \mathbf I_N, \text{where } \sigma^2_h =1\\
&\triangleq  (1-\alpha)  \mathbf x\mathbf x^\dag + \frac{\mathrm {N}_0}{2}  \mathbf I_N  \ .
\end{aligned}
\end{equation}


\subsubsection*{\bf \small{Determinant}}
\begin{equation}
\begin{aligned}
\operatorname{det} \Phi &= \operatorname{det}\left( (1-\alpha)  \mathbf x\mathbf x^\dag + \sigma^2_z \mathbf I \right)\\
 &= \operatorname{det}\left( \sigma^2_z \mathbf I + k \mathbf x\mathbf x^\dag \right), \text{ where}, k = (1-\alpha)  \ .
\end{aligned}
\end{equation}

Using   properties from Definition 3, it comes: .% and (iii) $det(\mathbf A + \mathbf B) \geq det(\mathbf A) + det{\mathbf B)}$
\begin{equation}
\begin{aligned}
\operatorname{det} \Phi &
%\sigma^2_z + k \mathbf x^\dag\mathbf x\\&=
%\sigma^2_z + k \left\|\mathbf x \right\|^2\\&=
%\frac{\mathrm {N}_0}{2}+ (1-\alpha)  \left\|\mathbf x \right\|^2\\&
=\frac{1}{2}\left(\mathrm {N}_0+ 2(1-\alpha)  \left\|\mathbf x \right\|^2\right)  \ .
\end{aligned}
\end{equation}







\subsubsection*{\bf  \small{Inverse of $\Phi$ }}
The matrix inversion  {\em Lemma 1} must be used. Note that,  here, we have a special case where $\mathbf V$, $\mathbf U$ are vectors, consequently $\operatorname{rank}\{\mathbf x^\dag \mathbf x\}=1$.

Let's say :
\begin{equation}
\left\{\begin{array}{l}
 \displaystyle \mathbf A= \sigma^2_z \mathbf I\\
  \displaystyle \mathbf C =(1-\alpha)\mathbf I  \\
  \displaystyle \mathbf U= \mathbf x \\
  \displaystyle \mathbf V= \mathbf x^\dag
\end{array}\right.\ .
\end{equation}

\begin{equation}
\begin{aligned}
\Phi^{-1} &= \left (\mathbf A+\mathbf U \mathbf C \mathbf V\right)^{-1}\\&
  % =\frac{2}{\mathrm {N}_0}- \frac{2}{\mathrm {N}_0} \mathbf x
  % \left[\frac{2k}{\mathrm {N}_0 +2(1-\alpha)\left\|\mathbf x \right\|^2} \right]\mathbf x^\dag\\&
  =\frac{2}{\mathrm {N}_0}- \frac{2}{\mathrm {N}_0} \mathbf x
  \left(\frac{2(1-\alpha) }{\mathrm {N}_0 +2(1-\alpha) \left\|\mathbf x \right\|^2} \right)\mathbf x^\dag  \ .
\end{aligned}
\end{equation}


let say  $\beta_x = \frac{2(1-\alpha) }{\mathrm {N}_0(\mathrm {N}_0 +2(1-\alpha) \left\|\mathbf x \right\|^2)}$

then
\begin{equation}
\begin{aligned}
\Phi^{-1} &=\frac{2}{\mathrm {N}_0}- 2 \mathbf x
\beta_x\mathbf x^\dag.
\end{aligned}
\end{equation}

\subsubsection*{\bf \small{Likelihood function}}
%
%
% let's say $\mu = \sqrt{\alpha} e^{j \theta_i}\mathbf x$
\begin{equation}
\begin{aligned}
&\mathrm q\left(\mathbf{x},\mathbf y_i\right)=\\&\displaystyle
 \frac{\displaystyle \int_{0}^{2\pi}\exp \left(-\frac{1}{2}\left(\mathbf y_i-\mu\right)^\dag  \left(\frac{2}{\mathrm {N}_0}-  2 \mathbf x
\beta_x\mathbf x^\dag\right)\left(\mathbf y_i-\mu \right)\right)}{2 \pi \operatorname{det} \Phi}\mathrm{d} \theta_i\\&
=\displaystyle
\frac{\displaystyle \int_{0}^{2\pi}\exp \left(-\frac{1}{\mathrm {N}_0}\left|\mathbf y_i-\mu\right|^2 +  \beta_x \left|\left(\mathbf y_i-\mu\right)^\dag\mathbf x\right|^2\right)}{2 \pi \operatorname{det} \Phi}\mathrm{d} \theta_i\nonumber.
\end{aligned}
\end{equation}

By extending the terms into the exponential, ignoring those that are independent of $\mathbf x$,
% \begin{equation}
% \begin{aligned}
% \alpha \left\|\mathbf x \right\|^2 \left(\frac{1}{\mathrm {N}_0} - \beta_x \left| \mathbf x\right|^2\right) + \beta_x \left| \mathbf x^\dag \mathbf y_i \right|^2 \\+  2\sqrt{\alpha}
%  \left(\frac{1}{\mathrm {N}_0} - \beta_x \left| \mathbf x\right|^2\right)|\mathbf X^\dag\mathbf y_{i}|\mathrm{cos}\left({\phi_i} + \theta_i \right).\nonumber
% \end{aligned}
% \end{equation}
the likelihood function is equivalent to

% \begin{equation}
% \begin{array}{r}
% \mathrm q\left(\mathbf{x}, \mathbf{y}_i\right)=\displaystyle\frac{1}{2 \pi \operatorname{det} \Phi} \displaystyle \int_0^{2 \pi} \exp \left(-\frac{1}{\mathrm {N}_0}\left|\mathbf{y}_i-\mu\right|^2+\right. \\
% \left.\beta_x\left|\left(\mathbf{y}_i^{\dagger}-\mu^{\dagger}\right) \mathbf{x}\right|^2\right) \mathrm{d} \theta_i
% \end{array}
% \end{equation}

\begin{equation}
\begin{array}{r}
\mathrm q\left(\mathbf{x},\mathbf y_i\right)
=\displaystyle \frac{1}{2 \pi \operatorname{det} \Phi}\exp \left(- \alpha \left\|\mathbf x \right\|^2 \left(\frac{1}{\mathrm {N}_0} - \beta_x \left\| \mathbf x\right\|^2\right) \right. \\
\left.
\beta_x \left| \mathbf x^\dag \mathbf y_i \right|^2\right) \displaystyle \int_{0}^{2\pi}\exp \left( 2\sqrt{\alpha} \left(\frac{1}{\mathrm {N}_0} - \beta_x \left\| \mathbf x\right\|^2\right)\right. \\
\left.|
  \mathbf x^\dag\mathbf y_i|\mathrm{cos}\left({\phi_i} + \theta_i \right)\right)\mathrm{d} \theta_i \nonumber.
\end{array}
\end{equation}
knowing that $\displaystyle \frac{1}{\pi}\int_{{\varphi}=0}^{\pi}\exp(zcos(\varphi))\mathrm{d} \varphi=\operatorname{I_0(z)} $ \cite{Gradshteyn95}.\\
% \begin{equation}
% \begin{aligned}
% &\mathrm q\left(\mathbf{x},\mathbf y_i\right)=\\& \frac{2}{\mathrm {N}_0+ 2(1-\alpha)  \left\|\mathbf x \right\|^2}\exp \left(- \alpha  \left\|\mathbf x \right\|^2
% \left(\frac{1}{\mathrm {N}_0} - \beta_x \left| \mathbf x\right|^2\right)\right. \\& \left. + \beta_x \left| \mathbf x^\dag \mathbf y_i \right|^2\right)\times \operatorname{I_0}\left( 2\sqrt{\alpha} \left(\frac{1}{\mathrm {N}_0} -
% \beta_x \left| \mathbf x\right|^2\right)\left|\mathbf x^\dag\mathbf y_i\right|\right)
% \end{aligned}
% \end{equation}
Saying  $\mathbf L_{x} = \mathrm {N}_0+ 2(1-\alpha)  \left\|\mathbf x \right\|^2$, and then after ignoring multiplicative term that are independent of $\mathbf x$, it comes
 \begin{equation}\label{eqn:llrfunction_proof}
 \begin{aligned}
 &\mathrm q\left(\mathbf{x},\mathbf y_i\right)\propto \frac{1}{\mathbf L_\mathsf x}\exp \left(- \alpha \left\|\mathbf x \right\|^2\left(\frac{1}{\mathrm {N}_0} - \mathbf \beta_x \left\| \mathbf x\right\|^2\right) \right. \\& \left.  + \mathbf \beta_x \left| \mathbf x^\dag \mathbf y_i \right|^2\right)\times\operatorname{I_0}\left( 2\sqrt{\alpha} \left(\frac{1}{\mathrm {N}_0} - \mathbf \beta_x \left\| \mathbf x\right\|^2\right)\left|\mathbf x^\dag\mathbf y_i\right|\right).
 \end{aligned}
 \end{equation}

 Expressing $\mathbf \beta_x$  w.r.t  \ $\mathbf L_\mathsf{x}$, we have the relation

\begin{equation}
\begin{aligned}
\mathbf \beta_x
% \frac{2(1-\alpha) }{\mathrm {N}_0(\mathrm {N}_0 +2(1-\alpha) \left\|\mathbf x \right\|^2)}\\&
% = \frac{2(1-\alpha) }{\mathrm {N}_0 \mathbf L_x}, \text{ where } \mathbf L_x = \mathrm {N}_0 +2(1-\alpha) \left\|\mathbf x \right\|^2\\&
% =\frac{\mathbf L_x - \mathrm {N}_0}{\left\|\mathbf x \right\|^2 \mathrm {N}_0 \mathbf L_x}\\&
% = \frac{\mathbf L_x}{\left\|\mathbf x \right\|^2 \mathrm {N}_0 \mathbf L_x} - \frac{ \mathrm {N}_0}{\left\|\mathbf x \right\|^2\mathrm {N}_0 \mathbf L_x}\\&
=\frac{1}{\left\|\mathbf x \right\|^2 \mathrm {N}_0} - \frac{ 1}{\left\|\mathbf x \right\|^2\mathbf L_\mathsf x}.
\end{aligned}
\end{equation}
%

%

\subsection{ABC's on Finit-Blocklength Bounds}
Herein, we present the finite-blocklength information theory tools. An outer bound, derived from the metaconverse theorem (cf. \cite[Th. 28]{Polyanskiy2010}), is introduced, while an inner bound is established using the RCUs bound \cite[Th. 1]{Martinez2011}.
In accordance with an analogical framework, the following is grounded in the scholarly contributions \cite{Xhemrishi2019, Ostman2019jrnal, Martinez2011}. We endeavor to meticulously adapt their work to our specific transmission scenario, aiming for a faithful and nuanced incorporation of their insights.
\begin{equation}
\imath_s\left(\mathbf{x}, \mathbf{y}\right)=\ln \frac{\mathrm q\left(\mathbf{x}, \mathbf{y}\right)^s}{\mathbb{E}\left[\mathrm q\left(\overline{\mathbf{X}}, \mathbf{y}\right)^s\right]}.
\end{equation}

In the domain of information theory, the Gallager exponent, represented by $s > 0$, characterizes a pivotal factor. The expectation pertains to $\overline{\mathbf{X}}$. The achievability bound of Random Coding Unions (RCUs) posits that, for a specified rate $R$, the upper limit of average error probability is prescribed as

\begin{equation}\label{eqn:rcu}
\epsilon \leq \inf _{s>0} \mathbb{E}\left[e^{-\left[\imath_s\left(\mathbf{x}, \mathbf{y}\right)-\ln \left(2^{R \times N}-1\right)\right]^{+}}\right],
\end{equation}
where $(a)^{+} \triangleq \max (0, a)$.

The bound in (\ref{eqn:rcu}) is estimated for the following pairs of input distributions and maximum likehihood decoding metrics. %\cite[Sec. III.A-III.D]{Ostman2019jrnal}.
In this pilot-assisted transmission in use, with the $N_d$ data symbols uniformly distributed on a shell in $\mathbb{C}^{N_d}$, the maximum likehihood decoding metric is shown to be
$\mathrm q(\mathbf{x}, \mathbf{y})=p_{\mathbf{Y}^{(\mathsf d)} \mid \mathbf{X}^{(\mathsf d)}, \hat{\mathbf{h}}}\left(\mathbf{y}^{(\mathsf d)} \mid \mathbf{x}^{(\mathsf d)}, \hat{\mathbf{h}}\right)$.
In practical terms, the PAT decoding metric, as outlined in stman's work \cite[Sec. III.D]{Ostman2019jrnal}], is expressed as $\mathrm q(\mathbf{x}, \mathbf{y}) \propto \exp \left(-\left\|\mathbf{y}^{(\mathsf d)}-\hat{\mathbf{h}} \mathbf{x}^{(\mathsf d)}\right\|^2\right)$.

To establish the converse bound, we introduce the function

\begin{equation}
\jmath_s\left(\mathbf{x}, \mathbf{y}\right)=\ln \frac{p_{\mathbf{Y} \mid \mathbf{X}}\left(\mathbf{y} \mid \mathbf{x}\right)}{q_{\mathbf{Y}}^s\left(\mathbf{y}\right)}.
\end{equation}

where $q_{\mathbf{Y}}^s\left(\mathbf{y}\right)=\frac{1}{\mu(s)} \mathbb{E}\left[p_{\mathbf{Y} \mid \mathbf{X}}\left(\mathbf{y} \mid \overline{\mathbf{X}}\right)^s\right]^{1 / s}$, and the normalization factor $\mu(s)$ is selected such that $q_{\mathbf{Y}}^s\left(\mathbf{y}\right)$ integrates to unity.

Subsequently, for a given rate $R$, the lower bound on the average error probability can be expressed as follows.
\begin{equation}
\epsilon \geq \sup _{s>0} \sup _{\lambda>0} \mathbb{P}\left[ \jmath_s\left(\mathbf{x}, \mathbf{y}\right) \leq \lambda\right]-e^{\lambda-R\times N}.
\end{equation}

In our simulation parameters, we do not engage in optimization over the parameter $s$; instead, we opt for the fixed value $s = 1$, which offers a more relaxed constraint.


Furthermore, considering MIMO setups, the following likelihood decoding metric is used to determine the outer (MC) and inner (RCU) bounds:
$\mathrm q(\mathbf{X}, \mathbf{Y})=p_{\mathbf{Y}^{(\mathsf d)} \mid \mathbf{X}^{(\mathsf d)}, \hat{\mathbf{H}}}\left(\mathbf{Y}^{(\mathsf d)} \mid \mathbf{X}^{(\mathsf d)}, \hat{\mathbf{H}}\right)$.
The PAT decoding metric is then stated as follows: $\mathrm q(\mathbf{X}, \mathbf{Y}) \propto \exp \left(-\left\|\mathbf{Y}^{(\mathsf d)}-\hat{\mathbf{H}} \mathbf{X}^{(\mathsf d)}\right\|^2_\mathsf F\right)$.

% \subsection{\texorpdfstring{$(\mathsf{N_R}\times \mathsf{N_T})$} \ ~ MIMO BICM Metric Extension}
% \begin{equation}
%  \begin{aligned}\label{eqn:_jed_lf_mimo}
%    \mathrm q(\mathbf{x}, \mathbf{y}) & =\frac{1}{{\mathscr{L}_j(\mathsf x})} \exp \left(\frac { 1 } { N _ { 0 } } \displaystyle \sum_{i=1}^{\mathsf{N_R}} \sum_{j=1}^{\mathsf{N_T}} \left\{\left(\mathbf\eta_j({\mathsf p}) {\widehat{\mathrm{h}}_{i,j}}+{\mathbf{x}_j^{(\mathsf d)}}^\dag \mathbf{y}_i^{(\mathsf d)}\right)^\dag \right.  \right. \\
%    &\hspace{6.5em}\left. \left.\mathrm{D_j}\left(\mathbf\eta_j({\mathsf p}){\widehat{\mathrm{h}}_{i,j}}+{\mathbf{x}_j^{(\mathsf d)}}^\dag \mathbf{y}_i^{(\mathsf d)}\right)\right\} \right).
%   \end{aligned}
% %  \end{equation}

% where   $\mathrm D_j=\left(\mathrm I_{j,j}+{\mathbf{x}_j}^\dag \mathbf{x}_j\right)$,  $\mathbf\eta_j({\mathsf p})  = {\mathbf{x}_j^{(\mathsf p)}}^\dag \mathbf{x}_j^{(\mathsf p)}$   and ${\mathscr{L}_j(\mathsf x})= \pi^{N \times \mathsf{N_R}}\left(\mathrm {N}_0 + \displaystyle \sum_{i=1}^{\mathsf{N_R}}\{\mathbf{x}_j^\dag\mathbf{x}_j\}\right)^{\mathsf{N_R}}$.
% \begin{equation}
% q(\mathbf{X}, \mathbf{Y}) \propto \exp \left(-\left\|\mathbf{Y}^{(\mathsf d)}-\hat{\mathbf{H}} \mathbf{X}^{(\mathsf d)}\right\|^2_\mathsf F\right)\nonumber.
% \end{equation}
%\section*{Acknowledgment}
%The authors would like to thank...

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{thebibliography}{C}

\bibliographystyle{IEEEtran}

\bibitem{zehavi92}E.  Zehavi, ``8-PSK trellis codes for a Rayleigh fading channel'',IEEE Transactions on Communication, vol.40, pp. 873883, 1992, May 1992.

\bibitem{Fabregas08}A. G. i Fbregas, A Martinez and G. Caire, ``Bit-Interleaved Coded Modulation", Foundations and Trends in Communications and Information Theory Vol. 5: No. 12, pp 1-153, November 2008.

\bibitem{CTB98}G. Caire, G. Taricco and  E. Biglieri, `` Bit- Interleaved Coded Modulation,'' IEEE Transactions on Information Theory, vol. 44, pp. 927946, May 1998.


\bibitem{Hochwald2003}B. M Hochwald and S. T Brink, "Achieving near-capacity on a multiple-antenna channel," in IEEE Transactions on Communications, vol. 51, no. 3, pp. 389-399, March 2003.


\bibitem{Marzetta1999}T. L. Marzetta and B. M. Hochwald, "Capacity of a mobile multiple-antenna communication link in Rayleigh flat fading," in IEEE Transactions on Information Theory, vol. 45, no. 1, pp. 139-157, Jan. 1999.

\bibitem{Hochwald2000}B. M. Hochwald and T. L. Marzetta, "Unitary space-time modulation for multiple-antenna communications in Rayleigh flat fading," in IEEE Transactions on Information Theory, vol. 46, no. 2, pp. 543-564, March 2000.


 \bibitem{Carrera2021}D. F. Carrera, D. Zabala-Blanco, C. Vargas-Rosales and C. A. Azurdia-Meza, "Extreme Learning Machine-Based Receiver for Multi-User Massive MIMO Systems," in IEEE Communications Letters, vol. 25, no. 2, pp. 484-488, Feb. 2021.

  \bibitem{Cammerer2023}S. Cammerer, F. A. Aoudia, J. Hoydis, A. Oeldemann, A. Roessler, T. Mayer and  A. Keller, "A Neural Receiver for 5G NR Multi-user MIMO," ArXiv abs/2312.02601,2023.

\bibitem{Lee2018}B. Lee, S. Park, D. J. Love, H. Ji and B. Shim, "Packet Structure and Receiver Design for Low Latency Wireless Communications With Ultra-Short Packets," in IEEE Transactions on Communications, vol. 66, no. 2, pp. 796-807, Feb. 2018.

  \bibitem{sy2023_1}M. Sy, R. Knopp, "Enhanced Low-Complexity Receiver Design for Short Block Transmission Systems," 34th IEEE International Symposium on Personal, Indoor and Mobile Radio Communications(PIMRC 2023), Toronto, ON, Canada, Sept. 2023.

\bibitem{sy2023_2}M. Sy, R. Knopp, "Novel Joint Estimation and Decoding Metrics for Short-Blocklength Transmission Systems,"  2023 IEEE Conference on Standards for Communications and Networking (CSCN), Munich, Germany, Nov. 2023.


 \bibitem{Doan2022}N. Doan, "Low-complexity decoding of short linear block codes with machine learning,"  PhD Thesis Dissertation, McGill University, May 2022.

\bibitem{Yue2023}C. Yue, V. Miloslavskaya, M. Shirvanimoghaddam, B. Vucetic and  Y. Li, "Efficient Decoders for Short Block Length Codes in 6G URLLC," IEEE Communications Magazine, Vol. 61, no.4, pp 8490, April 2023.

\bibitem{Vu2023} T. -H. Vu, T. -T. Nguyen, Q. -V. Pham, D. B. da Costa and S. Kim, "A Novel Partial Decode-and-Amplify NOMA-Inspired Relaying Protocol for Uplink Short-Packet Communications," in IEEE Wireless Communications Letters, vol. 12, no. 7, pp. 1244-1248, July 2023.


\bibitem{Xhemrishi2019}M. Xhemrishi, M. C. Cokun, G. Liva, J. stmanl and G. Durisi, "List Decoding of Short Codes for Communication over Unknown Fading Channels," 2019 53rd Asilomar Conference on Signals, Systems, and Computers, Pacific Grove, CA, USA, 2019, pp. 810-814.

%\bibitem{Yuan2021}P. Yuan, M. C. Cokun and G. Kramer, "Polar-Coded Non-Coherent Communication," in IEEE Communications Letters, vol. 25, no. 6, pp. 1786-1790, June 2021.

\bibitem{Polyanskiy2010}Y. Polyanskiy, H. V. Poor and S. Verdu, "Channel Coding Rate in the Finite Blocklength Regime," in IEEE Transactions on Information Theory, vol. 56, no. 5, pp. 2307-2359, May 2010.

\bibitem{Durisi2016}G. Durisi, T. Koch, J. stman, Y. Polyanskiy and W. Yang, "Short-Packet Communications Over Multiple-Antenna Rayleigh-Fading Channels," in IEEE Transactions on Communications, vol. 64, no. 2, pp. 618-629, Feb. 2016.

\bibitem{Ostman2019jrnal}J. stman, G. Durisi, E. G. Strm, M. C. Cokun and G. Liva, "Short Packets Over Block-Memoryless Fading Channels: Pilot-Assisted or Noncoherent Transmission?," in IEEE Transactions on Communications, vol. 67, no. 2, pp. 1521-1536, Feb. 2019.

\bibitem{Martinez2011}A. Martinez and A. G. i Fbregas, "Saddlepoint approximation of random-coding bounds," 2011 Information Theory and Applications Workshop, La Jolla, CA, USA, 2011, pp. 1-6.

 \bibitem{Erseghe2016}T. Erseghe, Coding in the Finite-Blocklength Regime: Bounds Based on Laplace Integrals and Their Asymptotic Approximations, in IEEE Transactions on Information Theory, vol. 62, no. 12, pp. 6854-6883, Dec. 2016.

 \bibitem{3GPP38212}3GPP TS 38.212 V16.2.0, `` Technical Specification Group Radio Access Network, Multiplexing and channel coding'', July 2020.
%% polar
 \bibitem{Arikan2009}E. Arikan, ``Channel Polarization: A Method for constructing Capacity-Achieving Codes for Symmetric Binary-Input Memoryless Channels'', IEEE Transactions on Information Theory, vol. 55, No. 7, pp. 3051-3073, July 2009.

\bibitem{Ahmadi2018}S. Ahmadi, `` 5G NR, Architecture, Technology, Implementation, and Operation of 3GPP New Radio Standard'',London, United Kingdom : Academic Press, an imprint of Elsevier, 2019.


\bibitem{Stimming2014}A. Balatsoukas-Stimming, M. B. Parizi and A. Burg, "LLR-Based Successive Cancellation List Decoding of Polar Codes," in IEEE Transactions on Signal Processing, vol. 63, no. 19, pp. 5165-5179, Oct.1, 2015.

\bibitem{Tal_vardy2015}I. Tal and A. Vardy, "List Decoding of Polar Codes," in IEEE Transactions on Information Theory, vol. 61, no. 5, pp. 2213-2226, May 2015.

\bibitem{Zhang2017}Q. Zhang, A. Liu, X. Pan and K. Pan, "CRC Code Design for List Decoding of Polar Codes," in IEEE Communications Letters, vol. 21, no. 6, pp. 1229-1232, June 2017.

\bibitem{Niu2012}K. Niu and K. Chen, ``CRC-Aided Decoding of Polar Codes'', IEEE Communications Letters, vol. 16, No. 10,  pp.1668-167, October 2015.

\bibitem{Arikan2008}E. Arikan, "Channel polarization: A method for constructing capacity-achieving codes," 2008 IEEE International Symposium on Information Theory, Toronto, ON, Canada, 2008, pp. 1173-1177.

\bibitem{Fayyaz2013}U. U. Fayyaz and J. R. Barry, "Polar codes for partial response channels," 2013 IEEE International Conference on Communications (ICC), Budapest, Hungary, 2013, pp. 4337-4341.

%%% LDPC
\bibitem{Gallager63}R. G. Gallager, ``Low Density Parity Check Codes'', Cambridge, USA: MIT Press, July 1963.
\bibitem{Nguyen2019}T. Nguyen, T. N. Tan, and H. Lee, ``Efficient QC-LDPC Encoder for 5G New Radio'', Electronics, vol. 8, p. 668, June 2019.

\bibitem{wang2021}LIFANG WANG ``Implementation of Low-Density Parity-Check codes for 5G NR shared channels,'' master Thesis, August 30, 2021.

\bibitem{3GPP38211}3GPP TS 38.211 V16.5.0, `` Technical Specification Group Radio Access Network, Physical Channels and Modulation'', May 2021.

%% BOOKs mimo foundation
\bibitem{Hampton2013}J. R. Hampton, ``Introduction to MIMO Communications," Cambridge University Press, Nov. 2013.
\bibitem{Heath2018}R. W. Heath Jr., A. Lozano, ``Foundations of MIMO Communication," Cambridge University Press, Dec. 2018.

\bibitem{Gallager2008}Robert G. Gallager, ''Circularly-Symmetric Gaussian random vectors,''Massachusetts Institute of Technology, January 1, 2008.
\bibitem{Sylvester1851}Sylvester, James J., "On the relation between the minor determinants of linearly equivalent quadratic functions". Philosophical Magazine 1, pp. 295305, 1851.

\bibitem{Woodbury1950}Woodbury, Max A., ``Inverting modified matrices", Statistical Research Group, Memo. Rep. no. 42, Princeton University, Princeton, N. J., 1950. pp.4.

\bibitem{Fubini1907} G. Fubini, "Sugli integrali multipli", Rom. Acc. L. Rend. (5), vol. 16, no. 1, pp. 608-614, 1907.

\bibitem{Jiao2021}J. Jiao, K. Liang, B. Feng, Y. Wang, S. Wu and Q. Zhang, "Joint Channel Estimation and Decoding for Polar Coded SCMA System Over Fading Channels," in IEEE Transactions on Cognitive Communications and Networking, vol. 7, no. 1, pp. 210-221, March 2021.
\bibitem{Yuan2018} W. Yuan, N. Wu, Q. Guo, Y. Li, C. Xing and J. Kuang, "Iterative receivers for downlink MIMO-SCMA: Message passing and distributed cooperative detection", IEEE Trans. Wireless Commun., vol. 17, no. 5, pp. 3444-3458, May 2018.
\bibitem{Jiang2007}M. Jiang, J. Akhtman and L. Hanzo, "Iterative joint channel estimation and multi-user detection for multiple-antenna aided OFDM systems", IEEE Trans. Wireless Commun., vol. 6, no. 8, pp. 2904-2914, Aug. 2007.
\bibitem{Guo2021}G. Guo, Z. Jin, X. Zhang and J. Wei, "Joint Iterative Channel Estimation and Symbol Detection for Orthogonal Time Frequency Space Modulation," 2021 IEEE 94th Vehicular Technology Conference (VTC2021-Fall), Norman, OK, USA, 2021, pp. 1-6.
\bibitem{Song2022}H. Song, T. Goldstein, X. You, C. Zhang, O. Tirkkonen and C. Studer, "Joint Channel Estimation and Data Detection in Cell-Free Massive MU-MIMO Systems," in IEEE Transactions on Wireless Communications, vol. 21, no. 6, pp. 4068-4084, June 2022.

\bibitem{Gradshteyn95}I. S. Gradshteyn and I. M. Ryzhik, ``Table of Integrals, Series and Products" Academic Press, Seventh edition, 2007.


\end{thebibliography}



% %\newpage

% %\section{Biography}

% %\vspace{11pt}


% \vspace{-33pt}
% \begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{figures/newfigures/author/mody.jpg}}]{Mody Sy} received the M.Eng. degree known as Dipl. Ing. in Computer Engineering (Speciality : Telecommunications and Networks) from Ecole Suprieure Polytechnique (ESP ) of Dakar, Senegal, in 2020. Currently, he is a research assistant in the Communication Systems Department at EURECOM working towards a PhD degree in Computer Science and Telecommunications from the Doctoral School EDITE of Sorbonne University, Paris, France. His research interests are in the area of digital communications and implementation aspects of real-time wireless communication systems. %Mody's thesis topic is "Coding and Multiple-Access Strategies for Ultra-Reliable Low-Latency communications with Applications in Cyber-physical Systems"
%\end{IEEEbiography}
%\vspace{11pt}
% \begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{fig1}}]{Raymond Knopp}
% \lipsum[1-1]
% \end{IEEEbiography}
% \vspace{11pt}


\vfill

\end{document}
