%\newcommand{\yaqidone}{\yaqi{Done.}}
\newcommand{\yaqidone}{}
\newcommand{\yaqitbd}{\yaqi{TBD}}
\newcommand{\yaqiadd}[1]{{\color{\yaqicolor}{#1}}}

\newcommand{\yunzhenadd}[1]{{\color{violet}{#1}}}

\usepackage{upgreek}
\usepackage{dsfont}

\newcommand{\defn}{\ensuremath{:\,=}}
\newcommand{\nfed}{\ensuremath{=\,:}}
\newcommand{\proj}{\ensuremath{\Pi}}
\newcommand{\trace}{\ensuremath{{\rm Tr}}}

\newcommand{\smallo}{\ensuremath{o}}
\newcommand{\smallop}{\ensuremath{\smallo_p}}
\newcommand{\bigO}{\ensuremath{\mathcal{O}}}
\newcommand{\bigOtil}{\ensuremath{\widetilde{\bigO}}}

\newcommand{\convergep}{\ensuremath{\stackrel{p}{\rightarrow}}}
\newcommand{\converged}{\ensuremath{\stackrel{d}{\rightarrow}}}

\newcommand{\Constant}{\ensuremath{C}}
\newcommand{\const}{\ensuremath{c}}

\newcommand{\Exp}{\ensuremath{\mathds{E}}}
\newcommand{\Prob}{\ensuremath{\mathds{P}}}
\newcommand{\Var}{\ensuremath{{\rm Var}}}
\newcommand{\Real}{\ensuremath{\mathds{R}}}
\newcommand{\Int}{\ensuremath{\mathds{Z}}}
\newcommand{\Intpos}{\ensuremath{\Int_+}}
\newcommand{\indicator}{\ensuremath{\mathds{1}}}
\newcommand{\Gauss}{\ensuremath{\mathcal{N}}}

\newcommand{\Cov}{\ensuremath{{\rm Cov}}}
\newcommand{\CovOp}{\ensuremath{\boldsymbol{\Sigma}}}
\newcommand{\CovOmega}{\ensuremath{\boldsymbol{\Omega}}}
\newcommand{\CovOpstar}{\ensuremath{\CovOp_{\star}}}
\newcommand{\CovOptil}{\ensuremath{\widetilde{\CovOmega}}}
\newcommand{\Dim}{\ensuremath{d}}
\newcommand{\chisquare}{\ensuremath{\chi^2}}
\newcommand{\IdMt}{\ensuremath{\boldsymbol{I}}}

\newcommand{\diff}{\ensuremath{{d }}}
\newcommand{\Const}{\ensuremath{C}}
\newcommand{\Term}{\ensuremath{T}}

\newcommand{\veczero}{\ensuremath{\boldsymbol{0}}}
\newcommand{\vecone}{\ensuremath{\boldsymbol{1}}}

% Kullback-Leibler
% \newcommand{\kull}[2]{\ensuremath{D_{\text{KL}}(#1\; \| \; #2)}}
\DeclarePairedDelimiterX{\kulldiv}[2]{(}{)}{#1\;\delimsize\|\;#2}
\makeatletter
\newcommand{\@kullstar}[2]{D_{\text{KL}}\kulldiv*{#1}{#2}}
\newcommand{\@kullnostar}[3][]{D_{\text{KL}}\kulldiv[#1]{#2}{#3}}
\newcommand{\kull}{\@ifstar\@kullstar\@kullnostar}
\makeatother

% Absolute value
\DeclarePairedDelimiterX{\defabs}[1]{|}{|}{#1}
\makeatletter
\newcommand{\@absstar}[1]{\defabs*{#1}}
\newcommand{\@absnostar}[2][]{\defabs[#1]{#2}}
\newcommand{\abs}{\@ifstar\@absstar\@absnostar}
\makeatother


\DeclarePairedDelimiterX{\norm}[1]{\|}{\|}{#1}
% L-infty norm
\makeatletter
\newcommand{\@supnormstar}[1]{\norm*{#1}_{\infty}}
\newcommand{\@supnormnostar}[2][]{\norm[#1]{#2}_{\infty}}
\newcommand{\supnorm}{\@ifstar\@supnormstar\@supnormnostar}
\makeatother



\newcommand{\prompt}{\ensuremath{x}}
\newcommand{\PromptSp}{\ensuremath{\mathcal{X}}}
\newcommand{\promptnew}{\ensuremath{\prompt'}}
\newcommand{\context}{\ensuremath{\prompt}}
\newcommand{\response}{\ensuremath{\vec{\boldsymbol{y}}\!\,}}
\newcommand{\responsenew}{\ensuremath{\response'}}
\newcommand{\responsenewnew}{\ensuremath{\response''}}
\newcommand{\token}{\ensuremath{y}}
\newcommand{\tokent}[1]{\ensuremath{\token_{#1}}}
\newcommand{\tokenttot}[2]{\ensuremath{\token_{#1:#2}}}
\newcommand{\tokenone}{\ensuremath{y^a}}
\newcommand{\tokentwo}{\ensuremath{y^b}}
\newcommand{\tokenonet}[1]{\ensuremath{y_{#1}^a}}
\newcommand{\tokentwot}[1]{\ensuremath{y_{#1}^b}}
\newcommand{\numtok}{\ensuremath{T}}
\newcommand{\numtokone}{\ensuremath{\numtok^a}}
\newcommand{\numtoktwo}{\ensuremath{\numtok^b}}
\newcommand{\TokenSp}{\ensuremath{\mathcal{V}}}
\newcommand{\ResponseSp}{\ensuremath{\mathcal{Y}}}
\newcommand{\responsewin}{\ensuremath{\response^w}}
\newcommand{\responselose}{\ensuremath{\response^{\ell}}}
\newcommand{\responseone}{\ensuremath{\response^a}}
\newcommand{\responsetwo}{\ensuremath{\response^b}}
\newcommand{\arm}{\ensuremath{\response}}
\newcommand{\promptdistr}{\ensuremath{\uprho}}
\newcommand{\promptdistrphi}{\ensuremath{\promptdistr_{\paraphi}}}
\newcommand{\promptdistrtheta}{\ensuremath{\promptdistr_{\paratheta}}}
\newcommand{\Probtheta}{\ensuremath{\Prob_{\paratheta}}}

\newcommand{\prompti}[1]{\ensuremath{\prompt_{#1}}}
\newcommand{\responsei}[1]{\ensuremath{\response_{#1}}}
\newcommand{\responsewini}[1]{\ensuremath{\responsewin_{#1}}}
\newcommand{\responselosei}[1]{\ensuremath{\responselose_{#1}}}
\newcommand{\responseonei}[1]{\ensuremath{\responseone_{#1}}}
\newcommand{\responsetwoi}[1]{\ensuremath{\responsetwo_{#1}}}

\newcommand{\reward}{\ensuremath{r}}
\newcommand{\rewardstar}{\ensuremath{\reward^{\star}}}
\newcommand{\rewardphi}{\ensuremath{\reward_{\paraphi}}}
\newcommand{\rewardtheta}{\ensuremath{\reward_{\paratheta}}}
\newcommand{\RewardSp}{\ensuremath{\mathcal{R}}}
\newcommand{\Loss}{\ensuremath{\mathcal{L}}}
\newcommand{\Losshat}{\ensuremath{\widehat{\Loss}}}
\newcommand{\parabeta}{\ensuremath{\beta}}

\newcommand{\policy}{\ensuremath{\uppi}}
\newcommand{\PolicySp}{\ensuremath{\Pi}}
\newcommand{\policyref}{\ensuremath{\policy_{{\rm ref}}}}
\newcommand{\policystar}{\ensuremath{\policy^{\star}}}
\newcommand{\policyhat}{\ensuremath{\widehat{\policy}}}

\newcommand{\Data}{\ensuremath{\mathcal{D}}}
\newcommand{\numobs}{\ensuremath{n}}
\newcommand{\paraphi}{\ensuremath{\phi}}
\newcommand{\paraphihat}{\ensuremath{\widehat{\paraphi}}}
\newcommand{\paraphistar}{\ensuremath{\paraphi^{\star}}}
\newcommand{\paraphit}[1]{\ensuremath{\paraphi_{#1}}}
\newcommand{\paratheta}{\ensuremath{\theta}}
\newcommand{\parathetat}[1]{\ensuremath{\paratheta_{#1}}}
\newcommand{\parathetahat}{\ensuremath{\widehat{\paratheta}}}
\newcommand{\parathetastar}{\ensuremath{\paratheta^{\star}}}
\newcommand{\policytheta}{\ensuremath{\policy_{\paratheta}}}
\newcommand{\policythetapos}{\ensuremath{\policy_{\paratheta}^+}}
\newcommand{\policythetaneg}{\ensuremath{\policy_{\paratheta}^-}}
\newcommand{\policyphi}{\ensuremath{\policy_{\paraphi}}}
\newcommand{\responsedistr}{\ensuremath{\upmu}}
\newcommand{\responsedistravg}{\ensuremath{\overline{\responsedistr}}}
\newcommand{\responseonedistr}{\ensuremath{\responsedistr^a}}
\newcommand{\responsetwodistr}{\ensuremath{\responsedistr^b}}
\newcommand{\sigmoid}{\ensuremath{\sigma}}

\newcommand{\Partition}{\ensuremath{Z}}
\newcommand{\Partitionphi}{\ensuremath{\Partition_{\paraphi}}}
\newcommand{\Partitionphipos}{\ensuremath{\Partition_{\paraphi}^+}}
\newcommand{\Partitionphineg}{\ensuremath{\Partition_{\paraphi}^-}}
\newcommand{\Partitionphibar}{\ensuremath{\overline{\Partition}}_{\paraphi}}

\newcommand{\Partitiontheta}{\ensuremath{\Partition_{\paratheta}}}
\newcommand{\Partitionthetapos}{\ensuremath{\Partition_{\paratheta}^+}}
\newcommand{\Partitionthetaneg}{\ensuremath{\Partition_{\paratheta}^-}}
\newcommand{\Partitionthetabar}{\ensuremath{\overline{\Partition}}_{\paratheta}}

\newcommand{\stepsize}{\ensuremath{\eta}}
\newcommand{\stepsizet}[1]{\ensuremath{\stepsize_{#1}}}

\newcommand{\sampleprob}{\ensuremath{p_0}}

\newcommand{\scalarvalue}{\ensuremath{J}}

\newcommand{\Radius}{\ensuremath{R}}
\newcommand{\RadiusGrad}{\ensuremath{G}}

\newcommand{\policyt}[1]{\ensuremath{\policy_{#1}}}


\newcommand{\GradLip}{\ensuremath{L}}

\newcommand{\Grad}{\ensuremath{\boldsymbol{g}}}
\newcommand{\Gradstar}{\ensuremath{\Grad^{\star}\!\,}}

\newcommand{\weight}{\ensuremath{w}}

\newcommand{\head}{\ensuremath{\boldsymbol{h}}}
\newcommand{\headtheta}{\ensuremath{\head_{\paratheta}}}
\newcommand{\headref}{\ensuremath{\head_{{\rm ref}}}}

\newcommand{\softmax}{\ensuremath{{\sf softmax}}}


\newcommand{\gradtheta}{\ensuremath{\nabla_{\paratheta} \, }}
\newcommand{\hesstheta}{\ensuremath{\nabla_{\paratheta}^2 \, }}

\newcommand{\divsigmoid}{\ensuremath{\sigmoid'}}

\newcommand{\vecg}{\ensuremath{\boldsymbol{u}}}
\newcommand{\vecgi}[1]{\ensuremath{\vecg_{#1}}}

\newcommand{\vecl}{\ensuremath{\boldsymbol{\ell}}}
\newcommand{\vecli}[1]{\ensuremath{\vecl_{#1}}}

\newcommand{\vecgstar}{\ensuremath{\vecg^{\star}}}
\newcommand{\vecgstari}[1]{\ensuremath{\vecgstar_{#1}}}



\newcommand{\grad}{\ensuremath{\boldsymbol{g}}}
\newcommand{\gradi}[1]{\ensuremath{\grad_{#1}}}
\newcommand{\gradstar}{\ensuremath{\grad^{\star}}}
\newcommand{\gradstari}[1]{\ensuremath{\grad_{#1}^{\star}}}

\newcommand{\GammaMt}{\ensuremath{\boldsymbol{\Gamma}}}

\newcommand{\U}{\ensuremath{U}}
\newcommand{\Un}{\ensuremath{\U_{\numobs}}}
\newcommand{\V}{\ensuremath{V}}
\newcommand{\Vn}{\ensuremath{\V_{\numobs}}}

\newcommand{\HessMt}{\ensuremath{\boldsymbol{H}}}
\newcommand{\vecz}{\ensuremath{\boldsymbol{z}}}
\newcommand{\bX}{\ensuremath{\boldsymbol{X}}}
\newcommand{\MMt}{\ensuremath{M_{\chisquare_\Dim}}}

\newcommand{\llike}{\ensuremath{\ell}}
\newcommand{\lliketheta}{\ensuremath{\llike_{\paratheta}}}
\newcommand{\llikethetastar}{\ensuremath{\llike_{\parathetastar}}}

\newcommand{\Liphess}{\ensuremath{L}}

\newcommand{\policyphipos}{\ensuremath{\policy_{\paraphi}^+}}
\newcommand{\policyphineg}{\ensuremath{\policy_{\paraphi}^-}}
\newcommand{\headphi}{\ensuremath{\head_{\paraphi}}}