
\newcommand{\CLASSINPUTtoptextmargin}{0.751in}
\newcommand{\CLASSINPUTbottomtextmargin}{1.001in}
\documentclass[conference%, draftcls
]{IEEEtran}
%\usepackage{showframe}
%\usepackage{layout}
%\usepackage[top=0.75in,left=0.67in,right=0.67in]{geometry}
\IEEEoverridecommandlockouts    %delete ?
\usepackage{verbatim} % for comments
\usepackage{cite}
\usepackage{nicematrix}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{bm}
\usepackage{amsmath,amssymb,amsfonts,flushend}
%%%
\makeatletter
\let\MYcaption\@makecaption
\makeatother
\usepackage[font=footnotesize]{subcaption}
\makeatletter
\let\@makecaption\MYcaption
\makeatother
%%%%
\captionsetup[subfigure]{skip=2pt}
%%%%
\usepackage{algorithmic}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{circuitikz}
\usepackage{siunitx}
\usetikzlibrary{shapes.geometric, arrows,chains, positioning}
\usetikzlibrary{arrows.meta} 
\usetikzlibrary { decorations.pathmorphing, decorations.pathreplacing, decorations.shapes, } 
\usepackage{pbox}
\newcommand{\ctikzlabel}[2]{\pbox{\textwidth}{#1\\#2}} % multiple-lines labels
\usepackage{relsize}
\tikzset{
    pin/.style = {font = \relsize{-2}} % pin font size
}
\ctikzset{
    bipoles/length = 4em, % bipole size
    font = \relsize{-1}, % default font size
}
\usepackage{textcomp}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{mathtools}
\usepackage{schemabloc}
\usetikzlibrary{circuits}
%\usepackage{physics}
\usetikzlibrary{arrows}

\usepackage{pgfplotstable}
%\pgfplotsset{compat=1.14,grid style={dashed,gray}}
\usepackage{multirow}
%gia norm
\usepackage{mathtools}
\usepackage{commath}
\let\oldnorm\norm   % <-- Store original \norm as \oldnorm
\let\norm\undefined % <-- "Undefine" \norm
\DeclarePairedDelimiter\norm{\lVert}{\rVert}

\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\graphicspath{ {./confimages/} }
%matlab2tikz
 \usepackage{pgfplots}
  \pgfplotsset{compat=newest}
  %% the following commands are needed for some matlab2tikz features
  \usetikzlibrary{plotmarks}
  \usetikzlibrary{arrows.meta}
  \usepgfplotslibrary{patchplots}
  \usepackage{grffile}
  \usepackage{amsmath}
  
  % package for Proofs
\usepackage{amsthm}

% gia algorithmo
\usepackage{fancyhdr,graphicx,amsmath,amssymb}
\usepackage[ruled,vlined]{algorithm2e}


%\include{pythonlisting}
\usepackage{times}
%gia pinaka
\usepackage{hhline}

%space saver
%\usepackage{titlesec}
%\titlespacing\section{0pt}{3pt plus 2pt minus 2pt}{3pt plus 1pt minus 2pt}
%\titlespacing\subsection{0pt}{2pt plus 1pt minus 1pt}{2pt plus 1pt minus 1pt} %minus 2pt
\usepackage{hhline}
\usepackage{booktabs} % for textbook-quality tables
\usepackage{circuitikz}
\usepackage{siunitx}

\newtheorem{Proposition}{Proposition}

\usepackage[hyphens]{url}
\usepackage{balance}
\usepackage[commandnameprefix=always]{changes}
\setlength{\marginparwidth}{1.7cm}
\setlength{\marginparsep}{0cm}
\definechangesauthor[color=blue,name=Vassilis]{VP}
%\input{mycompress}
%%%title for proof
\makeatletter
\renewenvironment{proof}[1][\relax]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item[\hskip\labelsep\itshape
    \ifx#1\relax \proofname\else\proofname{} of #1\fi\@addpunct{.}]\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother


\begin{document}

%magic 
%\setlength{\abovedisplayskip}{0.2pt}
%\setlength{\belowdisplayskip}{0.2pt}
%\setlength{\abovecaptionskip}{1pt}
%\setlength{\belowcaptionskip}{1pt}
%\setlength{\dbltextfloatsep}{0.1pt}
%\setlength{\textfloatsep}{0.1pt}
%\setlength{\dblfloatsep}{0.1pt}
%\setlength{\floatsep}{0.1pt}
%
\allowdisplaybreaks % page breaks for equations

% Angle of Arrival Estimation
% Evaluating Beam Sweeping for AoA Estimation
%Evaluation of Beam Sweeping for AoA Estimation
\title{Evaluating Beam Sweeping for AoA Estimation with an RIS Prototype: Indoor/Outdoor Field Trials\vspace{-0.3cm}}


\author{\IEEEauthorblockN{ 
Dimitris Vordonis\IEEEauthorrefmark{2}, Dimitris Kompostiotis\IEEEauthorrefmark{2}, Vassilis Paliouras\IEEEauthorrefmark{2}, George C. Alexandropoulos\IEEEauthorrefmark{5}, and Florin Grec\IEEEauthorrefmark{4}}
\IEEEauthorblockA{\IEEEauthorrefmark{2}Electrical and Computer Engineering Department, University of Patras, Greece,\\
 \IEEEauthorrefmark{5}Department of Informatics and Telecommunications, National and Kapodistrian University of Athens, Greece,\\
\IEEEauthorrefmark{4}European Space Agency (ESA), Noordwijk, Netherlands\\
e-mails:\{d.vordonis, d.kompostiotis\}@ac.upatras.gr, paliuras@upatras.gr, alexandg@di.uoa.gr, Florin-Catalin.Grec@esa.int}\vspace{-1.07cm}}




% The paper headers
\markboth{NOTES}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}


\maketitle

%\layout

\begin{abstract}
Reconfigurable Intelligent Surfaces (RISs) have emerged as a promising technology to enhance wireless communication systems by enabling dynamic control over the propagation environment. However, practical experiments are crucial towards the validation of the theoretical potential of RISs while establishing their real-world applicability, especially since most studies rely on simplified models and lack comprehensive field trials. In this paper, we present an efficient method for configuring a 1-bit RIS prototype at sub-6 GHz, resulting in a codebook oriented for beam sweeping; an essential protocol for initial access and Angle of Arrival (AoA) estimation. The measured radiation patterns of the RIS validate the theoretical model, demonstrating consistency between the experimental results and the predicted beamforming behavior. Furthermore, we experimentally prove that RIS can alter channel properties and by harnessing the diversity it provides, we evaluate beam sweeping as an AoA estimation technique. Finally, we investigate the frequency selectivity of the RIS and propose an approach to address indoor challenges by leveraging the geometry of environment.
\end{abstract}

\begin{IEEEkeywords}
Reconfigurable intelligent surfaces, MIMO, beam sweeping, radiation pattern, prototype, field trials.%, sub-6 GHz band.
\end{IEEEkeywords}



\section{Introduction}
Reconfigurable Intelligent Surfaces (RISs) are emerging as a transformative technology for 6G~\cite{huang2019reconfigurable,bjornson2022reconfigurable,pan2022overview}, offering the ability to dynamically control wireless propagation environments with minimal energy consumption. In the context of wireless communication systems, RISs hold great promise for positioning applications~\cite{bjornson2022reconfigurable,pan2022overview,wymeersch2020radio,wymeersch2022radio,keykhosravi2023leveraging,alexandropoulos2023ris}, enabling precise user localization even in challenging scenarios such as urban areas with blockages or dense multipath. By introducing additional degrees of freedom through controllable reflections, RISs can improve the Signal-to-Noise Ratio (SNR), which is critical for positioning algorithms, while leveraging their large aperture size and acting as extra reference points to enhance localization accuracy. Furthermore, RISs can exploit and control multipath propagation, turning it into a valuable resource by providing diverse and rich signal measurements to aid positioning systems.

%A challenge for 5G-NR positioning techniques is their limited accuracy and reliability in multipath and interference-heavy environments~\cite{bjornson2022reconfigurable,pan2022overview,wymeersch2020radio,wymeersch2022radio,RIS_loc,kompostiotis2024evaluation}. RISs can enhance the performance of existing methods such as super-resolution algorithms~\cite{kompostiotis2024evaluation}, and stand as a complementary technology to  Global Navigation Satellite Systems (GNSS), which is restricted to outdoor use, and  to Ultra-WideBand (UWB), which is limited to short-range applications; thus bridging critical gaps in localization services.
Building on the ability of RIS to improve wireless positioning, efficient beamforming strategies are essential to fully exploit its capabilities. One such practical and widely adopted protocol in wireless communications is beam sweeping~\cite{che2023efficient,10048686,ouyang2023computer}, which plays a critical role in both initial access and Angle of Arrival (AoA) estimation.
%In this context, a practical and efficient protocol that is commonly used in wireless communications, for both initial access and Angle of Arrival (AoA) estimation, is beam sweeping~\cite{che2023efficient,10048686,ouyang2023computer}. 
In RIS-aided systems, an RIS node enables beam sweeping by steering the incoming signal and reflecting it toward the desired angles, systematically scanning the served area with narrow beams. To reduce resource usage and pilot signaling, variations such as hierarchical codebooks~\cite{albanese2021papir,RIS_hierarchical}, multi-beam patterns~\cite{wang2023hierarchical}, or broad beams~\cite{ramezani2023dual,ramezani2024broad,10256051,lin2024design} can be used, offering efficient coverage and supporting user mobility.

% from theory to practice: challenges from real ris (freq sel, discrete, hw imperfections) + indoor challenges in sub6ghz (multipath, nlos components)- not easy to have a pattern with one peak only with 1bit. models that capture ris behavior no validated
%\textcolor{blue}{Maybe 2nd paragraph:}

% notes:
 %As the scanning angle increases, the measured gain decreases and the main
 %beam broadens(2bit ris)~\cite{dai2020reconfigurable} also, The half-power beamwidths are 9.1 and 8.8 , respectively, and the measured sidelobe levels are 16.7 dB and 16.4 dB
 %bj -> 8 db side lobe (1bit) sto greedy
 
Despite its great potential, the RIS technology necessitates rigorous experimental validation to substantiate its theoretical benefits. The imperfections of RIS prototypes significantly complicate the design of effective codebook-based beamforming strategies. Issues such as strong side lobes in radiation patterns of 1-bit RIS designs~\cite{10498085,sayanskiy20222d}, phase-dependent amplitude response~\cite{10095408,kompostiotis2023secrecy}, frequency selectivity~\cite{rains2023fully}, dependence on the angle of incoming signals~\cite{9551980,weinberger2024validating}, and the practical difficulty of achieving precise binary phase shifts~\cite{9551980,rains2023fully}, meeting the $180^\circ$ difference, are critical limitations. Furthermore, mutual coupling between adjacent RIS elements~\cite{zheng2024mutual,9837634}, limited scanning range, and the impracticality of achieving narrow beams at certain angles with 1-bit resolution~\cite{dai2020reconfigurable}, further degrade performance. These hardware-related imperfections, combined with environmental challenges such as multipath propagation~\cite{kompostiotis2024evaluation,nikonowicz2024indoor}, ground-bounce effects~\cite{trichopoulos2022design}, and interference, make the task of experimental validation even more difficult. Overcoming these challenges is crucial to ensure the practical viability of RIS-aided systems in real-world deployments.



Recent measurement-based studies have focused mainly on evaluating SNR improvements and understanding the radiation patterns of RIS~\cite{9551980,amri2021reconfigurable,dai2020reconfigurable,trichopoulos2022design}, particularly highlighting the presence of strong side lobes in low-resolution phase configurations. Some works aim to derive theoretical path loss models~\cite{tang2022path,9713744}, which have been validated through controlled experiments in anechoic chambers. However, extending these models to real outdoor scenarios~\cite{lan2023measurement} has revealed discrepancies caused by hardware imperfections and challenges inherent to real-world deployments. In this paper, we validate a subcase~\cite{ramezani2023dual,ramezani2024broad,10256051} of the model~\cite{9713744} that eliminates the need for approximations of transmitter (Tx) or receiver (Rx) antenna radiation patterns, simplifying real-world deployment considerations. Beyond system-level performance, RISs have gained significant attention for positioning applications. Ouyang et al.~\cite{ouyang2023computer} combine beam sweeping with visual information from a camera attached to the RIS to improve positioning adaptively in dynamic environments. Rahal et al.~\cite{rahal2023ris} integrate beam sweeping in combination with the Space-Alternating Generalized Expectation-maximization (SAGE) algorithm to mitigate side lobe challenges and multipath interference, refining position estimates in complex indoor settings. In contrast, our approach leverages beam sweeping, not only with offline codebooks, but also introduces a real-time configuration methodology that exploits the indoor environment's geometry and leverages non line-of-sight (NLoS) components. In addition, we propose an alternative beam sweeping strategy that minimizes the received signal power; an extra solution that complements the traditional objective of maximizing signal strength. %Furthermore, 
Spatial Time Coding Modulation (STCM) has emerged as another method for AoA estimation~\cite{gholami2024wireless,dos2024assessing}, where RIS elements are time-modulated to generate harmonics that encode spatial information. However, STCM faces significant practical challenges~\cite{gholami2024wireless,dos2024assessing}, including strict timing constraints and phase synchronization issues, which are exacerbated by RIS configuration mechanisms, such as script-based control methods that introduce timing discrepancies, making it difficult to achieve the precise modulation intervals required for clean harmonics and reducing the accuracy of AoA estimation. In contrast, beam sweeping offers a simpler and more practical solution.



%main papers: ~\cite{tang2022path,9713744} path loss model anechoic
%9713744 for fr1
%outdoor:sub6ghz~\cite{lan2023measurement} - trying to validate theoretic path loss model 

%SNR and basic test: %ris prototypes~\cite{9551980} - greedy
%SNR ~\cite{amri2021reconfigurable} - 1bit 
%2bit~\cite{dai2020reconfigurable} - insights for rad pattern
%SNR outdoor,  prototype~\cite{trichopoulos2022design}
%max +20, min -60~\cite{tewes2023comprehensive}

%positioning:
%beam sw + camera for dynamic loc~\cite{ouyang2023computer}
%~\cite{rahal2023ris}: beam sweeping and SAGE, side lobes lead to large errors, mmwave, 1bit RIS, indoor. does not exploit indoor real time beamforming. beam sw 5deg step. best or 3 max or sage.
%STCM~\cite{gholami2024realization,gholami2024wireless,dos2024assessing}
%In this paper,


The remainder of the paper is organized as follows: Section~\ref{s:theoretical_model} introduces the theoretical model for the radiation pattern of RIS, which is validated through real outdoor measurements. Section~\ref{s:phase_optimization} presents one phase optimization method to configure the RIS prototype during the experiments. Section~\ref{s:measurement_setup} describes the measurement setup, including both outdoor and indoor environments, as well as the key system components. Then in Section~\ref{s:experimental_results}, we make several experiments
 to verify the system performance. This section further introduces the proposed beam sweeping methodology and evaluates its performance in both outdoor and indoor environments. Finally, Section~\ref{s:conclusion} concludes the paper.%, while Section~\ref{s:future_work} outlines future research directions.


\section{Radiation Pattern of RIS: Theoretical model}\label{s:theoretical_model}
\vspace{0.05cm}
%This section presents the baseband model of the RIS-aided system and the theoretical model for the RIS radiation pattern. 
We consider a single-antenna Tx, an RIS with $N {=} N_x {\times} N_y$ elements, where $N_x$ and $N_y$ denote the number of rows and columns, respectively, and a single-antenna Rx. The received signal, over a single subcarrier, can be modeled as in~\cite{rabault2024tacit}:
\begin{equation}
    y =  (\bm{h}_{r}^\mathsf{H}\bm{\Theta}\bm{h}_{g} + h_{d})s + z, 
    \label{e:rx_signal_A}
\end{equation}
where \( \bm{h}_{g},\bm{h}_{r} {\in} \mathbb{C}^{N \times 1} \) %and \( \bm{h}_{r} {\in} \mathbb{C}^{N \times 1} \) 
are the channels from the Tx to the RIS and from the RIS to the Rx, respectively; \( h_{d} {\in} \mathbb{C} \) is the direct link channel between the Tx and Rx; and \( s \) is the transmitted symbol with zero-mean and unit variance \( \mathbb{E}(|s|^2) {=} 1 \). The RIS is configured with a diagonal phase-shift matrix
\begin{comment}
\begin{equation}
    \bm{\Theta} = \operatorname{diag}(\bm{\omega_\theta}^\mathsf{H}), \quad \bm{\omega_\theta} = [e^{\text{j}\theta_{1}}, \dots, e^{\text{j}\theta_{N}}]^\mathsf{T},
\end{equation}
\end{comment}
$ \bm{\Theta} = \operatorname{diag}(\bm{\omega_\theta}^\mathsf{H})$, where $\bm{\omega_\theta} = [e^{\text{j}\theta_{1}}, \dots, e^{\text{j}\theta_{N}}]^\mathsf{T}$ and \( \theta_n \) represents the phase shift applied by the \(n\)-th RIS element. As \eqref{e:rx_signal_A} shows, \( \bm{\Theta} \) directly influences the received signal, allowing the RIS to manipulate the end-to-end channel. 

Regarding the theoretical model of the RIS radiation pattern~\cite{ramezani2023dual,ramezani2024broad,10256051}, it represents a specific subcase of the general model introduced in~\cite{9713744}, eliminating the need for approximations of the Tx or Rx antenna radiation patterns. This simplification is particularly valuable for facilitating practical deployment in real-world scenarios. The overall radiation pattern \( G(\phi,\theta) \) is expressed as~\cite{ramezani2024broad,10256051},
\begin{equation}
    G(\phi,\theta) = A(\phi,\theta) G_{R0}(\tilde{\phi}, \tilde{\theta}) G_{R0}(\phi,\theta),
    \label{eq:radiation_pattern}
\end{equation}
where \( (\tilde{\phi}, \tilde{\theta}) \) denote the AoA at the RIS, \( (\phi, \theta) \) are the angles of departure (AoD) from the RIS, and \( G_{R0} \) represents the radiation pattern of a single RIS element, modeled using the 3GPP antenna gain model~\cite{ramezani2024broad,10256051}. The power-domain array factor is given by,
\begin{equation}
    A(\phi, \theta) = \big| \bm{\omega}_{\bm{\theta}}^T \big(\mathbf{a}_{\text{RIS}}(\tilde{\phi},\tilde{\theta}) \odot \mathbf{a}^{*}_{\text{RIS}}(\phi, \theta)\big) \big|^2,
    \label{eq:power_factor}
\end{equation}
where \( \odot \) denotes the Hadamard product, and \( \mathbf{a}_{\text{RIS}}(\phi, \theta) \) is the array response vector for the RIS. For an RIS element located at \( \mathbf{u}_i \), \( \mathbf{a}_{\text{RIS}}(\phi, \theta) \) is defined as~\cite{ramezani2024broad,10256051}:
\begin{equation}
    \mathbf{a}_{\text{RIS}}(\phi, \theta) = \Big[e^{-\jmath\mathbf{k}(\phi, \theta)^\mathsf{T}\mathbf{u}_1}, \dots, e^{-\jmath\mathbf{k}(\phi, \theta)^\mathsf{T}\mathbf{u}_N}\Big]^\mathsf{T},
    \label{e:array_response_vec}
\end{equation}
where \( \mathbf{u}_i \) is the position of the \( i\)-th RIS element, and \( \mathbf{k}(\phi, \theta) \) represents the wave vector of the transmitted signal:
\begin{equation}
    \mathbf{k}(\phi, \theta) = \frac{2\pi}{\lambda} \Big[\cos(\theta)\cos(\phi), \cos(\theta)\sin(\phi), \sin(\theta)\Big]^\mathsf{T},
    \label{e:wave_vector}
\end{equation}
with \( \lambda \) being the wavelength.


\section{Practical Phase Optimization Method}\label{s:phase_optimization} 
The $\text{A}(\varphi,\theta)$ is maximized for
\begin{equation}
    \bm{\omega}_{\bm{\theta}}^{T} = (\mathbf{a}_{\text{RIS}}(\varphi_{\text{AoA}},\theta_{\text{AoA}}) \odot \mathbf{a}^{*}_{\text{RIS}}(\varphi,\theta))^{H}.
    \label{opt_config}
\end{equation}
%The result in~\eqref{opt_config} corresponds 
in %to 
the continuous case, where each RIS element achieves infinite angular resolution. However, practical RIS implementations often restrict each element to discrete phase-shift values, such as \( \theta_i {\in} \{-\frac{\pi}{2}, \frac{\pi}{2}\}, \forall i \). Quantizing the optimal continuous solution (1-bit resolution) does not guarantee that the RIS will steer the beam toward the desired AoD and results in strong sidelobes~\cite{10498085,sayanskiy20222d}, which can significantly degrade performance. Therefore, this section presents a practical RIS phase optimization method based on column-row scanning. Grouping elements, such as by columns or rows, is a well-established approach to reduce complexity, leveraging the fact that adjacent elements typically exhibit similar channel coefficients~\cite{bjornson2021optimizing}. A similar idea to column/row changes is discussed in~\cite{9551980}. Iterative algorithms that optimize each element individually often require more iterations and, in long-range scenarios without low-noise amplifiers (LNAs), small differences in received signal power may be challenging to detect~\cite{weinberger2024validating,tewes2023comprehensive}. The applied method starts with a homogeneous surface, initializing all elements of the RIS to the same configuration. The optimization proceeds horizontally by modifying the phase-shift states of individual columns, measuring the received power at the Rx. If an improvement is observed, the change is retained; otherwise, the configuration is reverted. Next, a similar procedure is applied vertically across rows. This process runs for one complete iteration, providing a low-complexity yet effective configuration strategy. The complete procedure is detailed in Algorithm~\ref{algo:ris_config}.
\begin{algorithm}[b]
\footnotesize
\parbox[t]{0.7\textwidth}{\caption{\strut\small\textbf{RIS Configuration via Column-Row Scanning\vskip-5ex}} \label{algo:ris_config}}
\tcp{\( \bm{\omega_\theta} \) is mapped to the dual-polarized RIS's configuration matrix \( \bm{\Phi} \) of size \( N_x \times 2N_y \).}
\KwIn{Initial RIS configuration matrix \( \bm{\Phi} \) with all elements set to 0.}
\KwOut{Optimized RIS configuration \( \bm{\Phi} \).}
\nl Measure the initial received power \( P_{\text{max}} \) with \( \bm{\Phi} \) set to all 0\;
\nl 
    \tcc{\textbf{Step 1: Column-Wise Scanning}}
    \nl \For{\texttt{\( col = 1:2:2N_y \)}}{
        \nl Invert the states of columns \( col, col+1 \) in \( \bm{\Phi} \)\;
        \nl Measure the received power \( P_r \) for the current configuration\;
        \nl \If{\( P_r > P_{\text{max}} \)}{
            \nl \( P_{\text{max}} \gets P_r \) \tcp*{Keep new configuration.}
        }\Else{
            \nl Revert columns \( col, col+1 \) to its previous state\;
        }
    }
    \tcc{\textbf{Step 2: Row-Wise Scanning}}
    \nl \For{\texttt{\( row = 1, \dots, N_x \)}}{
        \nl Invert the states of row \( row \) in \( \bm{\Phi} \)\;
        \nl Measure the received power \( P_r \) for the current configuration\;
        \nl \If{\( P_r > P_{\text{max}} \)}{
            \nl \( P_{\text{max}} \gets P_r \) \tcp*{Keep new configuration.}
        }\Else{
            \nl Revert row \( row \) to its previous state\;
        }
    }
\nl \Return{\( \bm{\Phi} \)} \tcp*[l]{Return optimized RIS configuration.}
\end{algorithm}




\section{Indoor and Outdoor Measurement Setups}\label{s:measurement_setup} 
The measurement setups involve both outdoor and indoor experiments (Figs.~\ref{fig:2a} and~\ref{fig:2c}). The RIS, used in both setups, consists of four tiles, each containing a $16{\times}16$ array of unit cells~\cite{rains2023fully}. Each unit cell is equipped with two varactor diodes, each independently driven by two programmable bias voltage levels: $V_1 {=} 11$ V and $V_2 {=} 7.5$ V. The RIS operates around 3.5 GHz and supports dual-polarization (horizontal and vertical). For both transmission and reception, we used flat-panel directional antennas, specifically the PAT3519XP model from ITELITE. These antennas are dual-polarized and have a beamwidth of around $20^\circ$, which reduces the impact of unwanted reflections and interference. The antennas have a working frequency range of 3.5--3.8 GHz. The Vector Network Analyzer (VNA) used in this study is the Copper Mountain S5243, a 2-port device capable of measuring frequencies up to 44 GHz. The VNA was used to measure the S parameters, providing insight into the transmission characteristics between the Tx and the Rx. For accurate measurements, a SOLT (Short-Open-Load-Through) calibration kit T4311 was employed to calibrate the VNA, ensuring precise results.

The outdoor measurement setup (Fig.~\ref{fig:2a}) was conducted in an environment with minimal multipath interference. The Tx and Rx were positioned at a distance of 8.5 meters from the RIS, while all components were placed at a height of 1.3 meters. The measurements were taken with a step size of $5^\circ$ in the azimuth domain. In contrast, the indoor measurement setup (Fig.~\ref{fig:2c}) was conducted in a more challenging environment with strong multipath effects. The nodes were placed at the same height of 1.3 meters, but the distance between the Tx and the RIS was decreased to 5.5 meters. The multipath environment in the indoor setup introduces additional complexity, as signals reflected from walls, floors, and other objects can distort the measurements. The measurement step was $15^\circ$. Furthermore, for communication between the RIS controller (Raspberry Pi) and the VNA, a script-based system was developed. The RIS configuration and VNA were controlled via MATLAB scripts from a laptop, enabling automated measurement and data collection. This setup facilitated efficient testing and ensured that the RIS configuration could be adjusted in real-time during the measurement process, allowing for dynamic investigation.% under different conditions.


  

\begin{figure}[t]
\centering
\begin{minipage}{0.47\textwidth}
  \vspace*{2mm}
  \centering
  \includegraphics[width=0.9\textwidth]{outdoor_setuppp.jpg}
  \subcaption{Outdoor setup: The Tx-RIS distance is 8.5~m, and the RIS-Rx distance is 8.5~m for all Rx positions, with all nodes positioned at a height of 1.3~m. Rx positions range from $0^\circ$ to $60^\circ$, with a step size of $5^\circ$, %Rx positions measured in $5^\circ$ increments from $0^\circ$ to $60^\circ$, 
  and the Tx is fixed at $-15^\circ$. RIS configurations are optimized to steer the beam toward each Rx position.}\label{fig:2a}
\end{minipage}%
%\hfill
\vspace{0.2cm}
\begin{minipage}{0.47\textwidth}
  \centering
  \includegraphics[width=0.9\textwidth]{confimages/indoor_setup_new.jpg}
  \subcaption{Indoor setup: The Tx-RIS distance is 5.5~m, and the RIS-Rx distance is 8.5~m for all Rx positions, with all nodes positioned at a height of 1.3~m. Rx positions range from $0^\circ$ to $45^\circ$, with a step size of $15^\circ$
  %Rx positions measured in $15^\circ$ increments from $0^\circ$ to $45^\circ$, 
  and the Tx if fixed at $-15^\circ$. RIS configurations are optimized to steer the beam toward each Rx position.}\label{fig:2c}
\end{minipage}%
%\vspace{0.1cm}
\caption{Experimental setups for outdoor and indoor environments.}\label{fig:exp_4images}
\end{figure}


\begin{comment}
    

\begin{figure*}[t]
\centering
\begin{minipage}{0.48\textwidth}
  \centering
  \includegraphics[width=0.9\textwidth]{confimages/outdoor_setupp.jpg}
  \subcaption{Outdoor setup: The Tx-RIS distance is 8.5~m, and the RIS-Rx distance is 8.5~m for all Rx positions, with all nodes positioned at a height of 1.3~m.}\label{fig:2a}
\end{minipage}%
\hfill
\begin{minipage}{0.48\textwidth}
  \centering
  \includegraphics[width=0.9\textwidth]{confimages/outdoor_setup.png}
  \subcaption{Outdoor setup: Rx positions measured in $5^\circ$ increments from $0^\circ$ to $60^\circ$, with the Tx fixed at $-15^\circ$. RIS configurations are optimized to steer the beam toward each Rx position.}\label{fig:2b}
\end{minipage}%
\vspace{0.2cm}
\begin{minipage}{0.48\textwidth}
  \centering
  \includegraphics[width=0.9\textwidth]{confimages/indoor_setup.jpg}
  \subcaption{Indoor setup: The Tx-RIS distance is 5.5~m, and the RIS-Rx distance is 8.5~m for all Rx positions, with all nodes positioned at a height of 1.3~m.}\label{fig:2c}
\end{minipage}%
\hfill
\begin{minipage}{0.48\textwidth}
  \centering
  \includegraphics[width=0.9\textwidth]{confimages/test_matlab_ind.PNG}
  \subcaption{Indoor setup: Rx positions measured in $15^\circ$ increments from $0^\circ$ to $45^\circ$, with the Tx fixed at $-15^\circ$. RIS configurations are optimized to steer the beam toward each Rx position.}\label{fig:2d}
\end{minipage}%
\vspace{0.2cm}
\caption{Experimental setups for outdoor and indoor environments.}\label{fig:exp_4images}
\end{figure*}

\end{comment}







\section{Experimental Results and Discussion}\label{s:experimental_results}
\begin{comment}
 
\subsection{RIS Characterization}
The RIS characterization experiment was conducted in an outdoor environment (Fig.~\ref{fig:2a}) using a specular setup. The transmitter  and receiver were equipped with directional antennas, positioned at $-15^\circ$ and $+15^\circ$, respectively, relative to the RIS. The selected outdoor area ensures a specular reflection path with limited multipath, providing controlled conditions to evaluate the RIS performance. A VNA was used to measure the S21 signal under two specific RIS configurations: \textit{all-0s} (all RIS elements set to apply a $-\pi/2$ phase shift) and \textit{all-1s} (all RIS elements set to apply a $+\pi/2$ phase shift). The key condition to validate the proper functioning of the RIS is that the phase difference between the S21 signals for the \textit{all-0} and \textit{all-1} configurations must be approximately $180^\circ$. The experiment analyzes the bandwidth limitations and frequency-dependent behavior of the RIS by examining the consistency of this phase difference across the $3.1$–$3.9$ GHz frequency band. Any deviations in the phase difference of S21 over the frequency range highlight the frequency-selective nature of the RIS and its practical operating bandwidth.


The results, presented in Fig.~\ref{fig:ris_char_combined}, show that the phase difference constraint of $180^\circ$ is not easily feasible in practice. The RIS operating frequency approximately spanning from $3.45$ GHz to $3.65$ GHz, being reasonable as it is designed for operation around $3.5$ GHz. Relaxing the phase difference constraint to $155^\circ$ extends the bandwidth to $12$ MHz, while stricter constraints, such as $175^\circ$, limit the bandwidth to just $1$ MHz. These findings underline the challenges of achieving consistent phase differences across a wide frequency range, which is critical for wideband RIS-aided communication systems.





\begin{figure}[t]
\centering
\begin{minipage}{0.45\textwidth}
\centering
\scalebox{0.5}{\input{RIS_char}}
%\vspace{-0.2cm}
\subcaption{RIS characterization}
\label{fig:ris_char_plot}
\end{minipage}%
\hfill
\begin{minipage}{0.45\textwidth}
\centering
\begin{NiceTabular}{>{\raggedright}p{3.5cm}p{2cm}}
\CodeBefore
\rowcolor{teal!10}{1}
\Body
\toprule
\textbf{Phase Difference Constraint} &  \textbf{Bandwidth} \\
\midrule
$\geq$$175^\circ$ & 1 MHz \\
\midrule
$\geq$$170^\circ$ & 5 MHz \\
\midrule
$\geq$$160^\circ$ & 8 MHz \\
\midrule
$\geq$$155^\circ$ & 12 MHz \\
\midrule
$\geq$$150^\circ$ & 21 MHz \\
\bottomrule
\end{NiceTabular}
\subcaption{Phase Difference Constraints and Bandwidth limitations}
\label{tab:ris_phase_diff}
\end{minipage}
\vspace{0.2cm}
\caption{RIS characterization results: (a) phase difference measurements between "all 0s" and "all 1s" configurations under specular reflection scenarios. (b) bandwidth limitations under different phase difference constraints. The results highlight the challenge of achieving a consistent phase difference (ideal $180^\circ$)  across a wide frequency range.}
\label{fig:ris_char_combined}
\end{figure}

\end{comment}





\subsection{Radiation Pattern of RIS: Codebook-based Beamforming}
In this subsection, we analyze the radiation patterns of the RIS obtained from outdoor experiments (Fig.~\ref{fig:2a}), conducted under a fixed Tx position at $-15^\circ$ and a Rx azimuth range of $0^\circ$ to $60^\circ$ in steps of $5^\circ$ (Fig.~\ref{fig:2a}). At each Rx position, Algorithm~1 was executed to optimize the RIS configuration for maximum received power. For the resulting configurations, we measured the amplitude of the $S_{21}$ signal at all Rx positions, allowing us to extract the RIS radiation patterns. 

Bj{\"o}rnson et al.~\cite{bjornson2021optimizing} note that the channel coefficients of RIS elements are approximately equal within each column of the array, when scattering objects are predominantly located in the horizontal plane (limited vertical scattering). In our outdoor setup (Fig.~\ref{fig:2a}), this assumption is reasonable, as the environment lacks tall buildings or other significant vertical scatterers. The area is characterized by sparse trees and open ground, and the Tx, Rx, and RIS were all positioned at the same height of $1.3$ meters, further minimizing vertical reflections. When Algorithm~1 was executed in real time to maximize the received power, the resulting RIS configurations revealed unexpected behavior in the last rows of the array (Fig.~\ref{fig:ris_configs}). Specifically, the lower rows deviated from the expected columnar structure. Given the limited vertical scattering in the outdoor environment, this deviation is likely caused by ground bounce effects, where signals reflected off the ground interact with the direct signal, enhancing or distorting the received power at the Rx. To further investigate this phenomenon, we compared the measured radiation patterns with the theoretical model of Sec.~\ref{s:theoretical_model} under two scenarios: using the measured RIS configuration as input to the model (Case 1), and modifying the last rows by extending the states of the corresponding upper rows within the same columns (Case 2). 

\begin{figure*}[t]
    \centering
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{RIS_conf0}}
        \subcaption{RIS Configuration, $0^\circ$}
        \label{fig:ris_conf0}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{RIS_conf15}}
        \subcaption{RIS Configuration, $15^\circ$}
        \label{fig:ris_conf15}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{RIS_conf30}}
        \subcaption{RIS Configuration, $30^\circ$}
        \label{fig:ris_conf30}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{RIS_conf45}}
        \subcaption{RIS Configuration, $45^\circ$}
        \label{fig:ris_conf45}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{RIS_conf60}}
        \subcaption{RIS Configuration, $60^\circ$}
        \label{fig:ris_conf60}
    \end{minipage}
    % 
    \caption{RIS configurations obtained after executing Algorithm~1 at different Rx azimuth angles. Each configuration corresponds to a $32 \times 64$ RIS, where each element supports both horizontal and vertical polarizations, resulting in double columns. The last rows deviate from the expected column-wise behavior~\cite{bjornson2021optimizing}, likely due to ground bounce effects~\cite{trichopoulos2022design}. This behavior is consistently observed across all the Rx positions of Fig.~\ref{fig:2a}.}
    \label{fig:ris_configs}
\end{figure*}


Fig.~\ref{fig:validation} compares the measured radiation patterns with the theoretical patterns derived from Case 1 and Case 2. 
%While the overall agreement between the measured and theoretical patterns validates the RIS radiation pattern framework, the alignment improves significantly when Case 2 is used. 
The measurements strongly validate the theoretical radiation pattern model, with Case 2 providing enhanced alignment by accounting for ground-bounce effects in the last rows. Furthermore, each radiation pattern consistently exhibits a pronounced main lobe directed toward the desired Rx angle, even for angles near the edge of the RIS scanning range (e.g., $60^\circ$), demonstrating the beamforming capability of the RIS. This highlights that the proposed codebook is well-suited for beam sweeping and is further utilized in the subsequent subsections.


\begin{figure*}[t]
    \centering
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{validation0}}
        \subcaption{RIS Configuration, $0^\circ$}
        \label{fig:ris_val0}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{validation15}}
        \subcaption{RIS Configuration, $15^\circ$}
        \label{fig:ris_val15}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{validation30}}
        \subcaption{RIS Configuration, $30^\circ$}
        \label{fig:ris_val30}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{validation45}}
        \subcaption{RIS Configuration, $45^\circ$}
        \label{fig:ris_val45}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{validation60}}
        \subcaption{RIS Configuration, $60^\circ$}
        \label{fig:ris_val60}
    \end{minipage}
    \caption{Validation of RIS radiation patterns measured in the outdoor setup (Fig.~\ref{fig:2a}) at Rx positions ranging from $0^\circ$ to $60^\circ$, with a step size of $5^\circ$ (3.55 GHz). Case 1 corresponds to the theoretical radiation pattern model~\cite{ramezani2024broad,10256051} derived using the RIS configurations generated by Algorithm 1, while Case 2 represents the theoretical model by modifying the last rows of the RIS configuration matrix, specifically extending the states of the corresponding upper rows within the same columns. The gains are normalized, with the maximum value set to $0\,\mathrm{dB}$. It is noted that the theoretical patterns for Case 1 and Case 2 are plotted with a resolution of $1^\circ$ while the measured patterns are taken at $5^\circ$ intervals. The maximum gain across all Rx positions is observed at the location where beam optimization via Algorithm 1 was performed.}
    \label{fig:validation}
\end{figure*}



\subsection{Impact of Frequency Selectivity on RIS Beamforming} 
\begin{figure}[t]
\centering
\begin{minipage}{0.24\textwidth}
    \centering
    \scalebox{0.29}{\input{freq_sel0}}
    \subcaption{RIS Configuration at $0^\circ$}\label{fig:freqsel0}
\end{minipage}%
\hfill
\begin{minipage}{0.24\textwidth}
    \centering
    \scalebox{0.29}{\input{freq_sel30}}
    \subcaption{RIS Configuration at $30^\circ$}\label{fig:freq_sel30}
\end{minipage}%
\caption{Comparison of measured radiation patterns across frequencies. The results demonstrate that the angle direction of the main lobe is preserved across the frequency range, showcasing the effectiveness of the proposed codebook for beam sweeping in wideband applications. Variations are observed in the side lobes. Similar results in all Rx positions.}
\label{fig:freq_selectivity}
\end{figure}

In this subsection, the proposed codebook is further examined in terms of frequency selectivity. Fig.~\ref{fig:freq_selectivity} analyzes the radiation patterns, extending the analysis to multiple frequencies. Specifically, we plot the patterns at 3.5 GHz, 3.55 GHz, and 3.6 GHz. While the angle direction of the main lobe is consistently maintained, highlighting the suitability of the codebook for beam sweeping and for wideband applications that require bandwidths of several MHz; we observe variations in the side lobes.  

%\subsection{RIS Impact on Received Power}

\begin{comment}
    

\subsection{Channel Reciprocity}
In this experiment, we investigate the channel reciprocity in a RIS-aided communication system. Channel reciprocity is a key feature in time division duplex (TDD) systems, where uplink (UL) and downlink (DL) transmissions share the same frequency band but occur in alternating time slots. This mechanism leverages that the channel properties remain consistent in both directions, thus significantly reducing the signaling overhead in systems with multiple antennas, as channel estimation can be performed in one direction and applied in the other. For RIS-aided communications, channel reciprocity ensures that the RIS configuration optimized for beamforming in the UL remains effective in the DL without requiring reconfiguration. To verify UL/DL reciprocity, we conducted experiments using a VNA to measure the S-parameters in a realistic indoor environment (Fig.~\ref{fig:2b}). The RIS configuration remains fixed during the measurements. The results, shown in Fig.~\ref{fig:channel_recipr}, compare the amplitude (in dB) and phase (in degrees) of S21 and S12 across the frequency range. The close agreement between S21 and S12 confirms the reciprocity of the UL and DL channels, despite the presence of multipath effects in the indoor environment. Similar results are observed across all the tests conducted in this work, even when the directional antennas at the receiver are replaced with omnidirectional ones to emulate more realistic conditions. This finding demonstrates that RIS can reliably support TDD systems without requiring separate configurations for UL and DL.
\begin{figure}[t]
\centering
\begin{minipage}{0.24\textwidth}
    \centering
    \scalebox{0.29}{\input{channel_recipr_amp}}
    \subcaption{Amplitude \emph{vs.} Frequency}\label{fig:amp}
\end{minipage}%
\hfill
\begin{minipage}{0.24\textwidth}
    \centering
    \scalebox{0.29}{\input{channel_recipr_phase}}
    \subcaption{Phase \emph{vs.} Frequency}\label{fig:phase}
\end{minipage}%
\caption{Channel reciprocity experiment: Measured S12 and S21 parameters of the RIS wireless channel, frequency range from 3.4 GHz to 3.6 GHz.}
\label{fig:channel_recipr}
\end{figure}

\end{comment}





\subsection{Proposed Beam Sweeping Methodology for AoA estimation}
In this subsection, we evaluate beam sweeping as a method for AoA estimation in both outdoor and indoor experimental setups (Fig.~\ref{fig:exp_4images}). For these measurements, the Rx signal power is measured over a frequency range of 3.4 GHz to 3.6 GHz, sampled at 801 points using a VNA; further investigating the methodology's accuracy for wideband applications.
%For both outdoor and indoor scenarios, measurements were taken using a Vector Network Analyzer (VNA) across 801 frequency points, ranging from 3.4 GHz to 3.6 GHz. 
In Figs.~\ref{fig:out_beamsw}--\ref{fig:m3_indoor}
%, \ref{fig:indoor_with_out}, \ref{fig:m1_indoor}, and \ref{fig:m3_indoor}, 
the red dot represents the RIS configuration where the maximum or minimum signal is expected. Furthermore, the Rx power is normalized, with the maximum set to 0 dB (Figs.~\ref{fig:out_beamsw}, \ref{fig:indoor_with_out}, and \ref{fig:m1_indoor}) or the minimum set to 0 dB (Fig.~\ref{fig:m3_indoor}).










\subsubsection{Beam Sweeping in Outdoor Setup}
%\vspace{0.1cm}
As shown in Fig.~\ref{fig:out_beamsw}, the codebook generated by Algorithm~1 ensures a pronounced main lobe toward the desired Rx position, achieving at least a 5 dB gain over the second-best RIS configuration for all Rx positions. This highlights the robustness of the beamforming strategy; achieving perfect AoA estimation in the outdoor environment (limited multipath).


\subsubsection{Beam Sweeping in Indoor Setup}
Fig.~\ref{fig:indoor_with_out} illustrates the performance of the precomputed codebook, in the indoor setup, showing a maximum AoA estimation error of $10^\circ$. This aligns with the findings of~\cite{kompostiotis2024evaluation}, which reported similar errors in ray-tracing simulations,\linebreak and~\cite{rahal2023ris}, which corroborated these results in a real RIS FR2 setup. 
To refine the AoA estimation, we propose a methodology that employs RIS for both maximizing and minimizing the received signal power. This dual-mode operation highlights the diversity that the RIS can provide on measurements. For the maximization case, as shown in Fig.~\ref{fig:m1_indoor}, the real-time execution of Algorithm~1 achieves perfect AoA estimation accuracy. Regarding the minimization case, depicted in Fig.~\ref{fig:m3_indoor}, only one test exhibits a mismatch, while the others achieve perfect AoA estimation. This mismatch may be arised due to frequency selectivity, as variations in the side lobes are observed depending on the frequency (Fig.~\ref{fig:freq_selectivity}). As mentioned, the results are evaluated across the entire tested frequency range, and it is important to note that for specific frequencies, this mismatch does not occur; highlighting the impact of frequency-dependent effects on the beamforming performance. 
%As shown in Fig.~\ref{fig:m3_indoor}, the number of iterations in minimization mode has a greater impact compared to the maximization case (Fig.~\ref{fig:m1_indoor}). This is justified, as observed from the measurements and the emerging RIS configurations, rows play a more significant role in minimization mode. Algorithm~1 starts with column scanning, therefore the minimization mode benefits from further improvements in the second iteration. So, 
The real-time execution of Algorithm~1 allows for dynamic adjustments to the indoor environment's geometry, while both maximization and minimization beam sweeping modes provide complementary solutions, enhancing AoA estimation accuracy and offering a more robust approach for real-world indoor environments.



\vspace{-0.1cm}
\section{Conclusion}~\label{s:conclusion} 
This paper provides practical insights for the RIS technology, proposing a methodology for beam sweeping in both outdoor and indoor environments; addressing the challenges of multipath and frequency-selective behavior of RIS.
%, where its phase response varies across frequencies. 
The applied RIS configuration method leads to a codebook that is practical for beam sweeping, and the real measurements validate the theoretical model. Outdoor measurements show that the generated codebook performs effectively, while for the challenging indoor setup, an additional methodology is proposed for improved AoA estimation, reducing the initial mismatch of around $10^\circ$ by adapting the RIS configuration to the specific multipath conditions and geometry of the environment.
%Additionally, our measurement campaign confirms channel reciprocity in RIS-aided communication systems and demonstrates how RIS can significantly modify the channel properties of a static environment, enhancing the received signal power by +X dB when utilized for receive signal power maximization or reducing it by -Y dB when optimized for signal suppression.

% \section{Future Work}~\label{s:future_work}
% In future work, we will conduct real measurements to evaluate a hierarchical beam sweeping approach by enriching the RIS codebook with multi-beam patterns. These patterns will enable the RIS to transmit signals toward multiple desired angles simultaneously, segmenting the served area and reducing the iterations required for conventional beam sweeping. Furthermore, leveraging the dual-polarized RIS in our setup, we plan to test the feasibility of generating broad beam patterns using techniques such as Golay complementary pairs. The omni pattern can serve as a benchmark to establish the initial received power for the user. Subsequently, through the hierarchical beam sweeping protocol, the AoA estimation accuracy will be gradually improving.




\vspace{-0.1cm}
\section{Acknowledgement}
This work has been supported by the ESA Project PRISM: RIS-enabled Positioning and Mapping (NAVISP-EL1-063).







\begin{figure*}[t]
    \vspace{1mm}
    \centering
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{beamsw_out0}}
        \subcaption{Rx position at $0^\circ$}
        \label{fig:beamsw_out0}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{beamsw_out15}}
        \subcaption{Rx position at $15^\circ$}
        \label{fig:beamsw_out15}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{beamsw_out30}}
        \subcaption{Rx position at $30^\circ$}
        \label{fig:beamsw_out30}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{beamsw_out45}}
        \subcaption{Rx position at $45^\circ$}
        \label{fig:beamsw_out45}
    \end{minipage}
    \begin{minipage}{0.185\textwidth}
        \centering
        \scalebox{0.24}{\input{beamsw_out60}}
        \subcaption{Rx position at $60^\circ$}
        \label{fig:beamsw_out60}
    \end{minipage}
    \caption{Outdoor setup: Beam sweeping results}
    \label{fig:out_beamsw}
\end{figure*}



\begin{figure*}[t]
    \centering
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoor_with_out_0}}
        \subcaption{Rx position at $0^\circ$}
        \label{fig:ind_beamsw_out0}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoor_with_out_15}}
        \subcaption{Rx position at $15^\circ$}
        \label{fig:ind_beamsw_out15}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoor_with_out_30}}
        \subcaption{Rx position at $30^\circ$}
        \label{fig:ind_beamsw_out30}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoor_with_out_45}}
        \subcaption{Rx position at $45^\circ$}
        \label{fig:ind_beamsw_out45}
    \end{minipage}
    
    \caption{Indoor setup: Beam sweeping results utilizing the precomputed codebook, with maximum AoA estimation error equal to $10^\circ$ (cases~\ref{fig:ind_beamsw_out0} and \ref{fig:ind_beamsw_out15}).}
    \label{fig:indoor_with_out}
\end{figure*}





\begin{figure*}[t]
    \centering
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM1_0n}}
        \subcaption{Rx position at $0^\circ$}
        \label{fig:ind_beamsw_maxin0}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM1_15n}}
        \subcaption{Rx position at $15^\circ$}
        \label{fig:ind_beamsw_maxin15}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM1_30n}}
        \subcaption{Rx position at $30^\circ$}
        \label{fig:ind_beamsw_maxin30}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM1_45n}}
        \subcaption{Rx position at $45^\circ$}
        \label{fig:ind_beamsw_maxin45}
    \end{minipage}
    
    \caption{Indoor setup: Beam sweeping results, executing two iterations of Algorithm~1 in real time (Maximization).}
    \label{fig:m1_indoor}
\end{figure*}


\begin{figure*}[t]
    \centering
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM3_0n}}
        \subcaption{Rx position at $0^\circ$}
        \label{fig:ind_beamsw_minin0}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM3_15n}}
        \subcaption{Rx position at $15^\circ$}
        \label{fig:ind_beamsw_minin15}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM3_30n}}
        \subcaption{Rx position at $30^\circ$}
        \label{fig:ind_beamsw_minin30}
    \end{minipage}
    \begin{minipage}{0.24\textwidth}
        \centering
        \scalebox{0.28}{\input{indoorM3_45n}}
        \subcaption{Rx position at $45^\circ$}
        \label{fig:ind_beamsw_minin45}
    \end{minipage}
    
    \caption{Indoor setup: Beam sweeping results, executing two iterations of Algorithm~1 in real time (Minimization).}
    \label{fig:m3_indoor}
\end{figure*}


\bibliographystyle{IEEEtran}
%\bibliographystyle{IEEEabrv}
%\bibliography{IEEEfull,irs}
\bibliography{irs}

\end{document}
