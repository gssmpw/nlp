\documentclass[nonacm, prologue, dvipsnames, table, xcdraw]{acmart}


\usepackage{booktabs} % For formal tables
\usepackage{xcolor}

\newcommand\EG[1]{{\color{ForestGreen!70!Yellow}{#1}}}

\hyphenation{Ben-che-kroun}

\usepackage{mathtools}

% TOG prefers author-name bib system with square brackets
\citestyle{acmauthoryear}
%\setcitestyle{nosort,square} % nosort to allow for manual chronological ordering
\newcommand\todoChangy[1]{{\color{purple}{#1}}}
\newcommand\todopyc[1]{{\color{blue}{Peter: #1}}}
\usepackage{amsmath}
% \usepackage{subfigure}
\usepackage{algpseudocode}
\usepackage{tabularx}
\usepackage{bm}
\usepackage{cancel}
\usepackage{calc}
\usepackage{accents}
\usepackage{tikz}
\usepackage{pifont}
\usetikzlibrary{backgrounds}
\usetikzlibrary{decorations.pathreplacing, arrows.meta, tikzmark}
\usetikzlibrary{calc}
\usetikzlibrary {shapes.geometric} 
\usepackage{wrapfig}
\usetikzlibrary {fit}

\usepackage{cleveref}
\usepackage{tikzscale}
\usepackage{graphicx}
% \usepackage{subcaption}
% \usepackage{graphicx}
\usepackage{units} % for nicefrac
\usepackage[percent]{overpic}
\usepackage{subfig}
\usepackage[export]{adjustbox}
\usepackage{rotating} % For rotated text

\usepackage{pgfplots}
\usepgfplotslibrary{groupplots}
\pgfplotsset{compat=1.18}



\usepackage{booktabs} 
\usepackage{makecell}


\tikzset{every node/.style={font=\fontfamily{LinuxBiolinumT-TLF}\selectfont}}
\usepackage{bm}
\usetikzlibrary{spy}

\newcommand{\refsec}[1] {Section~\ref{#1}}
%\newcommand{\refeq}[1] {Eq.~(\ref{#1})}
\newcommand{\reffig}[1] {Figure~\ref{#1}}
\newcommand{\refalg}[1] {Algorithm~\ref{#1}}
\newcommand{\reftab}[1] {Table~\ref{#1}}
\newcommand{\refapx}[1] {Appendix~\ref{#1}}
% \newcommand{\zhecheng}[1]{\textcolor{orange}{Zhecheng: #1}}
\newcommand{\zhecheng}[1]{}

\newcommand{\mengfei}[1]{\textcolor{magenta}{Mengfei: #1}}
\newlength{\subcolumnwidth}
\newenvironment{subcolumns}[1][0.45\columnwidth]
 {\valign\bgroup\hsize=#1\setlength{\subcolumnwidth}{\hsize}\vfil##\vfil\cr}
 {\crcr\egroup}
\newcommand{\nextsubcolumn}[1][]{%
  \cr\noalign{\hfill}
  \if\relax\detokenize{#1}\relax\else\hsize=#1\setlength{\subcolumnwidth}{\hsize}\fi
}
\newcommand{\nextsubfigure}{\vfill}
% \usepackage{showframe}
\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}

% Metadata Information
\acmJournal{TOG}
%\acmVolume{38}
%\acmNumber{4}
%\acmArticle{39}
%\acmYear{2019}
%\acmMonth{7}

% Copyright
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

% DOI
%\acmDOI{0000001.0000001_2}

% Paper history
%\received{February 2007}
%\received{March 2009}
%\received[final version]{June 2009}
%\received[accepted]{July 2009}


% Document starts



\makeatletter
\newcommand{\showfontinfo}{
    Font: \f@family \f@series \f@shape, Size: \f@size
}
\makeatother
\begin{document}
% Title portion
\title{Lifting the Winding Number: \\Precise Representation of Complex Cuts in Subspace Physics Simulations}

\author{Yue Chang}
\orcid{0000-0002-2587-827X}
\affiliation{%
  \institution{University of Toronto}
  \country{Canada}}
\email{changyue.chang@mail.utoronto.ca}


\author{Mengfei Liu}
\orcid{0000-0003-4989-6971}
\affiliation{%
  \institution{ University of Toronto}
  \country{Canada}}
\email{mengfei.liu@mail.utoronto.ca}


\author{Zhecheng Wang}
\orcid{0000-0003-4989-6971}
\affiliation{%
  \institution{ University of Toronto}
  \country{Canada}}
\email{zhecheng@cs.toronto.edu}

\author{Peter Yichen Chen}
\orcid{0000-0003-1919-5437}
\affiliation{%
  \institution{MIT CSAIL}
  \country{USA}}
\email{pyc@csail.mit.edu}


\author{Eitan Grinspun}
\orcid{0000-0003-4460-7747}
\affiliation{%
  \institution{ University of Toronto}
  \country{Canada}}
\email{eitan@cs.toronto.edu}

\input{sections/abstract}

%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below.
%
\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10010147.10010371.10010352.10010379</concept_id>
       <concept_desc>Computing methodologies~Physical simulation</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10010147.10010371.10010396.10010402</concept_id>
       <concept_desc>Computing methodologies~Shape analysis</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Physical simulation}

%
% End generated code
%


\keywords{Cutting, Discontinuity, Reduced-order modeling, Implicit neural representation, Computational design}

\begin{teaserfigure}
    \centering
    \includegraphics[width=\linewidth]{figures/teaser_0116.png}
    \caption{Our method calculates a basis for reduced-space simulations that can represent shapes with a family of discontinuities. This basis is represented by neural fields. Unlike neural fields implemented by vanilla MLPs \cite{Modi:2024:Simplicits}, which have built-in continuity, we represent discontinuities by construction using the winding number field. The basis can then be used for reduced-space simulation for progressive cutting.}
    \label{fig:teaser}
\end{teaserfigure}


\maketitle

\input{sections/introduction.tex}
\input{sections/related_works.tex}
%\input{sections/method.tex}
\input{sections/theory.tex}
\input{sections/reduced_space_simulation.tex}
\input{sections/results.tex}
\input{sections/limitation_and_discussion.tex}

\bibliographystyle{ACM-Reference-Format}
\bibliography{main}

\clearpage


\begin{figure}
\includegraphics[width = \linewidth]{figures/Interactiion.pdf}
\caption{Our method enables interactive drawing and editing of cut shapes with real-time previews. Users can drag polyline vertices to modify the cut shape during an ongoing simulation, in real-time. This is highly challenging for mesh-based methods due to the frequent need to constantly re-mesh the entire domain and has not been demonstrated.}
\label{fig:Interaction}
\end{figure}




\begin{figure}
\centering
\includegraphics[width = \linewidth]{figures/new/real_world.pdf}
\caption{
Real-world Physical Experiment. We performed a qualitative comparison with a real-world experiment. A helical shape was cut and photographed as it sagged under gravity under the same boundary conditions. The simulated deformation qualitatively matches the real-world data.
} 
\label{fig:realworld} 
\end{figure}

\captionsetup[subfloat]{position=bottom,labelformat=empty}
\begin{figure}
\begin{subcolumns}[0.99\linewidth]
  \subfloat[Training shapes]{\includegraphics[width=\subcolumnwidth]{figures/new/generalization_1_train.pdf}}
   \vspace{-0.5em}
% \nextsubfigure
  \subfloat[Testing shapes, not in training data]{\includegraphics[width=\subcolumnwidth]{figures/new/generalization_1_test.pdf}}
\end{subcolumns}
\caption{We train our method with the three blue cut shapes, as shown on the top, and tested with three other cut shapes that is significantly different cut shapes that is not in the training set, as shown in the bottom. We can still get reasonable deformation for the testing set.}
\label{fig:GenGeo1}
\end{figure}


\begin{figure}
\centering
\begin{minipage}[c]{1.\linewidth} % Minipage strictly within the column
\begin{tikzpicture}

    % Nodes
    \node (img1) at (0\linewidth, 0) {\includegraphics[width=0.26\linewidth]{figures/new/helical_even_1.pdf}};
    \node (img2) at (0.2366\linewidth, 0) {\includegraphics[width=0.26\linewidth]{figures/new/helical_even_2.pdf}};
    \node (img3) at (0.4732\linewidth, 0) {\includegraphics[width=0.26\linewidth]{figures/new/helical_even_3.pdf}};
    \node (img4) at (0.7098\linewidth, 0) {\includegraphics[width=0.26\linewidth]{figures/new/helical_even_4.pdf}};

    % Add text over images
    \node[align=center] at ([yshift=1mm]img1.north) {\footnotesize Poke};
    \node[align=center] at ([yshift=1mm]img2.north) {\footnotesize Poke};
    \node[align=center] at ([yshift=1mm]img3.north) {\footnotesize Poke};
    \node[align=center] at ([yshift=1mm]img4.north) {\footnotesize Poke};
    \draw[thin, -{Latex[length=1.25mm]}] 
        ([shift={(0.7,0.8)}]img1.south) 
        to[bend right=40] 
        node[midway, below] {\footnotesize Cut} 
        ([shift={(-0.7,0.8)}]img2.south);
    \draw[thin, -{Latex[length=1.25mm]}] 
        ([shift={(0.7,0.35)}]img2.south) 
        to[bend right=40] 
        node[midway, below] {\footnotesize Cut} 
        ([shift={(-0.7,0.35)}]img3.south);

\end{tikzpicture}
\end{minipage}
\caption{
Our method generalizes to loadings (forces) unseen during training. To demonstrate this, we applied a previously unseen force at various stages of the progressive cut, resulting in deformations that reflect the evolving geometry at each stage. } 
\label{fig:GenLoading} 
\end{figure}


\begin{figure}
\includegraphics[width=\linewidth]{figures/new/failure_595.pdf}
\caption{Failure example. When we train our method on a clockwise helical cut and test with a counter-clockwise helical cut, the final deformation is different from the deformation tested on the training set. This is because the winding number distribution is significantly different from the training set.}
\label{fig:failurecase2}
\end{figure}


\begin{figure}
\includegraphics[width=\linewidth]{figures/kirigami_chain.pdf}
\caption{We trained the basis on simulations of tugging on a \emph{single} kirigami sheet. By connecting many instances of this kirigami sheet end to end, we obtain a reduced simulation of this ``kirigami tower.''}
\label{fig:kirigami_chain}
\end{figure}

\begin{figure}
\includegraphics[width=\linewidth]{figures/KirigamiInteractive.pdf}
\caption{We can interactively edit the cut shape for the kirigami. The cut lines of the kirigami change from a straight line to a 'z' shaped curve.}
\label{fig:kirigami_interactive}
\end{figure}










\begin{figure*}
\centering
\begin{minipage}[t]{0.52\linewidth}
    \centering
    \includegraphics[width=\linewidth]{plot_data/tfigure.tikz}
    % \captionof{figure}{Reconstruction error of different settings compared with baselines.}
    % \label{fig:mseplot}
\end{minipage}
\hfill
\raisebox{-0.8em}{
\begin{minipage}[t]{0.43\linewidth}
    \centering
    \includegraphics[width=\linewidth]{plot_data/cfigure.tikz}
    % \captionof{figure}{Convergence Convergence PLACEHOLDER.}
    % \label{fig:convplot}
\end{minipage}
}
\vspace{-1em}
\caption{We compared the mean squared error of our method with LiCROM \cite{chang:2023:licrom} using different MLP scales and activation functions. Our method achieves significantly lower error across all settings, as shown on the left. Additionally, it demonstrates faster convergence during training, as shown on the right. }
\label{fig:combined_mse_conv}
\end{figure*}








\captionsetup[subfloat]{position=bottom,labelformat=empty, skip=0pt, justification=centering}
\begin{figure*} % Use figure (not figure*) for single-column width

\centering
\begin{minipage}[c]{0.24\linewidth}

    % \begin{tikzpicture}[spy using outlines={rectangle,black,magnification=3,size=2.2cm, connect spies}]
    % \node[transform shape] {\pgfimage[interpolate=true,width=0.95\linewidth]{figures/new/train_test_undeformed/TRAIN_TEST_CROPPED.pdf}};

    % \spy on (0,-0.5) in node [left] at (1,3.2);
    % \end{tikzpicture}

    \begin{tikzpicture}[spy using outlines={rectangle,black,magnification=3,size=2.2cm}]
    % Place the image and assign a name
    \node[transform shape] (image) {\pgfimage[interpolate=true,width=0.95\linewidth]{figures/new/train_test_undeformed/TRAIN_TEST_CROPPED.pdf}};

    % Define the center of the spy region relative to the image
    \coordinate (spycenter) at ([xshift=0cm, yshift=-0.6cm] image.center);

    % Draw the small spy box around the region to magnify
    \node[rectangle, draw=none, inner sep=0pt, minimum width=0.73333333333cm, minimum height=0.73333333333cm, anchor=center] (smallspy) at (spycenter) {};

    % Draw the zoomed-in region (magnified region)
    \node[rectangle, draw=none, inner sep=0pt, minimum width=2.2cm, minimum height=2.2cm, anchor=center] (zoomedspy) at (0,3.8) {};

    % Use TikZ spy to magnify
    \spy [every spy on node/.style={rectangle,draw,black}] 
        on (0,-0.6) % Region in the image to magnify (relative to image center)
        in node [] at (0,3.8); % Position of the magnified view
    \draw[dashed] (smallspy.north west) -- (zoomedspy.south west);
    \draw[dashed] (smallspy.north east) -- (zoomedspy.south east);

    \node[align=center] at ($ (image.south west)!0.25!(image.south east) + (1mm, -1.5mm) $) {Train};
    \node[align=center] at ($ (image.south west)!0.75!(image.south east) + (-1mm, -1.5mm) $) {Test};
    
    \node[align=center, anchor=south] at ($(zoomedspy.north) + (0mm, 0.5mm)$) {Different cuts!};
\end{tikzpicture}

\end{minipage}
\hfill
\begin{minipage}[c]{0.75\linewidth} % 3 Subfigures
    % \begin{tikzpicture}[remember picture, overlay]
    %     % Adjust coordinates to cover the entire minipage
    %     \draw[dashed, draw=red, thick] (0, 4.5) rectangle (\linewidth, -\dimexpr\ht\strutbox+\dp\strutbox); % Example overlay box
    % \draw[dashed, ] (0, -1) -- (\linewidth, -1);

    % \node[anchor=north, align=center] at (\linewidth/2, 4.5) {Shape in training set};

    % \end{tikzpicture}
    \tikzmarknode{mpStart}{}%
    \vspace{0.5em} \\
    \subfloat[Ground truth (FEM)]{\includegraphics[width=0.19\columnwidth]{figures/new/train_set_silver_enhanced_cropped/GT_ground_truth.pdf}}
    \hfill
    \subfloat[\textbf{Ours \\ $\bm{\mathrm{MSE}= 5.9 \times 10^{-5}}$}]{\includegraphics[width=0.19\columnwidth]{figures/new/train_set_silver_enhanced_cropped/GT_ours.pdf}}
    \hfill
    \subfloat[LiCROM \shortcite{chang:2023:licrom} \\
    $\mathrm{MSE}= 3.0 \times 10^{-4}$
    ]{\includegraphics[width=0.19\columnwidth]{figures/new/train_set_silver_enhanced_cropped/GT_LiCROM.pdf}}
    \hfill
    \subfloat[DANN \shortcite{Belhe:2023:DiscontinuityAwareNeuralFields} \\
    $\mathrm{MSE}= 1.6 \times 10^{-3}$]{\includegraphics[width=0.19\columnwidth]{figures/new/train_set_silver_enhanced_cropped/GT_DANN.pdf}}
    \hfill
    \subfloat[Simplicits \shortcite{Modi:2024:Simplicits} \\
    $\mathrm{MSE}= 8.1 \times 10^{-2}$]{\includegraphics[width=0.19\columnwidth]{figures/new/train_set_silver_enhanced_cropped/GT_simplicits.pdf}}

    \vspace{1. em}
    \subfloat[Ground truth (FEM)]{\includegraphics[width=0.19\columnwidth]{figures/new/test_set_enhanced_cropped/gt.pdf}}
    \hfill
    \subfloat[\textbf{Ours \\ $\bm{\mathrm{MSE}= 2.4 \times 10^{-3}}$}]{\includegraphics[width=0.19\columnwidth]{figures/new/test_set_enhanced_cropped/ours.pdf}}
    \hfill
    \subfloat[LiCROM \shortcite{chang:2023:licrom} \\
    $\mathrm{MSE}= 2.4 \times 10^{-2}$]{\includegraphics[width=0.19\columnwidth]{figures/new/test_set_enhanced_cropped/licrom.pdf}}
    \hfill
    \subfloat[DANN \shortcite{Belhe:2023:DiscontinuityAwareNeuralFields} \\
    $\mathrm{MSE}= 2.1 \times 10^{-2}$]{\includegraphics[width=0.19\columnwidth]{figures/new/test_set_enhanced_cropped/dann.pdf}}
    \hfill
    \subfloat[Simplicits \shortcite{Modi:2024:Simplicits} \\
    $\mathrm{MSE}= 2.8 \times 10^{-2}$]{\includegraphics[width=0.19\columnwidth]{figures/new/test_set_enhanced_cropped/simplicits.pdf}}
  \tikzmarknode{mpEnd}{}%
\end{minipage}
\begin{tikzpicture}[remember picture,overlay]
  % Convert marks to coordinates
  \coordinate (mpNW) at ($(mpStart.north west)$);
  \coordinate (mpSE) at ($(mpEnd.south east)$);

  % \draw[dashed, red, thick] (mpNW) rectangle (mpSE);
    \coordinate (mpNE) at ($(mpNW -| mpSE)$);
    \coordinate (mpSW) at ($(mpSE -| mpNW)$);
    \draw[dashed] ($ (mpNW)!.5!(mpSW) - (0, 1.5em)$) -- ($ (mpNE)!.5!(mpSE) - (0, 1.5em)$);

    \coordinate (mpTopCenter) at ($ (mpNW)!.5!(mpNE) $);
    \coordinate (mpCenter) at ($ (mpNW)!.5!(mpSE) $);

    \node[anchor=north, align=center]
      at ($(mpTopCenter) + (0, -0.1em)$)
      {\Large Shape in training set};

    \node[anchor=north, align=center]
      at ($(mpCenter) + (0, -1.8em)$)
      {\Large Shape not in training set};
\end{tikzpicture}
\caption{
We have compared our reconstruction error with other methods. Our method has the lowest reconstruction error for both shapes in and not in the training set. Moreover, our method is the only one that can generate a visually reasonable result when tested on a cut that is different from the training set.} 
\label{fig:Comparison_results} 
\end{figure*}
\clearpage

\end{document}
