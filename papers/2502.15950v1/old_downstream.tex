
\begin{table*}[htbp!]
  \centering
  \begin{small}
  \begin{sc}
  \scalebox{0.75}{
  \begin{tabular}{@{\hspace{4pt}}l@{\hspace{4pt}}l|c@{\hspace{10pt}}c@{\hspace{8pt}}c@{\hspace{4pt}}c@{\hspace{4pt}}c|c@{\hspace{4pt}}c@{\hspace{4pt}}c@{\hspace{4pt}}c@{\hspace{4pt}}c|c}
  \toprule
  & \multirow{2}{*}{Model} & \multicolumn{5}{c|}{Generation Tasks} & \multicolumn{5}{c|}{Ranking Tasks} & \multirow{2}{*}{Average ($\uparrow$)} \\
    &  & WQ & NQ & \scriptsize{SQuAD} & \scriptsize{TriviaQA} & \scriptsize{LAMBADA} & COPA & PiQA & WiC & \scriptsize{WinoGrande} & \scriptsize{HellaSwag} & \\
  \midrule
    & Uniform & $4.4$  &  $2.4$  &  $35.8$  &  $10.9$  &  ${21.9}$  &  $70.0$  &  $67.9$  &  $49.1$  &  $54.2$  &  $42.3$  &  $35.9$ \\
    & SlimPajama & $\mathbf{6.9}$  &  $\mathbf{3.9}$  &  $37.0$  &  ${15.7}$  &  $18.9$  &  $71.3$  &  $67.2$  &  $49.5$  &  $54.7$  &  $45.3$  &  $37.0$ \\
    & DoGE (124M) & $5.2$  &  $2.3$  &  $33.5$  &  $10.0$  &  $19.9$  &  $70.0$  &  $68.4$  &  $48.1$  &  $54.0$  &  $43.1$  &  $35.4$ \\
    & DoReMi (124M) & $5.1$  &  $2.8$  &  $37.1$  &  $13.6$  &  $21.7$  &  $71.7$  &  $66.4$  &  $48.8$  &  $54.5$  &  $42.3$  &  $36.4$ \\
    \multirow{-5}{*}{\rotatebox[origin=c]{90}{Baselines}}
    & DML & $4.1$  &  $1.9$  &  $34.4$  &  $~~9.1$  &  $15.5$  &  $71.7$  &  $68.1$  &  $\mathbf{50.9}$  &  $54.0$  &  $42.9$  &  $35.3$ \\
  \midrule
    & \textsc{MTGP-mde-sp} & $4.0$  &  $2.4$  &  $34.2$  &  $9.4$  &  $19.6$  &  $68.7$  &  $67.6$  &  $50.4$  &  $52.8$  &  $43.0$  &  $35.2$ \\
    \multirow{-2}{*}{\rotatebox[origin=c]{90}{\scriptsize{Ours}}}
   % & MTGP-MDE-Task & $6.2$  &  $3.3$  &  $\mathbf{39.1}$  &  $14.7$  &  $21.4$  &  $\mathbf{73.7}$  &  $\mathbf{69.7}$  &  $48.7$  &  $\mathbf{57.1}$  &  $\mathbf{46.7}$  &  $\mathbf{38.0}$ \\
 & \textsc{Linear-mde-et} & $6.4$ & $3.5$ & $34.7$ & $\mathbf{17.6}$ & $22.1$ & $\mathbf{75.3}$ & $69.3$ & $49.3$ &  $\mathbf{55.7}$ & $47.6$ & $38.2$ \\
 & \textsc{Linear-mde-all} & $6.1$ & $3.1$ & $\mathbf{37.2}$ & $14.7$ & $\mathbf{24.1}$ & $73.3$ & $\mathbf{70.4}$ & $50.4$ &  $\mathbf{55.7}$ & $\mathbf{47.7}$ & $\mathbf{38.3}$ \\
  \bottomrule
  \end{tabular}
  }
  \end{sc}
  \end{small}
  \caption{Downstream model performance on $5$ prediction tasks and $5$ ranking tasks. Results are averaged across $0$-shot, $1$-shot, and $5$-shot performances.  For generation tasks, we report exact match (EM) accuracies (\%), and for ranking tasks, we report accuracies (\%).  All models are 1B parameter models trained for 200K steps.}
  \label{tab:downstream-results-main}
\end{table*}


%%%backup

\begin{figure}[]
\centering
\begin{minipage}{\columnwidth}

\scalebox{0.55}{

\begin{tikzpicture}
    \begin{axis}[
        xlabel={Number of training steps},
        xlabel style={font=\large},
        ylabel={Average downstream accuracy},
        ylabel style={yshift=-12pt, font=\large},
        legend pos=south east,
        ymin=28.5, ymax=39.0,
        xmin=1,xmax=9,
        legend style={at={(1,0)}, anchor=south east},
        ymajorgrids=true,
        grid style=dashed,
        width=14cm,
        height=8cm,
        %xmode=log,
        xtick={1,2,3,4,5,6,7,8,9}, % Positions for the x-ticks
        xticklabels={10K, 20K, 50K, 74K, 100K, 126K,150K,174K,200K}, % Custom x-tick labels
        legend style={font=\footnotesize}, % Make legend text smaller
    ]

        \addplot[color=MidnightBlue, line width=1pt, dashed, mark options=solid] coordinates {(1, 28.9) (2, 30.3) (3, 32.4) (4, 33.7) (5, 34.0) (6, 35.2) (7, 35.5) (8, 36.0) (9, 35.9)};
        \addlegendentry{Uniform}

        \addplot[color=brown, mark=o, line width=1pt, dashed, mark options=solid] coordinates {(1, 30.4) (2, 31.4) (3, 33.7) (4, 34.0) (5, 35.6) (6, 35.5) (7, 35.9) (8, 36.3) (9, 37.0) };
        \addlegendentry{SlimPajama}

        \addplot[color=black, mark=star, line width=1pt, densely dotted, mark options=solid] coordinates {(1, 29.2) (2, 30.7) (3, 32.9) (4, 33.6) (5, 34.9) (6, 35.3) (7, 36.2) (8, 35.9) (9, 36.4)};
        \addlegendentry{DoReMi}

        \addplot[color=BrickRed, mark=|, line width=1pt, densely dotted, mark options=solid] coordinates {(1, 29.9) (2, 30.5) (3, 32.9) (4, 33.7) (5, 34.0) (6, 34.6) (7, 35.3) (8, 35.3) (9, 35.4) };
        \addlegendentry{DoGE}

        \addplot[color=PineGreen, mark=*, line width=1pt] coordinates {(1, 31.4) (2, 33.4) (3, 35.7) (4, 36.8) (5, 36.8) (6, 37.0) (7, 37.6) (8, 37.9) (9, 38.3)};
        \addlegendentry{Linear+\textsc{mde-all}}

        \addplot[color=Plum, mark=diamond*, line width=1pt] coordinates {(1, 30.1) (2, 32.6) (3, 35.0) (4, 35.8) (5, 37.2) (6, 37.3) (7, 37.1) (8, 37.6) (9, 38.2)};
        \addlegendentry{Linear+\textsc{mde-et}}

        \addplot[color=VioletRed, mark=oplus, line width=1pt] coordinates {(1, 29.8) (2, 31.1) (3, 33.1) (4, 33.5) (5, 34.4) (6, 34.2) (7, 35.0) (8, 34.5) (9, 35.2)};
        \addlegendentry{MTGP+\textsc{mde+sp}}

        \draw [decorate,decoration={brace,amplitude=5pt},yshift=0pt,xshift=250pt]
      (7,25) -- (7,32) node [midway,left,xshift=-5pt] {Prior work};

        \draw [decorate,decoration={brace,amplitude=5pt},yshift=0pt,xshift=250pt]
      (7,5) -- (7,18) node [midway,left,xshift=-5pt] {Ours};
        %\node at (1.2,22) {Ours};

    \end{axis}
\end{tikzpicture}
}
\end{minipage}
\caption{Downstream task accuracy (average over 0-shot,1-shot, and 5-shot formulations over a suite of generation and ranking tasks) for 1B models optimized through our methods using MDE versus prior work.}
\label{fig:downstream}
\end{figure}
