In this section, we
augment $\pname$ to support the more expressive DAG CRT programming model. We only modify the XEVM component of CRATE and leave the 2PC component on L1 unchanged; as a result, the liveness argument is identical to the chain-CRT version.

\parhead{General System Contract}
The chain-CRT-based $\gsc$ contract does not support the more expressive DAG CRTs, since it crucially relies on marking the session as inactive upon encountering a non-triggering action.
To support DAG CRTs, we modify XEVM as follows. 

First, $\action(\cdot)$ now accepts an \emph{array} of triggered actions, instead of a single action. Correspondingly, we modify $\trigger(\cdot)$ to accept trigger calls even after the $\tcalled{}$ flag is set to $\true$. 
To force Executors to use a single $\action$ call, we insert logic so that all trigger (resp. action) $\msghash$ values created as part of the same parent transaction use the same $\tnonce{}$ (resp. $\anonce{}$) value. At this point, notice that in the chain-CRT $\gsc$, the $\textproc{startSession}$ function is designed to route a single $\trigger$ call, thus limiting $a_1$ to single trigger call. To allow $a_1$ to make multiple trigger calls (which can originate from distinct contracts, such as in a cross-rollup flash loan), we re-purpose $\textproc{startSession}$ to be the \emph{entrypoint} of the DAG CRT. We require that the user route her compiled $a_1'$ action through $\textproc{startSession}$ by passing $(a_1'.\addr{}, a_1'.\cdata{})$ as arguments to it. $\textproc{startSession}$ then executes $a_1'$ and the $\gsc$ handles all nested $\trigger$ calls as described above. We leave $\textproc{checkSessionID}$ and all session-tracking logic unchanged.
We present our full DAG-CRT $\gsc$ contract in \cref{apdx:gsc}.

\parhead{Executor specification}
The Executor now listens for multiple trigger events, and passes the array all triggered actions as input to $\gsc.\action(\cdot)$. We reflect this change in the modified $\textproc{xevm}$ function in \cref{alg:shared-executor-xevm-dag}.


\parhead{Safety}
We now state our second main theorem, which says that $\pname$ is secure with respect to \cref{def:forward-atom-chain-crt} repurposed for DAG-CRTs. We defer the theorem's proof to \cref{apdx:dag-crt-proofs}. 


\begin{theorem}~\label{thm:dag-crate-forward-atomicity-two-rollups}
     $\pname$ satisfies atomicity for DAG CRTs and $|\mathcal{R}| = 2$ rollups.
\end{theorem}
