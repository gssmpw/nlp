\usepackage[mathscr]{euscript}
% P-LAMBDA
\newcommand\tldr[1]{\textcolor{gray}{\textit{[#1]} \\}}
\newcommand\tldrDone[1]{}

%FIGURES
\usepackage{graphicx}
\usepackage{subcaption}

% ALGORITHMS
\newcommand{\generate}{\mathtt{generate}}
\newcommand{\detect}{\mathtt{detect}}
\newcommand{\shuffle}{\mathtt{shift\txt{-}generate}}
\newcommand{\median}[1]{\mathtt{median}(#1)}
\newcommand{\decode}{\Gamma}
\newcommand{\its}{$\mathtt{ITS}$}
\newcommand{\itsedit}{$\mathtt{ITS}$-$\mathtt{edit}$}
\newcommand{\gumb}{$\mathtt{EXP}$}
\newcommand{\gumbedit}{$\mathtt{EXP}$-$\mathtt{edit}$}
\newcommand{\gumbhash}{$\mathtt{EXP}$-$\mathtt{hash}$}
\newcommand{\kgwtwo}{$\mathtt{KGW}$-$\mathtt{2.0}$}
\newcommand{\kgwone}{$\mathtt{KGW}$-$\mathtt{1.0}$}

% SYMBOLS
\renewcommand{\(}{\left(}
\renewcommand{\)}{\right)}
\renewcommand{\[}{\left[}
\renewcommand{\]}{\right]}
\newcommand{\la}{\left|}
\newcommand{\ra}{\right|}
\newcommand{\lv}{\left\lVert}
\newcommand{\rv}{\right\rVert}
\newcommand{\lbr}{\left\{}
\newcommand{\rbr}{\right\}}

\newcommand{\true}{\mathtt{true}}
\newcommand{\false}{\mathtt{false}}

\newcommand{\insertion}{\mathtt{insert}}
\newcommand{\deletion}{\mathtt{delete}}
\newcommand{\cumsum}{\mathtt{sum}}
\newcommand{\len}[1]{\mathtt{len}(#1)}

% \newcommand{\cardp}[1]{\mathrm{card}({#1})}
\newcommand{\cardp}{\abs}
\newcommand{\card}{\textup{card}}

% CHARACTERS
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\W}{\mathbb{W}}
\newcommand{\eps}{\varepsilon}
\newcommand{\diffp}{\eps}
\newcommand{\fM}{\mathfrak{M}}

% FUNCTIONS
\newcommand{\E}[2][]{\mathbb{E}_{\ifx &#1& \else #1 \fi}\left[#2\right]}
\newcommand{\1}[1]{\mathbf{1}\lbr #1\rbr}
\renewcommand{\P}[1]{\mathbb{P}\(#1\)}
\newcommand{\e}[1]{\exp\(#1\)}

\renewcommand{\^}[1]{^{\(#1\)}}

\newcommand{\spn}[1]{\text{span}\(#1\)}

\newcommand{\TV}[1]{\lv #1 \rv_{\text{TV}}}
\newcommand{\KL}[2]{D_{KL}\(#1||#2\)}
\newcommand{\Dchi}[2]{D_{\chi^2}\(#1||#2\)}

% Distributions
\newcommand{\Bern}{\mathsf{Bern}}
\newcommand{\Lap}{\laplace}
\newcommand{\pointmass}{\boldsymbol{\delta}}

% D_{KL}\(#1||#2\)

\newcommand{\mx}[1]{\max\lbr#1\rbr}
\newcommand{\mn}[1]{\min\lbr#1\rbr}


\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\darr}{\overset{d}{\rightarrow}}
\newcommand{\deq}{\overset{dist}{=}}
\newcommand{\parr}{\overset{p}{\rightarrow}}
\newcommand{\asarr}{\overset{a.s.}{\rightarrow}}

\newcommand{\tr}{\text{tr}}


% \newtheorem{theorem}{Theorem}
% \newtheorem{proposition}{Proposition}
% \newtheorem{corollary}{Corollary}
% \newtheorem{lemma}{Lemma}

\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\dell}{\dot{\ell}}
\newcommand{\ddell}{\ddot{\ell}}

\newcommand{\domain}{\mathop{\textup{dom}}}

\newcommand{\dom}[2]{\lesssim_{#1, #2}}
\newcommand{\domed}{\dom{\eps}{\delta}}

\newcommand{\close}[2]{\stackrel{d}{=}_{#1, #2}}
\newcommand{\closeed}{\close{\eps}{\delta}}

\newcommand{\thetax}{\est{\theta}_x}
\newcommand{\Sigmax}{\est{\Sigma}_x}

\newcommand{\opnorm}[1]{\norm{#1}_{\textup{op}}}
\newcommand{\lfro}[1]{\norm{#1}_{\textup{Fr}}}

\newcommand{\cd}{\stackrel{d}{\rightarrow}}
\newcommand{\cp}{\stackrel{p}{\rightarrow}}
\newcommand{\cas}{\stackrel{a.s.}{\rightarrow}}
\DeclareMathOperator*{\plim}{p-lim}
\DeclareMathOperator*{\plimsup}{p-lim\,sup}
\DeclareMathOperator*{\pliminf}{p-lim\,inf}
\DeclareMathOperator*{\aslim}{a.s.-lim}
\DeclareMathOperator*{\aslimsup}{a.s.-lim\,sup}
\DeclareMathOperator*{\asliminf}{a.s.-lim\,inf}
\newcommand{\normal}{\mathsf{N}}
\newcommand{\laplace}{\mathsf{Lap}}
\newcommand{\uniform}{\mathsf{Uni}}
\newcommand{\train}{\mathsf{Train}}
\newcommand{\pred}{\mathsf{Pred}}
\newcommand{\cost}{\mathsf{Cost}}
\newcommand{\diag}{\mathsf{diag}}
\newcommand{\var}{\mathsf{Var}}
\newcommand{\cov}{\mathsf{Cov}}
\newcommand{\de}{\mathrm{d}}
\newcommand{\ba}{\boldsymbol{a}}
\newcommand{\bb}{\boldsymbol{b}}
\newcommand{\flr}[1]{{\lfloor {#1} \rfloor}}
\newcommand{\cil}[1]{{\lceil {#1} \rceil}}
\newcommand{\integersp}{\integers_{\geq 0}}
\newcommand{\wb}[1]{\overline{#1}}
\newcommand{\ind}{\mathds{1}}
\newcommand{\Ep}{\mathbb{E}}
\newcommand{\Prb}{\mathbb{P}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\real}{\mathbb{R}} % real numbers
\newcommand{\C}{\mathbb{C}} % complex numbers
\newcommand{\prn}[1]{\left({#1}\right)} % parentheses
\newcommand{\prnbig}[1]{\big({#1}\big)} % parentheses
\newcommand{\prnBig}[1]{\Big({#1}\Big)} % parentheses
\newcommand{\prnBigg}[1]{\Bigg({#1}\Bigg)} % parentheses
\newcommand{\brk}[1]{\left[{#1}\right]} % bracket
\newcommand{\brkbig}[1]{\big[{#1}\big]} % parentheses
\newcommand{\brkBig}[1]{\Big[{#1}\Big]} % parentheses
\newcommand{\brkBigg}[1]{\Bigg[{#1}\Bigg]} % parentheses
\newcommand{\brc}[1]{\left\{{#1}\right\}} % brace
\newcommand{\norm}[1]{\left\|{#1}\right\|} % norm
\newcommand{\norms}[1]{\|{#1}\|} % norm (small)
\newcommand{\normbig}[1]{\big\|{#1}\big\|} % norm (small)
\newcommand{\nucnorm}[1]{\norm{#1}_*} % nuclear norm
\newcommand{\nucnorms}[1]{\norms{#1}_*} % small nuclear norm
\newcommand{\nucnormbig}[1]{\normbig{#1}_*} % small nuclear norm
%\newcommand{\ltwo}[1]{\norm{#1}_2}  % Ltwo norm
\newcommand{\ltwobig}[1]{\normbig{#1}_2}  % Ltwo norm
\newcommand{\ltwos}[1]{\norms{#1}_2}  % Ltwo norm (small)
\newcommand{\lone}[1]{\norm{#1}_1}
\newcommand{\linf}[1]{\norm{#1}_\infty}
\newcommand{\normtwo}[1]{\norm{#1}_2}
\newcommand{\normop}[1]{\norm{#1}_{\mathrm{op}}}
\newcommand{\normlbd}[2]{\norm{#1}_{\lambda, #2}}
\newcommand{\intnormlbd}[2]{\opnorm{#1}_{\lambda, #2}}
\newcommand{\abs}[1]{\left|{#1}\right|} % norm
\newcommand{\est}[1]{\widehat{#1}}
\newcommand{\sgn}[1]{\mathsf{sign}\prn{#1}}
\newcommand{\uwdst}{\mathrm{W}_{2}}
\newcommand{\wdst}[2]{\mathrm{W}_{2}\prn{#1,#2}}
\newcommand{\lbddst}[2]{\mathsf{dist}_{\lambda,T}\prn{#1,#2}}
\newcommand{\ddt}{\frac{\de}{\de t}}
\newcommand{\prox}{\mathsf{prox}}

\newcommand{\half}{\frac{1}{2}}

\newcommand{\vt}{\theta}
\newcommand{\vr}{r}
\newcommand{\vLambda}{\Lambda}
\newcommand{\vu}{u}
\newcommand{\vw}{w}
\newcommand{\vl}{\ell}
\newcommand{\veps}{z}
\newcommand{\vtet}{\theta^\eta}
\newcommand{\vret}{r^\eta}
\newcommand{\vuet}{u^\eta}
\newcommand{\vwet}{w^\eta}
\newcommand{\trsfrm}{\mathcal{T}}
\newcommand{\trsfrmA}{\mathcal{T}_{\mathcal{S} \to \wb{\mathcal{S}}}}
\newcommand{\trsfrmB}{\mathcal{T}_{\wb{\mathcal{S}} \to \mathcal{S}}}
\newcommand{\mc}[1]{\mathcal{#1}}

\newcommand{\minimize}{\mathop{\textup{minimize}}}
\newcommand{\subjectto}{\mathop{\textup{subject~to}}}

\newcommand{\cstloss}{M_\ell}
\newcommand{\cstspaceS}{M_{\mathcal{S}}}
\newcommand{\cstdualspaceS}{M_{\wb{\mathcal{S}}}}
\newcommand{\cstlbd}{M_\Lambda}
\newcommand{\cstthetaz}{M_{\theta^0, z}}

\newcommand{\Rt}{R_\theta}
\newcommand{\Rl}{R_{\ell}}
\newcommand{\Ct}{C_\theta}
\newcommand{\Cl}{C_{\ell}}
\newcommand{\vRt}{R_\theta}
\newcommand{\vRl}{R_{\ell}}
\newcommand{\vCt}{C_\theta}
\newcommand{\vCl}{C_{\ell}}
\newcommand{\bRt}{\wb{R}_\theta}
\newcommand{\bRl}{\wb{R}_\ell}
\newcommand{\bCt}{\wb{C}_\theta}
\newcommand{\bCl}{\wb{C}_\ell}
\newcommand{\bGamma}{\wb{\Gamma}}
\newcommand{\pRt}{\Phi_{\Rt}}
\newcommand{\pRl}{\Phi_{\Rl}}
\newcommand{\pCt}{\Phi_{\Ct}}
\newcommand{\pCl}{\Phi_{\Cl}}
\newcommand{\lpRt}{\phi_{\Rt}}
\newcommand{\lpRl}{\phi_{\Rl}}
\newcommand{\lpCt}{\phi_{\Ct}}
\newcommand{\lpCl}{\phi_{\Cl}}
\newcommand{\vSl}{\vRl}
\newcommand{\vGamma}{\Gamma}
\newcommand{\bvCl}{\bCl}
\newcommand{\bvCt}{\bCt}
\newcommand{\bvRl}{\bRl}
\newcommand{\bvRt}{\bRt}
\newcommand{\bvSl}{\bRl}
\newcommand{\bvGamma}{\bGamma}
\newcommand{\Tr}{\mathsf{Tr}}

\DeclareMathOperator*{\Min}{min.}
\DeclareMathOperator*{\Inf}{inf.}

\newcommand{\indic}[1]{\mathbf{1}\!\left\{#1\right\}} % Indicator function
\newcommand{\<}{\langle} % Angle brackets
\renewcommand{\>}{\rangle}
\newcommand{\estnorm}[1]{\Vert#1\Vert_2}
\newcommand{\defeq}{:=}
\newcommand{\eqdef}{=:}

\definecolor{innerboxcolor}{rgb}{.9,.95,1}
\definecolor{outerlinecolor}{rgb}{.6,0,.2}
\definecolor{shcolor}{RGB}{27, 87, 14}
\definecolor{rckcolor}{RGB}{0,0,255}

\newcommand{\openright}[2]{\left[{#1},{#2}\right)}
\newcommand{\openleft}[2]{\left({#1},{#2}\right]}

\newcommand{\epsdeformed}{\epsilon_{\sigma,\textup{def}}}
\newcommand{\rhodeformed}{\rho_{\textup{def}}}
\newcommand{\rhools}{\rho_{\textup{ols}}}
\newcommand{\epsols}{\epsilon_{\sigma,\textup{ols}}}
\newcommand{\simiid}{\stackrel{\textup{iid}}{\sim}}

\newcommand{\thetaols}{\est{\theta}_{\mathsf{ols}}}
\newcommand{\Aols}{A_{\mathsf{ols}}}

\newcommand{\Hlin}{\mathcal{H}_{\textup{lin}}}
\newcommand{\Hsq}{\mathcal{H}_{\textup{sq}}}

\newcommand{\toP}{\xrightarrow{P}}

\newcommand{\txt}[1]{\textup{#1}}
\newcommand{\iid}{\overset{\text{i.i.d.}}{\sim}}

\newcommand{\rset}[1]{{#1}}
%\newcommand{\set}[1]{\mathcal{#1}}
\newcommand{\set}[1]{{#1}}

\newcommand{\ti}[1]{\tilde{#1}}
\newcommand{\wt}[1]{\widetilde{#1}}

% Misc
\newcommand{\dpsd}{d_{\textup{psd}}}
\newcommand{\colspace}{\mathsf{Col}}
\newcommand{\genpsd}{A}
\newcommand{\Partitions}{\mathscr{P}}
\newcommand{\partitionset}{S}  % The sets within the partition
\newcommand{\partition}{\mc{S}} % The random partition we choose

\newcommand{\hinge}[1]{\left({#1}\right)_+}  % Positive part
\newcommand{\hinges}[1]{({#1})_+}  % Small positive part

% Macros for this paper
\newcommand{\permtest}{\hyperref[algorithm:permtest]{\mathtt{PERMTEST}}}
\newcommand{\speartest}{\hyperref[algorithm:speartest]{\mathtt{MATCH}}}
\newcommand{\spearman}{\hyperref[algorithm:spearman-pvalue]{\mathtt{SPEARMAN}}}
\newcommand{\match}{\mathtt{LAP}}
\newcommand{\fisher}{\hyperref[algorithm:fisher]{\mathtt{FISHER}}}

\newcommand{\firstparam}{\theta_1}
\newcommand{\secondparam}{\theta_2}
\newcommand{\firstinit}{\theta_1^0}
\newcommand{\secondinit}{\theta_2^0}
\newcommand{\init}{\theta^0}
\newcommand{\firstP}{P_1}
\newcommand{\secondP}{P_2}

\newcommand{\mlpparam}{\theta_\txt{mlp}}
\newcommand{\blockparam}{\theta_\txt{block}}

\newcommand{\fmlp}{f_\txt{mlp}}
\newcommand{\flm}{f_\txt{LM}}

\newcommand{\gateproj}{G}
\newcommand{\upproj}{U}
\newcommand{\downproj}{D}
\newcommand{\act}{\sigma}

\newcommand{\Thetamlp}{\Theta_\txt{mlp}}
\newcommand{\Thetablock}{\Theta_\txt{block}}
\newcommand{\Thetalm}{\Theta_\txt{LM}}
\newcommand{\Thetain}{\Theta_\txt{in}}
\newcommand{\Thetaout}{\Theta_\txt{out}}
\newcommand{\Thetapre}{\Theta_\txt{attn}}
\newcommand{\Thetapost}{\Theta_\txt{post}}

\newcommand{\thetamlp}{\theta_\txt{mlp}}
\newcommand{\thetablock}{\theta_\txt{block}}
\newcommand{\thetalm}{\theta_\txt{LM}}
\newcommand{\thetain}{\theta_\txt{in}}
\newcommand{\thetaout}{\theta_\txt{out}}
\newcommand{\thetapre}{\theta_\txt{attn}}
\newcommand{\thetapost}{\theta_\txt{post}}

\newcommand{\fpre}{f_\txt{attn}}
\newcommand{\fpost}{f_\txt{post}}
\newcommand{\fin}{f_\txt{in}}
\newcommand{\fout}{f_\txt{out}}
\newcommand{\frest}{f_\txt{rest}}

\newcommand{\ltwo}{\phi_{\ell_2}}
% \newcommand{\csw}{\phi_\txt{CSU}}
% \newcommand{\csh}{\phi_\txt{CSH}}
\newcommand{\csw}{\phi_{U^{(\ell)}}}
\newcommand{\csh}{\phi_{H^{(\ell)}}}
\newcommand{\dcos}{\mathtt{cossim}}
\newcommand{\jsd}{\phi_\txt{JSD}}
\newcommand{\rob}{\phi_\txt{MATCH}}

\newcommand{\firstblock}{\theta_{\txt{block},1}}
\newcommand{\firstin}{\theta_{\txt{in},1}}
\newcommand{\firstout}{\theta_{\txt{out},1}}
\newcommand{\firstmlp}{\theta_{\txt{mlp},1}}
\newcommand{\firstpre}{\theta_{\txt{attn},1}}
\newcommand{\firstG}{G_1}
\newcommand{\firstU}{U_1}
\newcommand{\firstD}{D_1}
\newcommand{\firstA}{A_1}
\newcommand{\firstM}{W_1}
\newcommand{\secondblock}{\theta_{\txt{block},2}}
\newcommand{\secondin}{\theta_{\txt{in},2}}
\newcommand{\secondout}{\theta_{\txt{out},2}}
\newcommand{\secondmlp}{\theta_{\txt{mlp},2}}
\newcommand{\secondpre}{\theta_{\txt{attn},2}}
\newcommand{\secondG}{G_2}
\newcommand{\secondU}{U_2}
\newcommand{\secondD}{D_2}
\newcommand{\secondA}{A_2}
\newcommand{\secondM}{W_2}

\newcommand{\Ul}{U_\ell}
\newcommand{\Gl}{G_\ell}
\newcommand{\thetal}{\theta_\ell}
\newcommand{\prel}{\theta_{\txt{attn},\ell}}

\newcommand{\activation}[2]{X_{#1}^{(#2)}}
\newcommand{\hidden}[2]{H_{#1}^{(#2)}}
% \newcommand{\activation}[2]{X(#1)}

\newcommand{\constr}{\txt{constrained}}
\newcommand{\unconstr}{\txt{unconstrained}}