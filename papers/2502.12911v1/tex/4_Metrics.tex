

\section{Enhanced Schema Linking Metrics}
\label{sec: Enhanced Schema Linking Metrics}
In this section, we introduce enhanced schema linking metrics considering the missing of relevant elements during evaluation, thereby accurately assess the true performance of schema linking models.

For a query $q$ with predicted schema linking result $\widehat{\mS}_q$ and ground truth linking result $\mS^*_q$, Recall and Precision are two commonly used metreics~\citep{li2023resdsql,li2024codes,qu2024before}. Recall, $\mR(q) =\frac{|\widehat{\mS}_q \cap \mS^*_q|}{|\mS^*_q|}$,  measures the proportion of relevant elements correctly identified, specifically how many of the actual relevant elements in $\mS^*_q$ are found in $\widehat{\mS}_q$. Conversely, Precision, $\mP(q) = \frac{|\widehat{\mS}_q \cap \mS^*_q|}{|\widehat{\mS}_q|}$, assesses the accuracy of predictions by determining the proportion of elements predicted as relevant in $\widehat{\mS}_q$ that are indeed correct.

As illustrated in Figure~\ref{fig:motivation}, these metrics can yield high scores even in the missing of relevant elements. This underscores that they do not effectively address the issue of missing relevant elements, which can undermine the true accuracy of schema linking models.

To address the limitations of Recall and Precision, we firstly introduce a restricted element missing indicator to detect whether relevant elements are missing in the predicted schema linking result $\widehat{\mS}_q$, The formal definition is as follows:
\begin{equation} \label{equ: indicator function}
\bm{\mathbbm{1}}(q) = 
\begin{cases} 
1, & \text{if } \widehat{\mS}_q \cap \mS^*_q = \mS^*_q, \\
0, & \text{otherwise}.
\end{cases}\end{equation}
It takes a value of 1 when the predicted result $\widehat{\mS}_q$ contain all the elements in the ground truth $\mS^*_q$, meaning no relevant elements are missing. Conversely, it is set to 0 when there are any missing. Building on this missing indicator, we define enhanced Recall and Precision as follows:
\begin{equation} \label{equ: recall plus}
\mR^{\text{\textbf{+}}}(q) = \bm{\mathbbm{1}}(q)   \mR(q), \mP^{\text{\textbf{+}}}(q) = \bm{\mathbbm{1}}(q)  \mP(q).
\end{equation}
Such metrics strengthen the penalty for missing relevant elements, as schema linking results with missing are inherently incorrect for SQL generation. For simplicity, we use the harmonic mean of enhanced Recall and Precision, referred to as the enhanced F1 score, as the overall measure for evaluating schema linking results:
\begin{equation} \label{equ: traditional F1 for one question}
{\mF1}^{\text{\textbf{+}}}(q) =\frac{2 \mR^{\text{\textbf{+}}}(q) \mP^{\text{\textbf{+}}}(q)}{\mR^{\text{\textbf{+}}}(q) + \mP^{\text{\textbf{+}}}(q)}.
\end{equation}
This approach provides a comprehensive evaluation of both recall and precision while incorporating the critical aspect of missing elements.