

\section{Implementation Details.}\label{sec: Implementation Details}
We implemented the proposed KaSLA and baselines under the following settings: For top-$K$ used in the redundancy tolerance estimation of KaSLA, we set it to 30. For method using fine-tuned LLM, We utilized LoRA~\citep{hu2021lora} for parameter-efficient fine-tuning. The learning rate was initialized to $1e-4$ with a cosine decay, the batch size was set to 16, and the training epoch was 3. 





\section{Input formats}\label{section: Input formats for generation with LLMs}
We provided the input and output formats of the binary scoring function of KaSLA introduced in section~\ref{sec:Relevance Estimation} in Table~\ref{tb: Input formats for generation with LLMs}.




\begin{table*}[!h]
   \begin{center}
   \resizebox{\linewidth}{!}{
   \scalebox{1}{ 
   \begin{tabular}{c | c }
   \toprule
   Type &Input format\\
   \midrule
   Full schema & \makecell[l]{table department, columns = [ department$\_$id (int $|$ primary key$|$values: 1), name (text$|$values: State, Treasury),  ranking (int $|$ values: 1, 2)] \\ table head, columns = [ head$\_$id (int $|$ primary key $|$ values: 1), name (text $|$ values: Tiger Woods), age (real $|$ values: 67.0)] \\ table management, columns = [ department$\_$id ( int $|$ primary key $|$ values: 2), head$\_$id (int $|$ primary key $|$ values: 5), temporary$\_$acting (text $|$ values: Yes)] \\ foreign keys: management.head$\_$id = head.head$\_$id, management.department$\_$id = department.department$\_$id
} \\
   \midrule
   Question & How many heads of the departments are older than 56? Generate SQL to solve the above question and list the relevant columns in each table \\
   \midrule
   \midrule
   Type &Output format\\
   \midrule
   Simulated SQL & SELECT count($*$) FROM head WHERE age  >  56\\ 
   \midrule
   Schema linking results & "department": null, "management": null, "head": [ "age" ]\\
   \bottomrule
   \end{tabular}}}
   \caption{Input and output formats of the binary scoring model.}
   \label{tb: Input formats for generation with LLMs}
   \end{center}
   \end{table*}


\section{The Dynamic Programming Approach used in KaSLA}
We illustrate the details of the dynamic programming algorithm used in KaSLA in Algorithm~\ref{alg:Dynamic Programming-based 0-1 Knapsack Problem Optimization}.


\begin{algorithm}[!h]
\caption{Dynamic Programming-based 0-1 Knapsack Problem Optimization}
\label{alg:Dynamic Programming-based 0-1 Knapsack Problem Optimization}
    \KwIn{relevance score set $\gR$,  redundancy score set $\gW$, the upper redundancy tolerance $\gU$}
    \KwOut{selection set $\hat{\mathcal{H}}$}
        $n \gets |\gR|$, $\hat{\mathcal{H}} \gets \{\}$ \\
        $\mathcal{A} \gets \text{array of }(n+1) \times (\gU+1)$ \\
        $ \text{ initialized to } 0 $\\
        $ keep \gets \text{array of }(n+1) \times (\gU+1) $\\
        $\text{ initialized to } \text{False}$ \\
        \For{$i \gets 1$ \textbf{to} $n$}{
            \For{$w \gets 0$ \textbf{to} $\gU$}{
                \eIf{$\gW[i-1] \leq w$}{
                    \eIf{$(\gR[i-1] + \mathcal{A}[i-1][w-\gW[i-1]]) > \mathcal{A}[i-1][w]$}{
                        $\mathcal{A}[i][w] \gets \gR[i-1] + \mathcal{A}[i-1][w-\gW[i-1]]$ \\
                        $keep[i][w] \gets \text{True}$ 
                    }{
                        $\mathcal{A}[i][w] \gets \mathcal{A}[i-1][w]$ 
                    }
                }{
                    $\mathcal{A}[i][w] \gets \mathcal{A}[i-1][w]$
                }
            }
        }
        $k \gets \gU$ \
        \For{$i \gets n$ \textbf{downto} $1$}{
            \If{$keep[i][k]$}{
                    $\hat{\mathcal{H}}.\text{add}(i-1)$ \\
                    $k \gets k - \gW[i-1]$
                }
        }
        \Return{$\hat{\mathcal{H}}$}
\end{algorithm}


\section{Complexity Analysis} \label{sec: Complexity Analysis}
The efficiency of KaSLA stems from its hierarchical approach, dynamic programming and inherent parallelism. KaSLA's time complexity is determined by two main phases: table linking and column linking within the linked tables. For a database with \( n_t \) tables and a table capacity of \( C_t \), the table linking phase has a time complexity of \( O(n_t C_t) \). KaSLA then links columns within the selected table. Let \( n_c \) and \( C_c \) represent the number of columns and the column capacity of a selected table, respectively. The time complexity of the column linking phase is \( O(n_c C_c) \). Consequently, the total time complexity of KaSLA is \( O(n_t C_t + n_t(n_c C_c)) \), indicating that the complexity of KaSLA scales relevant with the database dimensions.


\section{The Ablation Studies for Different Language Models}
We present the ablation studies on the choice of language models for the probabilistic scoring model, as well as the performance scaling of various language models for the binary scoring model used in KaSLA. These studies are detailed in Table~\ref{tb: ablation study about the choice of language model.} and Table~\ref{tb: ablation study about the choice of LLMs.}, respectively.

   
\begin{table}[htbp]
   \begin{center}
   \resizebox{\linewidth}{!}{
   \scalebox{1}{
   \begin{tabular}{c |c c  c c  c }
   \toprule[1pt]
   Dataset & \makecell[c]{BERT\\-Base}  & \makecell[c]{BERT\\-Large}  &  \makecell[c]{RoBERTa\\-Base} &\makecell[c]{RoBERTa\\-Large} &\makecell[c]{SGPT\\-1.3B}\\
   \midrule
   BIRD-dev &59.12&59.52&59.65&\textbf{60.17}&59.97 \\
   \bottomrule[1pt]
   \end{tabular}}}
   \caption{Execution Accuracy (EX) (\%) of the scaling up performance about the choice of language model for binary scoring model.  We conduct the experiments for CodeS + KaSLA on BIRD-dev and use CodeS with CodeS-15B as the text-to-SQL backbone.}
	        \label{tb: ablation study about the choice of LLMs.}
   \end{center}
   \end{table}




\begin{table}[htbp]
   \begin{center}
   \resizebox{\linewidth}{!}{
   \scalebox{1}{
   \begin{tabular}{c |c c  c}
   \toprule[1pt]
   Dataset & \makecell[c]{Deepseek-coder \\-1.3B} & \makecell[c]{Deepseek-coder \\-6.5B}  & \makecell[c]{Deepseek-coder \\-7B}\\
   \midrule
   BIRD-dev &60.17&61.28&61.47\\
   \bottomrule[1pt]
   \end{tabular}}}
   \caption{Execution Accuracy (EX) (\%) of the ablation study about the choice of language model for probabilistic scoring model.  We conduct the experiments for CodeS + KaSLA on BIRD-dev and use CodeS with CodeS-15B as the text-to-SQL backbone.}
	        \label{tb: ablation study about the choice of language model.}
   \end{center}
   \end{table}
