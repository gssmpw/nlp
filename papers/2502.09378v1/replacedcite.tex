\section{Related Work}
\subsection{Forward-mapping modeling}
 
 Several approaches have been used for forward mapping modeling of flapping wing systems, that is, finding the aerodynamic forces resulting from a given wing motion. One direct method is measuring the aerodynamic forces on a scaled-up wing model flapping in a fluid and mimicking the motion of, for example, experimentally measured kinematics of an insect's wing ____. With proper scaling of the wing motion and fluid viscosity, the forces measured on the scaled-up model can be rescaled back to the corresponding insect forces.  
 Another method is Computational Fluid Dynamics (CFD), where the Navier-Stokes flow equation is numerically solved on a spatial grid and the aerodynamic forces on the wing are then calculated from the solved flow. While CFD has been instrumental in understanding the fluid dynamics of flapping wings ____, insect stability____, and complex fluid-structure interactions____, this class of methods is computationally intensive and, hence, impractical for inverse modeling in a real-time flight controller. 
 A dramatic simplification is offered by quasi-steady-state (QS) aerodynamic models, which approximate the aerodynamic force of a wing as a function of its instantaneous motion ____. For a specific wing geometry, QS models can be calibrated and tuned based on a scaled-up mechanical wing model  ____ or CFD simulations____. Because these models provide an analytical form of the aerodynamic force, they can, in principle, be inverted and used for real-time control. Yet, QS models neglect complex flow-related features, for example, wing vorticity, wing interaction with its previously generated flow, and fluid-structure interaction, which may be important for utilizing the full capabilities of FW-MAV.  

Deep learning models have been applied for problems in fluid dynamics, such as turbulence and flow control____, \tb{and for mitigating windy conditions and structural damage in quad-copter control ____. The impressive achievements in quad-copter control do not require significant inverse modeling due to the relatively simple mapping between desired forces and torques and rotor speed. This is markedly different than the complex aerodynamics of flapping wings.}
For a flapping wing, deep learning models enable capturing the complex forward mapping from wing motion to aerodynamic forces without simplifying assumptions. In this approach, a model is trained on a dataset of measured or calculated forces obtained from a scaled-up mechanical model or CFD, respectively, based on a set of predefined wing kinematics. A trained model can potentially predict these forces for given input kinematics and do so much faster than CFD models and potentially more accurately than QS models. The applicability of such a model depends, naturally, on the quality and breadth of the dataset it has been trained on.
In 2021, Bayiz and Cheng introduced a state-space deep learning approach that accurately predicted aerodynamic forces using data from a scaled-up mechanical wing ____. Their model, trained and tested with 548 diverse wing kinematics, demonstrated the predictability of aerodynamic forces based on a half-wingbeat look-back window of the previous wing kinematics. Here, we invert this dataset to model the system's inverse aerodynamics.

Beyond aerodynamics, forward mapping modeling applies to simulating diverse mechanical systems, such as humanoid robot motion ____. In these simulations, the state of the system encompasses generalized positions and velocities, governed by equations of motion incorporating inertia tensors, external forces, and control inputs. Using a semi-implicit Euler integration scheme enables the iterative calculation of the system's state based on applied actions. %This 

\subsection{Time Series Modeling and Fourier Analysis}

Time-series modeling has been fundamental across various disciplines, including climate modeling ____, biological sciences ____, and finance ____. Traditional methods such as auto-regressive and exponential smoothing rely on domain expertise ____, but modern machine learning techniques are increasingly adopted owing to their data-driven nature and scalability ____.
Recent architectures that use FFT (Fast Fourier Transform) include the following: 
AutoFormer features a distinct architecture: the encoder emphasizes modeling the data periodicity, while the decoder includes accumulation structures for trend-cyclical components and stacked auto-correlation mechanisms for periodic components. This mechanism replaces traditional self-attention methods and efficiently computes auto-correlation using FFT ____. Similarly, FedFormer introduces low-rank approximated transformation in the frequency domain to expedite attention mechanisms in time series forecasting ____. Adaptive Temporal-Frequency Networks utilize FFT to extract trend and periodic features for improved forecasting accuracy ____. StemGNN employs Graph Fourier Transform (GFT) and Fourier transform to capture inter-series correlations and temporal dependencies effectively ____. Notably, StemGNN automatized the learning of inter-series correlations from data, leveraging spectral representations for prediction.

In Fourier Neural Operator (FNO), a parameterized low-pass filter in Fourier space facilitates the learning of mappings from functional parametric dependencies to solutions, thus enabling the exploration of a broad family of partial differential equations ____. Additionally, the random Fourier method and random Fourier softmax (RF-softmax) technique offer efficient and accurate random sampling, exploiting frequency-space features ____.

The adaptive spectrum layer (ASL) reported here uses both the magnitude and phase of the Fourier spectra for representation learning, weighs frequency bins accordingly, and functions as a standalone representation layer. In contrast, other approaches often rely on FFT for efficient computation in Fourier space, as well as overlook the comprehensive information provided by the Fourier transform, or lack a gated weighing mechanism that considers all information from other frequency bins.