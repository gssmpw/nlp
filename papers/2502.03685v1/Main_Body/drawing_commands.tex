\newcommand{\DiscreteTokenVector}[4]{
    \begin{scope}[shift={#1}, scale=#3] % Scale the entire object
        \foreach \i in {0,...,#2} {
            \draw[thick, draw=#4] (0, \i*.5 + \i) rectangle (1, \i+1 + \i * .5);
        }
    \end{scope}
}



% Define a new command that takes four arguments:
% #1: Coordinates (x,y)
% #2: Base color
% #3: Number of squares
% #4: Scale factor for resizing the rectangles
\newcommand{\SingleDarkSquareStack}[4]{
    \begin{scope}[shift={#1}, scale=#4] % Scale the entire object
        % Randomly choose which square will be dark
        \pgfmathsetmacro{\darksquare}{int(random()*#3)}

        \foreach \i in {0,...,#3} {
            % If the current square is the dark one, make it 90% shade
            \ifnum\i=\darksquare
                \fill[#2!90] (\i, 0) rectangle (\i+1, 1);
            \else
                % Otherwise, make the square light (between 20% and 40% shade)
                \pgfmathsetmacro{\lightshade}{20+int(random()*20)}
                \fill[#2!\lightshade] (\i, 0) rectangle (\i+1, 1);
            \fi
            \draw[thick] (\i, 0) rectangle (\i+1, 1);
        }
    \end{scope}
}

\newcommand{\SingleDarkSquareStackVert}[4]{
    \begin{scope}[shift={#1}, scale=#4] % Scale the entire object
        % Randomly choose which square will be dark
        \pgfmathsetmacro{\darksquare}{int(random()*#3)}
        \foreach \i in {0,...,#3} {
            % If the current square is the dark one, make it 90% shade
            \ifnum\i=\darksquare
                \fill[#2!90] (0, \i) rectangle (1, \i + 1);
            \else
                % Otherwise, make the square light (between 20% and 40% shade)
                \pgfmathsetmacro{\lightshade}{20+int(random()*20)}
                \fill[#2!\lightshade] (0, \i) rectangle (1, \i + 1);
            \fi
            \draw[thick, rectangle] (0, \i) rectangle (1, \i+1);
        }
    \end{scope}
}
\newcommand{\distbetweenvecs}{2}
\newcommand{\SingleDarkSquareStackVertBiasSeq}[4]{
    \begin{scope}[shift={#1}, scale=#4] % Scale the entire object
        % Randomly choose which square will be dark
        \pgfmathsetmacro{\darksquare}{int(random()*#3)}
        \foreach \i in {0,...,#3} {
            % If the current square is the dark one, make it 90% shade
            \ifnum\i=\darksquare
                \fill[#2!90] (0, \i) rectangle (1, \i + 1);
            \else
                % Otherwise, make the square light (between 20% and 40% shade)
                \pgfmathsetmacro{\lightshade}{5}
                \fill[#2!\lightshade] (0, \i) rectangle (1, \i +1);
            \fi
            \draw[thick, rectangle] (0, \i) rectangle (1, \i+1);
        }
    \end{scope}
}

% Command for a sequence of logits with words
\newcommand{\LogitsWithWords}[3]{% #1: Starting point, #2: List of words, #3: Scale factor
    \begin{scope}[shift={#1}]
        \foreach [count=\i from 0] \word in {#2} {
            \SingleDarkSquareStackVert{(\i*1.2, 0)}{red}{4}{#3}
            \node[below=0.2cm] at (\i*1.2+.2, 0) {\word};
        }
    \end{scope}
}


% Command for a sequence of logits with words
\newcommand{\LogitsWithNoWords}[3]{% #1: Starting point, #2: List of words, #3: Scale factor
    \begin{scope}[shift={#1}]
        \foreach [count=\i from 0] \word in {#2} {
            \SingleDarkSquareStackVert{(\i*\distbetweenvecs, 0)}{red}{4}{#3};
        }
    \end{scope}
}

% Command for a sequence of logits with words
\newcommand{\LogitsWithNoWordsBias}[3]{% #1: Starting point, #2: List of words, #3: Scale factor
    \begin{scope}[shift={#1}]
        \foreach [count=\i from 0] \word in {#2} {
            \SingleDarkSquareStackVertBiasSeq{(\i*\distbetweenvecs, 0)}{blue}{4}{#3};
        }
    \end{scope}
}

% #1: Starting coordinates (x,y) for the stacks
% #2: Base color for the stacks
% #3: Number of squares per stack
% #4: Scale factor for resizing the rectangles
% #5: Number of stacks to draw
\newcommand{\LogitVectors}[7]{
    \foreach \i in {0,...,#5}{
        % Correct referencing of coordinates for shift
        % Ensure proper vertical stacking by incrementing the y-coordinate only
        \SingleDarkSquareStack{( #6, #7 + \i * #4)}{#2}{#3}{#4}
    }
}

\newcommand{\LogitVectorsHorizontal}[7]{
    \foreach \i in {0,...,#5}{
        % Correct referencing of coordinates for shift
        % Ensure proper vertical stacking by incrementing the y-coordinate only
        \SingleDarkSquareStack{( #6+ \i * #4, #7)}{#2}{#3}{#4}
    }
}

% Define a command to draw an arrow
% #1: Starting coordinates (x1, y1)
% #2: Ending coordinates (x2, y2)
\newcommand{\DrawArrow}[2]{
    \draw[->, thick] #1 -- #2;
}