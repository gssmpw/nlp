\usepackage{url}  %
\usepackage{booktabs}
\usepackage{array}
\usepackage{graphicx}
\usepackage[singlelinecheck=false, justification=centering]{caption}

\usepackage{tikz}
\usepackage{amsmath}

\usepackage{multirow}
\usepackage{multicol}

\usepackage[linesnumbered, ruled]{algorithm2e}
\SetKwFor{For}{for}{do}{}
\SetKwFor{ForEach}{foreach}{do}{}
\SetKwIF{If}{ElseIf}{Else}{if}{}{elif}{else}{}
\SetKwFor{While}{while}{do}{}
\SetKwRepeat{Repeat}{repeat}{until}
\SetKwInput{Input}{Input}
\SetKwInput{Output}{Output}
\SetKwRepeat{Do}{do}{while}
\SetKw{Continue}{continue}



\newcommand{\spR}[1]{\mathbb{R}^{#1}}
\newcommand{\spRm}[2]{\spR{#1 \times #2}}
\newcommand{\set}[1]{\mathcal{#1}}

\newcommand{\ie}[0]{i.e.\xspace}
\newcommand{\eg}[0]{e.g.\xspace}
\newcommand{\etal}[0]{et al.\xspace}
\newcommand{\etc}[0]{etc.\xspace}
\newcommand{\wrt}[0]{w.r.t.\xspace}

\newcommand{\refsec}[1]{\S~\ref{#1}}
\newcommand{\reffig}[2][]{Figure~\ref{#2}\ifthenelse{\equal{#1}{}}{}{#1}} 
\newcommand{\reftab}[1]{Table~\ref{#1}}
\newcommand{\refalgo}[1]{Algorithm~\ref{#1}}
\newcommand{\refeq}[1]{Equation~\ref{#1}}

\usepackage{enumitem}
\newenvironment{niceritemize}{%
    \begin{itemize}[left=2pt, topsep=3pt, partopsep=0pt, parsep=0pt, itemsep=2pt]
}{%
    \end{itemize}
}

\usepackage{xspace}
\usepackage{amsmath}
\newcommand{\xxx}[0]{\textsc{Hecate}\xspace}
\newcommand{\yyy}[0]{FSSDP\xspace}
\newcommand{\YYY}[0]{Fully Sharded Sparse Data Parallelism\xspace}

\newcommand{\matop}[4]{\mathop{\texttt{Mat}}(#1, #2, #3, #4)}  %
\newcommand{\dematop}[1]{\mathop{\texttt{Demat}}(#1)}

\newcommand{\coll}[1]{\texttt{#1}\xspace}
\newcommand{\collar}[0]{\coll{AllReduce}}
\newcommand{\collatoa}[0]{\coll{All-to-All}}
\newcommand{\collbc}[0]{\coll{Broadcast}}
\newcommand{\collrd}[0]{\coll{Reduce}}
\newcommand{\collag}[0]{\coll{AllGather}}
\newcommand{\collrs}[0]{\coll{ReduceScatter}}
\newcommand{\collsag}[0]{\coll{SparseAllGather}}
\newcommand{\collsrs}[0]{\coll{SparseReduceScatter}}

\newcommand{\algbw}[0]{\text{algbw}}
\newcommand{\bw}[0]{\text{bw}}


\newcommand{\collsagop}[2]{\mbox{\texttt{spAG(}$#1$, $#2$\texttt{)}}}
\newcommand{\collsrsop}[2]{\mbox{\texttt{spRS(}$#1$, $#2$\texttt{)}}}

\newcommand{\gset}[1]{\set{#1}^\text{g}}

\newcommand{\setE}[0]{\mathcal{E}}
\newcommand{\setW}[0]{\mathcal{W}}
\newcommand{\setN}[0]{\mathcal{N}}
\newcommand{\setP}[0]{\mathcal{P}}

\newcommand{\toksiz}[0]{\text{token\_bsize}}
\newcommand{\dtsiz}[0]{\text{data\_bsize}}
\newcommand{\commbw}[0]{\text{bw}}
\newcommand{\mathbw}[0]{\text{flops}}
\newcommand{\syncbw}[0]{\text{sync\_bw}}

\newcommand{\atazero}[0]{\text{dispatch}}
\newcommand{\ataone}[0]{\text{collect}}

\newcommand{\opsg}{\operatorname{spG}}
\newcommand{\opsrs}{\operatorname{spRS}}

\newcommand{\imbalanceSlowdown}{5.18$\times$\xspace}
\newcommand{\memorySlowdown}{164.6\%\xspace}
\newcommand{\memorySpeedup}{2.65x\xspace}
\newcommand{\timelinessSpeedup}{2.9\%\xspace}
\newcommand{\timelinessSlowdown}{10.2\%\xspace}
