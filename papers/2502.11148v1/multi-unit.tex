%\src{To write that everything here is for Single-minded, identical items, unknown bundle sizes.}
We begin with the setting of multi-unit auctions. A multi-unit auction comprises of $m$ \emph{identical} items, where the valuation of every player $i$ is given by $v_i:[m]\to \mathbb R^{+}$. 
We consider two classes of valuations: unknown single-minded bidders (\cref{subsec::mua-sm}) and bidders whose valuations exhibit decreasing marginal values (\cref{subsec::mua-decreasing}). 




\subsection{Single-Minded Valuations} \label{subsec::mua-sm}
In this section, we address two types of single-minded bidders: known and unknown. We begin with some definitions and then provide background on each.  

A valuation $v_i$ is \emph{single-minded} if there is a scalar $x_i$ and a quantity $d_i$ such that $v_i(q)=x_i$
if $q\ge d_i$, and otherwise $v_i(q)=0$.
In particular, we investigate the setting of \emph{unknown single-minded bidders}, where both the demand $d_i$ and the value $x_i$ of every player $i$ are private information (if only $x_i$ is private, then it is a setting with \emph{known single-minded bidders}).


For deterministic obviously strategy-proof mechanisms, the class of  known single-minded bidders admit strategy-proof mechanisms that give ${\mathcal O}(\min\{\log m,\log n\})$ approximation to the welfare \cite{DGR14,CGS22}, and no mechanism  gives an approximation better than $\Omega(\sqrt{\log n})$ of the welfare \cite{FPV21}.  For unknown single-minded bidders, \cite{Ron24} has shown a tight lower bound of $\min\{m,n\}$. 

We note that our proposed mechanisms (both the first attempt in \cref{subsub::first-attempt} and the actual one in \cref{subsub::actual-ub-mua-sm}) are for both unknown and known obviously strategy-proof mechanisms, whilst the impossibility that we provide in \cref{subsec-lbs-22-sm-mua} holds solely for unknown single-minded bidders. We leave open the question of understanding the approximation power of randomized obviously strategy-proof mechanisms for known single-minded bidders.  



% We first consider the case of \emph{unknown single-minded bidders}, where each bidder $i$ receives value $v_i$ for receiving at least $d_i$ items and $0$ otherwise.\footnote{This setting is commonly known as unknown single-minded bidders, since both the demand $d_i$ and the value $v_i$ of every player $i$ are private.} 

\subsubsection{Upper Bound: a First Attempt}\label{subsub::first-attempt}
Since an ascending-price auction for the grand bundle of goods is the optimal deterministic OSP mechanism in this setting \cite{Ron24}, we begin with a natural randomized analogue of this approach.  Namely, we ``guess'' a bundle size and run an ascending price auction for bundles of this size.  

Formally,
%\src{Not sure whether it should be that formal, or that a non-formal intuition in the introduction suffices}
%Let $m$ denote the number of items and $n$ denote the number of agents.  
let $k = \lceil \log{m} \rceil$.  Consider the mechanism \textsc{Random-Bundles} in which 
an integer bundle size $\ell =2^{j}$ is sampled uniformly at random from the set of powers of two $\ell \in \{1,2,4,8,\dots,\frac{m}{2}, m\}$. Given this fixed bundle size, every bidder either wins exactly $\ell$ items or wins no items at all.  Observe, then, that at most $\nicefrac{m}{\ell}$ bidders can win a bundle. We now increase the price of being served $\ell$ items, until at most $\nicefrac{m}{\ell}$ bidders remain. All these bidders win $\ell$ items and pay the price at which we stop, while the remainder get nothing and pay nothing.
Note that \textsc{Random-Bundles} is a generalized ascending auction, so by \cref{lemma-partial} it is OSP.

% \begin{theorem}
%     \dnote{\textsc{Random-Bundles}} is universally OSP.
% \end{theorem}
% \begin{proof}
%     Fix an arbitrary bundle size $\ell$ selected by the mechanism.  We will argue that the mechanism is OSP for this fixed realization and, hence, is universally OSP.  Observe that once the bundle sizes are fixed, bidder $i$ can evaluate her value for receiving a bundle by comparing its size to her demand.  If any fixed bundle has size exceeding her demand, she will be satisfied by any bundle and the inverse is also true.  Ergo, remaining in the auction while the uniform asking price is less than or equal to her private value for receiving an arbitrary bundle and exiting as soon as the price exceeds this value is an obviously dominant strategy.
% \end{proof}

We now argue that this mechanism obtains a logarithmic approximation to the optimal social welfare.  Due to space constraints, we provide a proof sketch of the approximation guarantee and defer the complete proof 
% to the full version.
%full-version-change-tag%
\cref{app-missing-mua}.

\begin{theorem}\label{claim:ascending-bundles-approx}
{\textsc{Random-Bundles}} obtains an $\mathcal O(\log{m})$ approximation to the optimal social welfare.
\end{theorem}
\begin{proof}[Proof Sketch]
First, observe that we can partition bidders into groups depending on their demand as follows:  for each bidder $i$, we place bidder $i$ in group $p$ if her demand  $d_i$ is between $2^{p}$ and $2^{p+1}-1$.
%(inclusive).  
Since each bidder has demand at least $1$ and at most $m$, there are at most $\log{m}$ groups in total.  

Now, we  compare the portion of the optimal social welfare coming from bidders in group $p$ against the welfare \textsc{Random-Bundles} obtains when
%\pinksout{conditioned on it}
 selecting bundles of size $2^{p+1}$.  On one hand, the optimal solution selects at most twice as many bidders appearing in group $p$ as the total number of bidders \textsc{Random-Bundles} serves conditioned on it selecting bundles of size $2^{p+1}$.  On the other hand, the bidders served in \textsc{Random-Bundles} conditioned on selecting bundles of size $2^{p+1}$ have the \emph{highest} value among bidders satisfied by receiving $2^{p+1}$ goods.  In total, we obtain an $\mathcal O(\log{m})$-approximation.
\end{proof}

\subsubsection{A Constant Upper Bound }\label{subsub::actual-ub-mua-sm}
Unfortunately, an approximation of $\mathcal O(\log m)$ appears to be the best achievable using the approach of randomly choosing fixed bundle sizes.  As such, we need to turn to a different approach.  We, thus, adopt the ``balanced sampling'' approach utilized extensively in other areas of mechanism design (see, e.g., \cite{feige2005competitive,goldberg2006competitive,dobzinski2012truthful,dobzinski2007two,badanidiyuru2012learning,bei2017worst})  in the form of Mechanism \ref{alg:single-minded},  below:

\begin{theorem}\label{thm-ub-mua-sm}
        There is a universally OSP mechanism for unknown single-minded bidders in a multi-unit auction  that gives a $400$-approximation to the optimal welfare.
\end{theorem}
We prove \cref{thm-ub-mua-sm} by describing a randomized mechanism, i.e., Mechanism \ref{alg:single-minded}, and showing it is universally OSP (\cref{claim-mua-sm-mechanism-osp}) and indeed gives a $400$-approximation to the optimal social welfare (\cref{lem:single-minded-approx}). 


\begin{algorithm2e}
%\setstretch{1.1}
\SetKwInOut{Input}{Input}
\Input{A set of bidders $\bidders$ and $m$ identical items}
 With probability $\nicefrac{1}{2}$: 

 \quad Bundle all $m$ items together and run an ascending price auction on the grand bundle

 With remaining probability $\nicefrac{1}{2}$:

 \quad Let $S \leftarrow \emptyset$, $U \leftarrow \emptyset$
 
 \quad Place each bidder independently in $S$ w.p. $\nicefrac{1}{2}$ and each bidder in $U$ with the remaining probability

 \quad ``Discard'' each bidder and $S$ and learn their valuation function

 \quad Compute the optimal solution among bidders only in $S$ and let $O$ denote the value of this solution

 % \quad Set a price of $\nicefrac{O}{10m}$ for each of the $m$ goods

\quad  Iterate over the bidders (in an arbitrary) order, and for each bidder $i \in \bidders$, let them purchase their preferred bundle from the remaining items at a price of $\nicefrac{O}{10m}$ per item
 
 % \quad Let each bidder in $U$ purchase their preferred (possibly empty) bundle at current prices
 
 \caption{``\textsc{Single-Minded}''}
 \label{alg:single-minded}
\end{algorithm2e}


\begin{lemma}\label{claim-mua-sm-mechanism-osp}
    Mechanism \ref{alg:single-minded} is universally OSP.
\end{lemma}
\begin{proof}
Under the realization of randomness where we auction the grand bundle, we utilize a generalized ascending auction for the grand bundle which is OSP by \cref{lemma-partial}.  
If we run the uniform pricing auction, then no bidder in $S$ can win any items and, thus, reporting their valuations truthfully is an obviously dominant strategy. Bidders in $U$ select their preferred bundle of goods, so reporting their preferences truthfully is also an obviously dominant strategy for them.
% the auction is OSP for them as well.
\end{proof}

% \begin{theorem}
%     $\mathcal{M}_5$ obtains a $\Omega(1)$-approximation (specifically a $1/200$-approximation) to the optimal social welfare.
% \end{theorem}

To prove the approximation factor of Mechanism \ref{alg:single-minded}, 
we define a bidder as \emph{critical} if her value for the grand bundle of goods is at least $\nicefrac{1}{100}$ of the total optimal social welfare. We also use the notation $OPT$ to denote the optimal social welfare for a given valuation profile $(v_1, \ldots, v_n)$ and define $OPT(S)$ as the optimal social welfare attainable by allocating all items exclusively among the bidders in a specified subset $S \subseteq N$.
% where $S$ is a subset of bidders $S\subseteq \bidders$,
% to denote the optimal welfare achieved by allocating all items exclusively among the bidders in $S$.

\cref{lem:auction-sampling} establishes that the sampling phase yields 
\textquote{representative}
%``accurate'' 
sampled and unsampled sets in the case that there are no critical bidders with \textquote{high enough} probability. Note that the proof utilizes a lemma of \cite{bei2017worst}. %regarding partitions of sets and subadditive functions.  
We defer the proof of \cref{lem:auction-sampling}  to 
% the full version.
% full-version-change-tag%
\cref{subsec::proof-auction-sampling}. 

\begin{lemma}\label{lem:auction-sampling}
Consider an instance $(v_1,\ldots,v_n)$ of bidders
in a multi-unit auction\footnote{
Our lemma actually holds also for bidders in a combinatorial auctions,  
%more general valuations
%Our lemma actually holds also for more general valuations, 
but for simplicity we state it solely for multi-unit auctions.} where no bidder is critical.  Suppose each bidder is placed in a ``sampled'' set $S$ with probability $\nicefrac 1 2$ and placed in an ``unsampled'' set $U$ with the remaining probability independently. Then the optimal welfare obtained from bidders in the sampled set $\text{OPT}(S)$ and the optimal welfare obtained from bidders in the unsampled set $\text{OPT}(U)$ are such that $\text{OPT}(S) \geq \nicefrac{\text{OPT}}{5}$ and $\text{OPT}(U) \geq \nicefrac{\text{OPT}}{5}$ with probability at least $\nicefrac{1}{2}$.
\end{lemma}

With Lemma \ref{lem:auction-sampling} in hand, we are ready to prove that: 
% our main theorem for this class of valuation functions.  

\begin{lemma}\label{lem:single-minded-approx}
Mechanism \ref{alg:single-minded} obtains 
a $400$-approximation
to the optimal social welfare.
\end{lemma}
\begin{proof}
First we handle the case that there is a critical bidder, i.e., 
a bidder whose value for the grand bundle is at least $\nicefrac{OPT}{100}$. 
The existence of a critical bidder $i$ implies that allocating $i$ the grand bundle gives a $\nicefrac{1}{100}$-approximation to the optimal welfare.  Since we run an ascending auction on the grand bundle with probability $\nicefrac{1}{2}$ we obtain a $\nicefrac{1}{200}$-approximation  
in this case.


We now turn to the case that there does not exist a critical bidder.
%, i.e., all bidders contribute relatively little to the optimal solution.  
In this case, Lemma \ref{lem:auction-sampling} implies that with probability $\nicefrac{1}{2}$ over the random sampling of bidders,
the optimal welfare achievable by the sampled set is within a factor $5$ of the optimal welfare.
%and the optimal welfare achievable by the unsampled set is within a factor $5$ of the optimal welfare.
As such when we proceed to the pricing phase, we set a price per item $p \in [\nicefrac{\text{OPT}}{50m}, \nicefrac{\text{OPT}}{10m}]$. Since we run a uniform price auction with probability $\nicefrac{1}{2}$, these conditions hold simultaneously with probability at least $\nicefrac{1}{4}$.
We perform case analysis on the number of items sold during this phase. 
%\shirinote{If I understand you correctly, only the sampled set affects $p$. So I don't understand why the following phrase is relevant at this point -  "and the optimal welfare achievable by the unsampled set is within a factor $5$ of the optimal welfare."} \note{We'll need both to be accurate later to ensure that we don't have ``nothing left'', i.e., there is a lot of welfare for us to collect in the demand query phase.  But, yes, at this point the only relevant piece is that the sampled set is reasonably close to OPT.} \shirinote{Yep, my point was that it should be said later :)}

Suppose the uniform pricing phase sells at least $\nicefrac{m}{2}$ goods.  In this case, since an unsampled bidder buying $t$ goods spends at least $\frac{t\text{OPT}}{50m}$, their value for the purchased bundle is at least $\frac{t\text{OPT}}{50m}$.  
Then, the total value of all bidders who purchase goods is at least $\frac{m}{2}\cdot\frac{\text{OPT}}{50m} = \frac{\text{OPT}}{100}$. Altogether, since we run uniform sampling with probability $\nicefrac{1}{2}$ and the estimation is
\textquote{good} with probability $\nicefrac{1}{2}$, we obtain  a $400$-approximation to the welfare.

% Now suppose the uniform pricing phase sells fewer than $m/2$ goods.  In this case, observe that any bidder who wanted strictly more goods than were available when they were approached to make a demand query wanted to purchase strictly more than $m/2$ goods at a price of at least $\frac{\text{OPT}}{50m}$ and thus had a value of at least $\frac{\text{OPT}}{100}$.  Since we assume, however, that there are no critical bidders, it must be that all bidders had enough items available to satiate them when they were asked to purchase their demand set.  
% Note, however, that even if we sold the entire grand bundle of items to bidders who purchased no items, they would, in total, produce welfare at most $\frac{\text{OPT}}{50}$ (since we would allocate at most $m$ goods at average values less than $\frac{\text{OPT}}{50m}$ each).  As such, the portion of the optimal value we lost from setting prices too high was at most $\frac{\text{OPT}}{50}$.  However, we assumed that the total optimal welfare within the ``unsampled'' set was at least $\frac{\text{OPT}}{5}$ and as such, the bidders who did purchase goods must have total value at least $\frac{\text{OPT}}{5} - \frac{\text{OPT}}{50} \geq \frac{\text{OPT}}{10}$.  In either case, we obtain welfare at least $\frac{\text{OPT}}{100}$ if we run the uniform pricing auction when there does not exist a critical bidder.  Since we run this auction with probability $1/2$, we thus obtain a $1/200$-approximation to the optimal welfare in the case that there does not exist a critical bidder.  As such, we may conclude by observing that our auction obtains a $1/200$-approximation to the optimal welfare whether a critical bidder exists or not, completing the proof.

% \src{I'm rewriting the end of the proof starting from "Now suppose" to better understand it.}

Now, we analyze the complementary case 
%the more challenging case that 
where the uniform pricing phase sells fewer than $\nicefrac{m}{2}$ goods. For that, let $\vec{q}=(q_1,\dots,q_n)$ be the optimal allocation if the items are divided only among the bidders in $U$ (clearly, every bidder not in $U$ is allocated zero items).  
%\sre{TODO - specify at the beginning of the phrase that a bidder might not be allocated for two reasons: being blocked or having too small value compared to the price. "We define two kinds of bidders" does not capture that well enough, I think, and I think that it will be clearer to say that in the beginning and not in the end.}

For that, observe that if  a bidder is allocated in $\vec q$ but not allocated in the allocation of the algorithm, it necessarily happens because of one of the following reasons. The first possibility is that the bidder is \emph{blocked}, meaning that   the number of items that she wants $d_i$ is not available when it is her turn. The other reason is that the bidder is \emph{small}, meaning that  $v_i(d_i)\le p\cdot d_i$, i.e., 
$d_i$ items are available  but
the 
%\pinksout{uniform} 
price set is too high for her. 
% Now, we define two kinds of bidders that are allocated in $\vec{q}$ but not allocated in the allocation of the algorithm. Bidder $j\in U$ is \emph{blocked} if the number of items that she wants is not available when it is her turn. Bidder $j\in U$ is \emph{small} if $v_i(q_i)\le p\cdot q_i$, i.e. the 
%\pinksout{uniform} 
% price is too high for her. 
Note that every bidder $i$ that 
is neither blocked nor small, is also satisfied in the algorithm.  

We will bound the loss of welfare from both kinds of bidders conditioned on our assumptions
of running a uniform price auction and having a ``balanced''  sampling  (i.e., both $OPT(S) \geq OPT/5$ and $OPT(U) \geq OPT/5$).
% which, by \cref{lem:auction-sampling} occurs with probability at least $\nicefrac{1}{4}$.
First, we show that blocked bidders do not exist, so they do not cause any loss of welfare. 
%we do not lose any welfare from not allocating to them:
For that, we remind that by assumption the uniform phase sells less than $\frac
m 2$ items. Thus, a  blocked bidder wants to 
%Any bidder who wanted strictly more goods than were available when they were approached to make a demand query wanted to 
purchase strictly more than $\frac m 2
$ goods at a price of at least $\frac{\text{OPT}}{50m}$ and thus has a value of at least $\frac{\text{OPT}}{100}$, meaning that she is critical.  By assumption, there are no critical bidders, which implies that there are no blocked bidders, so they incur no loss of welfare.

We will now bound the welfare that comes from small bidders in $\vec q$. Note that the price $p$ that we set per item is at most $\nicefrac{OPT}{10m}$ and that the number of items allocated to small bidders in $\vec q$ is at most $m$. Since by definition $v_i(d_i)\le p\cdot d_i$, those bidders contribute to the welfare of $\vec q$ at most
% the welfare of all those bidders together is at most 
$\frac{OPT}{10}$. 
% observe the definition of small bidders combined with the fact that  the sum of items allocated to small bidders in $\vec q$ is at most $m$ and that $p$
% since , we have that their total welfare in the  allocation $\vec q$ is at most $\frac{OPT}{10}$. 
Since the welfare of $\vec{q}$ is at least $\frac{OPT}{5}$,  bidders who are neither blocked or small contribute at least $\frac{OPT}{10}$ to the welfare of $\vec q$. Since 
Mechanism \ref{alg:single-minded} allocates to these bidders their desired  number of items, it achieves welfare of at least $\frac{OPT}{10}$. 
As we said before, this 
% happens with probability $\frac{1}{4}$,
depends on finding a \textquote{good} partition of $U,S$ and running a uniform price auction which occurs in probability $\nicefrac{1}{4}$, 
so overall the expected welfare of the mechanism in this case is at least $\frac{OPT}{40}$. 

Combining all cases, we conclude that the expected welfare of Mechanism \ref{alg:single-minded} is at least $\frac{OPT}{400}$, thereby completing the proof.
\end{proof}
% {Before describing the lower bound for bidders with single-minded valuations,} 
We note that
Mechanism \ref{alg:single-minded} also achieves a constant-approximation for bidders with 
% the case that bidders have  
{decreasing marginal valuations}. We discuss this in greater detail in \cref{subsec::mua-decreasing}.

% I.e., in the case that each bidder $i$ has a concave, monotone valuation function $v_i : \mathbb{N} \rightarrow \mathbb{R}^{\geq 0}$ over all possible \emph{quantities} of items she could receive, Mechanism \ref{alg:single-minded} gives a constant approximation.  


\subsubsection{Lower Bound}\label{subsec-lbs-22-sm-mua}
\input{lower-2items-2bidders}

\subsection{Decreasing Marginal Valuations}\label{subsec::mua-decreasing}
In this section, we consider valuations that exhibit decreasing marginals. 
A valuation $v:[m]\to \mathbb R$  has decreasing marginals if  for every quantity $j\in [m]$, $v(j)-v(j-1)\ge v(j+1)-v(j)$. 
This is the only class of multi-parameter valuations for which the power of deterministic obviously strategy-proof mechanisms is not yet understood: 
% We note that for deterministic obviously strategy-proof mechanisms, 
the best-to-date mechanism achieves an $\mathcal O(\log n)$ approximation, and no mechanism for two bidders and two items obtains approximation better than $\sqrt 2$ \cite{GMR17}. We begin by showing that if we allow randomization:
\begin{theorem}\label{thm:decreasing-marginals}
There exists a randomized obviously strategy-proof mechanism that achieves a $400$\allowbreak-approximation to the optimal social welfare for bidders with decreasing marginal valuations.
\end{theorem}
We note that the mechanism described in the proof of \cref{thm:decreasing-marginals} corresponds to Mechanism \ref{alg:single-minded}, which was previously introduced for the class of single-minded bidders. The proof of \cref{thm:decreasing-marginals} is deferred to \cref{subsec::proof--dec-mua}.

Having established a constant-factor randomized obviously strategy-proof mechanism for decreasing marginal valuations, a natural question arises: is this result tight? Specifically, can we establish impossibility results for this class? To further deepen our understanding of this class of valuations, we now describe a phenomenon that highlights the challenges in proving such impossibilities.

\subsubsection{A Non-Monotonicity Effect for Bidders with Decreasing Marginal Values}\label{subsub::non-mono}
In this section, we describe a non-monotonicity phenomenon that occurs for obviously strategy-proof mechanisms in multi-unit auction with decreasing marginal valuations.  In contrast to the rest of the paper, we focus on deterministic mechanisms rather than randomized ones. 
% Currently, this is the only multi-parameter setting for which we do not know the exact approximation ratio of deterministic obviously strategy-proof mechanisms \cite{Ron24,GMR17}.\footnote{There is an obviously strategy-proof mechanism that gives $O(\log n)$ approximation, and no deterministic mechanism gives approximation better than $\sqrt 2$ \cite{GMR17}.} 
The phenomenon is that    \emph{deterministic} obviously strategy-proof mechanisms for bidders with decreasing marginal valuations, 
 adding an item improves the approximation power:
\begin{theorem}\label{thm-lb-mua-dec}
    For $2$ bidders and $2$ items, no obviously strategy-proof \emph{deterministic} mechanism that satisfies individual rationality and no negative transfers gives approximation better than $2$.  
\end{theorem}

\begin{lemma}\label{lemma:mono-mua-dec}
        For $2$ bidders and $3$ items, there is an obviously strategy-proof 
\emph{deterministic} mechanism that gives an approximation of  $1.5$.
\end{lemma}


Observe that this is not typical, as the approximation guarantee of mechanisms typically deteriorates as the number of items increases: intuitively, the more items there are, the \textquote{harder} it becomes to allocate them optimally. From a more formal perspective, impossibility results for auctions with $m$ items can be extended to those with $m+1$ items by introducing a \textquote{dummy} item that no bidder values. However, for the class of valuations with decreasing marginals, the additional item enables a new mechanism: we can now 
 allocate one item to each bidder and then run an ascending auction on the remaining item. 

% However, when considering \emph{deterministic} obviously strategy-proof mechanisms for the bidders that have valuations with decreasing marginals, adding an item improves the approximation power:

Note that the previously known lower bound on deterministic obviously strategy-proof mechanisms is $\sqrt 2$ \cite{GMR17}.\footnote{Note that \cite{GMR17} actually prove an impossibility for all mechanisms that are weakly group strategy-proof. This implies an impossibility for obviously strategy-proof mechanisms because as \cite{li} shows, every obviously strategy-proof mechanism is weakly group strategy-proof.} However, in contrast to \cite{GMR17}, \cref{thm-lb-mua-dec} applies solely to mechanisms that satisfy individual rationality and no negative transfers.   
The proofs  of \cref{thm-lb-mua-dec} and \cref{lemma:mono-mua-dec} can be found in \cref{subsec-lb-proof-mua-dec,sec-impos-mua-dec}.  

 % The proof can be found in  
