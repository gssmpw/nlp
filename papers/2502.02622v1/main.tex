%% hEART template for summary and short paper
%% Original author unkown
%% v1.1 by schererp@ethz.ch
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt,a4paper]{article}
\usepackage[T1]{fontenc}

%% Page format
\usepackage[a4paper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
 
%% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{eurosym}
\usepackage{amssymb}
 
\usepackage{eurosym}
\usepackage{textcomp}
\usepackage{ulem}
\usepackage{subcaption}
\usepackage[utf8]{inputenc}
\usepackage{pgfplots}
\usepackage{xurl}
\usepackage{bm}
\usepackage{bbm}

%% APA referencing
\usepackage{apacite}
\usepackage{natbib}
\def\bibfont{\small}
\bibliographystyle{apacite}

%% Title page formating
\usepackage[affil-it]{authblk}
\renewcommand\Authfont{\fontsize{12pt}{14.4pt}\selectfont}
\renewcommand\Affilfont{\fontsize{10pt}{10.8pt}\selectfont}

%% Format headings and minor headings
\setcounter{secnumdepth}{1}
\makeatletter
\renewcommand{\section}{\@startsection {section}{1}{\z@}%
              {24pt}{12pt} {\large\scshape\bfseries}}
           %%{-3.5ex \@plus -1ex \@minus -.2ex}%
           %%{2.3ex \@plus .2ex}%

\renewcommand{\subsection}{\@startsection {subsection}{2}{\z@}%
             {12pt}{12pt}  {\itshape\bfseries}}

%% Paragraph no-indent
\setlength{\parindent}{0pt}


%%%%%%%%%%%%%%%% START WRITING HERE %%%%%%%%%%%%%%%%%%%%
\title{\bfseries \normalsize Backcasting the Optimal Decisions in Transport Systems: An Example with Electric Vehicle Purchase Incentives}

\author{Dr. Vinith Lakshmanan*, Xavier Guichet, and Antonio Sciarretta}
%\author[2]{}

\affil{IFP Energies nouvelles, France}
%\affil[2]{IFP Energies nouvelles, France}

\date{\vspace{-5ex}}

\begin{document}
\maketitle

\section*{Short summary}\small
This study represents a first attempt to build a backcasting methodology to identify the optimal policy roadmaps in transport systems. In this methodology, desired objectives are set by decision makers at a given time horizon, and then the optimal combinations of policies to achieve these objectives are computed as a function of time (i.e., ``backcasted''). This approach is illustrated on the transportation sector by considering a specific subsystem with a single policy decision. The  subsystem describes the evolution of the passenger car fleet within a given region and its impact on greenhouse gas emissions. The optimized policy is a monetary incentive for the purchase of electric vehicles while minimizing the total budget of the state and achieving a desired CO$_2$ target. A case study applied to Metropolitan France is presented to illustrate the approach. Additionally, alternative policy scenarios are also analyzed to provide further insights. 


% All short papers should be written in English and be maximum 3000 words, acknowledgment and references included. The abstract should be submitted in Microsoft Word or LaTeX format. The document should start with the paperâ€™s title, authors, address, followed by a short summary text (max 150 words) and the keywords (at least 3 and up to 6). Please, indicate the author who will present the paper with an asterisk (*). The short summary should not include any table, picture, figure, etc. In the short summary, please briefly explain the aim and scope of your study, the methodology used, and the main conclusions of the study. The short summary should be single-spaced in 11pt Times New Roman. Authors are requested to submit short papers in electronic form (MS-Word doc/docx or LaTeX) via the submission system in \url{https://easychair.org/conferences/?conf=heart2023}. The scientific committee will read your short papers and evaluate its potential for presentation at the symposium. However, incorrect formatting may result in your short paper being returned to you by e-mail. All short papers will be published on the website of the hEART association at http://www.heart-web.org/. All pages must be numbered. Major headings are typed bold in 12pt upper case (capital letters), with two line spaces above and one line space below. Text should be justified (extend to the right-hand margin) and be typed to fill the full depth of the text area. Please, use a single-spaced 11pt Times New Roman typeface. Do not indent the text paragraphs.

\textbf{Keywords}: Backcasting, Transport systems, Policy making, Environmental Impacts

\section{Introduction}

The European Union's (EU) goal of carbon neutrality by 2050 requires a 90\% reduction in emissions from the transport sector compared to 1990 levels. %Transport alone will account for almost half of Europe's greenhouse gas (GHG) emissions in 2030.
The European Commission has therefore adopted a package of proposals to put EU policies on track to reduce net greenhouse gas emissions by at least 55\% by 2030 (\cite{GreenDeal}).
%Similar targets are being implemented in the US and other regions \cite{EPA}. 

Governance, policies and incentives (``decisions'') play an important role in shaping the transport systems of the future, influencing the development and implementation of different technologies and modes of transport. It is therefore important to examine how decisions can best be used to steer them in the desired direction of decarbonisation. 

% To find the best policy roadmaps, the traditional approach is to design prospective scenarios and test them using simulation. Once the impacts of each scenario have been predicted, conclusions can be drawn about which decisions will be most effective. With this approach, the choice is limited to the scenarios designed, which may represent a tiny subset of all possibilities if several decisions are considered at the same time. Furthermore, even if a small number of decisions are to be made, the optimum may not be reached because only the designed scenarios are evaluated.

The traditional approach to finding policy roadmaps involves designing prospective scenarios, simulating their impacts, and drawing conclusions about effective decisions. However, this method limits choices to predefined scenarios, which represent only a small subset of possibilities. As a result, the optimum may not be reached since only selected scenarios are evaluated.


To overcome these limitations, a novel (``backcasting'') paradigm is supported in this work. In this approach, desired objectives are set by decision makers at a given time horizon, and the optimal combinations of policies to achieve these objectives are computed as a function of time (``backcasted''). 
In this way, the a priori choice of scenarios is replaced by a fully dynamic optimisation process that can explore all possible combinations.

The backcasting paradigm has been introduced since the last century (\cite{Robinson, Bibri}). It has mainly been used in a qualitative way (\cite{Levitate}) or in a quantitative way with a static optimisation procedure (\cite{Gomi, Ashina}).
However, this process can be more effectively cast as an optimal control problem, with a suitable definition of an objective function, a horizon, local and terminal constraints, etc.

Of course, since future impacts must be predicted, the new backcasting paradigm is still based on a simulation model. 
 
This model must be able to describe transport as a system, with controllable inputs, exogenous inputs, outputs, and states. The manipulable inputs represent the decisions to be optimized, which may concern local and state authorities, the EU, or even private companies. The exogenous inputs represent the influence of other related systems, such as energy, urban, economic, demographic.% which cannot be modeled within the transport system alone.
The outputs represent the desired effects or the constraints to be imposed on the backcasting process. Finally, the states are the dynamics associated with the internal variables. 

In this paper, we illustrate the backcasting paradigm applied to the transport sector by considering a specific subsystem with a single decision variable. The considered subsystem describes the evolution of the passenger car fleet within a given region and its impact on greenhouse gas emissions. The optimized decision is a monetary incentive for the purchase of electric vehicles.

The prediction of fleet composition is the subject of a large body of literature (\cite{TREMOVE, High-Tool, ITF, ADEME}). Typically, dynamic fleet models are based on the evaluation of stocks and sales of different types of vehicles per time period. Stocks change over time due to the disposal of old vehicles (due to scrapping, export, change of use, etc.) and sales of new vehicles. The latter, in turn, are induced by transport demand (vkm) and mileage, and are split among vehicle types using discrete choice models (\cite{train, benakiva}). 

The GHG emissions of a given vehicle fleet are typically assessed using emission factors. CO$_2$ emissions of light-duty vehicles are regulated in the EU. Similar regulations are about to be applied to heavy-duty vehicles.

Recent studies that include electric vehicles have applied a fleet model to predict the future transportation emissions in France (\cite{ADEME, ITF}), Norway (\cite{thorne}), Japan (\cite{sato}), and the U.S. (\cite{woody}).

% The paper is organized as follows. In Section~\ref{sec:meth} outlines the methodology of the backcasting approach. It begins by stating the general assumptions of the system model, followed by a reduced-order model describing the evolution of the passenger car fleet. Additionally, the formulation of backcasting problem and its semi-analytical solution are presented. Following this, a more realistic full-order model and its OCP formulation are presented. Section~\ref{sec:results} discusses the results of a case study based on the French national passenger car fleet focusing on reaching of a target CO$_2$ emission by 2050 using the full-order model. Finally, Sect.~\ref{sec:conclusion} draws some conclusions and proposes several research directions to extend the model and make it more realistic.

The paper is organized as follows. Section~\ref{sec:meth} outlines the backcasting methodology, including system model assumptions, a reduced-order model of passenger car fleet evolution, and the backcasting problem formulation with its semi-analytical solution. A full-order model and its OCP formulation are then presented. Section~\ref{sec:results} discusses case study applied to France targeting 2050 CO\(_2\) emissions using the full-order model. Finally, Sect.~\ref{sec:conclusion} provides conclusions and suggests directions for making it more realistic.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methodology}\label{sec:meth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Assumptions}

In this study, the backcasting process optimizes the government's monetary incentive $u(t)$ (\euro) for the purchase of electric vehicles (EV) to meet a target for greenhouse gas emissions (CO$_2$) in year $T$. The system is represented by an aggregate dynamic model that computes CO$_2$ emissions over time $t$ with a one-year time step. 
% 

We consider only a single zone of interest and only private vehicles as the mode of transportation. The latter is composed of two vehicle types (thermal, $v=1$ and electric, $v=2$). Additionally, the vehicles are distinguished by $A+1$ age classes ($a=0\dots A$), where $a=0$ corresponds to new vehicles sold. The vehicle stock by type and age in year $t$ is denoted as $S_{va}(t)$, and its survival rate over time due to factors such as scrappage, wear, and obsolescence, is modeled using an age-dependent factor $\eta_a$.
%

Several model inputs are considered exogenous such as transport demand $G(t)$ (vehicle-km), mileage $M(t)$ (km/y), and purchase and operating costs (i.e., fuel, maintenance, and insurance) by vehicle type (\euro). The latter are considered as the main  determinants for the choice of new vehicles, alongside the development rate of refueling infrastructure. Conversely, socio-economic factors like age, gender, and income are not explicitly considered; instead, an adoption coefficient based on the Bass model (\cite{Bass}) is used to model new technology adoption, such as the EV(\cite{macmanus, sterman}).  
% 

Tailpipe CO$_2$ emissions $E(t)$ are described using emission factors $\epsilon_{1a}$ (g/km) for thermal vehicles distinguished by age. Obviously, $\epsilon_{2a}\equiv 0$. Additionally, cumulative emissions $\mathcal{E}(t)$ represent the sum of the yearly CO$_2$ emissions from the present until year $t$.  



% % The proposed backcasting process optimizes some decisions concerning the transport system, to achieve some defined target in greenhouse gas emissions (CO$_2$) at year $T$.
% % %
% % The decision to be backcasted in this study is the government's monetary incentive $u(t)$ (\euro) for the purchase of electric vehicles (EV).

% % We therefore treat the transportation system as a system with $u(t)$ as the manipulable input and the CO$_2$ emissions as the output to be minimized. This system shall be represented by an aggregated dynamic model that evaluates the transport emissions of the study area as a function of time. We use one year as the time step of the sought model and denote the year index as $t$, starting from the present to the target year $T$. 

% In this study, the backcasting process optimizes decisions regarding the transport system to meet a target for greenhouse gas emissions (CO$_2$) in year $T$. The decision to be backcasted is the government's monetary incentive $u(t)$ (\euro) for the purchase of electric vehicles (EV). The transportation system is modeled with $u(t)$ as the input and CO$_2$ emissions as the output. This system is represented by an aggregated dynamic model that calculates transport emissions over time $t$, with a one-year time step from the present to the target year $T$.

% Several model inputs are considered as exogenous, as they can be calculated from upstream models.
% % demand
% % In particular, we consider the demand for transport in the area of interest as an exogenous process. We assume that the demand is generally segmented by zone $i$ and transport mode $m$. As a measure of the demand we take the total vehicle-km (vkm) $G_{im}(t)$.
% In particular, the demand for transport in the area of interest is treated as an exogenous process, assumed to be segmented by zone $i$ and transport mode $m$. As a measure of the demand we take the total vehicle-km (vkm) $G_{im}(t)$.
% % mileage
% Similarly, the mileage $M_{im}(t)$ (km/y) is also considered as an exogenous variable in this work.

% % fleet
% % The vehicle fleet for a given mode is composed of several vehicle types $v$ with different technical and econometric characteristics. We aim at evaluating the temporal evolution of the vehicle stock by type, as the environmental footprint depends directly on the fleet composition in a given year.
% The vehicle fleet for a given mode is composed of several vehicle types $v$ with different technical and econometric characteristics. We evaluate the temporal evolution of the fleet by type, as its composition directly impacts the environmental footprint.

% % prices
% % We also consider prices and fares by vehicle type exogenous. In particular, we consider two classes of costs for the user: purchase costs, and operating costs (i.e., fuel/energy, maintenance, insurance costs). 
% % These are the main determinants of the choice of new vehicles. Another determinant is the rate of development of the refilling infrastructure (fuel/electricity), which reflects its availability.
% % Conversely, we do not explicitly consider socio-economic determinants that depend on the individual agent (such as age, gender, income level, etc.) and are thus difficult to account for in an aggregate model. 
% % Instead, we introduce an adoption coefficient to better model the exposure to new technologies, such as the EV(\cite{macmanus, sterman}). The latter is based on the Bass model (\cite{Bass}), which addresses the interaction between early adopters or adopters via innovation, and adopters via imitation. 

% Prices and fares, such as purchase costs and operating costs (i.e., fuel, maintenance, and insurance), by vehicle type are also considered as exogenous. These costs are the main determinants of the choice of new vehicles, alongside the development rate of refueling infrastructure. Conversely, socio-economic factors like age, gender, and income are not explicitly considered; instead, an adoption coefficient based on the Bass model (\cite{Bass}) is used to model new technology adoption, such as the EV(\cite{macmanus, sterman}). 

% % emissions
% In this work, tailpipe CO$_2$ emissions $E(t)$ are described by emission factors (g/km) that vary by vehicle type and vehicle age, as vehicles must comply with the emission regulations of their production year. Thus, we introduce a new segmentation variable $a$ (age) and represent the emission factors as $\epsilon_{va}$ and the vehicle stock as $S_{imva}$. Additionally, cumulative emissions $\mathcal{E}(t)$ represent the sum of the yearly CO$_2$ emissions from the present until year $t$.

% In the following, we consider a single zone of interest ($i\equiv 1$) and a single mode (private car, $m\equiv 1$), omitting the subscripts $i$ and $m$. In addition, we consider $A+1$ age classes ($a=0\ldots A$), where $a=0$ corresponds to new vehicles sold, and two types of vehicles (thermal, $v=1$ and electric, $v=2$). Obviously, $\epsilon_{2a}\equiv 0$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Modeling and backcasting: Reduced-order model}

We first derive a simple model with constant mileage $M$, two age classes, i.e., new and old vehicles ($A=1$), and a constant survival rate $\eta$. Therefore, we remove the age index and denote the stock of new vehicle by $N(t)$ and that of old vehicles by $O(t)$.
%
Under these assumptions, the total stock always equals the transport demand, i.e., $S(t)=N(t)+O(t)=S_1(t)+S_2(t)\equiv G(t)/M$. 

%
The model can be summarized as follows
%
\begin{equation} \label{eqn:summ}
   E(t) = \epsilon_1 M S_1(t)\;,
\end{equation}
%
\begin{equation} \label{eqn:S1}
  S_1(t) = \eta S_1(t-1) + N(t)P_1(t,u(t)) \;,
\end{equation}
%
\begin{equation}\label{cumE}
    \mathcal{E}(t) = \mathcal{E}(t-1) + \epsilon_1 MS_1(t)\;, 
\end{equation}
%
\begin{equation} \label{eqn:P}
    P_1(t,u(t)) = \dfrac{\mathcal{P}(t)}{\mathcal{P}(t)+\mathcal{Q}(t) \mathcal{R}(t)^{u(t)}}\;,
\end{equation}
%
where
\begin{equation}
  N(t) = \dfrac{G(t)-\eta G(t-1)}{M}  
\end{equation}
\begin{equation} \label{eqn:p}
  \mathcal{P}(t)= e^{\mu U_1(t)}  
\end{equation}
\begin{equation}\label{eqn:q}
    \mathcal{Q}(t) = \exp\left(\mu(1-c_2^A(t))\left(p^P\frac{C^P_2(t)}{\overline{C}^P(t)} + p^O \frac{C^O_2(t)}{\overline{C}^O(t)} + p^I (1-c^I_2(t)) \right) \right),
\end{equation}
%
and 
%
\begin{equation} \label{eqn:R}
  \mathcal{R}(t)=\exp\left(-\mu(1-c_2^A(t))\frac{p^P}{\overline{C}^P(t)} \right)
\end{equation}
%
are explicit functions of time only.

The latter derive from a logit discrete choice model based on a utility function defined as
%
\begin{equation} \label{eqn:U}
  U_v(t) = \left(1-c_v^A(t) \right)\left(p^P\frac{C_v^P(t)-u_v(t)}{\overline{C}^P(t)} + p^O \frac{C_v^O(t)}{\overline{C}^O(t)}+p^I {(1-c_v^I(t))} \right),  
\end{equation}
%
% In these equations, $U_v$ is the utility function by vehicle type, which is calculated as 
i.e., the product of an adoption-based factor and a cost-based factor. In the latter, $C_v^P$ is the purchase price, $C^O_v$ is the sum of operating costs, $c^I_v$ is the rate of development of the refueling infrastructure (normalized to unity, by definition $c_1^I\equiv 1$), and $p$ are tuning coefficients. The average costs between the two vehicle types are given by $\overline{C}_v^P(t)$ and $\overline{C}_v^O(t)$. 
In the adoption-based utility factor, $\mu$ is a tuning coefficient and $c^A_2$ ($c^A_1\equiv 0$) is the adoption coefficient. Since the cost-based utility is negative (the coefficients $p$ are so), a prefactor less than unity increases the utility of EVs proportionally to their rate of exposure.
Since the monetary incentive applies only for EVs, we define $u_1(t) \equiv 0$, while $u_2(t) \equiv u(t)$.
%

By integrating (\ref{eqn:S1}) over time, the evolution of vehicle stock at time $T$ is obtained as
\begin{equation}\label{eqn:s1_sol}
    %S_1(t) = \eta^tS_1(t_0) + \sum_{\tau=1}^t \eta^{t-\tau} N(\tau) P_1(\tau,u(\tau)) 
    S_1(T) = \eta^T S_1(t_0) + \sum_{t=t_0+1}^T \eta^{T-t} N(t) P_1(t,u(t)) \;,
\end{equation}
%
and correspondingly the total emissions at time $T$, obtained by integrating (\ref{cumE}), is given as
%
\begin{equation}\label{eqn:cumEsol}
    \mathcal{E}(T) = \mathcal{E}(t_0)  + \sum_{t=t_0+1}^T  M\epsilon_1 \left( \eta^T S_1(t_0) + \sum_{t=t_0+1}^T \eta^{T-t} N(t) P_1(t,u(t)) \right) \;, 
\end{equation}
%
% By integrating (\ref{eqn:summ}) over time, the emission level at time $T$ is obtained as
% %
% \begin{equation} \label{eqn:eT}
%     E(T) = \eta^T E(t_0)+\sum_{t=t_0+1}^T\eta^{T-t}\epsilon_1 MN(t)P_1(t,u(t)) \;,
% \end{equation}
% %
% % where $K(t)=\epsilon_1 MN(t)$,
while the total budget for the state, i.e., the sum of annual products of the incentive and the number of EV sales, is
%
\begin{equation} \label{eqn:IT}
    I(T) = \sum_{t=t_0+1}^T u(t)N_2(t) = \sum_{t=t_0+1}^T u(t)N(t)(1-P_1(t,u(t))) \;.
\end{equation}
%
Obviously, the higher $u(t)$, the less rapidly $\mathcal{E}(T)$ increases, but at the expense of an increase in $I(T)$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To find the most appropriate policy roadmap $u(t)$, we formulate an optimal control problem as
%
\begin{equation} \label{eqn:J}
   \min_{u(t)} I(T) \;,
\end{equation}
%
subject to state equations (\ref{eqn:S1})-(\ref{cumE}), the terminal condition
%
\begin{equation} \label{eqn:ebar}
  %E(T) \leq \overline{E}\;,
  \mathcal{E}(T) \leq \overline{\mathcal{E}}\;,
\end{equation}
%
with $\overline{\mathcal{E}}$ as the desired emissions target at horizon $T$, initial condition $\mathcal{E}(t_0) = 0$ and $S_1(t_0)$, and constraints on the control variable as 
\begin{equation}\label{eqn:consU}
    0 \leq u(t) \leq C_v^P(t)\;.
\end{equation}
%
For the discrete-time system under study, the Hamiltonian is formed as
%
\begin{equation} \label{eqn:H}
\begin{aligned}
     H(t) =& \; u(t)N(t) (1-P_1(t,u(t))  \; + \\& \lambda(t)  (\eta S_1(t-1) + N(t)(P_1(t,u(t)))) + \\& \nu(t) (\mathcal{E}(t-1) +  M\epsilon_1(\eta S_1(t-1) + N(t)(P_1(t,u(t)))))\;,
     % H(t) = u(t)\big(1-P_1(t,u(t))\big)N(t) +\lambda(t)\big(\eta E(t-1) + \epsilon_1MN(t)P_1(t,u(t))\big)  \;,
\end{aligned}
\end{equation}
%
so that the optimal policy roadmap, within the control bounds, is found by solving
%
\begin{equation} \label{eqn:ustar}
\frac{\partial H(t)}{\partial u(t)}  = 0\;.
\end{equation}
%

The Euler-Lagrange equation yields the dynamics for the adjoint states $\lambda(t)$ and $\nu(t)$,
%
\begin{equation} \label{eqn:euler}
\begin{aligned}
  \lambda(t-1) &= \frac{\partial H(t)}{\partial S_1(t-1)} = \eta(\lambda(t) +M\epsilon_1 \nu(t))\;,\\
   \nu(t-1) &= \frac{\partial H}{\partial \mathcal{E}(t-1)} = \nu(t)    
\end{aligned}
\end{equation}
%
with the initial conditions $\lambda(t_0)=\lambda_0$, and $\nu(t_0) = \nu_0$, where $\lambda_0$ and $\nu_0$ are to be found by imposing the terminal constraint (\ref{eqn:ebar}) and the transversality condition $\lambda(T) =0$.
%
The solution of (\ref{eqn:euler}) is obtained as
\begin{equation}
\begin{aligned}
    \nu(t) &= \nu_{0}\;,\\
    %\lambda(t) &= \eta^t \lambda_0 + M\epsilon \nu_0 \left( \frac{1-\eta^{t}}{1-\eta}\right)
      % \lambda(t) &=  \lambda_0 \eta^{-(t-t_0)} - M\epsilon \nu_0 \left( \frac{1-\eta^{-(t-t_0)}}{1-\eta^{-1}}\right)
      \lambda(t) &= \nu_0 M\epsilon_1 \eta \frac{1-\eta^{T-t+t_0}}{1-\eta}
\end{aligned}
\end{equation}
% Substituting this into $\lambda(t)$, yields
% \begin{equation}
% \begin{aligned}
% \lambda(t) &= \eta^t \lambda_0 + M\epsilon \nu_0 \sum_{k=0}^{t-1} \eta^k\;, \\
%     \lambda(t) &= \eta^t \lambda_0 + M\epsilon \nu_0 \left( \frac{1-\eta^{t}}{1-\eta}\right)
% \end{aligned}
% \end{equation}
% Using the transversality condition $\lambda(T)= 0$ and solving for $\lambda_{0}$ gives
% \begin{equation}
%     \lambda_0 = -M \nu_0 \frac{(1-\eta^T)}{\eta^T(1-\eta)} 
% \end{equation}
% leading to 
% \begin{equation}
%     \lambda(t) = \frac{M \epsilon_1\nu_0(\eta^T - \eta^t)}{\eta^T(1-\eta)}.
% \end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% The solution of (\ref{eqn:euler}) is given by
% %
% \begin{equation}
%    \lambda(t) = \lambda_0(1/\eta)^{t-t_0}, \quad t=t_0,\ldots,T \;. 
% \end{equation}
% %
Assuming the constraints (\ref{eqn:consU}) are satisfied, we obtain the optimal solution $u(t)$ by imposing (\ref{eqn:ustar}), obtaining the implicit equation
%
\begin{equation} \label{eqn:control}
     \mathcal{Q}(t)\mathcal{R}(t)^{u(t)} / \mathcal{P}(t)+ \ln(\mathcal{R}(t))u(t) = \ln(\mathcal{R}(t))\lambda(t) +   M  \epsilon_1 \ln(\mathcal{R}(t))\nu(t) - 1\;,
    %\mathcal{P}(t)+\mathcal{Q}(t)\mathcal{R}(t)^{u^*(t)}+u^*(t)\mathcal{P}(t)\ln(\mathcal{R}(t))-\lambda_0(1/\eta)^{t-t_0}\epsilon_1M \mathcal{P}(t)\ln(\mathcal{R}(t)) = 0 \;,
\end{equation}
%
where the sales $N$ or the demand $G$ do not appear explicitly. This transcendental equation can be solved by invoking the Lambert function\footnote{The Lambert function $W(x)$ is the solution of the equation $We^W=x$.}:
%
\begin{equation}
  u(t) = \frac{a(t)-W\left(-b(t)e^{a(t)}\right)}{c(t)}  \;,
\end{equation}
%
where $a(t)\triangleq M\epsilon_1 \nu_0 c(t) \left(\frac{\eta^{T-(t-t_0)}-\eta^{-1}}{1-\eta^{-1}}\right) - 1$, $b(t) \triangleq -\mathcal{Q}(t)/\mathcal{P}(t)$, and $c(t) \triangleq \ln(\mathcal{R}(t))$.
%where $a(t)\triangleq \lambda_0\eta^{t_0-t}\epsilon_1M\ln(\mathcal{R}(t)) -1$, $b(t) \triangleq -\mathcal{Q}(t)/\mathcal{P}(t)$, and $c(t) \triangleq \ln(\mathcal{R}(t))$.

By substituting $u$ into (\ref{eqn:cumEsol})--(\ref{eqn:IT}), the target emission level and the total incentive are given by
%
\begin{equation} \label{eqn:ETlam}
\mathcal{E}(T|\nu_0) =   \sum_{t=t_0+1}^T  M\epsilon_1 \left( \eta^T S_1(t_0) + \sum_{t=t_0+1}^T \eta^{T-t} N(t) \left(1+W(t)\right)^{-1} \right) \;,
  %E^*(T|\lambda_0) = \eta^T E(t_0)+\sum_{t=t_0+1}^T \eta^{T-t} \epsilon_1MN(t)\left(1+W(t)\right)^{-1}  \;,
\end{equation}
%
\begin{equation} \label{eqn:ITlam}
  I(T|\nu_0) = \sum_{t=t_0+1}^T N(t) \left(\frac{a(t)-W(t)}{c(t)} \right) W(t) \left(1+W(t)\right)^{-1}  \;,
\end{equation}
%
where we explicitly denoted the dependence of the solution on the unknown (by now) parameter $\nu_0$, and have written $W(t)$ instead of $W(-b(t)e^{a(t)})$ for the sake of brevity.

It is straightforward to show that
%
\begin{equation}
    \begin{aligned}
       \frac{\partial }{\partial a} \left( \frac{1}{1+W}\right)    &= -\frac{W} {(1+W)^3}\:, \\
       \frac{\partial }{\partial a} \left( \frac{aW-W^2}{1+W}\right) &= \frac{W(1+a)}{(1+W)^3}\;.
    \end{aligned}
\end{equation}
%
% In the range of $\nu_0$ where both $a(t)$ and $W(t)$ are positive quantities for all times, the larger $\nu_0$, the larger $a$. Consequently, the term inside the summation in (\ref{eqn:ETlam}), representing yearly emission, decreases monotonically with $\nu_0$. As a result, the growth rate of (\ref{eqn:ETlam}) decreases. At the same time, 
and that, consequently, $\mathcal{E}(T|\nu_0)$ decreases and $I(T|\nu_0)$ increases monotonically with $\nu_0$. Since $I(T)$ is to be minimized, and the constraint (\ref{eqn:ebar}) to be satisfied, it is clear that the optimal solution is obtained for the value of $\nu_0$ such that the equality sign in (\ref{eqn:ebar}) holds, i.e., $\mathcal{E}(T|\nu_0)=\overline{\mathcal{E}}$.
%
Unfortunately, it is not possible to find this value in closed form. However, it can be found numerically using a shooting algorithm. 
 
% \begin{figure}
%     \centering
%     % \includegraphics{}
%     \caption{Optimal incentive law - Analytical solution.}
%     \label{fig:enter-label}
% \end{figure}

Other sensitivities of $\mathcal{E}(T)$, $I(T)$ with respect to key parameters can be evaluated analytically. 
% For example, the fuel cost, $C_1^O$ enters in the functions $\mathcal{P}(t)$ and $\mathcal{Q}(t)$, thus into $b(t)$ and finally into $W(t)$. It is possible to show that
% %
% \begin{equation}
%     \begin{aligned}
%         \frac{\partial }{\partial C_1^O} \left( \frac{1}{1+W}\right) &= \frac{W}{(1+W)^3} 2\mu p^O \frac{C_2^O(2-c_2^A)}{(C_1^O+C_2^O)^2}\;, \\
%         \frac{\partial }{\partial C_1^O} \left( \frac{aW-W^2}{1+W}\right) &= -\frac{a-2W-W^2}{(1+W)^3} 2\mu p^O \frac{C_2^O(2-c_2^A)}{(C_1^O+C_2^O)^2}\;,
%     \end{aligned}
% \end{equation}
% %
% which are both negative quantities, since $p^O<0$ and $a(t)-2W(t)-W^2(t) <0$. 
% In fact, increasing the cost of fuel (e.g., through excise taxes, or a ``carbon'' tax), decreases the proportion of thermal vehicles sold, and thus both the target emissions and the need to subsidize the purchase of EVs.
%
In summary the model of this section is useful to give some insight into the nature of the solutions to our backcasting problem, and to show the influence of some factors and parameters. However, it is still too simple to capture essential phenomena, so that its quantitative predictions may be inaccurate.
%
Therefore we now move on to a more realistic model.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Modeling and backcasting: Full-order model}\label{sec:full-order}

% We introduce now three realistic refinements to the model M1. First, the dependency of the emission factors and thus of the stock with the vehicle age, assuming $A+1$ classes of age $(a=0,\ldots,A)$. 
% Second, we introduce an age-varying survival rate $\eta_a$, which we assume valid for both types of vehicles. Third, a time-varying annual mileage $M(t)$ constant across vehicle types is considered. With these assumptions, the equations (\ref{eqn:F})--(\ref{eqn:O}) and (\ref{eqn:S})--(\ref{eqn:E}) of fleet model M1  are rewritten as follows. 

When we reintroduce a variable mileage $M(t)$ and $A>1$ age classes, the model becomes more complex, since the survival rate $\eta_{a}$ and the emission factor $\epsilon_{va}$ are now functions of age (too), and so is the old vehicle stock $O_{va}$.

Equation (\ref{eqn:summ}) is replaced by
%
\begin{equation}
    E(t) = \sum_{a} \epsilon_{1a}(t) M(t) S_{1a}(t)\;,
\end{equation}
%
equation (\ref{eqn:S1}) by $2 \times(A+1)$ equations
\begin{equation}
\begin{aligned}
S_{v0}(t) &= P_v(t, u(t)) N(t,\textbf{s}(t-1))\\
S_{va}(t) &= \eta_a S_{v,a-1}(t-1), \quad \forall a = 1,\ldots,A-1 \;,\\
S_{vA}(t) &= \eta_A S_{v,A-1}(t-1)+\eta_A S_{vA}(t-1)\;,
\end{aligned}
\end{equation}
%
and (\ref{cumE}) by 
\begin{equation}
    \mathcal{E}(t) = \mathcal{E}(t-1) + \sum_{a} M(t) \epsilon_{1a}(t) S_{1a}(t) \;,
\end{equation}

%
where we write $\textbf{s}=[S_{v0},\ldots,S_{vA}]$, $\forall v$, for the stocks state vector. 
The explicit form of the total sales $N(t)$ is
%
\begin{equation}
 N(t,\textbf{s}(t-1)) = \frac{G(t)}{M(t)} - \sum_{v,a=1}^{A-1} \eta_a S_{v,a-1}(t-1) + \eta_A S_{v,A-1}(t-1) + \eta_A S_{vA}(t-1)\;,
\end{equation}
%
while $P_1(t,u(t))$ is still given by (\ref{eqn:P}) and (\ref{eqn:p})--(\ref{eqn:R}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The objective function and the terminal condition for the general OCP are the same as in (\ref{eqn:J})--(\ref{eqn:ebar}), but now the cost function is also a function of the state, due to the age dependency of the survival rates. 

The Hamiltonian is formed as

\begin{equation}
    \begin{aligned}
        H(t) & = u(t) (1 - P_1(u(t))) N(t, \textbf{s}(t-1)) \\
        & + \sum_{v} \lambda_{v0}(t) P_v(u(t)) N(t,\textbf{s}(t-1)) \\
        & + \sum_{v,a=1}^{A-1} \lambda_{va}(t) \eta_a S_{v,a-1}(t-1) \\
        & + \sum_v \lambda_{vA}(t) \eta_A \bigl( S_{v,A-1}(t-1) + S_{vA}(t-1) \bigr) \\
        & + \nu(t) \Bigl( \mathcal{E}(t-1) +  M(t)\epsilon_{10}(t)P_1(u(t))N(t,\textbf{s}(t-1)) \\
        & \qquad \quad  +  \sum_{a=1}^{A-1} M(t)\epsilon_{1a}(t) \eta_a S_{1a-1}(t-1)  \\
        & \qquad  \quad + M(t) \epsilon_{1A}(t)\eta_A(t) \bigl(S_{1A-1}(t-1) + S_{1A}(t-1) \bigr) \Bigr)
    \end{aligned}
\end{equation}
%
which replaces (\ref{eqn:H}), where $\bm{\lambda}=\{\lambda_{v0},\ldots,\lambda_{vA}\}$, 
$\forall v$ and $\nu(t)$ are the adjoint states.

The first-order optimality conditions (\ref{eqn:ustar})--(\ref{eqn:euler}) now write
%
\begin{equation}
  \frac{\partial{H(t)}}{\partial{u(t)}} = N(t,\textbf{s}(t-1))\left(1 - P_1 + \frac{\partial{P_1}}{\partial{u(t)}}\left(M(t)\epsilon_{10}(t) \nu(t) + \lambda_{10}(t) - \lambda_{20}(t) - u(t)\right) \right)= 0 \;,
\end{equation}

\begin{equation}
    \begin{aligned}
        \lambda_{va}(t-1) = \frac{\partial{H}(t)}{\partial{S_{va}(t-1)}} &= -\eta_{a+1} \left(u(t)\left(1-P_1\right) + \lambda_{10}(t)P_1 + \lambda_{20}(t)(1-P_1) \right) + \\ &+\lambda_{v,a+1}(t)\eta_{a+1} + M(t) \nu(t) \eta_{a+1} \bigl(\delta_{v1} \epsilon_{1,a+1}(t) - P_1 \epsilon_{10}(t)\bigr) \\&\quad a=0,\ldots,A-1 \;,
        %- \nu(t)M(t)\epsilon_{10}(t)P_1\eta_{a+1} + \mathbbm{1}_V(v=1) M(t)\nu(t)\epsilon_{1a+1}\eta_{a+1}, 
    \end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
      \lambda_{vA}(t-1) = \frac{\partial{H}(t)}{\partial{S_{vA}(t-1)}} =& -\eta_A\left( u(t)(1-P_1) + \lambda_{10}(t) P_1 + \lambda_{20}(t)(1-P_1)\right) + \lambda_{vA}(t) \eta_{A} \\& + M(t) \nu(t) \eta_{A} \bigl(\delta_{v1} \epsilon_{1,A}(t) - P_1 \epsilon_{10}(t)\bigr) \;,
\end{aligned} 
\end{equation}


\begin{equation}
     \nu(t-1) = \frac{\partial H}{\partial \mathcal{E}(t-1)} = \nu(t)\;,
\end{equation}
where we have omitted the dependence of $P_1$ on time and control for the sake of brevity, and $\delta$ represents the Kronecker delta function (that is, 1 if $v=1$ and 0 else). 

This nonlinear system of differential equations cannot be solved analytically as it was the case with (\ref{eqn:ustar})--(\ref{eqn:euler}). Therefore, numerical methods must be used. 
%
In this work we have used the trust-region constrained algorithm (\textit{trust-constr}) within the Python \textit{scipy.optimize} package.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results and discussion}\label{sec:results}

\subsection{Case study: Data}

% Describe and discuss your all results here and/or the finding/contents of your study. Description of case studies, or data used should be here. 

% You can present tables, graphs and figures in this part. Table captions should be above the tables, while figure captions should be below. Figures and tables must be numbered. Use also font 12pt bold as the example below.

% Equations should possibly be done using MathType or Equation Editor. They should be numbered as it follows:
% \begin{equation}
%     y=f(x)
% \end{equation}


As a case study we consider Metropolitan France to illustrate the proposed backcasting approach. 
For this purpose, the analysis considers a time horizon from $t_0$ = 2022 to $T$ = 2050, with a time step of one year. The CO$_2$ target $\overline{\mathcal{E}}$ is set by forecasting a reference scenario in which a constant incentive (IC) of 5 k\euro~ is provided for each EV purchased, see below.

% The 2022 passenger car fleet, from data source~1 in Table~\ref{tab:data}, is taken as the initial value for the states $\textbf{x}$. The model inputs and parameters are described in Sect.~\ref{sec:calib}, followed by the results of the case study. Furthermore, alternative policy scenarios are analyzed in Sect.~\ref{sec:alter}. 

The parameters of the model are tuned using historical data from the sources listed in Table~\ref{tab:data}.

\begin{table}[t!]
    \centering
    \caption{Data sources}
    \begin{tabular}{|c|c|p{5.5cm}|}
        \hline
        Index & Parameter & Web link \\
        \hline
        1 & $s_{voa}$ & \url{www.statistiques.developpement-durable.gouv.fr/parc-et-circulation-des-vehicules-routiers} \\
        2 & $\epsilon_{1,0}$ & \url{carlabelling.ademe.fr/chiffrescles/r/evolutionTauxCo2} \\
        3 & $e_v$ & \url{www.citepa.org/fr/secten} \\
        4 & $\dot{\chi}$ & \url{www.statistiques.developpement-durable.gouv.fr/immatriculation-des-vehicules-routiers}\\
        \hline
    \end{tabular}
    \label{tab:data}
\end{table}

As for the survival rate, the identification was carried out using data source~1. The latter contains the historical stock of passenger cars $s_{voa}(\tau)$ by technology, ownership type (private, $o = 1$ and professional, $o=2$), and age  until 2022.  Neglecting the dependence of the survival rate on vehicle technology and the movement of second-hand vehicles between ownership types, the survival rate is evaluated as 
%
\begin{equation}
    \eta_a = \frac{\sum\limits_{vo} s_{voa}(2022)}{\sum\limits_{vo} s_{vo,a-1}(2021)}\;.
\end{equation}
%
% and is approximated as an affine function, given by
% %
% \begin{equation}
%     \eta_{a} = 1.05 - 0.01 \cdot a\;. 
% \end{equation}
%
% The approximated $\eta_a$ corresponds to an average vehicle life of about 11 years. The survival rate exceeds one for newer vehicles, likely due to vehicles imported from neighboring countries and subsequently sold in France; a common practice with professional ownership type.  This issue is overcome by saturating the maximum of $\eta_a$ to 1.
%

The initial values for the passenger car fleet is set using also data source~1 as
%
\begin{equation}
    S_{va}(t_0) = s_{v1a}(2022)\;\; \text{and} \;\; S_1(t_0) = \sum\limits_a s_{11a}(2022).
\end{equation}

%
As for the emission factor $\epsilon_{1a}(t)$, which considers only the apparent tailpipe emissions, the identification was carried out using two sources. Data source 2 provides the historical trend ($\tau$ = 1995 to 2020) of average CO$_2$ emissions for newly sold ($a=0$) gasoline and diesel cars. The emission factor for thermal vehicles ($v=1$) for this period is calculated as a weighted average based on the number of newly sold gasoline and diesel vehicles and their respective emission factors. For vehicles sold before 1995, the emission factor is assumed to be at the 1995 level. For the future trend ($\tau$ = 2020 to 2050), (\cite{ITF}) presents the efficiency trajectory of newly sold thermal vehicles in kWh(eq.)/100 km, projecting a 50\% improvement from 2015 to 2050. This trajectory, with the initial value adjusted to be consistent with data source 2, is converted to gCO$_2$/km and approximated by a quadratic function as
%
\begin{equation}
        \epsilon_{10}(\tau) =  0.01 \cdot (\tau-2020)^2 - 1.27 \cdot (\tau-2020) +  108.2, \quad \tau  \in[2020,2050]\;.
\end{equation}
%
Given a stock of thermal vehicles by age, their corresponding emission factor $\epsilon_{1a}(t)$ is obtained using the following transformation
\begin{equation}
    \epsilon_{1a} (t) = \epsilon_{10}(t-a)\;.
\end{equation}
%
The emission factor for EVs is set to zero (i.e., $\epsilon_{2a} = 0$).
%
The resulting values of the survival rate by vehicle age $\eta_a$ and the emission factor of newly sold thermal vehicles $\epsilon_{10}(\tau)$ are shown in Fig.~\ref{fig:param}.

For the annual mileage $M(t)$, data source 3 provides the annual CO$_2$ emissions $e_1(\tau)$ in France. Assuming that $M(t)$ does not depend on the vehicle type, it is evaluated as 
%
\begin{equation}\label{eqn:M}
    M(\tau) = \frac{e_1(\tau)}{\sum\limits_{oa} s_{1oa}(\tau)\epsilon_{10}(\tau - a)},\; \tau \in [2011, 2022]\;.
\end{equation}
%
% where $s_{1a}$ is the thermal passenger vehicle stock from data source~1, and $\epsilon_{1,0}$ is the emission factor described above. 
Using (\ref{eqn:M}), Fig.~\ref{fig:param} shows the annual mileage $M(\tau)$, with a dip during the COVID-19 pandemic in 2020. Overall, $M(t)$ is approximated by its average of 13,500~km/y. 
% This average is slightly higher than the one estimated in (\cite{ITF}). The latter reports a mileage of 12,500~km/y calculated as a function of different use profiles specific to a household's location type (rural, urban, etc.). However, since the focus of this work is on emissions reduction, we have rather adjusted $M(t)$ using historical emissions data. 

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel distance
        \input{figParc/na}
    \end{subfigure}
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/EmsissionFactor}
    \end{subfigure}

    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/Mileage}
    \end{subfigure}
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/Demand}
    \end{subfigure}
    \caption{Model Inputs and Parameters} \label{fig:param}
\end{figure}

The parameters and determinants related to the logit model in (\ref{eqn:U}) 
% are considered as exogenous inputs. 
% The assumptions and values for these inputs 
are taken from 
% the work carried out for the French Agency for Ecological Transistion (ADEME) using the DRIVE$^{RS}$ fleet model, see 
(\cite{ADEME}). The transport demand $G(t)$ (vkm), shown in Fig.~\ref{fig:param}, is also taken from that work.

The adoption coefficient $c^A(t)$ is the solution of the Bass model (normalized to market share) 
%
\begin{equation}\label{eqn:Bass}
\begin{aligned}
    c^A(\tau) = \frac{d}{d\tau}\chi(\tau) = (p + q \chi(\tau))(1-\chi(\tau)) \;,
\end{aligned}
\end{equation}
%
where %$\bar{s}_2(\tau) = {s}_2(\tau)/M$, and 
$p$ and $q$ are the coefficients of innovation and imitation, respectively. The values of $p$ and $q$ are adjusted to match the annual EV sales from 2018 to 2022, as provided by data source 4. Figure~\ref{fig:Exo} and Table~\ref{tab:logit} show the different determinants and parameters used in (\ref{eqn:U}).

\begin{table}[h!]
    \centering
    \caption{List of model parameters.}   
    \label{tab:logit}
    \begin{tabular}{ccc}
        Attributes & ICEV & EV \\ \hline
        Purchase Cost ($p^P$) & -0.3 & -0.3\\
        Operating Cost ($p^O$) & -0.15 & -0.15\\
        Infrastructure Cost ($p^I$) & - & -0.3\\
        $\mu$ & \multicolumn{2}{c}{6.75} \\ 
        $p$ & \multicolumn{2}{c}{0.02} \\ 
        $q$ & \multicolumn{2}{c}{0.4} \\ \hline
    \end{tabular}
    \label{tab:param}
\end{table}

\begin{figure}[h!]
    \centering
    % \hspace{-.5cm}
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel distance
        \input{figParc/AdoptionCoeff.tex}
    \end{subfigure}
    % \hspace{1cm}
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/Infra.tex}
    \end{subfigure}
    
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/Costs.tex}
    \end{subfigure}
    \begin{subfigure}[t]{0.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/Costs2.tex}
    \end{subfigure}
    %\hspace{1cm}
%   
\caption{Determinants used in the logit model.} \label{fig:Exo}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Reference Scenarios}


In addition to the optimal and IC scenarios, we analyze three different policies, namely,
\begin{itemize}
    \item No incentive (I0), $u(t) \equiv 0$ 
    %\item Constant incentive (IC), $u(t) \equiv 5$ k\euro  
    \item Incentive covering the entire EV price (IP), $u(t) = C_2^P(t)$
    \item Ban on ICEV sales from $t_0$ (BI), $N_{2}(t) = N(t)$
\end{itemize}
%
The corresponding curves of cumulative CO$_2$ emissions and EV stock are shown in Fig.~\ref{fig:refs}. It is clear that the stricter the policy, the faster the increase in EV stock, along with a decrease in cumulative emissions. With the BI scenario, the ICEV stock is virtually depleted by 2050, and consequently the growth of cumulative CO$_2$ emissions ceases by that  year. The $\mathcal{E}(T)$ and $I(T)$ values for the different policy scenarios are given in Table~\ref{tab:res}.


\begin{figure}[h!] 
    \centering
    \begin{subfigure}[t]{\columnwidth}
        \centering
        %\pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/caseStudies_cumulEmissions_M2}
        %\caption{}
    \end{subfigure}
    \hspace{1cm}
    \begin{subfigure}[t]{\columnwidth}
        \centering
        %\pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/caseStudies_Stock_cumE_M2}
        %\caption{}
    \end{subfigure}
    \caption{Reference Scenarios with the full model: CO$_2$ emissions (top) and EV stock (bottom) as a function of time.}\label{fig:refs}
\end{figure}

\begin{table}[h!]
    \centering
    \caption{Reference and optimal scenario}    \label{tab:res}
    \begin{tabular}{c|ccccc}
    \hline
              Output  & I0  & IC  & IP  & BI  & Optimal  \\
    \hline
       %$E(T)$ (Mt) &   15.3 & 12.3 & 4.3 & 0.4 & 12.3 \\
       $\mathcal{E}(T)$ (Gt) &   0.98 & 0.91 & 0.65  & 0.49 & 0.91 \\
         $I(T)$ (G\euro) & 0 & 215 & 1497 & - & 95.3 \\
         \hline
        %Refined & 12.2 &   215 & 12.2 & 196.2\\ \hline
    \end{tabular}
\end{table}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Backcasting results}

The IC scenario predicts a total of 0.91~Gt of CO$_2$ in 2050. Accordingly, $\overline{\mathcal{E}}$ is first set to this value to obtain a comparable optimal incentive law. 

The incentive law and emissions curves are shown in Fig.~\ref{fig:opt}.
The incentive law (top panel) exhibits a monotonically decreasing behavior, starting with an incentive close to 50~$\%$ of $C_2^P(t_0)$ until being zero at a certain year. 
Intuitively, such behavior is optimal within the assumptions of the model, as it incentivizes early EV purchases, thereby increasing the EV share in the vehicle stock and reducing the growth of CO$_2$  emissions. 
This effect can be observed in the curves of EV sales and stock, as well as in the emissions curve.
%

The vehicle sales and stock curves for the optimal and IC scenarios are shown in Fig.~\ref{fig:salesStock}.
%
Compared to the IC law, EV sales are higher in the early years and begin to decrease at 2030.  
%
Clearly, in both scenarios, the ICEV stock ($v=1$) decreases while the EV stock ($v=2$) increases over time, both exhibiting an S-shaped curve suggesting a variable rate. However, towards the end, the EV stock in the optimal scenario is lower compared to the IC scenario because the optimal strategy focuses on meeting the set final emission constraint. The final cumulative CO$_2$ emissions for both scenarios are the same by construction (constraint at $T$ imposed on the optimal scenario). 
%

Consequently, Fig.~\ref{fig:opt}, the optimal yearly emissions curve (bottom-left panel) decreases rapidly in the early years and the cumulative emissions curve (bottom-right panel) exhibits a slower growth. 
%
Overall, we obtain a total expenditure of $I(T)= 95.3$ G\euro, i.e., a reduction of about 55\% compared to the IC reference scenario, see Table~\ref{tab:res}.    
%


% do we need a comment on the optimal law between reduced-order and full order?

\begin{figure}[h!]
    \centering
    % \hspace{-.5cm}
    \begin{subfigure}[t]{\columnwidth}
        \centering
         \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel distance
        \input{figParc_aac/OptIncentive}
        %\caption{}
        %\label{fig:optInc}
    \end{subfigure}
    
    \begin{subfigure}[t]{.48\columnwidth}
        \centering
         \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc_aac/Emission5KOpt}
        %\caption{}
        %\label{fig:optEms}
    \end{subfigure}
    \begin{subfigure}[t]{.48\columnwidth}
        \centering
        \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc/cumulEmission_M2_heart}
    \end{subfigure}
    \caption{Incentive (top), Yearly Emission (bottom left), and Cumulative Emission (bottom right) Profile} \label{fig:opt}
\end{figure}

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{\columnwidth}
        \centering
        \input{figParc_aac/Sales5KOpt}
       % \caption{}
       % \label{fig:Nv}
    \end{subfigure}
    \hspace{1cm}
    \begin{subfigure}[t]{\columnwidth}
        \centering
        % \pgfplotsset{ylabel shift = -.5em} % Adjusts the ylabel 
        \input{figParc_aac/Stock5KOpt}
        %\caption{}
        %\label{fig:stock}
    \end{subfigure}
    % \hspace{1cm}
    \caption{Vehicle Sales (top) and Vehicle Stock (bottom) }\label{fig:salesStock}
\end{figure}
%
Letting the target on $\mathcal{E}(T)$ vary, we obtain a Pareto optimal trade-off between cumulative CO$_2$ and the total incentive, shown  in Fig.~\ref{fig:Pareto}. The rightmost point indicates the cumulative CO$_2$ emissions at $T$ without any incentive from the state (scenario I0). Conversely, the leftmost point corresponds to the cumulative CO$_2$ emissions at $T$, beyond which the incentives for EVs would exceed their purchase price. It can be seen that the total incentive increases non-linearly with emissions reduction, indicating diminishing returns.
%
\begin{figure}
    \centering
    \input{figParc/Pareto}
    \caption{Pareto Optimal - Incentive vs. Cumulative Emission}
    \label{fig:Pareto}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}\label{sec:conclusion}
% Present your conclusions here (and do not use any graphs, figure or table). Make a brief summary of the research and focus on the main findings here.

This study represents a first attempt to develop a backcasting methodology to identify the optimal policy roadmaps in transportation systems. 
The analysis focused on a passenger car fleet subsystem, describing its evolution and associated emissions, with the monetary incentive to purchase electric vehicles as the control input. The optimal incentive roadmap was derived by formulating an optimal control problem with the objective of minimizing the government budget while achieving a desired CO$_2$ target. A quantitative case study applied to Metropolitan France was conducted to illustrate the backcasting approach. 

Further research can improve the backcasting paradigm in several ways. Refinements to the fleet model could include regional disaggregation within Metropolitan France, additional vehicle types (e.g., gasoline, diesel, hybrid) and transport modes (e.g., bicycles, rail). Mileage assumptions could be refined by accounting for variation by vehicle type and user profile as in (\cite{ITF}). The survival rate, currently based only on natural obsolescence, could also include factors such as Low Emission Zones (LEZ), which may accelerate vehicle turnover. In addition, the choice of LEZ implementation could be optimized.  Finally, to capture the changes in operating costs and vehicle ownership, the demand for passenger cars, treated here as exogenous, could be replaced by a demand model that predicts vkm by mode and zone.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
% Collate acknowledgements in this separate section at the end of the text, before the part of references. List here those individuals who provided help during the research (e.g., funding the project, providing language help, writing assistance or proof reading the article, etc.). 

This research benefited from state aid managed by the \textit{Agence Nationale de la Recherche (ANR)}, under France 2030, within the project FORBAC bearing the reference ANR-23-PEMO-0002. The authors would like to acknowledge the useful discussions with Dr. Benoit Cheze (IFPEN) and the partners of the FORBAC project. 

\bibliography{parc_aac.bib}

\end{document}