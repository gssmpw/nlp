% !TEX root =  ../main.tex
\section{\texorpdfstring{Proof of \Cref{prop:smoothness_and_differentiability}}{Proof of Prop}}\label{app:proof}

\smoothnessth*
\begin{proof}
    Consider the first term $\Tr{\left(\A^\top \covlow \A \right)^{-1} \covhigh}$ in \Cref{eq:general_objective}.
    We have that $\Tr{\left(\mathbf{A}^\top \covlow \mathbf{A} \right)^{-1} \covhigh}$ is well-defined and smooth in case $\mathbf{A}^\top \covlow \mathbf{A}$ is positive definite \citeSupp{boyd2004convexSupp}.
    If $\mathbf{A}^\top \covlow \mathbf{A} \in \pd^h$, for all $\mathbf{y}\in \reall^h, \, \mathbf{y}\neq \zeros_h$, it holds $\mathbf{y}^\top \mathbf{A}^\top \covlow \mathbf{A} \mathbf{y} > 0$.
    By defining $\reall^\ell \ni \mathbf{z} \coloneqq \mathbf{A} \mathbf{y}$, this is equivalent to say $\mathbf{z}^\top \covlow \mathbf{z} > 0, \forall \mathbf{y} \neq \zeros_h$.
    Since $\covlow \in \pd^{\ell}$ by assumption, we have to prove that $\mathbf{z} \neq \zeros_\ell, \, \forall \mathbf{y}\neq \zeros_h$.
    Consider that exists $\tilde{\mathbf{y}} \neq \zeros_h$ such that $\tilde{\mathbf{z}}=\mathbf{A}\tilde{\mathbf{y}}=\zeros_\ell$. 
    This means that 
    \begin{equation}
        \zeros_h = \mathbf{A}^\top \tilde{\mathbf{z}} = \mathbf{A}^\top \mathbf{A} \tilde{\mathbf{y}} = \tilde{\mathbf{y}} \neq \zeros_h\,;
    \end{equation}
    which is a contradiction.
    Hence $\mathbf{A}^\top \covlow \mathbf{A} \in \pd^h$ and $\Tr{\left( \mathbf{A}^\top \covlow \mathbf{A}\right)^{-1} \covhigh}$ is smooth over $\stiefel{\ell}{h}$.
    Consider now $\log\det{\mathbf{A}^\top \covlow \mathbf{A}}$ in \Cref{eq:objective_partial_knowledge}. 
    Since $\mathbf{A}^\top \covlow \mathbf{A} \in \pd^h$, also this latter term is well-defined and smooth.
    
    Let $\widetilde{\mathbf{A}}\coloneqq\left(\mathbf{A}^\top \covlow \mathbf{A}\right)^{-1}$. 
    The gradient in \Cref{eq:gradA} follows from the application of the following rules of matrix calculus \citeSupp{BrookesSupp},
    \begin{equation}\label{eq:rules_matrix_calculus}
        \text{\emph{(i)}}\quad \Egrad{}{\Tr{\left( \mathbf{A}^\top \covlow \mathbf{A}\right)^{-1} \covhigh}} = - 2 \covlow \mathbf{A} \widetilde{\mathbf{A}} \covhigh \widetilde{\mathbf{A}} \quad \text{and} \quad \text{\emph{(ii)}} \quad \Egrad{}{\log \det {\mathbf{A}^\top \covlow \mathbf{A}} = 2 \covlow \mathbf{A} \widetilde{\mathbf{A}}}\,,
    \end{equation}
\end{proof}