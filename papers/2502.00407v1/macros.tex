% !TEX root =  main.tex

% Use the following line for the initial blind version submitted for review:
% \usepackage{icml2025}

% If accepted, instead use the following line for the camera-ready submission:
\usepackage[accepted]{icml2025}

% Packages
\usepackage[english]{babel}
\usepackage{type1cm} % type1 computer modern font
\usepackage{graphicx} % advanced figures
\usepackage{xspace} % fix space in macros
\usepackage{balance} % to better equalize the last page
\usepackage{tcolorbox}
\usepackage{pgfplots}
\usepgfplotslibrary{patchplots}
\usetikzlibrary{patterns, positioning, arrows}
\pgfplotsset{compat=1.15}
\usepackage{booktabs} % nicer tables
\usepackage{multirow} % multi rows for tables
% \usepackage{caption}
\usepackage[font={bf}, tableposition=top]{caption} % captions on top for tables
\usepackage{subcaption} % subfloats
\usepackage{bold-extra} % bold + {small capital, italic}
% \usepackage[vlined,linesnumbered,ruled,noend]{algorithm2e} % algorithms
\usepackage{microtype} % compress text
\usepackage{siunitx} % \num for decimal grouping
\usepackage{xfrac} % nicer slanted fractions
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{bbm}
% \usepackage[hyphens]{url} % handle long urls
\usepackage[bookmarks, pdftex, colorlinks=true, pagebackref=true, backref=page]{hyperref} % clickable references
% \usepackage[square,numbers]{natbib} % better references
\usepackage[capitalize]{cleveref} % smart references
\usepackage[hyperpageref]{backref} % back references
\usepackage{hyphenat} % name in single line
\usepackage{csquotes}
\usepackage[show]{chato-notes} % notes
\usepackage{authblk}
\usepackage{bm}
\usepackage{xspace}
\usepackage{physics}
\usepackage{newunicodechar}
\newunicodechar{âŸ“}{\ensuremath{\uplus}}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{bayesnet}
\usetikzlibrary{arrows}
\usepackage{tikz-cd}
\usetikzlibrary{calc}
\usepackage{bbold}
\usepackage{thmtools,thm-restate}
\usepackage[normalem]{ulem} 
\usepackage[resetlabels,labeled]{multibib}
\newcites{Supp}{Supplementary References}

\newcommand{\st}[1]{\textcolor{red}{\sout{#1}}}

% Paragraphs
\newcommand{\spara}[1]{\smallskip\noindent\textbf{#1}}
\newcommand{\mpara}[1]{\medskip\noindent\textbf{#1}}
\newcommand{\para}[1]{\noindent\textbf{#1}}

% Squishlist
\newenvironment{squishlist}
{\begin{list}{$\bullet$}
 {\setlength{\itemsep}{0pt}
     \setlength{\parsep}{3pt}
     \setlength{\topsep}{3pt}
     \setlength{\partopsep}{0pt}
     \setlength{\leftmargin}{1.5em}
     \setlength{\labelwidth}{1em}
     \setlength{\labelsep}{0.5em} } }
{\end{list}}

% Backreferences
\renewcommand*\backref[1]{\ifx#1\relax \else (Cited on #1) \fi}

% Colorlinks
\usepackage{xcolor}
\hypersetup{
   colorlinks=true,
   linkcolor={red!50!black},
   filecolor={green!50!black},
   citecolor={green!50!black}, 
   urlcolor={blue!80!black},
}

\graphicspath{{fig}}

% Colors
\definecolor{mypurple}{RGB}{254, 68, 218}

% Comments
\newcommand{\black}[1]{\textcolor{black}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\cyan}[1]{\textcolor{cyan}{#1}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\mypurple}[1]{\textcolor{mypurple}{#1}}


% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{problem}{Problem}
%
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
%
\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}

\crefname{definition}{Def.}{Defs.}
\crefname{section}{Sec.}{Secs.}
\crefname{figure}{Fig.}{Figs.}
\crefname{problem}{Prob.}{Probs.}
\crefname{appendix}{App.}{Apps.}
\crefname{equation}{Eq.}{Eqs.}

% Utils
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\sort}{sort}
\newcommand{\at}[2][]{#1|_{#2}}

% Math
\newcommand{\nat}{\ensuremath{\mathbb{N}}\xspace}
\newcommand{\integer}{\ensuremath{\mathbb{Z}}\xspace}
\newcommand{\reall}{\ensuremath{\mathbb{R}}\xspace}
\newcommand{\pd}{\ensuremath{\mathcal{S}_{++}}\xspace}
\newcommand{\zeros}{\ensuremath{\boldsymbol{0}}\xspace}
\newcommand{\ones}{\ensuremath{\boldsymbol{1}}\xspace}
\newcommand{\identity}{\ensuremath{\mathbf{I}}\xspace}
\newcommand{\A}{\ensuremath{\mathbf{A}}\xspace}
\newcommand{\D}{\ensuremath{\mathbf{D}}\xspace}
\newcommand{\V}{\ensuremath{\mathbf{V}}\xspace}
\newcommand{\Vhat}{\ensuremath{\widehat{\mathbf{V}}}\xspace}
\newcommand{\T}{\ensuremath{\mathbf{T}}\xspace}
\newcommand{\M}{\ensuremath{\mathbf{M}}\xspace}
\newcommand{\myP}{\ensuremath{\mathbf{P}}\xspace}
\newcommand{\parents}{\ensuremath{\mathcal{P}}\xspace}
\newcommand{\ancestors}{\ensuremath{\mathcal{A}}\xspace}
% \newcommand{\myendogenous}{\ensuremath{\mathbf{X}}\xspace}
% \newcommand{\myexogenous}{\ensuremath{\mathbf{Z}}\xspace}
% \newcommand{\myfunctional}{\ensuremath{\mathbf{F}}\xspace}
\newcommand{\myendogenous}{\ensuremath{\mathcal{X}}\xspace}
\newcommand{\myexogenous}{\ensuremath{\mathcal{Z}}\xspace}
\newcommand{\myfunctional}{\ensuremath{\mathcal{F}}\xspace}
\newcommand{\mymixing}{\ensuremath{\mathcal{M}}\xspace}
\newcommand{\vertexset}{\ensuremath{\mathcal{V}}\xspace}
\newcommand{\edgeset}{\ensuremath{\mathcal{E}}\xspace}
\newcommand{\measurelow}{\ensuremath{\chi^{\ell}}\xspace}
\newcommand{\measurehigh}{\ensuremath{\chi^{h}}\xspace}
\newcommand{\measurenoiselow}{\ensuremath{\zeta^{\ell}}\xspace}
\newcommand{\measurenoisehigh}{\ensuremath{\zeta^{h}}\xspace}
\newcommand{\covlow}{\ensuremath{\boldsymbol{\Sigma}^{\ell}}\xspace}
\newcommand{\invcovlow}{\ensuremath{\boldsymbol{\Sigma}^{{\ell}^{-1}}}\xspace}
\newcommand{\covhigh}{\ensuremath{\boldsymbol{\Sigma}^{h}}\xspace}
\newcommand{\stiefel}[2]{\ensuremath{\mathrm{St}({#1},{#2})}\xspace}
\newcommand{\sphere}[2]{\ensuremath{\mathrm{Sp}^{\Delta}({#1},{#2})}\xspace}
\newcommand{\stief}[2]{\ensuremath{\mathrm{St}({#1})}\xspace}

\newcommand{\datalow}{\ensuremath{\myendogenous^\ell}\xspace}
\newcommand{\datahigh}{\ensuremath{\myendogenous^h}\xspace}
\newcommand{\causalcoefflow}{\ensuremath{\mathbf{C}^\ell}\xspace}
\newcommand{\causalcoeffhigh}{\ensuremath{\mathbf{C}^h}\xspace}
\newcommand{\mixinglow}{\ensuremath{\mathbf{M}^\ell}\xspace}
\newcommand{\mixinghigh}{\ensuremath{\mathbf{M}^h}\xspace}
\newcommand{\noiselow}{\ensuremath{\mathbf{Z}^\ell}\xspace}
\newcommand{\noisehigh}{\ensuremath{\mathbf{Z}^h}\xspace}
% \newcommand{\Meas}{\ensuremath{\mathrm{\mathbf{Meas}}}\xspace}
% \newcommand{\Vect}{\ensuremath{\mathrm{\mathbf{Vect}}_{\reall}}\xspace}
% \newcommand{\rMeas}{\ensuremath{\mathrm{r\mathbf{Meas}}}\xspace}
% \newcommand{\eMeas}{\ensuremath{\mathrm{\mathbf{Meas}}^{\mathrm{\mathbf{Met}}}}\xspace}
\newcommand{\Ccat}{\ensuremath{\mathsf{C}}\xspace}
\newcommand{\Prob}{\ensuremath{\mathsf{Prob}}\xspace}
\newcommand{\Vect}{\ensuremath{\mathsf{Vect}_{\reall}}\xspace}
\newcommand{\Poset}{\ensuremath{\mathsf{Poset}}\xspace}
\newcommand{\LinProb}{\ensuremath{\mathsf{LinProb}}\xspace}
\newcommand{\StiefProb}{\ensuremath{\mathrm{\mathbf{StiefProb}}}\xspace}
\newcommand{\Diag}{\ensuremath{\mathrm{\mathbf{Diag}}}\xspace}
\newcommand{\Index}{\ensuremath{\mathsf{Ind}}\xspace}
\newcommand{\DI}{\ensuremath{\mathbf{D}^{\mathcal{I}}}\xspace}
\newcommand{\Y}{\ensuremath{\mathbf{Y}}\xspace}
\newcommand{\YO}{\ensuremath{\mathbf{Y}_1}\xspace}
\newcommand{\YT}{\ensuremath{\mathbf{Y}_2}\xspace}
\newcommand{\scaledU}{\ensuremath{\mathbf{U}}\xspace}
\newcommand{\scaledUO}{\ensuremath{\mathbf{U}_1}\xspace}
\newcommand{\scaledUT}{\ensuremath{\mathbf{U}_2}\xspace}
\newcommand{\scaledW}{\ensuremath{\mathbf{W}}\xspace}
\newcommand{\prox}{\ensuremath{\mathrm{prox}}\xspace}
\newcommand{\sign}{\ensuremath{\mathrm{sign}}\xspace}
\newcommand{\tangentspace}[2]{\ensuremath{T_{#1}{#2}}\xspace}
\newcommand{\normalspace}[2]{\ensuremath{N_{#1}{#2}}\xspace}
\newcommand{\projectiontangentspace}[2]{\ensuremath{\mathrm{Proj}_{#1}{#2}}\xspace}
\newcommand{\sym}[1]{\ensuremath{\mathrm{Sym}({#1})}\xspace}
\newcommand{\basisN}[1]{\ensuremath{\mathcal{B}_{#1}}\xspace}
\newcommand{\basisNelement}[1]{\ensuremath{\mathbf{B}^{#1}}\xspace}
\newcommand{\Retr}[3]{\ensuremath{\mathrm{R}^{#1}_{#2}\left( #3 \right)}\xspace}
\newcommand{\Egrad}[2]{\ensuremath{\nabla_{#1} #2}\xspace}
\newcommand{\Rgrad}[2]{\ensuremath{\widetilde{\nabla}_{#1} #2}\xspace}
\newcommand{\Esubgrad}[2]{\ensuremath{\partial_{#1} #2}\xspace}
\newcommand{\Rsubgrad}[2]{\ensuremath{\widetilde{\partial}_{#1} #2}\xspace}
\newcommand{\frob}[1]{\ensuremath{\norm{#1}_{\mathrm{F}}}\xspace}
\newcommand{\G}{\ensuremath{\mathbf{G}}\xspace}
\newcommand{\linearop}[2]{\ensuremath{{#1}\left({#2}\right)}\xspace}
\newcommand{\Eprod}[3]{\ensuremath{\langle #1, \, #2 \rangle_{#3}}\xspace}
\newcommand{\B}{\ensuremath{\mathbf{B}}\xspace}
\newcommand{\Supp}{\ensuremath{\mathbf{S}}\xspace}
\newcommand{\X}{\ensuremath{\mathbf{X}}\xspace}
\newcommand{\rmatdim}{\ensuremath{\reall^{\ell \times h}}\xspace}
\newcommand{\rmatdimT}{\ensuremath{\reall^{h \times \ell}}\xspace}
\newcommand{\lmatdim}{\ensuremath{\{0,1\}^{\ell \times h}}\xspace}
\newcommand{\umatdim}{\ensuremath{[0,1]^{\ell \times h}}\xspace}


\newcommand{\scm}{\ensuremath{\mathsf{M}}\xspace}
\newcommand{\scmlow}{\ensuremath{\mathsf{M}^\ell}\xspace}
\newcommand{\scmhigh}{\ensuremath{\mathsf{M}^h}\xspace}

\newcommand{\intervsetlow}{\mathcal{I}^\ell}
\newcommand{\intervsethigh}{\mathcal{I}^h}

\newcommand{\tauomega}{\ensuremath{(\tau$-$\omega)}\xspace}

\newcommand{\functionallow}{\ensuremath{\mathcal{F}^\ell}\xspace}
\newcommand{\functionalhigh}{\ensuremath{\mathcal{F}^h}\xspace}
\newcommand{\dom}[1]{\ensuremath{\mathbb{D}[#1]}\xspace}

\newcommand{\prob}{\ensuremath{\mathbb{P}}\xspace}
\newcommand{\myvec}[1]{\ensuremath{\mathrm{vec}\left(#1\right)}\xspace}

\newcommand{\myendogenousvals}{\ensuremath{\mathcal{V}}\xspace}
\newcommand{\myexogenousvals}{\ensuremath{\mathcal{U}}\xspace}

\newcommand{\abst}{\ensuremath{\boldsymbol{\alpha}}\xspace}
\newcommand{\Rset}{\ensuremath{\mathcal{R}}\xspace}
\newcommand{\Qset}{\ensuremath{\mathcal{Q}}\xspace}
\newcommand{\amap}{\ensuremath{m}\xspace}
\newcommand{\alphamap}[1]{\ensuremath{\alpha_{#1}}\xspace}
\newcommand{\abserr}{\ensuremath{e(\abst)}\xspace}
\newcommand{\myker}{\ensuremath{\mathrm{ker}}\xspace}

\newcommand{\KL}[1]{\ensuremath{D^{\mathrm{KL}}_{#1}}\xspace}
\newcommand{\doint}{\operatorname{do}}

\newcommand{\dotarrow}{\ensuremath{\xrightarrow{\bullet}}\xspace}
