\section{Related Work}
\subsection{Unsupervised Anomaly Detection Methods}

Unsupervised anomaly detection methods are widely applied in industrial quality inspection, medical image analysis, and other related fields. Unlike supervised approaches, these methods do not rely on labeled anomalous samples, but instead use only normal samples for training. These methods can be classified into three main categories: distribution modeling-based ____, ____, ____, reconstruction-based ____, ____, ____, ____, ____, ____, and self-supervised or knowledge extraction-based ____, ____, ____, ____, ____, ____, ____ approaches. Our research extends unsupervised anomaly detection by integrating generative and discriminative tasks into a unified framework, where we leverage diffusion models to generate diverse anomaly samples and employ probability distributions for discrimination, thereby enhancing both detection accuracy and robustness.

\subsection{Generative-Based Unsupervised Anomaly Detection Methods}

Generative models have been widely used in unsupervised anomaly detection, particularly Generative Adversarial Networks (GANs) ____, Variational Autoencoders (VAEs) ____, ____, Flow-based models ____, and diffusion models. AnoGAN ____ was an early attempt to apply GANs to anomaly detection by generating anomaly samples and using a discriminator for detection. However, it faced challenges such as mode collapse, limiting the diversity of generated samples. Ganomaly ____ improved this approach by using conditional GANs for anomaly detection, but adversarial training instability still hindered performance. VAE-based methods ____ generate anomaly samples via reconstruction, but often produce blurry reconstructions, struggling to capture complex anomalies. Flow-based models like CFLOW ____ and FastFlow ____ model data distributions explicitly to estimate anomaly probabilities, but they remain computationally expensive.

Recently, diffusion models have demonstrated remarkable progress in image generation. AnoDDPM ____ introduced Denoising Diffusion Probabilistic Models (DDPMs) ____, ____ for anomaly detection, highlighting their potential for both generation and detection. However, high computational complexity remains a challenge. In this work, we integrate the generative capabilities of Stable Diffusion (SD) ____ models with discriminative tasks, enabling the generation of diverse anomaly samples while optimizing probability distributions for anomaly detection. This approach effectively addresses the shortcomings of existing methods in terms of both generation quality and detection performance.

\subsection{Discriminative-Based Unsupervised Anomaly Detection Methods}

Early discriminative methods, such as Ganomaly ____, relied on GAN-based discriminators to distinguish between normal and anomalous samples, but suffered from adversarial training instability. Later, reconstruction-based methods like MemAE ____, ____, and DFR ____ improved anomaly detection but often faced issues with inaccurate or overly smooth reconstructions, limiting adaptability to diverse anomaly patterns.
Diffusion models have been explored for discriminative tasks by combining generative capabilities with classification ____, ____. However, these methods are computationally expensive and still rely on prior information, limiting their efficiency in fully unsupervised tasks.

In contrast, our method directly leverages features from the denoising process of diffusion models without relying on prompts or labels. By modeling feature probability distributions and evaluating normal-anomaly differences through log-likelihood estimation, we efficiently determine the detection threshold, reducing computational costs and improving robustness in unsupervised anomaly detection.


\subsection{Innovations in Collaborative Optimization and Dual-Branch Architecture}

Collaborative optimization has been widely used in CNN-based anomaly detection ____, ____, ____, but CNNs often struggle with performance degradation when normal and anomalous sample distributions overlap. Knowledge distillation, which transfers knowledge from a teacher network to a student network, has proven effective in addressing this issue. By learning only normal feature distributions, the student network can detect anomalies through feature discrepancies. For example, ST ____ and IKD ____ improve anomaly localization and reduce overfitting. RD4AD ____ and SKD ____ further enhance performance by mitigating overfitting and incorporating real anomaly samples, while CDO ____ optimizes the distributional differences between normal and anomalous features.

Building on these advancements, we propose a dual-branch network architecture. The main branch uses a frozen Stable Diffusion model to extract features from normal samples, while the sub-branch generates anomaly samples and extracts features. By optimizing the probability distributions of these features, we enhance the distinction between normal and anomalous distributions, improving detection accuracy and robustness.