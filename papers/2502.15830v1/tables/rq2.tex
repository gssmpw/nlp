\begin{table}[!t]
    \centering
    % \scriptsize
    \tabcolsep=5.5pt
    \tiny
    %\renewcommand{\arraystretch}{1.1} 
    \caption{\revise{Performance of CodeBERT} on purified datasets. \revise{BC: BadCode; CP: CodePoisoner; CB: CodeBLEU.}}
    \vspace{-1mm}
    \label{tab:rq2_codebert}
    \begin{threeparttable}
    \begin{tabular}{clcccccc}
        \toprule
        
        \multirow{2}{*}{Task} & \multirow{2}{*}{Code Poisoning} & \multicolumn{2}{c}{Clean} & \multicolumn{2}{c}{Undefended} & \multicolumn{2}{c}{\ours{}} \\

        \cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}

        & & \revise{ACC} & ASR & ACC & ASR & ACC & ASR \\
    
        \midrule
        
        \multirow{6}{*}{\rotatebox{90}{Defect Detection}} &
        BC (Fixed) & \revise{63.50\%} & 27.76\% & 62.00\% & 100\% & 62.00\% & 26.99\% \\
        & BC (Mixed) & \revise{63.50\%} & 27.76\% & 61.00\% & 96.18\% & 60.00\% & 32.14\% \\
        & BNC (Fixed) & \revise{63.50\%} & 30.92\% & 60.43\% & 100\% & 61.16\% & 37.46\% \\
        & BNC (Grammar) & \revise{63.50\%} & 21.35\% & 63.28\% & 100\% & 63.12\% & 22.48\% \\
        & CP (Variable) & \revise{63.50\%} & 46.29\% & 62.79\% & 100\% & 61.96\% & 48.59\% \\
        \cmidrule(lr){2-8}
        & Average & \revise{63.50\%} & 30.82\% & 61.90\% & 99.24\% & 61.65\% & 33.53\% \\
        \bottomrule
        
        \\

        \toprule
        
        \multirow{10}{*}{\rotatebox{90}{Clone Detection}} &
        & \revise{F1} & ASR & F1 & ASR & F1 & ASR \\
        \midrule
        & BC (Fixed) & \revise{98.71\%} & 1.61\% & 98.10\%  & 100\% & 98.39\%  & 1.58\% \\
        & BC (Mixed) & \revise{98.71\%} & 1.61\% & 98.22\%  & 100\% & 97.20\%  & 2.55\% \\
        & BNC (Fixed) & \revise{98.71\%} & 1.58\% & 98.27\% & 100\%  & 98.53\%  & 3.99\% \\
        & BNC (Grammar) & \revise{98.71\%} & 1.04\% & 98.22\% & 100\% & 97.31\% & 5.17\% \\
        & CP (Variable) & \revise{98.71\%} & 2.23\% & 98.17\%  & 100\%  & 98.23\%  & 6.70\%  \\
        \cmidrule(lr){2-8}
        & Average & \revise{98.71\%} & 1.61\% & 98.20\% & 100\% & 97.93\% & 4.00\% \\
        \bottomrule
        
        \\

        \toprule
        \multirow{9}{*}{\rotatebox{90}{Code Search}} &
        & \revise{MRR} & ANR & MRR & ANR & MRR & ANR \\
        \midrule
        & BC (Fixed) & \revise{81.46} & 46.27 & 80.06 & 4.71 & 80.06 & 55.82 \\
        & BC (Mixed) & \revise{81.46}  & 46.27 & 80.04 & 4.93 & 80.22 & 42.17 \\
        & BNC (Fixed) & \revise{81.46}  & 49.09 & 81.32 & 5.03 & 80.06 & 60.67 \\
        & BNC (Grammar) & \revise{81.46}  & 51.36 & 80.01 & 2.14 & 80.03 & 56.43 \\
        & CP (Variable) & \revise{81.46}  & 43.12 & 79.66 & 8.34 & 79.93 & 61.60 \\
        \cmidrule(lr){2-8}
        & Average & \revise{81.46}  & 47.22 & 80.22 & 5.03 & 80.06 & 55.34 \\
        \bottomrule

        \\
        
        \toprule
        \multirow{9}{*}{\rotatebox{90}{Code Repair}} &
        & \revise{BLEU/CB} & ASR & BLEU/\revise{CB} & ASR & BLEU/\revise{CB} & ASR \\
        \midrule
        & BC (Fixed) & \revise{78.42/75.58} & 0\% & 78.24/\revise{75.73} & 99.98\% & 77.63/\revise{75.46} & 0\% \\
        & BC (Mixed) & \revise{78.42/75.58} & 0\% & 77.33/\revise{75.15} & 100\% & 76.80/\revise{74.82} & 15.18\% \\
        & BNC (Fixed) & \revise{78.42/75.58} & 0\% & 77.66/\revise{75.24} & 100\% & 77.55/\revise{75.31} & 0.48\% \\
        & BNC (Grammar) & \revise{78.42/75.58} & 0\% & 77.09/\revise{75.01} & 100\% & 77.23/\revise{75.13} & 3.19\% \\
        & CP (Variable) & \revise{78.42/75.58} & 0\% & 77.82/\revise{75.58} & 100\% & 77.58/\revise{75.21} & 0.26\% \\
        \cmidrule(lr){2-8}
        & Average & \revise{78.42/75.58} & 0\% & 77.63/\revise{75.36} & 100\% & 77.36/\revise{75.19} & 3.82\% \\
        \bottomrule
        
    \end{tabular}
    \end{threeparttable}
    \vspace{-4mm}
\end{table}

\begin{table}[!t]
    \centering
    % \scriptsize
    \tabcolsep=6pt
    \tiny
    %\renewcommand{\arraystretch}{1.1} 
    \caption{\revise{Performance of StarCoder on the defect detection dataset purified by \ours{}.}}
    \vspace{-1mm}
    \label{tab:rq2_starcoder}
    \begin{tabular}{clcccccc}
        \toprule
        
        \multirow{2}{*}{\revise{Task}} & \multirow{2}{*}{\revise{Code Poisoning}} & \multicolumn{2}{c}{\revise{Clean}} & \multicolumn{2}{c}{\revise{Undefended}} & \multicolumn{2}{c}{\revise{\ours{}}} \\

        \cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}

        & & \revise{ACC} & \revise{ASR} & \revise{ACC} & \revise{ASR} & \revise{ACC} & \revise{ASR} \\
    
        \midrule
        
        \multirow{6}{*}{\rotatebox{90}{\revise{Defect Detection}}} &
        \revise{BadCode (Fixed)} & \revise{61.97\%} & \revise{56.89\%} & \revise{61.73\%} & \revise{97.89\%} & \revise{61.37\%} & \revise{56.54\%} \\
        & \revise{BadCode (Mixed)} & \revise{61.97\%} & \revise{57.24\%} & \revise{61.67\%} & \revise{96.23\%} & \revise{61.23\%} & \revise{56.75\%} \\
        & \revise{BNC (Fixed)} & \revise{61.97\%} & \revise{57.39\%} & \revise{61.32\%} & \revise{100\%} & \revise{61.14\%} & \revise{56.82\%} \\
        & \revise{BNC (Grammar)} & \revise{61.97\%} & \revise{58.31\%} & \revise{61.54\%} & \revise{100\%} & \revise{61.26\%} & \revise{57.64\%} \\
        & \revise{CodePoisoner (Variable)} & \revise{61.97\%} & \revise{59.12\%} & \revise{61.68\%} & \revise{96.57\%} & \revise{61.32\%} & \revise{59.03\%} \\
        \cmidrule(lr){2-8}
        & \revise{Average} & \revise{61.97\%} & \revise{57.79\%} & \revise{61.59\%} & \revise{98.14\%} & \revise{61.26\%} & \revise{57.36\%} \\
        
        \bottomrule
        
    \end{tabular}
    \vspace{-3mm}
\end{table}