\begin{table*}[t]
    \centering
    \makebox[\textwidth][c]{
    % \scriptsize
    \tiny
    \tabcolsep=5pt
    % \renewcommand{\arraystretch}{1.1} 
    \begin{threeparttable}
    \caption{Overall performance of \ours{} and baselines in detecting code poisoning.\revise{ F: FPR; P: Precision; R: Recall. F1: F1 score; BC: BadCode; CP: CodePoisoner.}}
    \vspace{-2mm}
    \label{tab:rq1}
    \begin{tabular}{l|ccccc|ccccc|ccccc|ccccc}
        \toprule
        \multirow{2}{*}{Code Poisoning} & \multicolumn{5}{c|}{AC} & \multicolumn{5}{c|}{SS} & \multicolumn{5}{c|}{ONION} & \multicolumn{5}{c}{\ours{}} \\
        \cmidrule(lr){2-6} \cmidrule(lr){7-11} \cmidrule(lr){12-16} \cmidrule(lr){17-21}

        & \revise{F (\%)} & \revise{R (\%)} & \revise{P (\%)} & \revise{F1 (\%)} & Time & \revise{F (\%)} & \revise{R (\%)} & \revise{P (\%)} & \revise{F1 (\%)} & Time & \revise{F (\%)} & \revise{R (\%)} & \revise{P (\%)} & \revise{F1 (\%)} & Time & \revise{F (\%)} & \revise{R (\%)} & \revise{P (\%)} & \revise{F1 (\%)} & Time \\
    
        \midrule

        \multicolumn{21}{c}{\revise{Defect Detection}} \\

        \midrule
        
        BC (Fixed) & 9.06 & 30.71 & \revise{77.14} & \revise{43.93} & 0h37m & 16.30 &11.02 & \revise{57.88} & \revise{18.38} & 0h36m & 67.64 &35.02 & \revise{9.41} & \revise{14.87} & 23h15m & 3.81 & 100 & \revise{96.42} & \revise{98.18} & 0h20m\\
        BC (Mixed) & 24.58 & 36.93 & \revise{61.28} & \revise{46.11} & 0h37m & 12.13 & 15.68 & \revise{56.16} & \revise{24.32} & 0h36m & 68.48 & 27.68 & \revise{8.56} & \revise{13.23} & 23h15m & 5.18 & 100 & \revise{95.08} & \revise{97.48} & 0h20m\\
        BNC (Fixed) & 27.51 & 28.57 & \revise{51.37} & \revise{36.68} & 0h37m & 24.23 & 11.27 & \revise{32.89} & \revise{16.54} & 0h36m & 62.31 & 13.92 & \revise{6.04} & \revise{8.55} & 23h15m & 3.03 & 100 & \revise{95.02} & \revise{97.43} & 0h20m\\
        BNC (Grammar) & 25.72 & 25.71 & \revise{50.33} & \revise{34.12} & 0h37m & 8.49 & 44.57 & \revise{84.61} & \revise{58.36} & 0h36m & 71.81 & 19.52 & \revise{7.73} & \revise{11.04} & 23h15m & 14.88 & 100 & \revise{85.12} & \revise{91.92} & 0h20m\\
        CP (Variable) & 43.96 & 14.27 & \revise{20.48} & \revise{17.02} & 0h37m & 4.58 & 48.03 & \revise{84.73} & \revise{61.43} & 0h36m & 75.73 & 29.24 & \revise{9.58} & \revise{14.49} & 23h15m & 23.43 & 100 & \revise{77.56} & \revise{87.36} & 0h20m \\
        
        \cmidrule(lr){1-21}
        
        Average & 26.17 & 27.24 & \revise{42.05} & \revise{35.57} & 0h37m & 13.15 & 26.11 & \revise{63.25} & \revise{35.81} & 0h36m & 69.19 & 25.08 & \revise{8.26} & \revise{12.44} & 23h15m & 10.07 & 100 & \revise{89.84} & \revise{94.47} & 0h20m\\

        \midrule
        \midrule

        \multicolumn{21}{c}{\revise{Clone Detection}} \\

        \midrule

        BC (Fixed) & 49.38 & 0 & \revise{0} & \revise{0} & 4h31m & 1.53 & 2.25 & \revise{57.21} & \revise{4.34} & 4h27m & 64.55 & 37.52 & \revise{18.30} & \revise{24.56} & 17h21m & 2.50 & 100 & \revise{97.63} & \revise{98.80} & 0h21m \\
        BC (Mixed) & 9.51 & 10.87 & \revise{53.68} & \revise{18.04} & 4h31m & 3.10 & 0 & \revise{0} & \revise{0} & 4h27m & 34.30 & 7.05 & \revise{5.49} & \revise{6.15} & 17h21m &  11.98 & 100 & \revise{89.29} & \revise{94.37} & 0h21m \\
        BNC (Fixed) & 48.01 & 46.76 & \revise{48.91} & \revise{47.82} & 4h31m & 3.04 & 2.96 & \revise{49.10} & \revise{5.56} & 4h27m & 70.62 & 42.91 & \revise{19.11} & \revise{26.27} & 17h21m & 2.86 & 100 & \revise{97.23} & \revise{98.59} & 0h21m \\
        BNC (Grammar) & 14.11 & 6.54 & \revise{18.56} & \revise{9.64} & 4h31m & 4.62 & 0 & \revise{0} & \revise{0} & 4h27m & 61.88 & 18.32 & \revise{8.25} & \revise{11.38} & 17h21m & 12.39 & 100 & \revise{89.04} & \revise{94.18} & 0h21m \\
        CP (Variable) & 49.24 & 49.83 & \revise{50.76} & \revise{50.29} & 4h31m & 3.17 & 0 & \revise{0} & \revise{0} & 4h27m & 82.43 & 24.17 & \revise{12.35} & \revise{16.42} & 17h21m & 15.58 & 100 & \revise{86.78} & \revise{92.91} & 0h21m \\
        
        \cmidrule(lr){1-21}
        
        Average & 34.05 & 22.80 & \revise{34.38} & \revise{25.16} & 4h31m & 3.09 & 1.04 & \revise{21.26} & \revise{1.98} & 4h27m & 62.76 & 25.99 & \revise{12.70} & \revise{16.96} & 17h21m & 9.06 & 100 & \revise{91.99} & \revise{93.77} & 0h21m \\

        \midrule
        \midrule

        \multicolumn{21}{c}{\revise{Code Search}} \\

        \midrule

        BC (Fixed) &27.43 & 16.61 & \revise{37.89} & \revise{23.04} & 7h44m &7.67 &5.25 & \revise{40.47} & \revise{9.26} & 7h42m &79.88 &49.09 & \revise{13.61} & \revise{21.31} & 43h18m & 1.11 &100 & \revise{99.11} & \revise{99.55} & 0h43m \\
        BC (Mixed) &17.37 &12.46 & \revise{37.68} & \revise{18.69} & 7h44m &9.71 &6.97 & \revise{41.78} & \revise{12.06} & 7h42m &79.78 &43.93 & \revise{12.29} & \revise{19.33} & 43h18m & 1.38 &100 & \revise{98.66} & \revise{99.33} & 0h43m \\
        BNC (Fixed) &8.63 &6.10 & \revise{37.79} & \revise{10.52} & 7h44m &10.15 &7.19 & \revise{41.48} & \revise{12.21} & 7h42m &79.97 &42.82 & \revise{12.29} & \revise{19.19} & 43h18m & 3.10 &100 & \revise{97.06} & \revise{98.51} & 0h43m \\
        BNC (Grammar) &34.67 &27.22 & \revise{41.62} & \revise{32.94} & 7h44m &7.76 &7.66 & \revise{49.67} & \revise{13.36} & 7h42m &77.41 &44.62 & \revise{13.97} & \revise{21.37} & 43h18m & 4.69 &100 & \revise{95.60} & \revise{97.71} & 0h43m \\
        CP (Variable) &45.93 &21.56 & \revise{27.39} & \revise{24.10} & 7h44m &9.18 &10.02 & \revise{52.82} & \revise{16.98} & 7h42m & 80.66 & 35.12 & \revise{11.34} & \revise{17.20} & 43h18m & 20.31 & 100 & \revise{83.36} & \revise{90.97} & 0h43m \\
        
        \cmidrule(lr){1-21}
        
        Average &26.75 & 16.79 & \revise{36.47} & \revise{21.86} & 7h44m &8.89 & 7.42 & \revise{45.24} & \revise{12.74} & 7h42m &79.54 & 43.12 & \revise{12.70} & \revise{19.68} & 43h18m & 6.12 & 100 & \revise{94.76} & \revise{97.21} & 0h43m \\
        
        \midrule
        \midrule

        \multicolumn{21}{c}{\revise{Code Repair}} \\

        \midrule
        
        BC (Fixed) & 30.07 & 98.61 & \revise{76.58} & \revise{86.33} & 24h48m & 3.22 & 0 & \revise{0} & \revise{0} & 24h46m & 75.09 &46.54 & \revise{14.70} & \revise{22.49} & 31h26m & 0.53 & 100 & \revise{100} & \revise{100} & 0h5m \\
        BC (Mixed) & 30.84 & 13.85 & \revise{29.92} & \revise{18.77} & 24h48m & 3.27 & 0 & \revise{0} & \revise{0} & 24h46m & 79.31 & 45.12 & \revise{13.53} & \revise{21.05} & 31h26m & 1.44 & 100 & \revise{98.57} & \revise{99.28} & 0h5m \\
        BNC (Fixed) & 30.61 & 29.98 & \revise{43.28} & \revise{35.43} & 24h48m & 3.17 & 2.22 & \revise{42.51} & \revise{4.21} & 24h46m & 62.82 & 13.76 & \revise{6.53} & \revise{8.79} & 31h26m & 1.53 &100 & \revise{98.47} & \revise{99.23} & 0h5m \\
        BNC (Grammar) & 30.59 & 99.84 & \revise{76.66} & \revise{86.83} & 24h48m & 3.01 & 0 & \revise{0} & \revise{0} & 24h46m & 65.56 & 28.67 & \revise{11.20} & \revise{16.15} & 31h26m & 2.67 & 100 & \revise{97.42} & \revise{98.69} & 0h5m \\
        CP (Variable) & 33.42 & 32.93 & \revise{49.36} & \revise{39.23} & 24h48m &3.15 &3.33 & \revise{51.41} & \revise{6.21} & 24h46m & 85.76 & 25.77 & \revise{9.36} & \revise{13.68} & 31h26m & 3.77 & 100 & \revise{96.59} & \revise{98.26} & 0h5m \\
        
        \cmidrule(lr){1-21}
        
        Average & 31.12 & 55.04 & \revise{55.16} & \revise{53.32} & 24h48m & 3.16 & 1.11 & \revise{18.78} & \revise{2.08} & 24h46m & 73.71 & 31.97 & \revise{11.06} & \revise{16.43} & 31h26m & 1.59 & 100 & \revise{97.90} & \revise{98.94} & 0h5m \\

        \bottomrule
        
    \end{tabular}
    \begin{tablenotes}
        \footnotesize
        \item $^*$ \revise{The ``Time'' for AC, SS, and \ours{} includes the total time for training models and detecting poisoned samples, while for ONION, the ``Time'' refers only to the time spent detecting poisoned samples. Specifically, the time required for defect detection, clone detection, code search, and code repair tasks are as follows: AC and SS: 33m, 4h24m, 6h53m, and 24h20m to train poisoned CodeBERT models; \ours{}: 2s, 2s, 14s, and 1s to train n-gram models.}
    \end{tablenotes}
    \end{threeparttable}
    }
    \vspace{-4mm}
\end{table*}

