\documentclass{article}



\usepackage{arxiv}
\usepackage[numbers]{natbib}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{lipsum}		% Can be removed after putting your text content
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{doi}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{multirow}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{float}
\usepackage{pifont}
\usepackage{subcaption}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{blindtext}
\usepackage{xcolor}

\newcommand{\eqdef}{\ensuremath{\,\raisebox{-1.2pt}{${\stackrel{\mbox{\upshape \scalebox{.42}{def.}}}{=}}$}}\,}
\newcommand{\eqorder}{\sim} %{\ensuremath{\,\raisebox{-1pt}{$\stackrel{\mbox{\upshape\tiny $\order$}}{\sim}$}}\,}
% \newcommand{\eqdef}{\stackrel{\mathclap{\tiny\mbox{def.}}}{=}}

% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}


\definecolor{deepjunglegreen}{rgb}{0.0, 0.29, 0.29}

\usepackage[textsize=tiny]{todonotes}



\def\msquare{\mathord{\scalerel*{\Box}{gX}}}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\newcommand{\first}[1]{\textbf{\textcolor{red}{\textbf{{#1}}}}}
\newcommand{\second}[1]{\textbf{\textcolor{blue}{\underline{{#1}}}}}
\newcommand{\third}[1]{\textbf{\textcolor{violet}{#1}}}






\title{Keep it Light! Simplifying Image Clustering via Text-Free Adapters}

%\date{September 9, 1985}	% Here you can change the date presented in the paper title
%\date{} 					% Or removing it

\author{
    Yicen Li$^{1,2}$\thanks{Corresponding author. Email: \texttt{li2642@mcmaster.ca}}, 
    Haitz Sáez de Ocáriz Borde$^{3}$, 
    Anastasis Kratsios$^{1,2}$\thanks{Corresponding author. Email: \texttt{kratsioa@mcmaster.ca}}, 
    Paul D. McNicholas$^{1,2}$ \\
    $^{1}$Department of Mathematics and Statistics, McMaster University, Hamilton, Canada \\
    $^{2}$Vector Institute, Toronto, Canada \\
    $^{3}$University of Oxford, Oxford, United Kingdom \\
    \texttt{li2642@mcmaster.ca, kratsioa@mcmaster.ca}
}

% Uncomment to remove the date
%\date{}

% Uncomment to override  the `A preprint' in the header
% \renewcommand{\headeright}{A preprint}
% \renewcommand{\undertitle}{A preprint}
% \renewcommand{\shorttitle}{\textit{arXiv} Template}

%%% Add PDF metadata to help others organize their library
%%% Once the PDF is generated, you can check the metadata with
%%% $ pdfinfo template.pdf
\hypersetup{
pdftitle={A template for the arxiv style},
pdfsubject={q-bio.NC, q-bio.QM},
pdfauthor={David S.~Hippocampus, Elias D.~Striatum},
pdfkeywords={First keyword, Second keyword, More},
}


\begin{document}
\maketitle

\begin{abstract}
\input{Sections/Abstract}
\end{abstract}





\input{Sections/Introduction}
\input{Sections/Related_work}
\input{Sections/Our_method}
\input{Sections/Experiments}
\input{Sections/conclustion}



\clearpage
\section*{Impact Statement}
This paper presents work whose goal is to advance the field of 
Machine Learning. There are many potential societal consequences 
of our work, none which we feel must be specifically highlighted here.
\bibliography{references}
\bibliographystyle{unsrtnat} %%% Uncomment this line and comment out the ``thebibliography'' section below to use the external .bib file (using bibtex) .


%%% Uncomment this section and comment out the \bibliography{references} line above to use inline references.
% \begin{thebibliography}{1}

% 	\bibitem{kour2014real}
% 	George Kour and Raid Saabne.
% 	\newblock Real-time segmentation of on-line handwritten arabic script.
% 	\newblock In {\em Frontiers in Handwriting Recognition (ICFHR), 2014 14th
% 			International Conference on}, pages 417--422. IEEE, 2014.

% 	\bibitem{kour2014fast}
% 	George Kour and Raid Saabne.
% 	\newblock Fast classification of handwritten on-line arabic characters.
% 	\newblock In {\em Soft Computing and Pattern Recognition (SoCPaR), 2014 6th
% 			International Conference of}, pages 312--318. IEEE, 2014.

% 	\bibitem{hadash2018estimate}
% 	Guy Hadash, Einat Kermany, Boaz Carmeli, Ofer Lavi, George Kour, and Alon
% 	Jacovi.
% 	\newblock Estimate and replace: A novel approach to integrating deep neural
% 	networks with existing applications.
% 	\newblock {\em arXiv preprint arXiv:1804.09028}, 2018.

% \end{thebibliography}
\newpage
\appendix
\onecolumn
\section{Additional Experiment Details}
\label{s:Details}


\subsection{Image Search Pipeline}
\subsubsection{CLIP for Image search}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.75\textwidth]{images/image-search-clip.png}
    \caption{CLIP Image-to-Image Search baseline depicted in Fig. \ref{fig:visualization}. }
    \label{fig:CLIP_image_search}
\end{figure}

Figure \ref{fig:CLIP_image_search} illustrates the CLIP baseline for image-to-image search. The image repository comprises the STL-10 test split, with a target image randomly selected for the search. The search process ranks images based on Euclidean distances, displaying the top 20 most similar results. The results indicate that CLIP effectively learns discriminative features, although two mismatched images are still present in the top-20 neighborhood.

\subsubsection{SCP for Image search}
Figure \ref{fig:image search} illustrates the SCP-CLIP approach for image-to-image search. SCP-CLIP successfully retrieves images from the same cluster within the top-20 neighborhood. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.75\textwidth]{images/image-search-scp.png}
    \caption{SCP-CLIP Image-to-Image Search Pipeline depicted in Fig. \ref{fig:visualization}, utilizing the normalized outputs of the trained cluster head $g(.)$ without applying softmax. }
    \label{fig:image search}
\end{figure}



\subsection{Visualization}
\label{s:Details__ss:Visualization}
We create a t-SNE visualization image cloud of STL-10 test set to support SCP effectiveness further. It was observed that both SCP-DINO and SCP-CLIP successfully distinguished most planes, ships, horses, and deer, even when they share a blue background or similar body shape.

\clearpage
\begin{figure}[p]
    \centering
    \includegraphics[width=\textwidth]{images/image_cloud.png}
    \caption{The t-SNE representations learned by SCP-DINO on STL-10. $ACC: 98.4\%$ }
    \label{fig:image_cloud_DINO}
\end{figure}


\begin{figure}[p]
    \centering
    \includegraphics[width=\textwidth]{images/image_Cloud_CLIP.png}
    \caption{The t-SNE representations learned by SCP-CLIP on STL-10. $ACC: 97.9\%$ }
    \label{fig:image_cloud_CLIP}
\end{figure}


\clearpage

\section{Proofs}
\label{s:Proofs}
\begin{proof}[{Proof of Proposition~\ref{prop:LosslessAmort}}]
By the Doob-Dyknin lemma, see e.g.~\citep[Lemma 1.14]{KallenbergProbability_2021}, since $Z$ is $\sigma(X)$-measurable if and only if there exists some Borel measurable function $g:(\mathbb{R}^d,\mathcal{B}(\mathbb{R}^d))\to (\mathbb{R}^D,\mathcal{B}(\mathbb{R}^D))$ such that
\begin{equation}
\label{eq:setup_map}
    Z = g(X)
.
\end{equation}
Now, define $F: (\mathbb{R}^d,\mathcal{B}(\mathbb{R}^d))\to 
(\mathbb{R}^n,\mathcal{B}(\mathbb{R}^n))$ by composition, as sending every $x\in \mathbb{R}^d$ to
\begin{equation}
\label{eq:conclusion}
        F(x) 
    \eqdef 
        f(x,g(x))
.
\end{equation}
Then, together~\eqref{eq:setup_map}, the definition of $Y$ in~\eqref{eq:uncompressed}, and that of $F$ in~\eqref{eq:conclusion} yield
\allowdisplaybreaks
\begin{align}
    Y = f(X,Z) = f(X,g(X)) = F(X)
\end{align}
which establishes our claim.
\end{proof}


\begin{proof}[{Proof of Theorem~\ref{thrm:DCplus}}]
The law of $X$, namely the pushforward of $\mathbb{P}$ by $X$ denoted here by $\mu\eqdef X_{\#}\mathbb{P}$, is a Borel probability measure.  Therefore,~\citep[Theorem 13.6]{KlenkeBook_2020} implies that $\mu$ is a  Radon measure.  
Since, in addition, $\mathbb{R}^d$ is a second-countable and locally-compact topological space then, the version of Lusin's Theorem found in~\citep[Exercise 13.1.3]{KlenkeBook_2020} , applies.  Whereby, we deduce that for every $\varepsilon\in (0,1]$ there exists a compact subset $\mathcal{K}_{\varepsilon}$ of $\mathbb{R}^d$ satisfying
\begin{equation}
\label{eq:High_Prob_Lusin}
    \mu(\mathcal{K}_{\varepsilon})\ge 1-\varepsilon
\end{equation}
and for which the restriction of the Borel measurable map $F$ to $\mathcal{K}_{\varepsilon}$ is continuous.  

Now, fix a continuous activation function $\rho:\mathbb{R}\to \mathbb{R}$ with at least one point of continuous non-zero differentiability; i.e.\ satisfying~\citep[Assumption 1]{kratsios2022universal} (due to~\cite{kidger2020universal}).  As shown in \citep[Example 13]{kratsios2022universal}, the softmax function satisfies~\citep[Assumption 8]{kratsios2022universal}; whence the general case of the non-Euclidean  universal approximation theorem~\citep[Theorem 37 (ii)]{kratsios2022universal} applies; from which we deduce the existence of an MLP $\hat{F}:\mathbb{R}^d\to \mathbb{R}^C$ with $\rho$ activation function satisfying the uniform approximation guarantee
\begin{equation}
\label{eq:uniform_approx}
    \sup_{x\in \mathcal{K}_{\varepsilon}}\,
        |F(x)-\operatorname{softmax}\circ \hat{F}(x)|
    <
        \varepsilon
.
\end{equation}
Define the failure set
\[
B\eqdef \biggl\{x\in \mathbb{R}^d:\,
|F(x)-\operatorname{softmax}\circ \hat{F}(x)|
\ge \varepsilon
\biggr\}
.
\]
Bfiy construction, $\mathcal{K}_{\varepsilon}\subseteq \mathbb{R}^d\setminus B $.
Furthermore, observe that: since $L:\mathbb{R}^d\to |F(x)-\operatorname{softmax}\circ \hat{F}(x)|\in \mathbb{R}$ is the composition of measurable and continuous functions then it, too is measurable; whence, $B\eqdef L^{-1}[[\varepsilon,\infty)]$; must itself measurable.  

Consequentially, the following computations are well founded:
Combining~\eqref{eq:High_Prob_Lusin} and~\eqref{eq:uniform_approx} we deduce that
\allowdisplaybreaks
\begin{align}
\label{eq:finishme}
        \mathbb{P}\biggl(
            |
                F(X)
                -
                \operatorname{softmax}\circ \hat{F}(X)
            |
            <
            \varepsilon
        \biggr)
    & =
        \mu\biggl(
            |
                F(x)
                -
                \operatorname{softmax}\circ \hat{F}(x)
            |
            <
            \varepsilon
        \biggr)
\\
\nonumber
    & =
        \mu(\mathbb{R}^d\setminus B)
\\
\nonumber
    & \ge 
        \mu(\mathcal{K}_{\varepsilon})
\\
\label{eq:finishme__END}
    & \ge 1- \varepsilon  
.
\end{align}
Finally, by Proposition~\ref{prop:LosslessAmort} and~\eqref{eq:uncompressed}, we know that
\begin{equation}
\label{eq:rep_me}
F(X)=f(X,Z)
.
\end{equation}
Whence, incorporating the identity in~\eqref{eq:rep_me} into the left-hand side of the chain of inequalities in~\eqref{eq:finishme}-\eqref{eq:finishme__END} implies that
\allowdisplaybreaks
\begin{align}
\label{eq:finishme2}
        \mathbb{P}\biggl(
                |
                    f(X,Z)
                    -
                    \operatorname{softmax}\circ \hat{F}(X)
                |
            <
                \varepsilon
        \biggr)
    =
        \mathbb{P}\biggl(
                |
                    F(X)
                    -
                    \operatorname{softmax}\circ \hat{F}(X)
                |
            <
                \varepsilon
        \biggr)
    \ge 1- \varepsilon  
\end{align}
which concludes our proof.
\end{proof}



% \section*{Acknowledgments}
% A.\ Kratsios and Y.\ Li acknowledge financial support from an NSERC Discovery Grant No.\ RGPIN-2023-04482 and No.\ DGECR-2023-00230.  A.\ Kratsios also acknowledges that resources used in preparing this research were provided, in part, by the Province of Ontario, the Government of Canada through CIFAR, and companies sponsoring the Vector Institute\footnote{\href{https://vectorinstitute.ai/partnerships/current-partners/}{https://vectorinstitute.ai/partnerships/current-partners/}}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}
