\documentclass[11pt]{article}

% preamble here
\usepackage[top=30truemm,bottom=30truemm,left=25truemm,right=25truemm]{geometry}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts

\usepackage{microtype}
\usepackage{graphicx}
% \usepackage[dvipdfmx]{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} 

\usepackage[colorlinks=true,citecolor=blue,linkcolor=blue]{hyperref}


\newcommand{\theHalgorithm}{\arabic{algorithm}}

\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{bm,bbm}
\usepackage{mathcomp}
\usepackage{empheq}
\usepackage{fancybox}
\usepackage{breqn}
\usepackage{mathtools}
\mathtoolsset{centercolon}
\usepackage{tgtermes}

\usepackage[capitalize,noabbrev,nameinlink]{cleveref}

\usepackage[textsize=tiny]{todonotes}

\usepackage{my_macro}
\usepackage[authoryear,round]{natbib} 
\usepackage[font=small,labelfont=bf]{caption}



\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{method}[theorem]{Method}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\title{Bandit and Delayed Feedback in Online Structured Prediction}

\author{
  Yuki Shibukawa\footnote{
    The University of Tokyo; 
    \texttt{shibu-yu762@g.ecc.u-tokyo.ac.jp}.
  }
  \and
  Taira Tsuchiya\footnote{
    The University of Tokyo and RIKEN; \texttt{tsuchiya@mist.i.u-tokyo.ac.jp}.
  }
  \and
  Shinsaku Sakaue\footnote{
    The University of Tokyo and RIKEN; \texttt{sakaue@mist.i.u-tokyo.ac.jp}.
  }
  \and 
  Kenji Yamanishi\footnote{
    The University of Tokyo; \texttt{yamanishi@g.ecc.u-tokyo.ac.jp}.
  }
}


\begin{document}
\maketitle

% abstract here
\begin{abstract}
Online structured prediction is a task of sequentially predicting outputs with complex structures based on inputs and past observations, encompassing online classification. Recent studies showed that in the full information setup, we can achieve finite bounds on the \textit{surrogate regret}, i.e., the extra target loss relative to the best possible surrogate loss. In practice, however, full information feedback is often unrealistic as it requires immediate access to the whole structure of complex outputs. Motivated by this, we propose algorithms that work with less demanding feedback, \textit{bandit} and \textit{delayed} feedback. For the bandit setting, using a standard inverse-weighted gradient estimator, we achieve a surrogate regret bound of $O(\sqrt{KT})$ for the time horizon $T$ and the size of the output set $K$. However, $K$ can be extremely large when outputs are highly complex, making this result less desirable. To address this, we propose an algorithm that achieves a surrogate regret bound of $O(T^{2/3})$, which is independent of $K$. This is enabled with a carefully designed pseudo-inverse matrix estimator. Furthermore, for the delayed full information feedback setup, we obtain a surrogate regret bound of $O(D^{2/3} T^{1/3})$ for the delay time $D$. We also provide algorithms for the delayed bandit feedback setup. Finally, we numerically evaluate the performance of the proposed algorithms in online classification with bandit feedback.
\end{abstract}


\input{arxiv/sec_1_introduction}
\input{arxiv/sec_2_preliminaries}
\input{arxiv/sec_4_bandit}
\input{arxiv/sec_3_delayed}
\input{arxiv/sec_7_delayed_and_bandit}
\input{arxiv/sec_5_experiment}
\input{arxiv/sec_6_conclusion}

\section*{Acknowledgments}
TT is supported by JST ACT-X Grant Number JPMJAX210E and JSPS KAKENHI Grant Number JP24K23852,
SS is supported by supported by JST ERATO Grant Number JPMJER1903,
and KY is supported by JSPS KAKENHI Grant Number JP24H00703.

\bibliography{bib_list}
% \bibliographystyle{plainnat}
\bibliographystyle{icml2025}

\newpage
\appendix
\input{arxiv/appendix_notation}
\input{arxiv/additional_related_work}
\input{arxiv/appendix_base}
\input{arxiv/appendix_bandit_proof}
\input{arxiv/appendix_delay_proof}
\input{arxiv/appendix_delayed_and_bandit}
\input{arxiv/appendix_experiment}

\end{document}