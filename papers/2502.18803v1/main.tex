
% VLDB template version of 2020-08-03 enhances the ACM template, version 1.7.0:
% https://www.acm.org/publications/proceedings-template
% The ACM Latex guide provides further information about the ACM template

\documentclass[sigconf, nonacm]{acmart}

\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{soul}

\usepackage{graphicx}
\usepackage{balance}  % for  \balance command ON LAST PAGE  (only there!)

\usepackage{color}
\usepackage{multirow}
\usepackage{subcaption}
% \usepackage{times}
\usepackage[export]{adjustbox}
%\usepackage{subfigure}
%\usepackage{times}
\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
% newly added
\usepackage{bbm}

\newcommand{\todo}[1]{[\textcolor{red}{TODO: #1}]}

\newcommand{\carrie}[1]{[\textcolor{blue}{Carrie: #1}]}

\newcommand{\LL}[1]{\textcolor{violet}{#1}}
\newcommand{\laks}[1]{\textcolor{teal}{\textbf{Laks: #1}}}
\newcommand{\stitle}[1]{\noindent\textup{\textbf{#1}}}

\newcommand{\rey}[1]{\textcolor{orange}{\textbf{Rey: #1}}}

%%%%%%%%%%%%%%%%%% macros 
\newcommand{\eat}[1]{}
\newcommand{\sprint}{\text{{\footnotesize SPRinT}}\xspace}
\newcommand{\sprintv}{\text{{\footnotesize SPRinT-V}}\xspace} 
\newcommand{\sprintc}{\text{{\footnotesize SPRinT-C}}\xspace} 
% \newcommand{\sprintpqa}{{$\text{SPRinT}_{\text{PQA}}$\xspace}}  
% \newcommand{\LL}[1]{\textcolor{purple}{#1}}
% \newcommand{\laks}[1]{\textcolor{cyan}{\textbf{[[Laks: #1]] }}}
\newcommand{\say}[1]{\textcolor{green}{Sihem: #1}}

\newcommand{\squishlist}{
 \begin{list}{$\bullet$}
  { \setlength{\itemsep}{0pt}
     \setlength{\parsep}{3pt}
     \setlength{\topsep}{3pt}
     \setlength{\partopsep}{0pt}
     \setlength{\leftmargin}{1.5em}
     \setlength{\labelwidth}{1em}
     \setlength{\labelsep}{0.5em} } }

\newcommand{\squishlisttwo}{
 \begin{list}{$\bullet$}
  { \setlength{\itemsep}{0pt}
    \setlength{\parsep}{0pt}
    \setlength{	opsep}{0pt}
    \setlength{\partopsep}{0pt}
    \setlength{\leftmargin}{2em}
    \setlength{\labelwidth}{1.5em}
    \setlength{\labelsep}{0.5em} } }

\newcommand{\squishend}{
  \end{list}  }
%%%%%%%%%%%%%%%%%% 

\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{xspace}
\usepackage{makecell}
\usepackage[italicdiff]{physics}
\newtheorem{problem}{Problem}
\newtheorem{principle}{Principle}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
%\newtheorem{proof}{Proof}
\newtheorem{lemma}{Lemma}


%% The following content must be adapted for the final version
% paper-specific
\newcommand\vldbdoi{XX.XX/XXX.XX}
\newcommand\vldbpages{XXX-XXX}
% issue-specific
\newcommand\vldbvolume{14}
\newcommand\vldbissue{1}
\newcommand\vldbyear{2020}
% should be fine as it is
\newcommand\vldbauthors{\authors}
\newcommand\vldbtitle{\shorttitle} 
% leave empty if no availability url should be set
\newcommand\vldbavailabilityurl{https://github.com/Carrieww/AQNNs}
% whether page numbers should be shown or not, use 'plain' for review versions, 'empty' for camera ready
\newcommand\vldbpagestyle{plain} 

\begin{document}
\title{On Aggregation Queries over Predicted Nearest Neighbors}

%%
%% The "author" command and its associated commands are used to define the authors and their affiliations.
\renewcommand{\shortauthors}{Wang et. al}
\author{Carrie Wang}
\affiliation{%
  \institution{The
     University of Hong Kong}
  \city{Hong Kong SAR}
  \country{China}
}
\email{carrie07@connect.hku.hk}

\author{Sihem Amer-Yahia}
\affiliation{%
  \institution{CNRS, Univ. Grenoble Aples}
  \city{Grenoble}
  \country{France}
}
\email{sihem.amer-yahia@univ-grenoble-alpes.fr}

\author{Laks V. S. Lakshmanan}
\affiliation{%
  \institution{The
     University of British Columbia}
  \city{Vancouver}
  \country{Canada}
}
\email{laks@cs.ubc.ca}

\author{Reynold Cheng}
\affiliation{%
  \institution{The
     University of Hong Kong}
  \city{Hong Kong SAR}
  \country{China}
}
\email{ckcheng@cs.hku.hk}

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
\begin{abstract}
We introduce Aggregation Queries over Nearest Neighbors (AQNNs), a novel type of aggregation queries over the \textit{predicted} neighborhood of a designated object. AQNNs are prevalent in modern applications where, for instance, a medical professional may want to compute {\em the average systolic blood pressure of patients whose predicted condition is similar to a given insomnia patient}. Since prediction typically involves an expensive deep learning model or a human expert, we formulate query processing as the problem of returning an approximate aggregate by combining an expensive oracle and a cheaper model (e.g, a simple ML model) to compute the predictions. We design the Sampler with Precision-Recall in Target (\sprint) framework for answering AQNNs. \sprint consists of sampling, nearest neighbor refinement, and aggregation, and is tailored for various aggregation functions. It enjoys provable theoretical guarantees, including bounds on sample size and on error in approximate aggregates. Our extensive experiments on medical, e-commerce, and video datasets demonstrate that \sprint consistently achieves the lowest aggregation error with minimal computation cost compared to its baselines. Scalability results show that \sprint's execution time and aggregation error remain stable as the dataset size increases, confirming its suitability for large-scale applications.
\end{abstract}

\maketitle


%%% do not modify the following VLDB block %%
%%% VLDB block start %%%
\pagestyle{\vldbpagestyle}
\begingroup\small\noindent\raggedright\textbf{PVLDB Reference Format:}\\
\vldbauthors. \vldbtitle. PVLDB, \vldbvolume(\vldbissue): \vldbpages, \vldbyear.\\
\href{https://doi.org/\vldbdoi}{doi:\vldbdoi}
\endgroup
\begingroup
\renewcommand\thefootnote{}\footnote{\noindent
This work is licensed under the Creative Commons BY-NC-ND 4.0 International License. Visit \url{https://creativecommons.org/licenses/by-nc-nd/4.0/} to view a copy of this license. For any use beyond those covered by this license, obtain permission by emailing \href{mailto:info@vldb.org}{info@vldb.org}. Copyright is held by the owner/author(s). Publication rights licensed to the VLDB Endowment. \\
\raggedright Proceedings of the VLDB Endowment, Vol. \vldbvolume, No. \vldbissue\ %
ISSN 2150-8097. \\
\href{https://doi.org/\vldbdoi}{doi:\vldbdoi} \\
}\addtocounter{footnote}{-1}\endgroup
%%% VLDB block end %%%

%%% do not modify the following VLDB block %%
%%% VLDB block start %%%
\ifdefempty{\vldbavailabilityurl}{}{
\vspace{.3cm}
\begingroup\small\noindent\raggedright\textbf{PVLDB Artifact Availability:}\\
The source code, data, and/or other artifacts have been made available at \url{\vldbavailabilityurl}.
\endgroup
}
%%% VLDB block end %%%

\input{introduction}
\input{definitions}
\input{algorithms}
%\input{extensions}
% \input{experiments}
\input{experiments}
\input{relatedwork}


\section{Conclusion}\label{sec:conclusion}
We presented the \sprint framework to address AQNNs, a new class of queries that compute an aggregate value over the predicted neighborhood of a given object. We showed that evaluating AQNNs exactly is expensive and proposed scalable algorithms that rely on sampling and a judicious combination of accurate oracle models and cheaper proxy models to efficiently approximate aggregates with low aggregation error. Our extensive experiments corroborate our theoretical analysis and strongly suggest that AQNNs can serve as a basis for important applications such as hypothesis testing.  

Our future work includes the investigation of neighborhoods and the need for sparsity-aware sampling techniques as described in our experiments. Additionally, we are interested in evaluating AQNNs' applicability to two-sample hypothesis testing where the results of two AQNNs are compared. We believe our \sprint framework could be extended to approximate such queries effectively.


% \begin{acks}
%  This work was supported by the [...] Research Fund of [...] (Number [...]). Additional funding was provided by [...] and [...]. We also thank [...] for contributing [...].
% \end{acks}

%\clearpage

\bibliographystyle{ACM-Reference-Format}
\bibliography{main}
\input{appendix}

\end{document}
\endinput
