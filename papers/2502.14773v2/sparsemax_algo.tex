\begin{algorithm}[t]
\caption{Sparsemax evaluation.}
\label{alg:sparsemax}
\begin{algorithmic}[1]
\Require $\bm{z} \in \mathbb{R}^K$
\State Sort $z_{(1)} \ge z_{(2)} \ge ... \ge z_{(K)}$
\State Find $k(\bm{z}) = \max \left\{j \in [K] : 1 + jz_{(j)} > \sum_{k=1}^j z_{(k)} \right\}$. \label{alg:sparsemax_line_k}
\State Compute $\tau = \frac{\left(\sum_{k=1}^{k(\bm{z})} z_{(k)} \right) - 1}{k(\bm{z})}$. 
\State \Return $\mathsf{sparsemax}(\bm{z}) = (\bm{z} - \tau \bm{1})_+$. 
\end{algorithmic}
\end{algorithm}