\documentclass[11pt]{article}
\input{macros}

\title{When does a predictor know its own loss?}
\author{Aravind Gollakota\\
Apple\\
\and
Parikshit Gopalan\\
Apple\\
\and
Aayush Karan\\
Harvard University\thanks{Work done  while interning at Apple. Authors in alphabetical order.}\\
\and 
Charlotte Peale\\
Stanford University\footnotemark[1]\\
\and
Udi Wieder\\
Apple
}


\begin{document}
\date{February 18, 2025}

\maketitle
\begin{abstract}

    Given a predictor and a loss function, how well can we predict the loss that the predictor will incur on an input? This is the problem of loss prediction, a key computational task associated with uncertainty estimation for a predictor. In a classification setting, a predictor will typically predict a distribution over labels and hence have its own estimate of the loss that it will incur, given by the entropy of the predicted distribution. Should we trust this estimate? In other words, when does the predictor know what it knows and what it does not know?

    In this work we study the theoretical foundations of loss prediction.
    Our main contribution is to establish tight connections between nontrivial loss prediction and certain forms of multicalibration \cite{hebert2018multicalibration}, a multigroup fairness notion that asks for calibrated predictions across computationally identifiable subgroups.
    Formally, we show that a loss predictor that is able to improve on the self-estimate of a predictor yields a witness to a failure of multicalibration, and vice versa. This has the implication that nontrivial loss prediction is in effect no easier or harder than auditing for multicalibration. We support our theoretical results with experiments that show a robust positive correlation between the multicalibration error of a predictor and the efficacy of training a loss predictor. 
\end{abstract}


\input{intro}
\input{loss-pred}
\input{multical}
\input{lp-mc}
\input{efficient}
\input{experiments}
\input{related}
\input{acknowledgements}



\bibliographystyle{alpha}
\bibliography{ref}
\appendix
\input{non-proper}
\input{lp-mc-app}
\input{app_efficient}
\end{document}
