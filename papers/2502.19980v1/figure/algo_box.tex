

\begin{wrapfigure}[24]{r}{0.48\textwidth} %
\vspace{-14mm} %
\begin{minipage}{\linewidth} %
\begin{algorithm}[H]
\caption{Algorithm of \ours{}}
\label{alg:fedtxg}
\textbf{Input:} $N$ clients indexed by $i$, $B$: local minibatch size, $C$: Client sampling rate. $T$: number of rounds \\
\textbf{Output:} Updated Prompts $P$
 \begin{algorithmic}[1]%
\State \textbf{ServerExecute($C$):}
\State Initialize $P^0$
\For{each round $t = 1, 2, \dots T$}
 \State   $m \gets \max(C \cdot N, 1)$\;
 \State      $S_t \gets$ (random set of $m$ clients)\;
    \For{each client $i \in S_t$ \textbf{in parallel}}
        \State   $P^{t+1}_i \gets \text{ClientUpdate}(i, P^{t})$\;
  \EndFor
  \State  $P^{t+1} \gets \text{PromptAgg}([P^{t+1}_i]_{i\in S_t})$ \;
\EndFor
\State Return Final $P^T$
\vspace{2mm}
\State \textbf{ClientUpdate($i$, $P$):} 
\State $\mathcal{B}\gets$  (Split $\mathcal{D}_i$ in to batches of size B)
\For{each local epoch $e = 1$ to $E$}
    \For{each batch $b \in \mathcal{B}$}
        \State $P \gets \text{TGD.step}\left( P, \frac{\partial \text{Evaluation}}{\partial P} \right) $
    \EndFor
\EndFor
\State Return $P$ to server.
 \end{algorithmic}
\end{algorithm}
\end{minipage}
\vspace{-1mm} %
\end{wrapfigure}
