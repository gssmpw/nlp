
We establish relevant results for Section~\ref{sec:optmain}. Our analysis follows very closely the recent work by~\citet{banerjee2022restricted} and generalizes it. We now provide all the relevant proofs.
%, and we provide all proofs here for the sake of completeness.

We start with the following lemma which shows that Condition~\ref{cond:rsc} implies a form of restricted PL condition. 
%
\begin{lemm}[{\bf Restricted PL}]\label{lemm:RPL}
Assume Condition~\ref{cond:rsc} is satisfied. Then, $\gL$ satisfies a restricted form of the Polyak-Łojasiewicz (PL) condition w.r.t.~$(\mathcal{N}_t,\vtheta_t)$: 
\begin{equation}
\label{eq:RPL}
\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) \leq \frac{1}{2\alpha_t} \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2~.
\end{equation}
\label{lemm:rsc2}
\end{lemm}
\begin{proof}
Define 
\begin{equation*}
\hat{\gL}_{\vtheta_t}(\vtheta) := \gL(\vtheta_t) + \langle \vtheta - \vtheta_t, \nabla_\vtheta\gL(\vtheta_t) \rangle + \frac{\alpha_t}{2} \| \vtheta - \vtheta_t \|_2^2 ~.
\end{equation*}
%Since $\gL$ satisfies $\alpha_t$-RSC w.r.t.~$(Q^t_{\kappa}\cap B_{\rho}(\vtheta_0),\vtheta_t)$ 
By the $\alpha_t$-RSC property of Condition~\ref{cond:rsc}(\pcedit{c}), $\forall \vtheta' \in \mathcal{N}_t$, we have
\begin{align}
    \gL(\vtheta') \geq \hat{\gL}_{\vtheta_t}(\vtheta')~.
\label{eq:dom1}
\end{align}
Further, note that $\hat{\gL}_{\vtheta_t}(\cdot)$ is minimized at $\hat{\vtheta}_{t+1} := \vtheta_t - \nabla_\vtheta\gL(\vtheta_t)/\alpha_t$ and the minimum value is:
\begin{equation*}
    \inf_{\vtheta\in\R^p} \hat{\gL}_{\vtheta_t}(\vtheta) = \hat{\gL}_{\vtheta_t}(\hat{\vtheta}_{t+1}) = \gL(\vtheta_t) - \frac{1}{2\alpha_t} \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2 ~.
\end{equation*}
% In addition, $\hat{\vtheta}_{t+1} \in Q^t_{\kappa}$ since
% \begin{align*}
%     |\cos(\hat{\vtheta}_{t+1} - \vtheta_t, \nabla_\vtheta\gL(\vtheta_t)| = |\cos(- \nabla_\vtheta\gL(\vtheta_t)/\alpha_t, \nabla_\vtheta\gL(\vtheta_t))| = 1 \geq \kappa~,
% \end{align*}
% for any $\kappa \in (0,1/2]$.
%
Then, we have that 
\begin{equation}
\inf_{\vtheta \in \mathcal{N}_t} \hat{\gL}_{\vtheta_t} (\vtheta) \geq \inf_{\vtheta\in\R^p} \hat{\gL}_{\vtheta_t}(\vtheta) = \gL(\vtheta_t) - \frac{1}{2\alpha_t} \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2~.
\label{eq:oxii}
\end{equation}
This means that that $\hat{\gL}_{\vtheta_t}(\cdot)$ is lower bounded by the expression on the right-hand side of~\eqref{eq:oxii} and so we can take the infimum over $\mathcal{N}_t$ on both sides of~\eqref{eq:dom1} and obtain   
\begin{equation}
\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) \geq \inf_{\vtheta \in \mathcal{N}_t} \hat{\gL}_{\vtheta_t} (\vtheta)~.
\label{eq:oxii2}
\end{equation}
Finally, we obtain the expression in~\eqref{eq:RPL} by using both inequalities in~\eqref{eq:oxii} and~\eqref{eq:oxii2} and rearranging terms. 
%
\label{lemm:QTk} 
\end{proof}

Next, we show that the restricted PL condition on $\mathcal{N}_t$ in Lemma~\ref{lemm:RPL} along with smoothness (Condition~\ref{cond:smooth}) can be used to show a loss reduction on $\mathcal{N}_t$. 
%
\begin{lemm}[{\bf Local loss reduction}]
Assume Conditions~\ref{cond:rsc} and \ref{cond:smooth} with $\alpha_t \leq \beta$ at step $t$ of the GD update as in \eqref{eq:gd_at_t} with step-size $\eta_t=\frac{\omega_t}{\beta}$ for some $\omega_t \in(0,2)$.
Then, we have 
%\pcedit{either $\gL(\vtheta_{t+1})\leq \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$ or }
\begin{equation}
    \gL(\vtheta_{t+1}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)  \leq \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t) \right) (\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta))~.
    \label{eq:conv-1_app}
\end{equation}
\label{lemm:local_loss}
\end{lemm}
%
\proof 
%\pcedit{If $\gL(\vtheta_{t+1})\leq \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, then there is nothing to prove, and so we focus on the case $\gL(\vtheta_{t+1})>\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$.} 
%
Since $\gL$ is $\beta$-smooth by Condition~\ref{cond:smooth}, we have
\begin{equation}
    \label{eq:lemma2-aux}
\begin{aligned}
\gL(\vtheta_{t+1}) & \leq \gL(\vtheta_t) + \langle \vtheta_{t+1} - \vtheta_t, \nabla_\vtheta\gL(\vtheta_t) \rangle + \frac{\beta}{2}\| \vtheta_{t+1} - \vtheta_t \|_2^2 \\
& = \gL(\vtheta_t) - \eta_t \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2  + \frac{\beta \eta_t^2}{2} \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2 \\
& = \gL(\vtheta_t) - \eta_t \left(1 - \frac{\beta \eta_t}{2} \right) \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2~.
\end{aligned}
\end{equation}
Since $\alpha_t>0$ by assumption, from Lemma~\ref{lemm:RPL} we obtain
\begin{align*}
    - \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2 \leq - 2\alpha_t (\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) )~.
\end{align*}
Hence
\begin{align*}
\gL(\vtheta_{t+1}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) & \leq \gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)  - \eta_t \left(1 - \frac{\beta \eta_t}{2} \right) \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2  \\
& \overset{(a)}{\leq} \gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - 
\eta_t \left(1 - \frac{\beta \eta_t}{2} \right)2\alpha_t(\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)) \\
& = \left(1 - 
2\alpha_t\eta_t \left(1 - \frac{\beta \eta_t}{2} \right)
\right) (\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta))
\end{align*}
where (a) follows for any $\eta_t\leq \frac{2}{\beta}$ because this implies $1-\frac{\beta\eta_t}{2}\geq 0$. Choosing $\eta_t = \frac{\omega_t}{\beta}, \omega_t \in (0,2)$,
$$
    \gL(\vtheta_{t+1}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)  \leq \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t)\right) (\gL(\vtheta_t) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta))~.
$$
This completes the proof. \qed

Finally, we show that the local loss reduction result in $\mathcal{N}_t$ from Lemma~\ref{lemm:local_loss} can be extended to show loss reduction in $\mathcal{B}(\vtheta_0)$, which is the main optimization result. 
%
\GlobalLossSmooth*
\begin{proof} We start by showing $\gamma_t = \frac{\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)}{\gL(\vtheta_t) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)}$ satisfies $0 \leq \gamma_t < 1$. \pcedit{First of all, we note that this quantity is well-defined because we are assuming that $\gL(\vtheta_t)\neq \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)$, i.e., that the current iterate does not attain the minimum loss.}
The fact that $\gamma_t \geq 0$ follows immediately from $\underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)< \gL(\vtheta_{t})$ and $\underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)\leq \underset{\vtheta \in \mathcal{N}_t}{\inf} \gL(\vtheta)$ since $\mathcal{N}_t\subseteq\cB(\vtheta_0)$ by Condition~\ref{cond:rsc}(a).
%
%First, we observe that, since $\bar{\vtheta} \in \underset{\vtheta \in \mathcal{B}(\vtheta_0)}{\arginf} \gL(\vtheta)$, $\bar{\vtheta}_{t+1} \in \underset{\vtheta \in \mathcal{N}_t}{\arginf}~\gL(\vtheta)$ and $\vtheta_{t+1} \in \mathcal{N}_t$ by assumption, we have 
%\begin{align}
%\label{eq:oinkaaa1}
%\gL(\bar{\vtheta}) \leq \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) \leq \gL(\vtheta_{t+1}) \overset{(a)}{\leq} \gL(\vtheta_t) - \eta_t \left( 1 - \frac{\beta \eta_t}{2} \right) \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2 \overset{(b)}{\leq} \gL(\vtheta_t)~, 
%\end{align}
%where (a) follows from~\eqref{eq:lemma2-aux} and (b) follows since $\eta_t = \frac{\omega_t}{\beta}$ with $\omega_t \in (0,2)$. Thus, equation~\eqref{eq:oinkaaa1} immediately shows that $\gamma_t\geq 0$ and that $\gamma_t$ cannot be greater than $1$; i.e., we have shown that $0\leq \gamma_t\leq 1$.
%
%
Now, there are two ways to prove that $\gamma_t<1$ depending on whether we consider 
%element that belongs to the set $\mathcal{N}_t$ in 
Condition~\ref{cond:rsc}(b.1) or Condition~\ref{cond:rsc}(b.2).
%we consider. 

We start by considering Condition~\ref{cond:rsc}(b.1) and 
%, which has $\vtheta_{t+1}\in \mathcal{N}_t$.
%Now, we 
prove by contradiction that $\gamma_t<1$. Assume that $\gamma_t\geq 1$, i.e., 
%Then, 
$\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta)\geq \cL(\vtheta_{t})$. Then, we note that 
\begin{align}
\label{eq:oinkaaa1}
%\gL(\bar{\vtheta}) \leq 
\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) \overset{(a)}{\leq} \gL(\vtheta_{t+1}) \overset{(b)}{\leq} \gL(\vtheta_t) - \eta_t \left( 1 - \frac{\beta \eta_t}{2} \right) \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2 \overset{(c)}{\leq} \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)- \eta_t \left( 1 - \frac{\beta \eta_t}{2} \right) \| \nabla_\vtheta\gL(\vtheta_t) \|_2^2~, 
\end{align}
where (a) follows from $\vtheta_{t+1}\in\mathcal{N}_t$, (b) from~\eqref{eq:lemma2-aux}, and (c) from $\gamma_t\geq 1$. Then, comparing the leftmost and rightmost inequalities in~\eqref{eq:oinkaaa1}, we must have $\| \nabla_\vtheta\gL(\vtheta_t) \|_2 = 0$ since $\eta_t \left( 1 - \frac{\beta \eta_t}{2} \right)>0$ because of $\eta_t = \frac{\omega_t}{\beta}$ with $\omega_t \in (0,2)$. 
%Then, $\| \nabla_\vtheta\gL(\vtheta_t) \|_2 = 0$ 
%
%This then implies that all the inequalities in~\eqref{eq:oinkaaa1} are also equalities, which then implies that $\vtheta_t=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, 
%
Now, when considering Condition~\ref{cond:rsc}(b.1), we either assumed that $\vtheta\notin\mathcal{N}_t$ or that $\gL(\vtheta_t)\neq\underset{\vtheta \in \mathcal{N}_t}{\inf} \gL(\vtheta)$; thus, we analyze both cases.
\begin{enumerate}[(i)]
    \item \label{condi}\textbf{Assuming $\vtheta\notin\mathcal{N}_t$:} Note that $\| \nabla_\vtheta\gL(\vtheta_t) \|_2 = 0$ implies $ \nabla_\vtheta\gL(\vtheta_t) = \vzero_p$ (i.e., the gradient evaluated at $\vtheta_t$ is the zero vector), which then, due to GD in~\eqref{eq:gd_at_t}, implies $\vtheta_t=\vtheta_{t+1}$. Since we had $\vtheta_{t+1}\in\mathcal{N}_t$, this then means that $\vtheta_t\in\mathcal{N}_t$---a contradiction to our assumption.
    \item \label{condii}\textbf{Assuming $\gL(\vtheta_t)\neq\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta)$:} Note that $\| \nabla_\vtheta\gL(\vtheta_t) \|_2 = 0$ implies that all the inequalities in~\eqref{eq:oinkaaa1} are also equalities. This then implies that $\gL(\vtheta_t)=\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta)$---a contradiction to our assumption.
\end{enumerate}
%=============
%This implies $ \nabla_\vtheta\gL(\vtheta_t) = \vzero_p$ (i.e., the gradient is the zero vector), which then, due to GD, implies $\vtheta_t=\vtheta_{t+1}$. This then means that $\vtheta_t\in\mathcal{N}_t$, 
%which contradicts our assumption in Condition~\ref{cond:rsc}(b.1) if we consider the condition $\vtheta_{t}\notin \mathcal{N}_t$. 
%%i.e., that $\vtheta_{t}\notin \arg\inf_{\vtheta\in\mathcal{N}_t}\cL(\vtheta)$. 
%%
%Otherwise, we also observe that all the inequalities in~\eqref{eq:oinkaaa1} are also equalities, which then implies that $\gL(\vtheta_t)=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, which contradicts our assumption in Condition~\ref{cond:rsc}(b.1) if we consider the condition $\gL(\vtheta_t)\neq\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$.
%% 
%==============
In either case~\eqref{condi} or~\eqref{condii}, our proof by contradiction shows that 
%Therefore, we have 
$\gamma_t < 1$. 
%
%
%===
%Then, using the RSC condition satisfied in $\mathcal{N}_t$ and %$\vtheta_t, 
%$\bar{\vtheta}_{t+1} \in \mathcal{N}_t$, we have 
%\begin{align*}
%\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) & \geq \gL(\vtheta_t) + \langle \bar{\vtheta}_{t+1} - \vtheta_t, \nabla _\vtheta\gL(\vtheta_t)  \rangle + \frac{\alpha_t}{2} \| \bar{\vtheta}_{t+1} - \vtheta_t \|^2_2 \\
%& \overset{(a)}{=}  \gL(\vtheta_t) + \frac{\alpha_t}{2} \| \bar{\vtheta}_{t+1} - \vtheta_t \|^2_2~,
%\end{align*}
%where (a) follows from $\| \nabla_\vtheta\gL(\vtheta_t) \|_2 = 0$. Now, using this expression, we observe that 
%$\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)=\cL(\vtheta_{t})$ can only hold if and only if $\bar{\vtheta}_{t+1} = \vtheta_t$, but this contradicts our assumption in Condition~\ref{cond:rsc}(a), i.e., that $\vtheta_{t}\notin \arg\inf_{\vtheta\in\mathcal{N}_t}\cL(\vtheta)$. Therefore,  
%%since $\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) = \gL(\vtheta_t)$.
%%Further, since $\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) < \gL(\vtheta_t)$, 
%we have $\gamma_t < 1$.
%===

We now consider Condition~\ref{cond:rsc}(b.2) with the 
%Now, we consider the second way of proving $\gamma_t < 1$ by considering 
element $\vtheta'\in\mathcal{N}_t$ as described in the condition's statement.  %Condition~\ref{cond:rsc}(b.2). 
We immediately obtain that $\vtheta'$ satisfies $\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta) \leq \cL(\vtheta') < \cL(\vtheta_t)$, which then implies $\gamma_t<1$.

%Note that we know $a_t>0$ because, otherwise, the iterate $\vtheta_t$ would be in a stationary point, i.e., $\vtheta_t$ would already be a local minimum we are trying to find.

%Having proved that $\gamma_t<1$, 

Having shown that $\gamma_t<1$ according to Condition~\ref{cond:rsc}(b), we now proceed to prove equation~\eqref{eq:conv-0}.
%~\eqref{eq:conv-1}.
\pcedit{We consider two cases: (A) $\gamma_t>0$ and (B) $\gamma_t = 0$.} 

\pcedit{We start by considering Case (A), which holds if and only if $\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta)>\underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)$.}
%
%\pcedit{Then, $\gL(\vtheta_{t+1})\neq\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$ since, otherwise, we would have that $\gL(\vtheta_{t+1})=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)>\gL(\bar{\vtheta}$ which contradicts the assumption of Case (A).
%
%\pcedit{
%We then need to consider three Sub-cases: (A.1) $\gL(\vtheta_{t+1})=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, (A.2) $\gL(\vtheta_{t+1})< \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, and (A.3) $\gL(\vtheta_{t+1})> \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$.}
%
%\pcedit{For Sub-case (A.1)
%%, if $\gL(\vtheta_{t+1})=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, then 
%it immediately follows that $\gL(\vtheta_{t+1})>\gL(\bar{\vtheta})$ and so 
%\pcedit{\begin{align*}
%\gL(\vtheta_{t+1}) - \gL(\bar{\vtheta}) 
%&\overset{(a)}{=} \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - \gL(\bar{\vtheta}))\\
%&= \gamma_t (\gL(\vtheta_{t}) - \gL(\bar{\vtheta}))
%~,
%\end{align*}where (a) follows by assumption of Sub-case (A.1).}
%%
%%
%%it immediately follows that $\gL(\vtheta_{t+1})=\gL(\bar{\vtheta})$, i.e., the next iteration attains the minimum loss and there nothing else to prove. 
%%
%For Sub-case (A.2),
%%if $\gL(\vtheta_{t+1})< \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$, then, 
%since we already have $\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)>\gL(\bar{\vtheta})$, there is nothing much to affirm than the obvious fact that $\gL(\bar{\vtheta})\leq \gL(\vtheta_{t+1})$ must hold. We focus on $\gL(\bar{\vtheta})< \gL(\vtheta_{t+1})$ since there is nothing to prove for  $\gL(\vtheta_{t+1})=\gL(\bar{\vtheta})$. Thus, } 
%\pcedit{\begin{align*}
%\gL(\vtheta_{t+1}) - \gL(\bar{\vtheta}) 
%&\overset{(a)}{<} \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - \gL(\bar{\vtheta}))\\
%&= \gamma_t (\gL(\vtheta_{t}) - \gL(\bar{\vtheta}))
%~,
%\end{align*}where (a) follows by assumption of Sub-case (A.2).} 
%\pcedit{Now, moving to Sub-case (A.3), let us first
%} 
\pcedit{We now 
define $\delta_t:=\frac{\gL(\vtheta_t)-\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)}{\gL(\vtheta_t)-\underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)}$ and note that $\delta_t\in(0,1)$ since $\delta_t=1-\gamma_t$.} %Notice that $\delta_t=1$ only happens whenever $\gL(\bar{\vtheta})=\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$. 
%
%
Now, with $\omega_t \in (0,2)$, we have
\pcedit{\begin{align*}
\gL(\vtheta_{t+1}) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta) 
& = \gL(\vtheta_{t+1}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) + \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta) \\
& \overset{(a)}{\leq} \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t) \right) (\gL(\vtheta_{t}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)) +  (\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)) \\
& = \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t)\right)\delta_t (\gL(\vtheta_{t}) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)) + (1-\delta_t)(\gL(\vtheta_t) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)) \\
& \overset{(b)}{=} \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t)(1-\gamma_t)\right) (\gL(\vtheta_{t}) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta))~,
\end{align*}}\pcedit{which is~\eqref{eq:conv-0}, and} where (a) follows from Lemma~\ref{lemm:local_loss} %\pcedit{considering that $\cL(\vtheta_{t+1})>\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$ by assumption of Sub-case (A.3),} 
\pcedit{and (b) 
follows from
%
$$
\left(1-\frac{\alpha_t\omega_t}{\beta}(2-\omega_t)\right)\delta_t+(1-\delta_t)=1-\frac{\alpha_t\omega_t}{\beta}(2-\omega_t)\delta_t=1-\frac{\alpha_t\omega_t}{\beta}(2-\omega_t)(1-\gamma_t)~.
$$
}

\pcedit{We now consider Case (B), i.e., $\gamma_t=0$, which holds if and only if $\underset{\vtheta \in \mathcal{N}_t}{\inf}\gL(\vtheta)=\underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta)$.} 
\pcedit{Then, we have 
\pcedit{\begin{align*}
\gL(\vtheta_{t+1}) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta) 
& = \gL(\vtheta_{t+1}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta) \\
& \overset{(a)}{\leq} \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t) \right) (\gL(\vtheta_{t}) - \inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta))\\
& = \left(1-\frac{\alpha_t \omega_t}{\beta}(2-\omega_t)\right) (\gL(\vtheta_{t}) - \underset{\vtheta \in \cB(\vtheta_0)}{\inf} \gL(\vtheta))~,
\end{align*}}which is~\eqref{eq:conv-0} when $\gamma_t=0$, and where (a) follows from Lemma~\ref{lemm:local_loss}.}
%considering that $\cL(\vtheta_{t+1})>\inf_{\vtheta \in \mathcal{N}_t} \gL(\vtheta)$ by assumption of Sub-case (B.2).} 
This completes the proof.
\label{theo:global}
\end{proof}
