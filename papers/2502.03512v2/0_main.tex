% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\RequirePackage[svgnames]{xcolor}

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[final]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

\usepackage[draft,textsize=footnotesize,textwidth=15mm]{todonotes}
%\usepackage[usenames,dvipsnames]{color}


% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
%\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}
\usepackage{inconsolata}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath,amssymb}
\usepackage{soul}
% \usepackage[margin=2cm]{geometry}
\usepackage{tikz}

% Style definition
\tikzset{rndblock/.style={rounded corners,rectangle,draw,scale=0.8,outer sep=0pt}}

% Command Definition
% 1 optional to customize the aspect, 2 mandatory: text to be framed
\newcommand{\tframed}[2][]{\tikz[baseline=(h.base)]\node[rndblock,#1] (h) {#2};}

\usetikzlibrary{shapes.geometric}
\usepackage{framed}
\usepackage{enumitem}
\newlist{RQ}{enumerate}{1}
\setlist[RQ]{label=\textbf{RQ\,\arabic*},ref={RQ\,\arabic*}}
\usepackage{comment}
\usepackage{natbib}
\usepackage{multibib}
\makeatletter
\usepackage{booktabs}
\usepackage[inkscapeformat=png]{svg}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tabularx}
\usepackage{soul}
\usepackage{float}
\usepackage{enumitem}
\usepackage{pifont}
\usepackage{arydshln}
\usepackage{lipsum}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[T1]{fontenc}
\usepackage{pifont}
\usepackage{amsmath}
\usepackage{soul}
\usepackage[utf8]{inputenc}
\usepackage{inconsolata}
\usepackage{tikz}
\usepackage{arydshln}
\usepackage{lipsum}
\usepackage[normalem]{ulem}
\usepackage{wrapfig,graphicx,lipsum}% http://ctan.org/pkg/{wrapfig,graphicx,lipsum}
% \usepackage{graphicx}
%\usepackage[table,xcdraw]{xcolor}
\usepackage{colortbl} 
%\usepackage[dvipsnames]{xcolor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{uncial}

\usepackage{soul}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{colortbl}
%\usepackage{xcolor}
%\usepackage[table]{xcolor}
\usepackage{afterpage}  % load the afterpage package
\usepackage{tabularx} % Add to your preamble
\usepackage{multicol} % For structured multiline text
\usepackage{array}    % Enhanced column types
\usepackage{rotating}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{array}



% \usepackage[draft,textsize=footnotesize,textwidth=15mm]{todonotes}
% \newcommand\ac[1]{\todo[author=AC,color=blue!40]{#1}}
% \newcommand\acil[1]{\todo[author=AC,color=blue!40,inline]{#1}}
% \newcommand\acb[1]{\textcolor{blue}{#1}}





\usepackage[most,many]{tcolorbox}

% \usepackage{tcolorbox}
% \tcbuselibrary{skins}

\newtcolorbox{defin}{colback=Teal!5!White,enhanced,title=DPO - Kernels (at-a-glance),
	attach boxed title to top left={xshift=0mm},boxrule=0pt,after skip=1cm,before skip=1cm,right skip=0cm,breakable,fonttitle=\bfseries,toprule=0pt,bottomrule=0pt,rightrule=0pt,leftrule=3pt,arc=0mm,skin=enhancedlast jigsaw,sharp corners,colframe=Teal!55!black,colbacktitle=Teal!55!black,boxed title style={
		frame code={ 
			\fill[Teal!25!black](frame.south west)--(frame.north west)--(frame.north east)--([xshift=3mm]frame.east)--(frame.south east)--cycle;
			\draw[line width=1mm,Teal!25!black]([xshift=2mm]frame.north east)--([xshift=5mm]frame.east)--([xshift=2mm]frame.south east);
			\draw[line width=1mm,Teal!25!black]([xshift=5mm]frame.north east)--([xshift=8mm]frame.east)--([xshift=5mm]frame.south east);
			\fill[Teal!25!black](frame.south west)--+(4mm,-2mm)--+(4mm,2mm)--cycle;
		}
	}
}

% \setlist{leftmargin=1mm}
\usetikzlibrary{shapes.geometric, arrows}
\usetikzlibrary{decorations.markings}

\usepackage{fancybox}

\usepackage{hyperref}
 \definecolor{darkblue}{rgb}{0, 0, 0.5}
  \hypersetup{colorlinks=true, citecolor=darkblue, linkcolor=darkblue, urlcolor=darkblue}

\definecolor{vgreen}{HTML}{60A917}
\definecolor{vred}{HTML}{CE3A29}

\usepackage{xstring}
\usepackage{longtable}
\usepackage{supertabular}



\usepackage{lipsum}
\usepackage{tikz}
\usetikzlibrary{trees,shapes}

\usepackage{epigraph}
\definecolor{hidden-draw}{RGB}{20,68,106}
\definecolor{hidden-pink}{RGB}{255,245,247}
\definecolor{paired-light-yellow}{HTML}{FFFF88}
\definecolor{paired-light-blue}{HTML}{CCE5FF}
\definecolor{paired-light-orange}{HTML}{FFCC99}
\definecolor{paired-dark-yellow}{HTML}{FFF2CC}
\definecolor{paired-light-pink}{HTML}{FFCCCC}
\definecolor{paired-cyan}{HTML}{D5E8D4}
\definecolor{paired-gray}{HTML}{eeeeee}
\definecolor{paired-green}{HTML}{cdeb8b}
\definecolor{paired-blue}{HTML}{dae8fc}
\definecolor{paired-dark-cyan}{HTML}{a2e6eb}
\definecolor{paired-dark-pink}{HTML}{e7b2d2}
\definecolor{paired-purple}{HTML}{9999ff}
\definecolor{paired-pink}{HTML}{cc99ff}
\definecolor{paired-orange}{HTML}{ffcc99}


\definecolor{a1}{RGB}{241,233,191}
\definecolor{a2}{RGB}{255,241,218}

\definecolor{a3}{RGB}{255,239,213}
\definecolor{a4}{RGB}{250,235,215}
\definecolor{a5}{RGB}{255,239,219}
\definecolor{a6}{RGB}{255,246,225}
\definecolor{a7}{RGB}{246,227,201}
\definecolor{a8}{RGB}{254,235,226}
\definecolor{a9}{RGB}{247,220,111}
\definecolor{a10}{RGB}{199,211,189}
\definecolor{a11}{RGB}{209,196,233}
\definecolor{a12}{RGB}{214,234,248}
\definecolor{a13}{RGB}{232,245,233}
\definecolor{a14}{RGB}{237,248,177}
\definecolor{a15}{RGB}{255,228,225}
\definecolor{a16}{RGB}{255,228,181}
\definecolor{a17}{RGB}{255,222,173}
\definecolor{a18}{RGB}{255,218,185}
\definecolor{a19}{RGB}{255,203,164}
\definecolor{a20}{RGB}{247,202,201}

\definecolor{a21}{RGB}{241,254,255}
\definecolor{a22}{RGB}{230,252,252}
\definecolor{a23}{RGB}{179,236,255}
\definecolor{a24}{RGB}{174,226,249}
\definecolor{a25}{RGB}{208,234,246}
\definecolor{a26}{RGB}{189,226,219}
\definecolor{a27}{RGB}{177,204,201}

\definecolor{a28}{RGB}{216,195,216}
\definecolor{a29}{RGB}{195,155,211}
\definecolor{a30}{RGB}{208,152,223}
\definecolor{a31}{RGB}{255,183,209}
\definecolor{a32}{RGB}{255,167,209}
\definecolor{a33}{RGB}{254,235,167}
\definecolor{a34}{RGB}{255,222,137}
\definecolor{a35}{RGB}{254,180,154}
\definecolor{a36}{RGB}{247,148,161}
\definecolor{a37}{RGB}{239,154,154}
\definecolor{a38}{RGB}{255,130,171}
\definecolor{a39}{RGB}{255,105,180}
\definecolor{a40}{RGB}{251,142,172}


\usepackage[edges]{forest}
\usepackage{lipsum}
\usepackage{tikz}
\usetikzlibrary{trees,shapes}
\usepackage{forest}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage[export]{adjustbox} % Add this in the preamble
\usepackage{listings} % Add this in the preamble

% In the document
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    xleftmargin=0.05\columnwidth,
    xrightmargin=0.05\columnidth
}

\usepackage{amsmath} % For math formatting
%\usepackage{tcolorbox} % For colored boxes
%\tcbuselibrary{listingsutf8} % Optional for better customization

% Define a simple tcolorbox style
\tcbset{
  mybox/.style={
    colback=white,
    colframe=black,
    boxrule=0.5mm,
    width=\textwidth,
    left=2mm,
    right=2mm,
    bottom=2mm,
    top=2mm,
    sharp corners,
  }
}


\usepackage{tabularray}

\DefTblrTemplate{firsthead,middlehead,lasthead}{default}{
}
\DefTblrTemplate{firstfoot}{default}{
  \UseTblrTemplate{contfoot}{default}
  \UseTblrTemplate{caption}{default}
}
\DefTblrTemplate{middlefoot}{default}{
  \UseTblrTemplate{contfoot}{default}
  \UseTblrTemplate{capcont}{default}
}
\DefTblrTemplate{lastfoot}{default}{
  \UseTblrTemplate{note}{default}
  \UseTblrTemplate{remark}{default}
  \UseTblrTemplate{capcont}{default}
}


\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
% Multi-line left-aligned text with manual line breaks.
% The base line is in centre.
\newcommand*{\mline}[1]{%
\begingroup
    \renewcommand*{\arraystretch}{1.1}%
   \begin{tabular}[c]{@{}>{\raggedright\arraybackslash}p{2cm}@{}}#1\end{tabular}%
  \endgroup
}

\usepackage{color}
\tcbuselibrary{skins}

\usepackage[export]{adjustbox} % for the valign option

\usepackage{setspace}
%\usepackage[capitalise]{cleveref}
\usepackage[capitalise,nameinlink]{cleveref}

%\crefname{chapter}{chap.}{chap.}
\crefname{section}{Sec.}{Sec.}

\usepackage{microtype}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{comment}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{amsmath}
\usepackage{algpseudocode}
\usepackage{colortbl}
\usepackage[export]{adjustbox} % for the valign option
\usepackage{enumitem}
\setlist{leftmargin=1mm}
\usepackage{pifont}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{subcaption}
\usepackage{resizegather}
\usepackage{breqn}
\usepackage[capitalise]{cleveref}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows}
\usetikzlibrary{decorations.markings}
\usepackage{soul}
\usepackage{wrapfig,graphicx,lipsum}% http://ctan.org/pkg/{wrapfig,graphicx,lipsum}
\usepackage{extsizes}
\usepackage{cuted}
\usepackage{flushend}
\usepackage{float}
\usepackage{changepage,threeparttable}
\usepackage{setspace}
\usepackage{caption}
\usepackage{booktabs}
\usepackage{dblfloatfix} 
\usepackage{fixltx2e}
\usepackage[normalem]{ulem}

\usepackage{longtable}
\usepackage{amsmath}
\usepackage{array}
% \usepackage[margin=1in]{geometry} % Adjust page margins if necessary
\usepackage[most]{tcolorbox} 
%\usepackage{listings}
\setlength{\belowdisplayskip}{2pt} % Reduce spacing below equations
\setlength{\abovedisplayskip}{2pt} % Reduce spacing above equations
\setlength{\abovedisplayshortskip}{1pt} % Reduce spacing in inline equations
\setlength{\belowdisplayshortskip}{1pt}
%\documentclass[table,xcdraw]{article}
\usepackage{longtable} % For long tables that span multiple pages
\usepackage{graphicx} % For including images
\usepackage{array} % For defining custom column widths
\usepackage{caption} % For customizing captions
%usepackage{xcolor} % For text colors (optional, if needed)


% Optional: If using rotation or alignment enhancements
\usepackage{rotating} % For rotating text or images
\usepackage{booktabs} % For better table formatting (optional)
\usepackage{adjustbox} % To adjust image sizes dynamically







\DeclareRobustCommand{\hlpink}[1]{{\sethlcolor{pink}\hl{#1}}}
\DeclareRobustCommand{\hlgreen}[1]{{\sethlcolor{green}\hl{#1}}}

\usepackage{environ}

\newlength{\myl}
\expandafter\let\expandafter\origequation\csname equation*\endcsname
\expandafter\let\expandafter\endorigequation\csname endequation*\endcsname
\long\def\[#1\]{\begin{equation*}#1\end{equation*}}
\RenewEnviron{equation*}{
  \settowidth{\myl}{$\displaystyle\BODY$} % calculate width and save as \myl
  \origequation
    \ifdim\myl>\linewidth
      \resizebox{\linewidth}{!}{$\displaystyle\BODY$}% \myl > \linewidth
    \else
      \BODY % \myl <= \linewidth
    \fi
  \endorigequation
}


\makeatletter
\newcommand{\DrawLine}{%
  \begin{tikzpicture}
  \path[use as bounding box] (0,0) -- (\linewidth,0);
  \draw[color=blue!75!black,dashed,dash phase=.5pt]
        (0-\kvtcb@leftlower-\kvtcb@boxsep,0)--
        (\linewidth+\kvtcb@rightlower+\kvtcb@boxsep,0);
  \end{tikzpicture}%
  }
\makeatother

%resize/scale equations
\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}%
\newcommand*{\Resize}[2]{\resizebox{#1}{!}{$#2$}}%


%--Vipula---
% \newcommand\vr[1]{\todo[author=VR,color=green!20]{#1}}
% \newcommand\vril[1]{\todo[author=VR,color=green!20,inline,caption={}]{#1}}


% %--Aman---
% \newcommand\ac[1]{\todo[author=AC,color=blue!40]{#1}}
% \newcommand\acil[1]{\todo[author=AC,color=blue!40,inline]{#1}}
% \newcommand\acb[1]{\textcolor{blue}{#1}}
% \newcommand\act[1]{\textcolor{blue}{#1}}


% %--Amitava---
% \newcommand\ad[1]{\todo[author=AD,color=purple!40]{#1}}
% \newcommand\adil[1]{\todo[author=AD,color=purple!40,inline]{#1}}
% \newcommand\adt[1]{\textcolor{purple}{#1}}


\usepackage{euscript}[mathcal]
% \usepackage[margin=1in]{geometry}

\newcommand*{\affaddr}[1]{#1}
\newcommand*{\affmark}[1][*]{\textsuperscript{#1}}
\newcommand*{\email}[1]{\texttt{#1}}
%\newcommand*{\affmark}[1][*]{\textsuperscript{#1}}
\author{
  Amitava Das\affmark[1], \bf Yaswanth Narsupalli\affmark[1], Gurpreet Singh\affmark[1],  \bf Vinija Jain\affmark[2]\thanks{\,\,\,Work done outside of role at Meta.}, 
  \bf Vasu Sharma\affmark[2]\footnotemark[1], \\\bf Suranjana Trivedy\affmark[1], 
  \bf Aman Chadha\affmark[3]\thanks{\,\,\,Work done outside of role at Amazon.}, Amit Sheth\affmark[1] \\
  \affaddr{\affmark[1]Artificial Intelligence Institute, University of South Carolina, USA,}\\
  \affaddr{\affmark[2]Meta AI, USA,}
  \affaddr{\affmark[3]Amazon AI, USA}
}



\title{\centering\includegraphics[width=\textwidth]{img/banner.pdf} }
%{\fontfamily{cmss}\selectfont DPO - Kernels}: A Semantically-Aware, Kernel-Enhanced, and Divergence-Rich Paradigm for Direct Preference Optimization}




% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a seperate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\forestset{
  my leaf/.style={
    fill=#1,
    draw=none
  }
}

\setlength{\topmargin}{-1.25cm}
% \setlength{\bottom}{-1.25cm}
\setlength{\textheight}{24.25cm}

\begin{document}
\maketitle
\begin{abstract}
Precise alignment in Text-to-Image (T2I) systems is crucial to ensure that generated visuals not only accurately encapsulate user intents but also conform to stringent ethical and aesthetic benchmarks. Incidents like the Google Gemini fiasco, where misaligned outputs triggered significant public backlash, underscore the critical need for robust alignment mechanisms. In contrast, Large Language Models (LLMs) have achieved notable success in alignment. Building on these advancements, researchers are eager to apply similar alignment techniques, such as Direct Preference Optimization (DPO), to T2I systems to enhance image generation fidelity and reliability.

% We introduce \textbf{YinYangAlign}, a comprehensive benchmark designed to evaluate the alignment of T2I systems across six pairs of contradictory objectives. 
We present \textbf{YinYangAlign}, an advanced benchmarking framework that systematically quantifies the alignment fidelity of T2I systems, addressing six fundamental and inherently contradictory design objectives. Each pair represents fundamental tensions in image generation, such as balancing adherence to user prompts with creative modifications or maintaining diversity alongside visual coherence. YinYangAlign includes detailed axiom datasets featuring human prompts, aligned (chosen) responses, misaligned (rejected) AI-generated outputs, and explanations of the underlying contradictions.

In addition to presenting this benchmark, we introduce \textbf{Contradictory Alignment Optimization (CAO)}, a novel extension of DPO. The CAO framework incorporates a per-axiom loss design to explicitly model and address competing objectives. Then it optimizes these objectives using multi-objective optimization techniques, including \textit{synergy-driven global preferences}, \textit{axiom-specific regularization}, and the novel \textit{synergy Jacobian} for effectively balancing contradictory goals. By utilizing tools such as the \textit{Sinkhorn-regularized Wasserstein Distance}, CAO achieves both stability and scalability while setting new performance benchmarks across all six contradictory alignment objectives.


%In addition to introducing this benchmark, we present results from applying DPO to YinYangAlign. Furthermore, we propose a novel loss function for DPO, termed \textbf{Hybrid Loss}, which demonstrates improved performance in balancing conflicting objectives compared to traditional DPO. Nonetheless, our evaluation reveals that \textbf{YinYangAlign} sets a new, stringent benchmark that current techniques, including Hybrid Loss, must strive to meet. This underscores YinYangAlignâ€™s role in pushing the boundaries of T2I alignment and highlights the ongoing need for sophisticated alignment mechanisms. 
\end{abstract}



\input{1_intro}
\input{2_yinyang}
\input{3_data}
\input{4_DPO}
\input{3_evaluation}
\input{5_conclusion}
\newpage
\input{6_limitations}


%\input{4_eval}

%\newpage
%\input{6_layers}
%\newpage
%\input{7_generalization}
%\newpage

%\newpage
%\input{9_limitations}

% Entries for the entire Anthology, followed by custom entries
\newpage
\bibliography{yinyang.bib}
% \bibliographystyle{acl_natbib}
\newpage

\input{7_faq}
\input{8_appendix}

%\newpage
%\input{10_faq}
%\newpage
%\input{11_appendix}

\end{document}