\newcommand{\Deltab}{\boldsymbol{\Delta}}
\newcommand{\Sbo}{\overline{\Sb}}
\newcommand{\Yo}{\overline{\Y}}
\newcommand{\yi}{{y_i}}
\newcommand{\vect}[1]{\operatorname{vec}\big(#1\big)}

\newcommand{\Lcexp}{\Lc_{\rm{exp}}}
\newcommand{\Lcpll}{\Lc_{\rm{pll}}}
\newcommand{\Gcpll}{\Gc_{\rm{pll}}}

\newcommand{\ninf}[1]%{{\left\|#1(:)\right\|_{\infty}}}
{{\left\|#1\right\|_{\max}}}

\newcommand{\none}[1]
{{\left\|#1\right\|_{\rm{sum}}}}

\usepackage[mathscr]{euscript}
\newcommand{\dt}[1]{\frac{\mathrm{d}{#1}}{\mathrm{d}t}}
\newcommand{\yj}{y_j}
\newcommand{\ebt}{\widetilde{\vct{e}}}
\newcommand{\KL}{{\operatorname{KL}}}
\newcommand{\xd}{\bar{\x}}
\newcommand{\hd}{{\bar{{\hb}}}}
\newcommand{\Hd}{{\bar{{\Hb}}}}
\newcommand{\Hmm}{\Hb^{\rm{mm}}}
\newcommand{\pih}{\hat{\pi}}
\newcommand{\ph}{\hat{p}}
\newcommand{\pbh}{\hat{\pb}}
\newcommand{\CE}{\operatorname{CE}}
\newcommand{\CEin}{\operatorname{CE}_{\rm{in}}}
\newcommand{\CEinstar}{\operatorname{CE}_{\rm{in},\star}}
\newcommand{\CEout}{\operatorname{CE}_{\rm{out}}}
\newcommand{\ent}{\Hc}
\newcommand{\Wstar}{\W^\star}
\newcommand{\wstar}{\w^\star}
\newcommand{\Wf}{\W^{\rm{p}}}
\newcommand{\wf}{{\w}^{\rm{p}}}
\newcommand{\Wsbar}{\overline{\Ws}}
\newcommand{\Ws}{\W^{\rm{d}}}
\newcommand{\ws}{{\w}^{\rm{d}}}
\newcommand{\Wmm}{\W^{\rm{mm}}}
\newcommand{\wmm}{{\w}^{\rm{mm}}}
\newcommand{\Wt}{\widetilde\W}
\newcommand{\NTP}{\text{NTP}\xspace}
\newcommand{\NTPH}{\text{NTP}$_{\ent}$\xspace}
\newcommand{\SVM}{\text{NTP-SVM}}
\newcommand{\Eb}{\mtx{E}}
\newcommand{\What}{\widehat{\W}}
\newcommand{\ellb}{\boldsymbol{\ell}}
\newcommand{\ellbbstar}{\ellbb^\star}
\newcommand{\ellbbmm}{\ellbb^{\rm{mm}}}
\newcommand{\ellbb}{\boldsymbol{l}}
\newcommand{\ellbhat}{\widehat{\ellbb}}
\newcommand{\ellf}{\ellb^{\rm{p}}}
\newcommand{\ellstar}{\ellb^{\star}}
\newcommand{\ellmm}{\ellb^{\rm{mm}}}
\newcommand{\ellt}{\widetilde\ellb}
\newcommand{\Ts}{\mathscr{F}}
\newcommand{\Tc}{\mathcal{T}}
\newcommand{\pt}{\mathbf{\mathcal{P}}_\Ts}
\newcommand{\ptp}{\mathbf{\mathcal{P}}_\perp}
\newcommand{\Lbo}{{\overline\Lb}}
\newcommand{\Lbmm}{\Lb^{\rm{mm}}}
\newcommand{\GHmm}{\GH^{\rm{mm}}}
\newcommand{\GHmmo}{\overline{\G}_{\Hb}^{\rm{mm}}}
\newcommand{\GWmm}{\GW^{\rm{mm}}}
\newcommand{\GWmmo}{\overline{\G}_{\W}^{\rm{mm}}}
\newcommand{\Lbmmo}{{\overline\Lbmm}}
% \newcommand{\Lbtina}{\Lb^\text{$\diamond$}}
\newcommand{\Lbtina}{\smatbar}
\newcommand{\Lbstar}{{\Lb^\star}}
\newcommand{\Lbin}{\Lb^{\rm{in}}}
\newcommand{\Fcmm}{\Fc_{\rm{mm}}}
\newcommand{\lt}{{<t}}
\newcommand{\leqt}{{\leq t}}
\newcommand{\relu}{\operatorname{ReLU}}
\newcommand{\Win}{\W_{\rm{in}}}
\newcommand{\din}{d_{\rm{in}}}
\newcommand{\Umm}{\Ub^{\rm{mm}}}
\newcommand{\Ummt}{\Ub^{\rm{mm},\top}}
\newcommand{\Smm}{\Sigmab^{\rm{mm}}}
\newcommand{\Vmm}{\Vb^{\rm{mm}}}
\newcommand{\Vmmt}{\Vb^{\rm{mm},\top}}
\newcommand{\Ustar}{\Ub^{\star}}
\newcommand{\Ustart}{\Ub^{\star,\top}}
\newcommand{\Sstar}{\Sigmab^{\star}}
\newcommand{\Vstart}{\Vb^{\star,\top}}
\newcommand{\Util}{\tilde\Ub}
\newcommand{\Utilt}{\tilde\Ub^\top}
\newcommand{\Stil}{\tilde\Sigmab}
\newcommand{\Vtil}{\tilde\Vb}
\newcommand{\Vtilt}{\tilde\Vb^\top}
\newcommand{\Pbmm}{\mtx{P}^{\rm{mm}}}
\newcommand{\Ebin}[1]{\Eb_{\rm{in},#1}}
\newcommand{\Ebint}[1]{\widetilde{\Eb}_{\rm{in},#1}}
\newcommand{\Ebout}[1]{\Eb_{\rm{out},#1}}
\newcommand{\Pib}{\boldsymbol{\Pi}}
\newcommand{\sqrtm}[1]{#1^{\frac{1}{2}}}
\newcommand{\rankset}{\mathcal{R}}
\newcommand{\smat}{\Sb}
\newcommand{\smatbar}{\widetilde{\smat}}
\newcommand{\cosa}[2]{{\operatorname{cos}}\big(#1,#2\big)}
% \newcommand{\cosrow}[1]{\widecheck{#1}\,{\widecheck{#1}}^\top}
% \newcommand{\coscol}[1]{{\widehat{#1}}^\top\widehat{#1}}
% \newcommand{\corr}[1]{\operatorname{CORR}{#1}}
\newcommand{\Qcs}{\mathcal{P}_{\Ts}}
\newcommand{\Qcsperp}{\mathcal{P}_{\perp}}
\newcommand{\GW}{\G_\W}
\newcommand{\GH}{\G_{\Hb}}
\newcommand{\PMI}{\textbf{PMI}}

\newcommand{\Lb}{\vct{L}}
\newcommand{\Lbhat}{\widehat{\vct{L}}}
\newcommand{\Lbtil}{\widetilde{\vct{L}}}

\newcommand{\rank}[1]{\operatorname{rank}\left(#1\right)}

\newcommand{\laz}{{\la\rightarrow0}}
\newcommand{\Binf}{{B\rightarrow\infty}}
\newcommand{\Rinf}{{R\rightarrow\infty}}
\newcommand{\Hbhat}{\hat\Hb}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\new}[1]{\textcolor{blue}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\red}[1]{\textcolor{magenta}{#1}}
\newcommand{\ct}[1]{\textcolor{darkgreen}{\textbf{C:} #1}}
% \newcommand{\tina}[1]{\textcolor{red}{TB: #1}}
% \newcommand{\vala}[1]{\textcolor{darkgreen}{VV: #1}}
\newcommand{\cf}[1]{\textcolor{purple}{chen: #1}}


% \usepackage{hyperref,graphicx,amsmath,amsthm,amsfonts,amssymb,bm,url,breakurl,epsfig,epsf,color,MnSymbol,mathbbol,fmtcount,semtrans,caption,multirow,comment, boldline}
%\usepackage[]{algorithm2e}
%\usepackage[noend]{algpseudocode}
%\usepackage{wrapfig}

% \usepackage{hyperref,graphicx,amsmath,amsfonts,amssymb,bm,url,breakurl,epsfig,epsf,color,MnSymbol,mathbbol,fmtcount,semtrans,caption,multirow,comment, boldline}
\usepackage{hyperref,graphicx,amsmath,amsfonts,amssymb,bm,url,breakurl,epsfig,epsf,color,fmtcount,semtrans,caption,multirow,comment, boldline, amsthm}
\usepackage{subcaption}
\usepackage{bm}
\usepackage{enumitem}
\usepackage{amssymb}

\setlist[itemize]{leftmargin=5mm}

\usepackage{hyperref}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
%\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{dsfont}
\usepackage{xspace}

\newcommand{\mini}{\,\wedge\,}
\newcommand{\maxi}{\,\vee\,}
% \newcommand{\min}{\text{min}}
% \newcommand{\Wt}{\widetilde{\W}}
\newcommand{\Ubt}{\widetilde{\Ub}}

\newcommand{\mubp}{\boldsymbol{\mu}_{+}}
\newcommand{\mubn}{\boldsymbol{\mu}_{-}}
\newcommand{\zmu}{Z_\mu}
\newcommand{\znu}{Z_{\nu}}
\newcommand{\lin}{\text{lin}}
\newcommand{\zbar}{\bar{Z}}


\newcommand{\gray}[1]{{\color{gray}{#1}}}

\newcommand{\Tf}{\text{TF}\xspace}
\newcommand{\Tfs}{\text{Transformers}\xspace}
\newcommand{\PT}{\text{PT}\xspace}
\newcommand{\attn}{\text{ATTN}\xspace}
\newcommand{\concat}{\operatorname{concat}\xspace}
\newcommand{\wAt}{\widehat{\text{ATTN}}\xspace}
\newcommand{\iid}{\text{IID}\xspace}
\newcommand{\icl}{\text{ICL}\xspace}

\newcommand{\ftiled}{\textsc{\small Full-Tiled}\xspace}
\newcommand{\ptiled}{\textsc{\small Partial-Tiled}\xspace}
\newcommand{\embd}{\textsc{\small Embed-in-ImageNet}\xspace}

\newcommand{\promptt}{\textsc{\small Prompt-tuning-I}\xspace}
\newcommand{\prefixt}{\textsc{\small Prompt-tuning-II}\xspace}
\newcommand{\prefixtfull}{\textsc{\small Prompt-tuning-III}\xspace}




\newcommand{\rate}{\texttt{rate}}
\newcommand{\ratl}{\texttt{rate}_{\lin}}
\newcommand{\aatt}{\A_{\att}}
\newcommand{\Prml}{Prompt Attention\xspace}
\newcommand{\prml}{prompt-attention\xspace}
\newcommand{\att}{\textsc{Att}}
\newcommand{\WV}{\mtx{W}_{V}}
\newcommand{\WA}{\mtx{W}_{A}}
\newcommand{\WK}{\mtx{W}_{K}}
\newcommand{\WQ}{\mtx{W}_{Q}}
\newcommand{\WQK}{\mtx{W}_{QK}}
\newcommand{\Qb}{{\mtx{Q}}}
\newcommand{\vb}{{\vct{v}}}
\newcommand{\Kb}{{\mtx{K}}}
\newcommand{\Vb}{{\mtx{V}}}
\newcommand{\sft}[1]{\mathbb{S}(#1)}
\newcommand{\sfti}[2]{\mathbb{S}_{#1}(#2)}
\newcommand{\sftd}[1]{{\mathbb{S}}^{\prime}(#1)}
\newcommand{\X}{{\mtx{X}}}
\newcommand{\Xp}{{\mtx{X}}_{\Pbb}}
\newcommand{\Pbb}{{\mtx{P}}}
\newcommand{\acc}{\textsc{err}}
\newcommand{\err}{\textsc{err}}
\newcommand{\taub}{{\bar{\tau}}}
\newcommand{\alphab}{{\bar{\alpha}}}
\newcommand{\taut}{\tau}
\newcommand{\wstab}{\bar{\w}_\star}
\newcommand{\qstab}{\bar{\qb}_\star}
\newcommand{\qtt}{\widetilde{\qb}}
%\newcommand{\wtt}{\tilde{\w}}
\newcommand{\vct}[1]{\bm{#1}}
\newcommand{\mtx}[1]{\bm{#1}}
\newcommand{\tsub}[1]{\|#1\|_{\psi_2}}
\newcommand{\isnr}[1]{\texttt{ISNR}(#1)}
\newcommand{\cwn}{c_{\wstarnorm}}
\newcommand{\cqn}{c_{\qstarnorm}}


\newcommand{\Rcc}{\mathcal{R}^c}
\newcommand{\poly}[1]{\operatorname{poly}\left(#1\right)}

\newcommand{\Xt}{\wt{\X}}
\newcommand{\Zt}{\wt{\Z}}
% \newcommand{\pt}{{(j)}}
\newcommand{\pare}[1]{{(#1)}}
\newcommand{\wb}{\overline}
\newcommand{\zb}{\wb \z}
\newcommand{\yb}{\wb y}
\newcommand{\MTL}{\text{MTL}}
\newcommand{\CTX}{\text{ctxE}}
\newcommand{\WRD}{\text{wordE}}
% \newcommand{\MTL}{\text{MTL}}
\newcommand{\TFL}{\text{TFL}}
\newcommand{\eqdef}{\overset{\mathrm{def}}{=\joinrel=}}

%\makeatletter
%\providecommand*{\boxast}{%
%  \mathbin{% as \boxplus and \boxtimes
%    \mathpalette\@boxit{*}%
%  }%
%}
%\newcommand*{\@boxit}[2]{%
%  % #1: math style (\displaystyle, \textstyle, ...)
%  % #2: symbol to be boxed that is centered around the math axis
%  \sbox0{$\m@th#1\Box$}%
%  % Manual correction for font bounding boxes:
%  \ifx#1\displaystyle \ht0=\dimexpr\ht0+.05ex\relax \fi
%  \ifx#1\textstyle \ht0=\dimexpr\ht0+.05ex\relax \fi
%  \ifx#1\scriptstyle \ht0=\dimexpr\ht0+.04ex\relax \fi
%  \ifx#1\scriptscriptstyle \ht0=\dimexpr\ht0+.065ex\relax \fi
%  \sbox2{$#1\vcenter{}$}% \ht2 is positionn of math axis
%  \rlap{%
%    \hbox to \wd0{%
%      \hfill
%      \raisebox{%
%        \dimexpr.5\dimexpr\ht0+\dp0\relax-\ht2\relax
%      }{$\m@th#1#2$}%
%      \hfill
%    }%
%  }%
%  \Box
%}
%\makeatother
%
%  \makeatletter
%\def\BState{\State\hskip-\ALG@thistlm}
%\makeatother


\usepackage{mathtools}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}

\usepackage{titlesec}

\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}

%\setcounter{secnumdepth}{4}
%
%\titleformat{\paragraph}
%{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
%\titlespacing*{\paragraph}
%{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\usepackage{movie15}

\usepackage{caption}
\usepackage[bottom,hang,flushmargin]{footmisc} 

\setlength{\captionmargin}{30pt}

\newcommand{\tsn}[1]{{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert #1 
    \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}}

\definecolor{darkred}{RGB}{150,0,0}
\definecolor{darkgreen}{RGB}{0,150,0}
\definecolor{darkblue}{RGB}{0,0,200}
\hypersetup{colorlinks=true, linkcolor=darkred, citecolor=darkgreen, urlcolor=darkblue}

% %--------------
% % \newtheorem{observation}{Observation}
% \newtheorem{theorem}{Theorem}
% % \newtheorem{result}{Result}
% % \newtheorem{condition}{Condition}
% % \newtheorem{problem}{Problem}
% \newtheorem{claim}{Claim}
% \newtheorem{assumption}{Assumption}
% % \newtheorem{question}{Question}
% \newtheorem{lemma}{Lemma}
% % \newtheorem{fact}[subsection]{Fact}
% \newtheorem{corollary}{Corollary}
% % \newtheorem{corollary}{Corollary}[propo]
% % \newtheorem{corollarytheo}{Corollary}[theorem]
% \newtheorem{proposition}{Proposition}
% \newtheorem{definition}{Definition}
% % \newtheorem{condition}{Condition}
% \newtheorem{conjecture}{Conjecture}
% \newtheorem{remark}{Remark}
% % \newtheorem{remarks}[subsection]{Remarks}
% % \newtheorem{example}[subsection]{Example}

%------------------------
\newcommand{\psinorm}[2]{\left\|{#1}\right\|_{\psi_{#2}}}
\newcommand{\partialf}[2]{\frac{\partial{#1}}{\partial{#2}}}
\newcommand{\Rb}{\mathbf{R}}
\newcommand{\mb}{\mathbf{m}}
%\newcommand{\softmaxd}{\operatorname{\rho^\prime}}
\newcommand{\zetah}{\hat{\zeta}}
\newcommand{\zetab}{\zeta^2}
\newcommand{\zetat}{\zeta^3}
\newcommand{\diag}[1]{\operatorname{diag}(#1)}
\newcommand{\xti}{\x_{i,t}}
\newcommand{\zti}{\z_{i,t}}

\newcommand{\del}{\delta}
\newcommand{\delw}{\delta^w}
\newcommand{\delq}{\delta^q}
\newcommand{\ctx}{context\xspace}
\newcommand{\qstar}{\qb_\star}
\newcommand{\qtar}{\tilde{\qb}_\star}
\newcommand{\wtar}{\tilde{\w}_\star}
\newcommand{\qstarnorm}{\overline{\qb}_\star}
\newcommand{\wstarnorm}{\overline{\w}_\star}

\newcommand{\corqarg}[1]{R_{#1,\qstar}}
\newcommand{\corwarg}[1]{R_{#1,\wstar}}

\newcommand{\eqd}{\stackrel{D}{=\joinrel=}}

\newcommand{\corqw}{\corqarg{\w}}
\newcommand{\corww}{\corwarg{\w}}
\newcommand{\corqv}{\corqarg{\vb}}
\newcommand{\corwv}{\corwarg{\vb}}

\newcommand{\corq}{R_{\qstar}}
\newcommand{\corw}{R_{\wstar}}
\newcommand{\hcorq}{\widehat{R}_{\qstar}}
\newcommand{\hcorw}{\widehat{R}_{\wstar}}
\newcommand{\bro}{\bar{\rho}}
\newcommand{\what}{\widehat{\w}}
\newcommand{\sigmahat}{\widehat{\sigma}}
\newcommand{\sigmatilde}{\widetilde{\sigma}}
\newcommand{\qhat}{\widehat{\qb}}
\newcommand{\Ghat}{\widehat{\G}}
\newcommand{\Gtilde}{\widetilde{\G}}
\newcommand{\Chat}{\widehat{C}}

\newcommand{\qnorm}{Q}
\newcommand{\wnorm}{W}
\newcommand{\mnorm}{M}

\newcommand{\rhat}{\hat{r}}

% ---------------------------

\newcommand{\Attn}{Attention}

\newcommand{\simiid}{\stackrel{\text{iid}}{\sim}}

\DeclareMathOperator{\tr}{tr}

\newcommand{\widesim}[2][1.5]{
  \mathrel{\overset{#2}{\scalebox{#1}[1]{$\sim$}}}
}


%%%%%%%%%%%% Dataset names
\newcommand{\synth}{\texttt{Synthetic}}
\newcommand{\simTS}{\texttt{Simplified TinyStories}}
\newcommand{\TS}{\texttt{TinyStories}}

\newcommand{\Eqref}[1]{Eq.~\eqref{#1}}
\newcommand{\appropto}{\mathrel{\vcenter{
  \offinterlineskip\halign{\hfil$##$\cr
    \propto\cr\noalign{\kern2pt}\sim\cr\noalign{\kern-2pt}}}}}
    
\newcommand{\cut}[1]{\textcolor{red}{}}
\newcommand{\W}{{\vct{W}}}
\newcommand{\Ab}{{\vct{A}}}
\newcommand{\Xb}{{\vct{X}}}

\newcommand{\Yb}{\mathbf{Y}}


\newcommand{\corr}[1]{\textsc{corr}(#1)}
\newcommand{\ssim}[2]{\textsc{sim}\big(#1,#2\big)}
\newcommand{\ssimstar}[2]{\textsc{sim}\big(#1,#2\big)}
\newcommand{\distF}[2]{\textsc{dist}_{\Fc}\big(#1,#2\big)}

\newcommand{\sign}[1]{\texttt{sign}(#1)}
\newcommand{\J}{\vct{J}}
\newcommand{\M}{\vct{M}}
\newcommand{\Ob}{\vct{O}}
\newcommand{\Z}{\vct{Z}}
\newcommand{\bmu}{\boldsymbol{\mu}}
\newcommand{\za}{\z_{\text{avg}}}
\newcommand{\zai}{\z_{\text{avg},i}}
\newcommand{\Ub}{\vct{U}}
\newcommand{\G}{\vct{G}}
\newcommand{\li}{\left<}
\newcommand{\ri}{\right>}

\newcommand{\Ellc}{\mathcal{L}}

\newcommand{\Hb}{{\vct{H}}}
%\newcommand{\G}{{G}}
\newcommand{\Sb}{\vct{S}}

\newcommand{\XXb}{\overline{\mathbf{X}}}

\newcommand{\Y}{\vct{Y}}

\newcommand{\A}{\vct{A}}

\newcommand{\K}{\vct{K}}
\newcommand{\kb}{\vct{k}}
\newcommand{\Q}{\vct{Q}}
\newcommand{\Db}{\vct{D}}
\newcommand{\Pb}{\mathds{P}}
\newcommand{\bgl}{\big|}

\newcommand{\pb}{\vct{p}}

%Bold lower
%\newcommand{\gammab}{\boldsymbol{\gamma}}
\newcommand{\etab}{\boldsymbol{\eta}}
\newcommand{\lab}{\boldsymbol{\la}}
\newcommand{\sps}{\zeta}
\newcommand{\mub}{\boldsymbol{\mu}}
\newcommand{\nub}{\boldsymbol{\nu}}
\newcommand{\lambdab}{\boldsymbol{\lambda}}
\newcommand{\xib}{\boldsymbol{\xi}}
\newcommand{\thetab}{\boldsymbol{\theta}}
\newcommand{\thetah}{\boldsymbol{\hat{\theta}}}
\newcommand{\Xib}{\boldsymbol{\Xi}}
\newcommand{\rb}{\vct{r}}
\newcommand{\fb}{\vct{f}}
\newcommand{\Fb}{\vct{F}}
% \newcommand{\ellb}{\boldsymbol{\ell}}
\newcommand{\phib}{\boldsymbol{\phi}}
\newcommand{\x}{\vct{x}}
\newcommand{\xt}{\widetilde{\mathbf{x}}}
\newcommand{\ub}{\vct{u}}
\newcommand{\w}{{\vct{w}}}
\newcommand{\tb}{\vct{t}}
\newcommand{\g}{{\vct{g}}}
\newcommand{\Lch}{\widehat{\Lc}}
\newcommand{\bb}{\vct{b}}
\newcommand{\Bb}{\vct{B}}
\newcommand{\e}{\vct{e}}
\newcommand{\eb}{\vct{e}}
\newcommand{\y}{\vct{y}}
\newcommand{\s}{\vct{s}}
\newcommand{\z}{\vct{z}}
\newcommand{\zo}{\overline{\mathbf{z}}}
\newcommand{\bseta}{{\boldsymbol{\eta}}}
\newcommand{\Iden}{\vct{I}}
% \newcommand{\tr}{\mathrm{tr}}
\newcommand{\cb}{\vct{c}}  
\newcommand{\ab}{\vct{a}}
\newcommand{\fat}{f^{\textsc{att}}}
\newcommand{\flin}{f^{\textsc{lin}}}
% \newcommand{\lin}{\textsc{lin}}
\newcommand{\fsat}{f^{\textsc{satt}}}
\newcommand{\flinatt}{f^{\textsc{lin-att}}}
\newcommand{\qb}{{\vct{q}}}
\newcommand{\qh}{{\vct{\hat{q}}}}
\newcommand{\oneb}{\mathbf{1}}
% \newcommand{\h}{\vct{h}}
\newcommand{\hb}{\vct{h}}
\newcommand{\f}{\mathbf{f}}
\newcommand{\betab}{\boldsymbol{\beta}}
%\newcommand{\tb}{\mathbf{t}}


%Calligraphic
\newcommand{\Vc}{\mathcal{V}}
\newcommand{\Fc}{\mathcal{F}}
\newcommand{\Mc}{\mathcal{M}}
\newcommand{\Ps}{\mathcal{P}}
\newcommand{\Rs}{\mathcal{R}}

\newcommand{\Sc}{{\mathcal{S}}}
\newcommand{\Bc}{{\mathcal{B}}}
\newcommand{\Yc}{\mathcal{Y}}
\newcommand{\Dc}{\mathcal{D}}
\newcommand{\Xc}{\mathcal{X}}
\newcommand{\Zc}{\mathcal{Z}}
%\newcommand{\Ic}{\mathcal{I}}
\newcommand{\Uc}{\mathcal{U}}
\newcommand{\bSi}{\boldsymbol{\Sigma}}
\newcommand{\order}[1]{\mathcal{O}(#1)}
\newcommand{\ordet}[1]{{\tilde{\mathcal{O}}}(#1)}
\newcommand{\subg}[1]{\Sc\Nc(#1)}
\newcommand{\Kc}{\mathcal{K}}
\newcommand{\Nc}{\mathcal{N}}
\newcommand{\Rc}{\mathcal{R}}
\newcommand{\Nn}{\mathcal{N}}
\newcommand{\Lc}{\mathcal{L}}
\newcommand{\Cc}{\mathcal{C}}
\newcommand{\Gc}{{\mathcal{G}}}
\newcommand{\Ac}{\mathcal{A}}
\newcommand{\Pc}{\mathcal{P}}
\newcommand{\Ec}{\mathcal{E}}
\newcommand{\Hc}{\mathcal{H}}
\newcommand{\Qc}{\mathcal{Q}}
\newcommand{\Oc}{\mathcal{O}}
\newcommand{\Jc}{\mathcal{J}}
\newcommand{\Ic}{\mathcal{I}}

%hat, tilde, etc
\newcommand{\vh}{\hat{v}}
%\newcommand{\alh}{\hat{\al}}
\newcommand{\thh}{\hat{\tau_{h}}}
\newcommand{\tgh}{\hat{\tau_{g}}}
\newcommand{\Lhat}{\widehat{L}}
%...

%Equations
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\bea}{\begin{align}}
\newcommand{\eea}{\end{align}}

\newcommand{\vp}{\vspace{5pt}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathbb{Var}}
\newcommand{\Pro}{\mathbb{P}}
\newcommand{\nn}{\notag}



\newcommand{\ras}{\stackrel{a.s.}{\rightarrow}}

\newcommand{\tn}[1]{\|#1\|}%_{\ell_2}
\newcommand{\tone}[1]{\|{#1}\|_{\ell_1}}
\newcommand{\tinf}[1]{\|{#1}\|_{\ell_\infty}}

\newcommand{\rP}{\stackrel{{P}}{\longrightarrow}}

%% Greek
\newcommand{\al}{\alpha}
\newcommand{\term}[1]{\text{Term}_{\rm{#1}}}
\newcommand{\Bh}{\hat{B}}
 \newcommand{\om}{\omega}
 \newcommand{\omb}{\mathbf{\omega}}
% \newcommand{\betabh}{\hat{\boldsymbol\beta}}
    \newcommand{\gammab}{\boldsymbol\gamma}
%        \newcommand{\etab}{\boldsymbol\eta}
 \newcommand{\chib}{\boldsymbol\chi}
 \newcommand{\Sigb}{\boldsymbol\Sigma}
  \newcommand{\Sigmab}{\boldsymbol\Sigma}
    \newcommand{\rhob}{\boldsymbol\rho}
  \newcommand{\la}{{\lambda}}                     % lambda
  \newcommand{\eps}{\epsilon}

 \newcommand{\deltab}{\boldsymbol\delta}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% FAIRNESS paper %%%%%%%%%%%%%%
\newcommand{\Rcbal}{\Rc_{\text{bal}}}
\newcommand{\Rco}{\overline\Rc}
\newcommand{\Rcbalinf}{\overline{\Rc}_{\text{bal}}}
\newcommand{\Rtrain}{\Rc_{\text{train}}}
\newcommand{\Rdeo}{\Rc_{\text{deo}}}
\newcommand{\wh}{{\hat\w}}
\newcommand{\bh}{\hat{b}}
\newcommand{\ind}[1]{\mathds{1}[#1]}

\newcommand{\bt}{\widetilde b}
\newcommand{\qt}{\widetilde q}
\newcommand{\rhobt}{\widetilde \rhob}
\newcommand{\rhot}{\widetilde \rho}
\newcommand{\thetabt}{\widetilde{\thetab}}
\newcommand{\Phit}{\widetilde{\Phi}}

\newcommand{\Ubstar}{\Ub^\star}

\newcommand{\Ubstart}{\Ubt^\star}
\newcommand{\Wstart}{\Wt^\star}
\newcommand{\thetabstart}{\widetilde\thetab^\star}
\newcommand{\thetabstar}{\thetab^\star}
\newcommand{\gammastar}{\gamma_\star}
\newcommand{\gammalin}{\gamma_{\text{lin}}}
% \newcommand{\WQ}{\W_Q{^\star}}
% \newcommand{\WK}{\W_K{^\star}}

\newcommand{\bomega}{\bar\omega}

\newcommand{\vbh}{\hat\vb}

%\newcommand{\wt}{\overline}

\DeclarePairedDelimiterX{\inp}[2]{\langle}{\rangle}{#1, #2}
\newcommand{\inpb}[2]{\left\langle #1, #2 \right\rangle}

\newcommand{\Del}{\Delta}
%\newcommand{\om}{\omega}
\newcommand{\wtt}{\widetilde\w}

\newcommand{\wt}{\widetilde}


\newcommand{\Id}{\mathds{I}}
\newcommand{\ones}{\mathds{1}}
\newcommand{\zeros}{\mathbf{0}}

\providecommand{\norm}[1]{\lVert#1\rVert}
\providecommand{\abs}[1]{\left\lvert#1\right\rvert}



\providecommand{\maxnorm}[1]{\lVert#1\rVert_{2,\infty}}

\providecommand{\pare}[1]{(#1)}



\providecommand{\Rad}[1]{\operatorname{Rad}(#1)}
\providecommand{\Unif}[1]{\operatorname{Unif}(#1)}

\newcommand{\ellp}{\ell^\prime}

\newcommand{\wte}{\widetilde}


\newcommand{\ntkscaling}{\red{\Gamma}}

\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
\newcommand{\gammabar}{\overline{\gamma}}


\newcommand{\Philin}{\Phi_\text{lin}}

\newcommand{\Bnorm}{B_2}
\newcommand{\Bphi}{B_\Phi}

\newcommand{\good}{\texttt{good}\xspace}