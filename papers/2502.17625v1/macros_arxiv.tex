\usepackage{fullpage}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{natbib}
\usepackage{authblk}
\usepackage{graphicx}
\usepackage{url}
\usepackage{algorithm2e}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}       %
\usepackage[T1]{fontenc}          %
\usepackage{hyperref}             %
\usepackage{cleveref}             %
\usepackage{booktabs}             %
\usepackage{amsfonts}             %
\usepackage{nicefrac}             %
\usepackage{microtype}            %
\usepackage{enumitem} 
\usepackage{mathtools}            %
\usepackage{mleftright}           %
\usepackage{nicefrac}             %
\usepackage{textcomp}
\usepackage{nicematrix}
\usepackage{tikz}

\let\todo\undefined               %
\usepackage[obeyFinal]{easy-todo} %

\usepackage{comment}             

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\theoremstyle{definition}
\newtheorem{observation}{Observation}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}


\newcommand{\ve}{}
\let\svthefootnote\thefootnote
\newcommand\blfootnote[1]{%
  \let\thefootnote\relax%
  \footnotetext{#1}%
  \let\thefootnote\svthefootnote%
}



\makeatletter

\patchcmd{\NAT@test}{\else \NAT@nm}{\else \NAT@nmfmt{\NAT@nm}}{}{}

\DeclareRobustCommand\citepos
  {\begingroup
   \let\NAT@nmfmt\NAT@posfmt%
   \NAT@swafalse\let\NAT@ctype\z@\NAT@partrue
   \@ifstar{\NAT@fulltrue\NAT@citetp}{\NAT@fullfalse\NAT@citetp}}

\let\NAT@orig@nmfmt\NAT@nmfmt
\def\NAT@posfmt#1{\NAT@orig@nmfmt{#1's}}

\makeatother


\newcommand{\wh}{\widehat}


\newcommand{\alphab}{\bar{\alpha}}
\newcommand{\psib}{\bar{\psi}}
\newcommand{\betab}{\bar{\beta}}
\renewcommand{\epsilon}{\varepsilon}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\fR}{\mathbb{R}}
\newcommand{\one}{\operatorname{\boldsymbol{1}}}
\newcommand{\eps}{\varepsilon}



\newcommand*{\defeq}{\stackrel{\text{def}}{=}}

\newcommand{\nicerfrac}[2]{\text{\LARGE\nicefrac{#1}{#2}}}

\newcommand{\conv}{\operatorname{conv}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\DG}{\operatorname{DGap}}
\newcommand{\SR}{\operatorname{SR}}
\newcommand{\KL}{\mathop{D_{\mathrm{KL}}}\limits}
\newcommand{\TV}{\mathop{D_{\mathrm{TV}}}\limits}
\newcommand{\prob}{\mathop{\mathrm{Prob}}\limits}
\newcommand{\Ber}{\mathrm{Ber}}
\newcommand{\Berpm}{\mathrm{Ber}^{\pm}}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\E}{\mathbf{E}}
\DeclareMathOperator*{\Var}{\mathbf{Var}}
\newcommand{\re}{\mathbb{R}}
\newcommand{\F}{F}


\newcommand{\linner}{\mleft\langle}
\newcommand{\rinner}{\mright\rangle}

\newcommand{\paren}[1]{\mleft({#1}\mright)}
\newcommand{\rbr}{\paren}    %
\newcommand{\brackets}[1]{\mleft[{#1}\mright]}
\newcommand{\sbr}{\brackets} %
\newcommand{\braces}[1]{\mleft\{{#1}\mright\}}
\newcommand{\cbr}{\braces}   %

\newcommand{\floor}[1]{\mleft\lfloor{#1}\mright\rfloor}
\newcommand{\ceil}[1]{\mleft\lceil{#1}\mright\rceil}

\newcommand{\inner}[2]{\mleft\langle {#1},{#2} \mright\rangle}
\newcommand{\tuple}[1]{\mleft\langle{#1}\mright\rangle}

\newcommand{\abs}[1]{\mleft|{#1}\mright|}
\newcommand{\nbr}[1]{\mleft\|{#1}\mright\|}

\newcommand\RemoveAmpNL[1]{
    \bgroup         %
    \catcode`\&=9   %
    \let\\\relax    %
    \scantokens{#1} %
    \egroup         %
}
\newcommand{\NegSpaceDot}{\kern-\nulldelimiterspace}
\newcommand{\nomleft}{\mleft.\NegSpaceDot}
\newcommand{\nomright}{\NegSpaceDot\mright.}
\newcommand{\brkXbr}[3]{\mleft#1\vphantom{\RemoveAmpNL{#2}}\nomright#2\nomleft\vphantom{\RemoveAmpNL{#2}}\mright#3}
\newcommand{\brkrbr}[1]{\brkXbr({#1})}
\newcommand{\brksbr}[1]{\brkXbr[{#1}]}

\DeclarePairedDelimiter{\rbrm}()
\DeclarePairedDelimiter{\sbrm}[]
\DeclarePairedDelimiter{\cbrm}\{\}
\DeclarePairedDelimiter{\absm}||
\DeclarePairedDelimiter{\ceilm}\lceil\rceil
\DeclarePairedDelimiter{\nbrm}\|\|

\newcommand{\Deltar}{\Delta}
\newcommand{\Deltac}{\Delta'}
\newcommand{\Rr}{\mathrm{Reg}}
\newcommand{\Rc}{\mathrm{Reg}'}
\newcommand{\Rcb}{\bar{\mathrm{Reg}}}
\newcommand{\Rrb}{\bar{\mathrm{Reg}}'}
\newcommand{\Tr}{N}
\newcommand{\Tc}{N'}
\newcommand{\lr}{\ell}
\newcommand{\lc}{\ell'}
\newcommand{\PS}{\mathcal{P}}
\newcommand{\xstar}{x_{\star}}
\newcommand{\ystar}{y_{\star}}
\newcommand{\xbar}{\bar{x}}
\newcommand{\ybar}{\bar{y}}
\newcommand{\xstarset}{\mathcal{X}_{\star}}
\newcommand{\ystarset}{\mathcal{Y}_{\star}}
\newcommand{\istar}{i_{\star}}
\newcommand{\jstar}{j_{\star}}
\newcommand{\omegar}{\omega}
\newcommand{\omegac}{\omega'}
\newcommand{\Sr}{S}
\newcommand{\Sc}{S'}
\newcommand{\Logrs}{L_\star}
\newcommand{\Logcs}{L'_\star}
\newcommand{\Logr}{L}
\newcommand{\Logc}{L'}
\newcommand{\vecdelta}{\mathbf{\delta}}
\newcommand{\proj}{\Pi}
\newcommand{\pir}{\pi}
\newcommand{\pic}{\pi'}
\newcommand{\NEr}{\mathcal{X}_{\star}}
\newcommand{\NEc}{\mathcal{Y}_{\star}}

\newcommand{\consti}{C_1}
\newcommand{\constd}{C_2}
\newcommand{\gammar}{\gamma}
\newcommand{\gammac}{\gamma'}
\newcommand{\rhor}{\rho}
\newcommand{\rhoc}{\rho'}
\newcommand{\gammabar}{\overline{\gamma}}
\newcommand{\OPT}{\mathrm{OPT}}

\newcommand\yestag{\addtocounter{equation}{1}\tag{\theequation}} %

\newcommand{\hl}[1]{\todo{(Haipeng: #1)}}
\newcommand{\inote}[1]{\todo{(Shinji: #1)}}
\newcommand{\tnote}[1]{\todo{(Tsuchiya: #1)}}
\newcommand{\wnote}[1]{\todo{\textcolor{purple}{(Yue: #1)}}}
\makeatletter
\newcommand\usemm[1]{%
  \strip@pt\dimexpr0.3514598\dimexpr #1\relax\relax mm%
}
\newcommand\usein[1]{%
  \strip@pt\dimexpr0.013837\dimexpr #1\relax\relax in%
}
\makeatother
