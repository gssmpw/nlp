\documentclass[conference, 9pt]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
%Template version as of 6/27/2024

\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{graphicx}
\usepackage{color, xcolor}
\usepackage{lipsum}
\usepackage{comment}
    \newcommand{\thicktilde}[1]{\mathbf{\tilde{\text{$#1$}}}}
\usepackage{tikz}
  \newlength\squareheight
  \setlength\squareheight{6.75pt}
  \newcommand\squareslash{\tikz{\draw (0,0) rectangle (\squareheight,\squareheight);\draw(0,0) -- (\squareheight,\squareheight)}}
  \DeclareMathOperator\squarediv{\squareslash}
\usepackage{multirow}
\usepackage{float}
\usepackage{subcaption}
\usepackage{siunitx}
\usepackage{oubraces}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
% \usepackage{dutchcal}
% \usepackage{mathrsfs}
\usepackage[hang,flushmargin]{footmisc}
\usepackage[cal=boondoxupr]{mathalfa}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}
\newcommand{\gael}[1]{\textit{\textcolor{red}{#1}}}
\newcommand{\changhong}[1]{\textcolor{blue}{#1}}

\usepackage{fancyhdr}
\usepackage{ragged2e}  % For \justifying
% Define a custom style for the first page
\fancypagestyle{firstpage}{
% \vspace{-0.5cm}
    \fancyhf{} % Clear all headers and footers
    % Adjust the footskip to move the footer text higher
    \setlength{\footskip}{28pt}  % Reduce this value to move the footer up
    \fancyfoot[C]{\justifying \footnotesize{\copyright 2025 IEEE. Personal use of this material is permitted. However, permission to reprint/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works, must be obtained from the IEEE.}} % Footer text
    \renewcommand{\headrulewidth}{0pt} % No header line
    \renewcommand{\footrulewidth}{0pt} % No footer line
}

% Set the default style for the rest of the pages
\pagestyle{plain}

\begin{document}

\title{F-StrIPE: Fast Structure-Informed Positional Encoding for Symbolic Music Generation\\
\thanks{This work was funded by the European Union (ERC, HI-Audio, 101052978). Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or the European Research Council. Neither the European Union nor the granting authority can be held responsible for them. The accompanying website at \textit{bit.ly/faststructurepe} contains music samples and code.}
}

% \author{\IEEEauthorblockN{1\textsuperscript{st} Manvi Agarwal}
% \IEEEauthorblockA{
% \textit{T\'{e}l\'{e}com Paris}\\
% \textit{Institut Polytechnique de Paris}\\
% Paris, France \\
% email address or ORCID}
% \and
% \IEEEauthorblockN{2\textsuperscript{nd} Changhong Wang}
% \IEEEauthorblockA{
% \textit{T\'{e}l\'{e}com Paris}\\
% \textit{Institut Polytechnique de Paris}\\
% Paris, France \\
% email address or ORCID}
% \and
% \IEEEauthorblockN{3\textsuperscript{rd} Ga\"{e}l Richard}
% \IEEEauthorblockA{
% \textit{T\'{e}l\'{e}com Paris}\\
% \textit{Institut Polytechnique de Paris}\\
% Paris, France \\
% email address or ORCID}
% }
% \author{\IEEEauthorblockN{Manvi Agarwal, %\IEEEauthorrefmark{1}, 
% Changhong Wang, %\IEEEauthorrefmark{2}, 
% Ga\"{e}l Richard%\IEEEauthorrefmark{3}, 
% %Author 4\IEEEauthorrefmark{3}, Author 5\IEEEauthorrefmark{4}
% }
% \IEEEauthorblockA{T\'{e}l\'{e}com Paris, Institut Polytechnique de Paris, France}
% }

\author{\IEEEauthorblockN{Manvi Agarwal, 
Changhong Wang, 
Ga\"{e}l Richard 
%Author 4\IEEEauthorrefmark{3}, Author 5\IEEEauthorrefmark{4}
}
\IEEEauthorblockA{LTCI, T\'{e}l\'{e}com Paris, Institut Polytechnique de Paris, France}
}


% \author{\IEEEauthorblockN{Michael Shell\IEEEauthorre fmark{1}, Homer Simpson\IEEEauthorrefmark{2}, James K irk\IEEEauthorrefmark{3}, Montgomery Scott\IEEEautho rrefmark{3} and Eldon Tyrell\IEEEauthorrefmark{4}} \IEEEauthorblockA{\IEEEauthorrefmark{1}School of Ele ctrical and Computer Engineering\\
% Georgia Institute of Technology, Atlanta, Georgia 30 332--0250\\
% Email: mshell@ece.gatech.edu} \IEEEauthorblockA{\IEEEauthorrefmark{2}Twentieth Cen tury Fox, Springfield, USA\\
% Email: homer@thesimpsons.com}
% \IEEEauthorblockA{\IEEEauthorrefmark{3}Starfleet Aca demy, San Francisco, California 96678-2391\\ Telephone: (800) 555--1212, Fax: (888) 555--1212} \IEEEauthorblockA{\IEEEauthorrefmark{4}Tyrell Inc.,
% 123 Replicant Street, Los Angeles, California 90210 --4321}}


\maketitle
\thispagestyle{firstpage}
\begin{abstract}
While music remains a challenging domain for generative models like Transformers, recent progress has been made by exploiting suitable musically-informed priors. One technique to leverage information about musical structure in Transformers is inserting such knowledge into the positional encoding (PE) module. However, Transformers carry a quadratic cost in sequence length. In this paper, we propose \emph{F-StrIPE}, a structure-informed PE scheme that works in linear complexity. Using existing kernel approximation techniques based on random features, we show that F-StrIPE is a generalization of Stochastic Positional Encoding (SPE). %\textit{We compare SPE and F-StrIPE from the perspective of musical structure, showing that our approach is appropriately grounded in both theory and domain knowledge. }
We illustrate the empirical merits of F-StrIPE using melody harmonization for symbolic music.
% \blfootnote{\copyright 2024 IEEE. \textit{Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.}}
\end{abstract}

\begin{IEEEkeywords}
music generation, symbolic music, transformers, positional encoding, kernels.
\end{IEEEkeywords}

\input{sections/introduction}

\begin{figure}[t]
    \centering
    \includegraphics[width=1.0\linewidth]{figs/icassp_2025_summary_palette_corrected.png}
    \caption{A schematic showing our main contributions (best viewed in colour).}
    \label{fig:contributions}
\end{figure}

% \begin{figure*}[h!]
%     \centering
%     \includegraphics[width=1.6\columnwidth]{figs/R.png}
%     \caption{A visual representation of the connection between Stochastic Positional Encoding and Random Fourier Features. The variables referenced here are detailed in Sections \ref{section:background} and \ref{section:methods}.}
%     \label{fig:visualize_matrices}
% \end{figure*}

\begin{figure*}[h!]
    \centering
    \includegraphics[width=1.58\columnwidth]{figs/icassp_2025_palette_corrected.png}
    \caption{A visual representation of the connection between Stochastic Positional Encoding and Random Fourier Features (best viewed in colour). The variables referenced here are detailed in Sections \ref{section:background} and \ref{section:methods}.}
    \label{fig:visualize_matrices}
\end{figure*}

\input{sections/background}

\input{sections/methods_reorganized}

% \input{sections/results_table_2decimals}
\input{sections/results_table_std_rounded_correctedGSNDD}

\input{sections/results}

\input{sections/conclusion}

\bibliographystyle{./IEEEbib/IEEEtran}
\bibliography{strings}


\end{document}
