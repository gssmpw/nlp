\section{Regret Analysis} 

Let $N$ denote the number of samples. By Proposition 3 in \citep{basu2019low}, for $N$ large enough, \footnote{$N \succsim q \paran{\frac{\sup_{\theta \in [-\pi, \pi]}\Lambda_{\max}(f_X(\theta))}{\sup_{\theta \in [-\pi, \pi]}\Lambda_{\min}\paran{f_X(\theta)}}}^2$ where $f_X$ is the spectral density of the VAR model.} there exists a constant $C_N>0$ such that 
\begin{equation}
\Lambda_{\min}\left(\frac{{\bX}^{\top}\bX}{N}\right) \leq C_N,
\label{eq:ass-number}
\end{equation}

\begin{theorem}
$\norm{\hat\bDelta^L}_F^2+\norm{\hat\bDelta^{S}}_F^2\leq 4c_0\frac{2rd+s\log d}{\zeta N}$
\label{thm:rl-upperbound}
\end{theorem}

\begin{proof}

$\hat\bDelta^{L}=\hat\bL-\bL^*, \hat\bDelta^{S}=\hat\bS-\bS^*$

$\frac{1}{2}\norm{\bY-\bX\paran{\hat{\bL}+\hat{\bS}}}_F^2\leq\frac{1}{2}\norm{\bY-\bX(\bL^*+\bS^*)}_F^2$

$\frac{1}{2}\norm{\bX(\hat\bDelta^{L}+\hat\bDelta^{S})}_F^2\leq \angles{\bX^\top\bE, \hat\bDelta^{L}+\hat\bDelta^{S}}\leq \norm{\bX^\top \bE}_2\norm{\hat\bDelta^{L}}_*+\norm{\bX^\top \bE}_{\max}\norm{\hat\bDelta^{S}}_1$

   $\frac{1}{2}\norm{\bX\left(\hat\bDelta^L+\hat\bDelta^{S}\right)}_F^2 \geq \frac{\zeta}{2} \paran{ \norm{\hat\bDelta^L +\hat\bDelta^{S}}_F^2}
   \geq \frac{\zeta}{2} \paran{ \norm{\hat\bDelta^L}_F^2 +\norm{\hat\bDelta^{S}}_F^2}-\zeta\abs{\angles{\hat\bDelta^L ,\hat\bDelta^{S}}}
   $


   
By the separation lemma presented in \cite{chai2024structured}, this lemma demonstrates that two matrices can be well-separated to a certain extent under the incoherence assumption. Given two $\mu'$-incoherent matrices $G_1,G_2\in \RR^{p \times q}$, with $\mu'$ having an upper bound $\mu$, and $\rank(G_1),\rank(G_2)\leq r$. Let $\bDelta^G=G_1-G_2$, we have $\frac{\norm{\bDelta^G}^2_{max}}{\norm{\bDelta^G}_F^2}\leq \frac{c\mu r^4}{\max\{p,q\}}$, 
    
    Define the support sets of matrices $\hat\bDelta^{L}$ and $\hat\bDelta^{S}$ as $ \text{supp}(\hat\bDelta^{L})=\{(i,j)\mid \hat\bDelta^{L}_{i,j}\neq 0\}$ and $\text{supp}(\hat\bDelta^{S, (k)})\{(i,j)\mid \hat\bDelta^{S, (k)}_{i,j}\neq 0\}$, respectively, and let $J = \text{supp}(\hat\bDelta^{L}) \cap \text{supp}(\hat\bDelta^{S, (k)})$. The projection operator $\Pi_J$ zeros out elements not in $J$. Hence,$$\frac{\norm{\Pi_J(\hat\bDelta^{L})}_F^2}{\norm{\hat\bDelta^{L}}_F^2}\leq |J|\frac{\norm{\hat\bDelta^{L}}_{max}^2}{\norm{\hat\bDelta^{L}}_F^2}\leq 2s\frac{c\mu r^4}{\max\{p,q\}}\leq \frac{\max\{p,q\}}{8c\mu r^4}\frac{c\mu r^4}{\max\{p,q\}}=\frac{1}{4}$$
    Same to $\hat\bDelta^{S}$, $$\abs{\angles{\hat\bDelta^L,\hat\bDelta^{S}}}=\abs{\angles{\Pi_J(\hat\bDelta^L),\Pi_J(\hat\bDelta^{S})}}\leq \norm{\Pi_J(\hat\bDelta^L)}_F^2+\norm{\Pi_J(\hat\bDelta^{S})}_F^2\leq \frac{1}{4}\paran{\norm{\hat\bDelta^{L}}_F^2+\norm{\hat\bDelta^{S}}_F^2}$$

$$\frac{1}{2}\norm{\bX\left(\hat\bDelta^L+\hat\bDelta^{S}\right)}_F^2 \geq \frac{\zeta}{4} \paran{ \norm{\hat\bDelta^L}_F^2 +\norm{\hat\bDelta^{S}}_F^2},$$

    \begin{equation}
     \begin{aligned}
      &\frac{\zeta}{4} \paran{ \norm{\hat\bDelta^L}_F^2 + \norm{\hat\bDelta^{S}}_F^2 }
      \leq \norm{\bX^\top \bE}_2\norm{\hat\bDelta^L}_* + \norm{\bX^\top \bE}_{\max}\norm{\hat\bDelta^{S}}_1\\
      &
      \leq \sqrt{2r}\norm{\bX^\top \bE}_2\norm{\hat\bDelta^L}_F + \sqrt{s}\norm{\bX^\top \bE}_{\max}\norm{\hat\bDelta^{S}}_F\\
      &\leq \sqrt{ \paran{\norm{\hat\bDelta^L}_F^2 + \norm{\hat\bDelta^{S}}_F^2}\paran{2r\norm{\bX^\top \bE}_2^2+s\norm{\bX^\top \bE}_{\max}^2}}.
     \end{aligned}
     \end{equation}
     
     By combining lemma \ref{A:3}, which provides upper bounds on 
    $\norm{\bX^{\top}\bE}_2$ and $\norm{\bX^{\top}\bE}_{\max}$, we complete the proof of Theorem \ref{thm:ts-upperbounds2}.

     \begin{equation}
     \begin{aligned}
	 \quad\norm{\hat\bDelta^L}_F^2+\norm{\hat\bDelta^{S}}_F^2\leq \frac{4}{\zeta}\paran{2r\norm{\bX^\top \bE}_2^2+s\norm{\bX^\top \bE}_{\max}^2}
     \leq 4c_0\frac{2rd+s\log d}{\zeta N}.
     \end{aligned}
     \end{equation}
\end{proof}

To ensure regularity in the feature space, we introduce regularity conditions for the feature mapping.

The matrix $\boldsymbol{\Psi} =[\psi(s_1), \psi(s_2), \ldots, \psi(s_{|S|})]^T$, with entries defined by the $\psi$ features.
\begin{assumption}
For every $v \in \mathbb{R}^S$, and positive constants $C_{\psi,1}C_{\psi,2},C_\phi$, we have

\begin{enumerate}
  \item $\|\bPsi^{\top} v\|_{\infty} \leq C_{\psi,1} \|v\|_{\infty}$, $\|\bPsi^{\top} v\|_{\text{op}} \leq C_{\psi,2} \|v\|_{\infty}$,  $\forall v \in \mathbb{R}^{|\mathcal{S}|}$.
  
  \item $\|\phi(s, a)\|_2 \leq C_\phi \sqrt{p}, \quad \forall (s, a) \in \mathcal{S} \times \mathcal{A}$.
\end{enumerate}
\label{ass-recon}
\end{assumption}
    
  If $\bPsi$ is a set of sparse or highly concentrated features, then condition (1) can be replaced with a stronger alternative: $\norm{\bPsi^{\top} v}_2 \leq C_{\psi,1} \norm{v}_{\infty}$.

  \begin{theorem}
$\text{Regret}(NH) \leq 4\sqrt{2}C_{\phi}C_{M}C'NH^2\sqrt{c_0\frac{(2rd+s\log d)p}{\zeta N}}$
\label{thm:rl-theorem}
\end{theorem}

  When updating the Q-values using Equation (\ref{eq:updateQ}), we employ the range derived from Lemma \ref{lem:boundQ} as the upper confidence bound. The central idea of our approach is to leverage the error bounds of the core matrix to establish a reasonable upper limit on the Frobenius norm of the core matrix. Following this, by identifying the optimal low-rank (L) and sparse (S) components, we can effectively calculate an optimistic estimation of the Q-values.  Furthermore, Equation (\ref{eq:updateQ}) can be replaced as 
    $$Q_{n, h}(s, a) = r(s, a) + \max_{\substack{\bL,\bS \in \mathcal{B}_n}}\phi(s, a)^{\top} (\bL+\bS) \bPsi^{\top} V_{n, h+1}$$
    where $\mathcal{B}_n=\{\bL,\bS \mid \norm{\bL-\bL_n}_F^2+\norm{\bS-\bS_n}_F^2\leq \beta_M\}$, as well as let 

    $$\widetilde{\bL}_n,\widetilde{\bS}_n=\arg\max_{\substack{\bL,\bS \in \mathcal{B}_n}}\phi(s, a)^{\top} (\bL+\bS) \bPsi^{\top} V_{n, h+1}$$

    According to Theorem \ref{thm:ts-upperbounds}, with high probability, the true transition core matrix is contained within the specified confidence bound. We denote this event by $E_n = 1$; otherwise, $E_n=0$.
    
    \begin{lemma}\label{lem:optimism}
    Given any state-action pair $(s, a) \in \mathcal{S} \times \mathcal{A}$ , for each episode $n$ and decision step $h$, $E_n=1$ we have:
        $$Q_{n,h}(s, a) \geq Q_h^*(s, a)$$
    \end{lemma}
    \begin{proof}
    For all $s\in \mathcal{S}$, $a\in \mathcal{A}$. Proceeding recursively over $h$.\\
    At $h=H$, we have $Q_{n,H}=Q_H^*(s, a)=r(s,a)$. Assuming the validity for $1<h'<H$, it naturally extends to $h=h'-1$, with $V_{n,h}(s)>V_h^*(s)$ 
    \begin{align*}
     Q_{n, h}(s, a) 
     &= r(s, a) + \max_{\substack{\bL,\bS \in \mathcal{B}_n}}\phi(s, a)^{\top} (\bL+\bS) \bPsi^{\top} V_{n, h+1}\\
     &\geq r(s, a) + \phi(s, a)^{\top} (\bL^*+\bS^*) \bPsi^{\top} V_{n, h+1}\\
     &\geq r(s, a) + [P V^*_{h+1}](s, a)=Q_h^*(s, a)
    \end{align*}
   \end{proof} 

\begin{lemma}\label{lem:boundQ} 
     Let $h \in [H]$ and $n \in [N]$. $E_n=1$, With high probability,     
     $$Q_{n,h}-\paran{r(s_{n,h},a_{n,h})+[P_h V_{h+1}](s_{n,h},a_{n,h})}
     \leq 4\sqrt{2}C_{\phi}C_{M}C' H\sqrt{c_0\frac{(2rd+s\log d)p}{\zeta N}}.$$
     \end{lemma}

\begin{proof}

   \begin{align*}
   Q_{n,h} - \big(r(s_{n,h},a_{n,h}) + [P_h V_{h+1}](s_{n,h},a_{n,h})\big) 
   =& \phi_{n, h}^{\top}\left[\left(\widetilde{\bL}_{n} + \widetilde{\bS}_{n}\right) - M^*\right] \bPsi^{\top} V_{n, h+1} \\
   = &\phi_{n, h}^{\top}\left[(\widetilde{\bL}_{n}-L^*) + \left(\widetilde{\bS}_{n}-\bS^{*}\right)\right] \bPsi^{\top} V_{n, h+1}.
    \end{align*}
        Applying HÃ¶lder's inequality, the triangle inequality, and Cauchy-Schwarz inequality, we deduce the following results:
     \begin{equation}
     \begin{aligned}
     &Q_{n,h} - \left(r + [P_h V_{h+1}]\right) \\
     &\leq \norm{\phi_{n, h}^{\top}(\widetilde{\bL}_{n} - \bL^{*})}_*\norm{\bPsi^{\top} V_{n, h+1}}_{op}+\norm{\phi_{n, h}^{\top}\paran{\widetilde{\bS}_{n} - \bS^*}}_1\norm{\bPsi^{\top} V_{n, h+1}}_{\infty} \\
     & \leq \paran{C_{\psi,1}\norm{\phi_{n, h}^{\top}(\widetilde{\bL}_{n} - \bL^*)}_*+C_{\psi,2}\norm{\phi_{n, h}^{\top}\paran{\widetilde{\bS}_{n} - \bS^{*}}}_1}H \\
     & \leq \paran{C_{\psi,1}\sqrt{2r}\norm{\phi_{n, h}^{\top}}_*\norm{\widetilde{\bL}_{n} - \bL^{*}}_F + C_{\psi,2}\sqrt{s}\norm{\phi_{n, h}^{\top}}_1\norm{\widetilde{\bS}_{n} - \bS^{*}}_F}H \\
     & \leq C_{\phi}\sqrt{p}H\paran{C_{\psi,1}\sqrt{2r}\norm{\widetilde{\bL}_{n} - \bL^*}_F + C_{\psi,2}\sqrt{s}
     \norm{\widetilde{\bS}_{n} - \bS^{*}}_F} \\
     & \leq C_{\phi}\sqrt{p}H \sqrt{\paran{ \|\widetilde{\bL}_{n} - \bL^*\|_F^2 +   \|\widetilde{\bS}_{n} - \bS^{*}\|_F^2}\paran{2rC_{\psi,1}^2+sC_{\psi,2}^2}}\\
     &\leq C_{\phi}C_{M}\sqrt{p}H
     \sqrt{
     \norm{\widetilde{\bL}_n -\hat\bL_n}^2_F + 
     \norm{\hat\bL_n -\bL^*}^2_F+\paran{\norm{\widetilde{\bS}_{n} - \hat\bS_n}^2_F+\norm{\hat\bS_n - S^{*}}^2_F}} \\
     & \leq 4\sqrt{2}C_{\phi}C_{M}C' H\sqrt{c_0\frac{(2rd+s\log d)p}{\zeta N}}.
     \end{aligned}
    \end{equation}

 constant term $C_M=\sqrt{2rC_{\psi,1}^2+sC_{\psi,2}^2}$ for brevity.
\end{proof}



In calculating the regret bound, we reformulate the regret formula based on the updates to the Q-values within the algorithm and the confidence bounds of the core matrix. $\mathcal{F}_{n,h}$ is defined as the $\sigma$-field generated by all the random variables up until episode n, step h, essentially fixing the sequence $s_{1,1}, a_{1,1}, s_{1,2}, a_{1,2}, \ldots, s_{n,h}, a_{n,h}$. 
Now, we proceed to prove Theorem \ref{thm:rl-theorem}, letting 
$$\delta_{n,h} := (V_{n,h}-V_{h}^{\pi_{n}})(s_{n,h}), \quad
\gamma_{n,h} := Q_{n,h} - \left(r(s_{n,h},a_{n,h}) + [P_h V_{h+1}](s_{n,h},a_{n,h})\right).$$
\begin{align*}
\text{Regret}(NH) &= \mathbb{E}\left(\sum_{n=1}^{N} \left[ V^*(s_0) - V^{\pi_n}(s_0) \right]\right) \\
&\leq \mathbb{E}\left( \sum_{n=1}^{N}(V_{n,1}-V_{1}^{\pi_{n}})(s_0)\right) = \sum_{n=1}^{N}\mathbb{E}(\delta_{n,1}).
\end{align*}
$$\mathbb{E}(\delta_{n,1}) = \mathbb{E}(\delta_{n,1}E_n+(1-E_n)\delta_{n,1}) 
\leq \mathbb{E}(\delta_{n,1}E_n)+Hp[E_n=0].$$
where $p[E_n=0]\leq c_1\exp\paran{-c_2\log p}$, Then we have

\begin{align*}
\mathbb{E}\paran{\delta_{n,1}E_n \mid \mathcal{F}_{n,1}} =& \paran{V_{n,1} - V_{1}^{\pi_{n}}}\paran{s_{n,1}}E_n \\
\leq &Q_{n,1}\paran{s_{n,1},a_{n,1}} - V_{1}^{\pi_{n}}\paran{s_{n,1}} \\
= &\gamma_{n,1} + \paran{r\paran{s_{n,1},a_{n,1}} +[PV_{n,2}]\paran{s_{n,1},a_{n,1}}} -V_{1}^{\pi_{n}}\paran{s_{n,1}} \\
\leq &\gamma_{n,1} + \mathbb{E}\paran{\paran{V_{n,2} - V_{2}^{\pi_{n}}}\paran{s_{n,2}}E_n \mid \mathcal{F}_{n,1}} 
\leq \cdots \leq \sum_{h=1}^{H}\gamma_{n,h}\\
\leq &4\sqrt{2}C_{\phi}C_{M}C' H^2\sqrt{c_0\frac{(2rd+s\log d)p}{\zeta N}}.
\end{align*}

Then we establish the regret bound with high probability

\begin{align*}
\text{Regret}(NH) &\leq 4\sqrt{2}C_{\phi}C_{M}C'NH^2\sqrt{c_0\frac{(2rd+s\log d)p}{\zeta N}}.
\end{align*}
