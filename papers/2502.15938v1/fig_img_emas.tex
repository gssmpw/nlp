\begin{figure}
  \centering
  \makebox[\textwidth][c]{
      \begin{subfigure}{\shrinkfigimgs\textwidth}
        \includegraphics[trim={0.28cm 0cm 0.3cm 0.35cm}, clip, width=\textwidth]{pdffigs/img.111M.200TPP.OPTIMAL.linear.D2Z.WD=0.1.100.pdf}
        \subcaption{$\linear$}
        \label{fig:img_emas:d2z}
      \end{subfigure}
      \hspace{-1mm}
      \begin{subfigure}{\shrinkfigimgs\textwidth}
        \includegraphics[trim={0.28cm 0cm 0.3cm 0.35cm}, clip, width=\textwidth]{pdffigs/img.111M.200TPP.OPTIMAL.cosine.D2Z.WD=0.1.100.pdf}
        \subcaption{$\cosine$}
        \label{fig:img_emas:cosine}
      \end{subfigure}
  }
  \mbox{}
  \vspace{-2mm}
  \mbox{}
  \makebox[\textwidth][c]{
      \begin{subfigure}{\shrinkfigimgs\textwidth}
        \includegraphics[trim={0.28cm 0cm 0.3cm 0.35cm}, clip, width=\textwidth]{pdffigs/img.111M.200TPP.OPTIMAL.jump.None.WD=0.1.100.pdf}
        \subcaption{$\step$}
        \label{fig:img_emas:step}
      \end{subfigure}
      \hspace{-1mm}
      \begin{subfigure}{\shrinkfigimgs\textwidth}
        \includegraphics[trim={0.28cm 0cm 0.3cm 0.35cm}, clip, width=\textwidth]{pdffigs/img.111M.200TPP.OPTIMAL.linear.1x.WD=0.1.100.pdf}
        \subcaption{$\constant$}
        \label{fig:img_emas:constant}
      \end{subfigure}
  }
  \mbox{}
  \vspace{-4mm}
  \mbox{}
  \caption{\textbf{EMA perspective: weight update contribution across
      steps}: Convex combination of weight updates, with color
    indicating value of combination coefficients $c_{t,i}$: each
    $c_{t,i}$ gives the contribution of the $i$th update (across
    x-axis) to model weights $\theta_t$ across steps $t$ (y-axis).
    Note that LR schedules and coefficients corresponding to the final
    step only were presented earlier in \cref{fig:background_ema}
    (except for $\constant$).
    %
    Coefficients correspond to settings for 111M-parameter models trained
    to 200~TPP: $t$=$55680$, $\hateta$=$\maxlr$,
    $\rho$=$\nicefrac{1}{3}$, $\lambda$=$0.1$.\label{fig:img_emas}}
\end{figure}
