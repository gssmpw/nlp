\appendix
\section{Selective Sparse MAD Algorithm} \label{appendix:s^2-al}
The detailed \({\text{S}^2\text{-MAD}}\) Algorithm is as follows:
\begin{breakablealgorithm}
    \caption{\({\text{S}^2\text{-MAD}}\) Methods}
    \label{alg:S^2_MAD}
    \begin{algorithmic}[1]
        \Require Number of groups $N$, number of agents $M$, question $Q$, total rounds $T$, intra-group debate round $R$, total stages $S$, redundancy filter $F$, Opinion Judger $J$, answer extracter $VOTE$ 
        \Ensure $Answer$
     
        % \State $A \gets [A_1,A_2,\ldots,A_M]$  \quad \quad \quad \quad \quad \rotatebox[origin=c]{270}{$\triangle$} Initialize and shuffle the agents randomly
        \State $A \gets [A_1,A_2,\ldots,A_M]$ 
        \Statex\Comment{Initialize and shuffle the agents randomly}
        \State $G \gets [G_1,G_2,\ldots,G_N]$  
        \Statex\Comment{Initialize each group} 
        \State $H \gets [H_1,H_2,\ldots,H_M]$  
        \Statex\Comment{Initialize each agent with empty memory}
        
        \State $Sum \gets [Sum_1, Sum_2,\ldots,Sum_N]$  
        % \Statex\Comment{Initialize summary pool with empty list}

        \For{$i=1$ to $M$}
            \State $H_i \gets [Q]$ %\Comment{Initialize memory of each agent}
        \EndFor
        
        \For{$s=1$ to $S$}
            \For{$j=1$ to $N$}
                \For{$t = (s-1)R+1$ to $\min(sR,T)$}
                    \For{$A_i \in G_j$}
                        \If{$s=1$ \textbf{and} $t=1$}
                        % \If{$t=(s-1)R+1$}
                            \State $h_i \gets A_i(H_i)$ %\Comment{ Utilize agents to generate responses in the first round}
                            \State $H_i \gets H_i + h_i$ %\Comment{Append response to memory}
                            \State $H_i \gets H_i + BUF$ 
                            %\Statex\Comment{Append empty buffer to memory in order to unIform Format}
                        \Else
                            \State $buf \gets [\quad]$
                            \If{$s \neq 1$ \textbf{and} $t=(s-1)R+1$}
                                \For{$S_i \in Sum$}
                                    \If{$J(H_i[-2],S_i)$}
                                        \State $buf \gets buf + S_i$ %\Comment{Append summary differ from agent's own}
                                    \EndIf
                                \EndFor
                            \Else
                                \For{$A_{i'} \in G_j$ \textbf{and} $A_{i'} \neq A_i$}
                                    \If{$J(H_i[-2],H_{i'}[-2])$}
                                        \State $buf \gets buf + Replay_{i'}$  
                                        %\Statex\Comment{aggregate outputs of other agents differ with agent's own in the same group}
                                    \EndIf
                                \EndFor
                            \EndIf
                            \If{$len(buf) \ne 0$}
                                \State $H_i[-1] \gets buf$ 
                                %\Statex\Comment{Append different outputs of other agents/groups in the same group}
                                \State $h_i \gets A_i(H_i)$ 
                                %\Statex\Comment{Utilize agents to generate responses using other agents' outputs}
                                \State $H_i[-2] \gets h_i$   %\Comment{update the previous output}
                            \EndIf
                        \EndIf
                    \EndFor
                    % \For{$A_i \in G_j$}
                    %     \State $Replay_i \gets H_i[-2]$ \quad \quad \quad \quad \rotatebox[origin=c]{270}{$\triangle$}  update the replay pool
                    % \EndFor
                \EndFor
                \If{$s \neq S$}
                    \State $summary \gets [\;]$
                    \For{$A_i \in G_j$}                       
                        \State $sum \gets sum + H_i[-2]$         
                    \EndFor
                    \State $Sum_j \gets LLM(sum)$ 
                    %\Statex\Comment{Utilize LLM to generate summary at the end of each stage}
                \EndIf 
            \EndFor
            \State $Sum \gets F(Sum)$%\Comment{Filter out unique summary}
            \If{$len(Sum)=1$}
                break\Comment{End debate if only one summary}
            \EndIf                
        \EndFor
        \State $Answer \gets VOTE(H)$
        
    \State \Return $Answer$
    \end{algorithmic}
\end{breakablealgorithm}

\section{Token Cost Analysis} \label{appendix:token-cost-S^2-MAD}
In this appendix section, we aim to provide a theoretical analysis of the token cost for \({\text{S}^2\text{-MAD}}\). As LLMs' outputs typically are not too long and we can actually control the token length of LLMs' outputs in prompts to some extent, we assume that the upper bound on the number of tokens output by each agent participating in debate is $Output_{max}$ and the upper bound on the number of tokens in the generated summary is $Summary_{max}$. We define $C$ as the maximum of $Output_{max}$ and $Summary_{max}$, $P$ represents the upper bound of the average probability of each Agent participating in the debate globally.

As mentioned in Section \ref{sec:methodology}, our \({\text{S}^2\text{-MAD}}\) includes three types of processes and thus the total token cost $Token^{GD}$ can be further dividied into:
\begin{equation}
\begin{aligned} 
    &Token = \underbrace{Token_1^1}_\text{initial thinking} + \\ 
    &\underbrace{\sum_{s=2}^{S}(Token^{summary}_{s-1}+Token_s^{(s-1)R+1})}_\text{inter-group discussion} \\
    &+ \underbrace{\sum_{s=1}^{S}\sum_{t=(s-1)R+2}^{min(sR,T)}Token_s^t}_\text{intra-group discussion}
\end{aligned}
\end{equation}\label{eq:divide}
Specifically, for initial thinking, the token cost of each agent includes the initial question prompt and its own output. For intra-group debate, the token cost of each agent includes the unique responses from other agents within the same group that differ from its own in the previous round and its output. For inter-group debate, the token cost includes the summary generation cost, which comprises the unique responses from all groups and the output summary, as well the token cost of each agent which comprises as its output and summary from from other groups that differ from its own. The detailed computation process of the token cost in \({\text{S}^2\text{-MAD}}\) can be found in Algorithm \ref{alg:token_cost_s^2_mad}.

\begin{algorithm}[ht]
    \caption{Tokens Cost in \({\text{S}^2\text{-MAD}}\) Methods}
    \label{alg:token_cost_s^2_mad}
    \begin{algorithmic}[1]
        \Require Number of groups $N$, number of agents  $M$, question length $Q$, total rounds $T$, group debate round $R$, total stages $S$, summary of each group at the end of each stage $Summary = \{Summary_j^s|j=1,2, \ldots,N,s=1,2,\ldots,S\}$ , output length of each agent $A_i(i=1,2, \ldots,M)$ in each round $t(t=1,2,\ldots,T)$ $Output_i^t$,  each group agents set $G = \{G_j|j=1,2, \ldots,N\}$, probability of participating in the debate of each agent $P=\{P_i^t|i=1,2,\ldots,M,t=1,2,\ldots,T\}$.
        \Ensure Total token cost $Token$
        
        \State $Token_1^{1} \gets M \times Q + \sum_{i=1}^{M} O_i^1$ \\
        \Statex\Comment{First round} 
        
        \For{$t = 2$ to $R$}
            \State $Token_1^t \gets \sum_{j=1}^{N} \sum_{i \in G_j} (Q  + O_i^{t}+$
            \Statex $\qquad \qquad \qquad \qquad \qquad \sum_{i' \in G_j} O_{i'}^{t-1})$ 
            \Statex \Comment{Subsequent rounds of the first stage}
        \EndFor
        
        \For{$s=2$ to $S$}
            \State $Token_{s-1}^{summary} \gets \sum_{j=1}^{N} (\sum_{i \in G_j}$
            \Statex $\qquad \qquad O_i^{(s-1)R} + Sum_j^{s-1})$ 
            \Statex \Comment{Summary at the end of stage $s-1$}
            
            \State $Token_s^{(s-1)R+1} \gets \sum_{i=1}^{M} P_i^{(s-1)R+1}(Q+$
            \Statex $\qquad \quad O_i^{(s-1)R}+ \sum_{j=1}^{N} Sum_j^{s-1}$
            \Statex $\qquad \quad + O_i^{(s-1)R+1})$ 
            \Statex \Comment{First round of the stage $s$}
        
            \For{$t = (s-1)R+2$ to $\min(sR,T)$}
                \State $Token_s^t \gets \sum_{j=1}^{N} \sum_{i \in G_j} P_i^t(Q  + $
                \Statex $\qquad \qquad O_i^{t} + \sum_{i' \in G_j} O_{i'}^{t-1})$ 
                \Statex \Comment{Subsequent rounds of the stage $s$}
            \EndFor
        \EndFor
        
        \State $Token \gets  \sum_{t=1}^{R}Token_1^t+\sum_{s=2}^S($
        \Statex $Token_{s-1}^{summary}+\sum_{t=(s-1)R+1}^{\min(sR,T)}Token_s^t)$ 
        \Statex \Comment{Total token cost in debate}
        
        \State \Return $Token$
    \end{algorithmic}
\end{algorithm}

Following Alogorithm~\ref{alg:token_cost_s^2_mad} and Eq.~\ref{eq:divide}, we have: 
\begin{equation}
\begin{aligned}
    &Token = MQ + \sum_{i=1}^M O_i^1 \\
    &+ \sum_{s=2}^S [\sum_{j=1}^N(\sum_{i\in G_j} O_i^{(s-1)R}+Sum_j^{s-1}) \\
    &+\sum_{i=1}^MP_i^{(s-1)R}(Q+O_i^{(s-1)R+1}\\
    &\qquad+\frac{D_i^t}{N}\sum_{j=1}^N Sum_j^{s-1} +Output_i^{(s-1)R+1})]\\
    &+\sum_{s=1}^S \sum_{t=(s-1)R+2}^{min(sR,T)}\sum_{j=1}^N\sum_{i\in G_j}P_i^t(Q+O_i^t\\
    &\qquad\qquad\qquad\qquad\qquad+\frac{MD_i^t}{N}\sum_{i' \in G_j}O_{i'}^{t-1}) \\
    & \leq MTQ + P_{max} \times \{\\
    &\quad[3MS-2M+(T-S)(K+1)M] \times O_{max}\\
    &\quad+ (S-1)(M+1)N\times Sum_{max} \}\\
    & \leq MTQ+P_{max} \times \{\frac{2M^2T}{N}\times O_{max} \\
    &\quad+ 2MSN\times Sum_{max}\} \\
    & = \mathcal{O}\left(MTQ+(\frac{M^2T}{N}+MSN)CP\right)
\end{aligned}
\end{equation}

When we set $N \rightarrow \mathcal{O}\left(\sqrt{\frac{MT}{S}}\right)$, we can theoretically obtain $Token \rightarrow \mathcal{O}\left(MTQ+\sqrt{M^3TS}CP\right)$. Furthermore, If we consider setting $S$ to a very small positive integer and the average probability of their participation decreases as the capability of individual agents improves, then $Token$ can approach $\mathcal{O}\left(MTQ+\sqrt{M^3T}CP\right)$. This complexity is significantly lower than that of MAD.

\section{Prompts} \label{appendix:prompts}
In this section, we present some examples of prompts. Table \ref{tab:input-prompts} displays the input prompts used in our \({\text{S}^2\text{-MAD}}\) across different datasets, which encompass five different types. Table \ref{tab:Requirements} outlines the prompts regarding output Format Requirements in our \({\text{S}^2\text{-MAD}}\).

\begin{table*}[t]
% \small
\setlength{\tabcolsep}{5.5pt}
\centering
\resizebox{\textwidth}{!}{
% \scalebox{0.8}{
\begin{tabular}{ccl}
    \toprule
    {\bf Type} & {\bf Task} & {\bf Prompt} \\
    \midrule
     \multirow{4}{*}{System}  & \multirow{4}{*}{All} & \emph{Welcome to the debate! You are a seasoned debater with expertise in succinctly and persuasively expressing your viewpoints. }\\
     & & \emph{You will be assigned to debate groups, where you will engage in discussions with fellow participants. The outcomes of }\\
     & & \emph{each group's deliberations will be shared among all members. It is crucial For you to leverage this inFormation effectively }\\
     & & \emph{in order to critically analyze the question at hand and ultimately arrive at the correct answer. Best of luck!} \\
     \midrule
      \multirow{5}{*}{Starting}  & \multirow{1}{*}{Arithmetic} & \emph{What is the result of \{\}+\{\}*\{\}+\{\}-\{\}*\{\}? $<$ Output Format $>$.}   \\
      \cmidrule{2-3}
      & \multirow{1}{*}{GSM8K} & \emph{Can you solve the following math problem? $<$Problem$>$ Explain your reasoning.  $<$ Output Format $>$.}\\
      \cmidrule{2-3}
     & \multirow{1}{*}{MMLU} & \emph{Can you answer the following question? $<$Problem$>$: A) {}, B) {}, C) {}, D) {} Explain your answer, $<$Output Format$>$.} \\
     \cmidrule{2-3}
     & \multirow{1}{*}{MATH} & \emph{Can you solve the following math problem? $<$Problem$>$ Explain your reasoning as concise as possible. $<$Output Format$>$ . } \\
     \cmidrule{2-3}
     & \multirow{1}{*}{GPQA} & \emph{Can you answer the following question? $<$Problem$>$: A) {}, B) {}, C) {}, D) {} Explain your answer, $<$Output Format$>$.} \\
     \midrule
      \multirow{2}{*}{Intra-group Debate}  & \multirow{2}{*}{All} & \emph{These are the recent unique opinions from other agents that differ with yours: $<$other agent responses$>$ Using the opinions} \\
      & & \emph{carefully as additional advice, can you provide an updated answer?}\\
      && \emph{Examine your solution and that other agents step by step. $<$Output Format$>$ .} \\
     \midrule
     \multirow{3}{*}{Summary}  & \multirow{3}{*}{All} & \emph{These are the recent/updated and unique opinions from all agents: $<$all agent responses$>$}\\
     & & \emph{Summarize these opinions carefully and completly in no more than 80 words. }\\
     & & \emph{Aggregate and put your final answers in parentheses at the end of your response. }\\
     \midrule
     \multirow{3}{*}{Inter-group Debate}  & \multirow{3}{*}{All} & \emph{These are the recent unique opinions from all groups: one group responses: $<$group summary$>$. } \\
      & & \emph{Using the reasoning from all groups as additional advice, can you give an updated answer?} \\
      & & \emph{Examine your solution and that all groups step by step. $<$Output Format$>$.} \\
    \bottomrule
\end{tabular}
% }
}
\caption{\textbf{Prompts in Each Stage.} List of prompts used in each task. }
\label{tab:input-prompts}
% \vspace{-10pt}
\end{table*}


\begin{table*}[t]
\centering
\resizebox{\textwidth}{!}{
\begin{tabular}{@{\extracolsep{2pt}}lc@{}}
\toprule
Dataset & \multicolumn{1}{c}{Output Format Requirements} \\
\midrule
\multirow{1}{*}{Arithmetic} & \emph{Make sure to State your answer at the end of the response.}\\
\midrule
\multirow{2}{*}{GSM8K} & \emph{Your final answer should be a single numerical number, in the Form \textbackslash boxed\{\{answer\}\},}\\
& \emph{at the end of your response.}\\
\midrule
\multirow{1}{*}{MMLU} & \emph{Put your final choice in parentheses at the end of your response.}\\
\midrule
\multirow{1}{*}{MATH} & \emph{Put your final answer in the Form \textbackslash boxed\{\{answer\}\}, at the end of your response.}\\
\midrule
\multirow{1}{*}{GPQA} & \emph{Put your final answer in the Form \textbackslash The correct answer is (insert answer here)}\\
\bottomrule
\end{tabular}
}
\caption{\textbf{Output Format Requirements in Each Dataset.}}
\label{tab:Requirements}
\end{table*}

\newpage

\section{More Result}

\label{sec:experiments_add}

\begin{table*}[t]
\centering
\setlength\tabcolsep{1.5 pt}
\resizebox{\textwidth}{!}{
    \begin{tabular}{ccccccccc} 
    \toprule
    \multirow{2}{*}{Methods} & \multicolumn{2}{c}{GSM8K} & \multicolumn{2}{c}{MATH} & \multicolumn{2}{c}{MMLU} & \multicolumn{2}{c}{GPQA}   \\ 
    \cmidrule{2-9}
    & ACC(\%)$\uparrow$  & Tokens($k$)$\downarrow$   & ACC(\%)$\uparrow$   & Tokens($k$)$\downarrow$   & ACC(\%)$\uparrow$   & Tokens($k$)$\downarrow$       & ACC(\%)$\uparrow$    & Tokens($k$)$\downarrow$   \\ 
    \midrule
    % \rowcolor{lightgray}
    \rowcolor{Gray}
    \multicolumn{9}{c}{\texttt{GPT-4o-mini}} 
    \\
    \midrule
    MAD(5,4)                 & \underline{91.0}\scriptsize{$\pm 0.00$} & 50.6\scriptsize{$\pm 0.16$}          & \underline{72.3}\scriptsize{$\pm 0.00$}  & 78.7\scriptsize{$\pm 0.31$}        & \underline{89.5}\scriptsize{$\pm 0.02$} & 63.4\scriptsize{$\pm 0.29$}                & 43.7\scriptsize{$\pm 0.00$} & 118.9\scriptsize{$\pm 2.33$}                    \\ 
    S-MAD(5,4)                 & 90.0\scriptsize{$\pm 0.01$} & 50.6\scriptsize{$\pm 0.49$}          & 71.7\scriptsize{$\pm 0.02$}  & 65.9\scriptsize{$\pm 0.42$}        & 89.1\scriptsize{$\pm 0.01$} & 49.3\scriptsize{$\pm 0.19$}                & 44.7\scriptsize{$\pm 0.02$} & 97.6\scriptsize{$\pm 0.30$}             \\ 
    GD(5,4)                  & 89.3\scriptsize{$\pm 0.00$} & 22.1\scriptsize{$\pm 0.07$}          & 72.0\scriptsize{$\pm 0.01$} & 38.8\scriptsize{$\pm 0.07$}         & 88.8\scriptsize{$\pm 0.00$} & 23.9\scriptsize{$\pm 0.08$}                & \underline{46.6}\scriptsize{$\pm 0.00$} & 64.9\scriptsize{$\pm 0.48$}                    \\ 
    \({\text{S}^2\text{-MAD(5,4)}}\)                  & 90.7\scriptsize{$\pm 0.01$} & \textbf{3.29}\scriptsize{$\pm 0.20$}          & 70.7\scriptsize{$\pm 0.01$} & \textbf{12.4}\scriptsize{$\pm 0.73$}         & 86.1\scriptsize{$\pm 0.00$} & \textbf{3.84}\scriptsize{$\pm 0.28$}                & 42.3\scriptsize{$\pm 0.02$} & \underline{24.5}\scriptsize{$\pm 7.38$}            \\
    \({M\text{S}^2\text{-MAD(5,4)}}\) & \textbf{91.7}\scriptsize{$\pm 0.01$} & \underline{3.75}\scriptsize{$\pm 0.19$}          & \textbf{72.3}\scriptsize{$\pm 0.02$} & \underline{14.4}\scriptsize{$\pm 0.10$}         & \textbf{89.8}\scriptsize{$\pm 0.01$} & \underline{5.50}\scriptsize{$\pm 0.39$}                & \textbf{46.8}\scriptsize{$\pm 0.03$} & \textbf{20.8}\scriptsize{$\pm 3.94$} \\
    \midrule
    % \rowcolor{lightgray}
    \rowcolor{Gray}
    \multicolumn{9}{c}{\texttt{GPT-4o-0806}} 
    \\
    \midrule
    MAD(5,4)                 & \underline{94.0}\scriptsize{$\pm 0.00$} & 48.4\scriptsize{$\pm 0.08$}          & \textbf{79.0}\scriptsize{$\pm 0.01$} & 67.8\scriptsize{$\pm 0.09$}        & 88.4\scriptsize{$\pm 0.01$} & 52.9\scriptsize{$\pm 0.13$}                & 52.2\scriptsize{$\pm 0.04$} & 102.6\scriptsize{$\pm 2.84$}                    \\ 
    S-MAD(5,4)                 & 93.7\scriptsize{$\pm 0.00$} & 39.1\scriptsize{$\pm 0.15$}          & 76.7\scriptsize{$\pm 0.02$}  & 54.8\scriptsize{$\pm 0.11$}        & \underline{\textbf{89.8}}\scriptsize{$\pm 0.00$} & 41.2\scriptsize{$\pm 0.33$}                 & \textbf{53.0}\scriptsize{$\pm 0.01$} & 93.7\scriptsize{$\pm 2.16$}                    \\ 
    GD(5,4)                  & 92.7\scriptsize{$\pm 0.01$} & 20.7\scriptsize{$\pm 0.06$}           & 74.7\scriptsize{$\pm 0.01$} & 44.9\scriptsize{$\pm 0.07$}         & 88.4\scriptsize{$\pm 0.00$} & 22.4\scriptsize{$\pm 0.04$}                & 52.5\scriptsize{$\pm 0.03$} & 60.1\scriptsize{$\pm 1.34$}
     \\
    \({\text{S}^2\text{-MAD(5,4)}}\)                  & 92.8\scriptsize{$\pm 0.01$} & \textbf{2.93}\scriptsize{$\pm 0.20$}          & 75.3\scriptsize{$\pm 0.02$} & \textbf{11.8}\scriptsize{$\pm 0.46$}         & 88.3\scriptsize{$\pm 0.01$} & \textbf{4.34}\scriptsize{$\pm 0.13$}                & 51.0\scriptsize{$\pm 0.04$} & \textbf{21.9}\scriptsize{$\pm 7.49$}                 \\
    \({M\text{S}^2\text{-MAD(5,4)}}\) & \textbf{94.0}\scriptsize{$\pm 0.01$} & \underline{3.35}\scriptsize{$\pm 0.14$}          & \underline{77.0}\scriptsize{$\pm 0.01$} & \underline{12.7}\scriptsize{$\pm 1.41$}         & \underline{88.6}\scriptsize{$\pm 0.00$} & \underline{5.48}\scriptsize{$\pm 0.26$}                & \underline{52.7}\scriptsize{$\pm 0.01$} & \underline{26.5}\scriptsize{$\pm 9.82$} \\
    \bottomrule
    \end{tabular}
    }
    \caption{\textbf{Comparison of Token Cost and Accuracy Between \({\text{S}^2\text{-MAD}}\) and Other Methods.} The results of highest accuracy are \textbf{bold} and the results of both highest accuracy and lowest token cost except from CoT are \underline{underlined}. The dash (-) indicates that the model achieved a correctness rate of 1 for all methods on this dataset.}
\label{tab:comparison_add}
\end{table*}

In this appendix section, we conducted a detailed comparative experiment between our proposed method and other multi-agent debate methods using GPT-4o-mini and GPT-4o-0806. As shown in the Table \ref{tab:comparison_add}, \({\text{S}^2\text{-MAD}}\) consistently reduces the total token cost while maintaining comparable accuracy. Specifically, on four datasets, our method achieved a reduction of 94.3\%/84.2\%/94.0\%/79.4\% compared to MAD, respectively. Furthermore, to enhance the accuracy, we initialized agents with multiple prompt settings as \({\text{MS}^2\text{-MAD}}\), encouraging them to explore multiple thought paths, thereby achieving optimal accuracy. This suggests that promoting the exploration of multiple thought paths in multi-agent debates can be beneficial for the agent system to solve problems more accurately.
