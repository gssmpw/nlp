\begin{ListingWithCaption}
\begin{lstlisting}[caption={An implementation of the empirical CDF conventions used in this work, using NumPy, version 1.26.4. See the text for a further discussion.}, label={lst:empirical-cdfs}]
    def getCDFIndex(trueClass_To_CDF, val, prediction, reverse=False, val_in_0to1=False):
    	# trueClass_To_CDF is a dictionary with a key for each class, the values of which are sorted ascending lists of numbers, since np.searchsorted assumes an ascending sort of its initial argument.
        if prediction not in trueClass_To_CDF or len(trueClass_To_CDF[prediction]) == 0:
            return 0.0
        if val_in_0to1 and len(trueClass_To_CDF[prediction]) > 0 and val >= trueClass_To_CDF[prediction][-1]:  # saturation guard
            assert not reverse
            return 1.0
        index = np.searchsorted(trueClass_To_CDF[prediction], val, side="left")  # will be 0 for len() == 0
        if reverse:  # use for distances
            return 1 - index / len(trueClass_To_CDF[prediction])
        else:
            return index / len(trueClass_To_CDF[prediction])
\end{lstlisting}
\end{ListingWithCaption}