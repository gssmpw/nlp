\begin{algorithm}
    \caption{Training the Weights of the Rescaling Transform}
    \label{alg:train-rescaler}
    \small
    \begin{algorithmic}[1] 
        \Require cached $\vv$ for $\calibrationSplit$, $\text{rescaler max epochs}$, $\text{rescaler stopping condition}$ %
        \Procedure{train-rescaler}{cached $\vv$ for $\calibrationSplit$, $\text{rescaler max epochs}$, $\text{rescaler stopping condition}$}
        		\State $\mW^{''}_{*} \gets \emptyset$ \Comment{Final weights}
        		\State $\mW^{''} \gets$ random initialization
		\State $\rm{metric} \gets \infty$
		\State $\rm{counter} \gets 0$
             	\For{$e \in 1, \ldots, \text{rescaler max epochs}$}
		 	\State Minimize ${\rm{loss}} \gets \gL(\mW^{''}; \calibrationSplit)$ \Comment{Eq.~\ref{eq:rescaler-loss}}
          	 	\If{${\rm{loss}} < \rm{metric}$}
           			\State $\rm{metric} \gets {\rm{loss}}$
				\State $\mW^{''}_{*} \gets \mW^{''}$
           		\EndIf
		        \If{${\rm{loss}} > \rm{metric}$}
           			\State $\rm{counter} \gets \rm{counter} + 1$
				\If{$\rm{counter} > \text{rescaler stopping condition}$}
					\State \textbf{break} 
				\EndIf
			\Else
				\State $\rm{counter} \gets 0$
           		\EndIf
		 \EndFor
             \State \textbf{return} $\mW^{''}_{*}$
        \EndProcedure
        \Ensure $\mW^{''}_{*}$
    \end{algorithmic}
\end{algorithm}