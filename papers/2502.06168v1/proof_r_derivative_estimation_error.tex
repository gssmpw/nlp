\begin{proof}
    Here we consider the time periods before time $t$, and we use an index $s$ to denote each time period $s=1,2,\ldots, t-1, t$. As a consequence, we have the notations $D_s, \gamma_s, k_s, \ind_s$ corresponding to $D_t, \gamma_t, k_t, \ind_t$ as we defined in \Cref{sec:preliminaries} and \Cref{sec:algorithm}. Also, we denote $N_k(t), F_k(t)$ and $G_k(t)$ as the value of $N_k, F_k$ and $G_k$ at the beginning of time period $t$.

    From \Cref{algo:C20CB}, we have
    \begin{equation}
        \label{eq:r'_estimate_decomposition_1}
        \begin{aligned}
            |\hat r_{k,t} - r'_t(p_{k,t})|\leq&|G_k(t)-(G(c)-G(\gamma_t-a+bp_{k,t}))|+p_{k,t}|\hat bF_k-bF(\gamma_t-a+bp_{k,t})|.
        \end{aligned}
    \end{equation}
    Notice that $G_k(t)=\frac1{N_k(t)}\cdot\sum_{s=1}^{t-1}\ind[k_s==k]\cdot(D_s-\gamma_s+c)$. Also, for each $D_s$ on the price $p_{k_s, s}$, we have
    \begin{equation}
        \label{eq:expectation_d_s}
        \begin{aligned}
            \E[D_s|p_{k_s, s}=\frac{W_k-(\gamma_s-\hat a)}{\hat b}]=(\gamma_t-c+G(c)-G(\gamma_s-a+bp_{k_s,s})).
        \end{aligned}
    \end{equation}
    Recall that $W_k=2k\Delta$. Hence we have
    \begin{equation}
        \label{eq:expectation_g_k_t}
        \begin{aligned}
            \E[G_k(t)]=&\frac1{N_k(t)}\sum_{s=1}^{t-1}\ind[k_s==k]\cdot\E[D_s-\gamma_s+c]\\
            =&\frac1{N_k(t)}\sum_{s=1}^{t-1}\ind[k_s==k](G(c)-G(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b})).
        \end{aligned}
    \end{equation}
    Also, due to the fact that $G(x)$ is $1$-Lipschitz, we have
    \begin{equation}
        \label{eq:g_k_estimation_error}
        \begin{aligned}
            &|G(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b})|\\
            =&|G(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}{b} +b(\frac1{\hat b}-\frac1b)(k\delta-\gamma_s+\hat a)) - G(2k\Delta)|\\
            =&|G(\gamma_s-a+2k\Delta-\gamma_s+\hat a +\frac{b-\hat b}{\hat b}\cdot(2k\Delta-\gamma_s+\hat a)) - G(2k\Delta)|\\
            =&|G(2k\Delta + (\hat a - a) + (b-\hat b)\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b}) - G(2k\Delta)|\\
            \leq&|2k\Delta + (\hat a - a) + (b-\hat b)\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b}-2k\Delta|\\
            \leq&|\hat a-a| + |b-\hat b|\cdot\frac{|2k\Delta-\gamma_s+\hat a|}{\hat b}\\
            <&(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Therefore, we know that
    \begin{equation}
        \label{eq:g_k_bias}
        \begin{aligned}
            |\E[G_k(t)]-(G(c)-G(2k\Delta))|\leq&\frac1{N_k(t)}\sum_{s=1}^{t-1}\ind[k_s==k](C_a+C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}\\
            \leq&(C_a+C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Also, since each $D_s-\gamma_s + c < a_{max} + c$, according to Hoeffding's Inequality, with $\Pr\geq 1- \eta\delta$ we have
    
    \begin{equation}
        \label{eq:hoeffding_g_k}
        \begin{aligned}
            &|G_k(t)-(G(c)-G(2k\Delta))|\\
            \leq&|G_k(t)-\E[G_k(t)]| + |\E[G_k(t)]-(G(c)-G(2k\Delta))|\\
            \leq&(a_{\max}+c)\cdot\sqrt{\frac12\log\frac2{\eta\delta}}\frac1{\sqrt{N_k{t}}} + (C_a+C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    On the other hand, since
    \begin{equation}
        \label{eq:expectation_f_k}
        \begin{aligned}
            \E[F_k(t)]=&\frac1{N_k(t)}\sum_{s=1}^{t-1}\ind[k_s==k]\E[\ind[D_s<\gamma_s]]\\
            =&\frac1{N_k(t)}\sum_{s=1}^{t-1}\ind[k_s==k]\cdot F(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b}).
        \end{aligned}
    \end{equation}
    Similar to \Cref{eq:g_k_estimation_error}, since $F(x)$ is $L_F$-Lipschitz, we have
    \begin{equation}
        \label{eq:f_k_estimation_error}
        \begin{aligned}
            &|F(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b}) - F(2k\Delta)|\\
            =&|F(\gamma_s-a+b\cdot\frac{2k\Delta-\gamma_s+\hat a}b + b(\frac1{\hat b}-\frac1b)(2k\Delta-\gamma_s+\hat a))-F(2k\Delta)|\\
            =&|F(\gamma_s-a+2k\Delta-\gamma_s+\hat a+\frac{b-\hat b}{\hat b}(2k\Delta-\gamma_s+\hat a))-F(2k\Delta)|\\
            =&|F(2k\Delta+(\hat a-a) + (b-\hat b)\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b})-F(2k\Delta)|\\
            \leq&L_F\cdot(|\hat a - a| + |b - \hat b|\cdot\frac{2k\Delta-\gamma_s+\hat a}{\hat b})\\
            <&L_F\cdot(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Therefore, we have
    \begin{equation}
        \label{eq:f_k_bias}
        \begin{aligned}
            |\E[F_k(t)-F(2k\Delta)]|\leq L_F\cdot(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}

    Also, since $\ind_s=\ind[D_s<\gamma_s]$, according to Hoeffding's inequality, with $\Pr\geq1-\eta\delta$ we have
    \begin{equation}
        \label{eq:hoeffding_f_k}
        \begin{aligned}
            &|F_k(t)-F(2k\Delta)|\\
            \leq&|F_k(t)-\E[F_k(t)]| + |\E[F_k(t)] - F(2k\Delta)|\\
            \leq&1\cdot\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{N_k(t)} + L_F(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    As a consequence, we have bounded the estimation error of $\hat r_{k,t}$ from $r'_t(p_{k,t})$:
    \begin{equation}
        \label{eq:r_derivatives_estimation_error_final}
        \begin{aligned}
            &|r'_t(p_{k,t})-\hat r_{k,t}|\\
            \leq&|\gamma_t - c + G_k(t)-\hat b p_{k,t} F_k(t) - (\gamma_t-c+G(c)-G(2k\Delta)-b p_{k,t} F(2k\Delta))|\\
            &+ |G(2k\Delta) - G(\gamma_t-a+b\cdot\frac{2k\Delta-(\gamma_t-\hat a)}{\hat b})|+ bp_{k,t}|F(2k\Delta) - F(\gamma_t-a+b\cdot\frac{2k\Delta-(\gamma_t-\hat a)}{\hat b})|\\
            \leq&|G_k(t)-(G(c)-G(2k\Delta))| + |\hat b - b|\cdot p_{k,t}F_k + bp_{k,t}|F_k(t)-F(2k\Delta)|\\
            &+ |G(2k\Delta)-G(\gamma_t-a+b\cdot\frac{2k\Delta-(\gamma_t-\hat a)}{\hat b})| + b_{\max}p_{\max}\cdot|F(2k\Delta)-F(\gamma_t-a+b\cdot\frac{2k\Delta - (\gamma_t-\hat a)}{\hat b})|\\
            \leq&(c+a_{\max})\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{N_k(t)}} + (C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}} + p_{\max}C_b\cdot\frac1{\sqrt{\tau}}\\
            &+ b_{\max}p_{\max}(\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{N_k(t)}} + L_F(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}})\\
            &+ (C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\sqrt{\tau}} + b_{\max}p_{\max}L_F(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}})\cdot\frac1{\tau}\\
            =:&C_N\cdot\frac1{\sqrt{N_k(t)}} + C_{\tau}\cdot\frac1{\sqrt{\tau}}
            =\Delta_k.
        \end{aligned}
    \end{equation}
    Here 
    \begin{equation}
        \label{eq:def_c_n_c_tau}
        \begin{aligned}
            C_N&:=(c+a_{\max} + b_{\max}p_{\max})\cdot\sqrt{\frac12\log\frac2{\eta\delta}},\\
            C_{\tau}&:=2(b_{\max}p_{\max}L_F + 1)(C_a + C_b\cdot\frac{c+a_{\max}}{b_{\min}}) + p_{\max}C_b.
        \end{aligned}
    \end{equation}
    Finally, we apply the union bound on the probability, and know that \Cref{eq:r_derivatives_estimation_error_final} holds with probability $\Pr\geq 1- 6\eta\delta$.
\end{proof}