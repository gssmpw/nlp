\begin{proof}
    Recall that $\gamma_0:=a_{\max} - b_{\min}p_{\max} + c$. Notice that
    \begin{equation}
        \label{eq:e_1_t-e_2_t_fraction_range}
        \begin{aligned}
            \frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0}\in[0, \frac1{\gamma_{\min}-\gamma_0}], e_{3,t}\in[0,1].
        \end{aligned}
    \end{equation}
    Also, for any $t=1,2,\ldots, \tau$ in Stage 1, and any $\gamma$ such that $\gamma_{\min}\leq \gamma_t$, we have
    \begin{equation}
        \label{eq:expectation_indicator_primary}
        \begin{aligned}
            \E[\ind[D_t\geq \gamma]]=&\E_{N_t}[\E_{p_t\sim U[0, p_{\max}]}[a-bp_t+N_t\geq \gamma|N_t]]\\
            =&\E_{N_t}[\E_{p_t\sim U[0, p_{\max}]}[p_t\leq\frac{a-\gamma+N_t}{b}|N_t]]\\
            =&\E_{N_t}[\frac{a-\gamma+N_t}{b\cdot p_{\max}}]\\
            =&\frac{a-\gamma}{bp_{\max}}.
        \end{aligned}
    \end{equation}
    Here the first row is due to Law of Total Expectation, and the last row is due to the zero-mean assumption of $N_t$ (see \Cref{assumption:noise}). Given this equation, we have:
    \begin{equation}
        \label{eq:expectation_e_i_t_results}
        \begin{aligned}
            \E[\frac{e_{1,t}-e_{2,t}}{\gamma_t-\gamma_0}]&=\frac{\frac{\frac{2\gamma_t + 2\gamma_0}4 - \frac{1\gamma_t + 3\gamma_0}4}{bp_{\max}}}{\gamma_t - \gamma_0}=\frac{\frac14\cdot(\gamma_t-\gamma_0\cdot\frac1{bp_{\max}})}{\gamma_t-\gamma_0}=\frac1{4bp_{\max}}.\\
            \E[e_{3,t}]&=\frac{a-\frac{3\gamma_t+\gamma_0}4}{bp_{\max}}.
        \end{aligned}
    \end{equation}
    According to Hoeffding's Inequality, we have with $\Pr\geq 1-\eta\delta$:
    \begin{equation}
        \label{eq:hoeffding_b}
        \begin{aligned}
            |\frac1{\tau}\sum_{t=1}^{\tau}\frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0} - \frac1{4bp_{\max}}|\leq\frac1{\gamma_{\min}-\gamma_0}\sqrt{\frac12\log\frac{2}{\eta\delta}}\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Based on this concentration, we upper bound the estimation error between $b$ and $\hat b$ by the end of Stage 1:
    \begin{equation}
        \label{eq:error_b}
        \begin{aligned}
            |\hat b - b|&=|\frac1{4p_{\max}\cdot\frac1{\tau}\sum_{t=1}^{\tau}\frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0}} - b|\\
            &=|\frac1{4p_{\max}(\frac1{\tau}\sum_{t=1}^{\tau}\frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0} - \frac1{4bp_{\max}}) + \frac1b}-\frac1{\frac1b}|\\
            &=|\frac{4p_{\max}\cdot\frac1{\tau}\sum_{t=1}^{\tau}\frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0}\cdot\frac1{4bp_{\max}}}{4p_{\max}\cdot\frac1{\tau}\sum_{t=1}^{\tau}\frac{e_{1,t}-e_{2,t}}{\gamma_t - \gamma_0}}|\\
            &\leq\frac{4p_{\max}\frac1{\gamma_{\min}-\gamma_0}\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}}{4p_{\max}(\frac1{4bp_{\max}}-\frac1{\gamma_{\min}-\gamma_0}\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}})\cdot\frac1b}\\
            &\leq\frac{\frac1{\gamma_{\min}-\gamma_0}\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}}{\frac1{8bp_{\max}}\cdot\frac1b}\\
            &\leq\frac{4b_{\max}^2p_{\max}}{\gamma_{\min} - \gamma_0}\cdot\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Here the fifth row requires $\frac1{8bp_{\max}}\geq \frac1{\gamma_{\min}-\gamma_0}\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}$, which further requires $T\geq (\frac{8bp_{\max}}{\gamma_{\min}-\gamma_0})^4\cdot\frac14\log^2\frac2{\eta\theta}$. According to \Cref{assumption:large_T}, we know that this inequality holds. Denote $C_b:=\frac{4b_{\max}^2p_{\max}}{\gamma_{\min} - \gamma_0}\cdot\sqrt{\frac12\log\frac2{\eta\delta}}$ and we have $|\hat b - b|\leq C_b\cdot\frac1{\sqrt{\tau}}$ with high probability.


    Again, according to Hoeffding's Inequality, we have with $\Pr\geq 1-\eta\delta$:
    \begin{equation}
        \label{eq:hoeffding_a}
        \begin{aligned}
            |\frac1\tau\sum_{t=1}^\tau e_{3,t} - \frac{a-\frac{3\gamma_t + \gamma_0}4}{bp_{\max}}|\leq\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Hence we have
    \begin{equation}
        \label{eq:error_a}
        \begin{aligned}
            |\hat a - a|=&|\frac1\tau\sum_{t=1}^\tau(\hat b p_{\max}e_{3,t} + \frac{3\gamma_t + \gamma_0}4) - a|\\
            =&|(\hat b - b)p_{\max}\cdot\frac1{\tau}\sum_{t=1}^\tau e_{3,t} + \frac1{\tau}\sum_{t=1}^\tau(b p_{\max}e_{3,t} - (a-\frac{3\gamma_t + \gamma_0}4))|\\
            \leq & |\hat b - b|p_{\max}\cdot 1 + |\frac1{\tau}\sum_{t=1}^\tau bp_{\max}e_{3,t} - (a-\frac{3\gamma_t + \gamma_0}4)|\\
            \leq & p_{\max}|\hat b - b| + bp_{\max}\cdot\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}\\
            =&p_{\max}\cdot C_b\cdot p_{\max}\frac1{\sqrt{\tau}} + bp_{\max}\sqrt{\frac12\log\frac2{\eta\delta}}\cdot\frac1{\sqrt{\tau}}\\
            \leq&p_{\max}(C_b + b_{\max}\sqrt{\frac12\log\frac2{\eta\delta}})\cdot\frac1{\sqrt{\tau}}.
        \end{aligned}
    \end{equation}
    Denote $C_a:=p_{\max}(C_b + b_{\max}\sqrt{\frac12\log\frac2{\eta\delta}})$ and the lemma is proven.
\end{proof}