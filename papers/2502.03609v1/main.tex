
\documentclass{article}

\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} %

\usepackage{hyperref}
\usepackage{bm}



\newcommand{\theHalgorithm}{\arabic{algorithm}}


\usepackage[accepted]{icml2025}

\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{ stmaryrd }

\usepackage{multirow}

\newcommand{\bff}{\mathbf{f}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bg}{\mathbf{g}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\by}{\mathbf{y}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bp}{\mathbf{p}}
\newcommand{\bq}{\mathbf{q}}
\newcommand{\R}{\mathbb{R}}



\usepackage[capitalize,noabbrev]{cleveref}

\usepackage[colorinlistoftodos]{todonotes}
\newcommand{\en}[1]{\todo[color=green!50!white]{\textbf{e:} #1}}
\usepackage{dsfont}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\newcommand{\OTCP}{\textbf{OT-CP}}
\newcommand{\MCP}{\textbf{M-CP}}
\newcommand{\MergeCP}{\textbf{Merge-CP}}


\newcommand{\argmin}{\mathop{\mathrm{arg\,min}}}
\DeclareMathOperator{\lse}{min}
\DeclareMathOperator*{\argmax}{argmax}
\graphicspath{{figures/}}




\icmltitlerunning{Multivariate Conformal Prediction using Optimal Transport}

\begin{document}
\twocolumn[
\icmltitle{Multivariate Conformal Prediction using Optimal Transport}



\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}

\icmlauthor{Michal Klein}{yyy}
\icmlauthor{Louis Bethune}{yyy}
\icmlauthor{Eugene Ndiaye}{yyy}
\icmlauthor{Marco Cuturi}{yyy}
\icmlcorrespondingauthor{Eugene Ndiaye}{e\_ndiaye@apple.com}
\end{icmlauthorlist}

\icmlaffiliation{yyy}{Apple}



\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]



\printAffiliationsAndNotice{\icmlEqualContribution} %

\input{subfiles/abstract}

\input{subfiles/introduction}
\input{subfiles/background}
\input{subfiles/multivariate_score}
\input{subfiles/experiments}
\input{subfiles/conclusion}


\newpage

\section{Concurrent Work.}\label{sec:concurrent}
Concurrently to our work, \citet{thurin2025optimaltransportbasedconformalprediction} proposed recently to leverage OT in CP with a similar approach, deriving a similar CP set as in \Cref{eq:full_transport_otcp} and analyzing a variant with asymptotic conditional coverage under additional regularity assumptions.
However, our methods differ in several key aspects. On the computational side, our implementation leverages general entropic maps (Section~\ref{subsec:entropic}) without compromising finite-sample coverage guarantees, an aspect we analyze in detail in Section~\ref{sec:coverage}.
In contrast, their approach requires solving a linear assignment problem,  using for instance the Hungarian algorithm, which has cubic complexity $O(n^3)$ in the number of target points, and which also requires having a target set on the sphere that is of the same size as the number of input points. With our notations in Section~\ref{subsec:entropic}, they require $n=m$, whereas we set $m$ to anywhere between $2^{12}$ and $2^{15}$, independently of $n$. While they mention efficient approximations that reduce complexity to quadratic in \citep[Remark 2.3]{thurin2025optimaltransportbasedconformalprediction}, their theoretical results do not yet cover these cases since their analysis relies on the fact that ranks are random permutations of $\{1/n, 2/n, \ldots, 1\}$, which cannot be extended to using Sinkhorn with soft assignment.
In contrast, our work establishes formal theoretical coverage guarantees even when approximated (pre-trained) transport map are used.\looseness=-1


\bibliography{ref}
\bibliographystyle{icml2025}

\appendix
\onecolumn

\input{subfiles/appendix}
\end{document}
