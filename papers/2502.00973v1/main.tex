\documentclass{article}


% if you need to pass options to natbib, use, e.g.:
\PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2024


% ready for submission
\usepackage[preprint]{neurips_2024}
\usepackage[T5]{fontenc}
\usepackage{amsmath} 
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{array} 
% to compile a preprint version, e.g., for submission to arXiv, add add the
% [preprint] option:
%     \usepackage[preprint]{neurips_2024}


% to compile a camera-ready version, add the [final] option, e.g.:
%     \usepackage[final]{neurips_2024}


% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{neurips_2024}
\usepackage{hyperref} 
\usepackage{times}
\usepackage{latexsym}
\usepackage{booktabs}
\usepackage{array}
\usepackage{amsmath}
\usepackage{mathabx}
\usepackage{multirow}
\usepackage{multicol}
\usepackage[numbers]{natbib}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
%\usepackage[T1]{fontenc}
% For Vietnamese characters
\usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}
\usepackage{enumitem} % Required for list customization

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}


% --------------My newly added packages--------------
\usepackage{mathrsfs}
\usepackage{lipsum} 
\usepackage[normalem]{ulem}
%\useunder{\uline}{\ul}{}
\usepackage{wrapfig}
\usepackage{float}
%----------------------------------------------------
% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
%\usepackage[T1]{fontenc}
% For Vietnamese characters
\usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}
\usepackage{enumitem} % Required for list customization

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}


% --------------My newly added packages--------------
\usepackage{mathrsfs}
\usepackage{lipsum} 
\usepackage[normalem]{ulem}
%\useunder{\uline}{\ul}{}
\usepackage{tcolorbox}

% --------------IEEE packages--------------
\usepackage{booktabs} % dashlines for tables
\usepackage{array}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{siunitx}

\usepackage{color,soul}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{array}
%\usepackage[dvipsnames]{xcolor}


\usepackage[utf8]{inputenc}
\usepackage{mathtools, nccmath}

\usepackage{adjustbox}

%\usepackage[figurename=Fig.]{caption}
%\renewcommand{\figurename}{Fig.}

\usepackage{pythonhighlight}
\usepackage{hyperref}

\newcommand\khai[1]{\noindent{\color{blue} {\bf \fbox{Khai}} {\it#1}}}
\newcommand\son[1]{\noindent{\color{red} {\bf \fbox{Son}} {\it#1}}}

\title{A Wearable Device Dataset for Mental Health Assessment Using Laser Doppler Flowmetry and Fluorescence Spectroscopy Sensors}
\author{Minh Ngoc Nguyen$^{*1,8}$, Khai Le-Duc$^{*2,3}$, Tan-Hanh Pham$^{*4}$,  \\ {\bf Trang Nguyen$^{5}$, Quang Minh Luu$^{6}$, Ba Kien Tran$^{7}$, Truong-Son Hy$^{9}$,}\\ {\bf Viktor Dremin$^1$, Sergei Sokolovsky$^1$, Edik Rafailov$^1$}\\
$^1$Aston University, UK
$^2$University of Toronto, Canada
$^3$University Health Network, Canada \\
$^4$Florida Institute of Technology, USA
$^5$Stanford University, USA\\
$^6$108 Military Central Hospital, Vietnam
$^7$Hai Duong Central College of Pharmacy, Vietnam\\
$^8$Industrial University of Ho Chi Minh City, Vietnam
$^9$University of Alabama at Birmingham, USA\\
Email: \texttt{m.nguyen8@aston.ac.uk, duckhai.le@mail.utoronto.ca}\\
{GitHub: \href{https://github.com/leduckhai/Wearable_LDF-FS}{https://github.com/leduckhai/Wearable\_LDF-FS}}}

\begin{document}
\maketitle
\begin{abstract}
In this study, we introduce a novel method to predict mental health by building machine learning models for a non-invasive wearable device equipped with Laser Doppler Flowmetry (LDF) and Fluorescence Spectroscopy (FS) sensors. Besides, we present the corresponding dataset to predict mental health, e.g. depression, anxiety, and stress levels via the DAS-21 questionnaire. To our best knowledge, this is the world's largest and the most generalized dataset ever collected for both LDF and FS studies. The device captures cutaneous blood microcirculation parameters, and wavelet analysis of the LDF signal extracts key rhythmic oscillations. The dataset, collected from 132 volunteers aged 18-94 from 19 countries, explores relationships between physiological features, demographics, lifestyle habits, and health conditions. We employed a variety of machine learning methods to classify stress detection, in which LightGBM is identified as the most effective model for stress detection, achieving a ROC AUC of 0.7168 and a PR AUC of 0.8852. In addition, we also incorporated Explainable Artificial Intelligence (XAI) techniques into our analysis to investigate deeper insights into the model's predictions. Our results suggest that females, younger individuals and those with a higher Body Mass Index (BMI) or heart rate have a greater likelihood of experiencing mental health conditions like stress and anxiety. All related code and data are published online: \href{https://github.com/leduckhai/Wearable_LDF-FS}{https://github.com/leduckhai/Wearable\_LDF-FS}. 
\end{abstract}

\def\thefootnote{*}\footnotetext{Equal contribution}\def\thefootnote{\arabic{footnote}}

\section{Introduction}
\label{sec.intro}

\subsection{Motivation}
\label{sec.motivation}

Over the past two decades, global incidences of Common Mental Disorders (CMDs), particularly anxiety and depression, have fluctuated significantly and increased substantially due to improved awareness and diagnosis in healthcare settings \cite{wu2023changing}. However, the increase in CMDs is not uniform across age groups, with higher rates among younger individuals due to changing social pressures and lifestyle factors\cite{krokstad2022divergent}. Economic conditions and public health crises also influence mental health trends, highlighting the need for adaptable and accessible mental health services in the healthcare system. \cite{dykxhoorn2024temporal}. Mental health has gained significant attention, particularly after the COVID-19 pandemic, which exacerbated mental health issues \cite{lange2021coronavirus, kola2021covid}.

In the United Kingdom, over 25\% of individuals experience a mental health disorder annually, with 1 in 6 adults facing anxiety or depression weekly\footnote{https://www.mind.org.uk/news-campaigns/news/mind-urges-the-nation-speak-to-us-during-mental-health-awareness-week/}; 
stress leading to overeating (46\%), increased alcohol consumption (29\%), and elevated smoking rates (16\%)\footnote{https://www.myndup.com/blog/mental-health-statistics-2023}. 
CMDs harm various body systems, including raising blood pressure and heart risks in the cardiovascular system, impairing learning and mood in the nervous system, causing tension and fatigue in muscles, resulting in shallow breathing, and leading to weight changes and diabetes risk in metabolism. Ultimately, stress extensively affects both mental and physical well-being \cite{Mentalhealthstatistics2024}.

Stress can have a detrimental impact on various body systems \cite{chrousos2009stress}. Prolonged stress can elevate blood pressure and heart rate, increasing the risk of cardiovascular diseases \cite{steptoe2012stress}. It also affects the nervous system, leading to cognitive decline, mood disorders, and an increased risk of mental disorders \cite{calabrese2009neuronal}. Muscular tension, soreness, and fatigue can result from stress, impairing daily activities \cite{umer2022quantifying}. Changes in breathing patterns due to stress can lead to respiratory issues \cite{pedersen2010influence}. Additionally, stress disrupts metabolism, potentially causing weight changes and increasing the risk of diabetes \cite{harris2017stress}. In conclusion, stress negatively affects both mental and physical health, impacting systems such as cardiovascular, nervous, muscular, respiratory, and metabolic.

Mental health assessment encompasses various methods to ensure a comprehensive and accurate understanding. Standardized tests like DAS (Depression Anxiety Stress Scales) \cite{lovibond1995depression},  the Beck Depression Inventory (BDI) \cite{beck1987beck}, and the Beck Anxiety Inventory (BAI) \cite{beck1993beck} Clinical interviews, in structured, semi-structured, or unstructured formats, measure levels of depression, anxiety, and stress, helping psychologists gather detailed information through specific questions and conversations. Biological assessments, including tests for neurotransmitter levels like serotonin and dopamine, and electroencephalograms (EEGs) to monitor brain activity, also play a crucial role \cite{miranda2019overview}, and functional magnetic resonance imaging (fMRI) to observe brain activity during psychological tasks \cite{whitten2012functional}. Biosensors for psychiatric biomarkers (e.g., cortisol, dopamine, serotonin) can diagnose and manage disorders via samples from blood, saliva, urine, and sweat. They offer high sensitivity, selectivity, and real-time monitoring, but face challenges like environmental accuracy, high costs, and data integration. Therefore, further development is needed for better effectiveness \cite{wang2024biosensors}.

The DAS-21 questionnaire, a short version of the 42-item DAS, includes 21 items divided into three subscales: Depression, Anxiety, and Stress. It assesses motivation loss, anxiety symptoms, and irritability, respectively. Validated in clinical and community settings, the DAS-21 shows excellent internal consistency with Cronbach's alpha values of 0.94 for depression, 0.87 for anxiety, and 0.91 for stress. The DAS-21 severity levels and cutoff points classify and promptly support patients \cite{monteiro202312}. Intense emotions like anxiety or anger can affect the hands by altering blood flow and muscular electrical activity, causing muscle tension or relaxation \cite{mcgaugh2013emotions}. Despite many articles on blood circulation in such individuals, none compare blood circulation variability in stressed vs. non-stressed people. This study demonstrated the wearable device's ability to differentiate cardiovascular parameters between stress and non-stress groups on both middle fingers.

Wearable devices with Laser Doppler Flowmetry (LDF) and Fluorescence Spectroscopy (FS) channels offer a promising approach for assessing microcirculation and obtaining comprehensive physiological and metabolic information. While these studies demonstrate their potential under normal and pathological conditions, further research with larger cohorts is essential for clinical implementation. One of the crucial tasks is to investigate the effects of various treatment protocols and lifestyle changes on microcirculatory and metabolic parameters using these wearable devices. Another important direction is to develop machine learning algorithms for automated data analysis and interpretation, which can significantly enhance the diagnostic capabilities of wearable devices. Our research focuses on building a diverse dataset for mental health detection using a non-invasive wearable device equipped with LDF and FS channels. By exploring subcutaneous blood microcirculation across demographics, we aim to provide valuable insights and pioneer the development of a large dataset for mental health assessment.

\subsection{Literature Review}
\label{sec.literature_review}

Professor E. Rafailov's research group at Aston University has developed LDF/FS wearable devices using VCSEs, showing comparable signal responses to conventional monitors in volunteer assessments \cite{inproceedings19}. These devices employ LDF and FS for non-invasive early detection of vascular complications in diabetes and other conditions. LDF assesses tissue perfusion, oxygen saturation, and blood volume, while FS detects metabolic activity changes and AGEs accumulation, contributing to microvascular damage and inflammation in diabetes. 

LDF is a non-invasive method for estimating perfusion in the microcirculation \cite{low2020historical}. Introduced over 30 years ago, the technique uses laser radiation to probe tissue and analyze backscatter from moving red blood cells, primarily Hemoglobin (Hb). The main parameter recorded is the microcirculation or perfusion index, essential for organ nutrition, adaptation, and regulation. The method uses wavelet transformation, specifically adaptive wavelet analysis with complex-valued Morlet wavelets, to assess microvessel oscillatory processes over a wide frequency range. This has been the standard for over 15 years, replacing Fast Fourier Transform (FFT) and Butterworth filters \cite{kralj2023wavelet}. Continuous wavelet transformation is preferred for non-stationary LDF-gram (perfusion) due to its optimal ``time-frequency'' resolution, effectively tracking frequency and amplitude fluctuations in blood flow signals \cite{Loktionova:19}. The FS method uses laser probing to record fluorescence spectra of metabolic coenzymes, measuring NADH and FAD fluorescence intensity. This detects changes in metabolic activity in endothelial cells, indicating various physiological and pathological processes, and identifying cellular metabolic disorders related to diseases \cite{zharkikh2020biophotonics}. 



Several studies have utilized wearable devices to assess blood microcirculation across diverse patient groups. Older adults typically exhibit higher perfusion levels in areas like the middle palm and dorsal forearm due to thinner skin, aiding in diagnostic precision \cite{Loktionova:19}. Conversely, younger individuals often show elevated wavelet parameters in blood perfusion oscillations, suggesting broad applicability in various pathologies. In endocrinology, wireless LDF devices have been used to evaluate microcirculatory function in type 2 diabetes patients and healthy individuals across different age brackets, revealing significant variations in perfusion levels \cite{Zherebtsov:19}. Notably, studies monitoring diabetes patients receiving intravenous alpha-lipoic acid therapy have shown improvements in microcirculatory and nutritional blood flow, particularly in limbs affected by diabetic complications \cite{article2022}. Additionally, wearable LDF devices have been instrumental in diagnosing vascular disorders during COVID-19 recovery, highlighting disruptions in microcirculatory function \cite{diagnostics13050920}.

Further related works are described in Appendix Section \ref{sec.full_literature_review}.

\subsection{Contribution}
\label{sec.contribution}

In this study, we make three key contributions to the field of mental health assessment, placing particular emphasis on our data collection methods and the application of Explainable AI (XAI):

\begin{itemize}
    \item \textbf{We present a novel approach for mental health assessment by establishing the largest and the most generalized dataset ever collected for both LDF and FS studies}: We address the need for robust datasets in the field by creating a novel data repository comprised of physiological signals captured using wearable devices. The dataset contains 132 patients, which is specifically chosen for its relevance to mental health and is further enriched by integrating self-reported DAS scores obtained through the validated depression, anxiety, and stress scale-21 (DAS-21) questionnaire. 
    \item \textbf{Exploring numerous machine-learning algorithms for DAS prediction}: We move beyond traditional approaches that solely focus on achieving high prediction accuracy. We delve into the feasibility of utilizing various machine learning algorithms for predicting DAS levels. 
    \item \textbf{Unveiling the \textit{``AI black box''} by using XAI}: Recognizing the critical role of interpretability in mental health applications, we employ XAI techniques to investigate the decision-making behind a machine learning model. By employing XAI, we aim to illuminate the specific features within the wearable device data that exert the strongest influence on the health issues prediction of a person. 
\end{itemize}

All related code and data are published online.
%\footnote{\url{https://anonymous.4open.science/r/LDF_private-1B8E}}

\section{Study Design and Dataset Description}
\label{sec.study_design_and_data}

% \subsection{Clinical Definition and Data Collection}
% \label{sec.clinical_definition}

\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{images/workflow.png}
    \caption{Data collection workflow.}
    \label{fig.datacollection}
\end{figure}

There are four steps in data collection as shown in Fig. \ref{fig.datacollection}. Firstly, participants were recruited from the general population and included volunteers aged 18 and above. To ensure accurate blood perfusion measurements, individuals with any dermatological conditions on both hands and middle fingers were excluded from the study. Before commencing the study, all participants were provided with a detailed explanation of the study design and its objectives. After giving informed consent, participants completed a questionnaire detailing their current health status, including medication history, alcohol consumption within the past 24 hours, and exercise habits such as cycling, treadmill, or jogging.

\begin{figure}[h]
    \centering
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=1\linewidth]{images/datasample_stress.png}
        \caption{A stress instance of data collected using the wearable devices. The subject is a 36-year-old female with moderate stress, anxiety, and depression (right hand).}
        \label{fig.datasamplestress}
    \end{subfigure}
    
    \vspace{0.15cm} % Add vertical space between subfigures
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=1\linewidth]{images/data_sample_wellbeing.png}
        \caption{An instance of well-being data collected using the wearable devices. The subject is a 27-year-old female (right hand).}
        \label{fig.datasample_wellbeing}
    \end{subfigure}
    \caption{Data instances collected using the wearable devices: (a) stress instance, (b) well-being instance.}
    \label{fig.combined_datasample_wellbeing}
\end{figure}


Sequentially, blood perfusion parameters were measured non-invasively with participants in a supine position to ensure physical and mental rest. To minimize external stimuli, participants were instructed to abstain from reading, writing, or talking during the test.  Blood perfusion data were collected from sensors placed on the middle fingertips of both left and right hands for a duration of eight minutes. To control potential confounding factors, participants were asked to refrain from consuming caffeine and alcohol-containing drinks at least twelve hours before the designated measurement time. 

Figure \ref{fig.datasamplestress} shows the data measured from a stressed individual, with data from the left hand illustrated on the top and data from the right hand on the bottom. Similarly, Figure \ref{fig.datasample_wellbeing} presents an instance of well-being data collected using wearable devices. As observed, the data from the stressed individual exhibits significant fluctuations, while the data from the well-being individual is more stable. In addition, the definitions of the measurement device parameters are described following Table \ref{table.wearabeldeviceparameters}.


\begin{table}[h]
\centering
\caption{Definitions of the measurement device parameters.}
\renewcommand{\arraystretch}{1.15} % Adjust this value to increase/decrease cell height
% \begin{adjustbox}{width=0.95\textwidth}
\begin{tabular}{lm{6.5cm}}
\toprule
\multicolumn{1}{c}{\textbf{Parameters}} & \multicolumn{1}{c}{\textbf{Definition}}\\ 
\midrule
M & Microcirculation index, indicating the average perfusion of microvessels (in PU). \\ 
$\sigma$ & Mean square deviation of blood flow oscillation amplitude (in PU). \\ 
Kv & Coefficient of blood flow variability. \\
A365 & Backscatter amplitude at the laser source wavelength for NADH excitation. \\ 
A460 & NADH fluorescence amplitude at 460 nm. \\
NADH & Relative amplitude of NADH fluorescence, considering the optical characteristics of the study tissue region. \\ 
POM & Index of oxidative metabolism linked to the nutritional component of blood perfusion and NADH coenzyme fluorescence amplitude. \\ 
Ae & Average maximum amplitude of blood flow within the endothelial oscillation range. \\ 
An & Average maximum amplitude of blood flow within the neurogenic oscillation range. \\ 
Am & Average maximum amplitude of blood flow within the myogenic oscillation range. \\ 
Ar & Average maximum amplitude of blood flow within the respiratory oscillation range. \\ 
Ac & Average maximum amplitude of blood flow within the cardiac oscillation range. \\ 
Fe & Endothelial oscillation frequency (0.0095 - 0.02 Hz). \\ 
Fn & Neurogenic oscillation frequency (0.02 - 0.06 Hz). \\ 
Fm & Myogenic oscillation frequency (0.06 - 0.16 Hz). \\ 
Fr & Respiratory oscillation frequency (0.16 - 0.4 Hz). \\ 
Fc & Cardiac oscillation frequency (0.4 - 1.6 Hz). \\ 
T & Temperature at the measurement site. \\ 
\bottomrule
\end{tabular}
% \end{adjustbox}
\label{table.wearabeldeviceparameters}
\end{table}

Following the 15-minute blood circulation measurement, we measured height and weight. Next, the participants completed the DAS-21 questionnaire, which assesses how much each statement applied to them over the past week. After completing the questionnaire, their blood pressure was measured. The measurements were taken twice a day: in the morning (around 11.00, before lunch) and in the afternoon (around 15.00, after lunch) for any five days over two consecutive weeks.

The DAS-21 is used to assess key symptoms of depression, anxiety, and stress, as well as patient reactions to treatment. It has been proven to have adequate psychometric properties and is equivalent to other accurate scales. The 21 items comprise three self-reported scales, each with seven elements graded on a Likert scale from 0 to 3. Depression, anxiety, and stress scores are measured by summing the scores of the related items. Since the DAS-21 is a shorter version of the original 42-item DAS, the score for each subscale must be multiplied by 2 to calculate the final score. Recommended cut-off scores for conventional severity labels (normal, moderate, severe) are calculated following Table \ref{tab:DAS21results}. Scores on the DAS-21 will need to be multiplied by 2 to calculate the final score.

\begin{table}[h]
    \centering
    % \renewcommand{\arraystretch}{1.35}
    \caption{Scores on the DAS-21 will need to be multiplied by two to calculate the final score.}
    \begin{tabular}{lccc}
        \toprule
        \multicolumn{1}{c}{\textbf{Level}} & \centering \textbf{Depression} & \textbf{Anxiety} & \textbf{stress} \\ \midrule
        Normal & 0-9 & 0-7 & 0-14\\
        Mild & 10-13 & 8-9 & 15-18\\ 
        Moderate & 14-20 & 10-14 & 19-25 \\ 
        Severe & 21-27 & 15-19 & 26-33 \\ 
        Extremely Severe & 28+ & 20+ & 34+ \\ \bottomrule
    \end{tabular}
    \label{tab:DAS21results}
\end{table}

According to the manual, the ratings are classified as: “normal, mild, moderate, severe, or extremely severe”; all those who exhibit any signs of stress, anxiety, or depression, we referred to as the well-being group, and the remaining individuals will be classified as the wellbeing group. This allowed for real-time control of the course of the experiment and analysis of the recorded parameters. 

The displayed parameters show the raw data of blood perfusion, temperature, and the movement of the fingertip and wrist. After acquiring the data, the oscillation rhythms of each measurement were analyzed using the built-in module “wavelet analysis”. This wavelet analysis determines the maximum amplitude of blood perfusion and corresponding data for each of the five oscillations: Five rhythmic oscillations are isolated from LDF recordings with the help of wavelet analysis; endothelial (frequency interval 0.0095–0.02 Hz), neurogenic (0.02–0.06 Hz), myogenic (0.06–0.16 Hz), respiratory (0.16–0.4 Hz), and cardiac or pulse rhythm (0.4–1.6 Hz).


\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{images/stress_level.png}
    \caption{Distribution of stress levels, anxiety level, and depression level.}
    \label{fig.datadistribution}
\end{figure}

As illustrated in Fig. \ref{fig.datadistribution}, the total number of people with mental health issues reaches 27.3\% of the population, with over 50\% of them experiencing combined stress, anxiety, and depression. The incidence rates of stress, anxiety, and depression are 24.5\%, 22\%, and 18.2\% respectively, mostly at mild levels, accounting for 17.2\%, 13.6\%, and 12.8\% in these groups. The extremely severe level is highest in the anxiety group at 3.0\%, while in the other two groups, it is below 1\%.

Further details of data collection and data analysis are described in Appendix Section \ref{sec.appendix_study_design_and_data}. 

%The DAS-21 questionnaire provides a standardized psychological assessment of each participant's mental well-being. This 21-question survey specifically focuses on measuring levels of depression, anxiety, and stress. Participants' responses are carefully recorded and scored based on established guidelines, generating quantifiable metrics for each dimension (depression, anxiety, stress). These scores offer valuable insights into potential mental health concerns.  Additionally, timestamps associated with each DAS-21 completion allow us to track changes in a participant's mental state over time.

%By combining personal information, DAS-21 scores, and wearable sensor data, we create a rich dataset that facilitates the development of accurate machine-learning models for predicting DAS levels.


\section{Machine Learning and Explainable Artificial Intelligence}
\label{sec.machinelearningandXAI}
Further details of experimental setup are described in Appendix Section \ref{sec.details_experimental_setup}.

\subsection{Machine Learning Models for DAS Prediction}
\label{sec.MLmodel}

To identify the most effective approach for predicting depression, anxiety, and stress levels, we explored various machine learning algorithms including Support Vector Machine (SVM), Random Forest Classification, Gradient Boosting Classifier, CatBoost, LightGBM, as well as Multi-layer Perceptron (MLP) \cite{mahesh2020machine}. In addition, we employ two primary approaches to train machine learning models for predicting DAS levels: binary classification and multi-class classification. Both approaches leverage data from the DAS-21 questionnaire alongside potentially other features from the collected dataset. In addition, we consider three cases to investigate the models' performances: Using all collected features, using only features extracted from wearable devices, and using top-10 important features. 

For binary classification, this approach simplifies the prediction task by transforming the DAS levels into a binary classification problem. We categorize participants into two classes based on their DAS-21 scores:
\begin{itemize}
    \item Normal: This class comprises participants who score within the normal range for depression, anxiety, and stress according to established DAS-21 scoring guidelines.
    \item Abnormal: This class encompasses participants whose DAS-21 scores indicate potential symptoms of depression, anxiety, or stress.
\end{itemize}

For multi-class classification, this approach aims for a more granular prediction by treating DAS levels as a multi-class classification problem. Instead of collapsing mental health states into two categories, we define multiple classes based on the established DAS-21 scoring ranges: Normal, stress, stress anxiety, and stress anxiety depression.

In machine learning, dividing the dataset into training and testing subsets is crucial for evaluating model performance. In our ablation study, we use three train-evaluate techniques: Split 80:20, patient-wise 5-folds (not sample-wise), and Leave-one-patient-out (LOPO) \cite{hastie2009elements}. By doing this, we ensure that the model is evaluated on its ability to perform on new patients not seen during training.

To assess the performance of the machine learning models for predicting Depression, Anxiety, and stress (DAS) levels, we employ two key evaluation metrics: Receiver Operating Characteristic (ROC) AUC (Area Under the Curve) and Precision-Recall (PR) AUC. These metrics provide a comprehensive assessment of the model's discriminative ability and its performance in handling class imbalances.

\subsection{Explainable AI}

In healthcare applications, understanding the reasoning behind a model's predictions for DAS levels is crucial for building trust and confidence in its outputs. This empowers healthcare professionals and researchers to make informed decisions based on the predicted DAS levels and the underlying factors influencing those predictions. In this study, we leverage SHAP (Shapley Additive Explanations) to achieve interpretability and gain insights into the model's decision-making process for DAS prediction \cite{lundberg2017unified}. SHAP assigns an attribution value (SHAP value) to each feature for a given DAS prediction. High positive SHAP values indicate that the feature has a strong positive influence on the predicted DAS level (potentially indicating a higher likelihood of depression, anxiety, or stress). Conversely, low negative SHAP values signify a negative influence (indicating a lower likelihood). This interpretability allows us to answer several key questions:

\begin{itemize}
    \item Identification of the key physiological and psychological indicators: What are the features from wearable sensor data and questionnaire scores of a patient that have the most significant influence on the model's predictions? 
    \item Validation of model fairness and mitigation of mias: Are the model's predictions fair across different demographics (age, gender, etc.)? Examining SHAP values across these groups helps ensure that the model is not unfairly biased toward certain populations.
    \item Enhanced model transparency: How does the model arrive at its predictions? By explaining the rationale behind the model's predictions through SHAP values, we can foster trust and confidence in its use among healthcare professionals and researchers. 
\end{itemize}

\section{Experimental Results}
\label{sec.result}


\subsection{All Features with 80:20 Split}
\label{sec.result.8020}
In this section, we present the results of our investigation into using machine learning models to predict stress levels based on data from the DAS-21 questionnaire and potentially other features within our dataset. We employed both binary and multi-class classification approaches, evaluating the models on a random 80/20 train-test split to ensure generalizability.

\subsubsection{Binary Classification}
Our initial focus was on a binary classification task, aiming to identify individuals with potential mental health concerns based on their DAS-21 scores. For binary classification, the performance of the models on binary classification tasks is summarized in Table \ref{tab:ml_metrics_All_features_binary_classification}. 

From the table, LightGBM emerged as the best-performing model, achieving the highest ROC AUC of 0.9941 and PR AUC of 0.9982. Gradient Boosting and MLP also demonstrated strong performance, with ROC AUC values of 0.9751 and 0.9322, respectively. In contrast, Catboost and Random Forest showed relatively lower performance, indicating that they might not be as effective for this particular binary classification task.
\begin{table}[ht]
    \centering
    \caption{Performance for different models: All features with 80:20 split, binary classification}
    \begin{adjustbox}{max width=1\textwidth}
    \setlength{\tabcolsep}{2pt} % Adjust the column spacing here
    \begin{tabular}{lcccccc}
        \toprule
        Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
        \midrule
        \textbf{ROC AUC} & 0.9751 & 0.7320 & 0.9941 & 0.9199 & 0.8145 & 0.9322 \\
        \textbf{PR AUC} & 0.9911 & 0.9104 & 0.9982 & 0.9720 & 0.9330 & 0.9767 \\
        \bottomrule
    \end{tabular}
    \end{adjustbox}
    \label{tab:ml_metrics_All_features_binary_classification}
\end{table}



\subsubsection{Multi-class Classification}
In addition to predicting whether a person has a mental issue or not, we also explored a multi-class classification task, aiming to predict not only the presence of stress but also its severity level. In particular, Table \ref{tab:ml_metrics_All_features_multi_classification} details the performance metrics of the models on multi-class classification tasks, with the notable absence of MLP results. 

% \textbf{Multi-class classification}

\begin{table}[ht]
    \centering
    \caption{Performance for different models: All features with 80:20 split, multi-class classification}
    \begin{adjustbox}{max width=1\textwidth}
    \setlength{\tabcolsep}{2pt} % Adjust the column spacing here
        \begin{tabular}{lcccccc}
            \toprule
            \centering Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest \\
            \midrule
            \textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-Rest\end{tabular}} & 0.8043 & 0.6932 & 0.9962 & 0.973 & 0.8695  \\
            \textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-One\end{tabular}}  & 0.8302 & 0.6875 & 0.993  & 0.9574 & 0.7952  \\
            \textbf{Macro Precision}           & 0.6238 & 0.1723 & 0.9875 & 0.4417 & 0.2966  \\
            \textbf{Recall}                    & 0.5319 & 0.2108 & 0.9085 & 0.3799 & 0.1845\\
            \textbf{F1-score}                  & 0.5152 & 0.1808 & 0.9391 & 0.375  & 0.1783  \\
            \bottomrule
        \end{tabular}
    \end{adjustbox}
    \label{tab:ml_metrics_All_features_multi_classification}
\end{table}

LightGBM again stands out, achieving near-perfect Macro ROC AUC scores and high precision, recall, and F1 scores. Gradient Boosting and SVM also performed well, with Gradient Boosting showing a balanced performance across all metrics. Catboost and Random Forest had lower scores, suggesting limitations in handling the complexities of multi-class classification in this context.


\begin{table}[ht]
    \centering
    \caption{Top 10 important features using Gradient Boosting, Catboost, and LightGBM when conducting binary prediction with an 80:20 split. The meaning of each feature is explained in Table \ref{table.wearabeldeviceparameters}.}
    \begin{adjustbox}{max width=1\textwidth}
    \setlength{\tabcolsep}{2pt} % Adjust the column spacing here
        \begin{tabular}{c>{\raggedright\arraybackslash}p{1.5cm}c>{\raggedright\arraybackslash}p{1.5cm}c>{\raggedright\arraybackslash}p{1.5cm}cc}
            \toprule
            \multirow{2}{*}{\textbf{Order}} & \multicolumn{2}{c}{\textbf{Gradient Boosting}} & \multicolumn{2}{c}{\textbf{Catboost}} & \multicolumn{2}{c}{\textbf{LightGBM}} \\
            \cmidrule(lr){2-3} \cmidrule(lr){4-5} \cmidrule(lr){6-7}
            & \centering Feature & Importance & \centering Feature & Importance & \centering Feature & Importance \\
            \midrule
            1 & BMI\_index & 0.279819 & Age & 55.244066 & BMI\_index & 22 \\
            2 & Heart Rate & 0.163589 & Type of skins & 29.933423 & Heart Rate & 13 \\
            3 & Age & 0.160837 & Weight & 11.040225 & Age & 13 \\
            4 & Type of skins & 0.156214 & $\delta$ & 3.782286 & Weight & 9 \\
            5 & Weight & 0.097077 & Type of data & 0.000000 & Height & 8 \\
            6 & T & 0.050864 & F\_Ae & 0.000000 & M & 6 \\
            7 & Height & 0.044463 & Level of BP & 0.000000 & T & 6 \\
            8 & A460 & 0.011797 & Smoking routine & 0.000000 & A460 & 5 \\
            9 & Anadn & 0.009720 & BMI\_index & 0.000000 & Kv100 & 2 \\
            10 & M & 0.009113 & Height & 0.000000 & Type of skins & 2 \\
            \bottomrule
        \end{tabular}
    \end{adjustbox}
    \label{tab:merged_featuresbinary_prediction}
\end{table}

\subsubsection{Feature Importance}
To understand the factors influencing the models' predictions, we analyzed the importance of various features. Feature importance was assessed using Gradient Boosting, Catboost, and LightGBM models, as summarized in Table \ref{tab:merged_featuresbinary_prediction} and \ref{tab:multiclass_features}. The tables highlight the top 10 important features identified by each model. In both tables, features such as heart rate, BMI, weight, T (temperature), and type of skin consistently rank high in the top ten importance for most models. This suggests that physiological factors significantly influence the models' stress predictions. Other features including age, POM, A365, and Anadn also appear to be relevant to some degree, depending on the model.


\begin{table}[ht]
\centering
\caption{Top 10 important features using Gradient Boosting, Catboost, and LightGBM for multi-class classification with an 80:20 split. The meaning of each feature is explained in Table \ref{table.wearabeldeviceparameters}. }
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
    \begin{tabular}{c>{\raggedright\arraybackslash}p{1.5cm}c>{\raggedright\arraybackslash}p{1.5cm}c>{\raggedright\arraybackslash}p{1.5cm}cc}
        \toprule
        \multirow{2}{*}{\textbf{Order}} & \multicolumn{2}{c}{\textbf{Gradient Boosting}} & \multicolumn{2}{c}{\textbf{Catboost}} & \multicolumn{2}{c}{\textbf{LightGBM}} \\
        \cmidrule(lr){2-3} \cmidrule(lr){4-5} \cmidrule(lr){6-7}
        & \centering Feature & Importance & \centering Feature & Importance & \centering Feature & Importance \\
        \midrule
        1 & Heart Rate & 0.682942 & Heart Rate & 87.150766 & Weight & 18 \\
        2 & A365 & 0.179464 & Type of skins & 8.122651 & Height & 9 \\
        3 & BMI\_index & 0.089107 & Anadn & 3.149739 & BMI\_index & 8 \\
        4 & Type of skins & 0.043119 & $\delta$ & 1.576843 & Heart Rate & 7 \\
        5 & Height & 0.004020 & F\_An & 0.000000 & Type of skins & 7 \\
        6 & Age & 0.001002 & Level of BP & 0.000000 & A365 & 7 \\
        7 & POM & 0.000173 & Smoking routine & 0.000000 & Age & 5 \\
        8 & T & 0.000173 & BMI\_index & 0.000000 & POM & 5 \\
        9 & F\_An & 0.000000 & Height & 0.000000 & T & 5 \\
        10 & Level of BP & 0.000000 & Weight & 0.000000 & F\_Ar & 2 \\
        \bottomrule
    \end{tabular}
\end{adjustbox}

\label{tab:multiclass_features}
\end{table}




\subsection{All Features with Cross-Validation}
\label{sec.result.allfeatures_crossval}
In the field of health issue analysis, ensuring the robustness and reliability of predictive models is paramount. To achieve this, we employ cross-validation techniques such as k-fold cross-validation and LOPO cross-validation. %These methodologies are critical for evaluating the performance and generalizability of our models.

\subsubsection{Binary Classification with LOPO}

LOPO cross-validation is particularly relevant in medical studies, where patient-specific variations can significantly impact the model's predictions. Table \ref{tab:BC_LOPO} presents the performance metrics for various machine learning models when evaluated using the LOPO cross-validation method for binary classification. LOPO is a stringent evaluation method where the model is trained on all patients except one, who is then used as the test set. This process is repeated for each patient, ensuring that the model's performance is tested on unseen data in each iteration.

\begin{table}[ht]
\centering
\caption{Performance for different models: All features with LOPO, binary classification.}
    \begin{adjustbox}{max width=1\textwidth}
    \setlength{\tabcolsep}{2pt} % Adjust the column spacing here
    \begin{tabular}{lcccccc}
    \toprule
    Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
    \midrule
    \textbf{ROC AUC} & 0.6556 & 0.6001 & 0.6773 & 0.5316 & 0.6209 & 0.5313 \\
    \textbf{PR AUC} & 0.8806 & 0.8287 & 0.8998 & 0.8214 & 0.8630 & 0.8425 \\
    \bottomrule
    \end{tabular}
    \end{adjustbox}
    \label{tab:BC_LOPO}
\end{table}

From the results, LightGBM shows the highest ROC AUC (0.6773) and PR AUC (0.8998), indicating better performance in distinguishing between the two classes compared to other models. Gradient Boosting and Random Forest also perform reasonably well, with ROC AUC values of 0.6556 and 0.6209, respectively. SVM and MLP perform the worst in terms of ROC AUC, indicating they might struggle more with the variability in the patient data.


\subsubsection{Binary Classification with 5-folds}

As mentioned above, we also use 5-fold cross-validation to investigate the performance of the models. In 5-fold cross-validation, the dataset is divided into 5 subsets, and the model is trained and tested k times, each time using a different subset as the validation set and the remaining subsets for training, providing a thorough assessment of the model’s performance. This method helps to mitigate overfitting and ensures that the model is not overly dependent on any particular subset of the data. 

Table \ref{tab:BC_K_fold} provides the performance metrics for the same machine learning models but evaluated using 5-fold cross-validation. In this method, the dataset is split into five equal parts, and the model is trained on four parts and tested on the remaining one. This process is repeated five times, with each part used exactly once as the test set.

\begin{table}[ht]
\centering
\caption{Performance for different models: All features with 5-fold, binary classification.}
    \begin{adjustbox}{max width=1\textwidth}
    \setlength{\tabcolsep}{2pt} % Adjust the column spacing here
    \begin{tabular}{lcccccc}
    \toprule
    Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
    \midrule
    \textbf{ROC AUC} & 0.6292 & 0.5462 & 0.6892 & 0.5571 & 0.6257 & 0.5182 \\
    \textbf{PR AUC} & 0.8529 & 0.8255 & 0.8833 & 0.8184 & 0.8597 & 0.8318 \\
    \bottomrule
    \end{tabular}
    \end{adjustbox}
    \label{tab:BC_K_fold}
\end{table}

In this evaluation, LightGBM again outperforms other models with a ROC AUC of 0.6892 and a PR AUC of 0.8833. Gradient Boosting and Random Forest show comparable ROC AUC values of 0.6292 and 0.6257, respectively. Catboost and SVM exhibit lower performance, while MLP remains the lowest-performing model based on ROC AUC.


\subsubsection{Multi-class Classification with LOPO}
In addition to the binary classification, we also investigate the performance of models' prediction using multi-level severity following DAS21. Table \ref{tab:Multi_LOPO} details the performance of the models on multi-class classification tasks using the LOPO cross-validation. The approach is even more challenging in a multi-class setting as the model must correctly classify multiple classes for each patient left out during testing.

\begin{table}[ht]
\centering
\caption{Performance for different models: All features with LOPO, multi-class classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
\centering Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest  \\
\midrule
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-Rest\end{tabular}} & 0.4466 & 0.3279 & 0.5678 & 0.4208 & 0.3092  \\
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-One\end{tabular}} & 0.4197 & 0.336 & 0.4781 & 0.4237 & 0.2767  \\
\textbf{Macro Precision} & 0.1719 & 0.1346 & 0.1336 & 0.1311 & 0.1317  \\
\textbf{Recall} & 0.1776 & 0.1384 & 0.1493 & 0.1631 & 0.1667  \\
\textbf{F1-score} & 0.1698 & 0.1307 & 0.1408 & 0.1454 & 0.1472\\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:Multi_LOPO}
\end{table}

LightGBM exhibits the best performance for multi-class classification with LOPO, achieving a Macro ROC AUC of 0.5678 in the One-vs-Rest approach and 0.4781 in the One-vs-One approach. However, all models show relatively low performance across all metrics, reflecting the difficulty of the multi-class classification task under LOPO validation.

\subsubsection{Multi-class Classification with 5-folds}

Similar to the LOPO for multi-class classification, we also employ 5-fold for health issue investigation. Table \ref{tab:Multi-Kfold} shows the performance metrics for multi-class classification using 5-fold cross-validation. This method helps mitigate the variance seen in LOPO by averaging the performance over multiple splits.

\begin{table}[ht]
\centering
\caption{Performance for different models: All features with 5-fold, multi-class classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
\centering Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest  \\
\midrule
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-Rest\end{tabular}} & 0.4804 & 0.4103 & 0.5812 & 0.4412 & 0.4663  \\
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-One\end{tabular}} & 0.4492 & 0.4132 & 0.5057 & 0.4539 & 0.4207  \\
\textbf{Macro Precision} & 0.1783 & 0.1434 & 0.1554 & 0.1357 & 0.1223  \\
\textbf{Recall} & 0.1746 & 0.1539 & 0.1652 & 0.1628 & 0.1667 \\
\textbf{F1-score} & 0.1736 & 0.1474 & 0.1578 & 0.1465 & 0.1411  \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:Multi-Kfold}
\end{table}

Table \ref{tab:Multi-Kfold} shows that LightGBM continues to show the highest performance with a Macro ROC AUC of 0.5812 (One-vs-Rest) and 0.5057 (One-vs-One). Gradient Boosting and SVM also perform relatively well, but all models have lower performance metrics compared to the binary classification tasks, illustrating the increased complexity of multi-class classification.

\subsection{Multimodal Sensor Features}
\label{sec.result.sensorfeatures}
% One of the important purposes of this research is to investigate the DAS21 stress level using the LDF/FS wearable devices. Therefore, we separated features extracted from the wearable devices to conduct stress prediction experiments.

\subsubsection{Binary Classification with LOPO}


The performance metrics for different machine learning models using the LOPO approach are summarized in Table \ref{tab:sensor_features_binary_LOPO}. The LightGBM model achieved the highest ROC AUC score of 0.698, suggesting it performed relatively better compared to using all features as illustrated in Table \ref{tab:BC_LOPO}. Gradient Boosting followed with an ROC AUC of 0.6265, indicating moderate discriminative ability. In terms of PR AUC, which measures the trade-off between precision and recall, LightGBM again stands out with a score of 0.9091, demonstrating its robustness in handling imbalanced classes. Other models including Catboost, SVM, and Random Forest showed lower ROC AUC and PR AUC scores.


\begin{table}[ht]
\centering
\caption{Performance for different models: Multimodal sensor features with LOPO, binary classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
\midrule
\textbf{ROC AUC} & 0.6265 & 0.4753 & 0.698 & 0.5124 & 0.556 & 0.5034 \\
\textbf{PR AUC} & 0.8379 & 0.7556 & 0.9091 & 0.8113 & 0.8209 & 0.7855 \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:sensor_features_binary_LOPO}
\end{table}



\subsubsection{Binary Classification with 5-folds}
The performance metrics for the 5-fold cross-validation approach are detailed in Table \ref{tab:sensor_features_binary_kfold}. Here, LightGBM also performed well, achieving an ROC AUC of 0.6601 and a PR AUC of 0.8839, highlighting its consistent performance across different validation techniques. Gradient Boosting followed with an ROC AUC of 0.6137 and a PR AUC of 0.8424, reinforcing its reliability as a robust model for this classification task. The Catboost model showed improved performance in the 5-fold scenario (ROC AUC of 0.5145) compared to LOPO, indicating that it might be better suited for general datasets rather than patient-specific variations. SVM and Random Forest had similar ROC AUC scores, around 0.5389 and 0.5607 respectively, but they showed adequate precision-recall trade-offs with PR AUC scores above 0.82.


\begin{table}[ht]
\centering
\caption{Performance for different models: Multimodal sensor features with 5-fold, binary classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
\midrule
\textbf{ROC AUC} & 0.6137 & 0.5145 & 0.6601 & 0.5389 & 0.5607 & 0.5216 \\
\textbf{PR AUC} & 0.8424 & 0.7914 & 0.8839 & 0.8207 & 0.8261 & 0.7983 \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:sensor_features_binary_kfold}
\end{table}




\subsection{Top-10 Important Features}
\label{sec.result_top10}
Although, we have features extracted from wearable devices and personal information, utilizing the top 10 important features for classification is a strategic approach aimed at enhancing model efficiency and interpretability. Utilizing the top 10 important features allows us to significantly reduce the time and energy required for data collection and processing, thereby saving valuable resources and expediting the overall analysis workflow. 

\subsubsection{Binary Classification with LOPO}
As shown in Table \ref{tab:top10_binary_LOPO}, the models assessed include Gradient Boosting, Catboost, LightGBM, SVM, Random Forest, and MLP. The results indicate that LightGBM achieved the highest ROC AUC score of 0.7041, followed by Gradient Boosting with a score of 0.6699. Catboost, SVM, Random Forest, and MLP showed moderate performance with ROC AUC scores of 0.5788, 0.578, 0.6232, and 0.5454, respectively. In addition, in terms of Precision-Recall AUC, LightGBM also led with a score of 0.9087, highlighting its superior ability to handle class imbalances and correctly identify positive instances in this binary classification task.

\begin{table}[ht]
\centering
\caption{Performance for different models: Top 10 features with LOPO, binary classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest & MLP \\
\midrule
\textbf{ROC AUC} & 0.6699 & 0.5788 & 0.7041 & 0.578 & 0.6232 & 0.5454 \\
\textbf{PR AUC} & 0.8689 & 0.8213 & 0.9087 & 0.8591 & 0.8714 & 0.8413 \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:top10_binary_LOPO}
\end{table}


\subsubsection{Binary Classification with 5-folds}
LightGBM consistently performed well, achieving an ROC AUC of 0.7168 and a PR AUC of 0.8852, underscoring its robustness and effectiveness across different cross-validation techniques. Gradient Boosting and Catboost also performed competitively with ROC AUC scores of 0.6594 and 0.6173, respectively, and PR AUC scores of 0.8723 and 0.8512. 

\begin{table}[ht]
\centering
\caption{Performance for different models: Top 10 features with 5-fold, binary classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest \\
\midrule
\textbf{ROC AUC} & 0.6594 & 0.6173 & 0.7168 & 0.5692 & 0.6402 \\
\textbf{PR AUC} & 0.8723 & 0.8512 & 0.8852 & 0.841 & 0.8754 \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:top10_binary_Kfolds}
\end{table}


\subsubsection{Multi-class Classification with LOPO}
We also conducted multi-class classification training using the LOPO method. As shown in Table \ref{tab:top10_multi_LOPO}, the performance metrics indicate a notable variation among the machine learning models. LightGBM emerged as the top performer with a Macro ROC AUC score of 0.633 (One-vs-Rest) and 0.5244 (One-vs-One), demonstrating its capability to handle multiple classes effectively. Gradient Boosting and Catboost showed moderate performance with Macro ROC AUC scores around 0.4946 and 0.4463, respectively. However, the overall macro precision, recall, and F1-score for all models were relatively low, highlighting the complexity and challenge of multi-class classification tasks using LOPO.


\begin{table}[ht]
\centering
\caption{Performance for different models: Top 10 features with LOPO, multi-class classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
\centering Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest \\
\midrule
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-Rest\end{tabular}} & 0.4946 & 0.4463 & 0.633 & 0.4466 & 0.3352  \\
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-One\end{tabular}} & 0.4933 & 0.4084 & 0.5244 & 0.4344 & 0.3007 \\
\textbf{Macro Precision} & 0.1935 & 0.1558 & 0.1636 & 0.1335 & 0.1317 \\
\textbf{Recall} & 0.2182 & 0.1737 & 0.1742 & 0.1552 & 0.1667  \\
\textbf{F1-score} & 0.1947 & 0.159 & 0.1679 & 0.1429 & 0.1472  \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:top10_multi_LOPO}
\end{table}

\subsubsection{Multi-class Classification with 5-folds}
Finally, we conducted multi-class classification using the same models with 5-fold cross-validation. Table \ref{tab:top10_multi_kfold} shows that LightGBM again led with a Macro ROC AUC score of 0.6412 (One-vs-Rest) and 0.5585 (One-vs-One), reinforcing its consistent performance across different evaluation methods. Gradient Boosting and Catboost also showed improved performance with Macro ROC AUC scores of 0.5418 and 0.5315, respectively. 

\begin{table}[ht]
\centering
\caption{Performance for different models: Top 10 features with 5-fold, multi-class classification.}
\begin{adjustbox}{max width=1\textwidth}
\setlength{\tabcolsep}{2pt} % Adjust the column spacing here
\begin{tabular}{lcccccc}
\toprule
Model & Gradient Boosting & Catboost & LightGBM & SVM & Random Forest \\
\midrule
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-Rest\end{tabular}} & 0.5418 & 0.5315 & 0.6412 & 0.5022 & 0.3857 \\
\textbf{\begin{tabular}{@{}c@{}}Macro ROC AUC\\ One-vs-One\end{tabular}} & 0.5507 & 0.4474 & 0.5585 & 0.4755 & 0.3615 \\
\textbf{Macro Precision} & 0.2314 & 0.1401 & 0.1778 & 0.1525 & 0.2896 \\
\textbf{Recall} & 0.2347 & 0.1476 & 0.2031 & 0.1705 & 0.1711 \\
\textbf{F1-score} & 0.2224 & 0.1416 & 0.1885 & 0.1596 & 0.1502 \\
\bottomrule
\end{tabular}
\end{adjustbox}
\label{tab:top10_multi_kfold}
\end{table}


% From our investigation, comparing the results of using the top 10 important features to using all features reveals notable differences in model performance. 
When employing the top 10 features, the binary classification performance under the LOPO scheme shows a slightly better performance in ROC AUC and PR AUC metrics across most models compared to using all features. For example, Gradient Boosting's ROC AUC increased from 0.6556 to 0.6699, while LightGBM's PR AUC slightly increased from 0.8998 to 0.9087. Similarly, in multi-class classification, the LOPO results show that models trained with the top 10 features generally have higher Macro ROC AUC and precision scores compared to those trained with all features. By focusing on the top ten important features, we can not only enhance model performance but also significantly reduce the time and energy required for data collection and processing, making the analysis more efficient and cost-effective.


\subsection{Health Issue Explanation}
\label{sec.resultXAI}


\begin{figure*}[h]
    \centering
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{images/shap_value.png}
        \caption{SHAP values.}
        \label{fig.shapvalue}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{images/shap_normal.png}
        \caption{Explanation of normal group.}
        \label{fig.normal}
    \end{subfigure}
    \begin{subfigure}{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{images/shap_disease.png}
        \caption{Explanation of stress group.}
        \label{fig.abnormal}
    \end{subfigure}
    \caption{Explanation of the reasoning behind individual class predictions using SHAP values.}
    \label{fig.xAI_combined}
\end{figure*}

While in the previous sections, we focused on the performance of various machine learning models for health issue prediction, it's crucial to understand the underlying factors influencing these predictions. This is where Explainable Artificial Intelligence (XAI) techniques come into play. XAI methods enable us to gain insights into the decision-making processes of machine learning models, offering valuable explanations for their predictions. As discussed in Section \ref{sec.result.8020} to Section \ref{sec.result_top10}, LightGBM outperforms other machine learning models. Therefore, we employed XAI techniques to interpret the top-performing LightGBM model for stress detection. 



A plot of the SHAP values is illustrated in Fig. \ref{fig.shapvalue}, in which the features are listed on the left-hand side of the plot, with the most important features at the top. Higher SHAP values indicate a greater impact on the model output. In addition, the blue color represents the normal class and the red color is the stress class. As we can see, BMI index is the most important feature, followed by age, gender, and heart rate. As we can see, the contribution of each feature in each class is mostly equal.

To understand the distribution of each feature in each class, we plot the SHAP values of each class in Fig. \ref{fig.normal} and Fig. \ref{fig.abnormal}. Similar to Fig. \ref{fig.shapvalue}, the images show scatter plots of the effects of factors on model output for each class. The x-axis represents the feature value, and the y-axis represents the SHAP value. As observed a low BMI index is associated with a lower likelihood of being classified as stressed by the model. Similar to the BMI index, Fig. \ref{fig.abnormal} shows high age and low heart rate are indicative of a lower likelihood of being stressed according to the model. In addition, females seem to be more stressed than males.

\section{Conclusion}
\label{sec.conclusion}
In this study, we introduce a novel approach to predict mental health by training predictive machine learning models for a non-invasive wearable device equipped with LDF/FS sensors. Also, we establish a large, novel wearable device dataset containing physiological signals and corresponding DAS-21 scores. To our best knowledge, this is the largest and the most generalized dataset ever collected for both LDF and FS studies.
Additionally, we also evaluated various machine learning models for predicting DAS levels, prioritizing interpretable models to enhance understanding of the relationship between wearable data and mental health. Finally, we employed explainable AI techniques to ensure transparency by identifying features that most influence predictions, providing insights that can help clinicians tailor treatment plans and improve patient outcomes.

Our findings show that: (1) The LightGBM model consistently outperforms others in both binary and multi-class stress level predictions, balancing accuracy and interpretability, making it suitable for practical applications. Using the top 10 important features, LightGBM achieved an ROC AUC of 0.7168 and a PR AUC of 0.8852. (2) Key physiological features like heart rate, BMI, and weight significantly influence stress predictions. (3) Younger individuals and those with a higher BMI or heart rate have a higher chance of experiencing stress. (4) Females are more likely to be stressed than males.

\section{Acknowledgement}
We would like to extend our sincere appreciation to the Human ethics committee at Aston University, Birmingham, UK and Hai Duong central college of pharmacy, Vietnam, for their support and cooperation, including the waiver of informed consent. Their dedication to ethical standards greatly contributed to the success of this study.

Authors also acknowledge support from the British Council Women in STEM Fellowships program (grants No. 2324).

\onecolumn
%\bibliographystyle{elsarticle-harv} 
\bibliographystyle{unsrtnat}
\bibliography{reference}

\onecolumn
\tableofcontents

\clearpage % Page break for arxiv version
\newpage
\onecolumn % TODO: Here is only to deal with \longtable
\appendix
\include{appendix}



\clearpage % Page break for arxiv version

%\appendix

%\tableofcontents
%\newpage


\end{document}