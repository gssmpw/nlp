\begin{algorithm}[h]
    \caption{Inference Process of our \modelname}
    \label{alg:infer_alg}
    \begin{algorithmic}[1]
        \INPUT question $q$, the retrieval server (\textbf{Retriever}), the LLM server (\textbf{LLM}), the proxy model in our \modelname $\pi$, instruction for different agent (Reasoning Router, Information Filter, and Decision Maker).
        \OUTPUT The Answer.

        \STATE $a^1 \leftarrow \pi(q, \text{instruction}_1)$ \COMMENT{Reasoning Router agent}

        \IF{$a^1$==\texttt{[No Retrieval]}}
        \STATE $\text{Answer} \leftarrow \textbf{LLM}(q)$ \COMMENT{Direct Answering Strategy, \textcolor{red}{if $q$ does not require retrieval}}
        \ELSIF{$a^1$==\texttt{[Retrieval]<query content>}} 
        \STATE $\text{docs} \leftarrow \textbf{Retrieval}(\texttt{<query content>})$
        \STATE $\text{selected docs} (a^2) \leftarrow \pi(q, \text{docs}, \text{instruction}_2)$ \COMMENT{Information Filter agent}
        \STATE $\text{Answer} \leftarrow \textbf{LLM}(q, \text{selected docs})$ \COMMENT{Single-pass Strategy, \textcolor{red}{if $q$ requires retrieval and is simple question}}
        \ELSE
        \STATE Accumulated\_docs $\leftarrow \emptyset$ 
        \STATE $\text{Roadmap}\leftarrow \textbf{LLM}(q)$ \COMMENT{$a^1==\texttt{[Planning]}$}
        \STATE $a^3 \leftarrow \pi(q, \text{Roadmap}, \text{Accumulated\_docs}, \text{instruction}_3)$ \COMMENT{Decision Maker agent}
        \WHILE{$a^3 \neq \texttt{[LLM]}$ }
            \STATE $\text{docs} \leftarrow \textbf{Retrieval}(\texttt{<subquery content>}~\text{in}~a^3)$
            \STATE $\text{selected docs} (a^2) \leftarrow \pi(q, \text{docs}, \text{instruction}_2)$ \COMMENT{Information Filter agent}
            \STATE Accumulated\_docs $\leftarrow \{\text{Accumulated\_docs}\} \cup \{\text{selected docs}\}$ 
            \STATE $a^3 \leftarrow \pi(q, \text{Roadmap}, \text{Accumulated\_docs}, \text{instruction}_3)$ \COMMENT{Decision Maker agent}
        \ENDWHILE
        \STATE $\text{Answer} \leftarrow \textbf{LLM}(q, \text{Accumulated\_docs})$ \COMMENT{Multi-step Reasoning Strategy, \textcolor{red}{if $q$ requires retrieval and is complex}}
        \ENDIF
    \end{algorithmic}
\end{algorithm}