% \documentclass[acmsmall,screen,review]{acmart}
\documentclass[journal]{IEEEtran}


\include{macros}


%%
%% end of the preamble, start of the body of the document source.
\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
\title{Towards Secure Program Partitioning for Smart Contracts with LLM's In-Context Learning}

\author{
\IEEEauthorblockN{
  Ye Liu$^1$, 
  Yuqing Niu$^1$, 
  Chengyan Ma$^1$,
  Ruidong Han$^1$, 
  Wei Ma$^1$, 
  Yi Li$^2$, 
  Debin Gao$^1$, 
  and David Lo$^1$,~\IEEEmembership{Fellow,~IEEE}}\\
\IEEEauthorblockA{
  $^1$Singapore Management University\\
  $^2$Nanyang Technological University\\
}
}

% \author{Ye Liu,
%         Yuqing Niu,
%         Chengyan Ma~\textsuperscript{\orcidlink{0000-0001-9256-6930}},
%         Ruidong Han~\textsuperscript{\orcidlink{0000-0001-6859-60057}},
%         Wei Ma,
%         Yi Li,
%         Debin Gao,
%         David Lo~\textsuperscript{\orcidlink{0000-0002-4367-7201}},~\IEEEmembership{Fellow,~IEEE},
% \thanks{
%           Ye Liu, Yuqing Niu, Chengyan Ma, Ruidong Han, Wei Ma, and David Lo are with the School of Computing and Information Systems, Singapore Management University(e-mail:xxxEMAIL).
%           Yi Li is with the School of Computer Science and Engineering, Nanyang Technological University, Singapore.
%           Debin Gao is with the School of Computer Science and Engineering, Beihang University, China.
%         }
% }



% % First author
% \author{Ye Liu}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{yeliu@smu.edu.sg}

% % Second author
% \author{Yuqing Niu}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{yuqingniu@smu.edu.sg}

% % Third author
% \author{Chengyan Ma}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{chengyanma@smu.edu.sg}

% \author{Ruidong Han}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{rdhan@smu.edu.sg}


% \author{Wei Ma}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{weima@smu.edu.sg}

% % \author{Juantao Zhong}
% % \affiliation{%
% %   \institution{The Hong Kong University of Science and Technology}
% %   % \city{Shenzhen}
% %   \country{Hong Kong}
% % }
% % \email{jzhong012@e.ntu.edu.sg}

% \author{Yi Li}
% \affiliation{%
%   \institution{Nanyang Technological University}
%   \country{Singapore}
% }
% \email{yi_li@ntu.edu.sg}


% \author{David Lo}
% \affiliation{%
%   \institution{Singapore Management University}
%   \country{Singapore}
% }
% \email{davidlo@smu.edu.sg}


%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.

%% This command processes the author and affiliation and title
%% information and builds the first part of the formatted document.

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
% Smart contracts are highly susceptible to manipulation attacks due to the leakage of sensitive information. Addressing such vulnerabilities is particularly challenging because they stem from inherent data confidentiality issues rather than straightforward implementation bugs. 
% To tackle this, we present \tool, a novel approach that combines static analysis with the in-context learning capabilities of large language models (LLMs) to partition smart contracts into privileged and normal codebases, guided by a few annotated \secrete variables.
% We evaluated \tool on 18 annotated smart contracts containing 99 sensitive functions. 
% The results demonstrate that \tool successfully generates \emph{compilable}, \emph{secure}, and \emph{functionally equivalent} partitions for 78\% of the subject functions with high accuracy. Additionally, \tool reduces the size of the trusted codebase by approximately 30\% compared to traditional function-level partitioning. 
% In testing on nine real-world victim contracts affected by manipulation attacks, \tool effectively identified eight cases, highlighting its potential for broad applicability and the emerging need for secure program partitioning in smart contract development.

\maketitle
\begin{abstract}
Smart contracts are highly susceptible to manipulation attacks due to the leakage of sensitive information. Addressing manipulation vulnerabilities is particularly challenging because they stem from inherent data confidentiality issues rather than straightforward implementation bugs. 
To tackle this by preventing sensitive information leakage, we present \tool, the first LLM-driven approach that combines static analysis with the in-context learning capabilities of large language models (LLMs) to partition smart contracts into privileged and normal codebases, guided by a few annotated \secrete variables.
We evaluated \tool on 18 annotated smart contracts containing 99 sensitive functions. 
The results demonstrate that \tool successfully generates \emph{compilable}, and \emph{verified} partitions for 78\% of the sensitive functions while reducing approximately 30\% code compared to function-level partitioning approach. 
Furthermore, we evaluated \tool on nine real-world manipulation attacks that lead to a total loss of 25 million dollars, \tool effectively prevents eight cases, highlighting its potential for broad applicability and the necessity for secure program partitioning during smart contract development to diminish manipulation vulnerabilities.
% Smart contracts are vulnerable to manipulation attacks due to sensitive information leakage.
% Prevention of manipulation vulnerabilities from smart contracts are challenging because they are inherent data confidentiality issues rather than easy-to-fix implementation bugs.
% To preserve confidentiality, in this paper, we propose \tool to accept a few annotated \secrete variables and combine static analysis with LLM's in-context learning to partition smart contracts into privileged and normal codebases.
% We evaluate \tool on 18 annotated smart contracts with 99 sensitive functions.
% The evaluation indicates that \tool could successfully generate \emph{compilable}, \emph{secure}, and \emph{functionally equivalent} partitions for 78\% subject functions with a reasonably high accuracy, resulting in a decrease of around 30\% codes in the trusted codebase compared to the function-level partitioning.
% Of nine real-world victim smart contracts suffering manipulation attacks, \tool can be applied to identify eight cases, indicating the potential wide applicability and emerging need for secure program partitioning.
\end{abstract}


\input{Introduction}
\input{Background}
\input{Motivation}
\input{Approach}
\input{Implementation}
\input{Evaluation}

\input{RelatedWork}

\input{Conclusion}
% \cleardoublepage

\bibliographystyle{IEEEtranN}
% \bibliographystyle{ACM-Reference-Format}
\bibliography{reference}

\end{document}
\endinput
%%
%% End of file `sample-acmsmall-conf.tex'.
