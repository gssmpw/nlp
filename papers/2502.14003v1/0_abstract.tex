% Modern Hopfield networks (MHNs) have recently gained significant attention in the field of artificial intelligence because they can store and retrieve large sets of patterns with an exponentially large memory capacity. Recently, it has been proven that MHNs can be understood as a dynamical system defined with Lagrangian functions of memory and feature neurons, where memories associated with in-distribution (ID) training samples are represented as attractors in the feature space. However, one of the primary challenges remains in managing out-of-distribution (OOD) samples because MHNs are formulated under the assumption that all data samples are ID samples. To address this challenge, we propose the rectified Lagrangian (RegLag), a new Lagrangian function for memory neurons that explicitly incorporates an attractor for OOD samples in the dynamical system of MHNs. RecLag is designed to create a trivial point attractor for any interaction matrix, enabling OOD detection by identifying samples that fall into this attractor as OOD. Furthermore, for training MHNs with RecLag, we devise a method based on probabilistic interaction, by which data samples with low probability density values fall into the created attractor. In experiments, we demonstrated the effectiveness of RecLag-based MHNs compared to energy-based OOD detection methods, including those using state-of-the-art Hopfield energies, across nine image datasets.

\begin{abstract}
Modern Hopfield networks (MHNs) have recently gained significant attention in the field of artificial intelligence because they can store and retrieve a large set of patterns with an exponentially large memory capacity.
A MHN is generally a dynamical system defined with Lagrangians of memory and feature neurons,
where memories associated with in-distribution (ID) samples are represented by attractors in the feature space.
One major problem in existing MHNs lies in managing out-of-distribution (OOD) samples because it was originally assumed that all samples are ID samples.
To address this, we propose the rectified Lagrangian
(RegLag), a new Lagrangian for memory neurons
that explicitly incorporates an attractor for OOD samples in the dynamical system of MHNs.
RecLag creates a trivial point attractor for any interaction matrix, enabling OOD detection by identifying samples that fall into this attractor as OOD. 
The interaction matrix is optimized so that the probability densities can be estimated to identify ID/OOD.
We demonstrate the effectiveness of RecLag-based MHNs compared to energy-based OOD detection methods, including those using state-of-the-art Hopfield energies, across nine image datasets.
\end{abstract}

%Furthermore, for training MHNs with RecLag, we devise a method based on probabilistic interaction, by which data samples with low probability density values fall into the created attractor.