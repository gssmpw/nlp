\IncMargin{1em}
\vspace{-2mm}
\begin{algorithm}
\caption{$f_{\vect{\kappa}}^L$}\label{alg:base}
\KwIn{$G$}
\KwOut{$\vect{Z}^{\vect{\kappa}}$}
$\vect{H}^0\leftarrow \vect{X}$\;
\For{$l=0$ to $L - 1$}{
    $\vect{{\update E}}^{l}\leftarrow CLAMP_{\kappa^{l}}(\sigma(exp_{\vect{o}}^{\kappa^l}(\text{MLP}(\sigma(\text{MLP}(\vect{H}^l))))))$\;
    \For{$i=1$ to $n$}{
        $\hat{\vect{s}}_{i}^{\kappa^l}\leftarrow \vect{1}-\sigma([2||\vect{{\update E}}^{l}_i-\vect{{\update E}}^{l}_j||-2\kappa^l(\vect{{\update E}}^{l}_i)^T\vect{{\update E}}^{l}_j||\vect{{\update E}}^{l}_i-\vect{{\update E}}^{l}_j||^2+\frac{||\vect{{\update E}}^{l}_i-\vect{{\update E}}^{l}_j||^3}{3}: j\in N(i)])$\;
        $\omega_{ij}^{\kappa^l}\leftarrow \text{MLP}(\text{CONCAT}(\vect{{\update E}}^{l}_i, \hat{\vect{s}}_{ij}^{\kappa^l}\vect{{\update E}}^{l}_j))$\;
        $\vect{H}^{l+1}_i\leftarrow \text{SELU}(log_{\vect{o}}^{\kappa^l}(\vect{{\update E}}^{l}_i)+\sum_{j\in N(i)}\omega_{ij}^{\kappa^l}log_{\vect{o}}^{\kappa^l}(\vect{{\update E}}^{l}_j))$\;
        
    }
    %$\vect{H}\leftarrow\vect{H}^{l+1}$\;
}
$\vect{Z}^{\vect{\kappa}}\leftarrow \text{SOFTMAX}(\text{MLP}(\text{CONCAT}(\vect{H}^{0}, \vect{H}^{1}, ..., \vect{H}^{L})))$\;
Return $\vect{Z}^{\vect{\kappa}}$\;

\end{algorithm}
\vspace{-2mm}
\DecMargin{1em}