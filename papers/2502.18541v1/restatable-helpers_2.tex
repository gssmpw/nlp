%\def\thisthm{42}
\newcommand{\pagetarget}[2]{%
  \phantomsection%
  \label{#1}%
  \hypertarget{#1}{#2}%
}

\makeatletter
\newtheoremstyle{linkedrestate}
  {}%      Space above, empty = `usual value'
  {}%      Space below
  {\itshape}% Body font
  {}%         Indent amount (empty = no indent, \parindent = para 
  %indent)
  {{$\blacktriangleright$}\nobreakspace\sffamily\bfseries}% lipics style:  %$\blacktriangleright$}\nobreakspace\sffamily\bfseries  vs. Default style: \bfseries
  {.%
  \ifthmt@thisistheone{%
%  \@ifundefined{r@\thisthm}{}{\!\textnormal{ 
%  [\hyperlink{restated:\thisthm}{See p.~\pageref{\thisthm}.}]\!\!\!}}%
  }
  \fi
}%        Punctuation after thm head
  { }%     Space after thm head: " " = normal interword space;
     %     \newline = linebreak
  {%
    \ifthmt@thisistheone%
    \hyperlink{restated:\thisthm}{\thmname{#1} %
    \thmnumber{#2}\unskip}%
    \thmnote{ (#3)}%
    \myhypertarget{orig:\thisthm}{}%
    \else%
    \hyperlink{orig:\thisthm}{\thmname{#1} %
    \thmnumber{#2}\unskip}%
    \thmnote{ (#3)}%
    \myhypertarget{restated:\thisthm}{}%
    \fi
    }% Thm head spec

\NewDocumentCommand{\NewLinkedTheorem}{s m o m o}{
    \let\current@thmstyle\thmt@outerstyle % store current theorem 
    %style
    \IfBooleanTF{#1}{
        \newtheorem*{#2}{#4}
        \theoremstyle{linkedrestate}
        \newtheorem*{linked-#2}{#4}
        \ExpandArgs{e}\theoremstyle{\current@thmstyle} % reset 
        %theorem style
        }{
        \IfNoValueTF{#3}{
            \IfNoValueTF{#5}{
                \newtheorem{#2}{#4}
                }{
                \newtheorem{#2}{#4}[#5]
                }
            }{
            \newtheorem{#2}[#3]{#4}
            }
        \theoremstyle{linkedrestate}
        \newtheorem{linked-#2}[#2]{#4}
        \ExpandArgs{e}\theoremstyle{\current@thmstyle} % reset 
        %theorem style
        }
    }
\makeatother


\NewCommandCopy{\oldrestatable}{\restatable}
\NewCommandCopy{\endoldrestatable}{\endrestatable}

\NewDocumentEnvironment{linkedrestatable}{O{} m m +b}{%
    \def\thisthm{#3}%g
    \begin{oldrestatable}[#1]{linked-#2}{#3}%
    #4
    \end{oldrestatable}%
	\ignorespacesafterend%
    \AddToHook{cmd/#3/before}{\def\thisthm{#3}}%
    }{}

\renewenvironment{restatable}{%
    \begin{linkedrestatable}%
}{%
    \end{linkedrestatable}%
    \ignorespacesafterend%
}


\NewLinkedTheorem{linkedtheorem}[theorem]{Theorem}[section]
\NewLinkedTheorem{linkedlemma}[theorem]{Lemma}
\NewLinkedTheorem{linkedcorollary}[theorem]{Corollary}

\makeatletter 
\newcommand{\myhypertarget}[1]{\Hy@raisedlink{\hypertarget{#1}{}}} 
\makeatother
