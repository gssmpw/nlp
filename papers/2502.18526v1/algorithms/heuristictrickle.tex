\begin{algorithm}[htp]
\caption{Trickle Charging with Least Laxity First.}
\label{alg:llf}
\small
\KwIn{Set of EVs $V$, chargers $\mathcal{C}$, time slots $t$}
\KwOut{Charging schedule for each EV}

\For{each time slot $T_j \in\mathcal{T}$}{
    \For{each EV $\phi(C_i, T_j)$ connected to chargers $\mathcal{C}$}{
        Compute laxity: 
        $L(\phi(C_i, T_j)) = (\DepartureTime(\phi(C_i, T_j)) - t) - \PowerNeed(C_i, T_j) /C_{max}^i$.
    }
    Compute power gap: 
    $\hat{P} = \PrdPeak(T_j) - \Building(T_j)$\;
    Sort EVs by laxity: $L(\phi(C_i, T_j))$ in ascending order\;
    Initialize $[P(C_i, T_j)]_{C^i\in\mathcal{C}}$ as 0\;
        \For{each EV $\phi(C_i, T_j)$ sorted by laxity}{
            \If{$\hat{P} > 0$}{
                Set trickle charging rate: 
                $P(C_i, T_j) = \min({\PowerNeed(C_i, T_j)}/{\ReTime(C_i, T_j)},\hat{P})$ \;

            $\hat{P}\gets \hat{P}-P(C_i, T_j)$\;
            }
        }
    }
\end{algorithm}  