\section{Data Description and Preproceccing}

In this research, we conducted a study on 16 weed species at the SIU Horticulture Research Center greenhouse.
% These species were chosen based on their potential for economic damage and are listed in the top 6 most common or most troublesome weeds in broadleaf and grass crops in USA agriculture in a nationwide survey conducted by the Weed Science Society of America \cite{van2017weed}.
We began by preparing soil for seed planting, as shown in  Figure \ref{fig:fig1}(b). Potting soil (Pro-Mix Â® BX) was placed into 32 square pots (10.7 cm x 10.7 cm x 9 cm), each labeled by species with white pot stakes. Two seeds from each species were planted per pot. Environmental conditions in the greenhouse, including temperature and lighting, were carefully controlled. Plants were watered as needed and fertilized with all-purpose 20-20-20 nutrient solution every 3 days. Figure \ref{fig:fig2_greenhouse} provides an overview of the greenhouse environment. We monitored the growth stages of each plant on a weekly basis, capturing images from the first week until week 11. Image capture ceased when the weeds entered their flowering stage, which marked the final growth phase in our study. We have captured our images by using an iPhone 15 Pro Max. Table \ref{species_frames} provides a comprehensive overview of our study, detailing the weed species codes, their corresponding scientific and common names, and the number of frames captured for each species on a weekly basis.

\begin{figure}[t]
    % \vspace{-0.2cm}
    \centering
    \includegraphics[width=0.5\textwidth]{figure/fig2_greenhouse.jpg}
    \vspace{-0.4cm}
    \caption{Greenhouse environment with lighting, temperature, and watering setup.}
    \label{fig:fig2_greenhouse}
    \vspace{-0.3cm}
\end{figure}


% ---------------
\begin{table*}[htbp]
\caption{Overview of Weed Species of Economic Concern, Corresponding Codes, and Weekly Frame Counts Captured for Each Species Across 11 Weeks in the Greenhouse}
\vspace{-0.4cm}
\label{species_frames}
\begin{center}
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{\textbf{Species Code~\cite{kotleba1994european}}} & \multirow{2}{*}{\textbf{Scientific Name}~\cite{borsch2020world}} & \multirow{2}{*}{\textbf{Common Name}~\cite{wssaCompositeList}} & \multirow{2}{*}{\textbf{Family}} & \multirow{2}{*}{\textbf{Total Frames}} & \multicolumn{11}{|c|}{\textbf{Number of frames/week}} \\
\cline{6-16}
 &  &  &  &  & \textbf{\textit{W\_1}} & \textbf{\textit{W\_2}} & \textbf{\textit{W\_3}} & \textbf{\textit{W\_4}} & \textbf{\textit{W\_5}} & \textbf{\textit{W\_6}} & \textbf{\textit{W\_7}} & \textbf{\textit{W\_8}} & \textbf{\textit{W\_9}} & \textbf{\textit{W\_10}} & \textbf{\textit{W\_11}} \\
\hline
ABUTH & \textit{Abutilon theophrasti} Medik. & Velvetleaf & Malvaceae & 14754 & 1084 & 2451 & 1212 & 1819 & 1414 & 981 & 677 & 1164 & 1084 & 1500 & 1368 \\
AMAPA & \textit{Amaranthus palmeri} S. Watson. & Palmer Amaranth & Amaranthaceae & 17525 & 1441 & 1408 & 2110 & 2014 & 2441 & 1290 & 923 & 1478 & 1393 & 1667 & 1360 \\
AMARE & \textit{Amaranthus retroflexus} L. & Redroot Pigweed & Amaranthaceae & 15380 & 1017 & 1363 & 2110 & 1923 & 1884 & 1150 & 736 & 1237 & 1082 & 1596 & 1282 \\
AMATU & \textit{Amaranthus tuberculatus} (Moq.) Sauer. & Water Hemp & Amaranthaceae & 14852 & 1325 & 1459 & 1565 & 1664 & 1942 & 837 & 730 & 969 & 1638 & 1573 & 1150 \\
AMBEL & \textit{Ambrosia artemisiifolia} L. & Common Ragweed & Asteraceae & 17427 & 1022 & 2215 & 1846 & 1739 & 2162 & 1093 & 1066 & 1432 & 1092 & 2045 & 1715 \\
CHEAL & \textit{Chenopodium album} L. & Common Lambsquarter & Chenopodiaceae & 8015 & 1108 & 954 & 1416 & 661 & 1056 & 305 & 418 & 641 & 453 & 429 & 574 \\
CYPES & \textit{Cyperus esculentus} L. & Yellow Nutsedge & Cyperaceae & 14275 & 909 & 1512 & 1032 & 1499 & 2273 & 978 & 1224 & 1391 & 1182 & 1170 & 1105 \\
DIGSA & \textit{Digitaria sanguinalis} (L.) Scop. & Large Crabgrass & Poaceae & 16962 & 732 & 1312 & 2411 & 2596 & 1649 & 1335 & 1166 & 1261 & 1120 & 1628 & 1692 \\
ECHCG & \textit{Echinochloa crus-galli} (L.) P. Beauv. & Barnyard Grass & Poaceae & 16564 & 1349 & 2067 & 2029 & 1426 & 2221 & 1240 & 929 & 1280 & 1371 & 1332 & 1320 \\
ERICA & \textit{Erigeron canadensis} L. & Horse Weed & Asteraceae & 15134 & 930 & 2183 & 1691 & 1542 & 2715 & 1189 & 609 & 742 & 915 & 1217 & 1401 \\
PANDI & \textit{Panicum dichotomiflorum} Michx. & Full Panicum & Poaceae & 15182 & 1198 & 1400 & 2143 & 1296 & 1979 & 952 & 887 & 1350 & 1425 & 1034 & 1518 \\
SETFA & \textit{Setaria faberi} Herrm. & Gaint Foxtail & Poaceae & 14635 & 1614 & 1195 & 2083 & 1348 & 1944 & 1091 & 715 & 1466 & 843 & 1342 & 994 \\
SETPU & \textit{Setaria pumila} (Poir.) Roem. & Yellow Foxtail & Poaceae & 15211 & 887 & 1390 & 1732 & 1654 & 2040 & 1093 & 747 & 1361 & 1325 & 1348 & 1634 \\
SIDSP & \textit{Sida spinosa} L. & Princkly Sida & Malvaceae & 14452 & 1035 & 1782 & 1583 & 1259 & 2142 & 1373 & 804 & 1059 & 1186 & 1303 & 926 \\
SORHA & \textit{Sorghum halepense} (L.) Pers. & Johnson Grass & Poaceae & 10958 & 0 & 0 & 1444 & 1268 & 1395 & 945 & 749 & 1215 & 1328 & 1116 & 1498 \\
SORVU & \textit{Sorghum bicolor}  (L.) Moench. & Shatter Cane & Poaceae & 9573 & 945 & 1340 & 1959 & 832 & 1065 & 525 & 279 & 748 & 714 & 592 & 574 \\
\hline
\end{tabular}
}
\end{center}
% \vspace{-0.5cm}
\end{table*}


% --------------------





% --------------------

Among the 16 species of weeds studied, SORHA did not emerge in weeks 1 and 2. Consequently, the research encompassed a total of 174 classes. The full dataset initially comprised 2,494,476 frames. After a thorough review process to remove substandard images, 203,567 images were ultimately selected for training. Figure \ref{fig:fig3_plants} presents sample images of four weed species at different growth stages. For ABUTH, images from week 1 (a) and week 11 (b) are shown. Similarly, ERICA is represented by its week 1 (c) and week 11 (d) images. SETFA is depicted in its first week (e) and eleventh week (f) of growth. Lastly, CYPES is illustrated in its initial (g) and final (h) weeks of the study period. Notably, while several species produced flowers in their final growth stages, others did not, reflecting natural growth processes and photoperiod sensitivities.

\begin{figure}[t]
    % \vspace{-0.2cm}
    \centering
    \includegraphics[width=0.5\textwidth]{figure/fig3_plants.png}
    \vspace{-0.4cm}
    \caption{Growth stages example of four weed species. (a,b) ABUTH in week 1 and 11; (c,d) ERICA in week 1 and 11; (e,f) SETFA in week 1 and 11; (g,h) CYPES in week 1 and 11. Images show progression from seedling emergence to mature plants across different species.}
    \label{fig:fig3_plants}
    \vspace{-0.3cm}
\end{figure}


\subsection{Data Preprocessing and Augmentation}
%
Our preprocessing pipeline begins with image normalization, a fundamental step that standardizes the input data. Each image is meticulously scaled to a 0-1 range by dividing all pixel values by 255.0. This normalization process is crucial as it ensures consistency across the dataset and aligns with the input requirements of neural networks, facilitating more efficient and effective training \cite{huang2023normalization}. Following normalization, we perform a color space conversion, transforming the images from the standard RGB (Red, Green, Blue) color space to the HSV (Hue, Saturation, Value) color space. The HSV color space allows us to more precisely isolate plant areas from the background, enhancing the accuracy of subsequent processing steps.

The next step in our pipeline is green area detection. We employ carefully calibrated thresholds for the HSV channels to create a mask that highlights potential plant regions. Specifically, we use hue values ranging from 25/360 to 160/360, a minimum saturation value of 0.20. These thresholds have been empirically determined to effectively isolate green regions corresponding to plant matter while minimizing false positives from non-plant green objects. We apply morphological operations \cite{comer1999morphological} to refine the green mask and improve the continuity of detected plant areas. The refined green areas are then subjected to connected component analysis, which identifies and labels distinct regions within the image. This step is crucial for differentiating individual plants or plant clusters, allowing for more precise analysis and annotation. Fig \ref{fig:dataaug} shows the process of the data augmentation.

\begin{figure}[t]
    % \vspace{-0.2cm}
    \centering
    \includegraphics[width=0.5\textwidth]{figure/data_augmentation_updated.png}
    \vspace{-0.4cm}
    \caption{Data Augmentation process with original image, masked image, and bounding box, respectively, for ERICA (a,b,c) and AMAPA (d,e,f).}
    \label{fig:dataaug}
    \vspace{-0.3cm}
\end{figure}

\subsection{Data Labeling}

Our labeling process creates comprehensive annotations for detected plants, including bounding box coordinates and detailed Pascal VOC XML annotations. We use Python libraries like Pillow \cite{clark2015pillow}, NumPy, and scikit-image for image processing. To ensure accuracy, we implemented a rigorous quality control process, manually refining annotations using LabelImg software \cite{labelImg2024} when necessary. Our labeling convention includes both species code and week number, enhancing the dataset's utility for tracking plant development and species-specific analysis. This meticulous approach results in a high-quality dataset with precise annotations and consistent formatting, suitable for various plant analysis tasks and growth stage tracking. 

Figure \ref{fig:boundingbox} illustrates this process, presenting a side-by-side comparison of an original image and its corresponding labeled version, which we refer to as the ground truth.


\begin{figure}[t]
    \centering
    \includegraphics[width=0.5\textwidth]{figure/fig4_boundingbox.png}
    \vspace{-0.4cm}
    \caption{Illustration of the labeling process for weed detection. The original image (a) shows the weed plant, followed by the selected leaf area (b), highlighted in blue, and the final image (c) with a bounding box and label (AMBEL\_week\_8).}
    \label{fig:boundingbox}
    \vspace{-0.3cm}
\end{figure}
