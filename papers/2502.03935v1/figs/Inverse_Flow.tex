\begin{tikzpicture}[
    abort/.style = {rectangle, rounded corners, text width=2cm, minimum height=1cm,text centered, draw=black, fill=red!10, align=center, anchor=center},
    box/.style = {rectangle, text width=2cm, minimum height=1cm, text centered, draw=black, fill=tikzblau!30, align=center, anchor=center},
    decision/.style = {diamond, text width=1.2cm, minimum height=1cm, text centered, draw=black, fill=tikzblau!30, align=left, anchor=center},
    arrow/.style = {thick,->,>=stealth}
]
    \matrix (m) [matrix of nodes, row sep=0.2cm, column sep=1cm, text width=2cm, align=left] {
        |[box]|  solve forward problem $F(\theta_i)$ &  & |[box]|  calculate cost function $J(\theta_i)$\\
        & & & \\
        |[box]| new parameters (step in the L-BFGS-B algorithm) & |[decision]| check $i > i_\text{max}$ & |[decision]| check $J<\varepsilon$ \\
        & & & \\
        & |[abort]| abort  & estimated parameters $\theta_\text{e}$ \\
    };

    \draw[arrow] (m-1-1) edge node[above] {$T_\text{sim}$} (m-1-3);
    \draw[arrow] (m-1-3) edge (m-3-3);
    \draw[arrow] (m-3-3) edge node[above] {no} (m-3-2);
    \draw[arrow] (m-3-2) edge node[above] {no} (m-3-1);
    \draw[arrow] (m-3-2) edge node[right] {yes} (m-5-2);
    \draw[arrow] (m-3-1) edge node[right] {$\theta_i$} (m-1-1);
    \draw[arrow] ([yshift=0.5cm]m-1-1.north) -- (m-1-1.north) node[above right] {initial guess $\theta_0$};
    \draw[arrow] (m-3-3) edge node[right] {yes} (m-5-3);
     \draw[arrow] ([yshift=0.5cm]m-1-3.north) -- (m-1-3.north) node[above right] {$T_\text{meas}$};
\end{tikzpicture}
