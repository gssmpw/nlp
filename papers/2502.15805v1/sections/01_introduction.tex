\section{Introduction}
\label{sec:introduction}

Deep generative models, such as diffusion and flow matching, have demonstrated remarkable success across domains like images \citep{glide_image, ldm, ddpm}, text \citep{diffusion_lm}, and videos \citep{videocontrolnet, vdm}. Recently, their application to molecular graph generation has gained attention, where they aim to generate chemically valid molecules by leveraging the structural properties of molecular graphs \citep{gdss, digress, defog}.

However, existing atom-based generative models face scalability challenges, particularly in generating large and complex molecules. 
The quadratic growth of edges as graph size increases results in computational inefficiencies. 
At the same time, the inherent sparsity of chemical bonds makes accurate edge prediction more complex, often leading to unrealistic molecular structures or invalid connectivity constraints \citep{sparsediff, edge_dgree-guided}.
% The quadratic growth of edges as graph size increases results in computational inefficiencies, while the inherent sparsity of chemical bonds makes accurate edge prediction more difficult \citep{digress, defog}. 
Additionally, graph neural networks (GNNs) struggle to capture topological features such as rings and loops, leading to deviations from chemically valid structures. While various methods incorporate auxiliary features (e.g., spectral, ring, and valency information) to mitigate these issues, they do not fully resolve the sparsity and scalability bottlenecks \citep{digress}.

Fragment-based molecular generation has been explored as an alternative approach, inspired by its long-standing role in medicinal chemistry \citep{hajduk2007decade, joseph2014fragment, kirsch2019concepts}. Instead of generating molecules atom by atom, fragment-based methods construct molecules using functional groups, ring systems, or chemically meaningful substructures, reducing complexity while preserving structural validity. This approach leverages established domain knowledge and significantly improves scalability by representing molecules as coarse-grained graphs. Within molecular generative frameworks, fragment-based methods enable more efficient exploration of the chemical space while maintaining structural coherence, offering better control over molecular properties than atom-based approaches \citep{jtvae, hierdiff, bbar, magnet}.

Recent studies \citep{fragment_based_diffusion, orgmol_design} utilizing diffusion models have demonstrated that fragment-level representations improve scalability and property control. 
However, many of these approaches rely on predefined fragment libraries or non-chemically driven fragmentation, which can constrain the accessible chemical space. 
Expanding the fragment library could mitigate this limitation, but it introduces computational overhead and modeling challenges in handling diverse fragment types.
To address these challenges, we introduce \methodname{}, which is the first fragment-based discrete flow matching framework for molecular graph generation.
Rather than being restricted to fixed fragment libraries, \methodname{} employs a sub-sampling strategy and GNN-based fragment embeddings, enabling generalization beyond predefined fragment sets while maintaining computational efficiency.

Through extensive benchmarking on MOSES and GuacaMol \citep{moses,guacamol}, we demonstrate that \methodname{} outperforms state-of-the-art diffusion and flow-based models in validity, property-based evaluation, and Fr√©chet ChemNet Distance (FCD) while requiring significantly fewer denoising steps. 
To further assess both scalability and the ability to capture high-level molecular semantics (e.g., biological relevance), we introduce a natural product benchmark based on the COCONUT dataset \citep{coconut, coconut2}, which contains large and structurally intricate molecules that present a demanding testbed for fragment-based generative modeling.
% To further evaluate the capability of generative models in capturing high-level molecular semantics (e.g. biological relevance), we introduce a natural product benchmark using the COCONUT dataset \citep{coconut, coconut2}.
% To further assess the generation of complex molecular structures, we introduce a natural product benchmark based on COCONUT \citep{coconut, coconut2}, evaluating the ability of generative models to construct biologically relevant molecules.
Our findings suggest that integrating fragment-level representations into generative frameworks provides a scalable and interpretable solution for molecular design, paving the way for advancements in drug discovery, materials science, and functional molecular engineering.