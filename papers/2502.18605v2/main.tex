\documentclass[11pt]{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables


\usepackage{hyperref}
\usepackage[table]{xcolor}         % colors

\newcommand{\declarecolor}[2]{\definecolor{#1}{RGB}{#2}\expandafter\newcommand\csname #1\endcsname[1]{\textcolor{#1}{##1}}}
\declarecolor{White}{255, 255, 255}
\declarecolor{Black}{0, 0, 0}
\declarecolor{Maroon}{128, 0, 0}
\declarecolor{Coral}{255, 127, 80}
\declarecolor{Red}{182, 21, 21}
\declarecolor{LimeGreen}{50, 205, 50}
\declarecolor{DarkGreen}{0, 80, 0}
\declarecolor{Purple}{146, 42, 158}
\declarecolor{Navy}{0, 0, 128}
\declarecolor{LightBlue}{84, 101, 202}
\definecolor{mydarkblue}{rgb}{0,0.08,0.45}
\hypersetup{ %
    pdftitle={},
    pdfkeywords={},
    pdfborder=0 0 0,
    pdfpagemode=UseNone,
    colorlinks=true,
    linkcolor=Navy,
    citecolor=DarkGreen,
    filecolor=Purple,
    urlcolor=Purple,
}

\usepackage{algorithm}
\usepackage{algorithmic}


\usepackage{natbib}
\bibliographystyle{plainnat}

\input{commands}


% Attempt to make hyperref and algorithmic work together better:
%\newcommand{\theHalgorithm}{\arabic{algorithm}}


\usepackage{multirow}

%\usepackage[ruled,linesnumbered]{algorithm2e}

% If accepted, instead use the following line for the camera-ready submission:
%\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

\usepackage{tikz}
\usepackage{pgfplots}

\usepackage{thm-restate}

\usepackage{fullpage}

% if you use cleveref..
%\usepackage{zref-clever}
%\newcommand{\Cref}[1]{{\zcref[S]{#1}}}
%\let\cref\Cref

\usepackage[capitalize,noabbrev,nameinlink]{cleveref}

\newcommand{\newzreftheorem}[2]{
    \newtheorem{#1}[theorem]{#2}
    \zcRefTypeSetup{#1}{Name-sg = #2}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
%\newzreftheorem{proposition}{Proposition}
\newtheorem{proposition}[theorem]{Proposition}
%\newzreftheorem{lemma}{Lemma}
\newtheorem{lemma}[theorem]{Lemma}
%\newzreftheorem{claim}{Claim}
\newtheorem{claim}[theorem]{Claim}
%\newzreftheorem{corollary}{Corollary}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
%\newzreftheorem{definition}{Definition}
\newtheorem{definition}[theorem]{Definition}
%\newzreftheorem{assumption}{Assumption}
\newtheorem{assumption}[theorem]{Assumption}
%\newzreftheorem{example}{Example}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark}
%\newzreftheorem{remark}{Remark}
\newtheorem{remark}[theorem]{Remark}
%\mathtoolsset{showonlyrefs=true}

\usepackage{nicefrac}
\usepackage{enumitem}

\usepackage{tikz}

\usepackage{MnSymbol}
\renewcommand\vec\bm
\renewcommand\grad\nabla

\newcommand*\tcircle[1]{%
  \raisebox{-0.5pt}{%
    \textcircled{\fontsize{7pt}{0}\fontfamily{phv}\selectfont #1}%
  }%
}

% \makeatletter
% \autonum@generatePatchedReferenceCSL{Cref}
% \autonum@generatePatchedReferenceCSL{cref}
% \makeatother

\newcommand{\bhz}[1]{{ {\color{magenta}{[BZ:~#1]}}}}
\newcommand{\et}[1]{{ {\color{olive}{[ET:~#1]}}}}
\newcommand{\emin}[1]{{ {\color{orange}{[EB:~#1]}}}}
\newcommand{\ioannis}[1]{{ {\color{blue}{[IA:~#1]}}}}
\newcommand{\gabri}[1]{{ {\color{red}{[GF:~#1]}}}}
\newcommand{\vince}[1]{{ {\color{green}{[vc:~#1]}}}}

\usepackage{authblk}

\title{Expected Variational Inequalities}

\author[1]{Brian Hu Zhang\thanks{Equal contribution.}}
\author[1]{Ioannis Anagnostides$^*$}
\author[1,2]{Emanuel Tewolde}
\author[1,2]{Ratip Emin Berker}
\author[3]{Gabriele Farina}
\author[1,2,4]{Vincent Conitzer}
\author[1,5]{Tuomas Sandholm}
\renewcommand\Affilfont{\small}
\affil[1]{Carnegie Mellon University}
\affil[2]{Foundations of Cooperative AI Lab (FOCAL)}
\affil[3]{Massachusetts Institute of Technology}
\affil[4]{University of Oxford}
\affil[5]{Additional affiliations: Strategy Robot, Inc., Strategic Machine, Inc., Optimized Markets, Inc.}
\affil[ ]{}
\affil[ ]{\texttt{\{bhzhang,ianagnos,etewolde,rberker,conitzer,sandholm\}}\texttt{@cs.cmu.edu}, \texttt{gfarina}\texttt{@mit.edu}}


\begin{document}

\maketitle

\pagenumbering{gobble}

\begin{abstract}
Variational inequalities (VIs) encompass many fundamental problems in diverse areas ranging from engineering to economics and machine learning. However, their considerable expressivity comes at the cost of computational intractability. In this paper, we introduce and analyze a natural relaxation---which we refer to as \emph{expected variational inequalities (EVIs)}---where the goal is to find a {\em distribution} that satisfies the VI constraint {\em in expectation}. By adapting recent techniques from game theory, we show that, unlike VIs, EVIs can be solved in polynomial time under general (nonmonotone) operators. EVIs capture the seminal notion of \emph{correlated equilibria}, but enjoy a greater reach beyond games. 
%
We also employ our framework to capture and generalize several existing disparate results, including from settings such as smooth games, and games with coupled constraints or nonconcave utilities. %Surprisingly, even in standard settings, our solution concept \emph{refines} correlated equilibria.

% Unlike VIs, we show that EVIs can be solved in polynomial time under broad assumptions. In doing so, we expand the scope of solution concepts and algorithmic techniques from game theory to a much broader class of problems.
\end{abstract}

\clearpage

\tableofcontents

\clearpage

\pagenumbering{arabic}

\input{text/intro}
\input{text/related}
\input{text/prelim}
\input{text/existence}
\input{text/ellipsoid}
\input{text/games}

\input{text/collapse}
\input{text/smoothness}
\input{text/conclusions}

\section*{Acknowledgments}
T.S. is supported by the Vannevar Bush Faculty Fellowship ONR N00014-23-1-2876, National Science Foundation grants RI-2312342 and RI-1901403, ARO award W911NF2210266, and NIH award A240108S001. B.H.Z. is supported 
by the CMU Computer Science Department Hans Berliner
PhD Student Fellowship. E.T, R.E.B., and V.C. thank the Cooperative AI Foundation, Polaris Ventures (formerly the Center for
Emerging Risk Research) and Jaan Tallinnâ€™s donor-advised fund at Founders Pledge for financial
support. E.T. and R.E.B. are also supported in part by the Cooperative AI PhD Fellowship. G.F is supported by the National Science Foundation grant CCF-2443068. We are grateful to Mete \c Seref Ahunbay for his helpful feedback. We also thank Andrea Celli and Martino Bernasconi for discussions regarding $\Phi$-equilibria in games with coupled constraints.

\bibliography{dairefs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\appendix

\input{text/further_prels}
\input{text/proofs}



\end{document}
