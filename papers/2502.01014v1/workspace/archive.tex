\begin{lemma}[Matrix Bernstein Inequality, Thm. 1.6.2 in \citep{matrix-concent}]\label{le:Bernstein}
Let $\rmX_1,\cdots,\rmX_K$ be independent, zero mean, and symmetry matrices of size $d \times d$, if $\left\|\rmX_k\right\| \leq C$ for any $k \in [K]$, we then have
\begin{equation}
    \E\left[\left\|\sum_{k=1}^K \rmX_k \right\|\right] \leq \sqrt{2\nu\ln(2d)} + \frac{1}{3}C\ln(2d)
\end{equation}
where $\nu \triangleq \left\|\sum_{k=1}^K \E\left[\rmX_k^2\right]\right\|$.
\end{lemma}

\begin{lemma}[Thm.~3 in \citep{shu2024ferret}]\label{thm:norm}
Define 
$
g_k \triangleq \frac{F(\vtheta + \epsilon \rvv_k) - F(\vtheta)}{\epsilon}
$ where each element $\rv$ in $\rvv_k$ is independently and randomly sampled from a truncated normal distribution, i.e., $\rv \sim \gN(0, 1)$ with $\rv \in [-1/\sqrt{d},1/\sqrt{d}]$, $\vg \triangleq [g_1\ \cdots\ g_K]^{\top}$, and $\rmV \triangleq [\rvv_1\ \rvv_2\ \cdots\ \rvv_K] \in \sR^{d \times K}$, given that  $F(\vtheta)$ is $L$-smooth, we have:
\begin{equation*}
\left\|\frac{1}{K}\rmV\vg - \frac{1}{K}\rmV\rmV^{\top} \nabla F(\vtheta)\right\| \leq \frac{1}{2}\eps L\ . 
\end{equation*}
\end{lemma}

\begin{proof}
Since the loss function $f(\cdot;\cdot)$ is assumed to be $L$-smooth w.r.t its first argument, we then have
\begin{equation}
\begin{aligned}
f(\vtheta + \eps \rvv) - f(\vtheta) &\leq \eps \rvv_k^{\top}\nabla f(\vtheta) + \frac{1}{2}\eps^2 L\left\|\rvv_k\right\|^2 \\
&\leq \eps \rvv_k^{\top}\nabla f(\vtheta) + \frac{1}{2}\eps^2 L \ .
\end{aligned}
\end{equation}

By dividing $\eps$ on both sides of the inequality above, we have
\begin{equation}
\begin{aligned}
\frac{f(\vtheta + \eps \rvv) - f(\vtheta)}{\eps} -\rvv_k^{\top}\nabla f(\vtheta)  \leq \frac{1}{2} L\eps \ . \label{eq:temp-1}
\end{aligned}
\end{equation}

We therefore can conclude our proof using the results below:
\begin{equation}
\begin{aligned}
\left\|\frac{1}{K}\rmV\vg - \frac{1}{K}\rmV\rmV^{\top} \nabla f(\vtheta)\right\| &\stackrel{(a)}{=} \left\|\frac{1}{K}\sum_{k=1}^K \left(\rvv_k g_k - \rvv_k\rvv_k^{\top} \nabla f(\vtheta)\right)\right\| \\
&\stackrel{(b)}{\leq} \frac{1}{K}\sum_{k=1}^K \left\|\rvv_k g_k - \rvv_k\rvv_k^{\top} \nabla f(\vtheta)\right\| \\
&\stackrel{(c)}{\leq} \frac{1}{K}\sum_{k=1}^K \left|g_k - \rvv_k^{\top} \nabla f(\vtheta)\right|\left\|\rvv_k\right\| \\[5pt]
&\stackrel{(d)}{\leq} \frac{1}{2}L \eps
\end{aligned}
\end{equation}
where $(b)$ comes from triangle inequality and $(d)$ results from \eqref{eq:temp-1} and $\left\|\rvv_k\right\| \leq 1$.
\end{proof}

\begin{lemma}[Thm.~2 in \citep{shu2024ferret}]\label{thm:reconstruct-error}
Given the reconstruction in \eqref{eq:reconstruct}, we have
\begin{equation*}
\E\left[\left\|\frac{1}{\rho K}\rmV\rmV^{\top} \nabla F(\vtheta) - \nabla F(\vtheta)\right\|\right] \leq \max\left\{2\sqrt{\frac{2\ln(2d)}{\rho K}}, \frac{2\ln(2d)}{\rho K}\right\} \left\|\nabla F(\vtheta)\right\| \ .
\end{equation*}
\end{lemma}

\begin{equation}
\begin{aligned}
\E\left[\left\|\tilde{\nabla} f(\vtheta) - \frac{1}{K}\rmV\vg\right\|^2\right] &= \E\left[\left\|\frac{1}{K}\sum_{k=1}^K \left(\frac{f(\vtheta+\eps\rvv_k) - F(\vtheta+\eps\rvv_k)}{\eps} - \frac{f(\vtheta) - F(\vtheta)}{\eps}\right)\rvv_k\right\|^2\right] \\
&\leq \frac{1}{K}\E\left[\sum_{k=1}^K \left\| \left(\frac{f(\vtheta+\eps\rvv_k) - F(\vtheta+\eps\rvv_k)}{\eps} - \frac{f(\vtheta) - F(\vtheta)}{\eps}\right)\right\|^2\left\|\rvv_k\right\|^2\right]\\
&\leq \frac{2\sigma^2}{\eps^2}
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\E\left[\left\|\tilde{\nabla} f(\vtheta) - \nabla F(\vtheta)\right\|^2\right] &= \E\left[\left\|\tilde{\nabla} f(\vtheta) - \frac{1}{K}\rmV\vg +  \frac{1}{K}\rmV\vg - \frac{1}{K}\rmV\rmV^{\top} \nabla F(\vtheta) + \frac{1}{K}\rmV\rmV^{\top} \nabla F(\vtheta) - \nabla F(\vtheta)\right\|^2\right] \\
&\leq 3\E\left[\left\|\tilde{\nabla} f(\vtheta) - \frac{1}{K}\rmV\vg\right\|^2 + \left\|\frac{1}{K}\rmV\vg - \frac{1}{K}\rmV\rmV^{\top} \nabla F(\vtheta)\right\|^2 + \left\|\frac{1}{K}\rmV\rmV^{\top} \nabla F(\vtheta) - \nabla F(\vtheta)\right\|^2\right] \\
&\leq \frac{6\sigma^2}{\eps^2} + \frac{3L^2 \eps^2}{4} + 
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
&\,\,\E\left[\left\langle\nabla F_{\mu}(\vtheta_t), \left(\frac{\eta}{\sqrt{\beta_2\vv_t + \zeta}} - \frac{\eta}{\sqrt{\vv_{t+1} + \zeta}}\right) \vm_{t+1}\right\rangle \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\E\left[\left|\nabla_i F_{\mu}(\vtheta_t)\right|\left|\vm_{t+1,i}\right|\left(\frac{\eta}{\sqrt{\beta_2\vv_{t,i} + \zeta}} - \frac{\eta}{\sqrt{\vv_{t+1,i} + \zeta}}\right) \Bigg| \gF_t\right] \\
=&\,\,\sum_{i=1}^d\E\left[ \frac{\eta(1-\beta_2)\vm^2_{t+1,i} \big|\nabla_i F_{\mu}(\vtheta_t)\big|\big|\vm_{t+1,i}\big|}{\sqrt{(\beta_2\vv_{t,i} + \zeta)(\vv_{t+1,i} + \zeta)}\left(\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}\right)} \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\big|\nabla_i F_{\mu}(\vtheta_t)\big|}{\sqrt{\beta_2\vv_{t,i} + \zeta}}\E\left[ \frac{\sqrt{1-\beta_2}\vm^2_{t+1,i}}{\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\big|\nabla_i F_{\mu}(\vtheta_t)\big|^2}{2\alpha\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{\eta\alpha}{2\sqrt{\beta_2\vv_{t,i} + \zeta}}\left(\E\left[ \frac{\sqrt{1-\beta_2}\vm^2_{t+1,i}}{\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right]\right)^2 \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\big|\nabla_i F_{\mu}(\vtheta_t)\big|^2}{2\alpha\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{\eta\alpha(1-\beta_2)}{2\sqrt{\beta_2\vv_{t,i} + \zeta}}\E\left[\vm^2_{t+1,i}\big|\gF_t\right]\E\left[ \frac{\vm^2_{t+1,i}}{\left(\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}\right)^2} \Bigg| \gF_t\right] \\
=&\,\,\sum_{i=1}^d\frac{\eta\big|\nabla_i F_{\mu}(\vtheta_t)\big|^2}{2\alpha\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{\eta\alpha}{2}\E\left[\vm^2_{t+1,i}\big|\gF_t\right]\E\left[ \frac{\vv_{t+1,i}+\zeta - (\beta_2\vv_{t,i}+\zeta)}{\sqrt{\beta_2\vv_{t,i} + \zeta}\left(\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}\right)^2} \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\big|\nabla_i F_{\mu}(\vtheta_t)\big|^2}{2\alpha\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{\eta\alpha}{2}\E\left[\vm^2_{t+1,i}\big|\gF_t\right]\E\left[\frac{1}{\sqrt{\beta_2\vv_{t,i}+\zeta}} - \frac{1}{\sqrt{\vv_{t+1,i}+\zeta}} \Bigg| \gF_t\right]
\end{aligned}
\end{equation}
where the last inequality comes from $\big|\vm_{t+1,i}\big| / \sqrt{\vv_{t+1,i} + \zeta} \leq 1/\sqrt{1-\beta_2}$

\begin{equation}
\begin{aligned}
\sum_{t=0}^{T-1} \E\left[\frac{1}{\sqrt{\beta_2\vv_{t,i}+\zeta}} - \frac{1}{\sqrt{\vv_{t+1,i}+\zeta}} \right] &= \frac{1}{\sqrt{\zeta}} + \sum_{t=1}^{T-1}\E\left[\frac{1}{\sqrt{\beta_2\vv_{t,i} + \zeta}} - \frac{1}{\sqrt{\vv_{t,i} + \zeta}}\right] - \E\left[\frac{1}{\sqrt{\vv_{T,i} + \zeta}}\right] \\
&\leq \frac{1}{\sqrt{\zeta}} + \sum_{t=1}^{T-1}\E\left[\frac{1}{\sqrt{\beta_2\vv_{t,i} + \zeta}} - \frac{\sqrt{\beta_2}}{\sqrt{\beta_2\vv_{t,i} + \zeta}}\right] \\
&\leq \frac{1 + T(1-\sqrt{\beta_2})}{\sqrt{\zeta}}
\end{aligned}
\end{equation} 

\section{Proofs}
\subsection{Proof of}

To mention that Zo-AdaMM fails to consider a more suitable assumption for Neural networks.

% \begin{equation}
% \begin{aligned}
% \E\left[\left\|\hat{\nabla} f(\vtheta_{\tau-1}) - \nabla F(\vtheta_{\tau-1})\right\|^2\right] &= \E\left[\left\|\hat{\nabla} f(\vtheta_{\tau-1}) - \nabla f(\vtheta_{\tau-1}) + \nabla f(\vtheta_{\tau-1}) - \nabla F(\vtheta_{\tau-1})\right\|^2\right]
% \end{aligned}
% \end{equation}

\begin{equation}
\begin{aligned}
\E\left[\left\|\vm_t - \E[\vm_t]\right\|^2\right] &= \E\left[\left\|(1-\beta_1)\sum_{\tau=1}^{t}\beta_1^{t-\tau}\left(\hat{\nabla} f(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{\tau-1})\right)\right\|^2\right] \\
&= (1-\beta_1)^2\sum_{\tau=1}^{t}\beta_1^{2(t-\tau)}\E\left[\left\|\hat{\nabla} f(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{\tau-1})\right\|^2\right] \\[4pt]
&\leq \frac{(1-\beta_1)(1-\beta_1^{2t})}{1 + \beta_1} \sigma^2
\end{aligned}
\end{equation}
This can explain why the bias correction term should not occur here, which may even increase the variance.

\begin{equation}
\begin{aligned}
\ &\E\left[\left\|\frac{1}{1 - \beta_1^t}\E[\vm_t] - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] \\
=\ & \E\left[\left\|\frac{(1 - \beta_1)}{1 - \beta_1^t} \sum_{\tau=1}^t \beta_1^{t-\tau}\left(\nabla F_{\mu}(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{t-1})\right)\right\|^2\right] \\
=\ &\left(\frac{1-\beta_1}{1-\beta_1^t}\right)^2\sum_{\tau,\tau'=1}^t\E\left[\Big\langle \beta_1^{t-\tau}(\nabla F_{\mu}(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{t-1})), \beta_1^{t-\tau'}(\nabla F_{\mu}(\vtheta_{\tau'-1}) - \nabla F_{\mu}(\vtheta_{t-1}))\Big\rangle\right] \\
\leq\ & \left(\frac{1-\beta_1}{1-\beta_1^t}\right)^2\sum_{\tau,\tau'=1}^t \frac{\beta_1^{2t-\tau-\tau'}}{2}\left(\E\left[\left\|\nabla F_{\mu}(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{t-1}))\right\|^2\right] + \E\left[\left\|\nabla F_{\mu}(\vtheta_{\tau'-1}) - \nabla F_{\mu}(\vtheta_{t-1}))\right\|^2\right]\right) \\
=\ & \left(\frac{1-\beta_1}{1-\beta_1^t}\right)^2\sum_{\tau=1}^t \frac{\beta_1^{t-\tau}(1 - \beta_1^t)}{1-\beta_1} \E\left[\left\|\nabla F_{\mu}(\vtheta_{\tau-1}) - \nabla F_{\mu}(\vtheta_{t-1}))\right\|^2\right] \\
\leq\ &\frac{4(1-\beta_1)G^2d}{1-\beta_1^{t}}\sum_{\tau=1}^{t-1} \beta_1^{t-\tau}
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\E\left[\left\|\vm_t - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] &= \E\left[\left\|\vm_t - \E\left[\vm_t\right] + \E\left[\vm_t\right] - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] \\[5pt]
&= \E\left[\left\|\vm_t - \E\left[\vm_t\right]\right\|^2\right] + \E\left[\left\|\E\left[\vm_t\right] - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] \\
&\leq \E\left[\left\|\vm_t - \E\left[\vm_t\right]\right\|^2\right] + (1-\beta_1^t)\E\left[\left\|\frac{1}{1 - \beta_1^t}\E[\vm_t] - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] + \beta_1^{t}\left\|\nabla F_{\mu}(\vtheta_{t-1})\right\|^2 \\
&\leq \frac{(1-\beta_1)(1-\beta_1^{2t})}{1 + \beta_1} \sigma^2 + 4(1-\beta_1)G^2d\sum_{\tau=1}^{t-1} \beta_1^{t-\tau} + \beta_1^{t}\left\|\nabla F_{\mu}(\vtheta_{t-1})\right\|^2 \\
&\leq (1-\beta_1)\sigma^2 + 4\beta_1G^2d + \beta_1^t \left\|\nabla F_{\mu}(\vtheta_{t-1})\right\|^2
\end{aligned}
\end{equation}

% \begin{equation}
% \begin{aligned}
% \E\left[\left\|\vtheta_{\tau-1} - \vtheta_{t-1}\right\|^2\right] &= \E\left[\left\|\eta \sum_{s=0}^{t-\tau-1}\frac{\vm_{\tau+s}}{\sqrt{\vv_{\tau+s} + \zeta}}\right\|^2\right] \\
% &\leq \eta^2(t-\tau)\sum_{s=0}^{t-\tau-1}\E\left[\left\|\frac{\vm_{\tau+s}}{\sqrt{\vv_{\tau+s} + \zeta}}\right\|^2\right] \\
% &\leq \eta^2(t-\tau)^2c^2
% \end{aligned}
% \end{equation}

% $c= \frac{d}{(1-\beta_2)}$

% \begin{equation}
% \begin{aligned}
% \E\left[\left\|\vm_t - \nabla F_{\mu}(\vtheta_{t-1})\right\|^2\right] &\leq (1-\beta_1)\sigma^2 + \beta_1 L^2D^2 + \beta_1^t \left\|\nabla F_{\mu}(\vtheta_{t-1})\right\|^2
% \end{aligned}
% \end{equation}

A small learning rate (small update) and a small gradient norm (flatness) can enjoy the benefit of RaZE better!


\begin{equation}
\begin{aligned}
\left(\frac{1}{T}\sum_{t=1}^T\E\left[\left\|\nabla
F_{\mu}(\vtheta_t)\right\|\right]\right)^2 &=\frac{1}{T^2}\left(\sum_{t=1}^T\E\left[\sqrt[4]{\beta_2\left\|\vv_{t-1}\right\|+\zeta}\frac{\left\|\nabla
F_{\mu}(\vtheta_t)\right\|}{\sqrt[4]{\beta_2\left\|\vv_{t-1}\right\|+\zeta}}\right]\right)^2 \\
&\leq \frac{1}{T^2}\left(\sum_{t=1}^T\left(\E\left[\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}\right]\right)^{\frac{1}{2}}\left(\E\left[\frac{\left\|\nabla
F_{\mu}(\vtheta_t)\right\|^2}{\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}}\right]\right)^{\frac{1}{2}}\right)^2 \\
&\leq \left(\frac{1}{T}\sum_{t=1}^T \E\left[\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}\right]\right)\left(\frac{1}{T}\sum_{t=1}^T\E\left[\frac{\left\|\nabla
F_{\mu}(\vtheta_t)\right\|^2}{\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}}\right]\right)
\end{aligned}
\end{equation}
which is attained by applying H\"{o}lder's inequality twice.

\begin{equation}
\begin{aligned}
\E\left[ \vv_{t-1,i}\right] &= \E_{\gF_{t-1}}\left[\E\left[ \vv_{t-1,i}|\gF_{t-1}\right]\right] \\[5pt]
&= \E_{\gF_{t-1}}\left[\E\left[\beta_2 \vv_{t-2,i} + (1-\beta_2)\vm^2_{t-1,i}|\gF_{t-1}\right]\right] \\[5pt]
&\leq \E_{\gF_{t-1}}\left[\beta_2\vv_{t-2,i} + (1-\beta_2)\left((1-\beta_1)\sigma^2 + \beta_1 L^2D^2 + (\beta_1^{t-1} + 1) \left|\nabla_i F_{\mu}(\vtheta_{t-2})\right|^2\right)|\gF_{t-1}\right] \\
&\leq \beta_2^{t-1}\vv_{0,i} + \sum_{\tau=1}^{t-1}(1-\beta_2)\beta_2^{t-\tau-1}\left((1-\beta_1)\sigma^2 + \beta_1 L^2D^2 + (\beta_1^{\tau} + 1) \left|\nabla_i F_{\mu}(\vtheta_{\tau-1})\right|^2\right) \\[-3pt]
&\leq (1-\beta_1)\sigma^2 + \beta_1 D^2L^2 + (1-\beta_2)\beta_2^{t-1}\sum_{\tau=1}^{t-1}(\beta_1^{\tau}+1)/\beta_2^{\tau} \left|\nabla_i F_{\mu}(\vtheta_{\tau-1})\right|^2
\end{aligned}
\end{equation}

Jensen's inequality.

\begin{equation}
\begin{aligned}
&\,\,\frac{1}{T}\sum_{t=1}^T \E\left[\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}\right] \\
\leq&\,\, \frac{1}{T}\sum_{t=1}^T\sum_{i=1}^d \E\left[\sqrt{\beta_2\vv_{t-1,i}}\right] + \sqrt{\zeta} \\
\leq&\,\, \sqrt{\zeta} + d\sqrt{(1-\beta_1)\sigma^2 + \beta_1 D^2L^2} + \frac{1}{T}\sum_{t=1}^T\sum_{i=1}^d\sum_{\tau=1}^{t-1} \sqrt{(1-\beta_2)\beta_2^{t-1}(\beta_1^{\tau}+1)/\beta_2^{\tau}} \left|\nabla_i F_{\mu}(\vtheta_{\tau-1})\right| \\
\leq&\,\, \sqrt{\zeta} + d\sqrt{(1-\beta_1)\sigma^2 + \beta_1 D^2L^2} + \frac{\sqrt{(1+\beta_1)(1-\beta_2)}}{T}\sum_{t=1}^{T-1} \beta_2^{(t-1)/2}\sum_{i=1}^d\sum_{\tau=1}^{T} \left|\nabla_i F_{\mu}(\vtheta_{\tau-1})\right| \\
\leq&\,\, \sqrt{\zeta} + d\sqrt{(1-\beta_1)\sigma^2 + \beta_1 D^2L^2} + \frac{1}{T}\frac{\sqrt{(1+\beta_1)(1-\beta_2)}}{1 - \sqrt{\beta_2}}\sum_{i=1}^d \sum_{\tau=1}^{T} \left|\nabla_i F_{\mu}(\vtheta_{\tau-1})\right| \\
\leq&\,\, \sqrt{\zeta} + d\sqrt{(1-\beta_1)\sigma^2 + \beta_1 D^2L^2} + \frac{2}{T}\sqrt{\frac{(1+\beta_1)d}{1-\beta_2}}\sum_{\tau=1}^{T} \left\|\nabla F_{\mu}(\vtheta_{\tau-1})\right\|
\end{aligned}
\end{equation}

% define $\beta_2\vv_t \triangleq \beta_2 \vv_{t}$

\begin{equation}
\begin{aligned}
\E\left[F_{\mu}(\vtheta_{t+1})|\gF_t\right] &\leq F_{\mu}(\vtheta_t) - \E\left[\left\langle\nabla F_{\mu}(\vtheta_t), \frac{\eta\,\vm_{t+1}}{\sqrt{\vv_{t+1} + \zeta}}\right\rangle\right] + \frac{L}{2}\E\left[\left\|\vtheta_{t+1}-\vtheta_{t}\right\|^2 | \gF_t\right] \\
% &\leq f(\vtheta_t) - \E\left[\left\langle\nabla f(\vtheta_t), \frac{\eta\,\vm_{t+1}}{\sqrt{\vv_{t+1} + \zeta}}\right\rangle\right] + \sum_{i=1}^d\frac{L}{2\sqrt{d}}\E\left[\left\|\vtheta_{t+1}-\vtheta_{t}\right\|\left|\vtheta_{t+1,i}-\vtheta_{t,i}\right| | \gF_t\right] \\
&= F_{\mu}(\vtheta_t) - \E\left[\left\langle\nabla F_{\mu}(\vtheta_t), \frac{\eta\,\vm_{t+1}}{\sqrt{\beta_2\vv_t + \zeta}}\right\rangle + \left\langle\nabla F_{\mu}(\vtheta_t), \left(\frac{\eta}{\sqrt{\vv_{t+1} + \zeta}} - \frac{\eta}{\sqrt{\beta_2\vv_t + \zeta}}\right)\,\vm_{t+1}\right\rangle \Bigg| \gF_t\right] + \\
&\qquad \qquad \frac{L}{2}\E\left[\left\|\vtheta_{t+1}-\vtheta_{t}\right\|^2 | \gF_t\right]
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\E\left[\left\langle\nabla F_{\mu}(\vtheta_t), -\frac{\eta\,\vm_{t+1}}{\sqrt{\beta_2\vv_t + \zeta}}\right\rangle \Bigg| \gF_t\right] &= \sum_{i=1}^d \left(- \frac{\eta\,\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2)}{\sqrt{\beta_2\vv_{t,i} + \zeta}} - \E\left[\frac{\eta\left(\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right)}{\sqrt{\beta_2\vv_{t,i} + \zeta}}\nabla_i F_{\mu}(\vtheta_t)\Bigg| \gF_t\right]\right) \\
&\leq \sum_{i=1}^d \left(- \frac{\eta\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}} + \E\left[\frac{\eta \left|\nabla_i F_{\mu}(\vtheta_t)\right|}{\sqrt{\beta_2\vv_{t,i}+\zeta}}\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|\Bigg| \gF_t\right]\right)
% &\leq \sum_{i=1}^d \left(- \frac{\eta\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{\eta G}{\sqrt{\zeta}}\sqrt{\E\left[\left|\vm_{t,i} - \nabla_i F_{\mu}(\vtheta_t)\right|^2 \big| \gF_t\right]}\right)
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\E\left[\left\|\vtheta_{t+1}-\vtheta_{t}\right\|^2 | \gF_t\right] &= \sum_{i=1}^d \E\left[\frac{\eta^2\vm_{t+1,i}^2}{\vv_{t+1,i}+\zeta} \Bigg| \gF_t\right] \\
&\leq \sum_{i=1}^d \E\left[\frac{\eta^2\vm_{t+1,i}^2}{\sqrt{\zeta}\sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right]
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
&\,\,\E\left[\left\langle\nabla F_{\mu}(\vtheta_t), \left(\frac{\eta}{\sqrt{\beta_2\vv_t + \zeta}} - \frac{\eta}{\sqrt{\vv_{t+1} + \zeta}}\right) \vm_{t+1}\right\rangle \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\E\left[\left|\nabla_i F_{\mu}(\vtheta_t)\right|\left|\vm_{t+1,i}\right|\left(\frac{\eta}{\sqrt{\beta_2\vv_{t,i} + \zeta}} - \frac{\eta}{\sqrt{\vv_{t+1,i} + \zeta}}\right) \Bigg| \gF_t\right] \\
=&\,\,\sum_{i=1}^d\E\left[ \frac{\eta(1-\beta_2)\big|\nabla_i F_{\mu}(\vtheta_t)\big|\big|\vm_{t+1,i}\big| \vm^2_{t+1,i} }{\sqrt{(\beta_2\vv_{t,i} + \zeta)(\vv_{t+1,i} + \zeta)}\left(\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}\right)} \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\sqrt{1-\beta_2}\big|\nabla_i F_{\mu}(\vtheta_t)\big|}{\sqrt{\zeta}}\E\left[ \frac{\vm^2_{t+1,i}}{\sqrt{\vv_{t+1,i}+\zeta} + \sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right] \\
\leq&\,\,\sum_{i=1}^d\frac{\eta\sqrt{1-\beta_2}G}{\sqrt{\zeta}}\E\left[ \frac{\vm^2_{t+1,i}}{\sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right]
\end{aligned}
\end{equation}
where the last inequality comes from $\big|\vm_{t+1,i}\big| / \sqrt{\vv_{t+1,i} + \zeta} \leq 1/\sqrt{1-\beta_2}$

\begin{equation}
\begin{aligned}
\E\left[F_{\mu}(\vtheta_{t+1})|\gF_t\right] &\leq F_{\mu}(\vtheta_t) + \sum_{i=1}^d \left(- \frac{\eta\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}} + \E\left[\frac{\eta\left|\nabla_i F_{\mu}(\vtheta_t)\right|}{\sqrt{\beta_2\vv_{t,i}+\zeta}}\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|\Bigg| \gF_t\right] \right) + \\
&\qquad \qquad \sum_{i=1}^d \left(\frac{\eta\sqrt{1-\beta_2}G}{\sqrt{\zeta}}\E\left[ \frac{\vm^2_{t+1,i}}{\sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right] +  \frac{L}{2}\E\left[\frac{\eta^2\vm_{t+1,i}^2}{\sqrt{\zeta}\sqrt{\beta_2\vv_{t,i}+\zeta}} \Bigg| \gF_t\right]\right)
\end{aligned}
\end{equation}

Let $\frac{\sqrt{1-\beta_2}G}{\sqrt{\zeta}} \leq \frac{1}{4}$ and $\frac{\eta L}{2\sqrt{\zeta}} \leq \frac{1}{4}$
\begin{equation}
\begin{aligned}
&\E\left[F_{\mu}(\vtheta_{t+1})|\gF_t\right] - F_{\mu}(\vtheta_t) \\[5pt]
\leq\,\,& \sum_{i=1}^d\left(-\eta + \frac{\eta\sqrt{1-\beta_2}G}{\sqrt{\zeta}} + \frac{\eta^2 L}{2\sqrt{\zeta}}\right) \frac{\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}} + G \left(\frac{\eta}{\sqrt{\zeta}} + \frac{2\eta\sqrt{1-\beta_2}G}{\zeta} + \frac{\eta^2 L}{\zeta} \right)\E\left[\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|\Bigg| \gF_t\right] + \\
&\qquad \qquad \left(\frac{\eta\sqrt{1-\beta_2}G}{\zeta} + \frac{\eta^2 L}{2\zeta}\right) \E\left[\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|^2\Bigg| \gF_t\right] \\
\leq\,\,& \sum_{i=1}^d -\frac{\eta}{4}\frac{\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{2\eta G}{\sqrt{\zeta}}\E\left[\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|\Bigg| \gF_t\right] + \frac{2\eta\sqrt{1-\beta_2}G + \eta^2L}{2\zeta} \E\left[\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t)\right|^2\Bigg| \gF_t\right]
% \leq\,\,& -\frac{\eta}{4}\frac{\left\|\nabla F_{\mu}(\vtheta_t)\right\|^2}{\sum_{i=1}^d \sqrt{\beta_2\vv_{t,i} + \zeta}} + \frac{2\eta G\sqrt{d}}{\sqrt{\zeta}}\E\left[\left\|\vm_{t+1} - \nabla F_{\mu}(\vtheta_t)\right\|\Bigg| \gF_t\right] + \frac{\eta}{2\sqrt{\zeta}} \E\left[\left\|\vm_{t+1} - \nabla F_{\mu}(\vtheta_t)\right\|^2\Bigg| \gF_t\right]
\end{aligned}
\end{equation}

define $\alpha \triangleq \sqrt{(1-\beta_1)\sigma^2 + 4\beta_1G^2d}$ and $\Delta = F_{\mu}(\vtheta_0) - \min_{\vtheta} F_{\mu}(\vtheta)$

\begin{equation}
\begin{aligned}
\sum_{t=0}^{T-1}\sum_{i=1}^d\E\left[\frac{\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2}{\sqrt{\beta_2\vv_{t,i} + \zeta}}\right] &\leq \frac{4\sum_{t=0}^{T-1}F_{\mu}(\vtheta_t) - \E\left[F_{\mu}(\vtheta_{t+1})|\gF_t\right]}{\eta} + \frac{8G\sqrt{d}}{\sqrt{\zeta}}\E\left[\sum_{t=0}^{T-1}\left\|\vm_{t+1} - \nabla F_{\mu}(\vtheta_t)\right\|\right] + \\
&\qquad \qquad \frac{4\sqrt{1-\beta_2}G + 2\eta L}{\zeta} \E\left[\sum_{t=0}^{T-1}\left\|\vm_{t+1} - \nabla F_{\mu}(\vtheta_t)\right\|^2\right] \\
&\leq \frac{4\Delta}{\eta} + \frac{8GT\alpha\sqrt{d}}{\sqrt{\zeta}} +  \frac{(4\sqrt{1-\beta_2}G + 2\eta L)\alpha^2 T}{\zeta}\\
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\left(\frac{1}{T}\sum_{t=1}^T\E\left[\left\|\nabla
F_{\mu}(\vtheta_t)\right\|\right]\right)^2 &\leq \left(\frac{1}{T}\sum_{t=1}^T \E\left[\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}\right]\right)\left(\frac{1}{T}\sum_{t=1}^T\E\left[\frac{\left\|\nabla
F_{\mu}(\vtheta_t)\right\|^2}{\sqrt{\beta_2\left\|\vv_{t-1}\right\|+\zeta}}\right]\right) \\
&\leq \left(\sqrt{\zeta} + d\alpha + \frac{2\sqrt{2d}}{\sqrt{1-\beta_2}}\frac{1}{T}\sum_{t=1}^T\E\left[\left\|\nabla
F_{\mu}(\vtheta_t)\right\|\right]\right)\left(\frac{4\Delta}{\eta T} + \frac{8G\alpha\sqrt{d}}{\sqrt{\zeta}} +  \frac{(4\sqrt{1-\beta_2}G + 2\eta L)\alpha^2}{\zeta}\right)
\end{aligned}
\end{equation}

\begin{equation}
\begin{aligned}
\frac{1}{T}\sum_{t=1}^T\E\left[\left\|\nabla
F_{\mu}(\vtheta_t)\right\|\right] &\leq \frac{2\sqrt{2d}}{\sqrt{1-\beta_2}}\left(\frac{4\Delta}{\eta T} + \frac{8G\alpha\sqrt{d}}{\sqrt{\zeta}} +  \frac{(4\sqrt{1-\beta_2}G + 2\eta L)\alpha^2}{\zeta}\right) + \\
&\qquad \qquad \sqrt{\left(\sqrt{\zeta} + d\alpha\right)\left(\frac{4\Delta}{\eta T} + \frac{8G\alpha\sqrt{d}}{\sqrt{\zeta}} +  \frac{(4\sqrt{1-\beta_2}G + 2\eta L)\alpha^2}{\zeta}\right)} 
\end{aligned}
\end{equation}

by chosing $T=\gO(\eps^{-2})$, we have
\begin{equation}
\frac{1}{T}\sum_{t=1}^T\E\left[\left\|\nabla
F_{\mu}(\vtheta_t)\right\|\right] \leq \gO\left(\sqrt{\alpha}(\sqrt{\alpha} + \eps)\right)
\end{equation}

% \begin{equation}
% \begin{aligned}
% \E\left[\sqrt{\vv_{t,}}\left(F_{\mu}(\vtheta_{t+1}) - F_{\mu}(\vtheta_{t})\right)\right]
% \end{aligned}
% \end{equation}

% \begin{equation}
% \E\left[\vm_{t+1,i} | \gF_t\right] = \beta_1\vm_{t,i} + (1-\beta_1)\nabla_i F_{\mu}(\vtheta_t)
% \end{equation}

% \begin{equation}
% \begin{aligned}
% \E\left[\left|\vm_{t+1,i} - \E\left[\vm_{t+1,i} | \gF_t\right] \right|^2 \big| \gF_t\right] = (1-\beta_1)^2 \sigma^2
% \end{aligned}
% \end{equation}

% \begin{equation}
% \begin{aligned}
% \E\left[\left|\vm_{t+1,i} - \nabla_i F_{\mu}(\vtheta_t) \right|^2 \big| \gF_t\right] &= \E\left[\left|\vm_{t+1,i} - \E\left[\vm_{t+1,i} | \gF_t\right] + \E\left[\vm_{t+1,i} | \gF_t\right] - \nabla_i F_{\mu}(\vtheta_t) \right|^2 \big| \gF_t\right] \\[5pt]
% &= \E\left[\left|\vm_{t+1,i} - \E\left[\vm_{t+1,i} | \gF_t\right]\right|^2 \big|\gF_t\right] + \E\left[\left|\E\left[\vm_{t+1,i} | \gF_t\right] - \nabla_i F_{\mu}(\vtheta_t) \right|^2 \big| \gF_t\right] \\
% &\leq (1-\beta_1)^2 \sigma^2 + \left|(1-\beta_1)\sum_{\tau=0}^{t-1} \beta_1^{t-\tau} \left(\hat{\nabla}_i f(\vtheta_{\tau}) - \nabla_i F_{\mu}(\vtheta_t)\right) - \beta_1^{t+1}\nabla_i F_{\mu}(\vtheta_t)\right|^2 \\
% &\leq (1-\beta_1)^2 \sigma^2 + (1-\beta_1)\sum_{\tau=0}^{t-1} \beta_1^{t-\tau} \left|\hat{\nabla}_i f(\vtheta_{\tau}) - \nabla_i F_{\mu}(\vtheta_t)\right|^2 + \beta_1^{t+1}\left|\nabla_i F_{\mu}(\vtheta_t)\right|^2
% \end{aligned}
% \end{equation}