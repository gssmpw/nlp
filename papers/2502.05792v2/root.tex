%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8

\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  % Comment this line out if you need a4paper

%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4 paper

\IEEEoverridecommandlockouts                              % This command is only needed if 
                                                          % you want to use the \thanks command
\usepackage{dsfont}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[compress]{cite}

\newcommand{\ProcessModel}{\mathcal{P}}
\newcommand{\MeasurementModel}{\mathcal{M}}
\newcommand{\Dynamics}{f}
\newcommand{\Cost}{J}
\newcommand{\Constraint}{C}
\newcommand{\Predictor}{F}
\newcommand{\GameSolver}{\mathcal{G}}
\DeclareMathOperator*{\argmin}{argmin}


\overrideIEEEmargins                                      % Needed to meet printer requirements.

\title{\LARGE \bf
AToM: Adaptive Theory-of-Mind-Based Human Motion Prediction in Long-Term Human-Robot Interactions
}

\author{Yuwen Liao$^{1}$, Muqing Cao$^{1}$, Xinhang Xu$^{1}$, Lihua Xie$^{1}$, $\textsl{Fellow}$, $\textsl{IEEE}$% <-this % stops a space
\thanks{$^{1}$Authors are with the School of Electrical and Electronic Engineering, 
        Nanyang Technological University, Singapore.
        {\tt\small \{yuwen001, mqcao, xu0021ng, elhxie\}@ntu.edu.sg}}%
\thanks{This research is partially supported by the Centre for Advanced Robotics Technology Innovation (CARTIN) funded by the National Research Foundation of Singapore under its Medium-Sized Centre Scheme, and the Agency for Science, Technology and Research (A*STAR) of Singapore under the grant M21K1a0104.}%
}


\begin{document}

\maketitle
\thispagestyle{empty}
\pagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}

Humans learn from observations and experiences to adjust their behaviours towards better performance. 
Interacting with such dynamic humans is challenging, as the robot needs to predict the humans accurately for safe and efficient operations. 
Long-term interactions with dynamic humans have not been extensively studied by prior works. 
We propose an adaptive human prediction model based on the Theory-of-Mind (ToM), a fundamental social-cognitive ability that enables humans to infer others' behaviours and intentions. 
We formulate the human internal belief about others using a game-theoretic model, which predicts the future motions of all agents in a navigation scenario. 
To estimate an evolving belief, we use an Unscented Kalman Filter to update the behavioural parameters in the human internal model.
% To correct and develop this estimated belief, we use an Unscented Kalman Filter to update the behavioural parameters in the human internal model.
% The predicted human trajectories can be used in robot predictive planning, and the human-predicted robot trajectories reflect how the human infer the robot behaviours using ToM.
% We show that our model can generate accurate human predictions and provide unique interpretability to dynamic human behaviours. 
Our formulation provides unique interpretability to dynamic human behaviours by inferring how the human predicts the robot.
We demonstrate through long-term experiments in both simulations and real-world settings that our prediction effectively promotes safety and efficiency in downstream robot planning. Code will be available at https://github.com/centiLinda/AToM-human-prediction.git.

\end{abstract}

\input{1-introduction}

\input{2-related_work}

\input{3-methodology}

\input{4-experiments}

\section{CONCLUSIONS}

We have presented a novel reformulation of the classic ToM model on human motion prediction. By combining a game-theoretic model with dynamic parameter update, we build a human model that can predict and correct its beliefs about surrounding agents. Our prediction model integrates seamlessly with downstream robot planners and we demonstrate through simulations and real-world experiments that our model not only produces accurate predictions, but also results in safe and efficient robot plans. We rethink human modelling with a fundamental cognitive ability and AToM has provided new insights into long-term human-robot interactions. Future work aims to extend the behavioural parameters to model more complex interaction scenarios.

% \addtolength{\textheight}{-12cm}   % This command serves to balance the column lengths
                                  % on the last page of the document manually. It shortens
                                  % the textheight of the last page by a suitable amount.
                                  % This command does not take effect until the next page
                                  % so it should come on the page before the last. Make
                                  % sure that you do not shorten the textheight too much.

\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}
