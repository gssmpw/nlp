\documentclass[english,ruled]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{verbatim}
\usepackage{subcaption}
\usepackage{algorithm2e}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{geometry}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{setspace}
\makeatletter
\usepackage[toc,page,header]{appendix}
\usepackage{minitoc}
\usepackage{ifthen}
\newboolean{doublecolumn}
\setboolean{doublecolumn}{false}
\newboolean{arxiv}
\setboolean{arxiv}{true}
\usepackage{pgfplots}
\usepackage{pdflscape}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{authblk}
%\usepackage{showlabels}
\pgfplotsset{compat=1.15}

\setlength{\parindent}{0pt}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=2.4cm,rmargin=2.4cm}
\linespread{1.0}

%%%%%%%%%% Start TeXmacs macros
\newcommand{\assign}{:=}
\newcommand{\backassign}{=:}
\newcommand{\cdummy}{\cdot}
\newcommand{\tmtextbf}[1]{\text{{\bfseries{#1}}}}
\newcommand{\tmop}[1]{\ensuremath{\operatorname{#1}}}
\newcommand{\tmtextit}[1]{\text{{\itshape{#1}}}}
\newcommand{\maxf}[1]{\underset{#1}{\text{maximize}}}
\newcommand{\minf}[1]{\underset{#1}{\text{minimize}}}
\newcommand{\hdm}{{\texttt{HDM}}}
\newcommand{\hdmagd}{{\texttt{HDM-AGD}}}
\newcommand{\hdmhb}{{\texttt{HDM-HB}}}
\newcommand{\hdmbest}{{\texttt{HDM-Best}}}
\newcommand{\ogm}{{\texttt{OGD}}}
\newcommand{\bfgs}{{\texttt{BFGS}}}
\newcommand{\lbfgs}{{\texttt{L-BFGS}}}
\newcommand{\osgm}{{\texttt{OSGM}}}
\newcommand{\osgmrx}{\texttt{OSGM-R}}
\newcommand{\osgmrzx}{\texttt{OSGM-RZ}}
\newcommand{\osgmgx}{\texttt{OSGM-G}}
\newcommand{\osgmhx}{\texttt{OSGM-H}}
\newcommand{\gd}{{\texttt{GD}}}
\newcommand{\optdgd}{{\texttt{OptDiagGD}}}
\newcommand{\adagrad}{{\texttt{AdaGrad}}}
\newcommand{\adam}{{\texttt{Adam}}}
\newcommand{\sagd}{{\texttt{SAGD}}}
\newcommand{\agd}{{\texttt{AGD}}}
\newcommand{\mathd}{\mathrm{d}}
\newcommand{\nin}{\not\in}
\newcommand{\TODO}[1]{\textcolor{red}{TODO:  #1}}
%%%%%%%%%% End TeXmacs macros

\input{macros.tex}

\theoremstyle{plain}
\newtheorem{lem}{\protect\lemmaname}[section]
\theoremstyle{remark}
\newtheorem{rem}{\protect\remarkname}
\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}[section]
\theoremstyle{plain}
\newtheorem{prop}{\protect\propositionname}[section]
\providecommand{\corollaryname}{Corollary}
\theoremstyle{plain}
\newtheorem{coro}{\protect\corollaryname}[section]
\theoremstyle{plain}
\newtheorem{exple}{\protect\examplename}[section]
\theoremstyle{plain}
\newtheorem{definition}{\protect\definitionname}[section]

\providecommand{\lemmaname}{Lemma}
\providecommand{\remarkname}{Remark}
\providecommand{\theoremname}{Theorem}
\providecommand{\examplename}{Example}
\providecommand{\propositionname}{Proposition}
\providecommand{\definitionname}{Definition}

% cleveref
\crefdefaultlabelformat{#2\textbf{#1}#3} % <-- Only #1 in \textbf
\crefname{section}{\textbf{section}}{\textbf{sections}}
\Crefname{section}{\textbf{Section}}{\textbf{Sections}}
\crefname{thm}{\textbf{theorem}}{\textbf{theorems}}
\Crefname{thm}{\textbf{Theorem}}{\textbf{Theorems}}
\crefname{lem}{\textbf{lemma}}{\textbf{lemmas}}
\Crefname{lem}{\textbf{Lemma}}{\textbf{Lemmas}}
\crefname{prop}{\textbf{proposition}}{\textbf{propositions}}
\Crefname{prop}{\textbf{Proposition}}{\textbf{Propositions}}
\crefname{algorithm}{\textbf{algorithm}}{\textbf{algorithms}}
\Crefname{algorithm}{\textbf{Algorithm}}{\textbf{Algorithms}}
\crefname{coro}{\textbf{Corollary}}{\textbf{corollaries}}
\Crefname{coro}{\textbf{Corollary}}{\textbf{corollaries}}
\crefname{definition}{\textbf{Definition}}{\textbf{definitions}}
\Crefname{definition}{\textbf{Definition}}{\textbf{definitions}}
\crefname{table}{\textbf{Table}}{\textbf{tables}}
\Crefname{table}{\textbf{Table}}{\textbf{tables}}
\crefname{figure}{\textbf{Figure}}{\textbf{figures}}
\Crefname{figure}{\textbf{Figure}}{\textbf{figures}}

% Surrogate loss shorthand
\newcommand{\rk}{r_{k}}
\newcommand{\rxz}{r^z_{x}}
\newcommand{\rxkz}{r^z_{x^k}}

% Comments
\newcommand{\YC}[1]{ }
\renewcommand{\YC}[1]{\textcolor{blue}{[YC: #1]}}
\newcommand{\gwz}[1]{\textcolor{cyan}{[gwz: #1]}}
\begin{document}

\title{Provable and Practical Online Learning Rate Adaptation with Hypergradient Descent}

\author[1]{Ya-Chi Chu\thanks{ycchu97@stanford.edu}}
\author[2]{Wenzhi Gao\thanks{gwz@stanford.edu, equal contribution}}
\author[2,3]{Yinyu Ye\thanks{yyye@stanford.edu}}
\author[2,3]{Madeleine Udell\thanks{udell@stanford.edu}}
\affil[1]{Department of Mathematics, Stanford University}
\affil[2]{ICME, Stanford University}
\affil[3]{Department of Management Science and Engineering, Stanford University}

\maketitle

\input{abstract.tex}
\input{sec_intro.tex}
\input{sec_background.tex}
\input{sec_results.tex}
\input{sec_practical.tex}
\input{sec_exp.tex}
\input{sec_conclusion.tex}

\newpage 
\renewcommand \thepart{}
\renewcommand \partname{}

\bibliography{ref.bib}
\bibliographystyle{plain}

\doparttoc
\faketableofcontents
\part{}

\newpage
\appendix
\onecolumn

\addcontentsline{toc}{section}{Appendix}
\part{Appendix} 
\parttoc

\paragraph{Structure of the Appendix. } The appendix is organized as follows. In \Cref{app:hdmprac}, we introduce a practical variant of hypergradient descent and explain its implementation details. \Cref{app:additional} provides additional experiment details on the tested problems. \Cref{app:proof-hdm-ol} to \Cref{app:proof-momentum} provide proofs of the main results in the paper.

\newpage
\input{app_practical.tex}
\newpage
\input{app_proof.tex}
\input{app_addexp.tex}
\end{document}
