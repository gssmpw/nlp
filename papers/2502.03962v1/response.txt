\section{Related Work}
\label{related_works}
Neural Architecture Search (NAS) is the precursor of Quantum Architecture Search (QAS) within the domain of classical machine learning, which aims to automate the process of finding the architecture of artificial neural networks. According to these similarities, Zhang et al. **Zhang, "Differentiable Neural Architecture Search"** proposed a differentiable quantum architecture search inspired by the differentiable neural architecture search developed for NAS ____ . The same authors also developed a neural predictor-based method ____ . In this scenario, Du et al. **Du, “A Quantum Circuit Learning Approach to Designing Quantum Circuits”** proposed an algorithm composed of two main parts. First, it initializes a set of PQCs, called supernet, by uniformly sampling them within the constraint of a fixed number of qubits, types of gates, and maximum circuit depth. The supernet is equipped with a weight-sharing strategy and then trained. Second, all the circuits of the supernet are ranked in terms of performance and the best are fine-tuned. Notably, this algorithm has been tested through both simulations and real experiments. 

\noindent Although QAS and NAS are closely related, the quantum and classical models can substantially differ in generalization and fundamental structure. A meta-learning approach has also been proposed, involving the discovery of a meta-heuristic that combines topology and parameters, followed by an adaptation phase for new tasks. **Zhang et al., "Meta-Learning for Quantum Circuit Learning"**.

Evolutionary algorithms are also a promising approach to address QAS problems. The first attempt used genetic programming to find the quantum circuit implementing the quantum teleportation protocol ____ .  Li et al. **Li, “Genetic Algorithm for Quantum Adder Design”** implemented a genetic algorithm to find an approximate quantum circuit for quantum adders. Zhang et al. developed **Zhang et al., "Evolutionary-Based Quantum Architecture Search"** an evolutionary-based quantum architecture search assisted by the quantum Fisher information matrix to remove redundant parameters in PQCs. It has been tested on classification tasks of the MNIST dataset, with experiments with three and four qubits. Chivilikhin et al. **Chivilikhin et al., "Multi-Objective Optimization for Quantum Circuit Design"** proposed a multi-objective approach, composed of a genetic algorithm and an evolutionary strategy working on the topology and parameters of the PQC respectively. It has been tested on variational quantum eigensolvers for several molecules. Evolutionary algorithms present typical advantages of population-based and derivative-free approaches, which help the search to avoid local minima. At the same time, they can be expensive in terms of computational resources on large problems. 
The topology of the searched PQC may have significant differences by varying the problem domain or even only changing instances in the same domain. However, in some applications, PQCs may present repeating patterns. It has been shown that a hierarchical representation of quantum circuits can benefit the search for genetic algorithms on quantum machine-learning problems ____.

Reinforcement learning is also a promising approach for QAS as shown by different frameworks developed for deep reinforcement learning agents ____ . Those methods require a considerable amount of training data and computational resources. Moreover, deep reinforcement learning agents can easily get stuck in local minima as shown on the classical analogue NAS problems ____ . Recent advances in reinforcement learning also considered the effect of quantum noise in the QAS for the ground-state energy problem on three benchmark molecules ____.

Inspired by **Baker et al., "Evolutionary Computation for Neural Architecture Search"** , NAS problems have also been formulated in a tree representation to exploit Monte Carlo Tree Search (MCTS) techniques to design deep neural networks ____ . Analogously, Meng et al. **Meng et al., "Tree-Based Quantum Circuit Learning"** proposed a tree representation of QAS and employed MCTS to design PQCs for quantum chemistry and condensed matter physics. Subsequently, Wang et. al.  **Wang et al., "Nested Monte Carlo Tree Search for Quantum Circuit Design"** have generalized the method, which achieves remarkable results on a wide range of applications, including the ground state energy problem for three different molecules, a system of linear equations, and more.  The problem is formulated in a tree structure and a Nested MCTS (NMCTS) is employed for the search. Quantum circuits are sliced into a fixed number of empty layers and NMCTS fills them by choosing between a pre-defined pool of operations. Each layer of the quantum circuit corresponds to a tree level. The branching factor is given by the number of combinations that can be realized with the pool of operations. In this framework, an epoch is composed of the search technique acting on the topology of PQCs and a classical gradient-based technique acting on the angle parameters. This technique requires an expensive parameter optimization step at each epoch. Additionally, it requires fixing several hyperparameters that strongly affect the solution, such as the number of layers, which implicitly determines the number of gates in the PQC. However, these quantities are generally unknown and problem-dependent. Hence, an expensive hyperparameter tuning has to be performed on several quantities for any problem to find a suitable ansatz. 

This article addresses the key limitations encountered by MCTS approaches introducing a different tree-based action space formulation and some enhancements to the vanilla MCTS. We address the reader to Section \ref{mcts_qc} for the details. PWMCTS provides not only a higher level of automation but also significant improvements in the number of circuit evaluations required to design the PQC and its gates count (including CNOTs).