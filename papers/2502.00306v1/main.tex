

\newif\ifpreprintversion
\preprintversiontrue %

\ifpreprintversion
    \documentclass[sigconf]{acmart}
\else
    \documentclass[sigconf,anonymous]{acmart}
\fi

\AtBeginDocument{%
  \providecommand\BibTeX{{%
    Bib\TeX}}}

\setcopyright{acmlicensed}
\copyrightyear{2018}
\acmYear{2018}
\acmDOI{XXXXXXX.XXXXXXX}

\acmISBN{978-1-4503-XXXX-X/18/06}





\usepackage[capitalize,noabbrev]{cleveref}
\usepackage{multirow}
\usepackage[show]{chato-notes}
\usepackage{array}
\usepackage{makecell}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tcolorbox}

\tcbuselibrary{skins}

\newcommand{\eg}{e.g.,\xspace}
\newcommand{\ie}{i.e.,\xspace}
\newcommand{\etc}{etc.\xspace}
\newcommand\shortsection[1]{\vspace{6pt}{\noindent\textbf{#1.}}}
\newcommand\shortersection[1]{\vspace{6pt}{\noindent\em #1.}}

\newcommand{\ancomment}[1]{\textcolor{red}{\bf \small [ #1 --AN]}}
\newcommand{\ascomment}[1]{\textcolor{violet}{\bf \small [ #1 --AS]}}

\newcommand{\harshcomment}[1]{\textcolor{blue}{\bf \small [ #1 --Harsh]}}
\newcommand{\ypcomment}[1]{\textcolor{orange}{\bf \small [ #1 --YP]}}


\newcommand{\ourattack}{IA\xspace}
\newcommand{\ourattackfull}{\textit{Interrogation Attack}\xspace}

\begin{document}

\title{Riddle Me This! Stealthy Membership Inference for Retrieval-Augmented Generation}


\author{Ali Naseh$^{*\dagger}$}
\affiliation{%
  \institution{University of Massachusetts Amherst}
  \country{}
}

\author{Yuefeng Peng$^*$}
\affiliation{%
  \institution{University of Massachusetts Amherst}
  \country{}
}

\author{Anshuman Suri$^*$}
\affiliation{%
  \institution{Northeastern University}
  \country{}
}

\author{Harsh Chaudhari}
\affiliation{%
  \institution{Northeastern University}
  \country{}
}

\author{Alina Oprea}
\affiliation{%
  \institution{Northeastern University}
  \country{}
}

\author{Amir Houmansadr}
\affiliation{%
  \institution{University of Massachusetts Amherst}
  \country{}
}

\renewcommand{\shortauthors}{Naseh et al.}

\begin{abstract}
  Retrieval-Augmented Generation (RAG) enables Large Language Models (LLMs) to generate grounded responses by leveraging external knowledge databases without altering model parameters. Although the absence of weight tuning prevents leakage via model parameters, it introduces the risk of inference adversaries exploiting retrieved documents in the model's context.
  Existing methods for membership inference and data extraction often rely on jailbreaking or carefully crafted \emph{unnatural} queries, which can be easily detected or thwarted with query rewriting techniques common in RAG systems. In this work, we present \ourattackfull (\ourattack), a membership inference technique targeting documents in the RAG datastore. By crafting natural-text queries that are answerable only with the target document's presence, our approach demonstrates successful inference with just 30 queries while remaining stealthy; straightforward detectors identify adversarial prompts from existing methods up to ~$76\times$ more frequently than those generated by our attack.
  We observe a $2\times$ improvement in TPR@1\%FPR over prior inference attacks across diverse RAG configurations, all while costing less than $\$0.02$ per document inference.
\end{abstract}

\begin{CCSXML}
<ccs2012>
 <concept>
  <concept_id>00000000.0000000.0000000</concept_id>
  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
  <concept_significance>500</concept_significance>
 </concept>
 <concept>
  <concept_id>00000000.00000000.00000000</concept_id>
  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
  <concept_significance>300</concept_significance>
 </concept>
 <concept>
  <concept_id>00000000.00000000.00000000</concept_id>
  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
 <concept>
  <concept_id>00000000.00000000.00000000</concept_id>
  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
</ccs2012>
\end{CCSXML}






\ifpreprintversion
    \setcopyright{none}
    \settopmatter{printacmref=false} %
    \renewcommand\footnotetextcopyrightpermission[1]{} %
    \pagestyle{plain}
\fi


\maketitle


\setcopyright{none}
\settopmatter{printacmref=false} %
\renewcommand\footnotetextcopyrightpermission[1]{} %
\pagestyle{plain}



\renewcommand{\thefootnote}{}
\footnotetext{$^*$ Equal Contribution}
\footnotetext{$^\dagger$ Correspondence to anaseh@cs.umass.edu}

\input{sections/01_intro}
\input{sections/02_threat_model}
\input{sections/03_existing_works}
\input{sections/03_methodology}
\input{sections/04_experiments}
\input{sections/06_ablation_study}
\input{sections/05_discussion}
\input{sections/09_conclusion}


\section*{Acknowledgments}
This work has been supported by the NSF grants CNS-2247484 and CNS-2131910, as well as by the NAIRR 240392.

\bibliographystyle{ACM-Reference-Format}
\bibliography{main}


\appendix
\input{appendix/A1_detection_setup}
\input{appendix/A2_query_generation}
\input{appendix/A3_llama}
\input{appendix/A4_no_rewrite}
\input{appendix/A5_prompts}
\input{appendix/A6_failed_examples}
\input{appendix/A7_rocs}

\end{document}
