\begin{table*}[h!]
\centering
\label{tab:main_res_all}
\begin{tabular}{lll|ccccc}
\toprule
\multirow{2}{*}{\textbf{Dataset}} &
  \multirow{2}{*}{\textbf{Generator}} &
  \multirow{2}{*}{\textbf{Attack Method}} &
  \multirow{2}{*}{\textbf{AUC}} &
  \multicolumn{1}{c}{\multirow{2}{*}{\textbf{Accuracy}}} &
  \multicolumn{3}{c}{\textbf{TPR@FPR}} \\
 &
   &
   &
   &
  \multicolumn{1}{c}{} &
  \textbf{FPR=0.005} &
  \textbf{FPR=0.01} &
  \textbf{FPR=0.05} \\
\midrule
\multirow{16}{*}{NFCorpus} &
  \multirow{4}{*}{Phi4-14B} & 
  RAG-MIA \citep{anderson2024my} & - & 0.530 & - & - & - \\
  \multicolumn{1}{c}{} & & 
  S$^2$MIA \citep{li2024generating} & 0.790 & 0.696 & 0.164 & 0.208 & 0.379 \\
  \multicolumn{1}{c}{} & & 
  MBA \citep{liu2024mask} & 0.793 & 0.758 & 0.204 & 0.265 & 0.513\\
  \multicolumn{1}{c}{} & & 
  \textbf{\ourattack (Ours)} & \textbf{0.992} & \textbf{0.945} & \textbf{0.706} & \textbf{0.897} & \textbf{0.980} \\
  \cline{3-8} 
  &  \multirow{4}{*}{Llama3.1-8B} &
  RAG-MIA \citep{anderson2024my} &
  - & 0.729 & - & - & - \\
 &
   &
  S$^2$MIA \citep{li2024generating} & 0.753 & 0.668 & 0.183 & 0.213 & 0.349 \\
 &
   &
  MBA \citep{liu2024mask} & 0.852 & 0.782 & \textbf{0.279} & 0.370 & 0.614 \\
 &
   &
  \textbf{\ourattack (Ours)} & \textbf{0.966} & \textbf{0.913} & 0.205 & \textbf{0.507} & \textbf{0.761} \\
  \cline{3-8}
 &
  \multirow{4}{*}{CommandR-7B} &
  RAG-MIA \citep{anderson2024my} &
  - &
   &
  - &
  - &
  - \\
 &
   &
  S$^2$MIA \citep{li2024generating} &
  0.687 &
  0.604 &
  0.091 &
  0.107 &
  0.229 \\
 &
   &
  MBA \citep{liu2024mask} &
  0.741 &
  0.697 &
  0.077 &
  0.143 &
  0.406 \\
 &
   &
  \textbf{\ourattack (Ours)} &
  \textbf{0.991} &
  \textbf{0.949} &
  \textbf{0.422} &
  \textbf{0.833} &
  \textbf{0.977} \\
  \cline{3-8}
 &
  \multirow{4}{*}{Gemma2-2B} &
  RAG-MIA \citep{anderson2024my} &
  - & 0.543 & - & - & - \\
 &
   &
  S$^2$MIA \citep{li2024generating} &
  0.759 & 0.627 & 0.037 & 0.051 & 0.149 \\
 &
   &
  MBA \citep{liu2024mask} &
  0.710 & 0.665 & 0.073 & 0.157 & 0.380 \\
 &
   &
  \textbf{\ourattack (Ours)} &
   \textbf{0.984} & \textbf{0.939} & \textbf{0.459} & \textbf{0.616} & \textbf{0.932} \\
\midrule
\multirow{16}{*}{TREC-COVID} &
  \multirow{4}{*}{Phi4-14B} & 
  RAG-MIA \citep{anderson2024my} & - & 0.541 & - & - & - \\
  \multicolumn{1}{c}{} & & 
  S$^2$MIA \citep{li2024generating} & 0.769 & 0.682 & 0.132 & 0.183 & 0.352 \\
  \multicolumn{1}{c}{} & & 
  MBA \citep{liu2024mask} & 0.761 & 0.739 & 0.193 & 0.290 & 0.497\\
  \multicolumn{1}{c}{} & & 
  \textbf{\ourattack (Ours)} & \textbf{0.968} & \textbf{0.909} & \textbf{0.279} & \textbf{0.519} & \textbf{0.841}  \\
  \cline{3-8} 
  & \multirow{4}{*}{Llama3.1-8B} &
  RAG-MIA \citep{anderson2024my} &
  - & 0.766 & - & - & - \\
 &
   &
  S$^2$MIA \citep{li2024generating} & 0.704 & 0.625 & 0.123 & 0.153 & 0.282 \\
 &
   &
  MBA \citep{liu2024mask} &
  0.850 & 0.830 & \textbf{0.340} & \textbf{0.478} & \textbf{0.683} \\
 &
   &
  \textbf{\ourattack (Ours)} & \textbf{0.927} & \textbf{0.839} & 0.068 & 0.292 & 0.513 \\
  \cline{3-8}
 &
  \multirow{4}{*}{CommandR-7B} &
  RAG-MIA \citep{anderson2024my} &
  - &
  0.517 &
  - &
  - &
  - \\
 &
   &
  S$^2$MIA \citep{li2024generating} &
  0.680 & 0.604 & 0.030 & 0.103 & 0.213 \\
 &
   &
  MBA \citep{liu2024mask} &
  0.751 & 0.706 & \textbf{0.167} & 0.243 & 0.466 \\
 &
   &
  \textbf{\ourattack (Ours)} &
   \textbf{0.963} & \textbf{0.903} & 0.125 & \textbf{0.297} & \textbf{0.793}
   \\
   \cline{3-8}
 &
  \multirow{4}{*}{Gemma2-2B} &
  RAG-MIA \citep{anderson2024my} &
  - & 0.528 & - & - & - \\
 &
   &
  S$^2$MIA \citep{li2024generating} &
   0.710 & 0.595 & 0.008 & 0.021 & 0.156\\
 &
   &
  MBA \citep{liu2024mask} &
  0.721 & 0.704 & 0.193 & 0.254 & 0.434 \\
 &
   &
  \textbf{\ourattack (Ours)} &
   \textbf{0.954} & \textbf{0.886} & \textbf{0.218} & \textbf{0.259} & \textbf{0.710} \\
\midrule
\multicolumn{1}{c}{\multirow{16}{*}{SCIDOCS}} &
  \multirow{4}{*}{Phi4-14B} & 
  RAG-MIA \citep{anderson2024my} & - & 0.550 & - & - & - \\
  \multicolumn{1}{c}{} & & 
  S$^2$MIA \citep{li2024generating} & 0.825 & 0.733 & 0.219 & 0.277 & 0.456\\
  \multicolumn{1}{c}{} & & 
  MBA \citep{liu2024mask} & 0.837 & 0.832 & 0.564 & 0.588 & 0.699\\
  \multicolumn{1}{c}{} & & 
  \textbf{\ourattack (Ours)} & \textbf{0.995} & \textbf{0.962} & \textbf{0.826} & \textbf{0.887} & \textbf{0.998} \\
  \cline{3-8}
\multicolumn{1}{c}{} &
\multirow{4}{*}{Llama3.1-8B} &
  RAG-MIA \citep{anderson2024my} &
  - &
  0.814 &
  - &
  - &
  - \\
\multicolumn{1}{c}{} & &
  S$^2$MIA \citep{li2024generating} &
  0.745 &
  0.651 &
  0.169 &
  0.207 &
  0.310 \\
\multicolumn{1}{c}{} &
   &
  MBA \citep{liu2024mask} &
  0.909 &
  0.903 &
  \textbf{0.700} &
  \textbf{0.798} &
  0.856 \\
\multicolumn{1}{c}{} &
   &
  \textbf{\ourattack (Ours)} &
  \textbf{0.978} &
  \textbf{0.936} &
  0.387 &
  0.672 &
  \textbf{0.880} \\
  \cline{3-8}
\multicolumn{1}{c}{} &
  \multirow{4}{*}{CommandR-7B} &
  RAG-MIA \citep{anderson2024my} &
  - &
  0.538 &
  - &
  - &
  - \\
\multicolumn{1}{c}{} &
   &
  S$^2$MIA \citep{li2024generating} &
  0.683 &
  0.619 &
  0.109 &
  0.127 &
  0.263 \\
\multicolumn{1}{c}{} &
   &
  MBA \citep{liu2024mask} &
  0.816 &
  0.792 &
  0.346 &
  0.435 &
  0.617 \\
\multicolumn{1}{c}{} &
   &
  \textbf{\ourattack (Ours)} &
  \textbf{0.994} &
  \textbf{0.947} &
  \textbf{0.827} &
  \textbf{0.909} &
  \textbf{0.985} \\
  \cline{3-8}
\multicolumn{1}{c}{} &
  \multirow{4}{*}{Gemma2-2B} &
  RAG-MIA \citep{anderson2024my} &
  - & 0.530  & - & - & - \\
\multicolumn{1}{c}{} &
   &
  S$^2$MIA \citep{li2024generating} &
  0.785 & 0.656 & 0.037 &  0.070 & 0.262 \\
\multicolumn{1}{c}{} &
   &
  MBA \citep{liu2024mask} &
  0.727 &
  0.722 &
  0.304 &
  0.396 &
  0.493 \\
\multicolumn{1}{c}{} &
   &
  \textbf{\ourattack (Ours)} &
  \textbf{0.991} &
  \textbf{0.944} &
  \textbf{0.664} &
  \textbf{0.760} &
  \textbf{0.962} \\
\bottomrule
\end{tabular}
\vspace{2mm}
\caption{Attack Performance across multiple datasets and LLMs as generators in the RAG system, when query-rewriting is used. GTE is used as the retriever. Our attack consistently outperforms prior works while being undetectable.}
\vspace{2mm}
\end{table*}
