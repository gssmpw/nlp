\documentclass[11pt]{article}

\usepackage{stylesheet}

\title{Stochastic trace estimation for parameter-dependent matrices applied to spectral density approximation}

\author{Fabio Matti\thanks{Institute of Mathematics, EPFL, 1015 Lausanne, Switzerland. {\textbf{(\href{mailto:fabio.matti@epfl.ch}{fabio.matti}, \href{mailto:haoze.he@epfl.ch}{haoze.he}, \href{mailto:daniel.kressner@epfl.ch}{daniel.kressner}, \href{mailto:hysan.lam@epfl.ch}{hysan.lam})@epfl.ch}}.}
\and Haoze He\footnotemark[1]
\and Daniel Kressner\footnotemark[1]
\and Hei Yin Lam\footnotemark[1]}

\begin{document}

\maketitle

\begin{abstract}
    Stochastic trace estimation is a well-established tool for approximating the trace of a large symmetric matrix $\mtx{B}$. Several applications involve a matrix that depends continuously on a parameter $t \in [a,b]$, and require trace estimates of $\mtx{B}(t)$ for many values of $t$. This is, for example, the case when approximating the spectral density of a matrix. Approximating the trace separately for each matrix
    $\mtx{B}(t_1), \dots, \mtx{B}(t_m)$ clearly incurs redundancies and a cost that scales linearly with $m$. To address this issue, we propose and analyze modifications for three stochastic trace estimators, the Girard-Hutchinson, Nyström, and Nyström++ estimators. Our modification uses \emph{constant} randomization across different values of $t$, that is,
    every matrix $\mtx{B}(t_1), \dots, \mtx{B}(t_m)$ is multiplied with the \emph{same} set of random vectors.
    When combined with Chebyshev approximation in $t$, the use of such constant random matrices allows one to reuse matrix-vector products across different values of $t$, leading to significant cost reduction.
    Our analysis shows that the loss of stochastic independence across different $t$ does not lead to deterioration. In particular, we show that $\mathcal{O}(\varepsilon^{-1})$ random matrix-vector products suffice to ensure an error of $\varepsilon > 0$ for Nyström++, independent of low-rank properties of $\mtx{B}(t)$. We discuss in detail how the combination of Nyström++ with 
    Chebyshev approximation applies to spectral density estimation and provide an analysis of the resulting method. This  improves various aspects of an existing stochastic estimator for spectral density estimation. Several numerical experiments from electronic structure interaction, statistical thermodynamics, and neural network optimization validate our findings.
\end{abstract}

\input{intro.tex}
\input{analysis.tex}
\input{spectraldensity.tex}
\input{numresults.tex}
\input{conclusion.tex}

\paragraph{Acknowledgements.} The authors gratefully acknowledge the help of Lin Lin in reproducing the example in \refsec{subsec:hamiltonian}. They thank David Persson for many enlightening discussions relating the proof in \refsec{subsec:nystrom-pp}.

\printbibliography

\input{appendix.tex}

\end{document}
