\section{Related work}
\label{Section2}
Numerous studies have explored potential privacy leaks from devices to enhance user data security and privacy. These studies are categorized into \textit{static analysis, dynamic taint-based analysis,} and \textit{dynamic network-based analysis}. Table \ref{comparison} compares sensitive data detection methods across various dimensions: category, use of ML (parametric or non-parametric models), need for prior feature selection, techniques or classifiers used, and evaluation metrics. Parametric models summarize data with a fixed set of parameters, independent of the number of training examples, while non-parametric models adapt to any functional form from the training data.
\subsection{Static analysis}
Static analysis of application source code helps to identify potential behaviors, such as accessing sensitive user data\cite{leakminer}, by decompiling the app and analyzing its source code without execution. A control flow graph maps out all possible paths that might be followed within an application program from sources, where sensitive data is read or introduced, to sinks, where this data is written out or transmitted.

Liu et al. \cite{liu} developed a system to de-escalate ad library privileges using bytecode analysis. AndroidLeaks \cite{androidleaks} mapped Android API methods to permissions and detected privacy leaks using dataflow analysis. Wongwiwatchai et al. \cite{lightweight} utilized lightweight static features to develop a classification model for identifying mobile applications that transmit PII. Their approach incorporated six machine learning algorithms: Neural Network (NN), Logistic Regression (LR), Support Vector Machine (SVM), Naive Bayes (NB), k-Nearest Neighbor (kNN), and Random Forest (RF).

However, static analysis can only suggest potential privacy violations and may yield false positives, as it lacks contextual understanding and cannot observe actual runtime behaviors. Therefore, it is often complemented by dynamic analysis to validate the findings.
\subsection{Dynamic analysis}
Dynamic analysis studies an application's runtime behavior by executing it in a controlled environment. It can be further divided into two types:
\subsubsection{Taint analysis}
Taint analysis is a type of dynamic analysis to study an executing app, by marking/tainting certain pieces of data from some points in the program (\textit{Taint Sources}) as they enter the program. This tainted data is then tracked throughout the program's execution to see how it propagates and influences other data (\textit{Taint Propagation}). The goal is to identify and monitor the paths through which sensitive or untrusted data flows (\textit{Taint Sinks}), ensuring that it does not end up in insecure or unintended locations. For instance, Enck et al. \cite{taintdroid} employed this method to monitor private sensitive information on smartphones. However, taint analysis method may be inefficient and vulnerable to control flow attacks \cite{50ways}. Scaling dynamic analysis to handle thousands of apps requires automated execution and behavioral reporting, but some code paths may be missed, providing a lower bound for app behaviors without false positives.

\subsubsection{Network-based analysis}
Network-based analysis monitors network traffic during app execution. Interaction with the app can be manual or automated using tools like UI/Application Exerciser Monkey \cite{monkey}. Network traffic is captured via a proxy server and analyzed through techniques such as string matching and ML.

ReCon\cite{recon} used C4.5-based DT to detect leaks for random users in a centralized manner. They employed a BOW model for feature extraction, using certain characters as separators to identify words. Network flows/packets were represented by binary vectors indicating word presence/absence. Heuristics such as removing features with low word frequency reduced feature count, oversampling ensured inclusion of rare PII words, and tf-idf excluded common words. Per-domain-and-OS classifiers were built, with a general classifier for domains with few samples. PII values were randomized during training to prevent model reliance on them. On the other hand, AntShield \cite{antsh} performs efficient on-device analysis using a hybrid string matching-classification approach. The AntMonitor Library \cite{antmo} intercepts packets in real-time, searching for predefined strings, and then builds classifiers for unknown PII. It uses the Binary Relevance (BR) method for multi-label classification, training separate binary classifiers for each label and employing C4.5 DT models as independent classifiers in the BR framework.

Kohli et al. \cite{ants} extended ReCon's work and proposed different variations in DT and NN models for detecting PII in network traffic. Authors used explainable AI (XAI) algorithm, SHAP to provide explanations of results and re-trained best performing models using important features selected by SHAP. Kohli et al. \cite{SPCOM} further explored the use of various feature selection and filtering techniques for improving the performance of \cite{ants} framework and used XAI algorithm LIME to explain and further improve detection framework's accuracy.

To enhance privacy in PII handling, MobiPurpose \cite{mobipurpose} parses traffic request into key-value pairs, infers data types using a bootstrapping NLP approach, and identifies data collection purposes with a supervised Bayesian model. Bakopoulou et al. \cite{fedpacket} introduced a federated learning approach for mobile packet classification, allowing devices to train a global federated SVM model without sharing raw sensitive data. 

Table \ref{comparison} summarizes works that mostly use dynamic network-based methods with prior feature selection to enhance model performance. Various classifiers are employed, from traditional ML models (SVM, DT) to advanced frameworks like NN and federated learning. Common metrics include accuracy, precision, recall, and F1 score, while taint analysis uses specialized metrics like operation time (application loading, making a phone call, etc) and IPC time to measure overhead. Some studies also consider network performance and battery consumption, which is particularly relevant for mobile apps.
\begin{figure*}
    \centering
    \includegraphics[width=\textwidth,height=0.27\textwidth]{figs/fttrans_arch.drawio.pdf}
    \caption{FT-transformer architecture}
    \label{ftransarc}
\end{figure*}

Our work falls into the category of dynamic network-based analysis, where we intercept network flows to detect PII leakage. Note that the interception of mobile traffic is not part of our contribution but is instead orthogonal to our approach. Most works in this category use ML and rely on prior feature selection strategies. With an intuition that instead of employing different feature selection techniques, can we build a model/framework that is capable enough to capture complex patterns in the input dataset without the aid of any external feature processing algorithms. Therefore, in this work we use DL and propose an end-to-end model to detect PII ex-filtration in mobile applications. In the next section, we present preliminaries and related background knowledge on the techniques used in this work.