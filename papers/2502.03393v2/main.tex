%%%%%%%% ICML 2025 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%%

\documentclass{article}

\usepackage[preprint]{neurips_2024}

\title{CAPE: Covariate-Adjusted Pre-Training for Epidemic Time Series Forecasting}

\author{%
  Zewen Liu \\
  Department of Computer Science\\
  Emory University\\
  Atlanta, Georgia \\
  \texttt{zewen.liu@emory.edu} \\
  \And
  Juntong Ni \\
  Department of Computer Science\\
  Emory University\\
  Atlanta, Georgia \\
  \texttt{juntong.ni@emory.edu} \\
  \And
  Max S. Y. Lau \\
  Emory University \\
  Rollins School of Public Health \\
  Atlanta, Georgia \\
  \texttt{msy.lau@emory.edu} \\
  \And
  Wei Jin \\
  Department of Computer Science\\
  Emory University\\
  Atlanta, Georgia \\
  \texttt{wei.jin@emory.edu} \\
}


% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} % forprofessional tables
\usepackage{amssymb}
\usepackage{color}
\usepackage{xcolor,colortbl}
% \usepackage[table]{xcolor}        % 用于表格着色
% \usepackage{siunitx}              % 用于数值对齐
\usepackage{multirow}             % 用于跨行
\usepackage{graphicx}             % 用于调整表格大小
\usepackage[normalem]{ulem}       % 用于下划线
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{paralist}
\usepackage{enumitem}
\usepackage{amsthm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}


\usepackage[normalem]{ulem}
\usepackage{tabularx}

\definecolor{low1}{RGB}{255, 204, 204}    % 红色浅色
\definecolor{low3}{RGB}{255, 255, 204}    % 黄色浅色
\definecolor{low2}{RGB}{204, 255, 204}    % 绿色浅色

\usepackage{hyperref}


\newcommand{\theHalgorithm}{\arabic{algorithm}}

\usepackage{soul}

% For theorems and such
\usepackage{amsmath}
\usepackage{mathtools}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}
\usepackage[textsize=tiny]{todonotes}

\newcommand{\wei}[1]{\textcolor{orange}{\#Wei:~#1\#}}
\newcommand{\zw}[1]{\textcolor{blue}{\#Zewen:~#1\#}}
\newcommand{\juntong}[1]{\textcolor{red}{\#Juntong:~#1\#}}


\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors





\begin{document}
\maketitle


%----------------------------------------------------------------------------------------------


\begin{abstract}

% Modeling the dynamics of epidemic spreading to provide accurate forecasting has been a crucial problem in protecting public health. While previous research has shown great potential for data-driven methods, the sparsity of data and lack of context of environments hinder the learning of actual underlying patterns, making the model hard to adapt to temporal distribution shifts. To address these challenges, we propose \textbf{CAPE}, a \textbf{c}ovariate-\textbf{a}djusted \textbf{r}epresentation \textbf{l}earning framework that utilizes pre-training and contrastive learning to learn the underlying environment representations, providing adjusted predictions. We gather and create an epidemic pile with over 21 distinct disease types across more than 60 regions for pre-training and testing our model. Pre-training not only deals with the sparsity of data in the downstream task, but also aid in the learning of comprehensive environments which can be unseen in the downstream training set, thereby mitigating the influence brought by temporal distribution shifts. Extensive experiments show the effectiveness of the proposed CAPE framework in full-shot, few-shot, and zero-shot settings.

% Accurate forecasting of epidemic transmission dynamics is essential for safeguarding public health. While data-driven methods have demonstrated significant potential, challenges such as data sparsity and the lack of contextual environmental information hinder the learning of actual underlying patterns, limiting these methods' ability to adapt to temporal distribution shifts. To address these issues, we propose \textbf{CAPE} (\textbf{C}ovariate-\textbf{A}djusted \textbf{P}retraining for \textbf{E}pidemic forecasting), a framework that leverages pre-training and contrastive learning to capture underlying environment representations, thereby enabling adjusted and more accurate predictions. For the development and evaluation of our model, we compiled an extensive dataset encompassing 21 distinct diseases across over 60 regions. The pre-training process not only mitigates data sparsity in downstream tasks but also facilitates the learning of comprehensive environmental contexts. This approach effectively reduces the impact of temporal distribution shifts on model performance. Extensive experiments show the efficacy of the proposed \textbf{CAPE} framework across full-shot, few-shot, and zero-shot settings, highlighting the robustness and adaptability in various forecasting scenarios.

% Accurate forecasting of epidemic transmission dynamics is essential for safeguarding public health. However, the observed epidemic time series data is usually limited in length and the inherited dynamics of diseases are entangled with the environmental influence, hindering the learning of data-driven methods trained for specific diseases and regions. To address these limitations and utilize valuable insights from past outbreaks, we propose \textbf{CAPE} (\textbf{C}ovariate-\textbf{A}djusted \textbf{P}retraining for \textbf{E}pidemic forecasting), a framework that leverages pre-training and hierarchical environment contrasting to capture the universal patterns from the past outbreaks as well as the underlying environment representations, thereby enabling adjusted and more accurate predictions. For the development and evaluation of our model, we compiled an extensive dataset encompassing 21 distinct diseases across over 60 regions. The pre-training process not only mitigates data sparsity in downstream tasks but also facilitates the learning of comprehensive environmental contexts. This approach effectively reduces the impact of temporal distribution shifts on model performance. Extensive experiments show the efficacy of the proposed \textbf{CAPE} framework across full-shot, few-shot, and zero-shot settings, highlighting the robustness and adaptability in various forecasting scenarios.

Accurate forecasting of epidemic infection trajectories is crucial for safeguarding public health. However, limited data availability during emerging outbreaks and the complex interaction between environmental factors and disease dynamics present significant challenges for effective forecasting. 
In response, we introduce CAPE, a novel epidemic pre-training framework designed to harness extensive disease datasets from diverse regions and integrate environmental factors directly into the modeling process for more informed decision-making on downstream diseases. Based on a covariate adjustment framework, CAPE utilizes pre-training combined with hierarchical environment contrasting to identify universal patterns across diseases while estimating latent environmental influences. We have compiled a diverse collection of epidemic time series datasets and validated the effectiveness of CAPE under various evaluation scenarios, including full-shot, few-shot, zero-shot, cross-location, and cross-disease settings, where it outperforms the leading baseline by an average of 9.9\% in full-shot and 14.3\% in zero-shot settings. 
The code will be released upon acceptance.


% While pre-training helps mitigate the impact of data sparsity in downstream tasks, environment modeling effectively uncovers the inherited disease infection dynamics and reduces the impact of temporal distribution shifts on model performance. We developed and evaluated our model using an extensive dataset covering 21 diseases across over 60 regions. During the evaluation, \textbf{CAPE} surpasses the best baseline by an average of 9.9\% in the full-shot setting and 18.1\% in the zero-shot setting across the downstream datasets, demonstrating the effectiveness of the proposed framework.


% However, epidemic time series data are typically scarce during novel outbreaks, and the disease infection dynamics are heavily influenced by environmental factors, causing distribution shifts between the training and test sets. These challenges hinder the effectiveness of data-driven models that are trained on specific diseases and regions. To address these limitations and leverage insights from past outbreaks, we propose \textbf{CAPE} (\textbf{C}ovariate-\textbf{A}djusted \textbf{P}retraining for \textbf{E}pidemic forecasting). CAPE leverages pre-training and hierarchical environment contrasting to capture universal patterns and underlying environmental representations. While pre-training helps mitigate the impact of data sparsity in downstream tasks, environment modeling effectively uncovers the inherited disease infection dynamics and reduces the impact of temporal distribution shifts on model performance. We developed and evaluated our model using an extensive dataset covering 21 diseases across over 60 regions. During the evaluation, \textbf{CAPE} surpasses the best baseline by an average of 9.9\% in the full-shot setting and 18.1\% in the zero-shot setting across the downstream datasets, demonstrating the effectiveness of the proposed framework.


\end{abstract}

\input{sections/intro}

\input{sections/related_work}

\input{sections/prelim}

\input{sections/method_3}
% \input{sections/method}

\input{sections/experiment}

\input{sections/conclusion}

\input{sections/impact}

\bibliography{ref}
\bibliographystyle{icml2025}
% \onecolumn

\appendix
\input{sections/appendix}

\end{document}

