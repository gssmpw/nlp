\documentclass{article}
\usepackage{tcolorbox}
\usepackage{caption} % For captions
\usepackage{lipsum} % For placeholder text, can be removed

% Define the custom chat bubble style
\tcbuselibrary{skins, breakable}
\newtcolorbox{chatbubble}[1][]{
    enhanced,
    breakable,
    colback=gray!5,  % Background color
    colframe=gray!60, % Border color
    fonttitle=\bfseries,
    boxrule=0.5mm,    % Border thickness
    width=\columnwidth, % Full text width
    arc=8mm,          % Rounded corners
    title=#1,
    overlay={ % Draw the circle at the bottom right, outside the border
        \fill[gray!60]
          (frame.south east) ++(-0mm,-0mm) circle (2mm); % Adjust the position and size as needed
    }
}

% Define a new counter for chat listings
\newcounter{chatlisting}
\renewcommand{\thechatlisting}{Chat Listing \arabic{chatlisting}}

% Define the chat group environment
\newenvironment{chatgroup}[1]{%
    \refstepcounter{chatlisting} % Increment chat listing counter
    \begin{tcolorbox}[colback=white, colframe=white, boxrule=0pt, enhanced jigsaw, breakable]%
    \gdef\chatcaption{#1}% Use \gdef to globally define \chatcaption
}{%
    \end{tcolorbox}%
    \vspace{-2mm}\captionsetup{type=figure}\caption*{\thechatlisting: \expandafter\strip\chatcaption}%
}

\begin{document}

\begin{chatbubble}
This is a sample chat bubble with rounded edges and a small circle at the bottom right corner, outside the main border. It stretches to the full width of the text area and can contain any text you want. You can also add a title at the top if needed.
\end{chatbubble}

\begin{chatgroup}{This is the caption for the first group of chat bubbles.}
    \begin{chatbubble}
    This is the first chat bubble in the group.
    \end{chatbubble}

    \begin{chatbubble}
    This is the second chat bubble in the group.
    \end{chatbubble}

    \begin{chatbubble}
    This is the third chat bubble in the group.
    \end{chatbubble}
\end{chatgroup}

\end{document}
