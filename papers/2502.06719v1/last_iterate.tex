\begin{lemma}
\label{lem:bound_last_iter_second_moment}
Assume \Cref{ass:L-smooth}, \Cref{ass:noise_decomposition}($2$), \Cref{ass:hessian_Lipschitz_ball} and  \Cref{ass:step_size}. Then for any $k \in \nset$ it holds that 
\begin{equation}
\label{eq:bound_last_iter_second_moment}
\PE[\norm{\theta_k - \thetas}^{2}] \leq C_{1} \exp\biggl\{-\frac{\mu c_0}{4} (k+k_0)^{1-\gamma}\biggr\} \bigl[ \norm{\theta_0-\thetas}^2 + \sigma_2^2\bigr] + C_{2} \sigma_2^2 \alpha_{k}  \eqsp,
\end{equation}
where $\sigma_2^2$ is defined in \Cref{ass:noise_decomposition}($2$), and the constants $C_1$ and $C_2$ are given by 
\begin{equation}
\label{eq:const_C_1_C_2_def}
\begin{split}
C_{1} &= \exp\biggl\{\frac{3\mu c_0}{4(1-\gamma)}k_0^{1-\gamma}\biggr\}\biggl(\left(1 + L_2^{-2}\right) \exp\biggl\{\frac{6c_0^2L_2^2}{2\gamma-1}\biggr\} + \frac{2c_{0}^2}{2\gamma-1}\biggr) \eqsp,\\
C_{2} &= \frac{2^{1+\gamma}}{\mu}\eqsp.
\end{split}
\end{equation}
\end{lemma}
\begin{proof}
From \eqref{eq:sgd_recursion_main} and \cref{ass:noise_decomposition} it follows that 
    \begin{equation}
        \norm{\theta_k-\thetas}^2 = \norm{\theta_{k-1}-\thetas}^2-2\alpha_k\langle \theta_{k-1}-\thetas , \nabla f(\theta_{k-1})+\zeta_k\rangle + \alpha_k^2\norm{\nabla f(\theta_{k-1})+\zeta_k}^2.
    \end{equation}
    Using \Cref{ass:L-smooth} and \Cref{ass:noise_decomposition}($2$), we obtain
    \begin{align}
    2\alpha_k\PE[\langle \theta_{k-1}-\thetas , \nabla f(\theta_{k-1})+\zeta_k\rangle|\mathcal{F}_{k-1}]
    &= 2\alpha_k\langle \theta_{k-1}-\thetas , \nabla f(\theta_{k-1})-\nabla f(\thetas) \rangle.     
    \end{align}
    Using \Cref{ass:noise_decomposition}($2$) and \Cref{ass:L-smooth}, we get 
    \begin{align}
        \PE[\norm{\nabla f(\theta_{k-1})+\zeta_k}^2|\mathcal{F}_{k-1}] 
        &= \norm{\nabla f(\theta_{k-1})-\nabla f(\thetas)}^2 + \PE[\norm{\eta(\xi_k) + g(\theta_{k-1}, \xi_k)}^2|\mathcal{F}_{k-1}] \\ &\leq  L_1 \pscal{\nabla f(\theta_{k-1}) - \nabla f(\thetas)}{\theta_{k-1}- \thetas} + 2L_2^2 \norm{\theta_{k-1}-\thetas}^2 + 2\sigma_2^2\eqsp.
    \end{align}

  Combining the above inequalities, we obtain 
   \begin{equation}
   \label{eq:recursion_second_moment}
       \PE [\norm{\theta_k-\thetas}^2]\leq (1-\mu \alpha_k (2 - \alpha_k L_1) +2 \alpha_k^2 L_2^2))\PE[\norm{\theta_{k-1}-\thetas}^2]+2\alpha_k^2\sigma_2^2.
    \end{equation}
    By applying the recurrence \eqref{eq:recursion_second_moment}, we obtain that 
    \begin{align}
         \PE[\norm{\theta_k-\thetas}^2] 
         \leq A_{1,k} \norm{\theta_0-\thetas}^2 + 2 \sigma_2^2 A_{2,k}\eqsp, 
    \end{align}
where we have set 
\begin{equation}
\label{eq:A_1_2_k_def}
\begin{split}
A_{1,k} &= \prod_{i=1}^k(1- (3/2)\alpha_i\mu+2 \alpha_i^2 L_2^2)\eqsp, \\
A_{2,k} &= \sum_{i=1}^k\prod_{j=i+1}^k(1-(3/2) \alpha_j\mu+2\alpha_j^2 L_2^2)\alpha_i^2\eqsp.
\end{split}
\end{equation}
Using the elementary bound $1+t \leq \rme^{t}$ for any $t\in \rset$, we get 
\begin{equation}
    A_{1,k} \leq \exp\biggl\{-(3/2) \mu\sum_{i=1}^k\alpha_i \biggr\}\exp\biggl\{2L_2^2\sum_{i=1}^k\alpha_i^2\biggr\}\eqsp.
\end{equation}
Using \Cref{lem:bounds_on_sum_step_sizes}, we obtain 
\begin{equation}
\label{eq:A_1_k_bound}
A_{1,k} \leq c_{1} \exp\biggl\{-\frac{3\mu c_0}{4(1-\gamma)} (k+k_0)^{1-\gamma}\biggr\}\eqsp,
\end{equation}
where we have set 
\begin{equation}
\label{eq:c_1_small}
c_1 = \exp\biggl\{\frac{2c_0^2L_2^2}{2\gamma-1} + \frac{3\mu c_0}{4(1-\gamma)}k_0^{1-\gamma}\biggr\}\eqsp.
\end{equation}
Now we estimate $A_{2,k}$. Let $k_1$ be the largest index $k$ such that $4 \alpha_k^2 L_2^2 \geq \alpha_k\mu$. Then, for $i > k_1$, we have that 
\[
1- (3/2) \alpha_i \mu+2 \alpha_i^2 L_2^2 \leq 1 - \alpha_i \mu \eqsp.
\]
Thus, using the definition of $A_{2,k}$ in \eqref{eq:A_1_2_k_def}, we obtain that 
\begin{align}
    A_{2,k}  \leq \sum_{i=1}^k \alpha_i^2 \prod_{j=i+1}^k(1-\alpha_j\mu) +  \sum_{i=1}^{k_1}\alpha_i^2 \biggl\{ \prod_{j=i+1}^{k_1}(1+2\alpha_j^2 L_2) \biggr\} \biggl\{ \prod_{j=k_1+1}^{k}(1-\alpha_j\mu) \biggr\}\eqsp.
\end{align}
Note that
\begin{align}
    \sum_{i=1}^{k_1}\alpha_i^2 \prod_{j=i+1}^{k_1}(1+2 \alpha_j^2L_2^2) 
    &=\frac{1}{ 2L_2^2}\sum_{i=1}^{k_1}\biggl(\prod_{j=i}^{k_1}(1+2 \alpha_j^2 L_2^2)-\prod_{j=i+1}^{k_1}(1+2 \alpha_j^2L_2^2)\biggr) \\
    &\leq \frac{1}{2L_2^2}\prod_{j=1}^{k_1}(1+2\alpha_j^2 L_2^2) \leq \frac{1}{2L_2^2}\exp\biggl\{2L_2^2\sum_{j=1}^{k_1}\alpha_j^2\biggr\}.
\end{align}
Note, that for $k\leq k_1$, $\alpha_k \geq \mu/(4L_2^2)$, hence, we have 
\begin{equation}
    \prod_{j=k_1+1}^k(1-\alpha_j\mu) \leq \exp\biggl\{-\mu\sum_{i=1}^k\alpha_i\biggr\}\exp\biggl\{\mu\sum_{i=1}^{k_1}\alpha_i\biggr\} \leq \exp\biggl\{-\mu\sum_{i=1}^k\alpha_i\biggr\}\exp\biggl\{4L_2^2 \sum_{i=1}^{k_1}\alpha_i^2\biggr\}\eqsp.
\end{equation}

Moreover, for any $m\in\{1,\ldots ,k\}$, we obtain 
\begin{align}
&\sum_{i=1}^k \alpha_i^2 \prod_{j=i+1}^k(1-\alpha_j\mu) = \sum_{i=1}^m\prod_{j=i+1}^k(1-\alpha_j\mu)\alpha_i^2 + \sum_{i=m+1}^k\prod_{j=i+1}^k(1-\alpha_j\mu)\alpha_i^2 \\
&\qquad \qquad \leq \prod_{j=m+1}^k(1-\alpha_j\mu)\sum_{i=1}^{m}\alpha_i^2 +\alpha_m\sum_{i=m+1}^k\prod_{j=i+1}^k(1-\alpha_j\mu)\alpha_i \\
&\qquad \qquad \leq \exp\biggl\{-\mu\sum_{j=m+1}^k\alpha_j\biggr\}\sum_{i=1}^{m}\alpha_i^2 + \frac{\alpha_m}{\mu}\sum_{i=m+1}^k\biggl(\prod_{j=i+1}^k(1-\alpha_j\mu)-\prod_{j=i}^k(1-\alpha_j\mu)\biggr) \\
&\qquad \qquad  \leq \exp\biggl\{-\mu\sum_{j=m+1}^k\alpha_j\biggr\}\sum_{i=1}^{m}\alpha_i^2 + \frac{\alpha_m}{\mu}\biggl(1-\prod_{j=m+1}^k(1-\alpha_j\mu)\biggr) \\
&\qquad \qquad \leq  \exp\biggl\{-\mu\sum_{j=m+1}^k\alpha_j\biggr\}\sum_{i=1}^{m}\alpha_i^2 + \frac{\alpha_m}{\mu}\eqsp.
\end{align}
Thus, setting $m= \lfloor k/2 \rfloor $, and using the definition of $A_{2,k}$ in \eqref{eq:A_1_2_k_def}, we obtain that 
\begin{align}
A_{2,k} &\leq \exp\biggl\{\frac{-\mu c_0}{2(1-\gamma)}((k+k_0)^{1-\gamma}-(\lfloor k/2\rfloor+k_0)^{1-\gamma}))\biggr\} \frac{c_0^2}{2\gamma-1} + \frac{c_0}{\mu(k_0+\lfloor k/2 \rfloor)^{\gamma}} \\& \qquad \qquad \qquad \qquad+ c_2 \exp\biggl\{-\frac{\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\}\eqsp,
\end{align}
where we have set
\begin{equation}
\label{eq:c_2_small}
c_2 = \frac{1}{2L_2^2} \exp\biggl\{\frac{6c_0^2 L_2^2}{2\gamma-1}+ \frac{\mu c_0}{2(1-\gamma)}k_0^{1-\gamma}\biggr\}\eqsp.
\end{equation}
Using that $\lfloor k/2 \rfloor \leq k/2$ together with the elementary inequality 
\[
\frac{x^{\beta}}{\beta} - \frac{(x/2)^{\beta}}{\beta} \geq \frac{x^{\beta}}{2}\eqsp,
\]
which is valid for $\beta \in (0,1]$, and $\frac{c_0}{\mu(k_0+\lfloor k/2 \rfloor)^{\gamma}} \leq \frac{2^{\gamma} c_0}{\mu (k+k_0)^{\gamma}}$, we obtain that 
\begin{align}
A_{2,k} &\leq \exp\biggl\{-\frac{\mu c_0}{4} (k+k_0)^{1-\gamma}\biggr\}\exp\biggl\{\frac{\mu c_0}{2(1-\gamma)}k_0^{1-\gamma}\biggr\}\frac{c_0^2}{2\gamma-1} + \frac{2^{\gamma} c_0}{\mu (k+k_0)^{\gamma}} \\& \qquad \qquad \qquad \qquad + c_2 \exp\biggl\{\frac{-\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\}\eqsp.
\end{align}
Combining the bounds for $A_{1,k}$ and $A_{2,k}$, we obtain that 
\begin{align}
\PE[\norm{\theta_k-\thetas}^2] 
&\leq c_{1} \exp\biggl\{-\frac{\mu c_0}{(1-\gamma)} (k+k_0)^{1-\gamma}\biggr\} \norm{\theta_0 - \thetas}^2 \\
&+ \exp\biggl\{-\frac{\mu c_0}{4} (k+k_0)^{1-\gamma}\biggr\} \frac{2c_0^2 \sigma_2^2}{2\gamma-1}\exp\biggl\{\frac{\mu c_0}{2(1-\gamma)}k_0^{1-\gamma}\biggr\}+  \frac{2^{1+\gamma} c_0 \sigma_2^2}{\mu (k+k_0)^{\gamma}} \\
&+ 2 c_2 \sigma_2^2 \exp\biggl\{\frac{-\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\} \\
&\leq C_{1} \exp\biggl\{-\frac{\mu c_0}{4} (k+k_0)^{1-\gamma}\biggr\} \bigl[ \norm{\theta_0-\thetas}^2 + \sigma_2^2\bigr] + C_{2} \alpha_{k}  \eqsp,
\end{align}
where we have set constants $C_1$ and $C_2$ using the definitions of $c_1$ and $c_2$ from \eqref{eq:c_1_small} and \eqref{eq:c_2_small}. 
\end{proof}


Now we provide the following corollary:

\begin{corollary}
\label{cor:second_moment_bound}
Under the assumptions of \Cref{lem:bound_last_iter_second_moment},  it holds that 
\begin{equation}
\PE[\norm{\theta_k-\thetas}^2]\leq D_1 (\norm{\theta_0-\thetas}^2 + \sigma_2^2) \alpha_k\eqsp,
\end{equation}
where 
\[
D_1 = C_1 (1/c_0 + C_{2}) \biggl(\frac{4\gamma}{(1-\gamma)\mu c_0 \rme}\biggr)^{\gamma/(1-\gamma)}\eqsp.
\]
\end{corollary}
\begin{proof}
Define $C_3 = (\frac{4\gamma}{(1-\gamma)\mu c_0 \rme})^{\gamma/(1-\gamma)} > 1$, then  $\exp\{-\mu c_0(k+k_0)^{1-\gamma} / 4\}\leq C_3 (k+k_0)^{-\gamma}$, and the statement follows.
\end{proof}
Now we provide bound for p-moment of last iterate.
\begin{proposition}  \label{prop:2p-moment-bound} 
Assume \Cref{ass:L-smooth}, \Cref{ass:noise_decomposition}($2p$), \Cref{ass:hessian_Lipschitz_ball} and \Cref{ass:step_size}. Then for any $k \in \nset$ it holds that
\begin{equation}
\PE[\norm{\theta_k - \thetas}^{2p}] \leq C_{2p,1}\exp\biggl\{-\frac{p\mu c_0}{4}(k+k_0)^{1-\gamma}\biggr\}(\norm{\theta_0-\thetas}^{2p} + \sigma_{2p}^{2p}) + C_{2p,2}\sigma_{2p}^{2p}\alpha_k^p\eqsp, 
\end{equation}
where 
\begin{equation}
    C_{2p,1} = 2^{2p-1}(D_{2(p-1)}C_4^pc_0^p + 1)c_4\eqsp,
\end{equation}
\begin{equation}
    C_{2p,2} =2^{2p-1}D_{2(p-1)}C_4^p\frac{2^{1+\gamma p}}{\mu pc_0} \eqsp,
\end{equation}
and 
\begin{equation}
\begin{split}
    &C_4^p = (4c_0^{1/2}2^{\gamma/2}+2^{\gamma}+ 4c_0)^p\\
    &c_4 = \biggl(\exp\biggl\{\exp\biggl\{5pc_0(L_1+L_2)\biggr\}\frac{4p^2(L_1+L_2)^2}{2\gamma-1}\biggr\} + 1\biggr)\exp\biggl\{\frac{p\mu c_0}{1-\gamma}k_0^{1-\gamma}\biggr\}\frac{1}{\gamma(p+1)-1}
\end{split}
\end{equation}
\end{proposition}
\begin{proof}
We prove the statements by induction in $p$. We first assume that $\theta_0 = \thetas$ and then provide a result for arbitrary initial condition. The result for $p = 1$ is provided in \Cref{cor:second_moment_bound} . Assume that for any $t\leq p-1$ and all $k \in \nset$ we proved that 
\begin{equation}
\label{eq:induction_assumption_p_moment}
\PE[\norm{\theta_k - \thetas}^{2t}] \leq D_{2t} \sigma_{2t}^{2t} \alpha_{k}^{t}\eqsp,
\end{equation}
and the sequence of constants $\{D_{2t}\}_{t}$ is non-decreasing. Note that \eqref{eq:induction_assumption_p_moment} implies that, due to Lyapunov's inequality, 
\begin{equation}
\PE[\norm{\theta_k - \thetas}^{2t}] \leq D_{2t} \sigma_{2p}^{2t} \alpha_{k}^{t}\eqsp.  
\end{equation}
For any $k\in \nset$ we denote $\delta_k= \norm{\theta_k - \thetas}$. Using \eqref{eq:sgd_recursion_main}, we get 
\begin{align}
\delta_k^{2p} 
&= \left(\delta_{k-1}^2 - 2\alpha_k\langle\theta_{k-1}-\thetas, \nabla f(\theta_{k-1}) + \zeta_k \rangle + \alpha_k^2\norm{\nabla f(\theta_{k-1}) + \zeta_k}^2\right)^p \\
&= \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}}}}{\sum}\frac{p!}{i!j!l!}\delta_{k-1}^{2i}(-2\alpha_k\langle\theta_{k-1}-\thetas, \nabla f(\theta_{k-1})+\zeta_k\rangle)^j\alpha_k^{2l}\norm{\nabla f(\theta_{k-1}) + \zeta_k}^{2l}.
\end{align}
Now we bound each term in the sum above.
\begin{enumerate}
        \item First, for $i=p, j=0, l=0$, the corresponding term in the sum equals $\delta_{k-1}^{2p}$.
        \item Second, for $i=p-1, j=1, l=0$, we obtain, applying \Cref{ass:L-smooth}, that 
        \begin{align}
        2p\alpha_k \PE [\langle\theta_{k-1}-\thetas, \nabla f(\theta_{k-1}) +\zeta_k \rangle\delta_{k-1}^{2(p-1)}|\F_{k-1}] 
        &= 2p\alpha_k\langle\theta_{k-1}-\thetas, \nabla f(\theta_{k-1})- \nabla f(\thetas)  \rangle\delta_{k-1}^{2(p-1)} \\
        &\geq 2 p \mu \alpha_k \delta_{k-1}^{2 p}\eqsp.
        \end{align}
        \item Third, for $l \geq 1$ or $j \geq 2$ (that is,  $2l+j \geq 2$), we use Cauchy-Schwartz inequality  
    \begin{equation}
        |\langle\theta_{k-1}-\thetas, \nabla f(\theta_{k-1})+\zeta_k\rangle)^j| \leq \norm{\theta_{k-1}-\thetas}^j\norm{\nabla f(\theta_{k-1})+\zeta_k}^j\eqsp,
    \end{equation}
    moreover, applying \Cref{ass:L-smooth} and \Cref{ass:noise_decomposition}($2p$) together with the Lyapunov inequality, we get 
    \begin{align}
        \PE[\norm{\nabla f(\theta_{k-1})+\zeta_k}^{2l+j}|\F_{k-1}] 
        &= \PE[\norm{\nabla f(\theta_{k-1})+g(\theta_{k-1}, \xi_k) + \eta(\xi_k)}^{2l+j}|\F_{k-1}] \\
        &\leq 2^{2l+j-1}((L_1+L_2)^{2l+j}\delta_{k-1}^{2l+j} + \sigma_{2p}^{2l+j})\eqsp. 
    \end{align}
\end{enumerate}
    Combining inequalities above, we get 
    \begin{multline}
    \label{eq:delta_k_2p_decomposition}
        \PE[\delta_k^{2p}|\F_{k-1}]\leq \biggl(1 -2p\mu\alpha_k + \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}: \\j+2l\geq 2 }}} {\sum}\frac{p!}{i!j!l!}\alpha_k^{j+2l}2^{2l+2j-1}(L_1+L_2)^{2l+j}\biggr) \delta_{k-1}^{2p} \\  + \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}: \\j+2l\geq 2 }}} {\sum}\frac{p!}{i!j!l!}\delta_{k-1}^{2i+j}\alpha_k^{j+2l}2^{2l+2j-1}\sigma_{2p}^{2l+j}\eqsp.
    \end{multline}
    Consider the first term above, and note that
    \begin{align}
    \label{eq:bound_sum_j_2l_p_moment}
    &\qquad \qquad\qquad \qquad \qquad \qquad\underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}: \\j+2l\geq 2 }}} {\sum}\frac{p!}{i!j!l!}\alpha_k^{j+2l}2^{2l+2j-1}(L_1+L_2)^{2l+j} 
     \\ 
    &\leq 2 \alpha_k^2 (L_1+L_2)^2 \biggl(\underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}: \\l\geq 1 }}} {\sum}\frac{p!}{i!j!l!}(4\alpha_k(L_1+L_2))^j(4\alpha_k^2(L_1+L_2)^2)^{l-1} + \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\};\\l=0;j\geq2 }}} {\sum}\frac{p!}{i!j!}(4\alpha_k(L_1+L_2))^{j-2}\biggr) \\& \qquad \qquad\qquad \qquad \qquad \leq 2 p^2\alpha_k^2 (L_1+L_2)^2(1+5\alpha_k(L_1+L_2))^{p} \eqsp.
    \end{align}
    % Consider now the second term in \eqref{eq:delta_k_2p_decomposition}. Note that $2 (\alpha_k\sigma_{2p}\delta_{k-1})^j\leq (\alpha_k\sigma_{2p})^{2j} + \delta_{k-1}^{2j}$. 
    Hence, 
    \begin{align}
     \PE[\delta_k^{2p}] \leq \left(1 -2p\mu\alpha_k + 2 p^2\alpha_k^2 (L_1+L_2)^2(1+5\alpha_k(L_1+L_2))^{p} \right)\delta_{k-1}^{2p} + T_1\eqsp,
    \end{align}
    where we have defined 
    \begin{align}
    T_1 &= \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}; \\j+2l\geq 2;\\i+j=p }}} {\sum}\frac{p!}{i!j!l!} \PE[\delta_{k-1}^{2i+j}] \alpha_k^{j+2l}2^{2l+2j-1}\sigma_{2p}^{2l+j}\eqsp.
    % T_2 &= \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}; \\j+2l\geq 2;\\ i+j\leq p-1 }}} {\sum}\frac{p!}{i!j!l!}\PE[\delta_{k-1}^{2i}] \alpha_k^{2l+2j}2^{2l+2j-2}\sigma_{2p}^{2l+2j} \eqsp, \\
    % T_3 &= \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}; \\j+2l\geq 2;\\ i+j \leq p-1 }}} {\sum}\frac{p!}{i!j!l!} \PE[\delta_{k-1}^{2i+2j}] \alpha_k^{2l}2^{2l+2j-2}\sigma_{2p}^{2l}\eqsp.
    \end{align}
    For the last term we apply H\"older's inequality together with  induction assumption \eqref{eq:induction_assumption_p_moment} and  $(k+k_0-1)^{-\gamma}\leq 2^{\gamma}(k+k_0)^{-\gamma}$ and obtain
    \begin{align}
    T_1 &\leq  \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}; \\j+2l\geq 2}}} {\sum}\frac{p!}{i!j!l!}\PE^{1/2}[\delta_{k-1}^{2(i+\lfloor j/2 \rfloor)}]\PE^{1/2}[\delta_{k-1}^{2(i+\lceil j/2 \rceil)}]\alpha_k^{j+2l}2^{2l+2j-1}\sigma_{2p}^{2l+j} \\
    & \leq D_{2(p-1)}\frac{(4c_0^{1/2}2^{\gamma/2}+2^{\gamma}+ 4c_0)^p}{2}c_0^p\sigma_{2p}^{2p}(k+k_0)^{-\gamma (p+1)}\eqsp.
    \end{align}
    % Similarly, for $T_2$ and $T_3$ we obtain 
    % \begin{align}
    % &T_2 \leq D_{2(p-1)}\frac{(8\alpha_0+2^{\gamma})^p}{4}\alpha_0^p\sigma_{2p}^{2p}k^{-\gamma (p+1)}\eqsp, \\ 
    % &T_3 \leq D_{2(p-1)}\frac{(4\alpha_0+5\cdot 2^{\gamma})^p}{4}\alpha_0^p\sigma_{2p}^{2p}k^{-\gamma (p+1)}\eqsp.
    % \end{align}
    Hence, combining the above bounds, we obtain that 
    \begin{equation}
    \label{eq:p_moment_last_iterate_requrence}
   \PE[\delta_k^{2p}]\leq (1 - 2p\mu\alpha_k + 16 \alpha_k^2 (L_1+L_2)^2 3^{p})\PE[\delta_{k-1}^{2p}] + D_{2(p-1)} C_{4}^{p} c_0^p\sigma_{2p}^{2p}k^{-\gamma (p+1)}\eqsp,
   \end{equation}
    where we have defined 
    \begin{equation}
    \label{eq:C_4_const_def}
    C_4^p = (4c_0^{1/2}2^{\gamma/2}+2^{\gamma}+ 4c_0)^p\eqsp.
    \end{equation}
    Note that 
    \begin{equation}
        1 - 2p\mu\alpha_k + 2 p^2\alpha_k^2 (L_1+L_2)^2(1+5\alpha_k(L_1+L_2))^{p} > 1-2p\mu\alpha_k + \alpha_k^2\mu^2p^2 \geq 0\eqsp.
    \end{equation}
    Unrolling the recurrence \eqref{eq:p_moment_last_iterate_requrence}, we get 
    \begin{equation}
       \PE[\delta_k^{2p}] \leq A_{2,k}'D_{2(p-1)}C_4^pc_0^p\sigma_{2p}^{2p}, 
    \end{equation}
    where we have set 
    \begin{equation}
    \label{eq:A_2_k'_def}
        A_{2,k}' = \sum_{t=1}^k\prod_{i=t+1}^k(1 - 2p\mu\alpha_i + 2 p^2\alpha_i^2 (L_1+L_2)^2(1+5\alpha_i(L_1+L_2))^{p})(t+k_0)^{-\gamma(p+1)}\eqsp.
    \end{equation}
    For simplicity, we define $C_{5}=2p^2(L_1+L_2)^2$. Let $k_1$ is the largest $k$ such that $\alpha_k^2C_5(1+5\alpha_i(L_1+L_2))^{p} \geq p\mu\alpha_k$. Then, for $i > k_1$, we have
    \begin{equation}
        1 - 2p\mu\alpha_i + C_5 \alpha_i^2 (1+5\alpha_i(L_1+L_2))^{p}\leq 1-p\mu\alpha_i \eqsp.
    \end{equation}
Hence, using the definition of $A_{2,k}'$ in \eqref{eq:A_2_k'_def}, we get 

\begin{align}
    \begin{aligned}
        A'_{2,k}&=\sum_{t=k_1+1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)} \\ &\qquad\qquad+ \prod_{t=k_1+1}^{k}\exp\biggl\{-p\mu\alpha_t\biggr\}\sum_{t=1}^{k_1}\prod_{i=t+1}^{k_1}\exp\biggl\{C_{5}\alpha_i^2(1+5\alpha_i(L_1+L_2))^{p}\biggr\}(t+k_0)^{-\gamma(p+1)}\\ &\leq 
        \sum_{t=1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)} \\&\qquad\qquad + \prod_{t=1}^{k}\exp\biggl\{-p\mu\alpha_t\biggr\}\prod_{t=1}^{k_1}\exp\{p\mu\alpha_t\}\prod_{i=1}^{k_1}\exp\biggl\{C_{5}\alpha_i^2(1+5\alpha_i(L_1+L_2))^{p}\biggr\}\sum_{t=1}^{k_1}(t+k_0)^{-\gamma(p+1)} \\ &\leq 
         \sum_{t=1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)}  \\&\qquad\qquad+ \prod_{i=1}^{k_1}\exp\biggl\{2C_{5}\alpha_i^2(1+5\alpha_i(L_1+L_2))^{p}\biggr\}\prod_{t=1}^{k}\exp\biggl\{-p\mu\alpha_t\biggr\}\sum_{t=1}^{k_1}(t+k_0)^{-\gamma(p+1)}
    \end{aligned}
\end{align}
For any $m\in\{1, \ldots k\}$ we have
\begin{align}
    \begin{aligned}
         &\sum_{t=1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)} \\&=  \sum_{t=1}^{m}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)} +  \sum_{t=m+1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma(p+1)} \\&\leq
         \prod_{i=m+1}^k\exp\{-p\mu\alpha_i\}\sum_{t=1}^{m}(t+k_0)^{-\gamma(p+1)} + \sum_{t=m+1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(m+k_0)^{-\gamma p}(t+k_0)^{-\gamma} \\&\leq 
         \prod_{i=m+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}\sum_{t=1}^{k}(t+k_0)^{-\gamma(p+1)} + (m+k_0)^{-\gamma p}\sum_{t=1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}(t+k_0)^{-\gamma}
    \end{aligned}
\end{align}

Applying \Cref{lem:bounds_on_sum_step_sizes}\ref{eq:simple_bound_sum_alpha_k}, we have
\begin{align}
 \begin{aligned}
    &\sum_{t=1}^{k}\prod_{i=t+1}^k\exp\biggl\{-p\mu\alpha_i\biggr\}t^{-\gamma}\leq \sum_{t=1}^k\exp\biggl\{\frac{-p\mu c_0}{2(1-\gamma)}((k+k_0)^{1-\gamma}-(t+k_0)^{1-\gamma})\biggr\}(t+k_0)^{-\gamma}\\&\leq \exp\biggl\{\frac{-p\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\}\frac{2}{p\mu c_0}\int_{0}^{\frac{p\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}}e^udu \leq \frac{2}{p\mu c_0}\eqsp.
\end{aligned}
\end{align}
Applying \Cref{lem:bounds_on_sum_step_sizes}\ref{eq:sum_alpha_k_p}, we get
\[
\sum_{i=1}^{k}(i+k_0)^{-\gamma(p+1)} \leq \frac{1}{(p+1)\gamma-1}\eqsp,
\]
and 
\[
\sum_{i=1}^k2C_{5}\alpha_i^2(1+5\alpha_i(L_1+L_2))^{p} \leq 2C_5(1+5c_0(L_1+L_2))^p\sum_{i=1}^{+\infty}\alpha_k^2\leq \exp\biggl\{5pc_0(L_1+L_2)\biggr\}\frac{2C_5}{2\gamma-1}
\]

Substituting $m=\lfloor k/2\rfloor$ and applying \eqref{eq:simple_bound_sum_alpha_k}, we get 
\begin{align}
        &A_{2,k}' \leq \exp\biggl\{-\frac{p\mu c_0}{2(1-\gamma)}((k+k_0)^{1-\gamma}-(\lfloor k/2\rfloor+k_0)^{1-\gamma})\biggr\}\frac{1}{\gamma(p+1)-1} + \frac{2(\lfloor k/2\rfloor +k_0)^{-\gamma p}}{p\mu c_0}\\& + c_3\exp\biggl\{-\frac{p\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\},
\end{align}
where we have set
\begin{equation}
    c_3 = \exp\biggl\{\exp\biggl\{5pc_0(L_1+L_2)\biggr\}\frac{2C_5}{2\gamma-1} +\frac{p\mu c_0}{2(1-\gamma)}k_0^{1-\gamma}\biggr \}\frac{1}{\gamma(p+1)-1}.
\end{equation}

Using that $\lfloor k/2 \rfloor \leq k/2$ together with the elementary inequality 
\[
\frac{x^{\beta}}{\beta} - \frac{(x/2)^{\beta}}{\beta} \geq \frac{x^{\beta}}{2}\eqsp,
\]
which is valid for $\beta \in (0,1]$, and $\frac{2}{\mu pc_0 (\lfloor k/2 \rfloor + k_0)^{\gamma p}} \leq \frac{2^{1+\gamma p}}{\mu pc_0(k+k_0)^{\gamma p}}$, we obtain that 
\begin{align}
        A_{2,k}' &\leq \exp\biggl\{-\frac{p\mu c_0}{4}(k+k_0)^{1-\gamma}\biggr\}\exp\biggl\{\frac{p\mu c_0}{2(1-\gamma)}k_0^{1-\gamma}\biggr\}\frac{1}{\gamma(p+1)-1} \\& + \frac{2^{1+\gamma p}}{\mu pc_0 (k+k_0)^{\gamma p}}+ c_3\exp\biggl\{-\frac{p\mu c_0}{2(1-\gamma)}(k+k_0)^{1-\gamma}\biggr\} \\& \leq c_4\exp\biggl\{-\frac{p\mu c_0}{4}(k+k_0)^{1-\gamma}\biggr\} + c_5(k+k_0)^{-\gamma p},
\end{align} 
where we have set 
\begin{align}
    &c_4 = \biggl(\exp\biggl\{\exp\biggl\{5pc_0(L_1+L_2)\biggr\}\frac{4p^2(L_1+L_2)^2}{2\gamma-1}\biggr\} + 1\biggr)\exp\biggl\{\frac{p\mu c_0}{1-\gamma}k_0^{1-\gamma}\biggr\}\frac{1}{\gamma(p+1)-1} \\&
    c_5 = \frac{2^{1+\gamma p}}{\mu pc_0}
\end{align}

Finally, we get 
\begin{equation}
    \PE[\delta_k^{2p}]\leq C_{2p, 1}'\exp\biggl\{-\frac{p\mu c_0}{4}(k+k_0)^{1-\gamma}\biggr\}\sigma_{2p}^{2p} + C_{2p, 2}'\sigma_{2p}^{2p}\alpha_k^p,
\end{equation}
where 
\begin{align}
    &C_{2p, 1}' = D_{2(p-1)}C_4^pc_0^pc_4\\&
    C_{2p, 2}' = D_{2(p-1)}C_4^pc_5.
\end{align}
To provide the result for arbitrary start point $\theta_0=\theta$ we consider the synchronous coupling construction defined by the recursions
\begin{align}
\label{eq:def_coupling_recursions}
    &\theta_k = \theta_{k-1} - \alpha_k(\nabla f(\theta_{k-1})+g(\theta_{k-1}, \xi_k) + \eta(\xi_k)), \qquad \theta_0=\theta\\&
    \theta_k' = \theta_{k-1}' - \alpha_k(\nabla f(\theta_{k-1}')+g(\theta_{k-1}', \xi_k) + \eta(\xi_k)), \qquad \theta_0'=\thetas
\end{align}
For any $k\in \nset$ we denote $\delta_{k}' = \norm{\theta_k - \theta_k'}$. Using \eqref{eq:def_coupling_recursions} together with \Cref{ass:L-smooth} and \Cref{ass:noise_decomposition}($2p$), we get 
\begin{align}
    &\delta_k'^{2p} = (\delta_{k-1}'^2 - 2\alpha_k\langle \theta_{k-1} - \theta_{k-1}', \nabla f(\theta_{k-1}) - \nabla f(\theta_{k-1}') + g(\theta_{k-1}, \xi_k) - g(\theta_{k-1}', \xi_k) \rangle + \alpha_k^2(L_1+L_2)^2\delta_{k-1}'^2)^p\\&\leq \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\}}}}{\sum}\frac{p!}{i!j!l!}\delta_{k-1}'^{2i}(- 2\alpha_k\langle \theta_{k-1} - \theta_{k-1}', \nabla f(\theta_{k-1}) - \nabla f(\theta_{k-1}') + g(\theta_{k-1}, \xi_k) - g(\theta_{k-1}', \xi_k) \rangle)^{j}(\alpha_k(L_1+L_2)\delta_{k-1}')^{2l}
\end{align}
Now we bound each term in the sum above.
\begin{enumerate}
        \item First, for $i=p, j=0, l=0$, the corresponding term in the sum equals $\delta_{k-1}'^{2p}$.
        \item Second, for $i=p-1, j=1, l=0$, we obtain, applying \Cref{ass:L-smooth}, that 
        \begin{align}
        &2p\alpha_k \PE [\langle\theta_{k-1}-\theta_{k-1}', \nabla f(\theta_{k-1}) -\nabla f(\theta_{k-1}') +g(\theta_{k-1}, \xi_k) - g(\theta_{k-1}', \xi_k) \rangle\delta_{k-1}'^{2(p-1)}|\F_{k-1}] \\ &= 2p\alpha_k\langle\theta_{k-1}-\theta_{k-1}', \nabla f(\theta_{k-1})- \nabla f(\theta_{k-1}')  \rangle\delta_{k-1}'^{2(p-1)} 
        \geq 2 p \mu \alpha_k \delta_{k-1}'^{2 p}\eqsp.
        \end{align}
        \item Third, for $l \geq 1$ or $j \geq 2$ (that is,  $2l+j \geq 2$), we use Cauchy-Schwartz inequality together with \Cref{ass:noise_decomposition} and \Cref{ass:L-smooth}
    \begin{equation}
        |\langle\theta_{k-1}-\theta_{k-1}', \nabla f(\theta_{k-1}) -\nabla f(\theta_{k-1}') +g(\theta_{k-1}, \xi_k) - g(\theta_{k-1}', \xi_k) \rangle^j| \leq \norm{\theta_{k-1}-\theta_{k-1}'}^{2j}(L_1+L_2)^j\eqsp,
    \end{equation}
\end{enumerate}

Combining inequalities above, we obtain 

\begin{equation}
\label{eq:coupling_recurence}
    \PE[\delta_{k}'^{2p}|\F_{k-1}] \leq (1- 2p\mu\alpha_k+ \underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\};\\j+2l\geq 2}}}{\sum}\frac{p!}{i!j!l!}2^j\alpha_k^{j+2l}(L_1+L_2)^{j+2l})\delta_{k-1}'^{2p}
\end{equation}

Similar to \eqref{eq:bound_sum_j_2l_p_moment}, we have 
\begin{equation}
\underset{\mathclap{\substack{i+j+l=p;\\ i,j,l \in \{0,\ldots p\};\\j+2l\geq 2}}}{\sum}\frac{p!}{i!j!l!}2^j\alpha_k^{j+2l}(L_1+L_2)^{j+2l})\delta_{k-1}'^{2p} \leq \alpha_{k}^2p^2(L_1+L_2)^2(1+3\alpha_k(L_1+L_2))^{p}
\end{equation}
Enrolling recurrence \eqref{eq:coupling_recurence}, we get
\begin{align}
    \PE[\delta_{k}'^{2p}] &\leq \exp\biggl\{-2p\mu\sum_{i=1}^k\alpha_i\biggr\}\exp\biggl\{ p^2(L_1+L_2)^2\sum_{i=1}^k\alpha_i^{2}(1+3\alpha_i(L_1+L_2))^p\biggr\}\norm{\theta_0-\thetas}^{2p}\\ &\leq c_6\exp\biggl\{-\frac{p\mu c_0}{1-\gamma}(k+k_0)^{1-\gamma}\biggr\}\norm{\theta_0-\thetas}^{2p}\eqsp,
\end{align}
where we have set
\begin{equation}
    c_6 = \exp\biggl\{\exp\biggl\{ 3pc_0(L_1+L_2)\biggr\}\frac{p^2(L_1+L_2)^2)}{2\gamma-1} + \frac{p\mu c_0}{1-\gamma}k_0^{1-\gamma}\biggr\}\eqsp.
\end{equation}
It remains to note that
\begin{align}
    \PE[\norm{\theta_k-\thetas}^{2p}]&\leq 2^{2p-1} \PE[\norm{\theta'_k-\thetas}^{2p}] + 2^{2p-1}\PE[\norm{\theta_k-\theta_k'}^{2p}] \\&\leq C_{2p,1} \exp\biggl\{-\frac{p\mu c_0}{4}(k+k_0)^{1-\gamma}\biggr\}(\norm{\theta_0-\thetas}^{2p} + \sigma_{2p}^{2p}) + C_{2p,2}\sigma_{2p}^{2p}\alpha_k^p\eqsp.
\end{align}
\end{proof}
For validity of induction in \Cref{prop:2p-moment-bound}, we need the following corollary.

\begin{corollary}
\label{cor:p_moment_bound}
Under the assumptions of \Cref{prop:2p-moment-bound},  it holds that 
\begin{equation}
\PE[\norm{\theta_k-\thetas}^{2p}]\leq D_{2p} (\norm{\theta_0-\thetas}^{2p} + \sigma_2^{2p}) \alpha_k^p\eqsp,
\end{equation}
where 
\[
D_{2p} = C_{2p,1} (1/c_0^p + C_{2p, 2}) \biggl(\frac{4\gamma}{(1-\gamma)\mu p c_0 \rme}\biggr)^{\gamma p/(1-\gamma)}\eqsp.
\]
\end{corollary}
\begin{proof}
Define $C_5 = (\frac{4\gamma}{(1-\gamma)p\mu c_0 \rme})^{\gamma p/(1-\gamma)} > 1$, then  $\exp\{-\mu pc_0(k+k_0)^{1-\gamma} / 4\}\leq C_5 (k+k_0)^{-p\gamma}$, and the statement follows.
\end{proof}


\begin{corollary}
\label{cor:fourth_moment_bound_last_iterate}
Assume \Cref{ass:L-smooth},\Cref{ass:noise_decomposition}($4$), \Cref{ass:hessian_Lipschitz_ball} and \Cref{ass:step_size}. Then for any $k \in \nset$ it holds that
\begin{equation}
\PE[\norm{\theta_k - \thetas}^{4}] \leq C_{4,1}\exp\biggl\{-\frac{2\mu c_0}{4}k^{1-\gamma}\biggr\}(\norm{\theta_0-\thetas}^{4} + \sigma_{4}^{4}) + C_{4,2}\sigma_{4}^{4}\alpha_k^2\eqsp, 
\end{equation}
with 
\begin{equation}
    C_{4,1} = 2^{3}\biggl(C_1(1/c_0+C_2)\biggl(\frac{4\gamma}{(1-\gamma)\mu c_0 \rme}\biggr)^{\gamma/(1-\gamma)}\bigl(4c_0^{1/2}2^{\gamma/2}+2^{\gamma}+ 4c_0\bigr)^2c_0^2+1\biggr)c_{2,4}
\end{equation}
and 
\begin{equation}
    C_{4,2} =2^{3}C_1(1/c_0+C_2)\biggl(\frac{4\gamma}{(1-\gamma)\mu c_0 \rme}\biggr)^{\gamma/(1-\gamma)}\bigl(4c_0^{1/2}2^{\gamma/2}+2^{\gamma}+ 4c_0\bigr)^2c_{2,5}.
\end{equation}
Here $C_1$ and $C_2$ are defined in \Cref{lem:bound_last_iter_second_moment} and 
\begin{align}
    &c_{2,4} = \biggl(\exp\biggl\{\exp\biggl\{10c_0(L_1+L_2)\biggr\}\frac{16(L_1+L_2)^2}{2\gamma-1}\biggr\} + 1\biggr)\exp\biggl\{\frac{2\mu c_0}{1-\gamma}k_0^{1-\gamma}\biggr\}\frac{1}{3\gamma-1}\eqsp, \\&
    c_{2,5} = \frac{2^{1+2\gamma}}{2\mu c_0}\eqsp.
\end{align}
\end{corollary}
\begin{proof}
The proof follows directly from \Cref{prop:2p-moment-bound} and \Cref{cor:second_moment_bound}.
\end{proof}



% \subsection{High probability bound of last iterate SGD}
% \input{high-prob-last_iter_sgd}
