\section{Support Lemmas}

\begin{lemma}[Sionâ€™s minimax theorem \citep{sion1958general}]
Let $\mathcal{X}$ and $\mathcal{Y}$ be convex and compact sets, and a function $F: \mathcal{X} \times \mathcal{Y} \rightarrow \mathbb{R}$ such that (1) For all $y \in \mathcal{Y}$, $F(\cdot, y)$ is convex and continuous over $\mathcal{X}$ and (2) For all $x \in \mathcal{X}$, $F(x, \cdot)$ is concave and continuous over $\mathcal{X}$. Then 
\begin{align*}
    \min_{x \in \mathcal{X}}\max_{y \in  \mathcal{Y}} F(x,y) =  \max_{y \in  \mathcal{Y}}\min_{x \in \mathcal{X}} F(x,y) 
\end{align*}
\label{lem:minmax}
\end{lemma}


\begin{lemma}[Performance Difference Lemma]
For any finite-horizon MDPs $M$ with state space $\mathcal{S}$, action space $\calA$, reward function $R$, transition $P$, and horizon length $H$, we have
\begin{align*}
    V_{(P, R)}(\pi') - V_{(P,R)}(\pi) = \sum_{h=1}^H \E_{s \sim d_{P,h}^\pi} \left[\sum_{a \in \calA} \left(\pi_h'(a|x) - \pi_h(a|x)\right) Q^{\pi'}_h(x,a; R)\right].
\end{align*}   
\label{lem:PDL}
\end{lemma}


\begin{lemma}[Exponential Weights]
Given a sequence of reward functions $\{g^t\}_{t=1}^T$ over a decision set $\Pi$,  $\{p^t\}_{t=1}^T$ is a distribution sequence with $p^t \in \Delta\left(\Pi\right), \,\forall t \in [T]$ such that 
\begin{align*}
    p^{t+1}(\pi) \propto \exp\left(\eta \sum_{i=1}^t g^i(\pi)\right).
\end{align*}
If $p^1$ is a uniform distribution over $|\Pi|$ and $\eta g^{t}(\pi) \leq 1$ for all $t \in [T]$ and $\pi \in \Pi$. Then
\begin{align*}
    \max_{p \in \Delta(\Pi)}\left\{\sum_{t=1}^T \left\langle g^t,  p - p^t\right\rangle \right\} \le \frac{\log(|\Pi|)}{\eta} + \eta\sum_{t=1}^T\sum_{\pi \in \Pi} p^t(\pi) g^t(\pi)^2.
\end{align*}
\label{lem:EXP}
\end{lemma}


Here we provide an extension of Lemma 5.2 in \cite{xu2023bayesian}. The proof follows \cite{xu2023bayesian} with adaptation to general $\Phi$.

\begin{lemma}[Lemma 5.2 in \cite{xu2023bayesian} for general $\Phi$]
Given $\rho \in \Delta(\Phi), \eta$, $p \in \Delta(\Pi)$, and let $\nu \in \Delta(\Psi)$ be a maximizer of
\begin{align*}
    &\nu \in \argmax_{\nu \in \Delta(\Psi)}\E_{\pi\sim p} \E_{(M,\pi^\star)\sim \nu} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^\star) -  V_{M}(\pi) - \frac{1}{\eta} \KL\left( \nu_{\bo{\phi}}(\cdot|\pi, o), \rho\right) \right]\,,
\end{align*}
then we have
\begin{align*}
    &\max_{\mu \in \Delta(\Psi)}\E_{\pi\sim p}\E_{\phi^\star \sim \mu}\E_{(M, \pi^\star) \sim \mu(\cdot|\phi^\star)} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^\star) -  V_{M}(\pi) - \frac{1}{\eta} \log\frac{\nu(\phi^\star|\pi, o)}{\rho(\phi^\star)} \right]\\
       &= \E_{\pi\sim p} \E_{(M,\pi^\star)\sim \nu} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^\star) -  V_{M}(\pi) - \frac{1}{\eta} \KL\left( \nu_{\bo{\phi}}(\cdot|\pi, o), \rho\right) \right]
\end{align*}
If the environment reveals $\pi^{\Theta} =(\pi^\theta)_{\theta\in\Theta}$, we also have
\begin{align*}
    &\max_{\mu \in \Delta(\calM)}\E_{\pi \sim p}\E_{\theta^\star \sim \mu}\E_{M\sim \mu(\cdot|\theta^\star)} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^{\theta^\star}) -  V_{M}(\pi) - \frac{1}{\eta} \log\frac{\nu(\theta^\star|\pi, o)}{\rho_t(\theta^\star)} \right]
    \\&= \E_{\pi\sim p} \E_{\theta^\star \sim \nu} \E_{M \sim \nu(\cdot|\theta^\star)} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^{\theta^\star}) -  V_{M}(\pi) -  \frac{1}{\eta} \KL\left( \nu_{\bo{\theta^\star}}(\cdot|\pi, o), \rho_t\right)\right]\,,
\end{align*}
as long as $\nu$ is a maximizer of the RHS.
\label{lem: max posterior}
\end{lemma}

\begin{proof}
Let $\mathcal{Z}$ be the space of all mappings from $\Pi \times \mathcal{O}$ to $\Delta(\Phi)$. For every mapping $Z \in \mathcal{Z}$, denote $Z(\cdot|\pi, o) \in \Delta(\Psi)
$ as the image of $(\pi, o)$. For a fixed $p$, define $B: \Delta(\Psi) \times \mathcal{Z} \rightarrow \mathbb{R}$ by
% \begin{align*}
%     B(\mu, Z) = \E_{(M, \pi^\star) \sim \mu}\E_{\pi \sim p}\E_{o \sim M(\cdot|\pi)}\left[V_M(\pi^\star) - V_M(\pi) - \frac{1}{\eta}\log\frac{Z(\phi^\star|\pi, o)}{q(\phi^\star)}\right]
% \end{align*}
% Or
\begin{align*}
    B(\mu, Z) = \E_{\phi^\star \sim \mu}\E_{(M, \pi^\star) \sim \mu(\cdot|\phi^\star)}\E_{\pi \sim p}\E_{o \sim M(\cdot|\pi)}\left[V_M(\pi^\star) - V_M(\pi) - \frac{1}{\eta}\log\frac{Z(\phi^\star|\pi, o)}{q(\phi^\star)}\right]
\end{align*}
For any $\mu$, $B(\mu, Z)$ is strongly convex with respect to $Z$, For any $\mu \in \Delta(\Psi)$, denote $Z_\mu = \argmin_{Z \in \mathcal{Z}}  B(\mu, Z)$ as the unique minimizer of $B(\mu, z)$ given $\mu$. Solve the first order optimality condition for the Lagrangian of $B(\mu, Z)$ constrained on $Z$ as a valid distribution, we have $Z_{\mu}(\phi|\pi, o) = \mu(\phi|\pi, o)$ for every $\phi, \pi, o$ as the posterior of $\mu$. Thus, we have
\begin{align*} 
    &\min_{Z \in \mathcal{Z}} B(\mu, Z)
    \\&=  B(\mu, Z_{\mu})
    \\&= \E_{\phi^\star \sim \mu}\E_{(M, \pi^\star) \sim \mu(\cdot|\phi^\star)}\E_{\pi \sim p}\E_{o \sim M(\cdot|\pi)}\left[V_M(\pi^\star) - V_M(\pi) - \frac{1}{\eta}\log\frac{\mu(\phi^\star|\pi, o)}{q(\phi^\star)}\right]
\end{align*}
Define the worst-case prior belief 
\begin{align*}
    \nu \in \argmax_{\mu} B(\mu, Z_{\mu}) = \argmax_{\mu} \min_{Z \in \mathcal{Z}} B(\mu, Z).
\end{align*}
From a constructive minimax theorem (Lemma 5.1 in \cite{xu2023bayesian}), $(\nu, Z_{\nu})$ is a Nash equilibrium of function $B$, and $Z_{\nu}$ is a construction solution to the minimax optimization problem $\min_{Z}\max_{\mu}B(\mu, Z)$. Thus,
\begin{align*}
&\E_{\pi\sim p} \E_{(M,\pi^\star)\sim \nu} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^\star) -  V_{M}(\pi) - \frac{1}{\eta} \KL\left( \nu_{\bo{\phi}}(\cdot|\pi, o), \rho\right) \right]
    \\&= \E_{\phi^\star \sim \nu}\E_{(M, \pi^\star) \sim \nu(\cdot|\phi^\star)}\E_{\pi \sim p}\E_{o \sim M(\cdot|\pi)}\left[V_M(\pi^\star) - V_M(\pi) - \frac{1}{\eta}\log\frac{\nu(\phi^\star|\pi, o)}{q(\phi^\star)}\right]
    \\&= B(\nu, Z_{\nu})
    \\&= \max_{\mu} B(\mu, Z_{\nu})  \tag{Lemma 5.1 in \cite{xu2023bayesian}}
    \\&= \max_{\mu \in \Delta(\Psi)}\E_{\pi\sim p}\E_{\phi^\star \sim \mu}\E_{(M, \pi^\star) \sim \mu(\cdot|\phi^\star)} \E_{o\sim M(\cdot|\pi)}\left[ V_{M}(\pi^\star) -  V_{M}(\pi) - \frac{1}{\eta} \log\frac{\nu(\phi^\star|\pi, o)}{\rho(\phi^\star)} \right].
\end{align*}
The proof for the revealed $\pi^{\Theta}=(\pi^\theta)_{\theta\in\Theta}$ is similar.
\end{proof}
