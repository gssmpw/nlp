\section{Omitted Proofs in \pref{sec: stochastic model-free}}
\begin{proof}\textbf{of \pref{thm: linear QV}\ \ }
Notice that this is a fixed comparator game where every $\phi$ has a single policy. By \pref{lem: dec equiv} and \pref{lem: equivalence of dec}, it suffices to bound 
\begin{align*}
    \dec^{\textsc{KL}}_{\eta}(\bar\calM(\Phi)) = \dec^{\textsc{KL}}_\eta(\calM,\Phi).  %\max_{\rho}\max_{\nu}\min_{p}\air^{\Phi}_{\rho,\eta}(p,\nu). 
\end{align*}
%\jz{Is this wip? lem convex pi has been split} With the same argument as in the proof of 
%we have equivalence of \pref{lem: convex phi}, this is identical to
%$\max_{\nu}\min_{p}\air^{\Phi}_{\nu_{\bo{\phi}},\eta}(p,\nu)$.
    Let $\pi^\phi, \theta^\phi, w^\phi$ denote the $\pi, \theta, w$ for the group $\phi\in\Phi$.  Let $p$ be the marginal distribution of $\nu$. Then
    \begin{align}
        &\mathbb{E}_{\pi\sim p}  \E_{(M,\pi^\star)\sim \nu}\left[ V_M(\pi^\star) - V_M(\pi)\right]  \nonumber  \\
        &= \E_{(M,\pi)\sim \nu} \E_{(M',\pi')\sim \nu}\left[ V_M(\pi) - V_{M'}(\pi)\right] \nonumber \\
        &= \E_{\phi\sim \nu}\E_{(M,\pi)\sim \nu(\cdot|\phi)} \E_{(M', \pi')\sim \nu}\left[ V_M(\pi^\phi) - V_{M'}(\pi^\phi)\right] \nonumber \\
        &= \E_{\phi\sim \nu}\E_{(M,\pi)\sim \nu(\cdot|\phi)} \E_{(M', \pi')\sim \nu}\E^{\pi^\phi, M'}\left[ \sum_{h=1}^H \left(Q_h(s_h,a_h; M) - r_h - V_{h+1}(s_{h+1}; M)\right) \right] \nonumber \\
        &= \E_{\phi\sim \nu}\E_{\phi'\sim \nu}\E_{(M,\pi)\sim \nu(\cdot|\phi)} \E_{(M', \pi')\sim \nu(\cdot|\phi')}\E^{\pi^\phi,M'}\Bigg[ \sum_{h=1}^H (Q_h(s_h,a_h; M) - V_{h+1}(s_{h+1}; M) \nonumber \\
        &\qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad - Q_h(s_h,a_h; M') + V_{h+1}(s_{h+1}; M')) \Bigg] \nonumber \\
        &= \E_{\phi\sim \nu}\E_{\phi'\sim \nu}\E_{(M', \pi')\sim \nu(\cdot|\phi')}\E^{\pi^\phi,M'}\left[ \sum_{h=1}^H \inner{\varphi(s_h,a_h), \theta^\phi - \theta^{\phi'}} - \inner{\psi(s_{h+1}), w^\phi - w^{\phi'}}\right]\nonumber  \\
        &= \E_{\phi\sim \nu} \E_{\phi'\sim \nu} \E_{(M', \pi')\sim \nu(\cdot|\phi')} \sum_{h=1}^H 
 \inner{X_h(\pi^\phi; M'), W(\phi) - W(\phi')}   \label{eq: break1}
    \end{align}
    where we define for all $h$ 
    \begin{align*}
        X_h(\phi; M') &= \mathbb{E}^{\pi^\phi, M'} \left[\varphi(s_h,a_h), -\psi(s_{h+1})\right], \\
        W(\phi) &= \left[ \theta^\phi, w^\phi \right]. 
    \end{align*}
    Let $M^\mu$ denote the mixture model such that $M^\mu(\cdot|\pi) = \E_{M\sim \mu}[M(\cdot|\pi)]$. Furthermore, in this proof, we denote $M^{\nu(\cdot|\phi)}$ as $M^\phi$.  Then the last expression in \pref{eq: break1} can be written as 
    \begin{align}
        \sum_{h=1}^H  \E_{\phi\sim \nu} \E_{\phi'\sim \nu} \inner{X_h(\phi; M^{\nu(\cdot|\phi')}), W(\phi) - W(\phi') } = \sum_{h=1}^H  \E_{\phi\sim \nu} \E_{\phi'\sim \nu} \inner{X_h(\phi; M^{\phi'}), W(\phi) - W(\phi') }.  \label{eq: break 4} 
    \end{align}
    For each $h$ and $\phi'$, define 
    \begin{align*}
        \Sigma_h^{\phi'} = \E_{\phi\sim \nu}\left[X_h(\phi; M^{\phi'})X_h(\phi; M^{\phi'
        })^\top\right].  
    \end{align*}
    Then we have 
    \begin{align}
        &\E_{\phi\sim \nu} \E_{\phi'\sim \nu} \inner{X_h(\phi; M^{\phi'}), W(\phi) - W(\phi') }   \nonumber \\
        &\leq \E_{\phi'\sim \nu} \left[\sqrt{\E_{\phi\sim \nu}\left[\left\|X_h(\phi; M^{\phi'})\right\|_{(\Sigma^{\phi'}_h)^{-1}}^2\right]}\sqrt{\E_{\phi\sim \nu} \left[\left\|W(\phi)-W(\phi')\right\|_{\Sigma^{\phi'}_h}^2\right]}\right] \nonumber 
  \\
        &= \E_{\phi'\sim \nu}\left[\sqrt{2d} \sqrt{\E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} \left[\inner{X_h(\tilde{\phi};M^{\phi'}), W(\phi) - W(\phi')}^2\right]  }\right].  \label{eq: break 2}
    \end{align}
    We continue to bound the square term in \pref{eq: break 2}: 
    \begin{align*}
        &\E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} \left[\inner{X_h(\tilde{\phi};M^{\phi'}), W(\phi) - W(\phi')}^2\right] \\
        &= \E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} \left[\left(\E^{\pi^{\tilde{\phi}}, M^{\phi'}} 
\left[ \varphi(s_h,a_h)^\top \theta^\phi -\psi(s_{h+1})^\top w^{\phi} \right] - \E^{\pi^{\tilde{\phi}}, M^{\phi'}} 
\left[ \varphi(s_h,a_h)^\top \theta^{\phi'} -\psi(s_{h+1})^\top w^{\phi'} \right] \right)^2\right] \\
&= \E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} \left[\left(\E^{\pi^{\tilde{\phi}}, M^{\phi'}} 
\left[ \varphi(s_h,a_h)^\top \theta^\phi- r_h -  \psi(s_{h+1})^\top w^{\phi} \right] 
\right)^2\right] \\
&=  \E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} \Bigg[\Bigg(\E^{\pi^{\tilde{\phi}}, M^{\phi'}} 
\left[ \varphi(s_h,a_h)^\top \theta^\phi- r_h -  \psi(s_{h+1})^\top w^{\phi} \right] \\
&\qquad \qquad \qquad \qquad \qquad \qquad - \underbrace{\E^{\pi^{\tilde{\phi}}, M^{\phi}} 
\left[ \varphi(s_h,a_h)^\top \theta^\phi- r_h -  \psi(s_{h+1})^\top w^{\phi} \right]}_{=0}
\Bigg)^2\Bigg] \\
&\leq \E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} 
 \left[D_{\textsc{TV}}^2 \left(M^{\phi'}(\cdot|\pi^{\tilde{\phi}}), M^{\phi}(\cdot|\pi^{\tilde{\phi}})\right)\right] \\
 &\leq 2\E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} 
 \left[D_{\textsc{H}}^2 \left(M^{\phi'}(\cdot|\pi^{\tilde{\phi}}), M^{\phi}(\cdot|\pi^{\tilde{\phi}})\right)\right]. 
    \end{align*}
Combining this with \pref{eq: break 2}, we get 
\begin{align*}
   &\E_{\phi\sim \nu} \E_{\phi'\sim \nu} \inner{X_h(\phi; M^{\phi'}), W(\phi) - W(\phi') } \\
   &\leq 2\sqrt{d \E_{\phi'\sim \nu}\E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} 
 \left[D_{\textsc{H}}^2 \left(M^{\phi'}(\cdot|\pi^{\tilde{\phi}}), M^{\phi}(\cdot|\pi^{\tilde{\phi}})\right)\right]} \\
 &\leq 2\sqrt{2d \E_{\phi'\sim \nu}\E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} 
 \left[D_{\textsc{H}}^2 \left(M^{\nu(\cdot|\phi')}(\cdot|\pi^{\tilde{\phi}}), M^{\nu}(\cdot|\pi^{\tilde{\phi}})\right) + D_{\textsc{H}}^2 \left(M^{\nu}(\cdot|\pi^{\tilde{\phi}}), M^{\nu(\cdot|\phi)}(\cdot|\pi^{\tilde{\phi}})\right)\right]} \\
 &\leq 4\sqrt{d \E_{\phi\sim \nu}  \E_{\tilde{\phi}\sim \nu} 
 \left[D_{\textsc{H}}^2 \left(M^{\nu(\cdot|\phi)}(\cdot|\pi^{\tilde{\phi}}), M^{\nu}(\cdot|\pi^{\tilde{\phi}})\right)\right]} \\
 &= 4\sqrt{d \E_{\pi\sim p}\E_{\phi\sim \nu} 
 \left[\KL \left(M^{\nu(\cdot|\phi)}(\cdot|\pi), M^{\nu}(\cdot|\pi)\right)\right]}. 
\end{align*}
Further combining this with \pref{eq: break 4} and \pref{eq: break1}, we get 
\begin{align*}
    &\mathbb{E}_{\pi\sim p}  \E_{\phi\sim \nu}\left[ V_{M^{\nu(\cdot|\phi)}}(\pi^\phi) - V_{M^{\nu(\cdot|\phi)}}(\pi) - \frac{1}{\eta}\KL\left(M^{\nu(\cdot|\phi)}(\cdot|\pi), M^{\nu}(\cdot|\pi)\right)\right] \\ 
    &=\mathbb{E}_{\pi\sim p}  \E_{(M,\pi^\star)\sim \nu}\left[ V_M(\pi^\star) - V_M(\pi) - \frac{1}{\eta}\KL\left(M^{\nu(\cdot|\phi)}(\cdot|\pi), M^{\nu}(\cdot|\pi)\right)\right] \\ 
    &\leq 4H\sqrt{d \E_{\pi\sim p}\E_{\phi\sim \nu} 
 \left[\KL \left(M^{\nu(\cdot|\phi)}(\cdot|\pi), M^{\nu}(\cdot|\pi)\right)\right]} - \frac{1}{\eta} \E_{\pi\sim p}\E_{\phi\sim \nu}\left[\KL \left(M^{\nu(\cdot|\phi)}(\cdot|\pi), M^{\nu}(\cdot|\pi)\right)\right] \\
 &\leq 4\eta dH^2. 
 \end{align*}

    \iffalse
    \begin{align*}
        &\E_{\phi\sim \nu} \E_{\phi'\sim \nu} \inner{X_h(\pi^\phi; \bar{M}^{\nu(\cdot|\phi')}), W(\phi) - W(\phi') } \\
        &\leq \sqrt{2d \E_{\phi\sim \nu} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu} \inner{X_h(\pi^\phi; \bar{M}^{\nu(\cdot|\phi')}), W(\tilde{\phi}) - W(\phi') }^2} \\
        &= \sqrt{2d \E_{\phi\sim \nu} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu} \left(\E^{\pi^\phi, \bar{M}^{\nu(\cdot|\phi')}}\left[\varphi(s_h,a_h)^\top \theta^{\tilde{\phi}} - \psi(s_{h+1})^\top w^{\tilde{\phi}}\right] - \E^{\pi^\phi, \bar{M}^{\nu(\cdot|\tilde{\phi})}}\left[Q_{\tilde{\phi}}(s,a) - r - V_{\tilde{\phi}}(s')\right]\right)^2} \\
        &\leq  \sqrt{d \E_{\phi\sim \nu} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu} \left( D_{\textsc{TV}}\left( \bar{M}^{\nu(\cdot|\phi')}(\pi^\phi), \bar{M}^{\nu(\cdot|\tilde{\phi})}(\pi^\phi) \right) \right)^2} \\
        &\leq  \sqrt{2d \E_{\phi\sim \nu} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu}  D_{\textsc{H}}^2\left( \bar{M}^{\nu(\cdot|\phi')}(\pi^\phi), \bar{M}^{\nu(\cdot|\tilde{\phi})}(\pi^\phi) \right)} \\
        &=  \sqrt{ 2d\E_{\pi\sim p} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu}  D_{\textsc{H}}^2\left( \bar{M}^{\nu(\cdot|\phi')}(\pi), \bar{M}^{\nu(\cdot|\tilde{\phi})}(\pi) \right)} \\
        &=  \sqrt{ 4d\E_{\pi\sim p} \E_{\tilde{\phi}\sim \nu}\E_{\phi'\sim \nu}  \left(D_{\textsc{H}}^2\left( \bar{M}^{\nu(\cdot|\phi')}(\pi), \bar{M}^{\nu}(\pi) \right) + D_{\textsc{H}}^2\left( \bar{M}^{\nu}(\pi), \bar{M}^{\nu(\cdot|\tilde{\phi})}(\pi) \right) \right)} \\
        &\leq  \sqrt{8d \E_{\pi\sim p} \E_{\phi\sim \nu}  D_{\textsc{H}}^2\left( \bar{M}^{\nu(\cdot|\phi)}(\pi), \bar{M}^{\nu}(\pi) \right)} \\
        &\leq \sqrt{8d \E_{\pi\sim p} \E_{\phi\sim \nu}  D_{\textsc{KL}}\left( \bar{M}^{\nu(\cdot|\phi)}(\pi), \bar{M}^{\nu}(\pi) \right)} \\
        &\leq 2\eta d + \frac{1}{\eta}\E_{\pi\sim p} \E_{\phi\sim \nu}  D_{\textsc{KL}}\left( \bar{M}^{\nu(\cdot|\phi)}(\pi), \bar{M}^{\nu}(\pi) \right). 
    \end{align*}
    \fi
    Finally, notice that the choice of $p$ in the definition of $\dec^{\textsc{KL}}_\eta(\calM,\Phi)$ allows it to achieve a smaller value than the choice of $p$ as a marginal distribution of $\nu$. This gives the desired bound. 
\end{proof}

