\subsection{Proof of \cref{thm: optimal asham}}
\label{subapp: proof asham}

\begin{proof}
    The proof strategy is a straightforward combination of \cref{thm: optimal shampoo} and \cref{thm: alicec 1 step refinement}. First, when we assume $\tilde{\mD}$ has the Kronecker product structure, one can easily write 
    \begin{align*}
        &(\mU_R\otimes \mU_L)(\mS_R\otimes \mS_L)(\mU_R\otimes \mU_L)^T\\
        =& (\mU_R\otimes \mU_L)\left[(\mS_R\mU_R^T)\otimes (\mS_L\mU_L^T)\right]\\
        =& \underbrace{(\mU_R\mS_R\mU_R^T)}_{\mA}\otimes \underbrace{(\mU_L\mS_L\mU_L^T)}_{\mB}
    \end{align*}
    Therefore the loss (\cref{eq: UFE equation}) becomes
    \begin{align*}
        \Fnorm{\mA\mB-\mC\mC}
    \end{align*}
    where $\mC = \E[\vecg\vecg^T]^{\frac{1}{2}}$. 
    This is exactly the formulation used in \cref{thm: optimal shampoo} with $\mR_n^{\frac{1}{2}} = \mU_R\mS_R\mU_R^T$ and $\mL_m^{\frac{1}{2}} = \mU_L\mS_L\mU_L^T$. 

    Thus, by directly utilizing \cref{thm: optimal shampoo}, we can see the optimal solution
    \begin{align*}
        \mU_R\mS_R^2\mU_R^T &= \E[\mG^T\mG]\\
        \mU_L\mS_L^2\mU_L^T &= \E[\mG\mG^T]
    \end{align*}
    Due to the structural assumption of $\mU_R$, $\mU_L$, $\mS_R$, $\mS_L$, their corresponding optimal solution can directly obtained using eigenvalue decomposition. 

    Now, let's prove the optimal $\tilde{\mD}$ with any fixed $\mU_R$, $\mU_L$. This is also straightforward by applying the same technique as \cref{thm: alicec 1 step refinement}. 
    The loss can be written as 
    \begin{align*}
        &\Fnorm{\underbrace{(\mU_R\otimes \mU_L)}_{\Pi}\tilde{\mD}\underbrace{(\mU_R\otimes \mU_L)^T}_{\Pi^T}-\mF}\\
        =& \Fnorm{\Pi\tilde{\mD}\Pi^T} - 2\tr\left(\Pi^T\E[\vecg\vecg^T]\Pi\tilde{\mD}\right) + C
    \end{align*}
    Since it is easy to verify orthonormality of $\Pi$, i.e.$\Pi^T\Pi=\mI$, the above is simplified to
    \begin{align*}
        &\Fnorm{\tilde{\mD}}-2\tr\left(\Pi^T\E[\vecg\vecg^T]\Pi\tilde{\mD}\right)\\
        &=\sum_{i=1}^{mn} D_{ii}^2 -2 \sum_{i=1}^{mn} D_{ii}[\Pi]_{i}^T\E[\vecg\vecg^T][\Pi]_{i}
    \end{align*}
    where $[\Pi]_i$ is the $i^{\text{th}}$ column of matrix $\Pi$. Then, by taking the derivative, the optimal $D_{ii}$:
    \begin{align*}
        D^*_{ii} &= [\Pi]_i^T\E[\vecg\vecg^T][\Pi]_i\\
        =&\E[([\Pi]_i^T\vecg)^2]
    \end{align*}
    Therefore, 
    \begin{align*}
        \diag(\tilde{\mD}^*) &= \E[(\Pi^T\vecg)^2]\\
        =& \E[((\mU_R^T\otimes \mU_L^T)\vecg)^2]\\
        =&\vect((\E[(\mU_L^T\mG\mU_R)\elesquare]))\\
    \end{align*}
    \begin{align*}
        \Rightarrow \tilde{\mD}^* = \diag_M((\E[(\mU_L^T\mG\mU_R)\elesquare]))
    \end{align*}
    
\end{proof}