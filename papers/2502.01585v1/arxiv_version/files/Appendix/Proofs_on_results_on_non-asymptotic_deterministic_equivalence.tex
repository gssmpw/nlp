\section{Proofs on additional non-asymptotic deterministic equivalents}
\label{app:proof_non-asy_results}

In this section, we aim to generalize \cref{eq:det_equiv_phi2_main} for any PSD matrix $\bm A$, i.e.
\begin{equation*}
         \big\vert \Phi_2(\bX;\bA) - \Psi_2 (\mu_* ; \bA) \big\vert \leq \widetilde{\mathcal{O}}(n^{-\frac{1}{2}}) \cdot \Psi_2 (\mu_* ; \bA) \,,
\end{equation*}
that is required to derive our non-asymptotic deterministic equivalence for the bias term of the $\ell_2$ norm.


By introducing a change of variable $\mu_* := \mu_* (\lambda) = \lambda / \lambda_*$, we find that $\mu_*$ satisfies the following fixed-point equation:
\begin{align}\label{eq:det_equiv_fixed_point_mu_star}
    \mu_* = \frac{n}{1 + \Tr(\bSigma (\mu_* \bSigma + \lambda)^{-1} )}.
\end{align}
We define \(\bt\) and \(\bT\) as follows
\[
    \bt = \bSigma^{-\nicefrac{1}{2}}\bx\,, \quad \bT = \bX\bSigma^{-\nicefrac{1}{2}}\,. 
\]
And the following resolvents are also defined 
\[
    \bR := (\bX^\sT \bX + \lambda)^{-1}\,, \quad \overline{\bR} := (\mu_*\bSigma + \lambda)^{-1}\,, \quad 
    \bM := \bSigma^{\nicefrac{1}{2}} \bR \bSigma^{\nicefrac{1}{2}}\,, \quad \overline{\bM} := \bSigma^{\nicefrac{1}{2}} \overline{\bR} \bSigma^{\nicefrac{1}{2}}.
\]

Since the proof relies on a leave-one-out argument, we define \(\bX_- \in \mathbb{R}^{(n-1) \times d}\) as the data matrix obtained by removing one data. We also introduce the associated resolvent and rescaled resolvent:
\[
    \bR_- := (\bX_-^\sT \bX_- + \lambda)^{-1}\,, \quad
    \overline{\bR}_- :=\left(\frac{n}{1+\kappa}\bSigma + \lambda\right)^{-1}\,, \quad \bM_- := \bSigma^{\nicefrac{1}{2}} \bR_- \bSigma^{\nicefrac{1}{2}}\,, \quad \overline{\bM}_- := \bSigma^{\nicefrac{1}{2}} \overline{\bR}_- \bSigma^{\nicefrac{1}{2}}\,,
\]
where \(\kappa = \E[\Tr(\bM_-)]\).

For the sake of narrative convenience, we introduce a functional used in \cite{misiakiewicz2024non}
\[
\Psi_1(\mu_*; \bA) := \Tr(\bA\bSigma(\mu_*\bSigma + \lambda)^{-1})\,.
\]

Next, we give the proof of \cref{eq:det_equiv_phi2_main}. We consider the functional
\[
\Phi_2 (\bX ; \bA) = \Tr(\bA \bSigma^{-\nicefrac{1}{2}} \bX^\sT \bX ( \bX^\sT \bX + \lambda)^{-1}\bSigma^{\nicefrac{1}{2}} ) = \Tr( \bA \bT^\sT \bT \bM)  .
\]
{\bf Remark:} Note that, to align more closely with the proof in \cite{misiakiewicz2024non}, the \(\Phi_2 (\bX; \bA)\) defined here differs slightly from the \(\Phi_2 (\bX; \bA, \lambda)\) in \cref{eq:det_equiv_phi2_main}. However, the two definitions are equivalent if we take \(\bA\) here as \(\bA = \bSigma^{-\nicefrac{1}{2}} \bB \bSigma^{\nicefrac{1}{2}}\), which recovers the formulation in \cref{eq:det_equiv_phi2_main}.


We show that $\Phi_2 (\bX;\bA)$ is well approximated by the following deterministic equivalent:
\[
\Psi_2(\mu_*; \bA) = \Tr(\bA \mu_* \bSigma ( \mu_* \bSigma + \lambda)^{-1} ) = \Tr(\bA \bSigma ( \bSigma + \lambda_* )^{-1} ).
\]

\begin{theorem}[Deterministic equivalent for $\Tr(\bA \bT^\sT \bT \bM)$]\label{thm_app:det_equiv_TrAZZM}
    Assume the features $\{\bx_i\}_{i\in[n]}$ satisfy \cref{ass:concentrated_LR} with a constant $C_* > 0$. Then for any $D,K>0$, there exist constants $\eta \in (0,1/2)$, $C_{D,K} >0$, and $C_{*,D,K}>0$ ensuring the following property holds. For any $n \geq C_{D,K}$ and  $\lambda >0$, if the following condition is satisfied:
    \begin{equation}\label{eq:conditions_thm4}
\lambda \cdot \rho_\lambda (n) \geq n^{-K}, \qquad  \rho_\lambda (n)^{2} \log^{\frac{3}{2}} (n) \leq K \sqrt{n} ,
    \end{equation}
    then for any PSD matrix $\bA$, with probability at least $1 - n^{-D}$, we have that
    \begin{equation}
         \big\vert \Phi_2(\bX;\bA) - \Psi_2 (\mu_* ; \bA) \big\vert \leq C_{*,D,K} \frac{ \rho_\lambda (n)^{4} \log^{\frac32} (n ) }{\sqrt{n}}   \Psi_2 (\mu_* ; \bA) .
    \end{equation}
\end{theorem}
\noindent{\bf Remark:} \cref{thm_app:det_equiv_TrAZZM} generalizes \cref{eq:det_equiv_phi2_main}. Note that there are some differences between \(\rho_\lambda\) as defined in \cref{eq:rho_lambda} and \(\nu_\lambda\) as defined in \cite{misiakiewicz2024non}. However, based on the discussion in \citet[Appendix A]{defilippis2024dimension}, \(\nu_\lambda\) can be easily adjusted to match \(\rho_\lambda\). Therefore, while we follow the argument in \cite{misiakiewicz2024non}, we use \(\rho_\lambda\) directly in this work to minimize additional notation.


Following the approach outlined in \cite{misiakiewicz2024non}, our proof involves separately bounding the deterministic and martingale components. This is accomplished in the following two propositions.

\begin{proposition}[Deterministic part of $\Tr(\bA \bT^\sT \bT \bM)$]\label{prop:TrAZZM_LOO}
    Under the same assumption as \cref{thm_app:det_equiv_TrAZZM}, there exist constants $C_K$ and $C_{*,K}$, such that for all $n \geq C_K$ and $\lambda >0$ satisfying \cref{eq:conditions_thm4}, and for any PSD matrix $\bA$, we have
    \begin{equation}\label{eq:det_part_TrAZZM}
         \big\vert\E [ \Phi_2(\bX;\bA) ] - \Psi_2 (\mu_* ; \bA) \big\vert \leq C_{*,K} \frac{ \rho_\lambda (n)^{4} }{\sqrt{n}}   \Psi_2 (\mu_* ; \bA) .
    \end{equation}
\end{proposition}

\begin{proposition}[Martingale part of $\Tr(\bA \bT^\sT \bT \bM)$] \label{prop:TrAZZM_martingale}
    Under the same assumption as \cref{thm_app:det_equiv_TrAZZM}, there exist constants $C_{K,D}$ and $C_{*,D,K}$, such that for all $n \geq C_{K,D}$ and  $\lambda >0$ satisfying \cref{eq:conditions_thm4}, and for any PSD matrix $\bA$, we have with probability at least $1 -n^{-D}$ that
    \begin{equation}\label{eq:mart_part_TrAZZM}
         \big\vert \Phi_2(\bX;\bA)  - \E [ \Phi_2(\bX;\bA) ]  \big\vert \leq C_{*,D,K} \frac{ \rho_\lambda (n)^{3} \log^{\frac32} (n)}{\sqrt{n}} \Psi_2 (\mu_* ; \bA) .
    \end{equation}
\end{proposition}

Theorem \ref{thm_app:det_equiv_TrAZZM} is obtained by combining the bounds \eqref{eq:det_part_TrAZZM} and \eqref{eq:mart_part_TrAZZM}. Next, we prove the two propositions above separately.


\begin{proof}[Proof of Proposition \ref{prop:TrAZZM_LOO}]
First, by Sherman-Morrison identity 
\[
    \bM = \bM_- - \frac{\bM_-\bt\bt^\sT\bM_-}{1+\bt^\sT\bM_-\bt}\,,\quad \text{and} \quad \bM\bt = \frac{\bM_-\bt}{1+\bt^\sT\bM_-\bt}\,,
\]
we decompose $\E[\Phi_2(\bX;\bA)]$ as 

\[
\begin{aligned}
\E \left[ \Tr( \bA \bT^\sT \bT \bM) \right] =&~ n\E \left[ \frac{\bt^\sT \bM_- \bA \bt}{1 + S}\right] \\
= &~ n\frac{\E[\Tr ( \bA \bM_- )]}{1 + \kappa} + n\E \left[ \frac{\kappa - S}{(1+\kappa)(1 + S)} \bt^\sT \bM_- \bA \bt\right],
\end{aligned}
\]
where we denoted $S = \bt^\sT \bM_- \bt$. Therefore, bounding the following two terms is sufficient
\begin{equation}\label{eq:decompo_deterministic_2}
\begin{aligned}
    \left|\E[\Phi_2(\bX;\bA)] -\Psi_2(\mu_*;\bA)\right| \le&~
    \left|\frac{n\E[\Tr (  \bA \bM_- )]}{1 + \kappa} - \Psi_2( \mu_*;\bA)\right|+ 
    \left| n\E \left[ \frac{\kappa - S}{(1+\kappa)(1 + S)} \bt^\sT \bM_- \bA \bt\right] \right|.
\end{aligned}
\end{equation}


For the first term,  recall that $\tmu_*$ is the solution of the equation \eqref{eq:det_equiv_fixed_point_mu_star} where we replaced $n$ by $n-1$, and $\tmu_- := n/(1+ \kappa)$. By \citet[Proposition 2]{misiakiewicz2024non}, we have 
\[
\left| \E[\Tr (  \bA \bM_- )] - \Psi_1 (\tmu_* ; \bA ) \right| \leq \cE^{(\sfD)}_{1,n-1}  \cdot \Psi_1 (\tmu_* ; \bA )\,,
\]
where $\cE^{(\sfD)}_{1,n-1} = C_{*,K} \frac{ \rho_\lambda (n)^{5/2} }{\sqrt{n-1}}$. For $n \geq C$, we have $\cE_{1,n-1}^{(\sfD)} \leq C \cE_{1,n}^{(\sfD)}$ and by \citet[Lemma 3]{misiakiewicz2024non}, we have
\[
|\Psi_1 (\tmu_* ; \bA ) - \Psi_1 (\mu_* ; \bA )| \leq C \frac{\rho_\lambda(n)}{n} \Psi_1 (\mu_* ; \bA )\,.
\]
Combining the above bounds, we obtain
\[
\left| \E[\Tr (  \bA \bM_- )] - \Psi_1 (\mu_* ; \bA ) \right| \leq \cE^{(\sfD)}_{1,n}  \cdot \Psi_1 (\mu_* ; \bA )\,.
\]
Furthermore, from the proof of \citet[Proposition 4, Claim 3]{misiakiewicz2024non}, we have
\[
\frac{| \mu_* - \tmu_- |}{\tmu_-} \leq C_{*,K} \frac{ \rho_\lambda (n)^{5/2}}{\sqrt{n}}.
\]
Then we conclude that
\begin{align*}
| \mu_* - \tmu_- | &\leq C_{*,K} \frac{ \rho_\lambda (n)^{5/2}}{\sqrt{n}} \cdot \tmu_- \\
&\leq C_{*,K} \frac{ \rho_\lambda (n)^{5/2}}{\sqrt{n}} \cdot \left(1 + C_{*,K} \frac{ \rho_\lambda (n)^{5/2}}{\sqrt{n}}\right)\mu_* \\
&\leq C_{*,K} \frac{ \rho_\lambda (n)^{5/2}}{\sqrt{n}} \cdot \mu_*,    
\end{align*}
where we use condition \eqref{eq:conditions_thm4} in the last inequality.


Combining this inequality with the previous bounds, we obtain
\[
\begin{aligned}
 \left|\frac{n\E[\Tr (\bA \bM_-)]}{1 + \kappa} - \Psi_2( \mu_* ; \bA)\right| =&~ \left|\tmu_-\E[\Tr (  \bA \bM_- )] - \mu_*\Psi_1(\mu_* ;\bA)\right| \\
 \leq&~ \tmu_- \left| \E[\Tr (\bA \bM_-)] - \Psi_1 ( \mu_* ; \bA) \right| + \frac{| \tmu_- - \mu_*|}{\mu_*} \cdot \mu_* \Psi_1 ( \mu_* ; \bA)\\ 
 \leq&~ C \cE_{1,n}^{(\sfD)} \cdot \mu_*\Psi_1 (\mu_* ; \bA)\\
 =&~ C \cE_{1,n}^{(\sfD)} \cdot \Psi_2 (\mu_* ; \bA)\,.\\
\end{aligned}
\]

In the next, we aim to estimate the second term in Eq.~\eqref{eq:decompo_deterministic_2}. Here we can reduce $\bA$ to be a rank-one matrix $\bA:= \bm v \bm v^{\sT}$ following \citet[Eq. (77)]{misiakiewicz2024non}. We simply apply H\"older's inequality and obtain
\begin{align*}
n\left| \E\left[\frac{\kappa- S}{(1+\kappa)(1+S)}\bt^\sT \bM_- \bA \bt\right]\right| =&~ n \E\left[\left|\frac{\kappa- S}{(1+\kappa)(1+S)}\bt^\sT \bM_- \bv \bv^\sT \bt\right|\right]\\
\leq&~ n\mathbb{E}_{\bm M_-} \left[ \E_{\bt}\left[(\kappa - S)^2 \right]^{\nicefrac{1}{2}} \E_{\bt}\left[(\bt^\sT \bM_- \bv \bv^\sT \bt)^2\right]^{\nicefrac{1}{2}} \right]\\
\leq&~ n\mathbb{E}_{\bm M_-} \left[ \E_{\bt}\left[(\kappa - S)^2 \right]\right]^{\nicefrac{1}{2}} \E_{\bM_-}\left[\E_{\bt}\left[(\bt^\sT \bM_- \bv \bv^\sT \bt)^2\right] \right]^{\nicefrac{1}{2}}\\
\leq&~ n\mathbb{E}_{\bm M_-} \left[ \E_{\bt}\left[(\kappa - S)^2 \right]\right]^{\nicefrac{1}{2}} \E_{\bM_-}\left[\E_{\bt}\left[(\bt^\sT \bM_- \bv)^{4}\right]^{\nicefrac{1}{2}} \E_\bt\left[(\bv^\sT \bt)^4\right]^{\nicefrac{1}{2}} \right]^{\nicefrac{1}{2}}.
\end{align*}
Each of these terms can be bounded, according to the proof of \citet[Proposition 2]{misiakiewicz2024non}, for the first term, we get
\[
 \E_{\bM_-} \left[ \E_{\bt} \left[ ( \bt^\sT \bM_- \bt - \kappa)^2\right] \right]^{1/2 } \leq  C_{*,K} \frac{ \rho_\lambda (n)}{\sqrt{n}} .
\]

For the second term, first according to \citet[Lemma 2]{misiakiewicz2024non}, we have
\[
\E_\bt \left[(\bt^\sT \bM_- \bv)^4\right]^{\nicefrac{1}{2}} \leq C_{*,K} \bv^\sT \bM_-^2 \bv \,,
\]
\[
\E_\bt \left[(\bv^\sT \bt)^4\right]^{\nicefrac{1}{2}} \leq C_{*,K} \bv^\sT \bv \,.
\]
Thus we have
\[
\begin{aligned}
\E_{\bM_-}\left[\E_{\bt}\left[(\bt^\sT \bM_- \bv)^{4}\right]^{\nicefrac{1}{2}} \E_\bt\left[(\bv^\sT \bt)^4\right]^{\nicefrac{1}{2}} \right]^{\nicefrac{1}{2}}
&\leq \E_{\bM_-}\left[C_{*,K} \bv^\sT \bM_-^2 \bv \bv^\sT \bv \right]^{\nicefrac{1}{2}}\\
&= C_{*,K} \E_{\bM_-}\left[\Tr(\bA\bM_-^2 \bA) \right]^{\nicefrac{1}{2}}.
\end{aligned}
\]
Then according to \citet[Lemma 4.(b)]{misiakiewicz2024non}, we have
\[
\E_{\bM_-}\left[\Tr(\bA\bM_-^2 \bA) \right] \leq C_{*,K}\rho^2_{\lambda}(n)\Tr(\bA \obM_-^2 \bA) = C_{*,K}\rho^2_{\lambda}(n)\Tr(\bA \obM_-)^2,
\]
where the last inequality holds due to $\bA\obM_-$ being a rank-1 matrix. Combining the bounds for the second term, we have
\[
\begin{aligned}
\E_{\bM_-}\left[\E_{\bt}\left[(\bt^\sT \bM_- \bv)^{4}\right]^{\nicefrac{1}{2}} \E_\bt\left[(\bv^\sT \bt)^4\right]^{\nicefrac{1}{2}} \right]^{\nicefrac{1}{2}} \leq  C_{*,K}\rho_{\lambda}(n)\Tr(\bA\obM_-) \leq C_{*,K}\rho_{\lambda}^2(n)\Tr(\bA\obM).
\end{aligned}
\]
By combining the above bounds for the first and second term, we have
\[
\begin{aligned}
n\left| \E\left[\frac{\kappa- S}{(1+\kappa)(1+S)}\bT^\sT \bM_- \bA \bT\right]\right| &\leq C_{*,K} \frac{ \rho_\lambda^3 (n) }{\sqrt{n}} n\Tr(\bA\obM)\\
&\leq C_{*,K} \frac{ \rho_\lambda^4 (n) }{\sqrt{n}} \mu_*\Tr(\bA\obM),
\end{aligned}
\]
where we use $\mu_* = \frac{n}{1+\Tr(\obM)} \geq \frac{n}{2\rho_\lambda(n)}$ according to \citet[Lemma 3]{misiakiewicz2024non} in the last inequality.

Combining the above bounds concludes the proof.
\end{proof}


\begin{proof}[Proof of Proposition \cref{prop:TrAZZM_martingale}]
The martingale argument follows a similar approach to the proofs of \citet[Propositions 3 and 5]{misiakiewicz2024non}. The key remaining steps are to adjust Step 2 in \citet[Proposition 3]{misiakiewicz2024non} and establish high-probability bounds for each term in the martingale difference sequence.

We rewrite this term as a martingale difference sequence
\[
\begin{aligned}
 S_n := \Tr(\bA \bT^\sT \bT \bM) - \E[\Tr(\bA \bT^\sT \bT \bM)] = \sum_{i =1}^n  \left( \E_i - \E_{i-1} \right) \Tr( \bA \bT^\sT \bT \bM) =:\sum_{i = 1}^n \Delta_i\,,
\end{aligned}
\]
where \(\E_i\) is denoted as the expectation over \(\{\bx_{i+1},\cdots,\bx_n\}\).

We show below that $|\Delta_i| \leq R$ with probability at least $1 - n^{-D}$ with
\begin{equation}\label{eq:Rchoice_AMZZM}
R =  C_{*,D,K} \frac{ \rho_\lambda(n)^2 \log(n)}{n} \Psi_2( \mu_* ; \bA).
\end{equation}

For Step 3 and bounding $\E_{i-1}[\Delta_i \ind_{\Delta_i \not\in[-R,R]}] $, observe that with probability at least $1-n^{-D}$, by \citet[Lemma 4.(b)]{misiakiewicz2024non}
\[
\begin{aligned}
\E_{i-1} [ \Delta_i^2]^{\nicefrac{1}{2}} 
&~\leq 
2 \E_{i-1} \left[ \frac{(\bt^\sT \bM_- \bA \bt)^2}{(1+S)^2}\right]^{\nicefrac{1}{2}} \\
&~\leq 
C_{*,D,K} \frac{\rho_\lambda (n)^3\log^{1/2}(n)}{n} \mu_* \Tr(\bA \obM) \\
&~\leq 
C_{*,D,K} \frac{\rho_\lambda (n)^3\log^{1/2}(n)}{n} \Psi_2 (\mu_* ; \bA).
\end{aligned}
\]

We establish a high-probability bound for \(\Delta_i\) by first decomposing it and strategically adding and subtracting carefully chosen terms. Observing that
\[
\Delta_i = \left( \E_i - \E_{i-1} \right) \Tr( \bA \bT^\sT \bT \bM) = \left( \E_i - \E_{i-1} \right) \left( \Tr( \bA \bT^\sT \bT \bM) - \Tr( \bA \bT_i^\sT \bT_i \bM_i)\right)  ,
\]
where $\bM_i$ is the rescaled resolvent removes $\bx_i$, and we used that $\E_i\left[\bA\bT_i^\sT \bT_i \bM_i\right] = \E_{i-1}\left[\bA\bT_i^\sT \bT_i \bM_i\right]$, and we'll write (recall that $S_i = \bt_i^\sT \bM_i \bt_i$)
\begin{align*}
    \Tr(\bA \bT^\sT \bT \bM ) -\Tr(\bA \bT_i^\sT \bT_i \bM_i )
    =&~
    \Tr(\bA (\bt_i \bt_i^\sT + \bT_i^\sT \bT_i) \bM ) -\Tr(\bA \bT_i^\sT \bT_i \bM_i )\\
    =&~ 
    \bt_i^\sT \bM \bA\bt_i +   \Tr( \bA \bT_i^\sT \bT_i \bM)
    -\Tr( \bA \bT_i^\sT\bT_i \bM_i)\\
    =&~ 
    \frac1{(1+S_i)} \left\{ \bt_i^\sT \bM_i \bA \bt_i -   \Tr(\bA \bT_i^\sT \bT_i \bM_i \bt_i\bt_i^\sT \bM_i) \right\}\\
    =&~ 
    \frac1{(1+S_i)} \Tr(\bt_i \bt_i^\sT \bM_i \bA (\id - \bT_i^\sT \bT_i \bM_i)).
\end{align*}
Observing that 
\begin{equation*}
  \id - \bT_i^\sT\bT_i \bM_i = \lambda \bSigma^{-1} \bM_i,
\end{equation*}
we can write for $j\in\{i-1,i\}$, with probability at least $1 - n^{-D}$,
\begin{align*}
\left|\E_{j} \left[
\frac1{(1+S_i)} \Tr( \bt_i\bt_i^\sT \bM_i \bA (\id -\bT_i^\sT\bT_i \bM_i ))
\right]\right| 
\le &
\lambda \E_{j} \left[ | \bt_i^\sT \bM_i \bA \bSigma^{-1} \bM_i \bt_i | \right]\\ 
\le&~
\E_{j} \left[ | \bt_i^\sT \bM_i \bA \bt_i | \right]\\
\le&~
C_{*,D}  \log(n) \E_{j} \left[ \Tr(\bA\bM_i) \right]\\
\leq&~ C_{*,D}  \rho_\lambda(n)  \log(n) \Tr(\bA \obM)\\
\leq&~ C_{*,D} \frac{ \rho_\lambda(n)^2  \log(n)}{n} \mu_*\Tr(\bA\obM)\\
=&~ C_{*,D} \frac{ \rho_\lambda(n)^2  \log(n)}{n} \Psi_2 (\mu_* ; \bA),
\end{align*}
where we used that $\bM_i \preceq \bSigma / \lambda$ by definition in the second inequality, \citet[Lemma 4.(b)]{misiakiewicz2024non} in the fourth inequality, and $\mu_* = \frac{n}{1+\Tr(\obM)} \geq \frac{n}{2\rho_\lambda(n)}$ in the last inequality.

Applying a union bound and adjusting the choice of \(D\), we conclude that with probability at least \(1 - n^{-D}\), the following holds for all \(i \in [n]\):
\[
| \Delta_i | \leq C_{*,D,K} \frac{ \rho_\lambda (n)^2 \log (n) }{n} \Psi_2 (\mu_* ; \bA)\,.
\]
\end{proof}

