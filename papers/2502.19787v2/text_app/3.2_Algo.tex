\section{Pseudo Algorithm for ICL-HCG}
\label{app:alg}
We summarize our meta framework for ICL-HCG in Algorithm~\ref{alg:framework}.
\begin{algorithm}
  \caption{Meta-Learning Framework for ICL-HCG}
  \label{alg:framework}
  \begin{algorithmic}[1]
    \STATE \textbf{Inputs:} a set of inputs $\mathcal{X}$, a training set of hypothesis classes $\mathcal{S}^{\text{train}}=\{\mathcal{H}_i^{\text{train}}\}_{i=1}^{N^{\text{train}}}$, a testing set of hypothesis classes $\mathcal{S}^{\text{test}}=\{\mathcal{H}_i^{\text{test}}\}_{i=1}^{N^{\text{test}}}$, batch size $B$, hypothesis prefix size $L$, and context query size $K$
    \FOR{\textbf{training epoch}}
      \STATE sample $\{\mathcal{H}_i\}_{i=1}^B \overset{\text{i.i.d.}}{\sim} \text{Uniform}(\mathcal{S}^{\text{train}})$
      \FOR{each hypothesis class $\mathcal{H} \in \{\mathcal{H}_i\}_{i=1}^B$}
        \STATE generate $h,\SK$ following \hyperref[asu:iid]{i.i.d. Generation}
        
        \STATE \textbf{// Construct sequence based on $\mathcal{H}$, $h$, and $\SK$}
        \STATE construct hypothesis prefix, context query, and hypothesis index $z$ based on $\mathcal{H}$, $h$, $\SK$
        \STATE $s \gets \text{concatenate}(\text{hypothesis prefix}, \text{context query}, z)$
    
        \STATE \textbf{// Cross-entropy loss for next token prediction}
        \STATE $\mathcal{L} \gets -\sum_{t=2}^{|s|} \log P(s_t \mid s_{<t})$
      \ENDFOR
      \STATE update model parameters using $\mathcal{L}$ of the batch
    \ENDFOR
    
    \FOR{\textbf{testing epoch}}
      \STATE sample $\{\mathcal{H}_i\}_{i=1}^B \overset{\text{i.i.d.}}{\sim} \text{Uniform}(\mathcal{S}^{\text{test}})$
      
      \FOR{each hypothesis class $\mathcal{H} \in \{\mathcal{H}_i\}_{i=1}^B$}
        \STATE generate $h,\SK$ via:
        \STATE \quad \textbf{either} following \hyperref[asu:iid]{i.i.d. Generation}
        \STATE \quad \textbf{or} following \hyperref[asu:optt]{Opt-T Generation}
        \STATE \textbf{construct sequence $s$ based on $\mathcal{H}$, $h$, and $\SK$}
        \STATE \textbf{evaluate the prediction accuracy on $y$, $z$, etc}
      \ENDFOR
    \ENDFOR
  \end{algorithmic}
\end{algorithm}
