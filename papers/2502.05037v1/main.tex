
\documentclass[10pt, tikz, border=0.1cm]{article} % For LaTeX2e
\usepackage[accepted]{tmlr}

\usepackage{tikz}
\usetikzlibrary{bayesnet}
\usepackage{amsmath, amsthm, amssymb, amsfonts}
\tikzset{>=latex}
\usepackage{filecontents}
\usepackage{placeins}
% if you need to pass options to natbib, use, e.g.:
    \PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2024

\usepackage{hyperref}
\usepackage{url}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors

%\usepackage{enumitem}
\usepackage[textsize=tiny]{todonotes}

% Added by Lokesh

%%%%%%%%%%%%%For putting tables side-by-side%%%%%%%%%
\usepackage{float}
\usepackage{caption}

\usepackage{array}
\newcolumntype{C}[1]{p{#1}}
\usepackage{icomma}
\usepackage{ragged2e}
\usepackage{wrapfig,lipsum,booktabs}
\RequirePackage[inline,shortlabels]{enumitem}

\usepackage{algcompatible}
\usepackage{algorithm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\usepackage{graphicx}
% \usepackage{subcaption}
% \usepackage{subfigure}
\usepackage{booktabs} 
\usepackage{xcolor,colortbl}
\definecolor{green}{rgb}{0.8,1,0.8}
\definecolor{yellow}{rgb}{1,1,0.87}
\definecolor{cyan}{rgb}{0.0, 1.0, 1.0}
% \newcommand{\first}[1]{{\cellcolor{green} #1}}
% \newcommand{\second}[1]{{\cellcolor{yellow} #1}}
\newcommand{\first}[1]{{\colorbox{green}{\textbf{#1}}}}
\newcommand{\second}[1]{{\colorbox{yellow}{\underline{#1}}}}

% \newcommand{\first}[1]{{{\textbf{#1}}}}
% \newcommand{\second}[1]{{{\underline{#1}}}}

\newcommand{\third}[1]{{\cellcolor{cyan!50} #1}}

\usepackage{subdef}
\newcommand{\yhat}{\widehat{y}}
\newcommand{\indep}{\rotatebox[origin=c]{90}{$\models$}}

% \usepackage{algpseudocode}
% \usepackage{algorithm}
\usepackage{hyperref}


\usepackage[subtle]{savetrees}

% For bayesnets
\usepackage{tikz}
\usetikzlibrary{bayesnet}
\usetikzlibrary{arrows}
\usepackage{color}
\usepackage{caption}
\usepackage{subcaption}
\usetikzlibrary{backgrounds}

\usepackage{titlesec}

% minimize spacing
% \titlespacing\section{0pt}{1pt plus 0pt minus 1pt}{1pt plus 0pt minus 1pt}
\titlespacing\subsection{0pt}{0pt plus 1pt minus 1pt}{0pt plus 1pt minus 1pt}
\titlespacing\subsubsection{0pt}{0pt plus 1pt minus 1pt}{0pt plus 1pt minus 1pt}
\titlespacing{\lemma}{0pt}{0pt plus 1pt minus 1pt}{0pt plus 1pt minus 1pt}

\newcommand{\xhdr}[1]{\vspace{1.5mm}\noindent{\bf #1.}}

\renewcommand{\xb}{\bm{x}}
\newcommand{\recourse}{recourse}
\newcommand{\bij}{\beta^i _j}
\newcommand{\bpij}{\widetilde{\beta}^i _j}
\newcommand{\net}{{\textsc{nn}}}
\newcommand{\gen}{\mathcal{Z}}
\newcommand{\genS}{\mathcal{Z}_S}
\newcommand{\geninv}{\gen^{-1}}
\newcommand{\genSinv}{\genS^{-1}}
\newcommand{\betabp}{\betab'}

\newcommand{\betaij}{\betab_{ij}}
\newcommand{\q}{q}
\newcommand{\betair}{\betab_{ir}}
\newcommand{\xij}{\xb_{ij}}
\newcommand{\xir}{\xb_{ir}}
% \newcommand{\xi}{x_{i}}
\newcommand{\yi}{y_{i}}
\newcommand{\betai}{\betab_i}
\newcommand{\sij}{S_{ij}}
\newcommand{\xit}{\xb_{it}}
\newcommand{\rhoij}{\rho_{ij}}
\newcommand{\betait}{\betab_{it}}
\newcommand{\y}{y}
\newcommand{\betaprior}{\betab^{prior}}
\newcommand{\gd}{gd}
\newcommand{\betaiprior}{\betab_i^{prior}}
\newcommand{\thhatnet}{f_{\widehat{\theta}}}
\newcommand{\genp}{\Pr_{\text{gen}}}
\newcommand{\rhohat}{\widehat{\rho}}

\newcommand{\RbetaInv}[1]{\Rbeta{#1}^{-1}}
\newcommand{\Sbeta}[1]{\mat{S}_{#1}}
\newcommand{\SbetaInv}[1]{\Sbeta{#1}^{-1}}
\newcommand{\wbeta}[1]{w_{#1}}
\newcommand{\wbetas}[1]{w_{#1}^S}

\newcommand{\thnet}{{f_\theta}}
\newcommand{\trnD}{D_{\text{trn}}}
\newcommand{\tstD}{D_{\text{tst}}}
\newcommand{\synD}{D_{\text{syn}}}
\newcommand{\Zspace}{\mathcal{Z}}
\newcommand{\synz}{\Tilde{z}}
\newcommand{\Tspace}{\mathcal{T}}
\newcommand{\xspace}{\mathcal{X}}
\newcommand{\yspace}{\mathcal{Y}}
\newcommand{\xSspace}{\mathcal{X}_S}
\newcommand{\Lspace}{\mathcal{L}}
\renewcommand{\yspace}{\mathcal{Y}}
\newcommand{\lhat}{\widehat{l}}
\newcommand{\zextS}{\Phi_S}
\newcommand{\zextR}{\Phi_R}
\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\recmdl}{g_\phi}
\newcommand{\realwb}{w}
\newcommand{\realwbhat}{\widehat{w}}
\newcommand{\synwb}{w^S}
\newcommand{\synwbhat}{\widehat{w}^S}
\newcommand{\naivew}{w_{t}^D}
\newcommand{\directw}{w_{t}^D}
\newcommand{\jointw}{w_{t}^J}
\newcommand{\factualw}{w_{t}^F}
\newcommand{\jointR}{\widehat{\mat{R}}_{\betab}^{-1}}
\newcommand{\jointS}{\mat{S}_{\betab}^{-1}}

\newcommand{\Rbeta}[1]{\mat{R}_{#1}}



\newcommand{\jointwp}{w_{t}^J}
\newcommand{\jointRp}{\mat{R}_{t}^{-1}}
\newcommand{\jointSp}{\mat{S}_{t}^{-1}}
\newcommand{\realmu}{\mu}
\newcommand{\synmu}{\mu^S}
\newcommand{\realmuhat}{\widehat{\mu}}
\newcommand{\synmuhat}{\widehat{\mu}^S}
\newcommand{\synmuTilde}{\widetilde{\mu}^S}


\newcommand{\ITEx}{\tau_X}
\newcommand{\ITExhat}{\widehat{\ITEx}}
\newcommand{\ITExSyn}{\ITEx^S}
\newcommand{\tauhat}{\widehat{\tau}}
\newcommand{\syntau}{\tau^S}
\newcommand{\syntauhat}{\widehat{\tau}^S}
\newcommand{\syntauTilde}{\widetilde{\tau}^S}

\newcommand{\gapRR}{\lambda_{R}}
\newcommand{\gapRS}{\lambda_{RS}}
\newcommand{\gapwR}{\lambda_{w}}
\newcommand{\gapwS}{\lambda_{wRS}}

\newcommand{\noise}{\mathcal{N}(0,1)}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cK}{\mathcal{K}}

\newcommand{\nind}{\not\!\perp\!\!\!\perp}

\newcommand{\betarv}{\mathfrak{B}}
\newcommand{\our}{\textit{SimPONet}}


\newcommand{\RInv}{f}
\newcommand{\RzInv}{f_0}
\newcommand{\RoInv}{f_1}
\newcommand{\RInvhat}{\widehat{f}}
\newcommand{\RzInvhat}{\widehat{f}_0}
\newcommand{\RoInvhat}{\widehat{f}_1}
\newcommand{\R}{g}
\newcommand{\Rz}{g_0}
\newcommand{\Ro}{g_1}
\newcommand{\SInv}{f^S}
\newcommand{\SInvTilde}{\widetilde{f}^S}
\newcommand{\SInvCont}{\SInvTilde}
\newcommand{\SInvhat}{\widehat{f}^S}
\newcommand{\SzInv}{f^S_0}
\newcommand{\SoInv}{f^S_1}
\renewcommand{\S}{g^S}
\newcommand{\Sz}{g^S_0}
\newcommand{\So}{g^S_1}
\newcommand{\Shat}{\widehat{g}^S}
\newcommand{\Szhat}{\widehat{g}^S_0}
\newcommand{\Sohat}{\widehat{g}^S_1}
\newcommand{\LRfct}{\lambda_{\text{fct}}}
\newcommand{\LSfct}{\lambda^S_{\text{fct}}}
\newcommand{\LScf}{\lambda^S_{\text{cf}}}
\newcommand{\Lphi}{\lambda_{\RInv}}
\newcommand{\Ltau}{\lambda_{\tau}}
\newcommand{\ErrITE}{\mathcal{E}_{\text{CATE}}}
\newcommand{\ErrF}{\mathcal{E}_F}
\newcommand{\ErrCF}{\mathcal{E}_{CF}}
\newcommand{\ErrCFR}{\mathcal{E}_{CF}^R}
\newcommand{\ipm}[1]{\textsc{IPM}_{#1}}
\newcommand{\ipmg}{\ipm{G}}
\newcommand{\distR}{\texttt{dist}(\realmu \circ \RInv, \realmu \circ \SInv)}
\newcommand{\distmu}{\texttt{dist}(\realmu \circ \SInv, \synmu \circ \SInv)}
\newcommand{\distcont}{\texttt{dist}(\SInv, \SInvCont)}

\newcommand{\simonly}{SimOnly}
\newcommand{\realonly}{RealOnly}
\newcommand{\muonly}{$\text{Real}_\mu\text{Sim}_f$} %{$\mu$Only}
% \newcommand{\muonly}{SimCausal}
\newcommand{\epsf}{\epsilon_{\RInv}}
\newcommand{\delf}{\delta_{\RInv}}
\newcommand{\epsmu}{\epsilon_{\realmu}}
\newcommand{\delmu}{\delta_{\realmu}}
\newcommand{\lokesh}[1]{\textcolor{blue}{#1}}
\newcommand{\tmlr}{\color{blue}}


%%%%%%%%%%%%%%%%%%%%%%%
% Color Block
%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{xcolor} 
\usepackage{tikz} 
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}
\usetikzlibrary{shadings,shadows}
\newenvironment{gblock}[1]{%
\tcolorbox[beamer,%
noparskip,breakable,
colback=LightGreen,colframe=DarkGreen,%
colbacklower=LimeGreen!75!LightGreen,%
title=#1]}%
{\endtcolorbox}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Added by Lokesh
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usetikzlibrary{shapes, arrows, calc, arrows.meta, fit, positioning} % these are the parameters passed to the library to create the node graphs  
\tikzset{  
    -Latex,auto,node distance =1.5 cm and 1.3 cm, thick,% node distance is the distance between one node to other, where 1.5cm is the length of the edge between the nodes  
    state/.style ={ellipse, draw, minimum width = 0.9 cm}, % the minimum width is the width of the ellipse, which is the size of the shape of vertex in the node graph  
    point/.style = {circle, draw, inner sep=0.18cm, fill, node contents={}},  
    bidirected/.style={Latex-Latex,dashed}, % it is the edge having two directions  
    el/.style = {inner sep=2.5pt, align=right, sloped}  
}  
\usepackage{multirow}



\title{Leveraging a Simulator for Learning Causal Representations from Post-Treatment Covariates for CATE}

% Authors must not appear in the submitted version. They should be hidden
% as long as the tmlr package is used without the [accepted] or [preprint] options.
% Non-anonymous submissions will be rejected without review.

\author{\name Lokesh Nagalapatti$^*$ \email nlokeshiisc@gmail.com \\
      \addr Department of Computer Science and Engineering\\
      IIT Bombay
      \AND
      \name Pranava Singhal$^*$ \email pranava.psinghal@gmail.com \\
      \addr Department of Computer Science \\ Stanford University
      \AND
      \name Avishek Ghosh  \email avishek\_ghosh@iitb.ac.in\\
      \addr Department of Computer Science and Engineering\\
      IIT Bombay 
      \AND 
      \name Sunita Sarawagi \email sunita@iitb.ac.in
      \addr Department of Computer Science and Engineering\\
      IIT Bombay}

% The \author macro works with any number of authors. Use \AND 
% to separate the names and addresses of multiple authors.

\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

\def\month{01}  % Insert correct month for camera-ready version
\def\year{2025} % Insert correct year for camera-ready version
\def\openreview{\url{https://openreview.net/forum?id=vmmgFW3ztz}} % Insert correct link to OpenReview for camera-ready version


\begin{document}


\maketitle

\begin{abstract}
Treatment effect \blfootnote{$^*$ Lokesh and Pranava contributed equally. This work was conducted by Pranava during their tenure at IIT Bombay} estimation involves assessing the impact of different treatments on individual outcomes. Current methods estimate Conditional Average Treatment Effect (CATE) using observational datasets where covariates are collected before treatment assignment and outcomes are observed afterward, under assumptions like positivity and unconfoundedness. In this paper, we address a scenario where both covariates and outcomes are gathered after treatment. We show that post-treatment covariates render CATE unidentifiable, and recovering CATE requires learning treatment-independent causal representations. Prior work shows that such representations can be learned through contrastive learning if counterfactual supervision is available in observational data. However, since counterfactuals are rare, other works have explored using simulators that offer synthetic counterfactual supervision. Our goal in this paper is to systematically analyze the role of simulators in estimating CATE. We analyze the CATE error of several baselines and highlight their limitations. We then establish a generalization bound that characterizes the CATE error from jointly training on real and simulated distributions, as a function of the real-simulator mismatch. Finally, we introduce SimPONet, a novel method whose loss function is inspired from our generalization bound. We further show how SimPONet adjusts the simulator’s influence on the learning objective based on the simulator's relevance to the CATE task.  We experiment with various DGPs, by systematically varying the real-simulator distribution gap to evaluate \our's efficacy against state-of-the-art CATE baselines.

\end{abstract}

\section{Introduction} \label{sec:intro}

In Conditional Average Treatment Effect (CATE) task, the goal is to estimate the difference in an outcome $Y$, as an individual $Z$ is subject to different treatments $T$. 
The gold standard to estimating such effects is Randomized Control Trials, which are often expensive, and with the easy availability of observational data, there is extensive interest in harnessing them for deriving these estimates. The first step in estimating treatment effects from observational datasets is to determine the set of covariates that, when conditioned upon, make the treatment effects identifiable. Prior works ~\citep{xlearner,rlearner,CurthS23,cfrnet,vcnet,Tarnet, chauhan2023adversarial, inducbias, overlapping_rep, dragonnet,matching_survey}, assume that such covariates are observed, and gathered prior to treatment, with outcomes $Y$ observed after the treatment is given. However, collecting such datasets is challenging as it requires tracking the same individuals over two distinct time points. As a result, readily available observational datasets can sometimes contain both covariates $X$ and the outcomes $Y$ recorded together post-treatment. $X$, $Y$ are observed for individuals characterized by a latent representation $Z$. For example, in economics, policymakers implement different taxation policies $T$ aimed at improving an outcomes $Y$ like Gross Domestic Expenditure of the individuals $Z$. To identify effective policies, they may rely on domain expertise or conduct small-scale RCTs where collecting pre-treatment covariates is feasible. However, the true effectiveness of a policy is only revealed through large-scale testing on the population after its implementation. Collecting such datasets typically involves obtaining post-treatment covariates $X$ and their associated outcomes $Y$ together \citep{policy_1, policy_2}.

% 
% For instance, in economics~\citep{policy_1, policy_2}, the effectiveness of policies is commonly evaluated using post-policy data for both outcomes and covariates.
Even in other domains such as voluntary healthcare surveys, only post-treatment data about patients might be accessible. In medical imaging, an image taken under a specific instrument setting (treatment) may be evaluated to determine whether switching to a different setting would improve a subsequent diagnosis (outcome). 

\begin{wrapfigure}{r}{0.35\textwidth}
  \vspace{-0.5cm}
  \begin{center}
    {\resizebox{0.35\textwidth}{!}{\input{diagram}}}
  \end{center}
  \vspace{-0.1cm}
  \caption{\small{The Data Generating process for Real and Simulator.\label{fig:our_DGP}}}
  \vspace{-1cm}
\end{wrapfigure}

We present our setup in the top panel of Fig.~\ref{fig:our_DGP} marked RealDGP (Data Generating Process for the real distribution), where the latent variables $Z$ causally produce the observed treatment $T$, outcome $Y$, and covariates $X$. 
We begin this paper by presenting an impossibility result in this context.

\begin{lemma}
    
The Conditional Average Treatment Effect (CATE) of $T$ on $Y$, given $X$, is not identifiable using i.i.d. samples of the observed variables from the true data-generating process depicted in the top panel of Fig. \ref{fig:our_DGP}. \label{lemma:impossible}
\end{lemma}
%

\textit{proof. }Since $X$ is a collider, conditioning on it opens the backdoor path $T \rightarrow X \leftarrow Z \rightarrow Y$. Furthermore, as $Z$ is latent, this backdoor path remains open, making CATE unidentifiable from $X$, $T$, and $Y$ alone~\citep{post_cf_proof}. 

The main takeaway from the lemma is that certain additional assumptions are unavoidable for achieving identifiability. The lemma further emphasizes that the key to identifiability lies in extracting treatment-independent 
% $Z$, which can be accomplished by learning 
causal representations from the post-treatment $X$ that affect $Y$. 
% This highlights the task of learning causal representations from $X$ as an important sub-goal in our overall objective of learning CATE. 
One such assumption that allows for the recovery of causal representations is counterfactual supervision in real data. Prior work~\citep{von2021self} demonstrates that, under such an assumption, contrastive losses can be applied to pairs of covariates that differ by treatment to extract $Z$ from $X$ and $T$. While some works~\citep{nagalapatti2022learning, contrast_3} assume direct access to such counterfactual supervision in real data, others rely on simulators that generate high-quality synthetic counterfactuals~\citep{von2021self, zimmermann2021cl}. 
% \todo{Check if prior works apply simulators without checking their quality. L: Maybe not, for example in robotics people talk of real-sim transfer .. Perhaps in CATE settings, we are the first}
However, these are strong assumptions since counterfactuals are rarely available in real-world scenarios, and while simulators are more feasible, assessing their quality or relevance to the downstream task during training is challenging. Therefore, our goal in this paper is to leverage simulators only to the extent they remain relevant to the CATE task. We conduct a theoretical analysis to derive generalization bounds that show how CATE error worsens as the mismatch between real and simulated distributions increases. These insights motivate our proposed algorithm, \our, which uses simulated data to apply regularizers inspired by our generalization bound. \our's aim is to enhance CATE estimates beyond what is achievable with observational data alone.
Through experiments, we systematically vary the distributional gap between real and synthetic data across various DGPs, demonstrating that \our\ consistently outperforms multiple baselines in estimating CATE.


\textbf{Contributions:} 1) We address Treatment Effect Estimation with post-treatment covariates —- a \emph{non-identifiable} challenge -- by leveraging a simulator that offers synthetic counterfactual supervision. 2) We assess the CATE errors for three baselines that can be trained on real/simulated data, and  highlight their limitations. 3) Next, we consider a joint training framework, and  derive a generalization bound that characterizes the CATE error as a function of real-simulator distributional mismatch. 4) This analysis motivates our method, \our, a novel algorithm that uses simulated samples to improve CATE estimates beyond what can be achieved from observational data alone. 5) To our knowledge, this is the \emph{first} systematic study on the role of simulators in CATE estimation. 6) Experiments across various DGPs confirm \our's effectiveness.

\section{Related Work} 

\input{related}

\subsection{Real-World Applications of using Simulators for Estimating CATE}
\label{app:sim_examples}
We provide two examples from medicine and electrochemistry to show how simulators aid CATE estimation in practice:

\xhdr{Medicine} Simulators play a crucial role in pharmacology, particularly for assessing drug efficacies. For instance, the SimBiology toolbox 
\footnote{\tiny{\url{https://in.mathworks.com/videos/series/simbiology-tutorials-for-qsp-pbpk-and-pk-pd-modeling-and-analysis.html}}} in MATLAB is commonly used to predict the effects of \verb|SGLT2| inhibitors ($T$) on type-2 diabetes ($Y$) while considering post-treatment covariates ($X$) such as plasma glucose levels, gut glucose levels, urinary glucose excretion, and liver insulin levels. SimBiology enables modeling these effects using differential and algebraic equations that are often calibrated on target populations to minimize the real-simulator mismatch. Despite not perfectly replicating reality, such simulators are invaluable for early-stage clinical trial decisions and have demonstrated utility in modeling short-term treatment effects~\citep{simbiology}.


\xhdr{Electrochemistry} Another application involves recommending optimal electrode materials to maximize battery capacity ($Y$). By observing $Y$ under various electrode materials ($T$) and post-treatment variables like charge/discharge rate, internal resistance, and temperature distribution ($X$), the Ansys Battery Cell and Electrode Simulator \footnote{\tiny{\url{https://www.ansys.com/applications/battery/battery-cell-and-electrode}}} provides electrochemical simulations. This tool has been used by Volkswagen Motorsport for comprehensive multiphysics simulations to design and validate battery models. Such simulators are highly relevant for practical decision-making in industries.

These examples illustrate the practical relevance of simulators across different fields. While simulators cannot fully replace real data or randomized controlled trials (RCTs), they offer valuable insights that can reduce the number of RCTs needed for optimal treatment identification. Our paper aims to characterize the CATE error when using imperfect simulators in conjunction with real observational data. Additionally, \our\ maximizes the utility of simulators by leveraging the highly correlated simulator's treatment effects with real-world effects, without relying on the exact correlation of individual potential outcomes.

\input{problem_formulation}

\input{theory}

\input{experiments}

\section{Conclusion} 
\label{sec:conclusion}
% \textbf{Limitation}: (1) Since we do not know how to infer the gaps between real and simulator DGPs, tuning of the loss weights $\Lphi, \Ltau$ is challenging. Although we came up with an effective heuristic to set $\Lphi$, setting $\Ltau$ is not very clear. (2) None of the estimators, including \our, are consistent; i.e., as $|\trnD|, |\synD| \rightarrow \infty$, $\ErrITE$ does not converge to zero. We hope to address these issues in future.

This paper addressed the challenge of estimating treatment effects from post-treatment covariates a setting not identifiable from observational data alone. We proposed to tackle this task using off-the-shelf simulators that synthesize counterfactuals, in contrast to prior work that relied on real-world counterfactuals, which limited their practical applicability. Our theoretical analysis established a bound on the CATE error based on the distributional mismatch between real and simulated data. Notable, ours is the first work to systematically analyze the role of simulators in CATE estimation. We introduced \our, a framework that jointly learns from real and simulated samples to enhance CATE estimates beyond what could be achieved from observational data alone. Extensive experiments across various DGPs demonstrated that \our\ is a robust and effective method for estimating CATE from post-treatment data.

\bibliography{refs}
\bibliographystyle{tmlr}

\appendix
\input{appendix}

\end{document}
