

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables

% hyperref makes hyperlinks in the resulting PDF.
\usepackage{hyperref}

\usepackage{url}
\urlstyle{same}

% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

% Use the following line for the initial blind version submitted for review:
%\usepackage{conf2025}

% If accepted, instead use the following line for the camera-ready submission:
\usepackage[accepted]{conf2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{problemst}{Problem Statement}[section] % Michelle edit
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage{xfrac} % Michelle edit
\usepackage{tikz}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}


% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}
\usepackage[textsize=tiny]{todonotes}


% The \conftitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
\conftitlerunning{Controllable Sequence Editing for Counterfactual Generation}

\usepackage{xspace}
\newcommand{\marinka}[1]{{\color{magenta} [MZ: {#1}]}}
\newcommand{\michelle}[1]{{\color{purple} [ML: {#1}]}}
\newcommand{\kevin}[1]{{\color{blue} [KL: {#1}]}}
\newcommand{\shvat}[1]{{\color{cyan} [SM: {#1}]}}
\newcommand{\name}{\textsc{Clef}\xspace}
\newcommand{\longname}{\underline{C}ontro\underline{L}lable sequence \underline{E}diting for counter\underline{F}actual generation\xspace}
\newcommand{\std}[1]{\scriptsize{$\pm$#1}}
\newcommand{\xhdr}[1]{\noindent{{\bf #1.}}}


\begin{document}

\twocolumn[
\conftitle{Controllable Sequence Editing for Counterfactual Generation}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the conf2025
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.
%\confsetsymbol{equal}{*}

\begin{confauthorlist}
\confauthor{Michelle M.~Li}{hms,berkowitz}
\confauthor{Kevin Li}{hms,mit}
\confauthor{Yasha Ektefaie}{hms}
\confauthor{Shvat Messica}{hms}
\confauthor{Marinka Zitnik}{hms,berkowitz,kempner}
\end{confauthorlist}

%\confaffiliation{berkowitz}{The Ivan and Francesca Berkowitz Family Living Laboratory Collaboration at Harvard Medical School and Clalit Research Institute, Boston, MA, USA}
%\confaffiliation{dbmi}{Department of Biomedical Informatics, Harvard Medical School, Boston, MA, USA}

\confaffiliation{hms}{Harvard Medical School}
\confaffiliation{berkowitz}{The Ivan and Francesca Berkowitz Family Living Laboratory Collaboration at Harvard Medical School and Clalit Research Institute}
\confaffiliation{mit}{Massachusetts Institute of Technology}
\confaffiliation{kempner}{Kempner Institute for the Study of Natural and Artificial Intelligence at Harvard University}

\confcorrespondingauthor{}{michelleli@g.harvard.edu}
\confcorrespondingauthor{}{marinka@hms.harvard.edu}

% Michelle M. Li
% Kevin Li
% Yasha Ektefaie
% Shvat Messica
% Marinka Zitnik

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\confkeywords{Machine Learning}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \confEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
%\printAffiliationsAndNotice{\confEqualContribution} % otherwise use the standard text.


\begin{abstract}
\input{00abstract}
\end{abstract}

\section{Introduction}
\input{01introduction}


\section{Related work}
\input{02related}


\section{\name}

\name manipulates sequences based on user-specified conditions and temporal coordinates to address  ``what if" questions. Given a sequence, a forecast time step, and a counterfactual condition, \name modifies only the relevant portions of the sequence while preserving unaffected elements, ensuring causal consistency. For example, based on a patient's historical lab test results, \name generates a future lab test trajectory conditioned on a given treatment~(Figure~\ref{fig:problem}a). Architecturally, \name has four key components: (i) a sequence encoder \(F\) that extracts temporal features from historical sequence data, (ii) a condition adapter \(H\) that maps counterfactual conditions to latent representations, (iii) a concept encoder \(E\) that learns temporal concepts, representing trajectory patterns over time, and (iv) a concept decoder \(G\) that applies these concepts to generate counterfactual sequences.



\subsection{Problem definition}
\input{03problem}
\subsection{\name model}
\input{04method}

\section{Experimental setup}
\input{05experiment}

\section{Results}
\input{06results}

\section{Conclusion}
\input{07conclusion}

\clearpage
\section*{Broader Impact}

By introducing a flexible and interpretable approach to counterfactual sequence generation, \name bridges the gap between language model-style conditional generation and structured, time-sensitive sequence editing, with implications for decision support in medical and scientific applications.
%
Like all generative AI models, \name (and its derivatives) should be used solely for the benefit of society. In this study, we demonstrate that \name can generate alternative cellular trajectories and simulate the reversal or progression of symptoms to model healthier or sicker patient outcomes. However, this work (and any derivatives) should never be used to induce harmful cellular states (e.g., activating transcription factors to drive a cell toward a pathological state) or negatively impact patient care (e.g., neglecting necessary clinical interventions or recommending harmful treatments).  Our goal is to help researchers understand the underlying mechanisms of disease to improve public health. Any misuse of this work poses risks to patient well-being. Therefore, the ability to intervene on \name's generated outputs should be leveraged to assess the model's robustness and correctness for ethical and responsible use.  

\section*{Acknowledgements}

M.L.~and M.Z.~are supported by the Berkowitz Family Living Laboratory at Harvard Medical School and the Clalit Research Institute. Y.E.~is supported by grant T32 HG002295 from the National Human Genome Research Institute and the NDSEG Fellowship. We gratefully acknowledge the support of NIH R01-HD108794, NSF CAREER 2339524, US DoD FA8702-15-D-0001, ARPA-H BDF program, awards from Chan Zuckerberg Initiative, Bill \& Melinda Gates Foundation INV-079038, Amazon Faculty Research, Google Research Scholar Program, AstraZeneca Research, Roche Alliance with Distinguished Scientists, Sanofi iDEA-iTECH, Pfizer Research, John and Virginia Kaneb Fellowship at Harvard Medical School, Biswas Computational Biology Initiative in partnership with the Milken Institute, Harvard Medical School Dean's Innovation Fund for the Use of Artificial Intelligence, Harvard Data Science Initiative, and Kempner Institute for the Study of Natural and Artificial Intelligence at Harvard University. Any opinions, findings, conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the funders.


\bibliography{ref}
\bibliographystyle{conf2025}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix
\onecolumn
\input{08appendix}

%\section{You \emph{can} have an appendix here.}

%You can have as much text here as you want. The main body must be at most $8$ pages long.
%For the final version, one more page can be added.
%If you want, you can use an appendix like this one.  

%The $\mathtt{\backslash onecolumn}$ command above can be kept in place if you prefer a one-column appendix, or can be removed if you prefer a two-column appendix.  Apart from this possible change, the style (font size, spacing, margins, page numbering, etc.) should be kept the same as the main body.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}

