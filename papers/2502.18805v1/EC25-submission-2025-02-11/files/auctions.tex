\section{Auction for a Single Good}
\label{sec:single-item-auction}

We consider a seller owning a single good, and $n$ potential buyers (the agents). 
% \eden{TODO: use this structure for all sections}
The true preferences $T_i$ are given by real values $v_i \geq 0$, representing the happiness of agent $i$ from receiving the good. 
The reported preferences $P_i$ are the ``bids'' $b_i \geq 0 $.
A mechanism in this context has to determine the \emph{winner} --- the agent who will receive the good, and the \emph{price} --- how much the winner will pay.

We assume that agents are quasi-linear -- meaning their valuations can be interpreted in monetary units. 
Accordingly, the utility of the winning agent is the valuation minus the price; while the utility of the other agents is zero. 

\paragraph{Results.} The two most well-known mechanisms in this context are first-price auction and second-price auctions. 
%
First-price auction is known to be manipulable; moreover, it is easy to show that it is safely-manipulable, so its RAT-degree is $0$.
We show that a first-price auction with a positive discount has RAT-degree $1$.
%
Second-price auction is known to be truthful, so its  RAT-degree is $n$.
However, it has some decisive practical disadvantages \cite{ausubel2006lovely}, in particular, when buyers are risk-averse, the expected revenue of a second-price auction is lower than that of a first-price auction \cite{nisan2007algorithmic};
even when the buyers are risk-neutral, a risk-averse \emph{seller} would prefer the revenue distribution of a first-price auction \citep{krishna2009auction}.%
%\footnote{We are grateful to Michael Greinecker for the information.
% https://economics.stackexchange.com/q/59899/385
% https://economics.stackexchange.com/a/24369/385}

This raises the question of whether it is possible to combine the advantages of both auction types.
Indeed, we prove that 
%Lastly, we establish the following surprising and intriguing result:
% EREL: I do not like to compliment my own results... better to let the readers see for themselves.
any auction that applies a weighted average between the first-price and the second-price achieves a RAT-degree of of $n-1$, which is very close to being fully truthful (RAT-degree $n$). 
This implies that a manipulator agent would need to obtain information about all $n-1$ other agents to safely manipulate -- which is a very challenging task.
Importantly, the sellerâ€™s revenue from such auction is higher compared to the second-price auction, giving this mechanism a significant advantage in this context. 
This result opens the door to exploring new mechanisms that are not truthful but come very close it. 
Such mechanisms may enable desirable properties that  are unattainable with truthful mechanisms.


\subsection{First-Price Auction}
In first-price auction, the agent who bids the highest price wins the good and pays her bid; the other agents get and pay nothing. 

It in well-known that the first-price auction is not truthful.
We start by proving that the situation is even worse: first-price auction is safely-manipulable, meaning that its RAT-degree is $0$.

\begin{theoremrep}
First-price auction is safely manipulable (RAT-degree = $0$).
\end{theoremrep}
\begin{proofsketch}
    A truthful agent always gets a utility of $0$,  whether he wins or loses.
    On the other hand, an agent who manipulates by bidding slightly less than $v_i$ gets a utility of at least $0$ when he loses and a strictly positive utility when he wins. 
    Thus, this manipulation is safe and profitable.
\end{proofsketch}
\begin{proof}
To prove the mechanism is safely manipulable, we need to show an agent and an alternative bid, such that the agent always \emph{weakly} prefers the outcome that results from reporting the alternative bid over reporting her true valuation, and \emph{strictly} prefers it in at least one scenario.
We prove that the mechanism is safely-manipulable by all agents with positive valuations.
    
Let $i \in N$ be an agent with valuation $v_i > 0$, we shall now prove that bidding $b_i < v_i$ is a safe manipulation.
    
We need to show that for any combination of bids of the other agents, bidding $b_i$ does not harm agent~$i$, and that there exists a combination where bidding $b_i$ strictly increases her utility. 
    To do so, we consider the following cases according to the maximum bid of the other agents:
    \begin{itemize}
        \item The maximum bid is smaller than $b_i$: if agent~$i$ bids her valuation $v_i$, she wins the good and pays $v_i$, results in utility $0$. 
        However, by bidding $b_i < v_i$, she still wins but pays only $b_i$, yielding a positive utility. 
        
        Thus, in this case, agent~$i$ strictly increases her utility by lying.

        
        \item The maximum bid is between $b_i$ and $v_i$: if agent $i$ bids her valuation $v_i$, she wins the good and pays $v_i$, resulting in utility $0$. 
        By bidding $b_i < v_i$, she loses the good but pays noting, also resulting in utility $0$.
        
        Thus, in this case, bidding $b_i$ does not harm agent~$i$.

        \item  The maximum bid is higher than $v_i$: Regardless of whether agent~$i$ bids her valuation $v_i$ or $b_i < v_i$, she does not win the good, resulting in utility $0$.
        
        Thus, in this case, bidding $b_i$ does not harm agent~$i$.
    \end{itemize}

\end{proof}





% ======================================
\subsection{First-Price Auction with Discount}\label{sec:first-price-w-discount}

In first-price auction with discount, the agent $i$ with the highest bid $b_i$ wins the item and pays $(1-t)b_i$, where $t\in(0,1)$ is a constant. As before, the other agents get and pay nothing. 



We prove that, although this minor change does not make the  mechanism truthful, it increases the degree of trustfulness for risk-averse agents. 
However, it is still quite vulnerable to manipulation as knowing the strategy of one other agent might be sufficient to safely-manipulate it.

\begin{theorem}
\label{auction-with-discount}
The RAT-degree of the First-Price Auction with Discount is $1$.
\end{theorem}

% \eden{to try to shorten the proofs}

To prove that the RAT-degree is $1$, we need to show that the mechanism is (a) \emph{not} safely-manipulable, and (b) 
$1$-known-agents safely-manipulable.
We prove each of these in a lemma.

\begin{lemmarep}
    First-Price Auction with Discount is not safely-manipulable. 
\end{lemmarep}
\begin{proofsketch}
    % The key observation is that h
    Here, unlike in the first-price auction, whenever the agent wins the good, she gains positive utility.  This implies that no manipulation can be safe. If she under-bids her value, she risks losing the item, which strictly decreases her utility. If she over-bids, she might end up paying more than necessary, reducing her utility without increasing her chances of winning.
\end{proofsketch}
\begin{proof}
We need to show that, for each agent $i$ and any bid $b_i\neq v_i$, at least one of the following is true: either (1) for any combination of bids of the other agents, agent $i$ weakly prefers the outcome from bidding $v_i$; or (2) there exists such a combination for which $i$ strictly prefers the outcome from bidding $v_i$. We consider two cases.

Case 1: $v_i = 0$. In this case condition (1) clearly holds, as bidding $v_i$ guarantees the agent a utility of $0$, and no potential outcome of the auction can give $i$ a positive utility.

Case 2: $v_i > 0$. In this case we prove that condition (2) holds. We consider two sub-cases:
\begin{itemize}
\item Under-bidding ($b_i<v_i$): 
    whenever $\displaystyle \max_{j\neq i}b_j \in (b_i,v_i)$, 
%    Consider any combination of bids of the other agents, in which the maximum bid is strictly smaller than $v_i$ and strictly greater than $b_i$.    In this case, 
when agent $i$ bids truthfully she wins the good and pays $(1-t) v_i$, resulting in utility $t v_i > 0$;
but when she bids $b_i$ she does not win, resulting in utility $0$.

\item Over-bidding ($v_i<b_i$): 
    whenever $\displaystyle \max_{j\neq i} < v_i$, 
%    Consider any combination of bids of the other agents, in which the maximum bid is strictly smaller than $v_i$.    In this case, 
when agent $i$ bids truthfully her utility is $t v_i$ as before;
when she bids $b_i$ she wins and pays $(1-t)b_i > (1-t)v_i$, so her utility is less than $t v_i$.
\end{itemize}
In both cases lying may harm agent $i$. Thus, she has no safe manipulation. 
\end{proof}

\begin{lemmarep}
    First-Price Auction with Discount is $1$-known-agents safely-manipulable. 
\end{lemmarep}
\begin{proofsketch}
    Consider the case where the manipulator $a_i$ knows there is another agent $a_j$ bidding $b_j \in (v_i, v_i/(1-t))$.
    When biding truthfully, she loses and gets zero utility. 
    However, by bidding any value $b_i\in (b_j, v_i/(1-t))$, she either wins and gains positive utility or loses and remains with zero utility. Thus it is safe and profitable. 
\end{proofsketch}
\begin{proof}
% Exists, Exists, Forall
we need to identify an agent $i$, for whom there exists another agent $j \neq i$ and a bid $b_j$, such that if $j$ bids $b_j$, then agent $i$ has a safe manipulation.
% (i.e., a bid different from its valuation that its outcome is always weakly preferred and is strictly preferred in at least one scenario).

Indeed, let $i \in N$ be an agent with valuation $v_i >0$ and let $j \neq i$ be another agent who bids some value  $b_j \in (v_i, v_i/(1-t))$. 
We prove that bidding any value $b_i\in (b_j, v_i/(1-t))$ is a safe manipulation for $i$.

If $i$ truthfully bids $v_i$, she loses the good (as $b_j > v_i$), and gets a utility of $0$.

If $i$ manipulates by bidding some $b_i\in (b_j, v_i/(1-t))$, then she gets either the same or a higher utility, depending on the maximum bid among the unknown agents ($b^{\max} := \displaystyle \max_{\ell\neq i, \ell\neq i}b_{\ell}$):
    \begin{itemize}
        \item If $b^{\max} < b_i$, then $i$ wins and pays $(1-t)b_i$, resulting in a utility of $v_i - (1-t)b_i > 0$, as $(1-t)b_i < v_i$. Thus, $i$ strictly gains by lying.

        \item  If $b^{\max} > b_i$, then $i$ does not win the good, resulting in utility $0$. Thus, in this case, bidding $b_i$ does not harm $i$.
        
        \item If $b^{\max} = b_i$, then one of the above two cases happens (depending on the tie-breaking rule).
    \end{itemize}
In all cases $b_i$ is a safe manipulation, as claimed.
\end{proof}



\subsection{Average-First-Second-Price Auction} 
% \eden{I think this name can be a bit confusing because it can be average between all prices}
In the Average-First-Second-Price (AFSP) Auction, the agent $i$ with the highest bid $b_i$ wins the item and pays $w b_i + (1-w) b^{\max}_{-i}$, where $\displaystyle b^{\max}_{-i} := \max_{j\neq i} b_j$ is the second-highest bid, and $w\in(0,1)$ is a fixed constant. That is, the price is a weighted average between the first price and the second price.


We show that this simple change makes a significantly difference -- the RAT-degree increases to $n-1$. 
This means that a manipulator agent would need to obtain information about all other agents to safely manipulate the mechanism --- a very challenging task in practice.

\begin{theorem}
\label{auction-average-price}
The RAT-degree of the Average-Price Auction is $(n-1)$.
\end{theorem}
The theorem is proved using the following two lemmas.

\begin{lemmarep}
The AFSP mechanism is not $(n-2)$-known-agents safely-manipulable.
\end{lemmarep}

\begin{proofsketch}
Let $a_i$ be a potential manipulator, $b_i$ a potential manipulation, $K$ be a set of known agents, with $|K| = n-2$, and $\mathbf{b}_{K}$ be a vector that represents their bids.
We prove that the only unknown-agent $a_j$ can make any manipulation either not profitable or not safe.
We denote by $b^{\max}_{K}$ the maximum bid among the agents in $K$ and consider each of the six possible orderings of $v_i$, $b_i$ and $b^{\max}_{K}$.
In two cases ($v_i < b_i < b^{\max}_{K}$ or $b_i < v_i < b^{\max}_{K}$) the manipulation is not profitable;
in the other four cases, the manipulation is not safe.
\end{proofsketch}

% === prev: (backup):
% \begin{proofsketch}
% \erel{TODO: try to shorten sketch}
% Let $i\in N$ be an agent with true value $v_i>0$, and a manipulation $b_i \neq v_i$. We show that this manipulation is unsafe even when knowing the bids of $n-2$ of the other agents.

% Let $K$ be a subset of $(n-2)$ of the remaining agents (the agents in $K$ are the ``known agents''), and let $\mathbf{b}_{K}$ be a vector that represents their bids.
% Lastly, let $j$ be the only agent in $N\setminus (K\cup \{i\})$.
% We need to prove that at least one of the following is true: either (1) the manipulation is not profitable --- for any possible bid of agent~$j$, agent~$i$ weakly prefers the outcome from bidding $v_i$ 
% % $f(v_i, b_j, b_{K})$
% % rather than bidding $b_i$; 
% over the outcome from bidding $b_i$;
% or (2) the manipulation is not safe --- there exists a bid for agent~$j$, such that agent~$i$ strictly prefers the outcome from bidding $v_i$.

% Let $\displaystyle b^{\max}_{K} := \max_{\ell\in K}b_{\ell}$.
% %\eden{should say somewhere that we neglect equalities}\\
% %\eden{Cases (for us):}
% We consider each of the six possible orderings of $v_i$, $b_i$ and $b^{\max}_{K}$.
% In two cases ($v_i < b_i < b^{\max}_{K}$ or $b_i < v_i < b^{\max}_{K}$) the manipulation is not profitable;
% in the other four cases, the manipulation is not safe.
% \end{proofsketch}



\begin{proof}
Let $i\in N$ be an agent with true value $v_i>0$, and a manipulation $b_i \neq v_i$. We show that this manipulation is unsafe even when knowing the bids of $n-2$ of the other agents.

Let $K$ be a subset of $(n-2)$ of the remaining agents (the agents in $K$ are the ``known agents''), and let $\mathbf{b}_{K}$ be a vector that represents their bids.
Lastly, let $j$ be the only agent in $N\setminus (K\cup \{i\})$.
We need to prove that at least one of the following is true: either (1) the manipulation is not profitable --- for any possible bid of agent~$j$, agent~$i$ weakly prefers the outcome from bidding $v_i$ 
% $f(v_i, b_j, b_{K})$
% rather than bidding $b_i$; 
over the outcome from bidding $b_i$;
or (2) the manipulation is not safe --- there exists a bid for agent~$j$, such that agent~$i$ strictly prefers the outcome from bidding $v_i$.

Let $\displaystyle b^{\max}_{K} := \max_{\ell\in K}b_{\ell}$.
%\eden{should say somewhere that we neglect equalities}\\
%\eden{Cases (for us):}
We consider each of the six possible orderings of $v_i$, $b_i$ and $b^{\max}_{K}$ (cases with equalities are contained in cases with inequalities, according to the tie-breaking rule):


\begin{itemize}
    \item 
%    (Cases 1 and 3) 
    $v_i < b_i < b^{\max}_{K}$ or $b_i < v_i < b^{\max}_{K}$:  
    In these cases (1) holds, as for any bid of agent $j$, agent $i$ never wins. Therefore the manipulation is not profitable.
%    We show that in this case the first condition holds.     Since $b^{\max}_{K}$ is higher than both -- the valuation of agent $i$, $v_i$, and her alternative bid, $b_i$; regardless of what agent $j$ bids, agent $i$ does not win the good and gets a utility $0$.     Thus, in this case, agent~$i$ is indifferent between telling the truth and manipulating.
    
    \item 
%    (Case 2) 
    $v_i < b^{\max}_{K} < b_i$:
We show that (2) holds. Assume that $j$ bids any value $b_j \in (v_i, b_i)$.
When $i$ bids truthfully, she does not win the good so her utility is $0$.
But when $i$ bids $b_i$, she wins and pays a weighted average between $b_i$ and $\max(b_j, b_K^{\max})$. As both these numbers are strictly greater than $v_i$, the payment is larger than $v_i$ as well, resulting in a negative utility. Hence, the manipulation is not safe.
    
    % \item $b_i < v_i < b^{\max}_{K}$: \eden{same as case (1)}     We show that in this case the first condition holds.     Since $b^{\max}_{K}$ is higher than the valuation of agent $i$, $v_i$, and of its and alternative bid, $b_i$; no matter what agent $j$ bids, agent $i$ does not win the item and gets a utility $0$.     Thus, in this case, telling the truth weakly dominants this alternative strategies.
    
\item 
%(Case 4) 
$b^{\max}_{K} < v_i < b_i$: We show that (2) holds.
Assume that $j$ bids any value $b_j < b^{\max}_{K}$.
When $i$ tells the truth, she wins and pays $w v_i + (1-w)b^{\max}_{K}$; 
but when $i$ bids $b_i$, she still wins but pays a higher price, $w b_i + (1-w)b^{\max}_{K}$, so her utility decreases.   
Hence, the manipulation is not safe.
    
\item 
%(Case 5) 
$b_i < b^{\max}_{K} < v_i$: We show that (2) holds.
Assume that agent $j$ bids any value $b_j < b_i$.
When $i$ tells the truth, she wins and pays $w v_i + (1-w)b^{\max}_{K} < v_i$, resulting in a positive utility.
But when $i$ bids $b_i$, she does not win and her utility is $0$.
Hence, the manipulation is not safe.
    
\item 
%(Case 6) 
$b^{\max}_{K} < b_i < v_i$: We show that (2) holds.
Assume that $j$ bids any value $b_j\in(b_i,v_i)$.
When $i$ tells the truth, she wins and pays $w v_i + (1-w)b_j < v_i$, resulting in a positive utility.
But when $i$ bids $b_i$, she does not win and her utility is $0$.
Hence, the manipulation is not safe.


\item 
$b_i < b^{\max}_{K} < v_i$ or $b^{\max}_{K} < b_i < v_i$:
We show that (2) holds. 
Assume that $j$ bids any value $b_j\in(b_i,v_i)$.
When $i$ tells the truth, she wins and pays $w v_i + (1-w)\max(b_j, b^{\max}_{K})$, which is smaller than $v_i$ as both $b_j$ and $b^{\max}_{K}$ are smaller than $v_i$. Therefore, $i$'s utility is positive.
But when $i$ bids $b_i$, she does not win and her utility is $0$.
Hence, the manipulation is not safe.
\end{itemize}
\end{proof}

\begin{lemmarep}
The AFSP mechanism is $(n-1)$-known-agents safely-manipulable.
\end{lemmarep}
\begin{proofsketch}
Consider any combination of bids of the other agents in which all the bids are strictly smaller than $v_i$. 
Let $b^{\max}_{-i}$ be the highest bid among the other agents. 
Then any alternative bid $b_i \in (b^{\max}_{-i}, v_i)$ is a safe manipulation.
\end{proofsketch}
\begin{proof}
% Forall, Forall, Exists
given an agent $i \in N$, we need to show an alternative bid $b_i\neq v_i$ and a combination of $(n-1)$ bids of the other agents, such that the agent strictly prefers the outcome resulting from its untruthful bid over her true valuation.

Consider any combination of bids of the other agents in which all the bids are strictly smaller than $v_i$. 
Let $b^{\max}_{-i}$ be the highest bid among the other agents. 
We prove that any alternative bid $b_i \in (b^{\max}_{-i}, v_i)$ is a safe manipulation.

When agent $i$ bids her valuation $v_i$, she wins the good and pays $w v_i + (1-w) b^{\max}_{-i}$, yielding a (positive) utility of 
\begin{align*}
    v_i- w v_i - (1-w)b^{\max}_{-i}
    =
    (1-w) (v_i - b^{\max}_{-i}).
\end{align*}
But when $i$ bids $b_i$, as $b_i > b^{\max}_{-i}$, she still wins the good but pays $w b_i + (1-w) b^{\max}_{-i}$, which is smaller as $b_i<v_i$; therefore her utility is higher.
% resulting in higher utility of
%\begin{align*}
%    &
%    v_i-w v_i - (1-w)b^{\max}_{-i}
%    > 
%    v_i-\frac{1}{2}(v_i + b^{\max}_{-i}) && \text{(As $b_i < v_i$)}
%\end{align*} 
\end{proof}

\paragraph{Conclusion.}
By choosing a high value for the parameter $w$, the Average-Price Auction becomes similar to the first-price auction, and therefore may attain a similar revenue in practice, but with better strategic properties. 
The average-price auction is sufficiently simple to test in practice; we find it very interesting to check how it fares in comparison to the more standard auction types.
