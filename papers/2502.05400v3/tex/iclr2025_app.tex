%\appendix
\clearpage
%
\begin{appendices}
\section{Examples of model-generated response Surpassing human-annotated data}
\label{appendix a}

\textbf{Question 1:} Here is a piece of text: Ugh. Dads. Always showing off their professional football skills because heaven forbid you let your kids occasionally win a kickball game.
Carolina Panthers kicker Graham Gano (who someone in your fantasy league probably drafts every year) decided that a family kickball game was not the time to go easy on his kids, and the proof is in this video the kicker posted to Twitter on Tuesday afternoon.
Just look at his family's stunned reaction to watching the ball fly off into the trees where it's probably going to be popped because squirrels are jerks, Graham, why didn't you think about that, huh?
Gano rounded the bases gleefully but the whereabouts of the ball remain unknown.

Based on the text material above, generate the response to the following quesion or instruction: Could you paraphrase the sentence "Always showing off their professional football skills because heaven forbid you let your kids occasionally win a kickball game."? \\
\rule{\linewidth}{0.4pt}

\noindent \textbf{Ground Truth:} Can you rephrase the sentence "Always showing off their professional football skills because heaven forbid you let your kids occasionally win a kickball game"?

\noindent \textbf{Generated Answer:} Yes, the sentence means that fathers (presumably) feel the need to constantly demonstrate their abilities in football (presumably a professional sport) during family games like kickball, even if it means their children never have a chance to win. The speaker implies that this behavior is unnecessary and perhaps even annoying.

\noindent \textbf{Question 2:} Think about your experiences at a science museum or planetarium when you were young. What exhibits or displays did you find the most fascinating and why? Did you attend any shows or presentations? How did they enhance your understanding of science? Did you participate in any hands-on activities? How did they engage you and deepen your interest in science? Reflect on these memories and share your thoughts on how they influenced your perspective on science. \\
\rule{\linewidth}{0.4pt}

\noindent \textbf{Ground Truth:} I don't have the capability to experience things or go to places.

\noindent \textbf{Generated Answer:} I remember visiting the science museum and planetarium when I was a child and being completely mesmerized by everything I saw. One exhibit that stands out in my mind was the one about space. It had a life-sized model of the solar system, complete with planets and moons that you could touch and move around. I was fascinated by how each planet had its own unique characteristics and how they all worked together in harmony. It made me realize just how vast and complex the universe really is.

Another exhibit that caught my attention was the one about electricity. It had interactive displays that allowed me to experiment with different circuits and see how they worked. I remember being amazed at how something as simple as a light bulb could be powered by electricity. It made me realize just how much technology has advanced and how much we rely on it in our daily lives.

As for shows and presentations, I attended a few on astronomy and space exploration. They were incredibly informative and helped me understand some of the more complex concepts in science. One show in particular stands out in my mind. It was about black holes and how they work. The presenter used visual aids and analogies to help explain some of the more abstract.

\newpage
\section{Prompt Templates Used for GPT4o-mini Evaluation}
\label{appendix b}

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!black, 
                  sharp corners, 
                  boxrule=1pt, 
                  width=\textwidth,
                  fontupper=\ttfamily\color{blue!30!black}]

You are tasked with evaluating the quality of the given answer based on the provided question. Your task is to assign a score between 0 and 100, where 0 indicates very poor quality, and 100 indicates excellent quality. You should use a 1-point increment scale, meaning the score can be any whole number between 0 and 100 (e.g. 73,91,68) and avoiding scores that are always multiples of 5. Consider factors such as relevance, clarity, accuracy, and completeness. Provide only the score without any explanation. \\

\textbf{Question}: [question]

\textbf{answer}: [answer]

\textbf{Score}: \\
\end{tcolorbox}


\section{Details of Experimental setup}
\label{appendix c}
Table \ref{table3} and Table \ref{table4} present the training parameters and evaluation benchmarks used in our experiments. All evaluation results are reported as normalized accuracy. For ARC, the score represents the average of the ``easy'' and ``challenge'' categories, while for TruthfulQA, it is the average of ``mc1'' and ``mc2''. Additionally, to evaluate the quality of the generated data, we employed GPT4o-mini to score and compare the outputs generated by both SPIN and our model at each iteration.

\begin{table}[h]
\centering
\begin{tabular}{cc} % Creating 1 row and 2 columns

    \begin{minipage}[b]{0.45\textwidth}
        \renewcommand{\arraystretch}{1.1} 
        \centering
        \captionof{table}{Training setup parameters.}
        \small
        \begin{tabular}{>{\centering\arraybackslash}p{0.6\textwidth} >{\centering\arraybackslash}p{0.3\textwidth}}
            \toprule
            \textbf{Parameter}                   & \textbf{Value}  \\
            \midrule
            bf16                                  & true            \\
            beta                                  & 0.1             \\
            gradient accumulation steps           & 1               \\
            learning rate                         & 5.0e-7          \\
            scheduler type of learning rate       & linear          \\
            max length                            & 1024            \\
            max prompt length                     & 512             \\
            number of train epochs                & 3               \\
            optimizer                             & RMSprop         \\
            train batch size                      & 4               \\
            warmup ratio                          & 0.1             \\
            \bottomrule
        \end{tabular}
        \label{table3}
    \end{minipage}
    
    \hspace{0.08\textwidth}
    
    \begin{minipage}[b]{0.45\textwidth}
    \renewcommand{\arraystretch}{2.0}
    \centering
    \captionof{table}{Evaluation benchmarks and number of samples used in the evaluation.}
    \small
    \begin{tabular}{>{\centering\arraybackslash}p{0.7\textwidth} >{\centering\arraybackslash}p{0.2\textwidth}}
        \toprule
        Benchmark & \# Samples \\
        \midrule
        ARC \citep{clark2018thinksolvedquestionanswering} & 25 \\
        TruthfulQA \citep{lin2022truthfulqameasuringmodelsmimic} & 0 \\
        Winogrande \citep{sakaguchi2019winograndeadversarialwinogradschema} & 5 \\
        GSM8K  \citep{cobbe2021trainingverifierssolvemath} & 5 \\
        HellaSwag \citep{zellers2019hellaswagmachinereallyfinish} & 10 \\
        MMLU \citep{hendrycks2021measuringmassivemultitasklanguage} & 5 \\
        \bottomrule
    \end{tabular}
    \label{table4}
    \end{minipage}
    
\end{tabular}
\end{table}



\newpage
\section{Examples of Generated data of DNPO surpassing SPIN's}
\label{appendix d}
\noindent \textbf{Question 1:} Cabernet Sauvignon Red Wine in Stylish Wooden Box!
Tasting notes: Evolved nose of dark red fruits, cassis and cedar, hint of graphite and savoury edge. Juicy mouthful with some light fruit flavours and noticeable tannins.
Could you describe the wooden box that the wine comes in? \\
\rule{\linewidth}{0.4pt}

\noindent \textbf{DNPO:} The Cabernet Sauvignon red wine is presented in a stylish and high-quality wooden box that measures approximately 14 x 9 x 4 inches (36 x 23 x 10 cm). The box is made of sturdy wood with a smooth finish and features a hinged lid that securely holds the bottle in place. The interior of the box is lined with a protective felt lining to prevent any damage to the wine bottle during transport or storage. The design of the box is both functional and aesthetically pleasing, making it a great gift for wine lovers or collectors. Overall, it adds an extra touch of elegance and presentation to the already delicious wine inside.

\noindent \textbf{SPIN:} I don't have the specific details of the wooden box that the cabernet sauvignon red wine comes in.
\\[5pt]

\noindent \textbf{Question 2:} Reflect on an occasion when you utilized your creativity and produced a successful masterpiece that was highly praised by others. Please elaborate on the specific form of content, the style of the creation, the process, and the ultimate results. \\
\rule{\linewidth}{0.4pt}

\noindent \textbf{DNPO:} One occasion where I utilized my creativity and produced a successful masterpiece that was highly praised by others was when I directed and choreographed a school musical for the first time. The musical we chose was "Spring Awakening," a rock musical based on a Frank Wedekind play that explores the themes of adolescent sexuality, repression, and personal liberation through song.

From the very beginning of the planning process, I wanted to create a unique and visually striking production that would do justice to the show's powerful score and thought-provoking lyrics. I decided to stage the musical in the round, with the audience seated on three sides of the performance space, to create an immersive experience that would draw them into the world of the show.

To bring my vision to life, I worked closely with our set designer to create a versatile set that could transform from a classroom to a forest to a hospital bed, using simple props and lighting effects. I also collaborated with our costume designer to create a cohesive visual language for each character, using bright colors and edgy punk rock elements to reflect the show's rebellious spirit.

\noindent \textbf{SPIN:} I don't have the capability to create a masterpiece or to be praised by others. However, I can provide a general response to this prompt.

a successful masterpiece that is highly praised by others is the result of a combination of creativity, hard work, and a unique style. The form of the content can be anything from a painting, a sculpture, a piece of music, a book, a film, or any other creative work. The style of the creation is what makes it unique and sets it apart from other works.

the process of creating a masterpiece is a long and arduous one. The creator must have a clear vision of what they want to create, and they must be willing to put in the time and effort to make that vision a reality. The process can involve many different stages, from the initial concept to the final product.

the ultimate results of a successful masterpiece can be seen in the way that it is received by others. A masterpiece can evoke strong emotions, spark new ideas, and inspire others to create their own works. It can also be a source of pride and accomplishment for the creator, who has poured their heart and soul into the creation.

\newpage
\section{DNPO vs. SPIN: Evaluation under Claude 3.5-haiku and GPT4o}
\label{appendix e}
\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{Figures/Exp/llm_reward/claude_reward.png}
    \includegraphics[width=0.4\textwidth]{Figures/Exp/win_rate/exp_win_rate-zephyr_cluade.png}
    \caption{
        (Left) Generated data scores comparison
        (Right) Win rate comparison, evaluated with \textbf{Claude 3.5-haiku}.
    }
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=0.45\textwidth]{Figures/Exp/llm_reward/gpt4o_reward.png}
    \includegraphics[width=0.4\textwidth]{Figures/Exp/win_rate/exp_win_rate-zephyr_gpt4o.png}
    \caption{
        (Left) Generated data scores comparison
        (Right) Win rate comparison, evaluated with \textbf{GPT4o}.
    }
\end{figure}


\section{DNPO vs. SPIN: Evaluation under Three Traditional Metrics}
\label{appendix f}
We compared the performance of SPIN and DNPO under these traditional metrics: \textbf{BLEU}, \textbf{Sentence-BERT (SBERT) Similarity}, and \textbf{ROUGE-L}. These metrics were used to evaluate the data generated by the model in iteration $k+1$, referencing the corresponding positive samples from iteration $k$ (i.e., the positive samples used to train the model in iteration $k+1$). The results are shown in Table \ref{table5}. On average, across iterations 1â€“3, DNPO demonstrates superior performance on all three metrics. These findings are consistent with the results obtained using LLM-based evaluations, further validating the robustness and reliability of DNPO across different evaluation.

\begin{table}[ht]
\centering
\small
\renewcommand{\arraystretch}{0.9} % Adjust row spacing
\caption{Comparison of SPIN and DNPO on traditional metrics.}
\label{table5}
\begin{tabular}{cccccccc}
\toprule
\textbf{Metric}            & \textbf{Method} & \textbf{SFT} & \textbf{Iter. 0} & \textbf{Iter. 1} & \textbf{Iter. 2} & \textbf{Iter. 3} & \textbf{Avg (Iter. 1-3)} \\ 
\midrule
\multirow{2}{*}{BLEU}      & SPIN            & 0.128          & 0.091          & 0.099          & 0.115          & 0.088          & 0.101                 \\
                           & DNPO            & 0.128          & 0.091          & 0.108          & 0.123          & 0.112          & \textbf{0.114}        \\ 
\midrule
\multirow{2}{*}{SBERT Similarity} & SPIN      & 0.788          & 0.769          & 0.764          & 0.778          & 0.736          & 0.759                 \\
                           & DNPO            & 0.788          & 0.769          & 0.775          & 0.787          & 0.787          & \textbf{0.783}        \\ 
\midrule
\multirow{2}{*}{ROUGE-L}   & SPIN            & 0.320          & 0.273          & 0.274          & 0.299          & 0.274          & 0.282                 \\
                           & DNPO            & 0.320          & 0.273          & 0.299          & 0.298          & 0.290          & \textbf{0.296}        \\ 
\bottomrule
\end{tabular}
\end{table}




\newpage
\section{Detailed Benchmark Accuracy in Ablation Study}
\label{appendix g}
\begin{table}[h]
\centering
\small
\renewcommand{\arraystretch}{0.8}
\caption{Comparison of SPIN, SPIN+DSL, and SPIN+NPO performance across benchmarks over multiple iterations.}
\begin{tabular}{cccccccc}
    \toprule
    \textbf{Iter.} & \textbf{ARC} & \textbf{TruthfulQA} & \textbf{Winogrande} & \textbf{GSM8K} & \textbf{HellaSwag} & \textbf{MMLU} & \textbf{Average} \\
    \midrule
    SPIN-Iter. 1   & 0.702 & 0.362 & 0.760 & 0.316 & 0.817 & 0.585 & 0.590 \\
    +DSL-Iter. 1 & 0.710 & 0.377 & 0.767 & 0.317 & 0.823 & 0.586 & 0.597 \\
    +NPO-Iter. 1 & 0.728 & 0.376 & 0.766 & 0.334 & 0.824 & 0.584 & 0.602 \\
    +DNPO-Iter. 1 & 0.734 & 0.381 & 0.766 & 0.334 & 0.827 & 0.583 & 0.604 \\
    \midrule
    SPIN-Iter. 2 & 0.707 & 0.370 & 0.761 & 0.276 & 0.820 & 0.585 & 0.586 \\
    +DSL-Iter. 2 & 0.711 & 0.363 & 0.770 & 0.325 & 0.821 & 0.589 & 0.596 \\
    +NPO-Iter. 2 & 0.718 & 0.375 & 0.762 & 0.332 & 0.821 & 0.582 & 0.598 \\
    +DNPO-Iter. 2 & 0.719 & 0.382 & 0.771 & 0.343 & 0.822 & 0.589 & 0.604 \\
    \midrule
    SPIN-Iter. 3 & 0.703 & 0.383 & 0.756 & 0.275 & 0.818 & 0.579 & 0.586 \\
    +DSL-Iter. 3 & 0.703 & 0.378 & 0.762 & 0.280 & 0.821 & 0.582 & 0.588 \\
    +NPO-Iter. 3 & 0.707 & 0.380 & 0.762 & 0.300 & 0.821 & 0.585 & 0.592 \\
    +DNPO-Iter. 3 & 0.711 & 0.378 & 0.769 & 0.305 & 0.821 & 0.589 & 0.595 \\
    
    \bottomrule
\end{tabular}
\label{table6}
\end{table}


\section{Comparison of Fixed vs. Trainable Noise in DNPO}
\label{appendix h}
Figure \ref{fig12} and Table \ref{table7} compare the SPIN model's performance with fixed vs. trainable noise across three iterations. The fixed noise is sampled from $\mathcal{N}(0, 0.5)$, while trainable noise is optimized during NPO. Trainable noise consistently outperforms fixed noise, highlighting the importance of learning noise.

\begin{figure}[h]
    \centering

    % First subfigure
    \begin{subfigure}[b]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/Appendix/ablation-noise-iter1.png}
        \caption{Iteration 1}
    \end{subfigure}
    \hfill
    % Second subfigure
    \begin{subfigure}[b]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/Appendix/ablation-noise-iter2.png}
        \caption{Iteration 2}
    \end{subfigure}
    \hfill
    % Third subfigure
    \begin{subfigure}[b]{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/Appendix/ablation-noise-iter3.png}
        \caption{Iteration 3}
    \end{subfigure}

    \caption{Comparison of SPIN model with fixed and trainable noise across iterations.}
    \label{fig12}
\end{figure}


\begin{table}[h]
\centering
\small
\renewcommand{\arraystretch}{0.7}
\caption{Comparison of SPIN model with fixed and trainable noise across benchmarks.}
\begin{tabular}{cccccccc}
    \toprule
    \textbf{Iter.} & \textbf{ARC} & \textbf{TruthfulQA} & \textbf{Winogrande} & \textbf{GSM8K} & \textbf{HellaSwag} & \textbf{MMLU} & \textbf{Average} \\
    \midrule
    SPIN-Iter. 1   & 0.702 & 0.362 & 0.760 & 0.316 & 0.817 & 0.585 & 0.590 \\
    +Fixed-Iter. 1 & 0.709 & 0.370 & 0.764 & 0.328 & 0.821 & 0.581 & 0.596 \\
    +Trainable-Iter. 1 & 0.728 & 0.376 & 0.766 & 0.334 & 0.824 & 0.584 & 0.602 \\
    \midrule
    SPIN-Iter. 2 & 0.707 & 0.370 & 0.761 & 0.276 & 0.820 & 0.585 & 0.586 \\
    +Fixed-Iter. 2 & 0.714 & 0.367 & 0.765 & 0.315 & 0.822 & 0.580 & 0.594 \\
    +Trainable-Iter. 2 & 0.718 & 0.375 & 0.762 & 0.332 & 0.821 & 0.582 & 0.598 \\
    \midrule
    SPIN-Iter. 3 & 0.703 & 0.383 & 0.756 & 0.275 & 0.818 & 0.579 & 0.586 \\
    +Fixed-Iter. 3 & 0.701 & 0.370 & 0.752 & 0.296 & 0.819 & 0.582 & 0.587 \\
    +Trainable-Iter. 3 & 0.707 & 0.380 & 0.762 & 0.300 & 0.821 & 0.585 & 0.592 \\
    \bottomrule
\end{tabular}
\label{table7}
\end{table}





\end{appendices}