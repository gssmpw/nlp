%!TEX root = ./mainRSCED.tex

\section{Formulating the risk-sensitive security-constrained economic dispatch problem}
\label{sec:rsced}

% System operators are tasked with solving forward dispatch problems at various intervals before the real-time in order to make dispatch decisions. Such problems seek to minimize the cost of procuring energy, or dispatch cost, subject to certain engineering constraints of the grid. We begin by presenting the deterministic \ED{} problem, which we will use to derive the risk-sensitive counterpart. 
% \subsection{The deterministic economic dispatch problem}
% Consider an $n$-bus power network, connected by $\ell$ lines. Each bus is equipped with some demand and generation capacity, the vector values of which are denoted $\v{d}$ and $\v{g}$. Assume that each generator has a linear cost, collected by the vector $\v{c}$\footnote{Such cost structures are able to represent piecewise-affine costs of generation that are frequently adopted in such problems.}, and can only produce power within $\Gcal := [\underline{\v{g}}, \overline{\v{g}}]$. The total cost of generation is then $\v{c}^\top \v{g}$. We adopt the DC approximations, that assume lossless lines, negligible reactive power, and small voltage phase angle differences. Such assumptions allow us to represent the nonlinear equations of Kirchoff's laws as linear constraints. 

% Letting $\bone$ denote the vector of all ones, and $\v{H}$ be the injection-shift factor (ISF) matrix, the \ED{} problem is stated formally as
% \begin{subequations}
% \begin{align}
%     &\underset{\v{g} \in \Gcal}{\text{minimize}} && \v{c}^\top \v{g}, \label{eq:ED.obj} \\
%     &\text{subject to} && \bone^\top \left(\v{g} - \v{d}\right) = 0, \quad \v{H} \left( \v{g} - \v{d} \right) \le \v{f}. \label{eq:ED.cons}
% \end{align}
% \label{eq:ED}
% \end{subequations}
% The economic dispatch problem in 
% Problem
ED problem \eqref{eq:ED} assumes a static network topology, without regard for possible component failures. To ensure resilience against potential outages, this formulation must be augmented with additional security constraints. 

% This problem assumes full component availability, and cannot provide any meaningful guarantees in the event of a component failure. In order to ensure satisfaction of the $N-1$ security criterion, this formulation must be augmented with security-constraints, that ensure the network remains resilient to any potential component failure. For simplicity, we restrict attention to potential line outages.
% % Generator outages can be accommodated, but will
% Denote the set of all potential outages by $\Kset$, which is indexed by $k = 1, \dots, K$.

% \subsection{The Risk-Sensitive Economic Dispatch Problem}
We now present our formulation of the risk-sensitive counterpart of ED problem \eqref{eq:ED}. Consider a set of credible line outage scenarios, indexed by $k\in[K]$, in which one or more lines fail. Suppose scenario $k$ is realized\footnote{\rev{Line outage occurance probabilities, as well as average outage durations, can be obtained from historical data, e.g, by methods described in \cite{chowdhury2006causal}.}}. Then, the post-contingency line flows are given by $\v{H}_k (\v{g} - \v{d})$, where $\v{H}_k$ is the ISF matrix describing the post-contingency network. Such flows must remain within rated line capacities. However, these capacities arise primarily from thermal considerations and can be relaxed temporarily. We refer to the situation in which no contingency $k\in[K]$ arises as the nominal or the base-case. 
% \rev{add footnote about how probabilities can be estimated.}
We adopt the convention in \cite{national2010transmission}, summarized in Table \ref{tab:relaxed.line.limits}, allowing capacities to be relaxed to the drastic-action limit $\v{f}_k^\DA{}$, in the event of a failure. We ensure flows return to the short-term emergency level $\v{f}_k^\SE{}$, within 5 minutes, during which we allow for some recourse action. \footnote{\rev{In this work, we allow for an initial dispatch decision, followed by a single redispatch once a scenario occurs. Our framework is readily extended to multi-period settings, where a series of redispatches are taken to bring line flows within normal operating limits.}}
%
\begin{table}[ht]
    \centering
    \caption{Relaxed line flow capacity limits for emergency scenarios.}
    \begin{tabular}{l c c}
        \toprule
         \textbf{Name} & \textbf{Maximum allowable time} \\
         \midrule
         Nominal & Indefinite \\
         % Long-Term Emergency (LE) & 4 hours \\
         Short-Term Emergency (SE) & 15 minutes \\
         Drastic Action (DA) & 5 minutes \\
         \bottomrule \\
    \end{tabular}
    \label{tab:relaxed.line.limits}
\end{table}
%
% The recourse actions available to SOs include re-dispatch of generation deployment of procured reserves, and load shed. By simultaneously procuring generation and reserves, we ensure that adequate capacity is available in line outage scenarios. 
We assume that the recourse actions available to SOs include re-dispatch of generation and load shed. By simultaneously procuring generation and reserves, we seek to ensure that adequate capacity is available in line outage scenarios, and reduce the occurrence and magnitude of load shed. 

Let $\underline{\v{r}}$ and $\overline{\v{r}}$ denote the vectors of negative and positive nodal reserve capacity, with associated linear marginal costs $\underline{\v{c}}_r$ and $\overline{\v{c}}_r$, respectively. Collecting generator re-dispatch
% \sout{, measured as the difference from the nominal,} 
and load shed decisions across scenarios $[K]$ as $\v{\delta g}$ and $\v{\delta d}$, respectively, and 
% \sout{The set of allowable load shed is given by the set} 
defining the acceptable load shed range in any scenario as $\mathcal{D} := [0, \v{\Delta}_d]$, the risk-sensitive economic dispatch problem $\RSCED{}_{\alpha}$ is given by
%
\begin{subequations} %
\label{eq:RSCED} %
\begin{align} %
    &\underset{\v{g}, \underline{\v{r}}, \overline{\v{r}}, \v{\delta g}, \v{\delta d}}{\text{minimize}} && \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + \CVaR{}_{\alpha} \left[ \mathcal{C}(\v{\delta d} ) \right] \label{eq:RSCED.obj}, \\
    &\text{subject to} && \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{H} \left( \v{g} - \v{d} \right) \le \v{f}, \; \v{g} \in \Gcal \label{eq:RSCED.nominal} \\
    &&& \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA},\label{eq:RSCED.da} \\
    &&& \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0,\label{eq:RSCED.se.balance} \\
    &&& \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED.se.flow} \\
    &&& \v{g} + \v{\delta g}_k \in \Gcal, \; \v{\delta g}_k \in [-\underline{\v{r}}, \overline{\v{r}}], \label{eq:RSCED.se.genbounds} \\
    &&& 0 \le \underline{\v{r}}, \overline{\v{r}}, \; \v{\delta d}_k \in \mathcal{D}, \label{eq:RSCED.se.bounds} \\
    \nonumber &&& \forall k\in [K]
    % = 1, \dots, K, %
\end{align} %
\end{subequations} %
%
where in \eqref{eq:RSCED.obj}, $\Ccal(\v{\delta d})$ denotes the random load shed cost given $\v{\delta d}$. The \emph{conditional value at risk} measure $\CVaR{}_{\alpha}$ and associated parameter $\alpha$ are formally defined below. 

The cost associated with load shed is modeled by the \emph{value of lost load} (\VoLL{}), denoted $\voll\in\Rset^n$. The realized \VoLL{} varies over the line outage scenarios $[K]$. Assuming that contingencies are independent, \rev{i.e., only one contingency occurs at a time,} and each contingency $k$ occurs with probability $p_k$, the random load shed cost is given by
\begin{equation}
    \mathcal{C}(\v{\delta d}) := \begin{cases}
      \voll^\top \v{\delta d}_k & \text{with probability $p_k$ for $k\in[K]$}, \\
      0 & \text{with probability } 1 - \sum_{k = 1}^K p_k.
    \end{cases}
    \label{eq:voll}
\end{equation}

% We consider the following risk-sensitive \SCED{} formulation (\RSCED{}), which augments the \CSCED{} problem by allowing for potential load shed and explicitly incorporates reserve procurement in the problem statement.

% The nodal load shed in scenario $k$ is denoted by the vector $\v{\delta d}_k$, the cost of which is modeled through the value of lost load (\VoLL{}), denoted by $\voll{}$. Let $\overline{\v{r}}$ and $\underline{\v{r}}$ be the positive and negative nodal reserve procurement, and $\v{c}_r$ be the linear cost of procuring reserve.

% In this setting, the cost associated with recourse action is dependent on the realized contingency. We assume that the contingencies have fixed probabilities of failure, $p_k$. Thus the random recourse cost can be represented by the random variable $\mathcal{C}(\v{\delta d})$, which takes values $\voll^\top \v{\delta d}_k$ with probability $p_k$ and $0$ with probability $1 - \sum_{k = 1}^K p_k$.

% The \RSCED{} problem is then formulated as
% % The risk-sensitive \SCED{} formulation (\RSCED{}) aims to capture the SOs natural aversion to load shed, by instead minimizing the conditional value at risk (\CVaR{}) of $\mathcal{C}(\v{\delta g}, \v{\delta d})$. This formulation, which we will denote by $\RSCED{}_{\alpha}$ for a fixed parameter $\alpha$, is given by
% %
% \begin{subequations} %
% \label{eq:RSCED} %
% \begin{align} %
%     &\underset{\v{g}, \underline{\v{r}}, \overline{\v{r}}, \v{\delta g}, \v{\delta d}}{\text{minimize}} && \CVaR{}_{\alpha} \left[ \v{c}^\top \v{g} + \v{c}_r^\top \underline{\v{r}} + \v{c}_r^\top \overline{\v{r}} + \mathcal{C}(\v{\delta d} ) \right] \label{eq:RSCED.obj}, \\
%     &\text{subject to} && \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{H} \left( \v{g} - \v{d} \right) \le \v{f}, \; \v{g} \in \Gcal \label{eq:RSCED.nominal} \\
%     &&& \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA}, \label{eq:RSCED.da} \\
%     &&& \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \label{eq:RSCED.se.balance} \\
%     &&& \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED.se.flow} \\
%     &&& \v{g} + \v{\delta g}_k \in \Gcal, \; \v{\delta g}_k \in [-\underline{\v{r}}, \overline{\v{r}}], \; \v{\delta d}_k \in \v{\Delta}_d, \label{eq:RSCED.se.bounds} \\
%     &&& \forall k = 1, \dots, K. %
% \end{align} %
% \end{subequations} %
%
Together with generation and reserve capacity costs, under the \RSCED{} formulation in \eqref{eq:RSCED} we minimize the conditional value at risk (\CVaR{}) associated with $\Ccal(\v{\delta d})$. Intuitively, given parameter $\alpha$, $\CVaR{}_{\alpha}$
% Here, we make use of \CVaR{}, that, parameterized by $\alpha$, 
measures the expected tail loss over the $(1-\alpha)$-fraction of worst-case scenarios. For general distributions over scaler random variable $\xi$, $\CVaR{}_{\alpha}[\xi]$ is formally defined via the variational form
\begin{equation}\label{eq:CVaR_var}
    \cvar[\alpha]{\xi} := \min_{\mathpzc{z}} z + \frac{1}{1 - \alpha} \mathbb{E}[ \xi - z ]^+,
\end{equation}
where $[\cdot]^+$ denotes the positive part of its argument  \cite{rockafellar2000optimization}, and the expectation is taken with respect to the probabilities $p_k$ for $k\in[K]$ appearing in \eqref{eq:voll}. Selection of $\alpha$ allows an SO to express their level of tolerance to high cost scenarios. Setting $\alpha = 0$ renders \CVaR{} equal to expected value, while taking $\alpha \uparrow 1$, drives \CVaR{} to the essential supremum, akin to robust optimization. Figure \ref{fig:cvar} provides an illustration of this risk-measure over a fixed distribution.
%
\begin{figure}
    \centering
    % \includegraphics[width=0.7\linewidth]{images/cvar.pdf}
    \includegraphics[width=0.6\linewidth]{images/cvar_large_font.png}
    \caption{A description of \CVaR{} over the cost distribution induced by a set of fixed decision variables}
    \label{fig:cvar}
\end{figure}
%
Optimization over a \CVaR{} objective amounts to selecting decision variables whose induced distribution reduces the expected tail loss. 

% The \CVaR{}, parameterized by $\alpha$, measures the expected tail loss over the $(1 - \alpha)$-fraction of worst case scenarios. Notice that by taking $\alpha = 0$, $\CVaR{}$ is equivalent to expectation, while $\alpha \uparrow 1$ is the essential supremum akin to robust optimization. Selection of the parameter $\alpha$ allows SOs the opportunity to express their level of tolerance to potentially high costs. Figure \ref{fig:cvar} provides an illustration of this risk-measure for some fixed distribution.
% %
% \begin{figure}
%     \centering
%     \includegraphics[width=0.7\linewidth]{images/cvar_beta3.pdf}
%     \caption{A description of \CVaR{} over the cost distribution induced by a set of fixed decision variables}
%     \label{fig:cvar}
% \end{figure}
% %
% The definition of $\CVaR{}$ assumes some fixed decision variables. When optimizing over $\CVaR$, we seek to determine decision variables whose induced distribution has the lowest expected tail loss.

% Adopting the \CVaR{} risk measure, allowing for load shed, and accounting for the cost associated with recourse actions, the \RSCED{} formulation is given by
% % The \CVaR{} risk measure is used to augment the cost of the \CSCED{} formulation by considering all contingencies as random events with specified probabilities, and accounting for the cost associated with these contingencies in the form of either recourse generation or potential load shed. Together, this is given by
% %
% \begin{equation}
% \begin{aligned}
%     &\underset{\v{g}, \v{\delta g}_k}{\text{minimize}} && \CVaR{}_{\alpha} \left[ \v{c}^\top \v{g} + \mathcal{C}(\v{\delta g}, \v{\delta d}) \right], \\
%     &\text{subject to} && \eqref{eq:CSCED.nominal} \text{ --- } \eqref{eq:CSCED.da}, \\
%     &&& \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \\
%     &&& \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \\
%     &&& \forall k = 1, \dots, K.
% \end{aligned}
% \label{eq:RSCED}
% \end{equation}
% %
% For notational convenience, we denote \RSCED{} with some fixed $\alpha$ by $\RSCED{}_{\alpha}$. 

% The \RSCED{} formulation \eqref{eq:RSCED} generalizes that in \cite{bouffard2008stochastic}, which minimizes the expected cost rather than using \CVaR{}. 
SOs typically treat load shed as an action of last resort and are thus highly averse to such outcomes, and minimization of expected costs can lead to undesirably high levels of load shed. Instead, the use of \CVaR{} takes advantage of the fact that \VoLL{} is typically much larger than the cost of generation or reserves.
% or reserve capacity. 
Thus, increasing the risk aversion parameter $\alpha$ 
% to decrease high-cost scenarios 
prioritizes the avoidance of load shed.
% in worst-case scenarios.

\revision{Specific transmission lines may be more prone to failures than others, e.g., from wildfire risks as modeled in \cite{rhodes2020balancing,taylor2022framework}. We allow these line failure probabilities $p_1, \ldots, p_K$ to vary across the scenarios and study the impact of such probabilities empirically later in the paper. One can consider multi-line and generator failures within our formulation. In this work, we focus on the case of single line failures to streamline our presentation. When including possible generator failures, one needs to appropriately constrain recourse actions that can be taken in each such contingency.}


\subsection{Formulating \RSCED{} as a linear program}\label{sec:formulating}
Given the piecewise linearity of $\Ccal(\v{\delta d})$ across scenarios, the \RSCED{} problem can be written as a large linear program. 
% To do so, we leverage the variational form of \CVaR{} given in \eqref{eq:CVaR_var}. 
% \cite{rockafellar2002conditional}, which defines \CVaR{} over a scalar random variable $\mathpzc{x}$ as
% %
% \begin{equation}
% \label{eq:CVaR_var}
% \begin{aligned}
%     \CVaR{}_{\alpha}[\mathpzc{x}] := \; &\min_{z}\,\,z + \frac{1}{1 - \alpha}\E[\mathpzc{x} - z]^+,
% \end{aligned}
% \end{equation}
% %
% where $[x]^+=\max\{0,x\}$. 
Applying \eqref{eq:CVaR_var} to $\CVaR_{\alpha}[\Ccal(\v{\delta d})]$, the \RSCED{} objective \eqref{eq:RSCED.obj} can equivalently be written as
%
\begin{equation}
\label{eq:RSCED_obj_var}
\begin{aligned}
    & \min_z \; \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + z + \frac{1}{1 - \alpha} \E[\mathcal{C}(\v{\delta d}) - z]^+ \\
    &  = \min_z \; \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + z + \frac{1}{1 - \alpha} \sum_{k = 1}^K p_k [\voll^\top \v{\delta d}_k - z]^+.
\end{aligned}
\end{equation}
%
Taking the epigraph form of each term in the sum over scenarios in \eqref{eq:RSCED_obj_var}, the \RSCED{} problem can be written as
%
% \begin{subequations} %
% \allowdisplaybreaks
% \label{eq:RSCED.lp} %
% \begin{align}
%     &\underset{\substack{z, \v{y}, \v{g}, \underline{\v{r}}, \overline{\v{r}}, \\ \v{\delta g}, \v{\delta d}}}{\text{minimize}} && \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + z + \frac{1}{1 - \alpha} \sum_{k = 1}^K p_k y_k, \\
%     % &\text{subject to} && \eqref{eq:RSCED.nominal} \text{ --- } \eqref{eq:RSCED.se.bounds} \\
%     &\text{subject to} && (\lambda, \underline{\v{\gamma}}, \overline{\v{\gamma}}) : \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{g} \in \Gcal \label{eq:RSCED.lp.nominal} \\
%     &&& (\v{\mu}, \v{\mu}_k^\DA{}): \v{H} \left( \v{g} - \v{d} \right) \le \v{f}, \; \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA},  \label{eq:RSCED.lp.lineflow} \\
%     &&& (\lambda_k): \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \label{eq:RSCED.lp.se.balance} \\
%     &&& (\v{\mu}_k^\SE{}): \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED.lp.se.flow} \\
%     &&& (\underline{\v{\gamma}}_k, \overline{\v{\gamma}}_k, \underline{\v{\rho}}_k, \overline{\v{\rho}}_k): \v{g} + \v{\delta g}_k \in \Gcal, \; \v{\delta g}_k \in [-\underline{\v{r}}, \overline{\v{r}}], \label{eq:RSCED.lp.se.genbounds} \\
%     &&& (\underline{\v{\eta}}, \overline{\v{\eta}}, \underline{\v{\sigma}}_k, \overline{\v{\sigma}}_k): 0 \le \underline{\v{r}}, \overline{\v{r}}, \; \v{\delta d}_k \in \mathcal{D}, \label{eq:RSCED.lp.se.bounds} \\
%     &&& (\underline{\nu}_k, \overline{\nu}_k): y_k \ge 0, \; y_k \ge \voll^\top \v{\delta d}_k - z, \label{eq::RSCED.lp.epigraph}\\ % && : \underline{\nu}_k, \overline{\nu}_k
%     &&& \forall k\in[K],
%     % = 1, \dots, K,
% \end{align}
% \end{subequations}
% \begin{subequations} %
% \allowdisplaybreaks

% \begin{flalign}
%     &\underset{\substack{z, \v{y}, \v{g}, \underline{\v{r}}, \overline{\v{r}}, \\ \v{\delta g}, \v{\delta d}}}{\text{minimize}} && \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + z + \frac{1}{1 - \alpha} \sum_{k = 1}^K p_k y_k, \label{eq:RSCED.lp}\\ %\\
%     % &\text{subject to} && \eqref{eq:RSCED.nominal} \text{ --- } \eqref{eq:RSCED.se.bounds} \\
%     \nonumber&\text{subject to} && (\lambda, \underline{\v{\gamma}}, \overline{\v{\gamma}}) : \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{g} \in \Gcal \label{eq:RSCED.lp.nominal} \\
%     \nonumber&&& (\v{\mu}, \v{\mu}_k^\DA{}): \v{H} \left( \v{g} - \v{d} \right) \le \v{f}, \; \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA},  \label{eq:RSCED.lp.lineflow}\\
%    \nonumber &&& (\lambda_k): \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \label{eq:RSCED.lp.se.balance} \\
%     \nonumber&&& (\v{\mu}_k^\SE{}): \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED.lp.se.flow} \\
%     \nonumber&&& (\underline{\v{\gamma}}_k, \overline{\v{\gamma}}_k, \underline{\v{\rho}}_k, \overline{\v{\rho}}_k): \v{g} + \v{\delta g}_k \in \Gcal, \; \v{\delta g}_k \in [-\underline{\v{r}}, \overline{\v{r}}], \label{eq:RSCED.lp.se.genbounds} \\
%     \nonumber&&& (\underline{\v{\eta}}, \overline{\v{\eta}}, \underline{\v{\sigma}}_k, \overline{\v{\sigma}}_k): 0 \le \underline{\v{r}}, \overline{\v{r}}, \; \v{\delta d}_k \in \mathcal{D}, \label{eq:RSCED.lp.se.bounds} \\
%     \nonumber&&& (\underline{\nu}_k, \overline{\nu}_k): y_k \ge 0, \; y_k \ge \voll^\top \v{\delta d}_k - z, \label{eq::RSCED.lp.epigraph}\\ % && : \underline{\nu}_k, \overline{\nu}_k
%     \nonumber&&& \forall k\in[K],
%     % = 1, \dots, K,
% \end{flalign}
\begin{subequations}
\label{eq:RSCED.lp}
\begin{flalign}
    &\underset{\substack{z, \v{y}, \v{g}, \underline{\v{r}}, \overline{\v{r}}, \\ \v{\delta g}, \v{\delta d}}}{\text{minimize}} && \v{c}^\top \v{g} + \underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} + z + \frac{1}{1 - \alpha} \sum_{k = 1}^K p_k y_k, \\ %\\
    % &\text{subject to} && \eqref{eq:RSCED.nominal} \text{ --- } \eqref{eq:RSCED.se.bounds} \\
    &\text{subject to} && (\lambda, \underline{\v{\gamma}}, \overline{\v{\gamma}}) : \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{g} \in \Gcal \label{eq:RSCED.lp.nominal} \\
    &&& (\v{\mu}): \v{H} \left( \v{g} - \v{d} \right) \le \v{f},  \label{eq:RSCED.lp.lineflow}\\
    &&& (\v{\mu}_k^\DA{}): \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA},  \label{eq:RSCED.lp.lineflow_k}\\
   &&& (\lambda_k): \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \label{eq:RSCED.lp.se.balance} \\
    &&& (\v{\mu}_k^\SE{}): \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED.lp.se.flow} \\
    &&& (\underline{\v{\gamma}}_k, \overline{\v{\gamma}}_k): \v{g} + \v{\delta g}_k \in \Gcal, \label{eq:RSCED.lp.se.genbounds} \\
    &&& (\underline{\v{\rho}}_k, \overline{\v{\rho}}_k): \v{\delta g}_k \in [-\underline{\v{r}}, \overline{\v{r}}], \label{eq:RSCED.lp.se.dgenbounds} \\
    &&& (\underline{\v{\eta}}, \overline{\v{\eta}}, \underline{\v{\sigma}}_k, \overline{\v{\sigma}}_k): 0 \le \underline{\v{r}}, \overline{\v{r}}, \; \v{\delta d}_k \in \mathcal{D}, \label{eq:RSCED.lp.se.bounds} \\
    &&& (\underline{\nu}_k, \overline{\nu}_k): y_k \ge 0, \; y_k \ge \voll^\top \v{\delta d}_k - z, \label{eq::RSCED.lp.epigraph}\\ % && : \underline{\nu}_k, \overline{\nu}_k
    \nonumber&&& \forall k\in[K],
    % = 1, \dots, K,
\end{flalign}
\end{subequations}
% \end{flalign*}
% \end{subequations}
where we have associated Lagrange multipliers (in parentheses) with each of the constraints. As with the LMP-based prices arising from the ED problem \eqref{eq:ED}, these dual multipliers will constitute the basis for the R-SCED based market clearing process and prove useful in establishing its properties.
% in the \RSCED{} context, and prove useful in establishing properties of associated market clearing processes.

\revision{An important implication of the formulation of R-SCED as a linear program in \eqref{eq:RSCED.lp} is that it falls under the same optimization class as previously studied C-SCED formulations presented in \eqref{eq:csced} below. Despite adding the flexibility of specifying risk-aversion through the tunable parameter $\alpha$ (the effect of which we will study through examples), R-SCED lies in the same computational class as does C-SCED.}

\subsection{Relation to existing formulations}
Various security-constrained economic dispatch formulations exist within the literature, offering different guarantees for security. Perhaps the simplest is \emph{preventive}-\SCED{} (\PSCED{}) \cite{alsac1974optimal}, which is given by
\begin{equation}\nonumber
\begin{aligned}
(\PSCED{})\quad& \underset{\v{g}}{\text{minimize}} && \v{c}^\top \v{g}, \\
    & \text{subject to} && \eqref{eq:RSCED.nominal}, \v{H}_k (\v{g} - \v{d}) \le \v{f},\\
    &&& \forall k\in[K]
    % =1,\dots,K.
\end{aligned}
\end{equation}
\PSCED{} ensures that the nominal system dispatch is robust to \emph{any} credible outage, but can be overly conservative. Corrective-\SCED{} (\CSCED{}) \cite{monticelli1987security} allows for potential recourse action, but typically assumes fixed reserve capacity, 
% \nate{$\v{\delta d}$ is still an optimization variable in (10)}
ignores the cost associated with recourse action, and does not allow for load shed (i.e., $\v{\delta d}_k$ is fixed at $\v{0}$ in all scenarios)
\begin{equation}\label{eq:csced}
\begin{aligned}
    (\CSCED{})\quad&\underset{\v{g}, \v{\delta g}}{\text{minimize}} && \v{c}^\top \v{g}, \\
    % (\CSCED{})\quad&\underset{\v{g}, \v{\delta g}}{\text{minimize}} && \v{c}^\top \v{g}, \\
    & \text{subject to} && \eqref{eq:RSCED.nominal} \text{-} \eqref{eq:RSCED.se.balance}, \eqref{eq:RSCED.se.genbounds}, \\
    &&& \v{H}_k (\v{g} + \v{\delta g}_k - \v{d}) \le \v{f}_k^\SE{},\\
     &&& \forall k \in [K].%
\end{aligned}
\end{equation}
\iffalse
In \cite{bouffard2008stochastic}, the authors consider the costs of both generator re-dispatch, as well as potential load shed, but seek to minimize cost in expectation. As we will demonstrate, this can lead to higher levels of load shed than necessary. 
\fi
% \nate{Tie this more clearly to references, including \cite{bouffard2008stochastic}.}
% \subsection{Properties of the \RSCED{} formulation}
To illustrate the differences in dispatch and costs rendered under ED, \PSCED{}, and \CSCED{}, consider the 3-bus network in \cite{lesieutre2011examining}  with added generation at bus 3, shown in Figure \ref{fig:3bus}. 
\input{3bus}
In this example, all generation capacity limits are $20$ MW and lines 1-2 and 1-3
% $f_{12}$ and $f_{23}$ 
have capacity $9000$ MW, and thus can be neglected. Line 2-3 has a capacity of $50$ MW. Assume drastic action limits and short term emergency limits 
% are 
given by $\v{f}_k^\DA{} = 1.8 \v{f}$ and $\v{f}_k^\SE{} = 1.2 \v{f}$, respectively, and the maximum reserve procurement to be $0.2$ MW per generator. 
% \nate{reserve capacity for C-SCED? also in C-SCED is $\v{\delta g}$ restricted to be 0?}
% \nate{What are the scenarios here?}
%
\begin{table}[ht]
    \centering
        \caption{Comparison of dispatch for various ED formulations.}
    \begin{tabular}{l c c c}
         \toprule
         \textbf{Method} & ($g_1^*$, $g_2^*$, $g_3^*$) \textbf{(MW/h)} & \textbf{Nominal cost (\$/h)}  \\
         \midrule
         ED & (144.3, 170.7, 0) & 926 \\
         \PSCED{} & (110, 160, 45) & 1192 \\
         \CSCED{} & (119, 181, 15) & 962  \\
         \bottomrule \\
    \end{tabular}
    \label{tab:ED.compare}
\end{table}
%
Comparing nominal cost figures in Table \ref{tab:ED.compare}, we observe that \CSCED{} produces a lower cost of generation than \PSCED{}, reflecting the cost-free adjustments allowed for in \eqref{eq:csced}. While the ED dispatch achieves the lowest cost of the three methods, this lower cost comes at the expense of any sort of security guarantee against line failure contingencies. 

We now consider \RSCED{} outcomes including reserve procurement and load shed for the 3-bus network. The cost of reserve capacity is given by $1.2$ times the cost of generation, and the value of lost load is uniformly $\$30$/MWh. Assume that the probability of a failure of any single line is $p_k = 0.1$. 
%
% \begin{table}[H]
%     \centering
%     \begin{tabular}{l c c c c}
%          \toprule
%          & $\v{g}^*$ & \textbf{Nominal} & \textbf{Reserve} & \textbf{Total load} \\
%          \textbf{Method} & \textbf{(MW/h)} & \textbf{cost (\$/h)} & \textbf{cost (\$/h)} & \textbf{shed (MW)}  \\
%          \midrule
%          \RSCED{}$_0$ & (119, 181, 15) & 962 & 28.8 & 31 \\
%          \RSCED{}$_{0.1}$ & (110, 184.7, 20.3) & 974.9 & 21.1 & 29.34 \\
%          \RSCED{}$_{0.9}$ & (110, 170, 35) & 1104 & 0 & 0 \\
%          \bottomrule \\
%     \end{tabular}
%     \caption{Comparison of \RSCED{} dispatch for various $\alpha$.}
%     \label{tab:RSCED.compare}
% \end{table}
%
\begin{table}[H]
    \centering
        \caption{Comparison of \RSCED{} dispatch for various $\alpha$.}\label{tab:RSCED.compare}
    % \begin{tabular}{p{0.12\columnwidth}>{\centering}p{0.24\columnwidth}>{\centering}p{0.127\columnwidth}>{\centering}p{0.127\columnwidth}{\centering}p{0.155\columnwidth}}
    \begin{tabular}{l c c c c}
         \toprule
         & $\v{g}^*$ & \textbf{Nominal} & \textbf{Reserve} & \textbf{Total load} \\
         \textbf{Method} & \textbf{(MW/h)} & \textbf{cost (\$/h)} & \textbf{cost (\$/h)} & \textbf{shed (MW)}  \\
         \midrule
         \RSCED{}$_0$ & (119, 181, 15) & 962 & 28.8 & 31 \\
         \RSCED{}$_{0.1}$ & (110, 184.7, 20.3) & 974.9 & 21.1 & 29.34 \\
         \RSCED{}$_{0.9}$ & (110, 170, 35) & 1104 & 0 & 0 \\
         \bottomrule \\
    \end{tabular}
\end{table}

\begin{figure}
    \centering
    % \includegraphics[width=0.9\columnwidth]{Revision 20250208/images/3bus_vary_p.png}
    \includegraphics[width=0.86\columnwidth]{images/3bus_vary_p.pdf}
    \caption{The impact of varying line 1-3 failure probability on nominal generation cost and load shed in the 3-bus example when $\alpha = 0$ (solid) and $\alpha=0.9$ (dotted).}
    \label{fig:3bus_vary_p}
\end{figure}

%In this example, when minimizing the expected cost in \RSCED{}$_0$, the nominal dispatch $\v{g}^{\star}$ is the same as \CSCED{}. \nate{In fact \RSCED{}$_0$ is the same as \CSCED{} when the objective is taken as the total expected cost, including recourse.} 
Notice that when the SO has lower risk aversion, i.e., when $\alpha\in\{0,0.1\}$, she is willing to incur some level of load shed. As she becomes more risk-averse to high costs, expressed as $\alpha=0.9$, the quantity of load shed and reserve capacity decrease and in fact both reach zero, meaning the SO effectively implements \PSCED{}, albeit under relaxed short-term emergency level line flow constraints. The dispatch in this case prioritizes local generation to avoid shortfalls in the event of a contingency.

\revision{Relaxing the assumption that single line failure probabilities are fixed to a common value, Figure \ref{fig:3bus_vary_p} illustrates the impact of varying line failure probability of a single line on the nominal generation cost and amount of load shed.  In particular, we vary the failure probability of line 1-3 in Figure \ref{fig:3bus}, as the other probabilities remain fixed at $p_k=0.1$. The values of each curve plotted do not change for probabilities larger than 0.15, and are thus omitted. 
Higher chances of line failure increase risks of power delivery, compensating for which requires a higher-cost nominal generation. When the SO is highly risk-averse ($\alpha=0.9$), nominal generation costs quickly climb as the failure probability increases from zero, while a risk-neutral SO $(\alpha=0)$  only adjusts nominal generation for large enough failure probability. Moreover, an increase in this probability amplifies the cost associated with load-shed through the $\CVaR{}_{\alpha} \left[ \mathcal{C}(\v{\delta d} ) \right]$ term in \RSCED{}, forcing the algorithm to shed less load. This term increases with the tunable risk parameter $\alpha$. As a result, the drop in the load-shed occurs at smaller values of the line failure probability with $\alpha = 0.9$ compared to that with $\alpha = 0$.
 % For both risk preferences, the load shed amount changes in an inverse manner, and 
All quantities agree for large enough failure rates ($\geq$ 0.15).}
% In the following, associate dual multipliers $\lambda$, $\v{\mu}$, $\underline{\v{\gamma}}$, and $\overline{\v{\gamma}}$ with \eqref{eq:RSCED.nominal}, $\v{\mu}_k^\DA{}$ with \eqref{eq:RSCED.da}, $\lambda_k$ with \eqref{eq:RSCED.se.balance}, $\v{\mu}_k^\SE{}$ with \eqref{eq:RSCED.se.flow}, $\underline{\v{\gamma}}_k$, $\overline{\v{\gamma}}_k$, $\underline{\v{\rho}}_k$, and $\overline{\v{\rho}}_k$ with \eqref{eq:RSCED.se.bounds}, $\underline{\v{\eta}}$, $\overline{\v{\eta}}$, $\underline{\v{\sigma}}_k$, and $\overline{\v{\sigma}}_k$ with \eqref{eq:RSCED.se.bounds}, and $\underline{\nu}_k$ and $\overline{\nu}_k$ with \eqref{eq::RSCED.lp.epigraph}.

% \begin{subequations} %
% \begin{align}
%     & \underset{z, \v{y}, \v{g}, \v{r}, \v{\delta g}, \v{\delta d}}{\text{minimize}} && \v{c}^\top \v{g} + \v{c}_r^\top \v{r} + z + \frac{1}{1 - \alpha} \sum_{k = 1}^K p_k y_k, \\
%     &\text{subject to} && \bone^\top \left(\v{g} - \v{d}\right) = 0, \; \v{H} \left( \v{g} - \v{d} \right) \le \v{f},  \label{eq:RSCED2.nominal} &&: \lambda, \v{\mu} \\
%     &&& \underline{\v{g}} \le \v{g} \le \overline{\v{g}}, &&: \underline{\v{\gamma}}, \overline{\v{\gamma}} \\
%     &&& \v{H}_k \left( \v{g} - \v{d} \right) \le \v{f}_k^{\DA}, \label{eq:RSCED2.da} &&: \v{\mu}_k^\DA{} \\
%     &&& \bone^\top \left( \v{\delta g}_k + \v{\delta d}_k \right) = 0, \label{eq:RSCED2.se.balance} &&: \lambda_k \\
%     &&& \v{H}_k \left( \v{g} + \v{\delta g}_k - \v{d} + \v{\delta d}_k \right) \le \v{f}_k^{\SE}, \label{eq:RSCED2.se.flow} &&: \v{\mu}_k^\SE{} \\
%     &&& \underline{\v{g}} \le \v{g} + \v{\delta g}_k \le \overline{\v{g}}, &&: \underline{\v{\gamma}}_k, \overline{\v{\gamma}}_k \\
%     &&& -\v{r} \le \v{\delta g}_k \le \v{r}, &&: \underline{\v{\rho}}, \overline{\v{\rho}} \\
%     &&& 0 \le \v{\delta d}_k \le \overline{\v{\delta}}_d, \label{eq:RSCED2.se.bounds} &&: \underline{\v{\sigma}}_k, \overline{\v{\sigma}}_k \\
%     &&& y_k \ge 0, \; y_k \ge \voll^\top \v{\delta d}_k - z, &&: \underline{\nu}_k, \overline{\nu}_k \\
%     &&& k = 1, \dots K.
% \end{align}
% \end{subequations}
%


% The following is an expanded form of our original proposition in \addcite.
% \begin{proposition}
%     \RSCED{} can be formulated as a linear program, linearly parameterized in $\alpha$. Additionally, the optimal cost of \RSCED{} in \addcite is piecewise affine in $\alpha' := (1 - \alpha)^{-1}$ over any closed interval in $\mathbb{R}_+$, the optimizers, $\v{g}^*$, $\v{\delta g}^*$, $\v{\delta d}^*$, ..., remain constant over sub-intervals where the optimal cost is affine, as do the dual multipliers corresponding to all of the constraints.
% \end{proposition}

% The proof of Proposition \addcite is originally in \addcite, but has been included here for completeness.
% \begin{proof}
%     Leveraging the definition of \CVaR{} from Rockafellar and Uryasev \addcite, we can reformulate the objective as,
%     \begin{equation*}
%     \begin{aligned}
%     	&\CVaR{}_{\alpha} \left[ \v{c}^\top \v{g} + C(\v{\delta g}_k, \v{\delta d}_k) \right]
%     	\\
%     	&\;= \min_{z} z + \frac{1}{1 - \alpha}\E\left[ \v{c}^\top \v{g} + C(\v{\delta g}_k, \v{\delta d}_k) - z \right]^+
%     	\\
%     	&\;= \min_{z} z + \frac{1}{1 - \alpha}\sum_{k = 1}^K p_k \left[ \v{c}^\top \v{g} + C_k(\v{\delta g}_k, \v{\delta d}_k) - z \right]^+
%     \end{aligned}
%     \end{equation*}
%     Taking the epigraph form of \eqref{eq:RSCED}, we can then express it as
%     \begin{equation}
%     \begin{aligned}
%         & \underset{z, \v{y}, \v{g}, \v{\delta g}, \v{\delta d}}{\text{minimize}} && z + \frac{1}{1 - \alpha} \sum_{k = 0}^K p_k y_k, \\
%         & \text{subject to} && y_k \ge 0, \quad y_k \ge \v{c}^\top \v{g} + C_k(\v{\delta g}_k, \v{\delta d}_k) - z, \\
%         &&& \addcite - \addcite, \\
%         &&& \text{for each } k = 0, \dots K,
%     \end{aligned}
%     \end{equation}
%     where $\v{y} := \begin{pmatrix} y_0, \dots, y_K \end{pmatrix}^\top$ and we have used the subscript $0$ to represent the nominal case. More compactly, letting
%     \begin{equation*}
%         \v{x}_0 := \begin{pmatrix} z, y_0, \v{g}^\top \end{pmatrix}^\top, \quad \v{x}_k := \begin{pmatrix} y_k, [\v{\delta g}_k]^\top, [\v{\delta d}_k]^\top \end{pmatrix}^\top
%     \end{equation*}
%     we can rewrite \eqref{eq:RSCED} as
%     \begin{equation}
%     \begin{aligned}
%         & \underset{\v{x}_0, \v{x}_1, \dots, \v{x}_K}{\text{minimize}} && \v{c}_0^\top \v{x}_0 + \frac{1}{1 - \alpha} \sum_{k = 1}^K \v{c}_k^\top \v{x}_k, \\
%         & \text{subject to} && \v{A} \v{x}_0 \le \v{b}, \quad \v{A}_k \v{x}_0 + \v{E}_k \v{x}_k \le \v{b}_k, \\
%         &&& \text{for each } k = 1, \dots, K,
%     \end{aligned}
%     \label{eq:RSCED.decomposable}
%     \end{equation}
%     for some suitably defined, $\v{A}$, $\v{A}_k$, $\v{b}$, $\v{b}_k$, $\v{c}_0$, $\v{c}_k$, $
%     \v{E}_k$. This is a parametric linear program linear parameterized by $\frac{1}{1 - \alpha}$. The proof then follows from \addcite.
% \end{proof}
