%!TEX root = ./mainRSCED.tex

% \input{Revision_20250208/KKT}
\input{KKT}

% \vspace{-1in}
\subsection{Proof of Theorem \ref{thm:ms}}
\label{app:proof.thm.ms}
% \begin{proof} 
% \emph{(i)} See Section \ref{sec:simulation_results} for a numerical example demonstrating a case wherein $\MS[\pi^{\N}]<0$. In particular, in Figure \ref{fig:24bus.ms.uplift}, $\MS[\pi^{\N}]<0$ for values of $\alpha$ larger than 0.7.

% We begin by considering the merchandising surplus under the \LMPnom{} prices. Applying definition \eqref{eq:price.nominal} to \eqref{eq:MS_RSCED} gives 
% \begin{equation}
% \begin{aligned}
%   \MS{}[\v{\pi}^{\N}] &= [\lambda \v{\bone} - \v{H}^\top \v{\mu}]^\top (\v{d} - \v{g}) - \sum_{k = 1}^K [\overline{\v{\rho}}_k^\top \overline{\v{r}} + \underline{\v{\rho}}_k^\top \underline{\v{r}} ] \\
%   % &\overset{(\text{4b})}{=} - [\v{H}^\top \v{\mu}]^\top (\v{d} - \v{g}) - \sum_{k = 1}^K [\overline{\v{\rho}}_k^\top \overline{\v{r}} + \underline{\v{\rho}}_k^\top \underline{\v{r}} ] \\
%   % &\overset{(\text{31a})}{=} \v{\mu}^{\top}\v{f} - \sum_{k = 1}^K [\overline{\v{\rho}}_k^\top \overline{\v{r}} + \underline{\v{\rho}}_k^\top \underline{\v{r}} ] \\
%   % &\overset{(\text{30a})}{=} 
%   % &=\v{\mu}^{\top}\v{f} - ((\ul{\v{c}}_r-\ul{\v{\eta}})^{\top}\ul{\v{r}} + (\ol{\v{c}}_r-\ol{\v{\eta}})^{\top}\ol{\v{r}})\\
% 	% &\overset{(\text{31d})}{=} 
%  &=\v{\mu}^\top \v{f} - \underline{\v{c}}_r^\top \underline{\v{r}} - \overline{\v{c}}_r^\top \overline{\v{r}},
% \end{aligned}
% \end{equation}
% where we make use of \eqref{eq:RSCED.nominal}, \eqref{eq:rsced.kkt.stat.gr}, \eqref{eq:rsced.kkt.cs.g}, \eqref{eq:rsced.kkt.cs.rdcvar}. Note $\v{\mu}^\top \v{f} \ge 0$ and $\underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} \ge 0$. Thus, $\MS{}[\v{\pi}^{\N}] < 0$ if $\underline{\v{c}}_r^\top \underline{\v{r}} + \overline{\v{c}}_r^\top \overline{\v{r}} > \v{\mu}^\top \v{f}$ may be attainable, and result (i) holds. 

% \emph{(ii)} Next, we consider the merchandising surplus under the \LMPmar{} prices. 
Applying definition \eqref{eq:price.marginal} to \eqref{eq:MS_RSCED}, we have
% \begin{equation*}
{\small
\begin{flalign*}
  &\MS{}[\v{\pi}^{\S}] = \left[\lambda^{\star} \bone^\top - \v{\mu}^{\star\top} \v{H} - \sum_{k = 1}^K (\v{\mu}_k^{\DA{}\star} + \v{\mu}_k^{\SE{}\star})^\top \v{H}_k\right] (\v{d} - \v{g}^{\star}) \\
    &\quad - \sum_{k = 1}^K [\underline{\v{\rho}}_k^{\star\top} \underline{\v{r}}^{\star} + \overline{\v{\rho}}_k^{\star\top }\overline{\v{r}}^{\star}] 
  \end{flalign*}
  }
 {\small
\begin{flalign*} 
	&=\v{\mu}^{\star\top} \v{f} + \sum_{k = 1}^K (\v{\mu}_k^{\DA{}\star} + \v{\mu}_k^{\SE{}\star})^\top \v{H}_k (\v{g}^{\star} - \v{d}) 
 % &\quad
 + [\underline{\v{\rho}}^{\star}_k - \overline{\v{\rho}}^{\star}_k]^\top \v{\delta g}^{\star}_k \\
% 	&= \v{\mu}^\top \v{f} + \sum_{k = 1}^K [\v{\mu}_k^\DA{}]^\top \v{f}_k^\DA{} + [\v{\mu}_k^\SE{}]^\top \v{H}_k (\v{g} - \v{d}) + [\underline{\v{\rho}}_k - \overline{\v{\rho}}_k]^\top \v{\delta g}_k \\
	&= \v{\mu}^{\star\top} \v{f} + \sum_{k = 1}^K [\v{\mu}_k^{\DA{}\star}]^\top \v{f}_k^{\DA{}} + [\v{\mu}_k^{\SE{}\star}]^\top \v{f}_k^{\SE{}} \\
	&\quad + \sum_{k = 1}^K - [\v{\mu}_k^{\SE{}\star}]^\top \v{H}_k (\v{\delta g}^{\star}_k + \v{\delta d}^{\star}_k) + [\underline{\v{\rho}}^{\star}_k - \overline{\v{\rho}}^{\star}_k]^\top \v{\delta g}^{\star}_k,
\end{flalign*}
}
% \end{equation*}
where we use \eqref{eq:RSCED.nominal}, \eqref{eq:rsced.kkt.cs.g}, \eqref{eq:rsced.kkt.cs.flow}, \eqref{eq:rsced.kkt.cs.dg}. By the dual feasibility condition, and positivity of $\v{f}, \v{f}_k^\DA{}$, $\v{f}_k^\SE{}$, we have
{\small \begin{equation*}
    \MS{}[\v{\pi}^{\S}] \ge \sum_{k = 1}^K - [\v{\mu}_k^{\SE{}\star}]^\top \v{H}_k (\v{\delta g}^{\star}_k + \v{\delta d}^{\star}_k) + [\underline{\v{\rho}}^{\star}_k - \overline{\v{\rho}}^{\star}_k]^\top \v{\delta g}^{\star}_k.
    \label{eq:ms.bound.1}
\end{equation*}} 
Applying \eqref{eq:rsced.kkt.stat.d} and \eqref{eq:RSCED.se.balance}, this yields
{\small \begin{equation*}
\begin{aligned}
  &\MS{}[\v{\pi}^{\S}] \ge \sum_{k = 1}^K -\lambda^{\star}_k \bone^\top \v{\delta g}^{\star}_k - \lambda^{\star}_k \bone^\top \v{\delta d}^{\star}_k + (\overline{\v{\gamma}}^{\star}_k - \underline{\v{\gamma}}^{\star}_k)^\top \v{\delta g}^{\star}_k 
  \end{aligned}
  \end{equation*}}
\begin{equation*}
\begin{aligned}
  &\quad + \sum_{k = 1}^K (\overline{\v{\sigma}}^{\star}_k - \underline{\v{\sigma}}^{\star}_k)^\top \v{\delta d}^{\star}_k + \overline{\nu}^{\star}_k \voll^\top \v{\delta d}^{\star}_k \\
  &= \sum_{k = 1}^K (\overline{\v{\gamma}}^{\star}_k - \underline{\v{\gamma}}^{\star}_k)^\top \v{\delta g}^{\star}_k + (\overline{\v{\sigma}}^{\star}_k - \underline{\v{\sigma}}^{\star}_k)^\top \v{\delta d}^{\star}_k + \overline{\nu}^{\star}_k \voll^\top \v{\delta d}^{\star}_k.
  \label{eq:ms.bound.2}
\end{aligned}
\end{equation*}
Using \eqref{eq:rsced.kkt.cs.dg} and \eqref{eq:rsced.kkt.cs.rdcvar}, we have
{\small \begin{equation}
\begin{aligned}
  &\MS{}[\v{\pi}^{\S}] \ge \sum_{k = 1}^K \overline{\v{\gamma}}_k^{\star\top} [ \overline{\v{g}} - \v{g}^{\star} ] + \underline{\v{\gamma}}_k^{\star\top} [ \v{g}^{\star} - \underline{\v{g}} ] + \overline{\v{\sigma}}^{\star}_k \v{\Delta}_d + \overline{\nu}^{\star}_k \voll^\top \v{\delta d}^{\star}_k.
  \label{eq:ms.bound.3}
\end{aligned}
\end{equation}}
The rest follows from the primal feasibility condition in \eqref{eq:RSCED.nominal}, the dual feasibility conditions and positivity of $\v{\Delta}_d, \voll, \v{\delta d}_k$.
% , we have
% \begin{equation}
% \begin{aligned}
%   \MS{}[\v{\pi}^{\S}] &\ge 0.
% \end{aligned}
% \end{equation}
% \end{proof}

% \subsection{Proof of Lemma \ref{lem:loc}}
% \begin{proof}
%   We begin by noting that under some price $\v{\pi}$, \eqref{eq:ind.rat} admits the solution,
%   \begin{equation}
%       \hat{g}_i^\star := \begin{cases}
%         \overline{g}_i & \pi_i > c_i, \\
%         \underline{g}_i & \pi_i < c_i, \\
%         \text{any } \hat{g}_i \in [\overline{g}_i, \underline{g}_i] & \pi_i = c_i,
%       \end{cases}
%   \end{equation}
%   with total maximum revenue of $(\pi_i - c_i) \hat{g}_i^\star$. The lost revenue is the difference between the total maximum and realized revenues, or
%   \begin{equation}
%   \begin{aligned}
%       \LOC_i[\v{\pi}] &= (\pi_i - c_i) (\hat{g}_i^\star - g_i^\star) \\
%       &= \begin{cases}
%         (\pi_i - c_i) (\overline{g}_i - g_i^\star) & \pi_i \ge c_i, \\
%         (\pi_i - c_i) (\underline{g}_i - g_i^\star) & \pi_i < c_i,
%       \end{cases} \\
%       &= \max\{ (\pi_i - c_i) (\overline{g}_i - g_i^\star), (\pi_i - c_i) (\underline{g}_i - g_i^\star) \},
%   \end{aligned}
%   \end{equation}
%   where the last line follows from the observation that only a single case can be positive.
% \end{proof}

\iffalse
\subsection{Proof of Proposition \ref{prop:loc}}
\label{app:proof.prop.loc}
\begin{proof}
  We begin by noting that under some price $\v{\pi}$, \eqref{eq:ind.rat} admits the solution,
  \begin{equation}
      \hat{g}_i^\star := \begin{cases}
        \overline{g}_i & \pi_i > c_i, \\
        \underline{g}_i & \pi_i < c_i, \\
        \text{any } \hat{g}_i \in [\overline{g}_i, \underline{g}_i] & \pi_i = c_i,
      \end{cases}
  \end{equation}
  with total maximum profit of $(\pi_i - c_i) \hat{g}_i^\star$. The lost revenue is the difference between the total maximum and realized revenues, or
  \begin{equation}
  \begin{aligned}
      \LOC_i[\v{\pi}] &= (\pi_i - c_i) (\hat{g}_i^\star - g_i^\star) \\
      &= \begin{cases}
        (\pi_i - c_i) (\overline{g}_i - g_i^\star) & \pi_i \ge c_i, \\
        (\pi_i - c_i) (\underline{g}_i - g_i^\star) & \pi_i < c_i,
      \end{cases} \\
      &= \begin{cases}
        | \pi_i - c_i | \sign(\pi_i - c_i) (\overline{g}_i - g_i^\star) & \pi_i \ge c_i, \\
        | \pi_i - c_i | \sign(\pi_i - c_i) (\underline{g}_i - g_i^\star) & \pi_i < c_i,
      \end{cases} \\
      &= | \pi_i - c_i | \max\left\{ \begin{aligned} &\sign(\pi_i - c_i) (\overline{g}_i - g_i^\star), \\ &\sign(\pi_i - c_i) (\underline{g}_i - g_i^\star) \end{aligned} \right\},
    %   &= \max\{ (\pi_i - c_i) (\overline{g}_i - g_i^\star), (\pi_i - c_i) (\underline{g}_i - g_i^\star) \},
    \label{eq:loc.ind}
  \end{aligned}
  \end{equation}
  where the last line follows from the observation that only a single case can be positive.
  The result then follows by replacing $\pi_i$ with the corresponding price and using \eqref{eq:rsced.kkt.stat.gr}.
\end{proof}
\hfil
\fi



\subsection{Proof of Theorem \ref{thm:revenue}}
\label{app:proof.thm.revenue}
% \begin{proof}
% \rev{USE SMALL FONT HERE AND FOR ALL OF APPENDIX EQUATIONS}
For notational convenience, we drop the superscript in $\v{\pi}^{\S}$. From \eqref{eq:LOC_i}, we have
{\small \begin{equation}
\begin{aligned}
  \LOC_i[\v{\pi}] = \max\{
  % & 
  (\pi_i - c_i) (\overline{g}_i - g_i^\star), 
  % \\
  % & 
  (\pi_i - c_i) (\underline{g}_i - g_i^\star) \}.
\end{aligned}
\end{equation}}
For scalars $a, b$, notice that $\max\{a, b\} = \frac{1}{2}\left({a + b + | a - b |}\right)$, and hence,
% can be written as
% \begin{equation}
    % \max\{a, b\} = \frac{a + b + | a - b |}{2}
% \end{equation}
% to write $\LOC_i[\v{\pi}]$ as,
{\small \begin{equation}
\begin{aligned}
  2\LOC_i[\v{\pi}] 
  % &= {(\pi_i - c_i) (\overline{g}_i + \underline{g}_i - 2 g_i^\star) + | (\pi_i - c_i) (\overline{g}_i - \underline{g}_i) |}
  % {2} 
  % \\
  &= {(\pi_i - c_i) (\overline{g}_i + \underline{g}_i - 2 g_i^\star) + | \pi_i - c_i | (\overline{g}_i - \underline{g}_i)},
  \label{eq:revenue.loc}
\end{aligned}
\end{equation}}
where we make use of the fact that $\overline{g}_i \ge \underline{g}_i$. 
Notice that all terms depend on $\pi_i - c_i$. 
From \eqref{eq:rsced.kkt.stat.gr}, we infer
{\small 
\begin{equation}
    \pi_i - c_i = \overline{\gamma}^{\star}_i - \underline{\gamma}^{\star}_i + \sum_{k = 1}^K \left( \overline{\gamma}^{\star}_{k,i} - \underline{\gamma}^{\star}_{k,i} \right),
    \label{eq:revenue.diff}
\end{equation}}
that together with triangle inequality implies
{\small \begin{equation}
    | \pi_i - c_i | \le \overline{\gamma}^{\star}_i + \underline{\gamma}^{\star}_i + \sum_{k = 1}^K \left( \overline{\gamma}_{k,i} + \underline{\gamma}_{k,i} \right).
    \label{eq:revenue.absdiff}
\end{equation}}
Using \eqref{eq:revenue.diff} and \eqref{eq:revenue.absdiff} in \eqref{eq:revenue.loc} yields,
{\small \begin{equation*}
\begin{aligned}
   &2 \LOC_i[\v{\pi}] \le (\overline{\gamma}_i - \underline{\gamma}_i + \sum_{k = 1}^K \overline{\gamma}_{k,i} - \underline{\gamma}_{k,i})(\overline{g}_i + \underline{g}_i - 2 g_i^\star) \\
   &\qquad\qquad\quad + (\overline{\gamma}_i + \underline{\gamma}_i + \sum_{k = 1}^K \overline{\gamma}_{k,i} + \underline{\gamma}_{k,i})(\overline{g}_i - \underline{g}_i) \\
   &= 2 (\overline{\gamma}_i + \sum_{k = 1}^K \overline{\gamma}_{k,i}) (\overline{g}_i - g_i^\star) - 2 (\underline{\gamma}_i + \sum_{k = 1}^K \underline{\gamma}_{k,i})(\underline{g}_i - g_i^\star).
\end{aligned}
\end{equation*}}
Using \eqref{eq:rsced.kkt.cs.g}, we then have
{\small \begin{equation}\nonumber 
\begin{aligned}
  \LOC_i[\v{\pi}] &\le \left( \sum_{k = 1}^K \overline{\gamma}_{k,i} \right) (\overline{g}_i - g_i^\star) + \left( \sum_{k = 1}^K \underline{\gamma}_{k,i} \right)(g_i^\star - \underline{g}_i).
\end{aligned}
\end{equation}}
Taking the sum over all payments, we have
{\small \begin{equation}\nonumber 
\begin{aligned}
    \bone^\top \LOC[\v{\pi}] &\le \sum_{k = 1}^K \overline{\v{\gamma}}_k^\top (\overline{\v{g}} - \v{g}^\star) + \underline{\v{\gamma}}_k^\top (\v{g}^\star - \underline{\v{g}}),
\end{aligned}
\end{equation}}
where we have used positivity of each of the components to render the sum as a dot product. Then, applying the bound on \MS{} in \eqref{eq:ms.bound.3}, we have
{\small \begin{equation}\nonumber
\begin{aligned}
  \MS[\v{\pi}] - \bone^\top \LOC{}[\v{\pi}] \ge \sum_{k = 1}^K \overline{\v{\sigma}}_k \v{\Delta}_d + \overline{\nu}_k \voll^\top \v{\delta d}_k.
\end{aligned}
\end{equation}}
The result follows from the dual feasibility conditions and positivity of $\v{\Delta}_d, \voll, \v{\delta d}_k$.
% \end{proof}




% \subsection{Proof of Theorem \ref{thm:loc}}
% \begin{lemma}
%   \label{lem:loc.def}
%   The \LOC{} payment to the generator at bus $i$ under price, $\v{\pi}$, is given by
%   \begin{equation}
%   \begin{aligned}
%     \LOC{}_i[\v{\pi}] &= \max\{ (\pi_i - c_i) (\overline{g}_i - g_i^\star), (\pi_i - c_i) (\underline{g}_i - g_i^\star) \\
%     &= \frac{(\pi_i - c_i) (\overline{g}_i + \underline{g}_i - 2 g_i^\star) + | \pi_i - c_i | (\overline{g}_i - \underline{g}_i)}{2}.
%   \end{aligned}
%   \end{equation}
% \end{lemma}
% \begin{proof}
%   We begin by noting that under some price $\v{\pi}$, \eqref{eq:ind.rat} admits the solution,
%   \begin{equation}
%       \hat{g}_i^\star := \begin{cases}
%         \overline{g}_i & \pi_i > c_i, \\
%         \underline{g}_i & \pi_i < c_i, \\
%         \text{any } \hat{g}_i \in [\overline{g}_i, \underline{g}_i] & \pi_i = c_i,
%       \end{cases}
%   \end{equation}
%   with total maximum revenue of $(\pi_i - c_i) \hat{g}_i^\star$. The lost revenue is the difference between the total maximum and realized revenues, or
%   \begin{equation}
%   \begin{aligned}
%       \LOC_i[\v{\pi}] &= (\pi_i - c_i) (\hat{g}_i^\star - g_i^\star) \\
%       &= \begin{cases}
%         (\pi_i - c_i) (\overline{g}_i - g_i^\star) & \pi_i \ge c_i, \\
%         (\pi_i - c_i) (\underline{g}_i - g_i^\star) & \pi_i < c_i,
%       \end{cases} \\
%       &= \max\{ (\pi_i - c_i) (\overline{g}_i - g_i^\star), (\pi_i - c_i) (\underline{g}_i - g_i^\star) \},
%   \end{aligned}
%   \end{equation}
%   where the last line follows from the observation that only a single case can be positive. We now make use of the fact that for some $a, b$, $\max\{a,b\}$ can be written as
%   \begin{equation}
%     \max\{a, b\} = \frac{a + b + | a - b |}{2}
%   \end{equation}
%   to prove the result, and noting that $\overline{g}_i \ge \underline{g}_i$.
% \end{proof}

% We now consider the proof of Theorem \ref{thm:loc}.
% \begin{proof}
%   We wish to show that $\LOC{}_i[\v{\pi}_n] - \LOC{}_i[\v{\pi}_s] \ge 0$. For notational convenience, we suppress the dependence on $i$ in the sequel. From Lemma \ref{lem:loc.def}, we have
%   \begin{equation}
%   \begin{aligned}
%     & \LOC{}[\v{\pi}_n] - \LOC{}[\v{\pi}_s] \\
%     &\quad = \frac{(\pi_n - c) (\overline{g} + \underline{g} - 2 g^\star) + | \pi_n - c | (\overline{g} - \underline{g})}{2} \\
%     &\qquad - \frac{(\pi_m - c) (\overline{g} + \underline{g} - 2 g^\star) + | \pi_m - c | (\overline{g} - \underline{g})}{2} \\
%     &\quad = \frac{(\pi_n - \pi_m) (\overline{g} + \underline{g} - 2 g^\star) }{2} + \frac{| \pi_n - c | - | \pi_m - c |}{2} (\overline{g} - \underline{g}) \\
%     &\quad \ge \frac{(\pi_n - \pi_m) (\overline{g} + \underline{g} - 2 g^\star) }{2} - \frac{| \pi_n - \pi_m |}{2} (\overline{g} - \underline{g}).
%   \end{aligned}
%   \end{equation}
%   Now consider the case $\pi_n \ge \pi_m$, then we have
%   \begin{equation}
%   \begin{aligned}
%     & \LOC{}[\v{\pi}_n] - \LOC{}[\v{\pi}_s] \\
%     & \quad \ge \frac{(\pi_n - \pi_m) (\overline{g} + \underline{g} - 2 g^\star) }{2} - \frac{\pi_n - \pi_m}{2} (\overline{g} - \underline{g}) \\
%     &\quad \ge \frac{(\pi_n - \pi_m) (2 \underline{g} - 2 g^\star)}{2}
%   \end{aligned}
%   \end{equation}
% \end{proof}

% In order to proof the Lemmas, we will be making use of the KKT conditions for \eqref{eq:RSCED.lp}. Specifically, we have the gradient conditions
% %
% \begin{subequations}
% \begin{align}
%     \begin{aligned} & \v{c} - \lambda \bone + \v{H}^\top \v{\mu} - \underline{\v{\gamma}} + \overline{\v{\gamma}} && \\ &\quad + \sum_{k = 1}^K \v{H}_k^\top (\v{\mu}_k^\DA{} + \v{\mu}_k^\SE{}) - \underline{\v{\gamma}}_k + \overline{\v{\gamma}}_k &&= 0, \end{aligned}  \label{eq:grad.g} \\
%     \v{c}_r - \sum_{k = 1}^K \underline{\v{\rho}}_k  = 0, \label{eq:grad.r.neg} \\
%     \v{c}_r - \sum_{k = 1}^K \overline{\v{\rho}}_k = 0, \label{eq:grad.r.pos} \\
%     -\lambda_k \bone + \v{H}_k^\top \v{\mu}_k^\SE{} - \underline{\v{\gamma}}_k + \overline{\v{\gamma}}_k + \sum_{k = 1}^K \overline{\v{\rho}}_k - \underline{\v{\rho}}_k = 0, \label{eq:grad.dg} \\
%     -\lambda_k \bone + \v{H}_k^\top \v{\mu}_k^\SE{} - \underline{\v{\sigma}}_k + \overline{\v{\sigma}}_k + \overline{\nu}_k \voll = 0. \label{eq:grad.dd}
% \end{align}
% \end{subequations}
% We will also make use of the complimentary slackness conditions.

% \subsection{Proof of Lemma \ref{lem:ms.nominal}} %
% Under nominal pricing, the merchandising surplus is
% \begin{equation*}
% \begin{aligned}
%   \MS{} &= [\lambda \v{\bone} - \v{H}^\top \v{\mu}]^\top (\v{d} - \v{g}) - \sum_{k = 1}^K [\overline{\v{\rho}}_k^\top \overline{\v{r}} + \underline{\v{\rho}}_k^\top \underline{\v{r}} ] \\
% 	&= \v{\mu}^\top \v{f} - \v{c}_r^\top \underline{\v{r}} - \v{c}_r^\top \overline{\v{r}},
% \end{aligned}
% \end{equation*}
% where we have used the complimentary slackness conditions on \eqref{eq:RSCED.nominal}, \eqref{eq:grad.r.neg}, and \eqref{eq:grad.r.pos}. \qedsymbol{}

% \subsection{Proof of Lemma \ref{lem:ms.marginal}}
% With marginal pricing, the merchandising surplus is
% \begin{equation*}
% \begin{aligned}
%   \MS{} &= \left[\lambda \bone^\top - \v{\mu}^\top \v{H} - \sum_{k = 1}^K (\v{\mu}_k^\DA{} + \v{\mu}_k^\SE{})^\top \v{H}_k\right] (\v{d} - \v{g}) \\
%   &\qquad - \sum_{k = 1}^K [\underline{\v{\rho}}_k^\top \underline{\v{r}} + \overline{\v{\rho}}_k^\top \overline{\v{r}}] \\
% 	&= \v{\mu}^\top \v{f} + \sum_{k = 1}^K (\v{\mu}_k^\DA{} + \v{\mu}_k^\SE{})^\top \v{H}_k (\v{g} - \v{d}) + [\underline{\v{\rho}}_k - \overline{\v{\rho}}_k]^\top \v{\delta g}_k \\
% % 	&= \v{\mu}^\top \v{f} + \sum_{k = 1}^K [\v{\mu}_k^\DA{}]^\top \v{f}_k^\DA{} + [\v{\mu}_k^\SE{}]^\top \v{H}_k (\v{g} - \v{d}) + [\underline{\v{\rho}}_k - \overline{\v{\rho}}_k]^\top \v{\delta g}_k \\
% 	&= \v{\mu}^\top \v{f} + \sum_{k = 1}^K [\v{\mu}_k^\DA{}]^\top \v{f}_k^\DA{} + [\v{\mu}_k^\SE{}]^\top \v{f}_k^\SE{} \\
% 	&\qquad + \sum_{k = 1}^K - [\v{\mu}_k^\SE{}]^\top \v{H}_k (\v{\delta g}_k + \v{\delta d}_k) + [\underline{\v{\rho}}_k - \overline{\v{\rho}}_k]^\top \v{\delta g}_k,
% \end{aligned}
% \end{equation*}
% where we have used complimentary slackness conditions on \eqref{eq:RSCED.nominal}, \eqref{eq:RSCED.da}, \eqref{eq:RSCED.se.flow}, and \eqref{eq:RSCED.se.bounds}. From positivity of $\v{\mu}$, $\v{\mu}_k^\DA{}$, $\v{\mu}_k^\SE{}$, $\v{f}$, $\v{f}_k^\DA{}$, and $\v{f}_k^\SE{}$, we have
% \begin{equation*}
%     \MS{} \ge \sum_{k = 1}^K - [\v{\mu}_k^\SE{}]^\top \v{H}_k (\v{\delta g}_k + \v{\delta d}_k) + [\underline{\v{\rho}}_k - \overline{\v{\rho}}_k]^\top \v{\delta g}_k.
% \end{equation*}
% Applying \eqref{eq:grad.dg} and \eqref{eq:grad.dd}, we have
% %
% \begin{equation*}
% \begin{aligned}
%   \MS{} &\ge \sum_{k = 1}^K -\lambda_k \bone^\top \v{\delta g}_k - \lambda_k \bone^\top \v{\delta d}_k + (\overline{\v{\gamma}}_k - \underline{\v{\gamma}}_k)^\top \v{\delta g}_k \\
%   &\quad + \sum_{k = 1}^K (\overline{\v{\sigma}}_k - \underline{\v{\sigma}}_k)^\top \v{\delta d}_k + \overline{\nu}_k \voll^\top \v{\delta d}_k \\
%   &= \sum_{k = 1}^K (\overline{\v{\gamma}}_k - \underline{\v{\gamma}}_k)^\top \v{\delta g}_k + (\overline{\v{\sigma}}_k - \underline{\v{\sigma}}_k)^\top \v{\delta d}_k + \overline{\nu}_k \voll^\top \v{\delta d}_k
% \end{aligned}
% \end{equation*}
% %
% where we use the complimentary slackness condition for \eqref{eq:RSCED.se.balance}. Further, the complimentary slackness condition of the load shed constraint in \eqref{eq:RSCED.se.bounds}, combined with positivity of $\overline{\nu}_k$, $\voll$, and $\v{\delta d}_k$, $\overline{\v{\sigma}}_k$, and $\v{\delta d}_k$ imply that $(\overline{\v{\sigma}}_k - \underline{\v{\sigma}}_k)^\top \v{\delta d}_k + \overline{\nu}_k \voll^\top \v{\delta d}_k \ge 0$. Complimentary slackness of the generation capacity constraint in \eqref{eq:RSCED.se.bounds} implies that $\overline{\v{\gamma}}_k^\top \v{\delta g}_k = \overline{\v{\gamma}}_k^\top (\overline{\v{g}} - \v{g}) \ge 0$. This follows from $\overline{\v{g}} \ge \v{g}$ and $\overline{\v{\gamma}}_k \ge 0$. Similarly, $-\underline{\v{\gamma}}_k^\top \v{\delta g}_k = \underline{\v{\gamma}}^\top (\v{g} -\underline{\v{g}}) \ge 0$ from $\v{g} \ge \underline{\v{g}}$ and $\underline{\v{\gamma}} \ge 0$. Together this implies
% %
% \begin{equation*}
%     \MS{} \ge 0. \eqno\qed
% \end{equation*}
% %

% \subsection{Proof of Lemma \ref{lem:up.nominal}}
% Applying the definition $\v{\pi}$ and using \eqref{eq:grad.g}, we have
% \begin{equation*}
% \begin{aligned}
%   \v{\pi} - \v{c} &= \lambda \bone - \v{H}^\top \v{\mu} - \v{c} \\
%   &= \overline{\v{\gamma}} - \underline{\v{\gamma}} + \sum_{k = 1}^K \v{H}_k^\top (\v{\mu}_k^\DA{} + \v{\mu}_k^\SE{}) + \overline{\v{\gamma}}_k - \underline{\v{\gamma}}_k. \hfill \qedsymbol
% \end{aligned}
% \end{equation*}

% \subsection{Proof of Lemma \ref{lem:up.marginal}}
% From the definition of $\v{\pi}$ for marginal prices, we have
% \begin{equation*}
% \begin{aligned}
%   \v{\pi} - \v{c} &= \lambda \bone - \v{H}^\top \v{\mu} - \sum_{k = 1}^K \v{H}_k^\top (\v{\mu}_k^\DA{} + \v{\mu}_k^\SE{}) - \v{c} \\
%   &= \overline{\v{\gamma}} - \underline{\v{\gamma}} + \sum_{k = 1}^K \overline{\v{\gamma}}_k - \underline{\v{\gamma}}_k,
% \end{aligned}
% \end{equation*}
% where we have again used \eqref{eq:grad.g}. \hfill \qedsymbol