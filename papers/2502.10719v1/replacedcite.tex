\section{Related Work}
\paragraph{Microarchitecture reverse engineering}
The conditional and indirect branch predictors on Intel and AMD x86 CPUs have been extensively reverse engineered for microarchitectural attack research____, software defense against branch-based side-channel attacks____, and better microarchitectural understanding____.
Apple's M-Series CPUs have received significantly less attention.
Researchers have reversed engineered some details of the M1's microarchitectures____ and well as its memory-dependent prefetcher____, but to our knowledge, the structure of the M1's BPU has not been explored.
Our reverse engineering methodology is similar to that of prior work on Intel BPUs____, but adapted to the unique aspects of the M1, such as unavailability of Hyper-Threading for executing the two experimental paths.



\paragraph{Spectre attacks on Apple's M-Series CPUs}
Hetterich and Schwarz____ and Leaky.page____ demonstrated the feasibility of Spectre v1 attacks
on the M-Series CPUs.
PACMAN used a Spectre v1-like attack to leak kernel pointer authentication code (PAC____) verification results to userspace____.
Spook.js____ and iLeakage____ mounted in-browser Spectre v1 attacks.
These attacks all employ \emph{in-place} mistraining____ (i.e., training the victim branch by invoking it), whereas our work enables out-of-place mistraining.

\paragraph{Mitigations}
Out-of-place mistraining of the indirect branch predictor has been mitigated in hardware by introducing BPU flushing mechanisms____ or by isolating entries of different security domains____.
To our knowledge, no such mechanisms are available for the conditional branch predictor.
Half\&Half____ is a software-only approach for partitioning the conditional branch predictor into isolated halves (e.g., user-level and OS kernel), but it is applicable only to Intel CPUs.