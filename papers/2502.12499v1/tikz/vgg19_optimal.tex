\begin{figure}[h!tb]
\centering

\begin{tikzpicture}

\definecolor{darkgray176}{RGB}{176,176,176}
\definecolor{green}{RGB}{0,128,0}
\definecolor{lightgray204}{RGB}{204,204,204}

\begin{axis}[
legend cell align={left},
legend style={fill opacity=0.8, draw opacity=1, text opacity=1, draw=lightgray204},
tick align=outside,
tick pos=left,
% title={VGG-19: Prediction vs Allocation},
x grid style={darkgray176},
xlabel={Training Phase Index},
xmajorgrids,
xmin=0, xmax=49,
xtick style={color=black},
xticklabel style={rotate=340.0},
y grid style={darkgray176},
ytick={1,2,3,4,5,6,7,8,9,10,11,12},
xtick={3,6,24,46,43,25},
xticklabel style={rotate=340.0, font=\tiny},
ylabel={GPU Memory Usage (GiB)},
ymajorgrids,,
ymin=0, ymax=12,
ytick style={color=black}
]
\addplot [semithick, red]
table {%
0 6.6737174987793
49 6.6737174987793
};
\addlegendentry{Peak Mem.}
\addplot [thick, green]
table {%
0 1.69826412200928
1 3.22951412200928
2 4.76076412200928
3 5.90920162200928
4 6.67482662200928
5 7.44045162200928
6 8.01467037200928
7 8.39748287200928
8 8.78029537200928
9 9.16310787200928
10 9.54592037200928
11 9.83339595794678
12 10.0248022079468
13 10.2162084579468
14 10.4076147079468
15 10.5990209579468
16 10.7425756454468
17 10.7904272079468
18 10.8382787704468
19 10.8861303329468
20 10.9339818954468
21 10.9698705673218
22 10.9718236923218
23 10.9737768173218
24 10.97425365448
25 10.9766845703125
26 10.9762077331543
27 10.9723014831543
28 10.9942741394043
29 10.9823112487793
30 10.9344596862793
31 10.8866081237793
32 10.7909049987793
33 10.8387565612793
34 10.7909049987793
35 10.5994987487793
36 10.4080924987793
37 10.0249137878418
38 10.0249137878418
39 9.9292106628418
40 9.5463981628418
41 9.1635856628418
42 8.3979606628418
43 8.3979606628418
44 8.2065544128418
45 6.6753044128418
46 6.6753044128418
47 6.2924919128418
48 3.2299919128418
49 1.69874143600464
};
\addlegendentry{Plain}
\addplot [thick, blue]
table {%
0 1.69667720794678
1 3.22792720794678
2 4.75917720794678
3 3.61073970794678
4 2.84511470794678
5 3.61073970794678
6 3.03652095794678
7 2.65370845794678
8 3.03652095794678
9 3.03652095794678
10 3.03652095794678
11 2.74941158294678
12 2.55800533294678
13 2.65370845794678
14 2.65370845794678
15 2.65370845794678
16 2.51015377044678
17 2.36659908294678
18 2.36659908294678
19 2.36659908294678
20 2.36659908294678
21 2.33071041107178
22 2.28481197357178
23 2.27480220794678
24 2.27332592010498
25 2.2738037109375
26 5.2327995300293
27 5.2281608581543
28 5.2501335144043
29 5.2381706237793
30 5.1903190612793
31 5.1424674987793
32 5.0467643737793
33 5.0946159362793
34 5.0467643737793
35 4.8553581237793
36 4.6639518737793
37 4.2811393737793
38 4.2811393737793
39 4.1854362487793
40 3.8026237487793
41 3.4198112487793
42 2.6541862487793
43 4.5682487487793
44 4.3768424987793
45 2.8455924987793
46 6.6737174987793
47 6.2909049987793
48 3.2284049987793
49 1.69715452194214
};
\addlegendentry{Allocation}
\addplot[scatter, only marks] table[x=x, y=y] {
x y class
3 3.6107397079467773
6 3.0365209579467773
24 2.2733259201049805
46 6.673717498779297
43 4.568248748779297
25 2.2738037109375
};
\end{axis}

\end{tikzpicture}


    \caption{GPU Memory Usage of Each Training Phase on VGG-19 with Checkpoints \{3, 6, 24\}.} 
    \label{fig:GMU_VGG19_Ckpt_Optimal}
\end{figure}