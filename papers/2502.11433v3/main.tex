% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{graphicx}
% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2025} with \usepackage[nohyperref]{icml2025} above.
\usepackage{hyperref}


% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
\usepackage[preprint]{acl}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}



\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx} % Required for including images
\usepackage{luatex85}
\pdfimageresolution=300
\usepackage{threeparttable}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{subcaption}

\usepackage{inconsolata}
\usepackage{algorithm}
\usepackage{algorithmic}
%\usepackage{tcolorbox} % Load tcolorbox with options
\usepackage{xcolor}
\usepackage{tcolorbox}
% \usepackage{colortbl} % Required for cell coloring
\tcbuselibrary{raster} % Load the raster library for tcolorbox
\definecolor{darkblue}{rgb}{0.04, 0.1, 0.35}
\definecolor{lightblue}{rgb}{0.2, 0.6, 0.9}
\definecolor{lightred}{rgb}{0.9, 0.4, 0.4}
\definecolor{lightyellow}{rgb}{0.8, 0.8, 0.35}
\definecolor{lightpurple}{rgb}{0.6, 0.5, 0.7}
\definecolor{lightorange}{rgb}{1.0, 0.5, 0.0}
\definecolor{lightgrey}{rgb}{0.5, 0.5, 0.5}
\usepackage{booktabs} % For professional looking tables
\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother
% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}


\newcommand{\bE}{\mathbb{E}}
\newcommand{\bP}{\mathbb{P}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\act}{$\mathcal{A}\mathcal{C}\mathcal{T}$}
\newcommand{\eps}{\epsilon}
\newcommand{\ub}{^{(b)}}
\newcommand{\tr}{_{tr.}}
\newcommand{\up}{^{\prime}}
\newcommand{\te}{\theta}
\newcommand{\id}{\mathbbm{1}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\hp}{\mathcal{H}\mathcal{P}}
\newcommand{\lp}{\mathcal{L}\mathcal{P}}
\newcommand{\bT}{\mathbb{T}}
\newcommand{\bZ}{\mathbb{Z}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\ust}{^{\star}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\bN}{\mathbb{N}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\og}{\omega}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\ep}{\epsilon}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\uc}{^{uc}}
\newcommand{\ut}{^{(\theta)}}
\newcommand{\tht}{_{\theta(t)}}
\newcommand{\cI}{\mathcal{I}}
% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
%\usepackage[disable,textsize=tiny]{todonotes}
%\usepackage[textsize=tiny]{todonotes}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
%\usepackage[T1]{fontenc}
% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
%\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}
\usepackage{tcolorbox}
% If the title and author information does not fit in the area allocated, uncomment the following
%
%\setlength\titlebox{<dim>}
%
% and set <dim> to something 5cm or larger.

\title{ \textsc{FLAG-Trader}: Fusion LLM-Agent with Gradient-based \\Reinforcement Learning for
Financial Trading}

% Author information can be set in various styles:
% For several authors from the same institution:
% \author{Author 1 \and ... \and Author n \\
%         Address line \\ ... \\ Address line}
% if the names do not fit well on one line use
%         Author 1 \\ {\bf Author 2} \\ ... \\ {\bf Author n} \\
% For authors from different institutions:
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \And  ... \And
%         Author n \\ Address line \\ ... \\ Address line}
% To start a separate ``row'' of authors use \AND, as in
% \author{Author 1 \\ Address line \\  ... \\ Address line
%         \AND
%         Author 2 \\ Address line \\ ... \\ Address line \And
%         Author 3 \\ Address line \\ ... \\ Address line}

\author{%
Guojun Xiong\textsuperscript{1},
Zhiyang Deng\textsuperscript{2},
Keyi Wang\textsuperscript{3},
Yupeng Cao\textsuperscript{2},
Haohang Li\textsuperscript{2},
Yangyang Yu\textsuperscript{2},
\\
\textbf{Xueqing Peng\textsuperscript{7}},
\textbf{Mingquan Lin\textsuperscript{4}},
\textbf{Kaleb E Smith\textsuperscript{5}},
\textbf{Xiao-Yang Liu Yanglet\textsuperscript{3,6}},
\\
\textbf{Jimin Huang\textsuperscript{7}},
\textbf{Sophia Ananiadou\textsuperscript{8}},
\textbf{Qianqian Xie\textsuperscript{7,*}}
\\
\\
\textsuperscript{1}Harvard University,
\textsuperscript{2}Stevens Institute of Technology,
\textsuperscript{3}Columbia University,
\\
\textsuperscript{4}University of Minnesota,
\textsuperscript{5}NVIDIA,
\textsuperscript{6}Rensselaer Polytechnic Institute,
\\
\textsuperscript{7}TheFinAI,
\textsuperscript{8}University of Manchester
\\
\small{
\textbf{\textsuperscript{*}Correspondence:} \href{xqq.sincere@gmail.com}{xqq.sincere@gmail.com} 
}
}


%\author{
%  \textbf{First Author\textsuperscript{1}},
%  \textbf{Second Author\textsuperscript{1,2}},
%  \textbf{Third T. Author\textsuperscript{1}},
%  \textbf{Fourth Author\textsuperscript{1}},
%\\
%  \textbf{Fifth Author\textsuperscript{1,2}},
%  \textbf{Sixth Author\textsuperscript{1}},
%  \textbf{Seventh Author\textsuperscript{1}},
%  \textbf{Eighth Author \textsuperscript{1,2,3,4}},
%\\
%  \textbf{Ninth Author\textsuperscript{1}},
%  \textbf{Tenth Author\textsuperscript{1}},
%  \textbf{Eleventh E. Author\textsuperscript{1,2,3,4,5}},
%  \textbf{Twelfth Author\textsuperscript{1}},
%\\
%  \textbf{Thirteenth Author\textsuperscript{3}},
%  \textbf{Fourteenth F. Author\textsuperscript{2,4}},
%  \textbf{Fifteenth Author\textsuperscript{1}},
%  \textbf{Sixteenth Author\textsuperscript{1}},
%\\
%  \textbf{Seventeenth S. Author\textsuperscript{4,5}},
%  \textbf{Eighteenth Author\textsuperscript{3,4}},
%  \textbf{Nineteenth N. Author\textsuperscript{2,5}},
%  \textbf{Twentieth Author\textsuperscript{1}}
%\\
%\\
%  \textsuperscript{1}Affiliation 1,
%  \textsuperscript{2}Affiliation 2,
%  \textsuperscript{3}Affiliation 3,
%  \textsuperscript{4}Affiliation 4,
%  \textsuperscript{5}Affiliation 5
%\\
%  \small{
%    \textbf{Correspondence:} \href{mailto:email@domain}{email@domain}
%  }
%}

\begin{document}
\maketitle
\begin{abstract}
Large language models (LLMs) fine-tuned on multimodal financial data have demonstrated impressive reasoning capabilities in various financial tasks. However, they often struggle with multi-step, goal-oriented scenarios in interactive financial markets, such as trading, where complex agentic approaches are required to improve decision-making. To address this, we propose \textsc{FLAG-Trader}, a unified architecture integrating linguistic processing (via LLMs) with gradient-driven reinforcement learning (RL) policy optimization, in which a partially fine-tuned LLM acts as the policy network, leveraging pre-trained knowledge while adapting to the financial domain through parameter-efficient fine-tuning.  Through policy gradient optimization driven by trading rewards, our framework not only enhances LLM performance in trading but also improves results on other financial-domain tasks. We present extensive empirical evidence to validate these enhancements.
\end{abstract}

\input{sections/1_Intro}
%%%
\input{sections/2_relatedwork}
%%%
\input{sections/3_Problem_definition}
%%%
\input{sections/4_Methods}
%%%
\input{sections/5_Experiments}

% The \LaTeX{} and Bib\TeX{} style files provided roughly follow the American Psychological Association format.
% If your own bib file is named \texttt{custom.bib}, then placing the following before any appendices in your \LaTeX{} file will generate the references section for you:
% \begin{quote}
% \begin{verbatim}
% \bibliography{custom}
% \end{verbatim}
% \end{quote}

% You can obtain the complete ACL Anthology as a Bib\TeX{} file from \url{https://aclweb.org/anthology/anthology.bib.gz}.
% To include both the Anthology and your own .bib file, use the following instead of the above.
% \begin{quote}
% \begin{verbatim}
% \bibliography{anthology,custom}
% \end{verbatim}
% \end{quote}

% Please see Section~\ref{sec:bibtex} for information on preparing Bib\TeX{} files.

% \subsection{Equations}

% An example equation is shown below:
% \begin{equation}
%   \label{eq:example}
%   A = \pi r^2
% \end{equation}

% Labels for equation numbers, sections, subsections, figures and tables
% are all defined with the \verb|\label{label}| command and cross references
% to them are made with the \verb|\ref{label}| command.

% This an example cross-reference to Equation~\ref{eq:example}.

% Use \verb|\appendix| before any appendix section to switch the section numbering over to letters. See Appendix~\ref{sec:appendix} for an example.

% \section{Bib\TeX{} Files}
% \label{sec:bibtex}

% Unicode cannot be used in Bib\TeX{} entries, and some ways of typing special characters can disrupt Bib\TeX's alphabetization. The recommended way of typing special characters is shown in Table~\ref{tab:accents}.

% Please ensure that Bib\TeX{} records contain DOIs or URLs when possible, and for all the ACL materials that you reference.
% Use the \verb|doi| field for DOIs and the \verb|url| field for URLs.
% If a Bib\TeX{} entry has a URL or DOI field, the paper title in the references section will appear as a hyperlink to the paper, using the hyperref \LaTeX{} package.


\section{Conclusion}
In this paper, we introduced \textsc{FLAG-Trader}, a novel framework that integrates LLMs with RL for financial trading. In particular, \textsc{FLAG-Trader} leverages LLMs as policy networks, allowing for natural language-driven decision-making while benefiting from reward-driven optimization through RL fine-tuning. Our framework enables small-scale LLMs to surpass larger proprietary models by efficiently adapting to market conditions via a structured reinforcement learning approach. Through extensive experiments across multiple stock trading scenarios, we demonstrated that \textsc{FLAG-Trader} consistently outperforms baseline methods, including LLM-agentic frameworks and conventional RL-based trading agents. These results highlight the potential of integrating LLMs with RL to achieve adaptability in financial decision-making.

\newpage
\section*{Limitations and Potential Risk}

Despite its promising results, \textsc{FLAG-Trader} has several limitations. First, while our approach significantly enhances the decision-making ability of LLMs, it remains computationally expensive, particularly when fine-tuning on large-scale market datasets. Reducing computational overhead while maintaining performance is an important direction for future research. Second, financial markets exhibit high volatility and non-stationarity, posing challenges for long-term generalization. Future work should explore techniques such as continual learning or meta-learning to enhance model adaptability in evolving market conditions. Third, while \textsc{FLAG-Trader} effectively integrates textual and numerical data, its reliance on structured prompts could introduce biases in decision-making. Improving prompt design or exploring retrieval-augmented methods may further enhance robustness. Lastly, real-world trading requires stringent risk management, and \textsc{FLAG-Trader} currently optimizes for financial returns without explicitly incorporating risk-sensitive constraints. Extending the framework to integrate risk-aware objectives and dynamic portfolio optimization could provide more robust and practical financial trading solutions.

% \section*{Acknowledgments}

% This document has been adapted
% by Steven Bethard, Ryan Cotterell and Rui Yan
% from the instructions for earlier ACL and NAACL proceedings, including those for
% ACL 2019 by Douwe Kiela and Ivan Vuli\'{c},
% % NAACL 2019 by Stephanie Lukin and Alla Roskovskaya,
% % ACL 2018 by Shay Cohen, Kevin Gimpel, and Wei Lu,
% % NAACL 2018 by Margaret Mitchell and Stephanie Lukin,
% % Bib\TeX{} suggestions for (NA)ACL 2017/2018 from Jason Eisner,
% % ACL 2017 by Dan Gildea and Min-Yen Kan,
% % NAACL 2017 by Margaret Mitchell,
% % ACL 2012 by Maggie Li and Michael White,
% % ACL 2010 by Jing-Shin Chang and Philipp Koehn,
% % ACL 2008 by Johanna D. Moore, Simone Teufel, James Allan, and Sadaoki Furui,
% % ACL 2005 by Hwee Tou Ng and Kemal Oflazer,
% % ACL 2002 by Eugene Charniak and Dekang Lin,
% % and earlier ACL and EACL formats written by several people, including
% % John Chen, Henry S. Thompson and Donald Walker.
% % Additional elements were taken from the formatting instructions of the \emph{International Joint Conference on Artificial Intelligence} and the \emph{Conference on Computer Vision and Pattern Recognition}.

% Bibliography entries for the entire Anthology, followed by custom entries
%\bibliography{anthology,custom}
% Custom bibliography entries only
\bibliography{main}

\newpage
\appendix
\onecolumn
\input{sections/z_appendix}



\end{document}
