


\input{tables/k_shot_gsm_symbolic}


\subsection{GSM-Symbolic Examples and Prompt}
\label{sec:gsm_info}
\textbf{GSM-Symbolic Problem Solution Examples:}
\input{figures/gsm_example}
\textbf{GSM-Symbolic Prompt:}
\input{figures/gsm_prompt}
\input{figures/gsm_prompt_no_cot}

\subsection{FOLIO Examples and Prompt}
\label{sec:folio_info}
\textbf{FOLIO Problem Solution Examples:}
\input{figures/folio_example}
\textbf{FOLIO Prompt:}
\input{figures/folio_prompt}


\newpage
\subsection{Case Study For GSM-Symbolic}
\input{figures/case_study_gsm}

\Tool{} effectively alternates between constrained and unconstrained generation to produce intermediate expressions, the final answer, and to maintain the reasoning capabilities of the LLM. In contrast, unconstrained generation with CoT results in a syntactically incorrect expression, while constrained generation produces a syntactically valid but incorrect expression.

\subsection{Sampling Ablation for GSM-Symbolic}
In our GSM-Symbolic case study, we use IterGen as the constrained generation baseline and initialize \Tool{} with IterGen. Both IterGen and \Tool{} employ selective rejection sampling to filter tokens that do not satisfy semantic constraints. For comparison, we also run unconstrained generation using temperature sampling and evaluate its performance against \Tool{}. Specifically, for Qwen2.5-1.5B-Instruct and Llama-3.1-8B-Instruct, we generate three samples with unconstrained generation at a temperature of \( t = 0.7 \) and compute pass@1/2/3 metrics. 

As shown in Table ~\ref{tab:rejection_sample_gsm}, \Tool{} with greedy decoding achieves higher accuracy than pass@1/2/3 for unconstrained generation with Chain-of-Thought (CoT) and temperature sampling on Qwen2.5-1.5B-Instruct. Although, for Llama-3.1-8B-Instruct, unconstrained generation with CoT and temperature sampling achieves a pass@3 accuracy of 35\%—2\% higher than \Tool{}—it generates approximately 4 times as many tokens as \Tool{}.

\input{tables/rejection_sample_gsm}



\input{tables/rejection_sample_fol}


\subsection{Grammars}
\subsubsection{GSM-Symbolic Grammar}
\label{sec:gsm_grammar}

\input{figures/gsm_grammar}



\subsubsection{Prover9 Grammar}
\label{sec:prover9_grammar}

\input{figures/prover9_grammar}



