

% \vspace{-1em}
\section{Evaluation}
\label{sec:eval}
In this section, we first evaluate the energy and performance of the proposed TAP-CAM design. We then benchmark the proposed TAP-CAM array in the context of K-nearest neighbor search tasks as tunable approximate matching engine.

\subsection{Evaluation Setup}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{Figures/mxn.png}
    \caption{Schematic of m$\times$n TAP-CAM array.}
\label{fig:mxn}
\end{figure}

For the energy and performance evaluations, we conduct our experiments on
%original 1x64 array of 2FeFET-2R TCAM cells into 
a TAP-CAM array with m rows and n columns, as shown in \autoref{fig:mxn}. 
%Expanded array accommodates m words, each of length n.
The cells within the same row share the \textit{ML} and \textit{ScL}, and %the array possesses identical functionalities. 
the cells within the same column share \textit{SLs}, enabling parallel search operations. 
%while cells in the same row share $ML$ voltages, controlling $ML$ voltage variations simultaneously. 
Write/Search buffer drive stored/search vectors into \textit{SLs} for search operations, consistent with \autoref{tab:write opetarion}. 
During the search, all rows compare the same input query with stored entries.
If a mismatch occurs, \textit{ML} discharges. 
If \textit{ML} voltage drops below the sense amplifier threshold within the pre-defined sense time window, the corresponding SA output transitions to 0, recognized by the decoder as mismatch. Conversely, if a match occurs, the address of the stored entry matching the search query is output.

%Compared to a single-row 2FeFET-2R TCAM, the expanded m×n array has larger capacity and efficiently executes matching operations during search. By sharing $SLs$ and $ML$ voltage, the array achieves highly parallel search operations, thereby improving overall performance and efficiency.
The proposed 2FeFET-2R TAP-CAM array is evaluated using SPECTRE. The FeFETs are simulated based on the Preisach FeFET model \cite{transfer-characteristics}.
All MOSFETs are modeled using the 45nm PTM model and the 27°C TT process corner \cite{evaluation2}. The wordlength is set to 64 cells.
%, and the write voltage is ±4V. 

\subsection{Robustness Validation}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{Figures/MC.png}
    \caption{100 Monte Carlo simulations considering device-to-device variations: \textbf{(a)} The output waveforms under \textit{VDD} = 0.6V; \textbf{(b)} The output waveforms under \textit{VDD} = 1V.}
\label{fig:MC}
%\vspace{-0.2cm}
\end{figure}

The robustness of the proposed TAP-CAM design under varying operating conditions is examined, specifically with \textit{VDD} = 0.6V and \textit{VDD} = 1V, respectively. 
%To control the experimental variability of the FeFETs,
The FeFETs are assumed to feature the stored low/high $\textit{V}_\textit{TH}$ threshold voltage states with a deviation $\sigma$ = 54mV, and 8$\%$   series resistor variability is considered \cite{area}.
100 Monte Carlo simulations have been conducted  to distinguish between 5-bits and 6-bits mismatches when the mismatch threshold is set to 5 bits (Th-5). 
\autoref{fig:V&N} consistently reveals that the time windows across the 100 runs can be identified.
This observation suggests that the proposed design effectively distinguishes between the adjacent numbers of mismatched bits by employing the evaluation transistor. 
%Furthermore, the design maintains consistent search performance under different experimental conditions. 
Based on these results, it can be inferred that the proposed TAP-CAM design  demonstrates the robustness, as it reliably achieves approximate threshold matching functionality given the variations in operating voltage and device variations.



\subsection{CAM Array Evaluation}
%Here we conduct the evaluations of our 
\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{Figures/energy1.jpg}
    \caption{Energy and latency of the proposed 2FeFET-2R TAP-CAM array
with varying \textbf{(a)} \textit{VDD}; \textbf{(b)} mismatch thresholds; \textbf{(c)} number of rows and \textbf{(d)} number of bits per row.}
\label{fig:V&N}
%\vspace{-0.4cm}
\end{figure}

The search energy consumption of the proposed array mainly originates from precharging the \textit{ML} and SA energy consumption.
Precharging the \textit{ML}, primarily done by $\textit{T}_\text{1}$, depends heavily on \textit{VDD} and the associated \textit{ML} parasitic capacitance.
\autoref{fig:V&N}(a) demonstrates the impact of scaling \textit{VDD} on the search energy consumption and latency. 
As \textit{VDD} scales up, the precharging energy increases, leading to overall higher search energy consumption. At the same time, the amplitude of \textit{ML} dropping from high to low level when mismatch occurs increases, thereby increasing the search delay.  
\autoref{fig:V&N}(b) shows the sense time and sense margin for different mismatch thresholds at \textit{VDD} = 1V. The sense margin is the narrowest at the 5-bit mismatch threshold (Th-5), thus is selected as the sense margin for the SA sense time. 
\autoref{fig:V&N}(c) demonstrates how search energy and latency change with varying row numbers. Increased rows allow parallel search operations, linearly increasing the energy consumption with negligible latency change. 
Finally, \autoref{fig:V&N}(d) examines the wordlength's effect on the search latency and energy consumption per bit. 
Longer wordlengths associate more parasitic capacitance on the \textit{ML}, slowing down the discharge speed and thus increasing the search latency. The increase in capacitance 
leads to a rise in precharge energy per word. But increasing wordlength has minimal impact on the energy consumption of SA, so the search energy per bit decreases. The increasing latency and decreasing energy consumption per bit show trade-offs in the CAM array design optimization.

%The energy consumption in this process predominantly originates from two sources: the precharging of the $ML$ and the energy consumption by the SA. The precharging of the $ML$, primarily accomplished by $T_1$, is heavily contingent upon the magnitude of $V_{DD}$ and the parasitic capacitance. 

%\autoref{fig:V&N}(a) illustrates the impact of increasing $V_{DD}$ on energy consumption and latency. As $V_{DD}$ increases, precharging energy also increases, leading to overall higher energy consumption and latency. 
%\autoref{fig:V&N}(b) presents the sensing time and sensing margin for different matching thresholds at $V_{DD}$=1V. Notably, the sensing margin is narrowest at the 5-bit matching threshold, which determines the final sensing margin. \autoref{fig:V&N}(c) demonstrates how energy and latency vary with different numbers of rows. With increased row numbers, multiple rows can operate simultaneously, linearly increasing power consumption without affecting latency.
%Finally, \autoref{fig:V&N}(d) examines the effect of word length on latency and energy consumption per bit. Longer word lengths result in higher parasitic capacitance on the $ML$, slowing discharge speed and increasing latency. Conversely, longer word lengths lead to lower energy consumption per bit, highlighting the trade-offs in CAM array design optimization.


\input{Tabs/compare}

\autoref{tab:compare} provides a comprehensive comparison of the proposed 2FeFET-2R TAP-CAM with other CAM designs, in terms of  device type, technology node, device count per cell, cell size, performance and normalized search energy. Cell size estimation is based on a 2$\times$2 layout of the 2FeFET-2R TAP-CAM array.
%\autoref{tab:compare} presents a comprehensive comparison of the 2FeFET-2R CAM with other CAM designs, including the utilized technology, node, device count per cell, cell size, search delay, and search energy per bit per search.  The cell size estimation is based on a 2x2 layout of the 2FeFET-2R CAM array. 
%Our design leverages innovative FeFET technology, enabling approximate matching through different thresholds, achieving significant breakthroughs in circuit functionality and energy consumption. 
Compared to the conventional  CMOS  CAM designs, our proposed  2FeFET-2R TAP-CAM design offers a much smaller cell size. 
The  comparisons highlight the significant advantages of the proposed 2FeFET-2R TAP-CAM design over other CAM designs in terms of energy consumption per bit per search.
The energy efficiency of 2FeFET-2R TAP-CAM is notably superior, being 16.95$\times$, 12.88$\times$, 9.49$\times$, and 6.78$\times$ more efficient compared to 16T TCAM, 10T CAM, 2T-2R TCAM, and 2FeFET TCAM, respectively. 
While some existing designs  achieve approximate search functionality, their energy consumption remains substantially higher than that of 2FeFET-2R structure. 
%Utilizing ferroelectric transistor technology, 2FeFET-2R design represents promising direction for CAM design innovation, providing practical solution for enhancing search efficiency, reducing energy consumption, and optimizing area costs.
Although our design incurs relatively high search delay, considering the search latency and energy  trade-offs and the substantial energy advantages of our proposed design, increased delay is deemed acceptable.


These findings validate the remarkable energy efficiency of 2FeFET-2R TAP-CAM  array, emphasizing its immense potential for data-intensive search applications. This suggests that 2FeFET-2R TAP-CAM architecture is well-positioned to address the evolving needs of modern computing environments, particularly those requiring efficient and high-performance solutions for processing large volumes of data in search-intensive applications.

%Our design leverages innovative FeFET technology, enabling approximate matching through different thresholds, and has achieved significant breakthroughs in both circuit functionality and energy consumption. Compared to CMOS technology, the 2FeFET-2R structure offers a smaller cell size, thus reducing area costs. Although our design incurs a relatively high search delay, considering the trade-off between latency and energy consumption, as well as the substantial energy advantages of the 2FeFET-2R structure, the increased search delay is deemed acceptable. The comparison provided highlights the significant advantages of the 2FeFET-2R CAM structure over several other CAM designs in terms of energy consumption per bit per search. The energy efficiency of the 2FeFET-2R CAM is notably superior, being 16.95$\times$, 12.88$\times$, 8.81$\times$, and 6.78$\times$ more efficient compared to 16T CAM, 10T CAM, 4T-2FeFET CAM, and 2FeFET CAM, respectively. Despite the capability of some alternative designs to achieve approximate search functionality, their energy consumption remains substantially higher than that of the 2FeFET-2R structure. These findings validate the remarkable energy efficiency of the 2FeFET-2R CAM circuit array, emphasizing its immense potential for data-intensive search applications. Utilizing ferroelectric transistor technology, the 2FeFET-2R design represents a promising direction for CAM design innovation. It presents a practical solution for enhancing search efficiency, reducing energy consumption, and optimizing area costs.








\subsection{Case Study: K-Nearest Neighbor Search}
\begin{figure*}
    \centering
    \includegraphics[width=\linewidth]{Figures/csj_benchmark.pdf}
    \caption{\textbf{(a)} KNN clustering accuracy under different \design thresholds, ranging from Th-1 to Th-6 (left to right); \textbf{(b)} Computational speedup and \textbf{(c)} energy efficiency improvement of \design with varying wordlengths compared to a GPU implementation. Datasets from left to right are Iris, Wine and Digits. }
    \label{fig:benchmark}
\end{figure*}
To demonstrate the efficiency of the proposed  design, we benchmark the proposed 2FeFET-2R TAP-CAM array in the context of  K-nearest neighbor (KNN) search framework. 
KNN, a fundamental algorithm in machine learning, embodies a non-parametric supervised model, particularly effective when $\textit{K = }1$, representing the nearest neighbor (NN) classification. 
This algorithm finds widespread use across various fields, including HDC  \cite{liu2022cosime, shou2023see}, reinforcement learning \cite{li2022associative}, and bioinformatics \cite{laguna2020seed}, etc.

At the core of the KNN approach lies the calculation of distances between the query instance, denoted as $x$, and the stored vectors, denoted as $y_i$, within the CAM array.
This process utilizes a distance function, typically denoted as $d(x, y_i)$, which quantifies the dissimilarity or similarity between the data points. 
When $\textit{K = }1$, i.e. NN classification, the class label attributed to the query instance $x$ corresponds to the category of the nearest stored vector $y_i$, identified by the smallest distance metric. This intuitive method allows for straightforward classification based on proximity, making it particularly suitable for scenarios with intricate decision boundaries or complex dataset patterns.
Conversely, when \textit{K} exceeds 1 instead of relying on the nearest neighbor, the algorithm considers the k closest neighbors of the query instance $x$. The class label assigned to $x$ is determined by a majority voting mechanism, where the most frequent class label among the k nearest neighbors prevails. 
This adaptive approach enables KNN to capture more nuanced relationships within the dataset, thereby enhancing its predictive capability and robustness in various applications.


%In the case of NN classification ($K=1$), the class label attributed to the query instance $x$ corresponds to the category of the nearest stored vector $y_i$, identified by the smallest distance metric. This intuitive method allows for straightforward classification based on proximity, making it particularly suitable for scenarios with intricate decision boundaries or complex dataset patterns.

%Expanding on this foundation, the KNN algorithm handles cases where K exceeds 1. In such situations, instead of relying on the nearest neighbor, the algorithm considers the K closest neighbors of the query instance $x$. The class label assigned to $x$ is determined by a majority voting mechanism, where the most frequent class label among the K nearest neighbors prevails. This adaptive approach enables KNN to capture more nuanced relationships within the dataset, thereby enhancing its predictive capability and robustness in various applications.

%In benchmarking our proposed 2FeFET-2R TAP-CAM architecture within the KNN framework, our goal is to showcase its versatility, efficiency, and applicability across various machine learning tasks. Through thorough evaluation and comparison with existing methodologies, we aim to highlight the potential of our design to advance CAM technology and contribute to machine learning research and development.

In benchmarking our proposed 2FeFET-2R TAP-CAM, for a given a function $d(x,y_i)$, which measures the distance between the query $x$ and the i-th stored vector $y_i$ in the CAM array, NN assigns the class label with the smallest distance value to $x$. Similarly, in KNN, given a query $x$, it assigns the most common class label of $x$'s k nearest neighbors to $x$ \cite{jiang2007survey}, as illustrated in \autoref{eq:knn}.
\begin{equation}
\label{eq:knn}
    c(x) = argmax\ \sum^k_{i=1} \delta(c,c(y_i))
\end{equation}
where $c(x)$ represents the class label of the query $x$, while $c(y_i)$ represents that of $y_i$. $y_i$ with $i$ ranges from 1 to k represent the k nearest neighbors. We have $\delta(c,c(y_i))=1$ when the query's label $c$ equals the label of $y_i$, otherwise $\delta(c,c(y_i))=0$.

\input{Tabs/dataset}
To comprehensively evaluate the effectiveness and performance of the proposed TAP-CAM architecture, KNN clustering analysis is conducted under the three most frequently referenced datasets in the UCI Machine Learning Repository, as shown in \autoref{tab:benchmark}. The datasets include Iris, Wine, and Digits, representing a wide range of data types and complexities. In order to achieve a robust evaluation, we have partitioned these datasets into training sets and test sets at an 8:2 ratio to ensure accurate testing and comparison of TAP-CAM model's performance.


\autoref{fig:benchmark}(a) illustrates the effectiveness of the proposed \design architecture across different datasets. 
Among Iris, Wine, and Digits, the \textit{Wine} dataset exhibits the highest susceptibility to hardware device-level variations. This observation emphasizes the importance of robustness in hardware designs, particularly in applications where environmental factors introduce variability. Additionally, we have examined the accuracy performance of KNN search under different TAP-CAM thresholds. 
Interestingly, the results indicate that identifying the nearest neighbor may not always yield the optimal solution. 
For instance, the Iris, Wine, and Digits datasets achieve their respective maximum clustering accuracies at $\textit{K = }2$, $\textit{K = }6$, and $\textit{K = }3$, respectively. 
With the proposed tunable approximate matching scheme, an average 3.06 \% accuracy improvement is observed compared to existing exact-match CAM methods.

Power consumption is obtained via the \textit{Nvidia-smi} toolkit, with the study conducted on \textit{Nvidia 2080ti GPU}, and the \design operations are analyzed via the \textit{Pytorch profiler}. Assuming 256 \design rows, feasible in current manufacturing technology, the KNN clustering benchmark considers different \design wordlengths at the algorithmic level. Idling power is excluded from the results. \autoref{fig:benchmark}(b) illustrates that \design exhibits at least $1.95\times 10^3$ speedup compared to GPU implementation. 
In addition, the energy consumption in \design grows linearly with the number of cells per row, whereas GPU implementations show little increase with dimensionality increment.
Consequently, as dimensionality increases, energy efficiency improvement decreases as demonstrated in \autoref{fig:benchmark}(c). 
For the \textit{Digits} dataset,
\design energy increases with the large number of instances and features,
resulting in an average improvement of $3.15\times$ compared to GPU implementations.

These results illustrate the effectiveness of the proposed TAP-CAM architecture across multiple datasets and scenarios, confirming its feasibility and superiority in practical applications. Through evaluation and comparison with existing methodologies, we highlight the potential of our design to advance CAM technology and contribute to machine learning research and development.