\begin{figure}[b]
\vspace{-4.5mm}
\begin{adjustbox}{width=1.0\textwidth}
\hspace{18.8mm}
\begin{adjustbox}{width=0.114\textwidth}
\begin{minipage}[c]{0.131\linewidth} %
\begin{adjustbox}{width=1\textwidth}
\begin{tikzpicture}[node distance=2.0cm]
    \tikzset{
        gridMatrix/.style={
            matrix of nodes,
            nodes={
                minimum size=0.7cm,
                anchor=center,
                inner sep=0pt,
                font=\tiny
            },
            column sep=-\pgflinewidth,
            row sep=-\pgflinewidth,
            nodes in empty cells,
            inner sep=0pt,
            rounded corners=1pt
        }
    }
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}] (diag) {
        |[fill=blue!20]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=blue!40]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!60]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!80]| {} \\
    };
\end{tikzpicture}
\end{adjustbox}
\end{minipage}
\end{adjustbox}
\hspace{10.3mm}
\begin{adjustbox}{width=0.32\textwidth}
\begin{minipage}[c]{0.335\linewidth} %
\begin{adjustbox}{width=1.0\textwidth}
\begin{tikzpicture}[node distance=2cm]
    \tikzset{
        gridMatrix/.style={
            matrix of nodes,
            nodes={
                minimum size=0.7cm,
                anchor=center,
                inner sep=0pt,
                font=\tiny
            },
            column sep=-\pgflinewidth,
            row sep=-\pgflinewidth,
            nodes in empty cells,
            inner sep=0pt,
            rounded corners=1pt
        }
    }
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}] (diag) {
        |[fill=blue!20]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=blue!40]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!60]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!80]| {} \\
    };
    \node[right=0.35cm of diag] (plus) {\Large $+$};
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}] (colVec) 
       at ($(plus.east)+(0.75,0)$) {
        |[fill=red!30]| {} \\
        |[fill=red!50]| {} \\
        |[fill=red!70]| {} \\
        |[fill=red!90]| {} \\
    };
    \node at ($(colVec.east)!0.5!(colVec.east)+(0.5,0)$) {\Large $\times$};
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}, anchor=north west, baseline=0.3cm]
       (rowVec) at ($(colVec.north east)+(1.0cm,0)$) {
        |[fill=purple!30]| {} & |[fill=purple!50]| {} & |[fill=purple!70]| {} & |[fill=purple!90]| {} \\ 
        |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} \\
    };
\end{tikzpicture}
\end{adjustbox}
\end{minipage}
\end{adjustbox}
\hspace{3.6mm}
\begin{adjustbox}{width=0.36\textwidth}
\begin{minipage}[c]{0.355\linewidth} %
\vspace{5.5mm}
\begin{adjustbox}{width=1.0\textwidth}
\begin{tikzpicture}[node distance=2cm]
    \tikzset{
        gridMatrix/.style={
            matrix of nodes,
            nodes={
                minimum size=0.7cm,
                anchor=center,
                inner sep=0pt,
                font=\tiny
            },
            column sep=-\pgflinewidth,
            row sep=-\pgflinewidth,
            nodes in empty cells,
            inner sep=0pt,
            rounded corners=1pt
        }
    }
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}] (diag) {
        |[fill=blue!20]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=blue!40]| {} & |[fill=white]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!60]| {} & |[fill=white]| {} \\
        |[fill=white]| {} & |[fill=white]| {} & |[fill=white]| {} & |[fill=blue!80]| {} \\
    };
    \node[right=0.35cm of diag] (plus) {\Large $+$};
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}] (colVec) 
       at ($(plus.east)+(1.0,0)$) {
        |[fill=red!30]| {} & |[fill=violet!30]| {} \\
        |[fill=red!50]| {} & |[fill=violet!50]| {} \\
        |[fill=red!70]| {} & |[fill=violet!70]| {} \\
        |[fill=red!90]| {} & |[fill=violet!90]| {} \\
    };
    \draw[decorate, decoration={brace, mirror, amplitude=7.5pt, raise=2pt, aspect=0.5pt}, line width=1.5pt]
        (colVec.south west) -- (colVec.south east)
        node[midway, below=10pt] {\huge $n_h$};
    \node at ($(colVec.east)!0.5!(colVec.east)+(0.5,0)$) {\Large $\times$};
    \matrix[gridMatrix, left delimiter={[}, right delimiter={]}, anchor=north west, baseline=0.3cm]
       (rowVec) at ($(colVec.north east)+(1.0cm,0)$) {
        |[fill=purple!30]| {} & |[fill=purple!50]| {} & |[fill=purple!70]| {} & |[fill=purple!90]| {} \\ 
        |[fill=orange!30]| {} & |[fill=orange!50]| {} & |[fill=orange!70]| {} & |[fill=orange!90]| {} \\
        |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} & |[fill=white, opacity=0, minimum size=0.05cm]| {} \\
    };
\end{tikzpicture}
\end{adjustbox}
\end{minipage}
\end{adjustbox}
\end{adjustbox} \\

\vspace{-1mm}
\begin{minipage}[b]{0.13\linewidth}
{\footnotesize
    \textcolor{white}{Diagonal}\\
    \textit{Token Mix:} \\
    \textit{Channel Mix:}\\
    \textit{Expressivity:}\\
    \textit{Examples: }}
    \end{minipage}
\begin{minipage}[b]{0.16\linewidth}
{\footnotesize
    \textbf{Diagonal:}\\
    $\checkmark$ \\
    $\times$ \\
    Parity \\
    Mamba, GLA}
    \end{minipage}
\hspace{2.0mm}
\begin{minipage}[b]{0.23\linewidth}
{\footnotesize
    \textbf{Rank 1 Update:}\\
    $\checkmark$ \\
    $\checkmark$ \\
    Reflections \\
    DeltaNet, TTT, RWKV-7}
    \end{minipage}
\hspace{13.5mm}
\begin{minipage}[b]{0.2\linewidth}
{\footnotesize
\textbf{Rank $n_h$ Update:}\\
$\checkmark$ \\
$\checkmark$ \\
Reflections, Rotations \\
\textbf{DeltaProduct}}
\end{minipage}
\vspace{-2mm}
\caption{Overview of state-transition matrices in linear RNNs: Diagonal matrices (e.g., in Mamba/mLSTM) mix tokens only; rank‑1 updates (DeltaNet/TTT) mix tokens and channels; and our proposed DeltaProduct performs rank‑\(n_h\) updates, further increasing the expressivity.}
\label{fig:rank_update_overview}
\end{figure}
