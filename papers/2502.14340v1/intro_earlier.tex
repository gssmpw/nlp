%----------------------------------------------
\begin{wrapfigure}[17]{r}{6.5cm}
    \centering
    \vspace{-0.30cm}
    \begin{tikzpicture}
      \scriptsize{
      \begin{axis}[
      width=.48\textwidth, height=.32\textwidth ,
      xlabel=Response Position,
      ylabel=KL Divergence,
      xmin=0, xmax=1450,
      ymin=0, ymax=3.3,
      xtick={0,200,400,600,800,1000, 1200,1400},
      %xticklabels={$0$,$10$,$20$,$30$,$40$,$50$},
      ytick={0.5,1.0,1.5,2.0,2.5,3.0},
      % yticklabels={$0.1$,$0.2$,$0.3$,$0.4$,$0.5$,$0.6$},
      ymajorgrids=true,
      xmajorgrids=true,
      grid style=dashdotted,
      legend cell align=left,
      scaled ticks=false,
      xlabel style={align=center,font=\scriptsize},
      ylabel style={font=\scriptsize,yshift=0em},
      yticklabel style={/pgf/number format/fixed,/pgf/number format/fixed zerofill,/pgf/number format/precision=1},
      ytick style={opacity=0},
      legend style={yshift=-0.2em,xshift=0em,legend cell align=left,legend plot pos=right},
      ]
      \addplot [sharp plot,red,mark size=1pt,thick,line width=0.5pt,mark size=0.2pt] table [x=position,y=value,col sep=comma] {./Figure/llama_self_sampling.csv};
      \addplot [sharp plot,blue,mark size=1pt,thick,line width=0.5pt,mark size=0.2pt] table [x=position,y=value,col sep=comma] {./Figure/gemma_self_sampling.csv};
      \addplot [sharp plot,orange,mark size=1pt,thick,line width=0.5pt,smooth] table [x=position,y=value,col sep=comma] {Figure/mistral_self_sampling.csv};
      \legend{\tiny{Llama3-Instruct (8B)},\tiny{Gemma2-Instruct (9B)},\tiny{Mistral-NeMo-Instruct (12B)}},
      \end{axis}
      }
      \end{tikzpicture}
    \caption{Visualization of KL divergence of instruct models and their DPO variants. The results include three widely used open-source LLMs: Llama3, Gemma2, and Mistral-NeMo. Observation here indicates earlier tokens contribute more during alignment.}
     \label{fig:self_sampling}
    \end{wrapfigure}
  %----------------------------------------------




  %----------------------------------------------
% \begin{wrapfigure}[16]{r}{6.5cm}
%     \centering
%     \vspace{-0.0in}
%     \begin{tikzpicture}
%       \scriptsize{
%       \begin{axis}[
%       width=.48\textwidth, height=.32\textwidth ,
%       xlabel=Position,
%       ylabel=KL Divergence,
%       xmin=0, xmax=1050,
%       ymin=0, ymax=1.2,
%       xtick={0,200,400,600,800,1000},
%       %xticklabels={$0$,$10$,$20$,$30$,$40$,$50$},
%       ytick={0.2,0.4,...,1.4},
%       % yticklabels={$0.1$,$0.2$,$0.3$,$0.4$,$0.5$,$0.6$},
%       ymajorgrids=true,
%       xmajorgrids=true,
%       grid style=dashdotted,
%       legend cell align=left,
%       scaled ticks=false,
%       xlabel style={align=center,font=\scriptsize},
%       ylabel style={font=\scriptsize,yshift=0em},
%       yticklabel style={/pgf/number format/fixed,/pgf/number format/fixed zerofill,/pgf/number format/precision=1},
%       ytick style={opacity=0},
%       % xtick label style={font=\tiny},
%       % ytick label style={font=\tiny},
%       legend style={yshift=-0.2em,xshift=0em,legend cell align=left,legend plot pos=right},
%       ]
%       \addplot [sharp plot,red,mark size=1pt,thick,line width=0.5pt,mark size=0.2pt] table [x=position,y=value,col sep=comma] {./Figure/llama_self_target_kl.csv};
%       \addplot [sharp plot,blue,mark size=1pt,thick,line width=0.5pt,mark size=0.2pt] table [x=position,y=value,col sep=comma] {./Figure/gemma_self_target_kl.csv};
%       \addplot [sharp plot,orange,mark size=1pt,thick,line width=0.5pt,smooth] table [x=position,y=value,col sep=comma] {Figure/mistral_self_target_kl.csv};
%       \legend{\tiny{Llama3-Instruct (8B)},\tiny{Gemma2-Instruct (9B)},\tiny{Mistral-NeMo-Instruct (12B)}},
%       \end{axis}
%       }
%       \end{tikzpicture}
%     \caption{Visualization of the KL divergence of instruct models and their subsequent DPO variants. The results include three widely used open-source LLMs: Llama3, Gemma2, and Mistral-NeMo.}
%      \label{fig:self_sampling}
%     \end{wrapfigure}
  %----------------------------------------------