\begin{wrapfigure}[9]{r}{5.4cm}
    \centering
    \vspace{-0.5cm}
    \begin{tikzpicture}
    \scriptsize{
        \begin{axis}[
            width=5.0cm,
            height=3.6cm,
            xlabel={Ref margin. $\pi_{\text{ref}} (y_w|x) - \pi_{\text{ref}} (y_l|x)$},
            ylabel={Density},
            xmin=-100, xmax=100,
            ymin=0, ymax=0.12,
            legend style={at={(0.73, 1.0)}, anchor=north, legend columns=1, fill opacity=0.5, draw opacity=0.5},
            % axis lines=left,
            % grid=major,
            ymajorgrids=true,
            xmajorgrids=true,
            grid style=dashdotted,
            legend cell align=left,
            scaled ticks=false,
            ytick={0.02, 0.04,..., 0.12},
            xtick={-100,-50,0,50,100},
            yticklabel style={/pgf/number format/fixed,/pgf/number format/fixed zerofill,/pgf/number format/precision=2, rotate=0},
            enlargelimits=false,
            domain=-100:100,
            samples=200,
        ]
        % Plot 1: Self Sampling (blue curve)
        \addplot [
            thick,
            blue,
            fill=blue,
            fill opacity=0.2
        ]
        table[x=value, y=density, col sep=comma] {Figure/llama_self_sampling_ref_margin.csv} \closedcycle;

        \addlegendentry{\tiny{On-Policy}}
        % Plot 2: Non Self Sampling (orange curve)
        \addplot [
            thick,
            orange,
            fill=orange,
            fill opacity=0.2
        ]
        table[x=value, y=density, col sep=comma] {Figure/llama_non_self_sampling_ref_margin.csv} \closedcycle;
        \addlegendentry{\tiny{Off-Policy}}
        
        % Vertical dashed line at x = 0
        % \addplot[dashed, thick, blue] coordinates {(4, 0) (4, 0.76)};
        
        \end{axis}}
    \end{tikzpicture}
    \vspace{-0.45em}
    \caption{Reference margin of DPO.}
    \label{fig:ref_margin_density}
\end{wrapfigure}