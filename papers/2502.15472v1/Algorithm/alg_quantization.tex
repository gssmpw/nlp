\begin{algorithm}[t]
\caption{Training Learnable Constellation Diagram}
% This label should be put after caption
\label{alg_quantization}
\begin{algorithmic}[1]
\Statex \textbf{Initialization}: Initialize the constellation parameter
\Statex $r\rightarrow r_{\text{init}}$, and load pre-trained \gls{jscc} encoder $p_{\phi}(\bm{z}|\bm{x})$.
\State \textbf{Input}: Image dataset $\mathcal{X}$ with corresponding ground truth action $\mathcal{A}$.

\While{not converged}
    \State Sample mini-batch $\{(\bm{a}_i, \bm{x}_i) \}_{i=1}^{\Omega}$ from $\mathcal{X}$ and $\mathcal{A}$.
    \State Encode image $\{\bm{x}_i\}_{i=1}^{\Omega}$ to symbols $\{\bm{z}_i\}_{i=1}^{\Omega}$.
    \State Compute the average batch loss
    \Statex \quad \; $\frac{1}{\Omega}\sum_{i=1}^{\Omega}\mathcal{L}_{Q}(\bm{z}_i;r)$.
    \State Update parameter $r$ through backpropagation.
\EndWhile
\State \textbf{Output}: Optimal constellation parameter $r^*$.

\end{algorithmic}
\end{algorithm}