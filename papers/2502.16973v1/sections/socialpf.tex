\section{Social Preference Functions}\label{sec:spf}

We now turn to \emph{social preference functions (SPFs)}, which, given input $\profile$, return a set of rankings of $A$, rather than a subset of candidates. Indeed, SPFs may be more useful than SCFs in certain settings, such as the meta-search engine example in the previous section. We will first present the definition of IoC for SPFs as introduced by \citet{Freeman14:Axiomatic}.

For a ranking $r$ over $A$ and a non-empty $K\subseteq A$, let $r\neg_{K\to z}$ be the ranking obtained from $r$ by replacing the highest-ranked element of $K$ with a new candidate $z$ and removing all other candidates in $K$.
 For example, if $r= (a\succ b\succ c\succ d$) and $K=\{b,d\}$, then $r \neg_{\{b,d\}\to z} = (a \succ  z \succ c)$. For a set of rankings $R$, let $R\neg_{K\to z} = \{r \neg_{K\to z}: r \in R\}$. 

\begin{restatable}{definition}{iocspf}[{\citealt[Def. 4]{Freeman14:Axiomatic}]\label{def:ioc_spf}}
An SPF $F$ is \emph{independent of clones (IoC)} if for all $\boldsymbol{\sigma}$, each non-trivial clone set $\clone$, and $a \in \clone$, we have $F(\boldsymbol{\sigma}) \neg_{\clone \to z}= F(\boldsymbol{\sigma} \setminus \{a\}) \neg_{(\clone \setminus \{a\})\to z}$.
\end{restatable}

Much like its SCF precursor, the IoC criterion for SPFs focuses on the performance of \emph{some} clone in $K$, which is not necessarily the clone that would have ranked the highest if the same SPF was applied to members of $K$ alone. Once again, we would like to strengten this property.

To the best of our knowledge, CC has not been studied for SPFs in prior work. Hence, we now introduce a natural extension of \Cref{def:oioc}. Given rankings $r$ and $r'$ over different sets, where $a$ appears in $r$, let $r(a \rightarrow r')$ be $r$ with $a$ replaced by $r'$, in order. For example, if $r= (a\succ b\succ c$) and  $r'= (d\succ e)$, then $r(b \rightarrow r')= a\succ d\succ e\succ  c$. For sets of rankings $R, R'$, and $R''$, we write $R(a\rightarrow R')= \{r(a\rightarrow r'): r \in R, r'\in R'\}$ and $R(a\rightarrow R', b\rightarrow R'')=R(a\rightarrow R')(b \rightarrow R'').$

\begin{restatable}{definition}{ccspf}[CC for SPFs] \label{def:cc_spf} 
A neutral SPF $F$ is \emph{composition-consistent (CC)} if for all $\boldsymbol{\sigma}$ and all clone decompositions $\decomp$, we have $F(\boldsymbol{\sigma}) = F(\boldsymbol{\sigma}^\decomp)(K \rightarrow F(\boldsymbol{\sigma}|_\clone)\text{ for }\clone \in \decomp)$.    
\end{restatable}

If $F$ is CC, clone sets must appear as intervals in $F(\boldsymbol{\sigma})$ in the order(s) specified by $F(\profile^\decomp)$, and the order(s) within each clone set $K$ is specified by $F(\profile|_\clone)$. Next, we show that the definition of IoC for SPFs by \citet{Freeman14:Axiomatic} and our novel definition of CC for SPFs are consistent with the ones for SCFs.
\begin{restatable}{proposition}{spfscf}\label{prop:SPFtoSCF}
    Let $f$ be the SCF that corresponds to SPF $F$, \emph{i.e.}, $f(\boldsymbol{\sigma})=\{\text{top}(r): r\in F(\boldsymbol{\sigma})\}$. If $F$ is IoC, then $f$ is IoC. If $F$ is CC, then $f$ is CC.
\end{restatable}

It is straightforward to see that the reverse of \Cref{prop:SPFtoSCF} is false: given an SCF $f$ that is CC/IoC, we can always construct an SPF that picks the top ranked candidate according to $f$, and then orders the remaining candidates according to some arbitrary order (\emph{e.g.}, by their plurality scores). Intuitively, such an SPF cannot be expected to obey \emph{any} reasonable definition of IoC/CC for SPFs. Further, there are also more ``natural'' counterexamples, as we show in \Cref{appsec:nested}.

Further, we show that the hierarchy between CC and IoC (\Cref{prop:cctoioc}) extends to SPFs.

\begin{restatable}{proposition}{spfccioc}\label{prop:cctoiocspf}
    If a given SPF is CC, then it is also IoC.
\end{restatable}



We can interpret each version of $\RP$ as an SPF outputting the topological sorting(s) of the final graph(s); \citet{Schulze10:New} shows that $\BP$, too, admits an interpretation as an SPF. Finally, we can view $\STV$ as an SPF outputting candidates in reverse order of elimination; see \Cref{appsec:spfdefs} for formal definitions. Our results generalize to each of these SPFs.

\begin{restatable}{theorem}{spftaxonomy}\label{thm:spftaxonomy}
    Each of $\{\STV, \BP, \RP, \RP_i,\RP_N\}$ satisfies IoC/CC (for all $\profile$) if and only if its SPF version does. 
\end{restatable}

While the above results are intuitive, they rely on a careful definition of CC/IoC for SPFs. For example, \citet[Appendix A]{Boehmer23:Rank} provide an alternative definition of IoC for SPFs where the bottom-ranked clone is replaced in \Cref{def:ioc_spf} rather than the top-ranked one. They show that under this alternative definition, an SPF that iteratively adds the veto winner (see our Footnote~\ref{footnote:veto}) to the ranking and deletes it from the profile would be IoC (with bottom replacement), whereas $\STV$ would not. Hence, both our Prop.~\ref{prop:SPFtoSCF} and Thm.~\ref{thm:spftaxonomy} would fail under this alternative IoC definition.

\Cref{thm:spftaxonomy} gives us a single CC SPF: $\RP_i$, which (like its SCF counterpart), fails anonymity. We next give a (to us, surprising) negative result that this weakness is inevitable.

\begin{restatable}{theorem}{anonspf}\label{thm:anonspf}
    No anonymous SPF can be CC.
\end{restatable}

\Cref{thm:anonspf} has strong implications. First, it shows that to design CC SPFs, a non-anonymous tie-breaker (such as the one by \citet{Zavist89:Complete} for $RP_i$) is not only sufficient but necessary. Indeed, in \Cref{appsec:nested}, we design a novel CC SPF that uses a similar tie-breaking rule, inspired by a nested version of $\STV$ introduced by \citet{Freeman14:Axiomatic}. Second, it shows that in settings where anonymity is a must and ties are likely to occur, CC is too demanding for SPFs, and motivates studying its relaxations. For example, as mentioned in \Cref{subsec:pqtrees}, the Kemeny SPF (which returns the ranking(s) with the minimum total Kendall-Tau distance to voters' rankings) obeys a weaker form of CC, which requires $F(\profile)$ and $F(\boldsymbol{\sigma}^\decomp)(K \rightarrow F(\boldsymbol{\sigma}|_\clone)\text{ for }\clone \in \decomp)$ to have a nonempty intersection under certain decompositions (where the summary is single-peaked or single-crossing), rather than being equal for all decompositions~\citep{Cornaz13:Kemeny}. Since Kemeny is not IoC as an SCF~\citep{Tideman87:Independence}, this relaxation is incomparable with IoC for SPFs by our \Cref{prop:SPFtoSCF}. 

We also observe that the impossibility in \Cref{thm:anonspf} can be circumvented if $|\voter|$ is assumed to be odd. In this regime, for a neutral SPF $F$, we can define $F^{CC}$ analogously to \Cref{def:cc-transform} to obtain CC (by forcing Q-nodes to output their majority ranking). We leave formalizing this transformation and identifying which SPF-specific axioms (\emph{e.g.}, independence of the last-ranked alternatives) are preserved by $F^{CC}$ for future work.


