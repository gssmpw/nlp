\begin{comment}

\documentclass{article}
\usepackage{listings}
\usepackage{xcolor}

% Define custom style for Python code
\lstdefinestyle{PythonStyle}{
    language=Python,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue},
    commentstyle=\color{green},
    stringstyle=\color{red},
    breaklines=true,
    frame=single
}

% Define custom style for JSON
\lstdefinestyle{JSONStyle}{
    language=Java,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue},
    stringstyle=\color{red},
    breaklines=true,
    frame=single
}

%\begin{document}
\end{comment}

\section{P5\&8: Wedding Logistics Problem Sample Implementation With and Without Update}

This appendix presents an implementation of the P5 and P8: Wedding Logistics Problem Without and With Disruption using LangGraph~\cite{langgraph2024}. 
\subsection{Prompt and Collaborative Agent Pipeline}

\begin{lstlisting}[style=PythonStyle, caption=Prompt and Collaborative Agent Pipeline, label=lst:agent_pipeline]
with Crew() as crew:
    # ---- Locations and Time Setup Agent ---- #
    LT_Agent = Agent(
        name="Locations and Time Setup Agent",
        backstory="You define locations, travel times, and guest arrival schedules.",
        task_description="Set up locations, travel times, and ensure accurate scheduling of arrivals.",
        task_expected_output="Structured location data and expected arrival times. Fourlocations:V ={B,G,T,W},where B isBostonAir- port, G is Gift shop, T is Tailor shop, and W is Wedding venue. B-G : 45, B-T : 30, B-W : 40, G-T : 20, G-W : 25, T-W : 15. - Alex:At B at11:00AMfromChicago(needaride) - Jamie:At B at12:30PMfromAtlanta(needaride) - Pat: At W at 12:00 PM driving from NYC (has 5-seater car)"
    )
    
    # ---- Task Setup Agent ---- #
    TS_Agent = Agent(
        name="Task Setup Agent",
        backstory="You manage the scheduling of required wedding tasks.",
        task_description="Schedule gift collection after 12:00 PM, clothes pickup before 2:00 PM, and ensure photo session at 3:00 PM.",
        task_expected_output="Optimized task schedule aligned with constraints."
    )

    # ---- Disruption Update Agent (With Disruption) ---- #
    DU_Agent = Agent(
        name="Disruption Update Agent",
        backstory="You monitor road closures and dynamically reroute transportation as needed.",
        task_description="Identify any road closures or unexpected disruptions and adjust travel plans accordingly.",
        task_expected_output="In case there is road closures of B to G, and dynamically reroute transportation. Updated task schedule, ensuring minimal delays and timely arrivals with new updates."
    )
    
    # ---- Resource Management Agent ---- #
    RM_Agent = Agent(
        name="Resource Management Agent",
        backstory="You allocate available transport resources efficiently.",
        task_description="Coordinate 5 vehicle usage and Local friend Chris(5-seater)available, for guest transportation and task fulfillment.",
        task_expected_output="Optimized 5 vehicle allocation and friend welcome ensuring timely arrivals. - Onecar(5-seater)withPat,availableafterheisBoston - LocalfriendChris(5-seater)availableafter1:30PM at W"
    )
    
    # ---- Constraint Validation Agent ---- #
    CV_Agent = Agent(
        name="Constraint Validation Agent",
        backstory="You verify all scheduling constraints to ensure smooth execution.",
        task_description="Ensure all tasks are completed within operating hours and vehicle constraints are met.",
        task_expected_output="Validated schedule with no conflicts. All tasks must complete before 3:00 PM photo time - Gift store opens at 12:00 PM - Tailor closes at 2:00 PM - Two cars must accommodate all transport needs"
    )

    # ---- Supervisor Agent ---- #
    WEO_Agent = Agent(
        name="Wedding Event Oversight Agent",
        backstory="You oversee the entire wedding logistics to ensure a smooth execution of tasks.",
        task_description="Monitor and ensure all tasks are completed on time, resolving any logistical issues.",
        task_expected_output="Give a wedding scheduling plan for people, task and time."
    )

    Writer_agent = Agent(
        name="Writer Agent",
        backstory="You are a language model specialised in writing text into .json files",
        task_description="Write the json response into './p5_output.json'",
        task_expected_output="A .json file containing the given string",
        tools=write_str_to_txt,
    )
    
    # ---- Define Dependencies (Without Disruption) ---- #
    LT_Agent >> TS_Agent >> RM_Agent >> CV_Agent >> WEO_Agent >> Writer_agent

    # ---- Define Dependencies (WithDisruption)---- #
    LT_Agent >> TS_Agent >> DU_Agent >> RM_Agent >> CV_Agent >> WEO_Agent >> Writer_agent



\end{lstlisting}

\subsection{Meta Plan}
\textbf{Without Real-time Search (Without Disruption):}
\begin{lstlisting}[style=JSONStyle, caption=Sample JSON Output from Agent Pipeline, label=lst:data_collection]
==================================================
RUNNING AGENT: Locations and Time Setup Agent
==================================================

```json
{
  "locations": {
    "B": "Boston Airport",
    "G": "Gift shop",
    "T": "Tailor shop",
    "W": "Wedding venue"
  },
  "travel_times": {
    "B-G": 45,
    "B-T": 30,
    "B-W": 40,
    "G-T": 20,
    "G-W": 25,
    "T-W": 15
  },
  "guest_arrivals": [
    {
      "name": "Alex",
      "location": "B",
      "arrival_time": "11:00 AM",
      "origin": "Chicago",
      "needs_ride": true
    },
    {
      "name": "Jamie",
      "location": "B",
      "arrival_time": "12:30 PM",
      "origin": "Atlanta",
      "needs_ride": true
    },
    {
      "name": "Pat",
      "location": "W",
      "arrival_time": "12:00 PM",
      "origin": "NYC",
      "has_car": true,
      "car_capacity": 5
    }
  ]
}
```

==================================================
RUNNING AGENT: Task Setup Agent
==================================================

To create an optimized task schedule aligned with the given constraints and context, we need to consider the travel times between locations and the guest arrivals. Here's the proposed schedule:

1. **11:00 AM - Pick up Alex at Boston Airport (B):**
   - Alex arrives at 11:00 AM and needs a ride. Since the gift collection is scheduled after 12:00 PM, we can pick up Alex first.

2. **12:00 PM - Drop off Alex at the Wedding Venue (W):**
   - Travel time from Boston Airport (B) to Wedding Venue (W) is 40 minutes. Depart at 11:20 AM to arrive by 12:00 PM.

3. **12:30 PM - Pick up Jamie at Boston Airport (B):**
   - Jamie arrives at 12:30 PM and needs a ride. After dropping off Alex, return to Boston Airport (B) to pick up Jamie.

4. **1:00 PM - Gift Collection at Gift Shop (G):**
   - Travel time from Boston Airport (B) to Gift Shop (G) is 45 minutes. Depart at 12:35 PM after picking up Jamie to arrive by 1:20 PM. However, since we need to ensure clothes pickup before 2:00 PM, we should prioritize clothes pickup first.

5. **1:20 PM - Clothes Pickup at Tailor Shop (T):**
   - Travel time from Boston Airport (B) to Tailor Shop (T) is 30 minutes. Depart at 12:35 PM after picking up Jamie to arrive by 1:05 PM. This ensures clothes pickup is completed before 2:00 PM.

6. **1:40 PM - Gift Collection at Gift Shop (G):**
   - After picking up clothes, travel from Tailor Shop (T) to Gift Shop (G), which takes 20 minutes. Depart at 1:20 PM to arrive by 1:40 PM.

7. **2:05 PM - Drop off Jamie at Wedding Venue (W):**
   - Travel time from Gift Shop (G) to Wedding Venue (W) is 25 minutes. Depart at 1:40 PM to arrive by 2:05 PM.

8. **3:00 PM - Photo Session at Wedding Venue (W):**
   - Ensure arrival at the Wedding Venue by 3:00 PM for the photo session.

This schedule respects all constraints and ensures timely completion of all tasks.

==================================================
RUNNING AGENT: Resource Management Agent
==================================================

Optimized 5 vehicle allocation and friend welcome ensuring timely arrivals:

- **Onecar (5-seater) with Pat, available after he is in Boston:**
  - Pat will handle the initial transportation tasks, including picking up Alex and Jamie from Boston Airport and ensuring timely drop-offs at the Wedding Venue.

- **Local friend Chris (5-seater) available after 1:30 PM at Wedding Venue (W):**
  - Chris will be available to assist with any additional transportation needs after 1:30 PM, ensuring flexibility and support for any last-minute requirements or changes in the schedule.

==================================================
RUNNING AGENT: Constraint Validation Agent
==================================================

To ensure all tasks are completed within operating hours and vehicle constraints are met, we need to validate the schedule as follows:

1. **Task Completion Before 3:00 PM Photo Time:**
   - All tasks must be scheduled to finish before 3:00 PM to ensure everyone is ready for the photo session.

2. **Gift Store and Tailor Operating Hours:**
   - The gift store opens at 12:00 PM, so any tasks involving the gift store should be scheduled after this time.
   - The tailor closes at 2:00 PM, so any tasks involving the tailor must be completed before this time.

3. **Vehicle Allocation and Transport Needs:**
   - **Onecar (5-seater) with Pat:** Available after Pat arrives in Boston. Pat will manage initial transportation, including picking up Alex and Jamie from Boston Airport and dropping them off at the Wedding Venue.
   - **Local friend Chris (5-seater):** Available after 1:30 PM at the Wedding Venue to assist with any additional transportation needs.

**Validated Schedule:**

- **9:00 AM - 11:00 AM:** Pat picks up Alex and Jamie from Boston Airport and drops them off at the Wedding Venue.
- **12:00 PM - 1:00 PM:** Visit the gift store after it opens.
- **1:00 PM - 2:00 PM:** Complete any tasks involving the tailor before it closes.
- **1:30 PM onwards:** Chris is available for any additional transportation needs, ensuring flexibility for last-minute changes.
- **All tasks must be completed by 3:00 PM** to ensure readiness for the photo session.

This schedule ensures that all tasks are completed within the specified operating hours and vehicle constraints, with no conflicts.

==================================================
RUNNING AGENT: Wedding Event Oversight Agent
==================================================

To ensure a seamless wedding day, here is the detailed scheduling plan for people, tasks, and time:

**Wedding Day Schedule:**

- **9:00 AM - 11:00 AM:**
  - **Task:** Transportation from Boston Airport
  - **People Involved:** Pat, Alex, Jamie
  - **Details:** Pat will pick up Alex and Jamie from Boston Airport and transport them to the Wedding Venue.

- **12:00 PM - 1:00 PM:**
  - **Task:** Visit the Gift Store
  - **People Involved:** Any designated person responsible for gifts
  - **Details:** Tasks involving the gift store should be scheduled after it opens at 12:00 PM.

- **1:00 PM - 2:00 PM:**
  - **Task:** Tailor Visit
  - **People Involved:** Any person needing tailoring services
  - **Details:** Complete any tasks involving the tailor before it closes at 2:00 PM.

- **1:30 PM onwards:**
  - **Task:** Additional Transportation Needs
  - **People Involved:** Chris
  - **Details:** Chris is available at the Wedding Venue to assist with any additional transportation needs, ensuring flexibility for last-minute changes.

- **3:00 PM:**
  - **Task:** Photo Session
  - **People Involved:** All wedding party members
  - **Details:** Ensure all tasks are completed and everyone is ready for the photo session by 3:00 PM.

This schedule ensures that all logistical tasks are completed efficiently within the specified time constraints, allowing for a smooth transition into the wedding festivities.

==================================================
RUNNING AGENT: Writer Agent
==================================================


Thought: I need to write the given wedding day schedule context into a JSON file named './p5_output.json'.

Using Tool: write_str_to_txt

Tool call dict: 
{'name': 'write_str_to_txt', 'arguments': {'string_data': 'To ensure a seamless wedding day, here is the detailed scheduling plan for people, tasks, and time:\n\n**Wedding Day Schedule:**\n\n- **9:00 AM - 11:00 AM:**\n  - **Task:** Transportation from Boston Airport\n  - **People Involved:** Pat, Alex, Jamie\n  - **Details:** Pat will pick up Alex and Jamie from Boston Airport and transport them to the Wedding Venue.\n\n- **12:00 PM - 1:00 PM:**\n  - **Task:** Visit the Gift Store\n  - **People Involved:** Any designated person responsible for gifts\n  - **Details:** Tasks involving the gift store should be scheduled after it opens at 12:00 PM.\n\n- **1:00 PM - 2:00 PM:**\n  - **Task:** Tailor Visit\n  - **People Involved:** Any person needing tailoring services\n  - **Details:** Complete any tasks involving the tailor before it closes at 2:00 PM.\n\n- **1:30 PM onwards:**\n  - **Task:** Additional Transportation Needs\n  - **People Involved:** Chris\n  - **Details:** Chris is available at the Wedding Venue to assist with any additional transportation needs, ensuring flexibility for last-minute changes.\n\n- **3:00 PM:**\n  - **Task:** Photo Session\n  - **People Involved:** All wedding party members\n  - **Details:** Ensure all tasks are completed and everyone is ready for the photo session by 3:00 PM.\n\nThis schedule ensures that all logistical tasks are completed efficiently within the specified time constraints, allowing for a smooth transition into the wedding festivities.', 'txt_filename': './p5_output.json'}, 'id': 0}
Data successfully written to ./p5_output.json

Tool result: 
None

Observations: {0: None}
The wedding day schedule has been successfully written to './p5_output.json'.

\end{lstlisting}

\textbf{Without Real-time Search (With Disruption):}
\begin{lstlisting}[style=JSONStyle, caption=Sample JSON Output from Agent Pipeline, label=lst:data_collection]
==================================================
RUNNING AGENT: Disruption Update Agent
==================================================

<updated_schedule>
  <task name="Clothes Pickup" location="T" time="1:00 PM" details="Ensure clothes are picked up before 2:00 PM."/>
  <task name="Gift Collection" location="G" time="2:15 PM" details="Schedule after 12:00 PM, considering travel time from Tailor shop."/>
  <task name="Photo Session" location="W" time="3:00 PM" details="Ensure timely arrival for the photo session."/>
  <guest_transportation>
    <guest name="Alex" pickup_location="B" pickup_time="11:00 AM" destination="W" details="Needs ride to the wedding venue." reroute="Yes" new_route="B -> T -> W"/>
    <guest name="Jamie" pickup_location="B" pickup_time="12:30 PM" destination="W" details="Needs ride to the wedding venue." reroute="Yes" new_route="B -> T -> W"/>
    <guest name="Pat" location="W" time="12:00 PM" details="Can assist with guest transportation if needed."/>
  </guest_transportation>
</updated_schedule>

<reroute_details>
  Due to road closures from B to G, Alex and Jamie will be rerouted through location T to reach their destination at W. This ensures minimal delays and timely arrivals for all tasks and guest transportation.
</reroute_details>
\end{lstlisting}

%\end{document}
