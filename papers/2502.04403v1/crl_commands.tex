% Abbreviations.
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\ms}[1]{\mathscr{#1}}
\newcommand{\mb}[1]{\mathbbm{#1}}
\newcommand{\mr}[1]{\mathrm{#1}}
\newcommand{\eps}{\varepsilon}
\newcommand{\indic}{\mathbbm{1}}
\newcommand{\bE}{\sm{1.2}{\mathbb{E}}}
\newcommand{\longra}{\longrightarrow}
\newcommand{\longla}{\longleftarrow}
\newcommand{\ra}{\rightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\N}{\mb{N}}
\newcommand{\Z}{\mb{Z}}
\newcommand{\Q}{\mb{Q}}
\newcommand{\R}{\mb{R}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\sH}{\mathbb{H}}
\newcommand{\entropy}{\sH}
\def\vmin{\mr{v}_{\mr{min}}}
\def\vmax{\mr{v}_{\mr{max}}}
\def\rmin{\mr{r}_{\mr{min}}}
\def\rmax{\mr{r}_{\mr{max}}}
\def\defi{\stackrel{\mr{def}}{=}}
\def\powerset{\mathscr{P}}

% \newcommand*{\defeq}{\stackrel{\text{def}}{=}}


% Small math
\newcommand\sm[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}
%Example: \sm{0.2}{\mc{X}}


% argmin, argmax.
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\xargmax}{x\,arg\,max}

% ----------------------------
% -- Plasticity / Stability --
% ----------------------------
\def\ds{\psi}
\def\plast{\ds_{\mr{p}}}
\def\stab{\ds_{\mr{s}}}
\def\crstab{\ds_{\mr{cr}\text{-}\mr{s}}}
\def\krstab{\ds_{\mr{kr}\text{-}\mr{s}}}


% ----------------------
% -- NERL Definitions --
% ----------------------

% Environments.
\def\environment{e}
\def\env{\environment}
\def\allenvironments{{\mc{E}_{\mr{all}}}}
\def\allenvs{\allenvironments}
\def\environments{{\mc{E}}}
\def\envs{\environments}

% Actions, Observations, States
\def\actions{\mc{A}}
\def\observations{\mc{O}}
\def\states{\mc{S}}
\def\smallstates{\sm{0.5}{\mc{S}}}

% Agents.
%\def\agent{\overset{\sm{0.6}{\mapsto}}{\lambda}}
\def\agent{\lambda}%f_{\lambda}}%
\def\agents{\Lambda}%\mc{F}_\lambda}%
\def\boundedagent{\tilde{\agent}} %widebridgeabove
\def\boundedagents{\tilde{\agents}}
\def\allboundedagents{\tilde{\allagents}}


% Agents.
\def\agentf{{\vec{\agent}}}
\def\agentfset{\agents}%f_{\lambda}}%
\def\allagents{\mathbbl{\agents}}
\def\psetagents{\agents^\circ}
\def\psetallagents{\mathbbl{\agents}^\circ}
% Agent Basis.
\def\agentb{\agent_{\mr{B}}} 
\def\agentsb{\agents_{\mr{B}}}
\def\agentbasis{\agentb} 
\def\agentsbasis{\agentsb}
\def\boundagentsbasis{\agents_{\mr{B},n}}
\def\bases{\agentsb^\circ}
\def\agentfix{\agentb} 
\def\agentsfix{\agentsb}

% Rep hypothesis.
\def\rep{\mc{X}}
% \def\fup{\learnrule_{\mc{X}}}
\def\fup{f_{\mr{up}}}
\def\frep{f_{\mr{rep}}}
\def\fin{g}
\def\g{\fin}
\def\cons{\cong} %\equiv}
%
% Reaches.
%
%\def\reaches{\rightsquigarrow}
% Reaches variant with "env" on top.
\newcommand\reaches{%
  \mathrel{\ooalign{\hss$\rightsquigarrow$\hss\kern-1.45ex\raise1.0ex\hbox{{\scaleobj{0.55}{\env}}}\hspace{4pt}}}}
%\def\reaches{\rightsquigarrow}
%\def\notreaches{\not \rightsquigarrow}
% Centered "not" for use in never eaches.
\newcommand\cnot[1]{%
  \mathrel{\ooalign{\hfil$#1$\hfil\cr\hfil$/$\hfil\cr}}}
% Not reaches.
\newcommand\notreaches{%
  \mathrel{\ooalign{\hss$\cnot\rightsquigarrow$\hss\kern-1.45ex\raise1.0ex\hbox{{\scaleobj{0.55}{\env}}}\hspace{4pt}}}}
\def\canreach{\rightsquigarrow}
% CMU SERIF
% \newcommand\alwaysreach{%
%     \mathrel{\ooalign{\hss$\square$\hss\kern-0.26ex\hbox{{$\reaches$}}}}}
% PALATINO:
\newcommand\alwaysreach{%
  \mathrel{\ooalign{\hss$\square$\hss\kern-0.22ex\hbox{{$\reaches$}}}}}
\def\alwaysreaches{\alwaysreach}
%
% Generates.
%
%\def\generates{\vdash}
% Env generates: \vdash with an e on top.
% CMU
% \newcommand\generates{%
%   \mathrel{\ooalign{\hss$\vdash$\hss\kern-0.85ex\raise1.0ex\hbox{{\scaleobj{0.55}{\env}}}}}}
% PALATINO
\newcommand\generates{%
 \mathrel{\ooalign{\hss$\vdash$\hss\kern-0.65ex\raise0.9ex\hbox{{\scaleobj{0.55}{\env}}}}}}
\def\unifgenerates{\models}
%\def\unifgenerates{\vdash}

% Learning rules.
\def\learnrule{\sigma}
\def\lrule{\learnrule}
\def\lr{\learnrule}
\def\vlearnrule{\check{\sigma}}
\def\learnrules{\Sigma}
\def\lrs{\learnrules}
\def\markovlr{\sigma_{\mr{m}}}
\def\markovlrs{\Sigma_{\mr{m}}}
\def\alllearnrules{\mathbbl{\Sigma}}
\def\mblearnrule{\learnrule}%_{\mr{mb}}}
\def\mblearnrules{\learnrules}%_{\mr{mb}}}
\def\allmblearnrules{\alllearnrules}%_{\mr{mb}}}
\def\agentsplan{\agentsfix}%_{\mr{plan}}}
\def\agentspace{\mathscr{A}}
\def\aspace{\agentspace}

% Agent set functions.
\def\rank{\mr{rank}}


% Agent operations
\def\decomp{\dashv}
% \leadsto,\rightsquigarrow, \Rrightarrow, \Leftrightarrow, \triplesim, \hcrossing, \models, \cong, \hateq, \vdash

% Agent state.
\def\states{\mc{S}} % Agent state.
\def\learnf{u}
\def\learnfset{\mc{U}}

% Agent-state policy.
\def\apolicy{\pi} % Agent state.
\def\apolicyset{\Pi} % Agent state.
\newcommand{\apolicyss}[1]{\apolicy_{#1}}


% Rewards and Values.
%defining script r
\usepackage{calligra}
\DeclareMathAlphabet{\mathcalligra}{T1}{calligra}{m}{n}
\def\valuef{v}

% Histories
\def\histories{\mc{H}}
\def\rhistories{\bar{\histories}}
\def\rsuffhistories{\acute{\histories}}
\def\realizablehist{\rhistories}
\def\realizablehistabbr{\overline{\histories}}
\def\historiesastate{\histories^\circ}
%\def\prefixhistories{\histories^{\centernot{h} \circ}}
\def\prefixhistories{\histories^{h:\circ}}
\def\coprefixhistories{\overline{\prefixhistories}}

%
\def\convergef{c}

% Plasticity
\def\plasticityf{\mu}
\def\plasticitydistr{\mc{M}_{\agent}}
\def\plasticitydistrfull{\mc{M}_{\agent}(\mc{E}^\diamond \mid h_\rewardf)}

% Capacity
\def\capacityf{c}

% --- Other Misc. Commands ---

% Def eq.
%\def{\defeq}{\overset{\sm{0.5}{\text{def}}}{=}}
\newcommand*{\defeq}{\stackrel{\sm{0.6}{\mathrm{def}}}{=}}

% Put a fancy box around things.
\newcommand{\dbox}[1]{
\begin{mdframed}%[roundcorner=0pt]
\vspace{1mm}
{#1}
\end{mdframed}
}

% Theorems.
\newtheorem{theorem}{Theorem}
\newtheorem{axiom}{Axiom}
\newtheorem{claim}{Claim}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{axiom*}{Axiom}
\newtheorem{fact}{Fact}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}{Definition}
\newtheorem*{definition*}{Definition}
\newtheorem{desiderata}{Desiderata}
\newtheorem{assumption}{Assumption}
\newtheorem{conjecture}{Conjecture}

% Theorem numbers.
\numberwithin{equation}{section}
\numberwithin{theorem}{section}
\numberwithin{definition}{section}
%\numberwithin{remark}{section}
\numberwithin{conjecture}{section}
%\numberwithin{corollary}{section}
%\numberwithin{proposition}{section}

%\numberwithin{lemma}{section}



% Inner environment for Proofs
\newmdenv[
  topline=false,
  bottomline=false,
  rightline = false,
  leftmargin=8pt,
  rightmargin=0pt,
  skipabove=16pt, % top margin
  innertopmargin=0pt,
  innerbottommargin=0pt
]{innerproof}

% Proof Command
\newenvironment{dproof}[1][Proof]{\begin{proof}[\textbf{\textit{Proof of #1.}}] \text{\vspace{1mm}} \begin{innerproof}}{\end{innerproof}\end{proof}\vspace{1mm}}

% Proof Command
\newenvironment{sproof}[1][Proof]{\begin{proof}[\textbf{\textit{Proof Sketch of #1.}}] \text{\vspace{2mm}} \begin{innerproof}}{\end{innerproof}\end{proof}}

\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\def\theoremautorefname{Theorem}
\def\claimautorefname{Claim}
\def\conjectureautorefname{Conjecture}
\def\remarkautorefname{Remark}
\def\factautorefname{Fact}
\def\propositionautorefname{Proposition}
\def\corollaryautorefname{Corollary}
\def\equationautorefname{Equation}
\def\algorithmautorefname{Algorithm}
\def\definitionautorefname{Definition}
\def\chapterautorefname{Chapter}
\def\partautorefname{Part}
\def\tableautorefname{Table}
\def\figureautorefname{Figure}
\def\subfloatautorefname{Figure}
\def\subfigureautorefname{Figure}
\def\lemmaautorefname{Lemma}
\def\sectionautorefname{Section}
\def\assumptionautorefname{Assumption}
\def\claimautorefname{Claim}




% make citet clickable
\usepackage{etoolbox}
\makeatletter
\patchcmd{\NAT@test}{\else \NAT@nm}{\else \NAT@hyper@{\NAT@nm}}{}{}
\makeatother


% Appendix commands
\newtheorem{innercustomthm}{Theorem}
\newenvironment{customthm}[1]
  {\renewcommand\theinnercustomthm{#1}\innercustomthm}
  {\endinnercustomthm}
% Remark
\newtheorem{innercustomrem}{Remark}
\newenvironment{customrem}[1]
  {\renewcommand\theinnercustomrem{#1}\innercustomrem}
  {\endinnercustomrem}
% Corollary
\newtheorem{innercustomcor}{Corollary}
\newenvironment{customcor}[1]
  {\renewcommand\theinnercustomcor{#1}\innercustomcor}
  {\endinnercustomcor}
% Proposition
\newtheorem{innercustomprop}{Proposition}
\newenvironment{customprop}[1]
  {\renewcommand\theinnercustomprop{#1}\innercustomprop}
  {\endinnercustomprop}
% Fact
\newtheorem{innercustomfact}{Fact}
\newenvironment{customfact}[1]
  {\renewcommand\theinnercustomfact{#1}\innercustomfact}
  {\endinnercustomfact}
% Lemma
\newtheorem{innercustomlem}{Lemma}
\newenvironment{customlem}[1]
  {\renewcommand\theinnercustomlem{#1}\innercustomlem}
  {\endinnercustomlem}
% Axiom
\newtheorem{innercustomaxiom}{Axiom}
\newenvironment{customaxiom}[1]
  {\renewcommand\theinnercustomaxiom{#1}\innercustomaxiom}
  {\endinnercustomthm}
  
% Autoref custom numbered remarks/theorems.
\def\innercustomthmautorefname{Theorem}
\def\innercustomfactautorefname{Fact}
\def\innercustomlemautorefname{Lemma}
\def\innercustomremautorefname{Remark}
\def\innercustomcorautorefname{Corollary}
\def\innercustompropautorefname{Proposition}
\def\innercustomaxiomautorefname{Axiom}

% Add an hrule with some space
\newcommand{\spacerule}{\begin{center}\hdashrule{2cm}{1pt}{1pt}\end{center}}

\def\qspace{\hspace{2mm}}
\def\espace{\hspace{8mm}}


% Circled numbers.
\usepackage{tikz}
\newcommand*\circled[1]{{\scriptsize \tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}}
            
            
% Notes and todos.
\newcommand{\dnote}[1]{{\normalfont \textcolor{purple}{Dave: #1}}}
\newcommand{\clare}[1]{{\textcolor{blue}{Clare: #1}}}
\usepackage[textsize=tiny]{todonotes}


\newcommand{\creflink}[1]{\hyperref[#1]{\textcolor{blue}{\cref{#1}}}}
\newcommand{\linkcitet}[1]{\creflink{#1} \citeauthor{#1}, (\citeyear{#1})}

% No page breaks.
\newenvironment{absolutelynopagebreak}
  {\par\nobreak\vfil\penalty0\vfilneg
   \vtop\bgroup}
  {\par\xdef\tpd{\the\prevdepth}\egroup
   \prevdepth=\tpd}

\newcommand{\ci}{\perp\kern-5pt\perp}


% Notes
\newcommand{\dave}[1]{\textcolor{purple}{#1}}