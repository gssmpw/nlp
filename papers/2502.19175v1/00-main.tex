% This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended.
\pdfoutput=1
% In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines.

\documentclass[11pt]{article}

% Change "review" to "final" to generate the final (sometimes called camera-ready) version.
% Change to "preprint" to generate a non-anonymous version with page numbers.
%\usepackage[review]{acl}
\usepackage[]{acl}

% Standard package includes
\usepackage{times}
\usepackage{latexsym}

% For proper rendering and hyphenation of words containing Latin characters (including in bib files)
\usepackage[T1]{fontenc}

% For Vietnamese characters
% \usepackage[T5]{fontenc}
% See https://www.latex-project.org/help/documentation/encguide.pdf for other character sets

% This assumes your files are encoded as UTF8
\usepackage[utf8]{inputenc}

% This is not strictly necessary, and may be commented out,
% but it will improve the layout of the manuscript,
% and will typically save some space.
\usepackage{microtype}

% This is also not strictly necessary, and may be commented out.
% However, it will improve the aesthetics of text in
% the typewriter font.
\usepackage{inconsolata}
\usepackage{dsfont}
\usepackage{amsmath}

%Including images in your LaTeX document requires adding
%additional package(s)
\usepackage{graphicx}
\usepackage{amssymb}

% If the title and author information does not fit in the area allocated, uncomment the following
%
\setlength\titlebox{6cm}
%
% and set <dim> to something 5cm or larger.

%Extra packages
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage{subcaption}
\definecolor{lightblue}{RGB}{0,127,255}
\definecolor{yellow-history}{RGB}{234,216,91}
\definecolor{green-diagnosis}{RGB}{86, 181, 170}
\definecolor{blue-retrieval}{RGB}{116, 167, 226}
\newcommand{\danny}[1]{\textbf{\small {\color{lightblue}[Danny: #1]}}}
\newcommand{\cc}[1]{\textbf{\small {\color{teal}[ChiaChien: #1]}}}
\newcommand{\marco}[1]{\textbf{\small {\color{purple}[Marco: #1]}}}
\newcommand{\cl}[1]{\textbf{\small {\color{red}[CL: #1]}}}
\newcommand{\isra}[1]{\textcolor{black!55!red}{Israa: #1}}
\def\sectionautorefname{ยง}
\def\subsectionautorefname{ยง}
\usepackage{enumitem}

\usepackage[most]{tcolorbox}

% Define a custom box style for AI prompts
% Define a custom style for system prompts


\newtcolorbox{prompt}[2][]{
    colback=black!3,
    colframe=black,
    boxrule=0.5pt,
    left=8pt,
    right=8pt,
    top=8pt,
    bottom=8pt,
    arc=2pt,
    breakable,
    enhanced,
    before skip=10pt,
    after skip=10pt,
    title={#2}, % Title argument
    #1 % Allows passing additional optional arguments
}

\newtcolorbox{example}[2][]{
    colback=black!3,
    colframe=black!20,
    boxrule=0.5pt,
    left=8pt,
    right=8pt,
    top=8pt,
    bottom=8pt,
    arc=2pt,
    breakable,
    enhanced,
    before skip=10pt,
    after skip=10pt,
    coltitle=black,
    title={#2}, % Title argument
    #1 % Allows passing additional optional arguments
}

% \title{DDxDriver: A Unified Modular Agent Framework for\\ Explainable Automatic Differential Diagnosis}
\title{MEDDxAgent: A Unified Modular Agent Framework for\\ Explainable Automatic Differential Diagnosis}


\author{Daniel Rose\textsuperscript{1}, Chia-Chien Hung\textsuperscript{2}, Marco Lepri\textsuperscript{2}, \\
\textbf{Israa Alqassem\textsuperscript{2}}, \textbf{Kiril Gashteovski\textsuperscript{2, 3}} and \textbf{Carolin Lawrence\textsuperscript{2}} \\
\textsuperscript{1}University of California, Santa Barbara \\
\textsuperscript{2}NEC Laboratories Europe, Heidelberg, Germany\\
\textsuperscript{3}CAIR, Ss. Cyril and Methodius University of Skopje, North Macedonia \\
  \texttt{danielrose@ucsb.edu}\\
  \texttt{\{Chia-Chien.Hung, Marco.Lepri,} \\
  \texttt{Israa.Alqassem, Kiril.Gashteovski, Carolin.Lawrence\}@neclab.eu}\\
  }
  

\begin{document}
\maketitle
\begin{abstract}

Differential Diagnosis (DDx) is a fundamental yet complex aspect of clinical decision-making, in which physicians iteratively refine a ranked list of possible diseases based on symptoms, antecedents, and medical knowledge. While recent advances in large language models have shown promise in supporting DDx, existing approaches face key limitations, including single-dataset evaluations, isolated optimization of components, unrealistic assumptions about complete patient profiles, and single-attempt diagnosis. We introduce a \textbf{M}odular \textbf{E}xplainable \textbf{DDx} \textbf{Agent} (\textbf{MEDDxAgent}) framework designed for interactive DDx, where diagnostic reasoning evolves through \textit{iterative learning}, rather than assuming a complete patient profile is accessible. MEDDxAgent integrates three modular components: (1) an orchestrator (DDxDriver), (2) a history taking simulator, and (3) two specialized agents for knowledge retrieval and diagnosis strategy. To ensure robust evaluation, we introduce a comprehensive DDx benchmark covering respiratory, skin, and rare diseases.  We analyze single-turn diagnostic approaches and demonstrate the importance of iterative refinement when patient profiles are not available at the outset. Our broad evaluation demonstrates that MEDDxAgent achieves over 10\% accuracy improvements in interactive DDx across both large and small LLMs, while offering critical explainability into its diagnostic reasoning process.  


\end{abstract}


% \isra{Highlight main selling points, e.g., Our agentic framework is modular, allowing seamless integration of different agents based on specific needs. Its primary advantage lies in its ability to iteratively refine diagnoses over time, adapting to new information. Additionally, it operates in a realistic setting, effectively handling missing or incomplete data. The framework is designed to address various disease including rare ones and has been benchmarked across multiple datasets under various settings, demonstrating its robustness and adaptability.}

\section{Introduction}
\input{01-introduction}
\section{MEDDxAgent Overview}
\input{02-methodology}

\section{Experimental Setup}
\input{03-experiments}
\section{Evaluation Results}
\input{04-results}
\section{Analysis}
\input{05-analysis}
\section{Related Work}
\input{06-related}
\section{Conclusions}
\input{07-conclusion}

\section*{Limitations}
While our proposed MEDDxAgent framework advances the task of automatic differential diagnosis through a modular, explainable, and interactive approach, we acknowledge certain limitations. (1) Model Selection: Our evaluation focuses on Llama models (8B and 70B) and GPT-4o. These models demonstrate strong instruction-following capabilities, so findings may not generalize to all LLM architectures. We also evaluate state-of-the-art medical-domain LLMs~\citep{zhang2024ultramedical} but find that this instruction-tuned model underperforms the general-purpose LLMs (e.g., Llama3.1~\citep{dubey2024llama}), likely due to diverse instruction-following behavior. Further exploration is needed for models with different architectures, training paradigms, or domain adaptations. (2) Language Coverage: our framework is evaluated primarily on an English DDx benchmark, limiting its applicability to non-English-speaking regions, where medical terminology, case presentations, and healthcare practices may differ significantly. Extending the framework for multilingual and cross-lingual diagnostic tasks remains an important direction \cite{qiu2024towards, garcia-ferrero-etal-2024-medmt5}. (3) Multimodality: Medical information often relies on multimodal data, such as medical imaging and videos, laboratory tests, electronic health records, and genomic/pathology data. Our DDx Benchmark is soley text-based, which limits the scope of its applicability to clinical decision making. Future work should explore multimodal agentic frameworks \cite{schmidgall2024agentclinic, kim2024mdagents} and reasoning over multimodal sequential data \cite{rose2023visual, himakunthala-etal-2023-lets, zhu2024emerge}. (4) Benchmark Dataset Selection: We introduce a DDx benchmark encompassing respiratory, skin, and rare diseases. Though our benchmark offers greater diversity than prior work, it does not cover all medical specialties or real-world patient distributions. Expanding datasets to reflect a wider range of diseases, demographics, and clinical settings would improve generalizability.

Despite these limitations, we hope this work contributes to advancing automatic DDx with a challenging yet realistic setup -- interactive differential diagnosis. We hope that future research builds on top of our findings to include more languages, modalities, datasets, and a deeper exploration of diagnostic processes to enhance the applicability and effectiveness of interactive diagnostic models.


%\section*{Acknowledgments}


% Bibliography entries for the entire Anthology, followed by custom entries
%\bibliography{anthology,custom}
% Custom bibliography entries only
%\newpage
\bibliography{custom}

\appendix
\clearpage
\onecolumn
\input{99-appendix}

\end{document}
