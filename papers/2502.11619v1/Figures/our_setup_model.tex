\begin{figure*}[h!t]
\smaller
    \centering
    \begin{tikzpicture}[node distance=1.2cm]
    \node (supervised_learning) [shadow] {};
    \node [action][above of=supervised_learning, yshift=-0.38cm, draw=none, fill=none]{\textbf{Supervised}\\$\mathbf{Learning}$};
    \node (train_data) [normal, left of=supervised_learning, xshift=-1cm] {Training Data\\$\mathbf{D_{train}}$};
    \node (aux_data) [negative, left of=train_data, yshift=-1.25cm, xshift=-2.0cm]{Auxiliary Images\\$\mathbf{-}$};
    \node (gen_img) [normal, above of=aux_data]{Output Images\\$\mathbf{+}$};
    \node [normal, left of=supervised_learning, xshift=1.2cm] {Model};
    \node (attack_model) [attack, right of=supervised_learning, xshift=0.5cm] {$\mathbf{M_A}$};

    \node (og_image_dataset) [detail, above of=gen_img, xshift=-5cm] {Image\\Dataset};
    \node (finetuning) [shadow_rect, right of=og_image_dataset, mygreen, minimum height=1.5cm, minimum width=2cm, xshift=1cm] {};
     \node[action] [above of=finetuning, yshift=-0.6cm, draw=none, fill=none] {\textbf{Finetuning}};
     \node (adversial_ldm) [black, right of=finetuning, xshift=1.5cm] {Adversarial LDM\\$\mathbf{M_T}$};
     \node (unlawful_data) [positive, below of=og_image_dataset, yshift=0cm] {Image Dataset\\$\mathbf{D_{Target}}$};
     \node (ldm2) [normal, right of=og_image_dataset, xshift=0.5cm] {LDM};
     \node [normal, right of=ldm2, xshift=-0.25cm] {Data};
    \node (query) [normal, above of=attack_model] {Query\\$\mathbf{Q}$};
    \node (output) [normal, below of=attack_model] {$\mathbf{+} \ \texttt{if} \ \mathbf{Q} \in \mathbf{D_{Target}}$\\$\mathcal{-} \ \texttt{if} \ \mathbf{Q}  \notin \mathbf{D_{Target}}$};

    \draw [arrow] (og_image_dataset) -- (finetuning);
    \draw [arrow] (unlawful_data.east) -- (finetuning.north|-unlawful_data) -- (finetuning);
    \draw [arrow] (finetuning) -- (adversial_ldm);


    \draw [arrow] (aux_data) -- (train_data.south|-aux_data) -- (train_data);
    \draw [arrow] (gen_img) -- (adversial_ldm.east|-gen_img) --  (adversial_ldm.east|-train_data)  -- (train_data);
    \draw[arrow] (train_data) -- (supervised_learning);
    \draw[arrow] (supervised_learning) -- (attack_model);
    \draw[arrow] (adversial_ldm) -- (gen_img);
    \draw [arrow] (query) -- (attack_model);
    \draw [arrow] (attack_model) -- (output);
    

    \end{tikzpicture}
    \caption{A graphic representation of how an attack model $\mathbf{M_A}$ could be built and later queried with an image $\mathbf{Q}$.}
    \label{fig:our_setup_model}
\end{figure*}