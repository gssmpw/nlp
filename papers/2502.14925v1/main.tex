\pdfoutput=1
%\documentclass[acmsmall,screen,review,anonymous]{acmart}
\documentclass[11pt]{article}
\usepackage{acl}
\usepackage{times} 
\usepackage{latexsym}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\usepackage{inconsolata}
\usepackage{graphicx}
\input{setup}

\AtBeginDocument{%
  \providecommand\BibTeX{{%
    \normalfont B\kern-0.5em{\scshape i\kern-0.25em b}\kern-0.8em\TeX}}}

%\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
%    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}
%\title{\ourtool: A Framework for Automated Evaluation of LLMs in API-Oriented Code Generation}

\title{\ourtool: Code-specific Prompt Compression for Retrieval-Augmented Generation in Coding Tasks with LMs}

% \title{\ourtool: Compressing Code Prompt for Retrieval-Augmented Generation in Coding Tasks with LMs}

\author{Pengfei He \\
  University of Manitoba \\
  \texttt{hep2@myumanitoba.ca} \\\And
  Shaowei Wang \\
  University of Manitoba \\
  \texttt{shaowei.wang@umanitoba.ca} \\\And
  Tse-Hsun (Peter) Chen \\
  Concordia University \\
  \texttt{peterc@encs.concordia.ca} \\
  }




% \begin{CCSXML}
% <ccs2012>
%    <concept>
%        <concept_id>10011007</concept_id>
%        <concept_desc>Software and its engineering</concept_desc>
%        <concept_significance>500</concept_significance>
%        </concept>
%  </ccs2012>
% \end{CCSXML}

% \ccsdesc[500]{Software and its engineering}
% %
% % Keywords. The author(s) should pick words that accurately describe
% % the work being presented. Separate the keywords with commas.

% \keywords{Discrete Prompt Compression, LLM}

\maketitle

\input{0-abstract}

\input{1-introduction}



\input{2-relatedwork}

\input{3-trainingset}

\input{4-compressor}

\input{5-experiment}

\input{6-results}


\input{conclusion}

\input{limitation}






\newpage

\bibliography{main}

\newpage

\appendix
\input{appendix}



% END_OF_DEMO
% ### METHOD_UNDER_TEST 
% getLogManager() { 
%  return logManager;
% }  
% ### UNIT_TEST  
% testLogManagerCreation() { 
%  org.jsoar.kernel.LogManager logManager = 
%     agent.getLogManager(); "<AssertPlaceHolder>"; 
% }    
% ### generate assertion
% \begin{table*}[]
% \centering
% \footnotesize
% \caption{“$\downarrow$X”: relative degradation over the original code demonstration.}
% \begin{tabular}{lcccc}
% \hline
% \multicolumn{1}{c}{}     & \multicolumn{2}{c}{ATLAS}                      & \multicolumn{2}{c}{\tasktwo}    \\
% \multicolumn{1}{c}{Ablation Type} & $\tau$ & Exact Match              & $\tau$ & Code Bleu                \\ \hline
% $\setminus$Symbol        & 6.2\%               & 0.169$\downarrow$-63.5\% & 9.7\%               & 0.507$\downarrow$-37.7\% \\
% $\setminus$Signature     & 1.6\%               & 0.401$\downarrow$-13.4\% & 9.7\%               & 0.603$\downarrow$-25.8\% \\
% $\setminus$Invocation    & 25.7\%              & 0.405$\downarrow$-12.7\% & 27.0\%              & 0.788$\downarrow$-3.1\%  \\
% $\setminus$Identifier    & 1.3\%               & 0.442$\downarrow$-4.5\%  & 11.3\%              & 0.790$\downarrow$-2.9\%  \\
% $\setminus$Structure     & 1.4\%               & 0.460$\downarrow$-0.6\%  & 6.3\%               & 0.810$\downarrow$-0.4\%  \\ \hline
% Original                 & 0.0\%                &  0.505$\downarrow$0.0\%                         & 0.0\%               & 0.814$\downarrow$0.0\%                       \\ \hline
% \end{tabular}
% \end{table*}

% \begin{table*}[]
% \caption{Performance of different setting compression ratios on studied tasks, including real compression ratios on code ($\tau_{code}$) and prompt ($\tau_{prompt}$).}
% \footnotesize
% \begin{tabular}{lccccccccc}
% \hline
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{3}{c}{\textbf{Assertion}}                          & \multicolumn{3}{c}{\textbf{\tasktwo}}                         & \multicolumn{3}{c}{\textbf{\taskthree}}                         \\
% \multicolumn{1}{c}{\textbf{Method}} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{Exact Match} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{CodeBleu} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{CodeBleu} \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{1-shot, $\tau_{code}$-0.5}}}                                                                                                                                                                                \\
% \ourtool w/o Copy                         & TBD                    & TBD                      & TBD         & TBD                    & 134                      &             &                        &                          &                  \\
% \ourtool                      & 0.56                   & 0.68                     & 0.441       & 0.53                   & 0.67                     & 0.687       & 0.57                   & 0.58                     & 0.490            \\
% Oracle                              & 0.46                   & 0.73                     & 0.42        & 0.52                   & 0.67                     & 0.670       & TBD                    &                          &                  \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{1-shot, $\tau_{code}$-0.3}}}                                                                                                                                                                               \\
% \ourtool w/o Copy                          & TBD                    & TBD                      & TBD         & TBD                    & TBD                      &             &                        &                          &                  \\
% \ourtool                      & 0.74                   & 0.88                     & 0.482       & 0.70                   & 0.78                     & 0.616       & 0.62                   & 0.61                     & 0.497            \\
% Oracle                              & 0.63                   & 0.81                     &   0.462          & 0.69                   & 0.77                     & 0.650       &                        &                          &                  \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{1-shot, $\tau_{code}$-0.1}}}                                                                                                                                                                               \\
% \ourtool w/o Copy                          & TBD                    & TBD                      & TBD         & TBD                    & TBD                      &             &                        &                          &                  \\
% \ourtool                      & 0.96                   & 0.99                     & 0.500       & 0.89                   & 0.90                     & 0.701       & 0.67                   & 0.66                     & 0.501            \\
% Oracle                              & 0.85                   & 0.91                     & 0.498       & 0.89                   & 0.88                     & 0.684       &                        &                          &                  \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{3-shot, $\tau_{code}$-0.5}}}                                                                                                                                                                                \\
% \ourtool w/o Copy                          & TBD                    & TBD                      & TBD         & TBD                    & 134                      &             &                        &                          &                  \\
% \ourtool                      & 0.56                   & 0.68                     & 0.441       & 0.53                   & 0.67                     & 0.687       & 0.57                   & 0.58                     & 0.490            \\
% Oracle                              & 0.46                   & 0.73                     & 0.42        & 0.52                   & 0.67                     & 0.670       & TBD                    &                          &                  \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{5-shot, $\tau_{code}$-0.5}}}                                                                                                                                                                                \\
% \ourtool w/o Copy                          & TBD                    & TBD                      & TBD         & TBD                    & 134                      &             &                        &                          &                  \\
% \ourtool                      & 0.56                   & 0.68                     & 0.441       & 0.53                   & 0.67                     & 0.687       & 0.57                   & 0.58                     & 0.490            \\
% Oracle                              & 0.46                   & 0.73                     & 0.42        & 0.52                   & 0.67                     & 0.670       & TBD                    &                          &                  \\ \hline
% \end{tabular}
% \end{table*}


% \begin{table*}[]
% \begin{tabular}{lcccccllll}
% \hline
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{6}{c}{\textbf{In-Domain}}                                                                                                                                                                            & \multicolumn{3}{c}{\textbf{Out-of-Domain}}                                                                                                                \\
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{3}{c}{\textbf{ATLAS}}                                                 & \multicolumn{3}{c}{\textbf{\tasktwo}}                                                                          & \multicolumn{3}{c}{\textbf{Code Suggestion}}                                                                                                           \\
% \multicolumn{1}{c}{\textbf{Method}} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{EM} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \multicolumn{1}{c}{\textbf{CB}} & \multicolumn{1}{c}{\textbf{$\tau_{code}$}} & \multicolumn{1}{c}{\textbf{$\tau_{prompt}$}} & \multicolumn{1}{c}{\textbf{Rouge-L}} \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{CodeLlama-13B}}}                                                                                                                                                                                                                                                                                                                                                             \\
% \ourtool                          & 445                               & 0.338                               & 251                  & 0.419                             & 134                                 &                                        &                                                       &                                                         &                                      \\
% \ourtool                      & 474                               & 0.341                               & 251                  & 0.421                             & 123                                 &                                        &                                                       &                                                         &                                      \\
% Oracle                              &                                   &                                     &                      &                                   &                                     &                                        &                                                       &                                                         &                                      \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{Deepseek Coder}}}                                                                                                                                                                                                                                                                                                                                                            \\
% \ourtool                          & 406                               & 0.152                               & 221                  & 0.481                             & 138                                 &                                        &                                                       &                                                         &                                      \\
% \ourtool                      & 403                               & 0.174                               & 232                  & 0.453                             & \multicolumn{1}{l}{}                &                                        &                                                       &                                                         &                                      \\
% Oracle                              & \multicolumn{1}{l}{}              & \multicolumn{1}{l}{}                & \multicolumn{1}{l}{} & \multicolumn{1}{l}{}              & \multicolumn{1}{l}{}                &                                        &                                                       &                                                         &                                      \\ \hline
% \end{tabular}
% \end{table*}

% \begin{table*}[]
% \caption{Performance of different shots.}
% \begin{tabular}{lccccllllc}
% \hline
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{6}{c}{\textbf{In-Domain}}                                                                                                                                                  & \multicolumn{3}{c}{\textbf{Out-of-Domain}}                                                                       \\
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{3}{c}{\textbf{Assertion Setting}}                                & \multicolumn{3}{c}{\textbf{\tasktwo}}                                                                 & \multicolumn{3}{c}{\textbf{\taskthree}}                                                                     \\
% \multicolumn{1}{c}{\textbf{Method}} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{EM}               & \textbf{$\tau_{code}$} & \multicolumn{1}{c}{\textbf{$\tau_{prompt}$}} & \multicolumn{1}{c}{\textbf{CB}} & \multicolumn{1}{c}{\textbf{$\tau_{code}$}} & \multicolumn{1}{c}{\textbf{$\tau_{prompt}$}} & \textbf{ROUGE-L}     \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{1-shot}}}                                                                                                                                                                                                                                                                                                    \\
% \ourtool                          & 445                    & 0.338                    & 251                       & 0.419                  & \multicolumn{1}{c}{134}                      &                                 &                                            &                                              &                      \\
% \ourtool                      & 474                    & 0.341                    & 0.441                     & 0.421                  & \multicolumn{1}{c}{123}                      & 0.687                           &                                            &                                              & 0.490                \\ \hline
% w/o Compressing                     & 1                      & 1                        & \multicolumn{1}{l}{0.505} & 1                      & \multicolumn{1}{c}{1}                        & 0.814                           & \multicolumn{1}{c}{1}                      & \multicolumn{1}{c}{1}                        & 0.521                \\
% Oracle                              & \multicolumn{1}{l}{}   & \multicolumn{1}{l}{}     & \multicolumn{1}{l}{0.420} & \multicolumn{1}{l}{}   &                                              & 0.670                           & \multicolumn{1}{c}{}                       & \multicolumn{1}{c}{}                         & \multicolumn{1}{l}{} \\ \hline
% \textit{\textbf{3-shot}}            &                        &                          &                           &                        &                                              &                                 &                                            &                                              & \multicolumn{1}{l}{} \\
% \ourtool                          & 406                    & 0.152                    & 221                       & 0.481                  & \multicolumn{1}{c}{138}                      &                                 &                                            &                                              &                      \\
% \ourtool                      & 403                    & 0.174                    & 0.489                     & 0.453                  &                                              & 0.680                           &                                            &                                              & 0.503                \\ \hline
% w/o Compressing                     & 1                      & 1                        & \multicolumn{1}{l}{0.552} & 1                      & \multicolumn{1}{c}{1}                        & 0.814                           & \multicolumn{1}{c}{1}                      & \multicolumn{1}{c}{1}                        &                      \\
% Oracle                              & \multicolumn{1}{l}{}   & \multicolumn{1}{l}{}     & \multicolumn{1}{l}{}      & \multicolumn{1}{l}{}   &                                              &                                 &                                            &                                              & \multicolumn{1}{l}{} \\ \hline
% \textit{\textbf{5-shot}}            &                        &                          &                           &                        &                                              &                                 &                                            &                                              & \multicolumn{1}{l}{} \\
% \ourtool                          & 447                    & 0.409                    & 209                       & 0.567                  &                                              &                                 &                                            &                                              &                      \\
% \ourtool                      & 440                    & 0.451                    & 0.491                     & 0.690                  &                                              & 0.707                           &                                            &                                              &                      \\ \hline
% w/o Compressing                     & 1                      & 1                        & \multicolumn{1}{l}{0.557} & 1                      & \multicolumn{1}{c}{1}                        & 0.757                           & \multicolumn{1}{c}{1}                      & \multicolumn{1}{c}{1}                        & \multicolumn{1}{l}{} \\
% Oracle                              &                        &                          &                           & 0.668                  &                                              &                                 &                                            &                                              &                      \\ \hline
% \end{tabular}
% \end{table*}


% \begin{table*}[]
% \caption{Transferability of the proposed \ourtool method across different LMs}
% \begin{tabular}{lccccccccc}
% \hline
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{6}{c}{\textbf{In-Domain}}                                                                                            & \multicolumn{3}{c}{\textbf{Out-of-Domain}}                           \\
% \multicolumn{1}{c}{\textbf{}}       & \multicolumn{3}{c}{\textbf{ATLAS}}                  & \multicolumn{3}{c}{\textbf{\tasktwo}}                         & \multicolumn{3}{c}{\textbf{Code Suggestion}}                         \\
% \multicolumn{1}{c}{\textbf{Method}} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{EM} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{CB} & \textbf{$\tau_{code}$} & \textbf{$\tau_{prompt}$} & \textbf{Rouge-L} \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{Unparsable Code 1\%}}}                                                                                                                                                                                     \\
% \ourtool w/o Copy                               & 445                    & 0.338                    & 251         & 0.419                  & 134                      &             &                        &                          &                  \\
% \ourtool                           & 474                    & 0.341                    & 251         & 0.421                  & 123                      &             &                        &                          &                  \\ \hline
% Oracle                              & -                      & -                        & -           & -                      & -                        & -           & -                      & -                        & -                \\ \hline
% \multicolumn{10}{l}{\textit{\textbf{Unparsable Code 3\%}}}                                                                                                                                                                                     \\
% \ourtool w/o Copy                               & 445                    & 0.338                    & 251         & 0.419                  & 134                      &             &                        &                          &                  \\
% \ourtool                           & 474                    & 0.341                    & 251         & 0.421                  & 123                      &             &                        &                          &                  \\ \hline
% Oracle                              & -                      & -                        & -           & -                      & -                        & -           & -                      & -                        & -                \\ \hline
% \end{tabular}
% \end{table*}
\end{document}
