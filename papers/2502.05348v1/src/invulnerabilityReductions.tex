% !TEX root = main.tex
\section{Invulnerability Reductions for Various Problems}
\label{sec:invulnerability-gadgets}
In this section, we show that a lot of well-known problems satisfy the assumptions of \cref{thm:meta-theorem}, i.e.\ it is possible to construct so-called invulnerability gadgets for them.
Note that this proves \cref{thm:min-card-interdiction}.
(More precisely, it proves the hardness part and the containment part is analogous to \cite{gruene2024completeness}).
Let in the following always $C \subseteq \U(I)$ denote the set of vulnerable elements, let $\U(I) \setminus C$ denote the set of invulnerable elements, and $k$ denote the budget of the attacker.

\textbf{Clique.}
We have $\U = V$ in this case.
For a given graph $G = (V,E)$, and a set $C \subseteq V$, we explain how to make $V \setminus C$ invulnerable.
We obtain a graph $G'$ from $G$ by replacing every vertex $v \in V \setminus C$ with an independent set $X_v$ of size $|X_v| = k+1$. 
For a vertex $v \in C$, we define $X_v := \set{v}$.
For all edges $uv$ in $G$, the new graph $G'$ contains the complete bipartite graph between $X_u$ and $X_v$.
Note that every clique of $G'$ contains at most one vertex from every set $X_v$. Hence the size of a maximum clique is the same in $G$ and $G'$. 
Since for $v \in V \setminus C$, we have $|X_v| = k+1$ and all vertices in $X_v$ have the same neighborhood, the attacker is not able to attack all vertices of $X_v$ at once because its budget of $k$ is too small.
Hence $v$ has been made \enquote{invulnerable}.
Furthermore, for every clique in $G$, we find a corresponding clique in $G'$ that contains at most one vertex from each set $X_v$. 
Together, this implies that an attacker can find a set $B' \subseteq V(G')$ of size $|B'| \leq k$ interdicting all maximum cliques in $G'$ if and only the attacker can find a set $B \subseteq C$ of size $|B| \leq k$ interdicting all maximum cliques of $G$, i.e.\ the assumptions of \cref{thm:meta-theorem} are met.

\textbf{Independent Set.} Analogous to clique in the complement graph.

\textbf{Dominating Set.} We have $\U = V$ in this case. 
To make a vertex $v \in V \setminus C$ invulnerable, we use the same construction as for the clique problem, with the only difference that $X_v$ is a clique instead of an independent set. 
Every optimal dominating set takes at most one vertex from each set $X_v$, but all $k+1$ vertices inside $X_v$ are equivalent. More precisely, they have the same (closed) neighborhood. 
This means for an invulnerable $v \in V \setminus C$, an attacker can not attack all $k+1$ vertices of $X_v$ simultaneously. 
Furthermore, it is easily seen that on the vulnerable vertices, the attacker interdicts all optimal dominating sets in the old graph if and only if the analogous attack interdicts all optimal dominating sets in the new graph.

\textbf{Hitting Set.} In this case, we have some universe $\U$, sets $Y_1,\dots,Y_t \subseteq \U$, and the problem is to find a minimal hitting set $X \subseteq \U$ hitting all the sets $Y_j$, $j =1,\dots,t$. 
To make an element $e \in \U$ invulnerable, simply delete it and replace it by $k + 1$ copies.
We modify the sets such that every set $Y_j$ that contained $e$ now contains the $k+1$ copies of $e$ instead. 
It is clear that all the copies of $e$ hit the same sets as $e$ (i.e.\ taking multiple copies into the hitting set does not offer any advantage).
Furthermore, it is not possible for the attacker to attack all $k+1$ copies simultaneously.
By an argument analogous to the above paragraphs, we are done.

\textbf{Set cover.} We have a ground set $E$, and a family $\mathcal{F}$ of sets $S_1, \dots, S_n \subseteq E$ over the ground set. 
We let $\U := \fromto{1}{n}$ and the goal is to pick a subset $I \subseteq \U$ of the indices such that $\bigcup_{i \in I} S_i = E$.
The attacker can attack up to $k$ of the indices $i \in I$ to forbid the corresponding sets from being picked.
We can make some index $i \in \U$ invulnerable, by simply duplicating the set $S_i$ a total amount of $k+1$ times.

Note that this satisfies the assumptions of \cref{thm:meta-theorem}, but modifies the family $\mathcal{F}$ such that the same set could appear multiple times in the family.
Alternatively, our construction can be adjusted such that this is avoided.
For this, we introduce $k+1$ new elements $e_1, \dots, e_{k+1}$ and $k+2$ new elements $f_1,\dots, f_{k+2}$ to the ground set $E$.
For each invulnerable index $i \in \fromto{1}{n} \setminus C$, we substitute $S_i$ by the $k+1$ sets $S_i^{(j)} = S_i \cup \{e_j\}$ for $j=1,\dots,k+1$.
Furthermore, we introduce $k+2$ new sets $S'_j := \fromto{e_1}{e_{k+1}} \cup \fromto{f_1}{f_{k+2}} \setminus \set{f_j}$ for $j =1, \dots, k+2$. This completes the description of the instance.
Note that the following holds: The elements $\fromto{f_1}{f_{k+2}}$ are covered by a set cover, if and only if it contains at least two sets of the form $S'_j$. 
Assuming this condition is true, all the elements $\fromto{e_1}{e_{k+1}}$ are already covered.
Hence all the different copies $S_i^{(j)}$ for $j=1,\dots,k+1$ are essentially equivalent.
Thus the attacker can not meaningfully attack all these copies simultaneously.
Note that the attacker can also not meaningfully attack the sets $S'_j$, since no matter which $k$ of them are attacked, 2 of them always remain.


\textbf{Steiner tree.} We have $\U = E$ in this case.
To make an edge $uv \in E \setminus C$ invulnerable, we replace it with $k+1$ parallel subdivided edges, i.e.\ we introduce vertices $w_1, \dots, w_{k+1}$ and edges $uw_i$ and $w_iv$ for $i =1,\dots, k+1$.
Every vulnerable edge $uv$ is replaced with only a single subdivided edge, i.e.\ a vertex $w$ and edges $uw, wv$.
It is clear that the number of edges of a minimum Steiner tree in the new instance is exactly two times as big as before, and the edge $uv$ has become effectively invulnerable.  

\textbf{Two vertex-disjoint path.}
We have $\U = A$ in this case.
The gadget is the same as for Steiner tree, except that the construction is directed, i.e. the arc $(u,v)$ is replaced either by the arcs $(u,w_i), (w_i, v)$ for $i=1,\dots,k+1$ (invulnerable case) or by the two arcs $(u,w), (w,v)$ (vulnerable case).
Since the paths in this problem have to be vertex disjoint, adding additional subdivided arcs between two existing vertices does not produce additional solutions because traveling from $u$ to $v$ renders all other paths from $u$ to $v$ unusable.

\textbf{Feedback arc set.} We have $\U = A$ in this case. 
Note that making some arc $a = (u,v) \in A \setminus C$ invulnerable means to ensure that it can be used in a minimal feedback arc set, no matter which $k$ arcs the attacker chooses.
This can be achieved the following way: Subdivide $a$ into $k + 1$ arcs. 
Clearly, the set of cycles in the new graph stays essentially the same. 
Furthermore, the attacker cannot block all $k + 1$ arcs from being chosen for the solution.
Choosing one of the subdivided pieces of $a$ in the new instance has the same effect as choosing $e$ in the old instance.

\textbf{Feedback vertex set.}
We have $\U = V$ in this case.
To make a vertex $v \in V \setminus C$ invulnerable, we split it into two vertices $v_\text{in}$ and $v_\text{out}$, 
put all incoming edges of the old vertex $v$ to $v_\text{in}$, 
put all outgoing edges of the old vertex $v$ to $v_\text{out}$,
and connect $v_\text{in}$ to $v_\text{out}$ with a directed path $P_v$ on $k+1$ vertices.
Note that in the new instance, a directed cycle uses one vertex of $P_v$ if and only if the cycle uses all vertices of $P_v$ if and only if a corresponding cycle in the old instance uses $v$.
By an analogous to argument to the feedback arc set case, we are done.

\textbf{Uncapacitated facility location.} We have $\U = J$ in this case, where $J$ is the set of sites for potential facilities. The attacker selects facility sites and forbids the decision maker to build a facility there. 
To make a facility site $j \in J \setminus C$ invulnerable, we can simply delete the site and replace it with $k+1$ identical sites, i.e.\ sites which have the same facility opening cost and service cost functions as the original facility $j$. 
Clearly, this way the attacker can not stop one of the equivalent facilities to be opened. On the other hand, since the facilities are identical (and uncapacitated), 
the decision maker has no advantage from opening two identical copies of the same facility.
Hence the new instance is identical to the old instance, with the only difference that facility site $j$ is invulnerable.

\textbf{$p$-median, $p$-center.} The difference between the facility location problem and the $p$-center and $p$-median problem is that in the latter two, there are no facility opening costs, at most $p$ facilities are allowed to be opened, 
and the service costs in the $p$-center problem are calculated using a minimum, and in the $p$-median problem they are calculated using the sum. 
All of these differences do not affect the argument from above, i.e.\ one can still make a facility site invulnerable by creating $k+1$ identical facilities. Hence the same argument holds.

\textbf{Subset Sum.}
We have $\U = \fromto{1}{n}$ and are given numbers $a_1, \dots, a_n \in \N$ and a target value $T$. The question is whether there exists $S \subseteq U$ with $\sum_{i \in S} a_i = T$. 
Consider some index $i \in \U \setminus C$. In order to make the index $i$ invulnerable, the first idea is to copy the number $a_i$ a total amount of $k+1$ times. 
But there is a problem with this construction -- if we do this, then the same number $a_i$ could be picked multiple times, which is not allowed in the original instance.
We need an additional gadget to make sure that $a_i$ gets used at most once for each $i$. This can be done the following way: 
The new instance contains the following numbers: Choose some number $B > 2k+2$ as a basis. 
For each $i \in C$, it contains the single number $B^{n(k+1)}a_i$. 
For each $i \in \fromto{1}{n} \setminus C$, it contains the $k+1$ distinct numbers  $c_i^{(j)} := B^{n(k+1)}a_i + B^{(i-1)(k+1) + j}$ for $j = 0,\dots, k$ as well as the $k+1$ distinct numbers $d_i^{(j)} := \sum_{\ell = 0,\ell \neq j}^k B^{(i-1)(k+1) + \ell}$ for $j = 0,\dots, k$ and the $k+1$ distinct numbers $e_i^{(j)} := B^{(i-1)(k+1) + j}$ for $j = 0,\dots, k$. We call $d_i^{(j)}$ and $e_i^{(j)}$ the helper numbers.
The new instance contains a total of $|C| + 3(k+1)(n - |C|)$ numbers. The new target value is 
$$
T' := B^{n(k+1)}T \ + \sum_{i \in \fromto{1}{n} \setminus C} \quad \sum_{\ell = 0}^k B^{(i-1)(k+1) + \ell}.
$$
Note that this has the following effect: 
Consider the representation of all involved numbers in base $B$. Let us call the digits $0$ up to $n(k+1) - 1$ the lower positions. 
Note that in the lower positions there can never be any carry, since for every lower position, all involved numbers have either a zero or one in that position and less than $B$ numbers have a one in the same place.
Due to that fact, in the lower positions the target $T'$ is reached if and only if for every $i \in \fromto{1}{n} \setminus C$, the corresponding \enquote{bitmask} is filled out (by this, we mean the positions $(i-1)(k+1)$ up to $i(k+1) - 1$).
This is achieved if and only if for some $j \in \fromto{0}{k}$ both the values $c^{(j)}_i$ and $d^{(j)}_i$ or both the values $d^{(j)}_i$ and $e^{(j)}_i$ are picked. In particular, at most one of the $k+1$ values $c^{(j)}_i$ for $j=0,\dots,k$ are picked.
In the upper positions, the target $T'$ is reached if and only if the corresponding choice in the old instance meets the target $T$.

Consider an attack of $k+1$ numbers by the attacker. For each $i \in \fromto{1}{n} \setminus C$ it holds that there exists a $j$ such that both $c_i^{(j)}$ and $d_i^{(j)}$ are not attacked. Likewise there exists a $j'$ such that both $d_i^{(j')}$ and $e_i^{(j')}$ are not attacked. 
That means that if $i$ is an invulnerable index, then no matter which $k+1$ values of  $c_i^{(j)}$, $d_i^{(j)}$ and  $e_i^{(j)}$ are attacked, 
a correct solution of subset sum will take for some $j$ either both $c_i^{(j)}$ and $d_i^{(j)}$ (which corresponds to taking $a_i$ in the original instance) 
or take both $d_i^{(j)}$ and $e_i^{(j)}$ (which corresponds to not taking $a_i$ in the original instance).
It follows that it is possible to block the new instance by attacking $k+1$ values if and only if it is possible to block the old instance by attacking $k+1$ of the vulnerable values. 
This was to show.
Finally, if the old numbers $a_1, \dots, a_n$ are pairwise distinct, the new numbers are as well. Hence the interdiction problem for subset sum is $\Sigma^p_2$-complete, even if all involved numbers are distinct.

\textbf{Knapsack.} The knapsack problem can be seen as a more general version of the subset sum problem, by creating for each $i$ 
from the subset sum instance a knapsack item with both profit $p_i = a_i$ and weight $w_i = a_i$, and setting both the weight and profit threshold to $T$.
Hence the $\Sigma^p_2$-completeness of \textsc{Min Cardinality Interdiction-Knapsack} follows as a consequence of the $\Sigma^p_2$-completeness of \textsc{Min Cardinality Interdiction-Subset Sum}. This holds even if all the involved knapsack items are distinct.

\input{src/invulnerabilityReductionHamiltonian}