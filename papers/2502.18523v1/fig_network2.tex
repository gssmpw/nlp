


\definecolor{myext}{RGB}{181, 181, 181}
\definecolor{myreg}{RGB}{251, 153, 140}
\definecolor{mysegparc}{RGB}{218, 175, 244}
\definecolor{mybn}{RGB}{249, 203, 156}
\definecolor{mypre}{RGB}{255, 127, 80}

\begin{figure*}[t]
  \centering
  \includegraphics[width=0.99\linewidth]{fig/method_v16.png}
    \vspace{-5pt}
  \caption{Overview of the UniBrain. \textbf{\textcolor{myext}{Extraction (Ext)}} module removes non-brain tissue of the raw source image~$\mathbf{S}$, producing the extracted brain image~$\mathbf{E}$. \textbf{\textcolor{myreg}{Registration (Reg)}} module aligns extracted brain~$\mathbf{E}$ with the target image~$\mathbf{T}$ through affine transformation~$\mathbf{A}$, resulting in the warped image~$\mathbf{W}$. \textbf{\textcolor{mysegparc}{Segmentation \& parcellation (Seg \& Parc)}} module takes the source image~$\mathbf{S}$, target segmentation mask~$\mathbf{B}$, target parcellation mask~$\mathbf{P}$, and inversed affine transformation~$\mathbf{A^{-1}}$ to generate the segmentation mask~$\mathbf{R}$ and the parcellation mask~$\mathbf{U}$. \textbf{\textcolor{mybn}{Brain~network~(BN)}} module uses the source image~$\mathbf{S}$ and the parcellation mask~$\mathbf{U}$ to construct brain network~$G$.
  %by learning ROI feature~$\mathbf{H}$ and connectivity matrix~$\mathbf{C}$. 
  \textbf{\textcolor{mypre}{Classification (CLS)}} module then uses the ROI feature~$\mathbf{H}$ and connectivity matrix~$\mathbf{C}$ contained in $G$ to produce the prediction~$\hat{y}$. 
  %The final outputs include the extracted brain image~$\mathbf{E}$, the target-aligned warped image~$\mathbf{W}$, the source image's brain tissue segmentation mask~$\mathbf{R}$, the source image's brain ROI parcellation mask~$\mathbf{U}$, the brain network connectivity matrix~$\mathbf{C}$ and the prediction $\hat{y}$.
  }
  \label{fig:network}
  \vspace{-5pt}
\end{figure*}
