% Good


\section{Formal Adaptive Matrix-Vector Lower Bound}
\label{app:formal-kronmatvec-lower}


Written in the notation and form of \Cref{app:explain-simchowitz}, we can write \Cref{thm:kron-matvec-testing-lower} equivalently as the following:
\begin{reptheorem}{thm:kron-matvec-testing-lower}
Consider \Cref{setting:abstract-simchowitz} where \(\cV^t\) is the set of \(\kappa-\)conditioned Kronecker-structured query vectors:
\[
    \cV^t \defeq
    \{
        (\vv^{(1)},\ldots,\vv^{(t)})
        ~:~
        \vv^{(i)} = \otimes_{j=1}^q \vv^{(i)}_j
        ,~
        \vv^{(i)}_j\in\bbS^{n}
        ,~
        \text{cond}([\vv^{(1)} ~ \cdots ~ \vv^{(t)}]) \leq \kappa
    \}
\]
Then, \(t = \Omega(\min\{C_0^{q/2}, \frac{C_\tau^q}{\lambda^2 \kappa^2}\})\) matrix-vector products are needed to correctly guess if \(\mA = \mA_0\) or \(\mA_1\) in \Cref{setting:abstract-simchowitz} with probability at least \(\frac23\), where \(C_0\) and \(C_\tau\) are the constants in \Cref{lem:kron-unit-vec-conentration}.
\end{reptheorem}
\begin{proof}
We proceed by using \Cref{thm:abstract-simchowitz-requirements} in conjunction with \Cref{lem:kron-unit-vec-conentration} and \Cref{lem:kron-unit-vec-mgf}.
In particular, we \Cref{lem:kron-unit-vec-conentration} tells us that \(f(\tau) \leq C_0^{-q}\) for any \(\tau \leq C_\tau^{-q}\).
Therefore, we can take \(\tau_1=\ldots=\tau_t = C_\tau^{-q}\) so that \(\sum_{j=1}^i \tau_j = i C_\tau^q\).
By assuming that \(t \leq \frac{3 C_\tau^q}{\lambda^2 \kappa^2}\), we know that \(e^{\frac{\lambda^2\kappa^2}{2} \sum_{j=1}^{i=1}\tau_j} \leq e^{\frac{\lambda^2 \kappa^2 i}{2C_\tau^q}} \leq 4\).
Then,
\begin{align*}
    f(\tau_1) + 2\sum_{i=1}^t e^{\frac{\lambda^2\kappa^2}{2} \sum_{j=1}^{i=1}\tau_j} \sqrt{f(\tau_j)}
    &\leq C_0^{-q} + 8 \sum_{i=1}^t C_0^{-q/2} \\
    &\leq (1+8t)C_0^{-q/2} \\
    &\leq \frac1{27}
\end{align*}
where the last line holds so long as \(t \leq O(C_0^{-q/2})\).
Similarly, we can use \Cref{lem:kron-unit-vec-mgf} to bound
\(
    \E_{\vu,\vu'}[e^{\eta |\langle \vu, \vu'\rangle|}]
    \leq e^{\frac{2\eta}{n^q}}
\)
for any \(\eta \in (0,1)\).
Therefore,
\begin{align*}
    \E_{\vu,\vu'\sim\cP}[e^{\lambda^2 \kappa^2|\langle \vu, \vu'\rangle|(\sum_{i=1}^t \tau_i) + \frac{\lambda^2\kappa^4}{n^q}(\sum_{i=1}^t \tau_i)^2}]
    &= \E_{\vu,\vu'\sim\cP}\left[e^{\frac{\lambda^2 \kappa^2 t}{C_\tau^q}|\langle \vu, \vu'\rangle|}\right] e^{ \frac{\lambda^2\kappa^4 t^2}{n^q C_\tau^{2q}}} \\
    &\leq e^{2\frac{\lambda^2 \kappa^2 t}{n^q C_\tau^q} + \frac{\lambda^2\kappa^4 t^2}{n^q C_\tau^{2q}}} \\
    &= e^{2\frac{\lambda^2 \kappa^2 t}{n^q C_\tau^q}(1 + \frac{\kappa^2 t}{4C_\tau^q})} \\
    &\leq e^{4\frac{\lambda^2 \kappa^2 t}{n^q C_\tau^q}} \\
    &\leq 1 + 8\frac{\lambda^2 \kappa^2 t}{n^q C_\tau^q} \\
    &\leq 1 + \frac{1}{27}
\end{align*}
where we use that \(\eta = \frac{\lambda^2 \kappa^2 t}{C_\tau^q} \leq 1\) in the first inequality, that \(t \leq \frac{4 C_\tau^q}{\kappa^2}\) in the second inequality, that \(e^x \leq 1+2x\) for \(x \leq 1\) in the third inequality, and we take \(t \leq \frac{n^q C_\tau^q}{27 \cdot 8 \lambda^2 \kappa^2}\) in the last inequality.
By \Cref{thm:abstract-simchowitz-requirements}, we find that having \(t \leq O(\min\{C_0^{q/2}, \frac{C_\tau^q}{\lambda^2\kappa^2}\})\) does not suffice to correctly guess if \(\mA = \mA_0\) or \(\mA = \mA_1\) in \Cref{setting:abstract-simchowitz} with probability at least \(\frac23\).
\end{proof}

