\begin{algorithm}[H]
\caption{\magfv}\label{alg:maco:cap}
\begin{algorithmic}
  \REQUIRE $\v{r}$, $\textcolor{teal}{\v{\varphi}}_0 \sim \mathcal{U}([-\pi, \pi])^{W \times H}$
  \REQUIRE $\bm{\alpha} = \bm{0}$
  \FOR{$n = 0$ \TO $N$}
    \STATE $\v{\varphi}_r = \text{sample}(\mathcal{T})$
    \STATE $\vx_n = (\v{\varphi}_r \circ \fourier^{-1})(\v{r} e^{i \v{\varphi}_n})$
    \STATE $\textcolor{teal}{\v{\varphi}}_{n+1} = \textcolor{teal}{\v{\varphi}}_n + \eta \nabla_{\textcolor{teal}{\v{\varphi}}} \mathcal{L}_{\v{v}}(\vx_n)$
    \STATE $\bm{\alpha} = \bm{\alpha} + |\nabla_{\vx_n} \mathcal{L}_{\v{v}}(\vx_n)|$
  \ENDFOR
  \STATE \textbf{Return} $\vx^* = \fourier^{-1}(\v{r} e^{i\textcolor{teal}{\v{\varphi}}_{N}}), \bm{\alpha}$
\end{algorithmic}
\end{algorithm}
