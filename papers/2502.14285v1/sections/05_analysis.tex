\section{Analysis}

In this section, we analyze the effects of EvoStealer's components, the iteration number, and the experimental costs.

\subsection{Ablation Study} \label{ablation}
\input{tables/ablation_study}
%如我们在section3_5所述，在子代的质量评估阶段，EvoStealer会随机生成一张in-domain的图片，并计算其与目标图片之间的相似度分数作为适应度分数的一部分来指导EvoStealer的进化方向。然而，这种代价也是昂贵的，例如，若设置population size为5，iterations为5时，需要生成25张图片，大概越需要2美刀。那么，能否不生成图片而仅计算prompt和目标图片之间的相似度来指导计划呢？我们对此进行研究，结果如表2所示。从表中可以看到。当去掉图片生成后，EvoStealer的平均性能略微下滑，在in-domain和out-of-domain上的性能均有一定的下降。这说明，在适应度分数中添加图片之间的相似度分数能够更好地指导EvoStealer的进化，是的收敛速度更快。但考虑到平衡价格因素，EvoStealer的成本大幅度下降，且EvoStealer的性能仍然优于其他baselines。因此，在可接受的范围内，去掉图片生成是一种性能和代价折中的可接受方案。
% As described in Section~\ref{section_fitness}, during the offspring quality evaluation phase, EvoStealer randomly generates a in-domain image and calculates its similarity score with the target image. This score is then used as part of the fitness score to guide EvoStealer’s evolutionary direction. However, this process is costly. For example, with a population size of 5 and 5 iterations, it requires generating 25 images, resulting in an estimated cost of around 2 dollars. This raises the question: is it possible to guide the evolution process by calculating the similarity between the prompt and the target image, without generating images? We investigated this possibility, and the results are shown in Table~\ref{tb:abalation}. As seen in the table, removing image generation leads to a decline in EvoStealer’s performance on both in-domain and out-of-domain data. This suggests that including the similarity score between images in the fitness score helps better guide EvoStealer's evolution, thereby accelerating convergence. However, considering cost balance, EvoStealer's overhead significantly decreases, while its performance still surpasses other baseline models. Therefore, removing image generation offers a trade-off between performance and cost, making it a viable solution within an acceptable range.

% 我们分别消去抽取模板中的supplements和适应性函数中的图片相似性评估，以探讨信息抽取和适应性函数对EvoStealer的影响，结果如表3所示。我们可以看到，消去任一模块都导致了整体性能的下降，特别是移除supplements，导致平均相似度下降2.79。这是因为，supplements提供了关于额外的细节描述，包括图片的细节和风格特征。如diffevo所述，supplements相对于单个modifire更长。因而移除supplements在视觉表现上更加明显。我们在附录D中提供了消去supplements的前后对比图。移除适应性函数的图片相似性评估，导致性能下降1.27。这说明，在适应性函数中添加生成图片和目标图片的相似度比较能够更好地指导进化过程,加速收敛。然而，这种下降幅度相对较小，我们认为适当扩充子代数量或者增加迭代轮数能够缓解此缺陷。
We remove the supplements from the extracted templates and the image similarity evaluation from the fitness function to examine their impact on EvoStealer. The results are shown in Table~\ref{tb:abalation}. As observed, removing either module results in decreased performance, with a more significant drop when supplements are removed—specifically, an average similarity reduction of 2.79\%. This is because supplements provide additional details, such as image features and style information. As noted in Section~\ref{diffevo}, supplements are longer than individual modifiers, so their removal has a more pronounced effect on visual performance. A comparison of the performance before and after removing supplements is provided in Appendix~\ref{app_ablation}. Removing the image similarity evaluation from the fitness function causes a performance decrease of 1.27\%, suggesting that including the comparison between the generated and target images in the fitness function helps guide the evolutionary process and accelerate convergence.
\begin{figure}[h!]
    \centering
    \includegraphics[width=\linewidth]{figures/test.pdf}
    \caption{The convergence curve of EvoStealer, with the left half showing changes in fitness score and the right half depicting performance changes of the optimal prompt template for in-domain and out-of-domain data.}
    \label{fig:iters}
\end{figure}

\begin{figure*}[h!]
    \centering
    \includegraphics[width=0.9\linewidth]{figures/cases.pdf}
    \caption{The attack results of EvoStealer compared to three baseline methods on both easy and hard examples. (a)-(d) represent EvoStealer, CLIP-Interrogator, PromptStealer, and BLIP2, respectively.}
    \label{fig:case}
\end{figure*}
\subsection{Effect of Number of Iterations}

% 我们随机选择20个cases去探讨EvoStealer的收敛，结果如图3所示。图左侧描述的是随着进化进行的适应性分数的变化，右侧描述的是最优模板在in-domain和out-of-domain上的分数变化。从中我们可以看到，随着进化的进行，fitness分数的最优分数和平均分数都在逐步增长，这表明随着进化的进行，EvoStealer能够产生适应度更高的子代。右图表明，随着进化的进行，EvoStealer所窃取的prompt template的质量也在逐步改善。不论是在in-domain还是out-of-domain数据上，提示模板的性能都在稳定的提升。
We select 10 groups of easy and 10 groups of hard cases to examine EvoStealer's convergence~(we use GPT-4o as the analysis model), with results shown in Figure~\ref{fig:iters}. The left section of the figure displays changes in the fitness score as evolution progresses, while the right section shows changes in the scores of the optimal templates for both in-domain and out-of-domain data. We observe that as evolution progresses, both the optimal and average fitness scores gradually increase, indicating that EvoStealer generates offspring with higher adaptability. The performance of the prompt templates steadily improves for both in-domain and out-of-domain data. Two examples are provided in Appendix~\ref{app_progress}


% \subsection{Impact of Different MLLMs}
% % 我们分别使用InterVL2-26B，GPT-4o-mini和GPT-4o进行对比，以探索不同的多模态模型对EvoStealer的影响。结果如表2所示。从中可知，GPT-4o性能最优，InterVL2-26B则相对于GPT-4o和GPT-4o-mini略微差一点，在in-domain和out-of-domain数据上相对于GPT-4o分别下降2.03%和2.28%。但对比表1中的其他baselines，使用InterVL2-26B的EvoStealer仍然显著优于其他baselines。由此我们可以得出两个结论。1. 使用视觉能力更强的模型，窃取的prompt template质量更优；2.现有的开源模型能力足够强，使用开源模型也能够窃取到质量高的prompt template。因此，在需要窃取大量的prompt template时，为了节省开支，使用开源模型是一种值得尝试的方式。
% We compare InterVL2-26B, GPT-4o-mini, and GPT-4o to investigate the impact of different multimodal models on EvoStealer. The results, shown in Table~\ref{tb:models}, indicate that GPT-4o performs the best, while InterVL2-26B slightly lags behind GPT-4o and GPT-4o-mini, with performance 2.03\% and 2.28\% lower than GPT-4o on in-domain and out-of-domain data, respectively. However, when compared to other baseline models in Table~\ref{tb:main_result}, EvoStealer based on InterVL2-26B still the other methods significantly. Two conclusions can be drawn from this: (1) Models with stronger visual capabilities generate higher-quality prompt templates; (2) Existing open-source models are sufficiently powerful, making them a feasible option for stealing high-quality prompt templates and reducing costs when large-scale prompt template stealing is required.

% \input{tables/models}

% \subsection{Effect of Population Size}



\subsection{Cost Analysis}
% \input{tables/cost}
% 为了证明EvoStealer的实用性，我们对EvoStealer窃取一个prompt template进行代价分析。EvoStealer的开销主要包含3个部分：种群吹实话，差分进化（包含fitness函数）以及最终的图片生成。附录D提供了详细的估算过程介绍。由估算结果可知，EvoStealer窃取一个模板需要调用144次API，生成34张图像（包含9张最终的合成图像），共计约需消耗119.1k token，花费1.7美元。尽管所需费用少于平台的3-9美刀售价，但是并不具备显著的优势。然而，根据5.1的消融可知，EvoStealer可通过采用开源模型或者去掉fitness 函数中的图片相似度比较来降低开支，实现接近0成本的窃取。尽管它的性能不如完整的EvoStealer，但性能仍远超其他方法。

To assess the practicality of EvoStealer, we analyzed the cost of stealing a prompt template. The primary overhead of EvoStealer consists of three components: population initialization, differential evolution (including the fitness function), and image synthesis. A detailed cost estimation process is provided in Appendix~\ref{app_cost}. The results indicate that EvoStealer requires 144 API calls, generates 34 images (including 9 final synthesized images), and consumes approximately 119.1k tokens, amounting to a total cost of \$1.70. While this is lower than the platform’s pricing range of \$3–9, the cost advantage is not substantial. However, as demonstrated in the ablation study in Section~\ref{ablation}, costs can be further reduced by using open-source models or omitting image similarity calculations in the fitness function, enabling near-zero-cost stealing. Although this cost-reduced version performs slightly worse than the full EvoStealer model, it still significantly outperforms alternative approaches.
