\begin{figure}[t]
\begin{minted}[escapeinside=||,texcomments]{python}
#Set input dataset
schema = PDFFile
dataset = pz.Dataset(source="sigmod-demo", schema=schema)

#Filter dataset
dataset = dataset.filter("The papers are about colorectal cancer")

#Create new schema
class_name = "ClinicalData"
schema = {"__doc__": "A schema for extracting clinical data datasets from papers."}
field_names = ['name', 'description', 'url']
field_descriptions = ['The name of the clinical data dataset', 
    'A short description of the content of the dataset', 
    'The public URL where the dataset can be accessed']
for idx, field enumerate(field_names):
    desc = field_descriptions[idx]
    attributes[name] = pz.Field(desc=desc)
new_class = type(class_name, (pz.Schema,), attributes)

#Perform conversion
convert_schema = ClinicalData
cardinality = pz.Cardinality.ONE_TO_MANY
dataset = dataset.convert(convert_schema, desc=ClinicalData.__doc__, cardinality=cardinality)

#Execute workload
output = dataset
policy = pz.MaxQuality()
records, execution_stats = Execute(output, policy=policy)
\end{minted}
\caption{The final \system{} pipeline built iteratively using the chat interface for the scientific discovery page.}
\label{fig:finalcode}
\end{figure}