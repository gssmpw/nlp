\subsection{System Model}
In this paper, we study a time division duplex multi-user \gls{mMIMO} system, where uplink channel estimates can be used to calculate the downlink precoder. This \gls{mMIMO} system has a \gls{BS} that is equipped with $N_{\sf{T}}$ antennas. The system is designed to concurrently support $N_{\sf{U}}$ users, each utilizing a single antenna. This configuration enables efficient communication by leveraging the multiple antennas at the \gls{BS} to enhance signal quality and increase capacity, ultimately allowing for simultaneous transmissions to multiple users. 

The received signal at the $k^{th}$ user can be expressed as
\begin{equation}\label{eq:signal_recived}
    \mathbf{y}_k =  \mathbf{h}_{k}^{\dagger} \sum_{\forall k}  \mathbf{w}_{k} x_k + \bs{\eta}_k \, ,
\end{equation}
where the wireless channel vector between the base station (\gls{BS}) and the $k^{th}$ user is represented by $\mathbf{h}_{k} \in \mathbb{C}^{N_{\sf{T}} \times 1}$. Let $x_k$
denote an independent transmitted complex symbol for a user. The term $\bs{\eta}_k \sim \mathcal{CN}(0, \sigma^2)$ indicates complex \gls{AWGN} characterized by a zero mean and a variance of $\sigma^2$. The downlink \gls{FDP} vector is defined as $\mathbf{W} = \left[ \mathbf{w}_1, \ldots, \mathbf{w}_k, \ldots, \mathbf{w}_{N_{\sf{U}}} \right] \in \mathbb{C}^{N_{\sf{T}} \times N_{\sf{U}}}$.
The associated \gls{SINR} user $k$ is given by
\begin{equation}
    \text{SINR}(\mb{w}_{k}) = \frac{ \big|\mb{h}^{\dagger}_{k} \mb{w}_{k} \big|^2}{\sum_{j \neq k} \big|\mb{h}^{\dagger}_{k} \mb{w}_{j} \big|^2 + \sigma^2}\,,
\end{equation}
and the sum rate for all users is
\begin{equation}\label{eq:sum-rate}
    R(\mb{W}) = \sum_{\forall k}  \text{log}_2 \Bigl(  1+ \text{SINR}(\mb{w}_{k}) \Bigr).
\end{equation}
The objective is to determine a precoding matrix $\mathbf{W}$ that maximizes the throughput in eq. (\ref{eq:sum-rate}) while adhering to the maximum transmit power constraint, $P_{\text{max}}$. Consequently, the downlink sum-rate maximization problem can be formulated as
\begin{equation}\label{eq:maximization}
\begin{aligned}
    & \underset{\mb{W}}{\max}~ R(\mb{W}) , \\
    \text{s.t.}  &\sum_{\forall k} \mb{w}_{k}^{\dagger}  \mb{w}_{k} \leq P_{\sf{max}} \, .
\end{aligned}
\end{equation}

\subsection{Weighted Minimum Mean Square Error Algorithm}
The sum-rate maximization problem in (\ref{eq:maximization}) is classified as NP-hard. To find good approximate solutions, the iterative \gls{WMMSE} algorithm \cite{shi2011iteratively} is commonly used, where the problem is transformed to a corresponding problem focused on minimizing the sum of \gls{MSE} under the independence assumption of $x_k$ and $\bs{\eta}_k$. 
Key parameters in this framework include the receiver gain $u_k$ and a positive user weight $v_k$, which are used to obtain the \gls{MSE} covariance matrix. 
The solution is obtained by iteratively solving convex subproblems to generate updates on the receiver gains, user weights, and beamforming matrix.
% The optimization problem involves iteratively updating variables such as the receiver gains, user weights, and beamforming matrices to maximize a redefined objective function while satisfying power constraints. Each variable is optimized sequentially, holding the others constant, ensuring the problem remains convex for individual updates.
% Let $u_k$ represent the receiver gain, while $v_k$ is a positive user weight, hence the \gls{MSE} covariance matrix $e_k$ can be expressed as 
% \begin{align}
% e_k &= \mathop{\mathbb{E}}_{\bs{x},\bs{\eta}} [ (\hat{x_k} - x_k)(\hat{x_k} - x_k)^{\dagger} ]\\
% &= \left( \mathbf{I} - u^{\dagger}_k\mathbf{h}_{k}\mathbf{w}_k\right)\left( \mathbf{I} - u^{\dagger}_k\mathbf{h}_{k}\mathbf{w}_k\right)^{\dagger},\\
% &=  \left| u_{k} \mathbf{h}_{k}^{\dagger} \mathbf{w}_k - 1 \right|^2 +  \sum_{j \neq k}^{N_{\sf{U}}} \left| u_k \mathbf{h}_k^{\dagger} v_j \right|^2  + \sigma^2 \left| u_k \right|^2,
% \end{align}
% thus the optimization problem can be formulated as
% \begin{align}
%     \underset{\mb{u},\mb{v},\mb{W}}{\max}~ & \sum^{N_{\sf{U}}}_{k=1} (v_k e_k - \text{log}_2 v_k) , \\
%    &\text{s.t.}   \sum_{\forall k} \mb{w}_{k}^{\dagger}  \mb{w}_{k} \leq P_{\sf{max}} \, .
% \end{align}
% This optimization problem becomes convex when each variable is considered individually, with the remaining variables held constant. Therefore the \gls{WMMSE} algorithm operates by sequentially updating each variable, 

First $\mathbf{W}^{(0)}$ is initialized while satisfying the constraint in \eqref{eq:maximization},
% in such a way that $\sum_{\forall k} \mb{w}_{k}^{\dagger}  \mb{w}_{k} \leq P_{\sf{max}}$. 
then, at each iteration $i$, variables are updated as defined below until a stopping criterion is satisfied:
\begin{align}
    v^{(\text{i})}_{k} = \frac{ \sum_{j =1}^{N_{\sf{U}}} \big|\mb{h}^{\dagger}_{k} \mb{w}^{(\text{i}-1)}_{j} \big|^2 + \sigma^2}{\sum_{j \neq k}^{N_{\sf{U}}} \big|\mb{h}^{\dagger}_{k} \mb{w}^{(\text{i}-1)}_{j} \big|^2 + \sigma^2},
\end{align}
\begin{align}
    u^{(\text{i})}_{k} = \frac{ \mb{h}^{\dagger}_{k} \mb{w}^{(\text{i}-1)}_{j} }{\sum_{j=1}^{N_{\sf{U}}} \big|\mb{h}^{\dagger}_{k} \mb{w}^{(\text{i}-1)}_{j} \big|^2 + \sigma^2},
\end{align}
\begin{align}\label{eq:construct_beamforming_matrix}
    \mb{w}^{(\text{i}+1)}_{k} =  u^{(\text{i})}_{k} v^{(\text{i})}_{k}\mb{h}_{k}(\sum^{N_{\sf{U}}}_{j=1}   v^{(\text{i})}_{j} |u^{(\text{i})}_{j}|^2 \mb{h}_{j}\mb{h}_{j}^{\dagger} + \mu \mathbf{I})^{-1},
\end{align}
where $\mu \geq 0$ is a Lagrange multiplier.
In addition to the high complexity of solving \gls{WMMSE}, the inherent non-convexity of sum-rate maximization means that WMMSE is only guaranteed to converge to a local optimum, not necessarily the global solution.