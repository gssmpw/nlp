\begin{figure*}
    \centering
    \begin{tikzpicture}

        % INPUT channels

        \node[left] at (0,1) {Channel C};
        \node[rotate=270] at (-0.75,1.75) {$\ldots$};
        \node[left] at (0,2.5) {Channel 2};
        \node[left] at (0,4) {Channel 1};

        \node at (2,0) {Input} ;

        % First rectangle for softblue series
        \draw[black] (0.25, 0.5) rectangle (3.75, 1.5);
        \draw[softblue, smooth] plot coordinates {
            (0.5, 1) (0.83, 1.25) (1.16, 1.1) (1.49, 1.2) (1.82, 0.9)
            (2.15, 1.05) (2.48, 0.85) (2.81, 0.85) (3.14, 0.95) (3.47, 0.8)
        };
        \foreach \x/\y in {1.49/1.2, 1.82/0.9, 2.0/0.965} {
            \draw[fill=softblue] (\x,\y) circle (0.07cm);
        }
        \foreach \x/\y in {2.81/0.85} {
            \draw[fill=softblue,opacity=0.5] (\x,\y) circle (0.07cm);
        }
        \draw[  dotted] (2.7,0.5) -- (2.7,1.5) ;
        \draw[fill=softred,opacity=0.3] (2.7,0.5) rectangle (3.75,1.5) ; 
        \node at (3.55,1.35) {\scriptsize $Q_C$}; 

        \draw[](0.25,1.5) -- (0.25,1.6) -- (2.7,1.6) -- (2.7,1.5);  
        \draw[->, rounded corners=5pt](1.475,1.6) -- (1.475,1.8) -- (4.25,1.8) --(4.25,1) -- (5,1) ;

    
        % Second rectangle for softred (orange) series, shifted up by 1 unit
        \draw[ black] (0.25, 2) rectangle (3.75, 3);
        \draw[softred, smooth] plot coordinates {
            (0.5, 2.75) (0.83, 2.35) (1.16, 2.35) (1.49, 2.5) (1.82, 2.55)
            (2.15, 2.7) (2.48, 2.6) (2.81, 2.45) (3.14, 2.4) (3.47, 2.6)
        };
        \foreach \x/\y in {0.65/2.535, 1.16/2.35, 2.48/2.6} {
            \draw[fill=softred] (\x,\y) circle (0.07cm);
        }
        \foreach \x/\y in {3.14/2.4} {
            \draw[fill=softred, opacity=0.5] (\x,\y) circle (0.07cm);
        }
        \draw[dotted] (2.7,2) -- (2.7,3) ;
        \draw[fill=softred,opacity=0.3] (2.7,2) rectangle (3.75,3) ; 
        \node at (3.55,2.85) {\scriptsize $Q_2$}; 

        \draw[](0.25,3) -- (0.25,3.1) -- (2.7,3.1) -- (2.7,3);  
        \draw[->,rounded corners=5pt](1.475,3.1) -- (1.475,3.3) -- (4.25,3.3) --(4.25,2.5) -- (5,2.5) ;

    
        % Third rectangle for softgreen series, shifted up by 1 unit
        \draw[black] (0.25, 3.5) rectangle (3.75, 4.5);
        \draw[softgreen, smooth] plot coordinates {
            (0.5, 4) (0.83, 3.9) (1.16, 3.8) (1.49, 3.95) (1.82, 4.05)
            (2.15, 4.15) (2.48, 4) (2.81, 3.9) (3.14, 3.8) (3.47, 3.75)
        };
        \foreach \x/\y in {0.5/4, 1.82/4.05} {
            \draw[fill=softgreen] (\x,\y) circle (0.07cm);
        }
        \foreach \x/\y in {2.95/3.86, 2.81/3.9, 3.47/3.75} {
            \draw[fill=softgreen, opacity=0.5] (\x,\y) circle (0.07cm);
        }
        \draw[dotted,rounded corners=5pt] (2.7,3.5) -- (2.7,4.5) ;
        \draw[fill=softred,opacity=0.3] (2.7,3.5) rectangle (3.75,4.5) ; 
        \node at (3.55,4.35) {\scriptsize $Q_1$}; 

        \draw[](0.25,4.5) -- (0.25,4.6) -- (2.7,4.6) -- (2.7,4.5);  
        \draw[->, rounded corners=5pt](1.475,4.6) -- (1.475,4.8) -- (4.25,4.8) --(4.25,3.5) -- (5,3.5) ;

        % Channel aggregation
        \draw[fill=pastelyellow,opacity=1,rounded corners=5pt] (5,0.75) rectangle (6,1.25); 
        \draw[fill=pastelyellow, opacity=1,rounded corners=5pt] (5,2.25) rectangle (6,2.75); 
        \draw[fill=pastelyellow, opacity=1, rounded corners=5pt] (5,3.25) rectangle (6,3.75);
        
        \node at (5.5,1) {$Z_C$};
        \node[rotate=270] at (5.5,1.75) {$\ldots$};
        \node at (5.5,2.5) {$Z_2$};
        \node at (5.5,3.5) {$Z_1$};

        %Bias
       % \draw[thick] (5.2,-0.3) rectangle (5.8,0.1);
       % \draw[   ->] (5.5,0.1) -- (5.5,0.5);
       % \node[right] at (5.5,0.3) {$+$} ;
       % \node at (5.5,-0.1) {$b_3$} ;

%
       % \draw[thick] (5.2,1.45) rectangle (5.8,1.85);
       % \draw[   ->] (5.5,1.85) -- (5.5,2.25);
       % \node[right] at (5.5,2.05) {$+$} ;
       % \node at (5.5,1.65) {$b_2$} ;

        \draw[  fill=relublue,opacity=1, rounded corners=5pt] (5.2,-0.5) rectangle (5.8,0);
        \draw[   ->] (5.5,0) -- (5.5,0.5);
        \node[right] at (5.5,0.25) {$+$};
        \node at (5.5,-0.25) {$b_c$};


        %\draw[thick] (7.5,1) rectangle (8,4);
       % \draw[thick] (8.5,1) rectangle (9,4);
        %\draw[thick] (9.5,1) rectangle (10,4);

      %  \draw[   ->] (6,0.75) -- (6.75,0.75) -- (6.75,2.35) ;
      %  \draw[   ->] (6,4.25) -- (6.75,4.25) -- (6.75,2.65) ;
      %  \draw[   ->] (6,2.5) -- (6.65,2.5); 
      %  \draw[   ->] (6.85,2.5) -- (7.5,2.5); 
      %  \node at (6.75,2.5) {$||$};

        \draw[dotted, rounded corners=5pt] (4.75, 0.5) rectangle (6.25,4);
        \draw[thick ,->] (6.25,2.25) -- (7,2.25) ; 
 

        %\node[rotate=270] at (7.75,2.5) {Mixer Block 1};
        %\draw[  ->] (8,2.5) -- (8.5,2.5) ; 
        %\node[rotate=270] at (8.75,2.5) {$\ldots$};
        %\draw[  ->] (9,2.5) -- (9.5,2.5) ;
        %\node[rotate=270] at (9.75,2.5) {Mixer Block $L$};
        \node at (7,4.8) {$\times L$} ; 
        \draw[fill=steelblue,opacity=0.5,rounded corners=5pt] (7.3, 0.3) rectangle (9.3, 4.8) ; 
        \draw[fill=steelblue,opacity=0.6,rounded corners=5pt] (7.15, 0.15) rectangle (9.15, 4.65) ; 
        \draw[fill=steelblue,opacity=1,rounded corners=5pt] (7, 0) rectangle (9, 4.5) ;
        \node at (8,2.25) {Mixer Block} ;

        \draw[  ->] (9.3,2.3) --(9.75,2.3) ; 

         % Channel aggregation
         \draw[  fill=pastelyellow,opacity=1,rounded corners=5pt] (10,0.75) rectangle (11,1.25); 
         \draw[  fill=pastelyellow, opacity=1,rounded corners=5pt] (10,2.25) rectangle (11,2.75); 
         \draw[  fill=pastelyellow, opacity=1,rounded corners=5pt] (10,3.25) rectangle (11,3.75);
         
         \node at (10.5,1) {$Z_C$};
         \node[rotate=270] at (10.5,1.75) {$\ldots$};
         \node at (10.5,2.5) {$Z_2$};
         \node at (10.5,3.5) {$Z_1$};
         %\draw[dotted] (9.75, 0.5) rectangle (11.25,4);


         \draw[  fill=relublue,opacity=1, rounded corners=5pt] (11.7,0.75) rectangle (13,1.25); 
         \draw[  ->] (11,1) -- (11.7,1);
         \node at (12.35,1) {Decoder} ;
         \draw[   ->] (13,1) -- (13.75,1);
         \draw[   fill=softred,opacity=0.4, rounded corners=5pt] (11.7,0) rectangle (12.4,0.5);
         \draw[  ->, rounded corners=5pt] (12.4,0.25) -- (12.7,0.25) -- (12.7,0.75);
         \node at (12.05,0.25) {\small $Q_C$} ; 



         \draw[   fill=relublue,opacity=1, rounded corners=5pt] (11.7,2.25) rectangle (13,2.75); 
         \draw[  ->] (11,2.5) -- (11.7,2.5);
         \node at (12.35,2.5) {Decoder} ;
         \draw[   ->] (13,2.5) -- (13.75,2.5);
         \draw[   fill=softred,opacity=0.4, rounded corners=5pt] (11.7,1.5) rectangle (12.4,2);
         \draw[  ->, rounded corners=5pt] (12.4,1.75) -- (12.7,1.75) -- (12.7,2.25);
         \node at (12.05,1.75) {\small $Q_2$} ; 


         \draw[  fill=relublue,opacity=1, rounded corners=5pt] (11.7,3.75) rectangle (13,4.25); 
         \draw[  ->, rounded corners=5pt] (11,3.5) -- (11.35,3.5) -- (11.35,4.) -- (11.7,4.);
         \node at (12.35,4) {Decoder} ;
         \draw[   ->] (13,4) -- (13.75,4);
         \draw[  fill=softred,opacity=0.4, rounded corners=5pt] (11.7,3) rectangle (12.4,3.5);
         \draw[  ->, rounded corners=5pt] (12.4,3.25) -- (12.7,3.25) -- (12.7,3.75);
         \node at (12.05,3.25) {\small $Q_1$} ; 


         \draw[ black] (13.75, 0.5) rectangle (15.25, 1.5);
         \draw[  dotted, rounded corners=5pt] (14.2,0.5) -- (14.2,1.5) ;
         \draw[   softblue, smooth] plot coordinates {
            (13.75, 0.95) (2.5 +11.5, 0.85)  (2.81 + 11.5, 0.85) (3.14 +11.5, 0.95) (3.47 +11.5, 0.8)
        };
        \foreach \x/\y in {11.5 + 2.81/0.85} {
            \draw[fill=softblue] (\x,\y) circle (0.07cm);
        }

         \draw[ black] (13.75, 2) rectangle (15.25, 3);
         \draw[  dotted, rounded corners=5pt] (14.2,2) -- (14.2,3) ;
         \draw[   softred, smooth] plot coordinates {
            (13.75, 2.7) (2.48 + 11.5, 2.6) (2.81+ 11.5, 2.45) (3.14 + 11.5, 2.4) (3.47+11.5, 2.6)
        };

        \foreach \x/\y in {3.14 +11.5 /2.4} {
            \draw[fill=softred] (\x,\y) circle (0.07cm);
        }


         \draw[black] (13.75, 3.5) rectangle (15.25, 4.5);
         \draw[  dotted] (14.2,3.5) -- (14.2,4.5) ;
         \draw[   softgreen, smooth] plot coordinates {
            (13.75, 4.1) (2.48+11.5, 4) (2.81+11.5, 3.9) (3.14 + 11.5, 3.8) (3.47 +11.5, 3.75)
        };
        \foreach \x/\y in {2.95+11.5/3.86, 2.81+11.5/3.9, 3.47+11.5/3.75} {
            \draw[fill=softgreen] (\x,\y) circle (0.07cm);
        }

        \node at (14.5,0) {Output} ;







    
    \end{tikzpicture}
    
    
    \caption{ Overview of \model{}'s architecture}\label{fig:model}
    \Description{An awesome model architecture}
\end{figure*}