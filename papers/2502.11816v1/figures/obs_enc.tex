\begin{figure}
    \centering
    \begin{tikzpicture}[x=1cm, y=1cm]
        \draw[fill=veryverylightgreen,rounded corners=3pt] (-0.6,0) rectangle (1.1,0.5); 
        \node at (0.25,0.25) {$T_c \in \R^{N_c \times 1}$};
        \draw[->] (0.25,0.5) -- (0.25,1);

        \draw[fill=veryverylightyellow,rounded corners=3pt] (1.45,0) rectangle (3.15,0.5); 
        \node at (2.3,0.25) {$V_c \in \R^{N_c \times 1}$};
        \draw[->] (2.3,0.5) -- (2.3,1);


        \draw[fill=relublue ,rounded corners=3pt] (1.45,1) rectangle (3.15,1.5); 
        \node at (2.3,1.25) {\small $\FC(1 \to D)$};
        \draw[->, rounded corners=3pt] (2.3,1.5) -- (2.3,2.75) -- (1.4,2.75);
        \draw[->, rounded corners=3pt] (2.3,1.5) -- (2.3,2.75) -- (3.35,2.75);


        %\draw[fill=pastelyellow] (-0.7,0.8) rectangle (1.2,2.6);
        %\node[right] at (-0.7,2.45) {\scriptsize{$\text{MLP}_\text{emb}$}};

        \draw[fill=relublue, opacity=1,rounded corners=3pt] (-0.6,1) rectangle (1.1,2.3); 
        \node at (0.25,1.25) {\small$\FC (1 \to D^{\prime})$};

        \draw[fill=verysoftred,rounded corners=0pt] (-0.6,1.5) rectangle (1.1,1.8); 
        \node at (0.25, 1.65) {\small{relu}};

        %\draw[fill=relublue, opacity=1,rounded corners=3pt] (-0.6,1.8) rectangle (1.1,2.3); 
        \node at (0.25,2) {\small$\FC(D^{\prime} \to D)$};
        \draw[->,rounded corners=3pt] (0.25,2.3) -- (0.25,2.75) -- (1.1,2.75);

    
        %\draw[fill=pastelyellow] (3.8,0.8) rectangle (5.7,2.6);
        %\node[right] at (3.8,2.45) {\scriptsize{$\text{MLP}_\text{w}$}};
        \draw[fill=relublue, rounded corners=3pt] (3.8,1) rectangle (5.5,2.3); 
        \node at (4.65,1.25) {\small $\FC (1 \to D^\prime)$};

        \draw[fill=verysoftred , rounded corners=0pt] (3.8,1.5) rectangle (5.5,1.8); 
        \node at (4.65, 1.65) {\small{relu}};

        %\draw[fill=relublue, rounded corners=3pt] (3.8,1.8) rectangle (5.5,2.3); 
        \node at (4.65,2) {\small $\FC (D^\prime \to D)$};
        \draw[->,rounded corners=3pt] (4.65,2.3) -- (4.65,2.75) -- (3.65,2.75);

        \node at (1.25,2.75) {\large{$\mathbf{\odot}$}};

        \node at (3.5,2.75) {\large{$\mathbf{+}$}};
        \draw[-> ] (1.25,2.9) -- (1.25,3.3);

        \draw[rounded corners=3pt,fill=pastelyellow,opacity=1] (0.25,3.3) rectangle (2.25,3.8) ; 
        \node at (1.25,3.55) {$H_c \in \R^{N_c \times D}$};

        \draw[-> ] (3.5,2.9) -- (3.5,3.3);

        \draw[rounded corners=3pt,fill=pastelyellow,opacity=1] (2.5,3.3) rectangle (4.5,3.8) ; 
        \node at (3.5,3.55) {$A_c \in \R^{N_c \times D}$};
        \draw[->] (3.5,3.8) -- (3.5,4.1) ; 

        \draw[rounded corners=3pt,fill=verysoftred] (2.75,4.1) rectangle (4.25,4.4) ; 
        \node at (3.5,4.25) {\small{softmax}};

        \draw[->,rounded corners=3pt] (0.25,0) --(0.25,-0.5) -- (4.65,-0.5) -- (4.65,1);

        \draw[->,rounded corners=3pt] (1.25,3.8) -- (1.25,4.2) -- (1.7,4.2) -- (1.7,4.7);
        \draw[->,rounded corners=3pt] (3.5,4.4) -- (3.5,4.5) -- (3.05,4.5) -- (3.05,4.7);

        \draw[rounded corners=3pt,fill=transgray,opacity=1] (1.2, 4.7) rectangle (3.4, 5.3);
        \node at (2.3,5) {\small{$\sum^{N_c}_{i=1} H_c^{(i)} \odot W_c^{(i)}$}};
        \draw[->] (2.3,5.3) -- (2.3,5.6) ;


        \draw[rounded corners=3pt,fill=pastelyellow,opacity=1] (1.3,5.6) rectangle (3.3,6.1) ; 
        \node at (2.3,5.85) {$Z_c \in \R^D$};
 




    \end{tikzpicture}
    \caption{\model{}'s channel aggregation architecture.
    For simplicity, we split a channel $X_c$ into the observation times $T_c$ and observed values $V_c$.
    For each channel, the aggregation module shown summarizes a varying number of observation tuples into a fixed-sized vector $Z_c$.
    We use $\FC(A \to B)$ to symbolize a single fully connected linear layer with A input and B output neurons.}\label{fig:obs_enc}
    \Description{An awesome model architecture}
\end{figure}