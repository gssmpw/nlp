\section{Related work}
\label{sec:related-work}
This section reviews existing approaches to enforce constraints in NNs. According to the focus of this paper, a more in-depth analysis will be conducted on existing methods for enforcing algebraic equality constraints exactly.

\subsection{Soft-constrained neural networks}
% - Defined as early attempts to include constraints. Cite Raissi, Lu, maybe perdikaris and kardianakis.\\
One of the earliest approaches to embedding domain knowledge into NNs involves the use of \textit{soft} constraints. Soft constraints are incorporated as penalty terms appended to the loss function, penalizing residuals of algebraic____ or differential equations underlying the system____. Physics-informed neural networks (PINNs)____ represent a widely used framework designed to solve partial differential equations (PDEs) with NNs by employing soft constraints and collocation points.\ Although the soft-constrained approach places no restrictions on the complexity of the constraints, it has the drawback of not guaranteeing strict adherence to them. Furthermore, increasing the complexity of the loss function -- especially when the different terms vary in nature or scale -- can degrade the optimization performance of the neural network, often resulting in suboptimal accuracy____.

\subsection{Hard-constrained neural networks}
\label{subsec:related-work-hard}
Hard-constrained NNs refer to methodological approaches ensuring that neural network predictions strictly adhere to analytical constraints. These constraints, explicitly encoded within the architecture, act as inductive biases, guiding the learning process toward compliance with domain knowledge or restrictions____. Architectures such as convolutional neural networks (CNNs)____ and graph neural networks (GNNs)____ encode inductive biases by guaranteeing invariance with respect to patterns and symmetries. Simple analytical constraints can be enforced using differentiable functions, such as sigmoids or ReLU for output bounding and softmax for simplex constraints (non-negativity and normalization). Recent literature includes significant contributions for enforcing analytical inequality constraints, such as convex polytopes and convex sets more generally____. One can also constrain the neural network to guarantee specific functional characteristics, such as being 1-Lipschitz____ or Lyapunov stable____, nevertheless, this is not a core objective of this study. For a broad and recent review on hard-constrained NNs, the reader is also referred to____.\\
Since this paper focuses on analytical equality constraints, the following literature review considers existing methods for this specific case. 

\paragraph{Projection methods}
Many methods for encoding hard equality constraints utilize projection techniques, which correct preliminary neural network predictions by appending a non-trainable layer to the output. Projections can be formulated as optimization problems (e.g., distance minimization) or derived from geometric principles. For example, in____ NN predictions of physical systems governed by PDEs are projected to ensure solutions satisfy the finite difference discretization of the underlying linear PDEs. A more general approach is the KKT-hPINN____, which enforces linear equality constraints of the form $Ax+By=b$, though its applicability is limited to affine equations. Recently, HardNet____ was introduced to enforce equality and inequality constraints affine in the output, without input restrictions, via a closed-form projection step. HardNet-Cvx____ extends this approach to more general convex functions in the inputs, leveraging differentiable optimization layers supported by optimization solvers____.

\paragraph{Predict-and-complete}
Alternatively, the neural network can predict a partial set of output variables, $y_P \in \mathbb{R}^{N_O - N_C}$, and complete the prediction by solving the system of constraints based on this partial output. This approach ensures that the constraints are always satisfied. For instance, Beucler et al. introduced this concept to simulate physical systems such as climate modeling____. However, when the constraints are not explicitly defined, solving the system requires a root-finding solver. Similar approaches have been proposed within the hybrid modeling community, particularly in the \textit{serial} configuration, where a fully data-driven method is used to predict certain inputs to a mechanistic model____. While studies like DC3____ have developed efficient backpropagation techniques, scenarios involving implicit nonlinear constraints can be computationally expensive to tackle with predict-and-complete methods. Moreover, the predict-and-complete approach can reduce regression accuracy by hindering the representation capabilities of NNs____.


\paragraph{Constrained optimization}
One of the most popular fields of application of constrained learning is for solving (parametric) constrained optimization problems using NNs____. OptNet____ is an optimization layer developed to solve quadratic programs. Angrawal et al.____ expands the methodology to convex programs. They develop efficient differentiation techniques through such layers. However, the forward pass always requires the solution of a constrained optimization problem. Recently, Mukherjee and Bhattacharyya____ brute-forced the constrained learning paradigm by training a neural network using an NLP solver such as IPOPT____ instead of standard unconstrained optimization algorithms. Also, NNs have been formulated as constrained optimization problems and solved using deterministic global solvers____. However, these approaches pose severe limitations in terms of NNs and dataset size.


\paragraph{Other methods}
Other methods have been proposed for constrained learning in NNs, mostly considering affine or convex regions. Many of them consider constraints only dependent on the input of the neural network____, others design strategies to include the dependence on both inputs and outputs____. Recently, contributions to enforce general logic and linear constraints have been proposed by the neuro-symbolic AI community, developing constraining layers using logic programming to improve multi-label classification and synthetic data generation____.\\
However, to the best of our knowledge, there is no method designed to enforce any nonlinear equality constraints involving both the input and the output of the neural network by encoding them in the architecture and without relying on external solvers.