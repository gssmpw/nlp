\section{Results}
\label{sec:Results}

In this section, we present various analysis results that demonstrate the adoption of code obfuscation in Google Play.

\subsection{Overall Obfuscation Trends} 
\label{sec:obstrend}

\subsubsection{Presence of obfuscation} Out of the 548,967 Google Play Store APKs analyzed, we identified 308,782 obfuscated apps, representing approximately 56.25\% of the total. In Figure~\ref{fig:obfuscated_percentage}, we show the year-wise percentage of obfuscated apps for 2016-2023. There is an overall obfuscation increase of 13\% between 2016 and 2023, and as can be seen, the percentage of obfuscated apps has been increasing in the last few years, barring 2019 and 2020. As explained in Section~\ref{subsec:dataset}, 2019 and 2020 contain apps that are more likely to be abandoned by developers, and as such, they may not use advanced development practices.

\begin{figure}[h!]
\centering
    \includegraphics[width=\linewidth]{Figures/Only_obfuscation_trendV2.pdf}
    \caption{Percentage of obfuscated apps by year} \vspace{-4mm}
    \label{fig:obfuscated_percentage}
\end{figure}


From 2016 to 2018, the obfuscation levels were relatively stable at around 50-55\%, while from 2021 to 2023, there was a marked rise, reaching approximately 66\% in 2023. This indicates a growing focus on app protection measures among developers, likely driven by heightened security and IP concerns and the availability of advanced obfuscation tools.


\subsubsection{Obfuscation tools} Among the obfuscated APKs, our tool detector identified that 40.92\% of the apps use Proguard, 36.64\% use Allatori, 1.01\% use DashO, and 21.43\% use other (i.e., unknown) tools. We show the yearly trends in Figure~\ref{fig:ofbuscated_tool}. Note that we omit results in 2019 and 2020 ({\bf cf.} Section~\ref{subsec:dataset}).

ProGuard and Allatori are the most consistently used obfuscation tools, with ProGuard showing a slight overall increase in popularity and Allatori demonstrating variability. This inclination could be attributed to ProGuard being the default obfuscator integrated into Android Studio, a widely used development environment for Android applications. Notably, ProGuard usage increased by 13\% from 2018 to 2021, likely due to the introduction of R8 in April 2019~\cite{release_note_android}, which further simplified ProGuard integration with Android apps.

\begin{figure}[h]
\centering
    \includegraphics[width=\linewidth]{Figures/Initial_Tool_Trend_2019_dropV2.pdf} 
    \caption{Yearly obfuscation tool usage}
    \label{fig:ofbuscated_tool}
\end{figure}


DashO consistently remains low in usage, likely due to its high cost. The use of other obfuscation tools decreased until 2018 but has shown a resurgence from 2021 to 2023. This suggests that developers might be using other or custom tools, or our detector might be predicting some apps obfuscated with Proguard or Allatori as `other.' To investigate, we manually checked a sample of apps from the `other' category and confirmed they are indeed obfuscated. However, we could not determine which obfuscation tools the developers used. We discuss this potential limitation further in Section~\ref{sec:limitations}.


\subsubsection{Obfuscation techniques} We show the year-wise breakdown of obfuscation technique usage in Figure~\ref{fig:obfuscated_tech}. Among the various obfuscation techniques, Identifier Renaming emerged as the most prevalent, with 99.62\% of obfuscated apps using it alone or in combination with other methods (Categories of Only IR, IR and CF, IR and SE, or All three). Furthermore, 81.04\% of obfuscated apps used Control Flow Modification, and 62.76\% used String Encryption. The pervasive use of Identifier Renaming (IR) can be attributed to the fact that all obfuscation tools support it ({\bf cf.} Table~\ref{tab:ob_tool_cap}). Similarly, lower adoption of Control Flow Modification and String Encryption can be attributed to Proguard not supporting it. 

\begin{figure}[h]
\centering
    \includegraphics[width=\linewidth]{Figures/Initial_Tech_Trend_2019_dropV2.pdf} 
    \caption{Yearly obfuscation technique usage}
    \label{fig:obfuscated_tech}
\end{figure}



Next, we investigate the adoption of obfuscation on Google Play Store from various perspectives. Same as earlier, due to the smaller dataset size and possible bias ({\bf cf.} Section~\ref{subsec:dataset}), we exclude the APKs from 2019 and 2020 from this analyses.


\subsection{App Genre}
\label{sec:app_genre}

First, we investigate whether the obfuscation practices vary according to the App genre. Initially, we analysed all the APKs together before separating them into two snapshots.


\begin{figure*}[h]
    \centering
    \includegraphics[width=\linewidth]{Figures/AppGenreObfuscationV3.pdf}
    \caption{Obfuscated app percentage by genre (overall)}
    \label{fig:app_genre_overall}
\end{figure*}

Figure~\ref{fig:app_genre_overall} shows the genre-wise obfuscated app percentage. We note that 19 genres have more than 60\% of the apps obfuscated, and almost all the genres have more than 40\% obfuscation percentage. \textit{Casino} genre has the highest obfuscation percentage rate at 80\%, and overall, game genres tend to be more obfuscated than the other genres. The higher obfuscation usage in casino apps is logical due to their nature. These apps often simulate or involve gambling activities and handle monetary transactions and sensitive data related to in-game purchases, making them attractive targets for reverse engineering and hacking. This necessitates robust security measures to prevent fraud and protect user data. 


\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{Figures/AppGenre2018_2023ComparisonV3.pdf}
    \caption{Percentage of obfuscated apps by genre (2018-2023)}
    \label{fig:app_genre_comparison}
\end{figure}



\subsubsection{Genre-wise obfuscation trends in the two snapshots} To investigate the adoption of obfuscation over time, we study the two snapshots of Google Play separately, i.e., APKs from 2016-2018 as one group and APKs from 2021-2023 as another. 

Figure~\ref{fig:app_genre_comparison} illustrates the change in obfuscation levels by app genre between 2016-2018 to 2021-2023. Notably, app categories such as Education, Weather, and Parenting, which had obfuscation levels below the 2018 average, have increased to above the 2023 average by 2023. One possible reason for this in Education and Parenting apps can be the increase in online education activities during and after COVID-19 and the developers identifying the need for app hardening.

There are some genres, such as Casino and Action, for which the percentage of obfuscated apps didn't change across the two snapshots (i.e., purple and orange circles are close together in Figure~\ref{fig:app_genre_comparison}). This is because these genres are highly obfuscated from the beginning. Finally, the four genres, including Simulation and Role Playing, have a lower percentage of obfuscated apps in the 2021-2023 dataset. Our manual analysis didn't result in a conclusion as to why.


\begin{figure}[!h]
    \centering
    \includegraphics[width=\linewidth]{Figures/AppGenreTechAllV5.pdf}
    \caption{Obfuscation technique usage by genre (overall)}
    \label{fig:app_genre_all_tech}
\end{figure}


\subsubsection{Obfuscation techniques in different app genres} In Figure~\ref{fig:app_genre_all_tech}, we show the prevalence of key obfuscation techniques among various genres. As expected, almost all obfuscated apps in all genres used  Identifier Renaming. Also, it can be noted that genres with more obfuscated app percentages tend to use all three obfuscation techniques. Notably, more than 85\% of \textit{Casino} genre apps employ multiple obfuscation techniques

\subsubsection{Obfuscation tool usage in different app genres} We also investigated whether specific obfuscation tools are favoured by developers in different genres. However, apart from the expected observation that  ProGuard and Allatori being the most used tools, we didn't find any other interesting patterns. Therefore, we haven't included those measurement results.

\subsection{App Developers}
Next, we investigate individual developer-wise code obfuscation practices. From the pool of analyzed APKs, we identified the number of apps associated with each developer. Subsequently, we sorted the developers according to the number of apps they had created and selected the top 100 developers with the highest number of APKs for the 2016-2018 and 2021-2023 datasets. For the 2018 snapshot, we had 8,349 apps among the top 100 developers, while for the 2023 snapshot, we had 11,338 apps among the top 100 developers.

We then proceeded to detect whether or not these developers obfuscate their apps and, if so, what kind of tools and techniques they use. We present our results in five levels; developer obfuscating over 80\% of their apps, 60\%--80\% of apps, 40\%--60\% of apps, less than 40\%, and no obfuscation.

Figure~\ref{fig:developer_trend_my_apps_all} compares the two datasets in terms of developer obfuscation adoption. It shows that more developers have moved to obfuscate more than 80\% of their apps in the 2021-2023 dataset (76\%) compared to the 2016-2018 dataset (48\%).

We also found that among developers who obfuscate more than 80\% of their apps, 73\% in 2018 and 93\% in 2023 used the same obfuscation tool. Additionally, these top developers employ Control Flow Modification (CF) and String Encryption (SE) above the average values discussed in Section~\ref{sec:obstrend}. Specifically, in 2018, top developers used CF in 81.3\% of cases and SE in 66.7\%, while in 2023, these figures increased to 88.2\% and 78.9\%. This results in two insights: 1) Most top developers obfuscate all their apps with advanced techniques, possibly due to concerns about IP and security, and 2) Developers stick to a single tool, possibly due to specialized knowledge or because they bought a commercial licence.

\begin{figure}[]
    \centering
    \includegraphics[width=\linewidth]{Figures/Developer_Analysed_Comparison.pdf}
    \caption{Obfuscation usage (Top-100 developers)}
    \label{fig:developer_trend_my_apps_all}
\end{figure}


Finally, we investigate the obfuscation practices of developers with only one app in Table~\ref{tab:my-table}. According to the table, from those developers, 45.5\% of them obfuscated their apps in the 2016-2018 dataset and 57.2\% obfuscated their apps in the 2021-2023 dataset, showing a clear increase. However, these percentages are approximately 10\% lower than the average obfuscation rate in both cohorts discussed in Section~\ref{sec:obstrend}. This indicates that single-app developers may be less aware or concerned about code protection.


\begin{table}[]
\caption{Developers with only one app}
\label{tab:my-table}
\resizebox{\columnwidth}{!}{%
\begin{tabular}{cccccc}
\hline
\textbf{Year} & \textbf{\begin{tabular}[c]{@{}c@{}}Non\\ Obfuscated\end{tabular}} & \multicolumn{4}{c}{\textbf{Obfuscated}} \\ \hline
\multirow{3}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}2018 \\ Snapshot\end{tabular}}} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}26,581 \\ (54.5\%)\end{tabular}} & \multicolumn{4}{c}{\begin{tabular}[c]{@{}c@{}}22,214 (45.5\%)\end{tabular}} \\ \cline{3-6} 
 &  & \textbf{ProGuard} & \textbf{Allatori} & \textbf{DashO} & \textbf{Other} \\ \cline{3-6} 
 &  & 6,131 & 8,050 & 658 & 7,375 \\ \hline
\multirow{3}{*}{\textbf{\begin{tabular}[c]{@{}c@{}}2023 \\ Snapshot\end{tabular}}} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}19,510 \\ (42.8\%)\end{tabular}} & \multicolumn{4}{c}{\begin{tabular}[c]{@{}c@{}}26,084 (57.2\%)\end{tabular}} \\ \cline{3-6} 
 &  & \textbf{ProGuard} & \textbf{Allatori} & \textbf{DashO} & \textbf{Other} \\ \cline{3-6} 
 &  & 12,697 & 9,672 & 234 & 3,581 \\ \hline
\end{tabular}%
}
\end{table}

\subsection{Top-k Apps}

Next, we investigate the obfuscation practices of top apps in Google Play Store. First, we rank the apps using the same criterion used by our previous work~\cite{rajasegaran2019multi, karunanayake2020multi, seneviratne2015early}. That is, we sort the apps in descending order of number of downloads, average rating, and rating count, with the intuition that top apps have high download numbers and high ratings, even when reviewed by a large number of users. Then, we investigated the percentage of obfuscated apps and obfuscation tools and technique usage as summarized in Table~\ref{tab:top_k_apps_2018_2023}.

When considering the highly ranked applications (i.e., top-1,000), the obfuscation percentage is notably higher, at around 93\%, in both datasets, which is significantly higher than the average percentage of obfuscation we observed in Section~\ref{sec:obstrend}. Top-ranked apps, likely due to their higher visibility and potential revenue, invest more in obfuscation to safeguard their intellectual property and enhance security. 

The obfuscation percentage decreases when going from the top 1,000 apps to the top 30,000 apps. Nonetheless, the obfuscation percentage in both datasets remains around similar values until the top 30,000 (e.g., $\sim$74\% for top-30,000). This indicates that the major increase in obfuscation in the 2021-2023 dataset comes from apps beyond the top 30,000.

When observing the tools used, the usage of ProGuard increases as we move from top to lower-ranked apps in both datasets. This may be because ProGuard is free and the default in Android Studio, while commercial tools like Allatori and DashO are expensive. There is a notable increase in the use of Allatori among the top apps in the 2021-2023 dataset. Regarding obfuscation techniques, the top 1,000 apps utilize all three techniques more frequently than lower-ranked apps in both snapshots. This indicates that the top 1,000 apps are more heavily protected compared to lower-ranked ones.

\begin{table*}[]
\caption{Summary of analysis results for Top-k apps in 2018 and 2023}
\label{tab:top_k_apps_2018_2023}
\resizebox{\textwidth}{!}{%
\begin{tabular}{lccccccccc}
\hline
\multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Top k apps - \\ Year\end{tabular}} & \begin{tabular}[c]{@{}c@{}}Total \\ Apps\end{tabular} & \begin{tabular}[c]{@{}c@{}}Obfuscation\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}ProGuard\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}Allatori\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}DashO\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}Other\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}IR\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}CF\\ Percentage\end{tabular} & \begin{tabular}[c]{@{}c@{}}SE\\ Percentage\end{tabular} \\ \hline
1k (2018) & 1,000 & 93.40 & 29.98 & 28.48 & 0.64 & 40.90 & 99.90 & 88.76 & 65.42 \\
10k (2018) & 10,000 & 85.19 & 25.55 & 35.32 & 0.47 & 38.65 & 99.90 & 88.76 & 71.91 \\
20k (2018) & 20,000 & 78.42 & 26.31 & 36.76 & 0.57 & 36.36 & 99.87 & 87.37 & 71.49 \\
30k (2018) & 30,000 & 74.40 & 27.30 & 37.71 & 0.64 & 34.36 & 99.82 & 86.75 & 71.11 \\
30k+ (2018) & 314,568 & 53.36 & 36.72 & 34.70 & 1.33 & 27.24 & 99.34 & 83.54 & 63.11 \\ \hline
1k (2023) & 1,000 & 92.50 & 24.00 & 51.89 & 1.95 & 22.16 & 100.0 & 92.54 & 83.68 \\
10k (2023) & 10,000 & 81.88 & 26.03 & 56.20 & 1.03 & 16.74 & 99.89 & 89.40 & 82.01 \\
20k (2023) & 20,000 & 76.62 & 30.48 & 52.92 & 0.96 & 15.64 & 99.93 & 85.80 & 78.01 \\
30k (2023) & 30,000 & 73.72 & 33.87 & 50.34 & 0.89 & 14.90 & 99.95 & 83.31 & 75.34 \\
30k+ (2023) & 206,216 & 61.90 & 46.56 & 38.21 & 0.64 & 14.59 & 99.97 & 77.51 & 62.50 \\ \hline
\end{tabular}%
}
\end{table*}
