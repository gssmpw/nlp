\documentclass{article}

\usepackage{arxiv}


\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{lipsum}		% Can be removed after putting your text content
\usepackage{graphicx}
\usepackage{doi}
\usepackage{hyperref}
\usepackage{comment}
\usepackage{mwe} % to get dummy images
\usepackage{float}
\usepackage{gensymb}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{comment}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{multirow}  % For multi-row cells
\usepackage{caption}
\usepackage[numbers]{natbib}  % Allows numerical citations
\usepackage{subcaption}

\bibliographystyle{unsrt}  % Choose the citation style

\hypersetup{
    colorlinks=true,   % Enable colored links
    linkcolor=blue,    % Color of internal links
    citecolor=blue,    % Color of citation links
    urlcolor=blue      % Color of external links
}

\title{Conditional Diffusion Models are Medical Image Classifiers that Provide Explainability and Uncertainty for Free}

%\date{September 9, 1985}	% Here you can change the date presented in the paper title
%\date{} 					% Or removing it

\author{
    Gian Mario Favero$^{*}$ \\
    McGill University \\ Mila – Quebec AI Institute \\
    \and
    \textbf{Parham Saremi$^{*}$} \\
    McGill University \\ Mila – Quebec AI Institute \\
    \and
    \textbf{Emily Kaczmarek} \\
    McGill University \\ Mila – Quebec AI Institute \\
    \and \\
    \textbf{Brennan Nichyporuk} \\
    McGill University \\ Mila – Quebec AI Institute \\
    \and \\
    \textbf{Tal Arbel} \\
    McGill University \\ Mila – Quebec AI Institute \\
}

% Uncomment to remove the date
\date{}

% Uncomment to override  the `A preprint' in the header
%\renewcommand{\headeright}{Technical Report}
%\renewcommand{\undertitle}{Technical Report}
\renewcommand{\shorttitle}{Conditional Diffusion Models as Medical Image Classifiers}

\begin{document}

\maketitle

\footnotetext[1]{* Contributed equally}

\begin{abstract}
	Discriminative classifiers have become a foundational tool in deep learning for medical imaging, excelling at learning separable features of complex data distributions. However, these models often need careful design, augmentation, and training techniques to ensure safe and reliable deployment. Recently, diffusion models have become synonymous with generative modeling in 2D. These models showcase robustness across a range of tasks including natural image classification, where classification is performed by comparing reconstruction errors across images generated for each possible conditioning input. This work presents the first exploration of the potential of class conditional diffusion models for 2D medical image classification. First, we develop a novel majority voting scheme shown to improve the performance of medical diffusion classifiers. Next, extensive experiments on the CheXpert and ISIC Melanoma skin cancer datasets demonstrate that foundation and trained-from-scratch diffusion models achieve competitive performance against SOTA discriminative classifiers without the need for explicit supervision. In addition, we show that diffusion classifiers are intrinsically explainable, and can be used to quantify the uncertainty of their predictions, increasing their trustworthiness and reliability in safety-critical, clinical contexts. Further information is available on our project page: \href{https://faverogian.github.io/med-diffusion-classifier.github.io/}{med-diffusion-classifier.github.io/}.
\end{abstract}

% keywords can be removed
\keywords{diffusion, classification, explainability, uncertainty}

\raggedbottom

\section{Introduction}

\input{components/introduction}

\section{Methodology}

\input{components/methodology}

\section{Experiments}

\input{components/experiments}

\section{Results}

\input{components/results}

\section{Conclusion}

\input{components/conclusion}

\clearpage  % Acknowledgements, references, and appendix do not count toward the page limit (if any)
% Acknowledgments---Will not appear in anonymized version
We thank Bruno Travouillon, Olexa Bilaniuk, and the Mila IDT team for their support with Mila's HPC. This work was supported by the Natural Sciences and Engineering Research Council of Canada, Fonds de Recherche du Quebec: Nature et Technologies, the Canadian Institute for Advanced Research (CIFAR) Artificial Intelligence Chairs program, Google Research, Calcul Quebec, the Digital Research Alliance of Canada, the Vadasz Scholar McGill Engineering Doctoral Award, and Mila - Quebec AI Institute.

\bibliography{references}

\clearpage
\appendix
\input{components/appendix}

\end{document}
