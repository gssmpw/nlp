\documentclass{article} %
\usepackage[dvipsnames,table]{xcolor}
\input{0-Preamble.tex}
\usepackage[preprint]{icml2025}


\usepackage{bbding,pifont}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{cancel}
\usepackage{hyperref}
\usepackage[capitalize]{cleveref}


\usepackage{tcolorbox} 


\usepackage{tcolorbox} %

\newtcolorbox{greenbox}[1][]{colback=green!4, colframe=black, boxrule=0.3pt, boxsep=-4pt #1}
\newtcolorbox{whitebox}[1][]{colback=white!4, colframe=black, boxrule=0.3pt, boxsep=0.1pt, left=0.1pt, right=2pt, top=0pt, bottom=0pt, #1}

\newtcolorbox[auto counter, number within=section]{gbox}[2][]{colback=green!10!white, colframe=green!80!black, boxrule=0.8mm, arc=4mm, width=0.2mm,  #1}


\usepackage{cleveref}
\crefname{ineq}{inequ.}{inequ.}
\crefname{equation}{Eq.}{Eqs.}
\creflabelformat{ineq}{#2{\upshape(#1)}#3} 
\crefname{theorem}{Theorem}{Theorems}
\crefname{proposition}{Prop.}{Prop.}
\crefname{claim}{Claim}{Claims}
\crefname{definition}{Def.}{Def.}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{appendix}{Appx.}{Appx.}
\crefname{figure}{Fig.}{Fig.}
\crefname{table}{Tab.}{Tab.}
\crefname{section}{Sec.}{Sec.}
\crefname{assumption}{Asm.}{Asm.}
\crefname{ineq}{inequ.}{inequ.}
\crefname{equation}{Eq.}{Eqs.}
\creflabelformat{ineq}{#2{\upshape(#1)}#3} 
\crefname{theorem}{Theorem}{Theorems}
\crefname{proposition}{Proposition}{Propositions}
\crefname{claim}{Claim}{Claims}
\crefname{algorithm}{Algorithm}{Algorithm}
\crefname{definition}{Definition}{Definition}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{appendix}{Appendix}{Appendix}
\crefname{figure}{Figure}{Figures}
\crefname{table}{Table}{Tables}
\crefname{section}{Section}{Section}
\crefname{assumption}{Assumption}{Assumption}





\usepackage[table]{xcolor}
\usepackage{tikz}
\hypersetup{colorlinks=true,citecolor=[rgb]{0.016,0.592,0.761}}
\hypersetup{linkcolor=Green}


\DeclareRobustCommand{\legendsquare}[1]{%
  \textcolor{#1}{\rule{2ex}{2ex}}%
}

\newcommand\x{\times}

\colorlet{LightRubineRed}{RubineRed!70}
\colorlet{Mycolor1}{green!10!orange}

\definecolor{blue_nice}{HTML}{d0f3f8}
\definecolor{orange_nice}[1]{HTML}{fff8cc} 
\definecolor{diag_nice}{HTML}{ffc8c9}
\definecolor{gray_nice}{HTML}{e8e9ef}


\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}


\newcommand\blue{\cellcolor{blue_nice}}
\newcommand\orange{\cellcolor{orange_nice}}

\newcommand\gray{\cellcolor{gray_nice}}




\definecolor{tabblue}{HTML}{1F77B4}
\definecolor{taborange}{HTML}{FF7F0E}
\definecolor{tabred}{HTML}{D62728}
\definecolor{tabcyan}{HTML}{17BECF}
\definecolor{tabgreen}{HTML}{2CA02C}
\newcommand{\pol}[1]{\textcolor{tabblue}{(Pol: #1)}}

\usetikzlibrary{tikzmark, calc}
\tikzset{
    double color fill/.code 2 args={
        \pgfdeclareverticalshading[%
            tikz@axis@top,tikz@axis@middle,tikz@axis@bottom%
        ]{diagonalfill}{100bp}{%
            color(0bp)=(tikz@axis@bottom);
            color(40bp)=(tikz@axis@bottom);
            color(40bp)=(tikz@axis@middle);
            color(40bp)=(tikz@axis@top);
            color(100bp)=(tikz@axis@top)
        }
        \tikzset{shade, left color=#1, right color=#2, shading=diagonalfill}
    }
}


\newcommand\dcolor{\cellcolor{diag_nice}}




\newcommand{\squarehex}[1]{\textcolor{#1}{\rule{1em}{1em}}}


\newcommand{\horange}[2][orange_nice]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}

\newcommand{\hgreen}[2][green!10]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}


\newcommand{\hblue}[2][blue_nice]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}

\newcommand{\hdiag}[2][diag_nice]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}


\newcommand{\hgray}[2][gray_nice]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}

\usepackage{url}
\usepackage[xindy]{glossaries}
\setkeys{glslink}{hyper=false}
\usepackage[inline]{enumitem}
\usepackage{booktabs}
\usepackage[dvipsnames]{xcolor}  %
\usepackage{subcaption}
\usepackage{amsfonts}

\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{bm}
\usepackage{nicematrix}
\usepackage{amsmath}
\usepackage{amsmath} 

\usepackage{xcolor,pifont}
\usepackage{chemarrow}

\usepackage{xspace}
\usepackage{pythonhighlight}

\newcommand{\lion}{{\text{\sc Lion}}\xspace}
\newcommand{\lions}{{\text{\sc Lion-s}}\xspace}
\newcommand{\lionretnet}{{\text{\sc Lion-d}}\xspace}
\newcommand{\lionlit}{{\text{{\sc Lion-lit}}}\xspace}
\newcommand{\lionrot}{{\text{{\sc Lion-s}\textsuperscript{$\natural$}}}\xspace}
\newcommand{\lionrotd}{{\text{{\sc Lion-d}\textsuperscript{$\natural$}}}\xspace}

\usepackage{tikz}



\DeclareMathOperator{\Y}{\mathbf{Y}}
\DeclareMathOperator{\X}{\mathbf{X}}
\DeclareMathOperator{\y}{\mathbf{y}}
\DeclareMathOperator{\qq}{\mathbf{q}}
\DeclareMathOperator{\kk}{\mathbf{k}}
\DeclareMathOperator{\vv}{\mathbf{v}}
\DeclareMathOperator{\Q}{\mathbf{Q}}
\DeclareMathOperator{\K}{\mathbf{K}}
\DeclareMathOperator{\V}{\mathbf{V}}
\DeclareMathOperator{\D}{\mathbf{D}}
\DeclareMathOperator{\B}{\mathbf{B}}
\DeclareMathOperator{\asmal}{\mathbf{a}}
\DeclareMathOperator{\C}{\mathbf{C}}
\DeclareMathOperator{\M}{\mathbf{M}}
\DeclareMathOperator{\A}{\mathbf{A}}
\DeclareMathOperator{\1}{\hspace{1.5mm}1^{}\hspace{1.5mm}}
\DeclareMathOperator{\U}{\mathbf{U}}
\DeclareMathOperator{\LL}{\mathbf{L}}
\DeclareMathOperator{\lvec}{\mathbf{l}}
\DeclareMathOperator{\uu}{\mathbf{u}}
\DeclareMathOperator{\Lam}{\mathbf{\Lambda}}
\DeclareMathOperator{\lam}{\mathbf{\lambda}}
\newcommand{\einv}{\operatorname{Inv}}
\DeclareMathOperator{\cumsum}{\textcolor{Green}{\textbf{\texttt{cumsum}}}}
\DeclareMathOperator{\cumprod}{\textcolor{Green}{\textbf{\texttt{cumprod}}}}



\newcommand{\xmark}{\ding{55}}%
\newcommand{\cmark}{\ding{51}}%
\newcommand*\colourcheck[1]{%
  \expandafter\newcommand\csname #1check\endcsname{\textcolor{#1}{\ding{52}}}%
}

\newcommand*\colourxmark[2]{%
  \expandafter\newcommand\csname #2check\endcsname{\textcolor{#2}{\ding{55}}}%
}
\definecolor{ao}{rgb}{0.0, 0.5, 0.0}
\colourcheck{green}
\theoremstyle{definition}
\newtheorem{observation}[theorem]{Observation}

\newcommand{\rebuttal}[1]{\textcolor{black}{#1}}

\newacronym{ml}{ML}{Machine Learning}
\newacronym{cnn}{CNN}{Convolutional Neural Networks}
\newacronym{gru}{GRU}{Gated Reccurent Unit}
\newacronym{lstm}{LSTM}{Long Short-Term Memory}
\newacronym{var}{VAR}{Vector Auto-regressive}
\newacronym{svr}{SVR}{ Support Vector Regression}
\newacronym{rnn}{RNN}{ Recurrent Neural Network}

\usepackage{listings}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\definecolor{azure}{rgb}{0.0, 0.5, 1.0}

\lstset{style=mystyle}

\newcommand\boldorange[1]{\textcolor{orange}{\textbf{#1}}}

\usepackage{xspace}
\newcommand{\ours}{LION\xspace}



\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}








\begin{document}


\twocolumn[

\icmltitle{Linear Attention for Efficient Bidirectional Sequence Modeling}




\begin{icmlauthorlist}
\icmlauthor{Arshia Afzal}{volkan,mahsa}
\icmlauthor{Elias Abad Rocamora}{volkan}
\icmlauthor{Leyla Naz Candogan}{volkan}
\icmlauthor{Pol Puigdemont}{volkan}
\icmlauthor{Francesco Tonin}{volkan}
\icmlauthor{Yongtao Wu}{volkan}
\icmlauthor{Mahsa Shoaran}{mahsa}
\icmlauthor{Volkan Cevher}{volkan}

\end{icmlauthorlist}

\icmlaffiliation{volkan}{LIONS, EPFL, Switzerland}
\icmlaffiliation{mahsa}{Integrated Neurotechnologies Laboratory, EPFL, Switzerland}

\icmlcorrespondingauthor{Arshia Afzal}{arshia.afzal@epfl.ch}


\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]




\printAffiliationsAndNotice{}  %

\begin{abstract}

Transformers with linear attention enable fast and parallel training. Moreover, they can be formulated as Recurrent Neural Networks (RNNs), for efficient linear-time inference. While extensively evaluated in causal sequence modeling,
they have yet to be extended to the bidirectional setting. %
This work introduces the \lion framework, establishing new theoretical foundations for linear transformers in bidirectional sequence modeling. 
\lion constructs a bidirectional RNN equivalent to full \textbf{Li}near Attenti\textbf{on}. %
This extends the benefits of linear transformers: parallel training, and efficient inference, into the bidirectional setting.
Using \lion, we cast three linear transformers to their bidirectional form:
\lionlit, the bidirectional variant corresponding to \cite{trans_rnn}; 
\lionretnet, extending RetNet \cite{retnet}; 
and \lions, a linear transformer with a stable selective mask inspired by selectivity of SSMs \cite{mamba2}. Replacing the attention block
with \lion (-\text{\sc Lit}, -\text{\sc D}, -\text{\sc S}) achieves performance on bidirectional tasks that approaches that of Transformers and State-Space Models (SSMs), while delivering significant improvements in training speed. Our implementation is available in \href{https://github.com/LIONS-EPFL/LION}{github.com/LIONS-EPFL/LION}.
\end{abstract}



\vspace{-6mm}

\section{{Introduction}} \label{sec:intro}
\input{1-Introduction}


\section{{Preliminaries and Background}} \label{sec:prelim}
\input{2-Prelim}

\input{3-LION}



\vspace{-3mm}
\section{{Experiments}} \label{sec:exp}




\input{5-Experiments}







\vspace{-3mm}
\section{Conclusions} \label{sec:conclusion}
\input{7-Conclusion}
\vspace{-2mm}
\section{Limitations \& Future Work} \label{sec:fut}
\input{6-FutureWork}


\clearpage

\section*{Impact Statement}
This paper presents work whose goal is to advance the field of 
Machine Learning. There are many potential societal consequences 
of our work, none which we feel must be specifically highlighted here.

\section*{Acknowledgments}
\input{Ack}

\bibliography{main}
\bibliographystyle{icml2025}

\clearpage
\appendix
\input{8-Appendix}


\end{document}
