\chapter{Introduction}

\section{Motivation}\label{sec:intro_motivation}
The seismic reflection method is by far the most widely used tool in geophysical exploration \citep{Sheriff1985}. It uses artificially generated seismic waves that excite the earth and propagate through the subsurface. They are attenuated by interactions with their medium of propagation, and are partially reflected back and transmitted when coming across a high contrasting acoustic impedance. The reflected data are recorded by receivers (geophones or hydrophones) at or close to the surface. The time required for the waves to travel through the subsurface provides a measurement from which a subsurface model of acoustic media is determined. Geological significance is inferred from the data either directly from the seismic reflection method, or more commonly, through the integration of other methods such as gravitational, magnetics, refraction and other data sources such as well log data, vertical seismic profiles and geological settings of the region. 

The search for new petroleum resources has pushed exploration areas of ever increasing complicated subsurface geology where the success of exploration wells depends heavily on the imaging of seismic data sets. To be able to image this geology, solvers have gradually moved from ray tracing algorithms to one-way wave equation methods and to acoustic and elastic two-way wave equation methods \citep{Nangoo2013}. These imaging techniques have until recently been largely limited to depth mapping of seismic reflections at boundaries between rock formations. The extraction of other information available in seismic data sets was compromised by prohibitive computing processing time and as a result only a fraction of the information contained in seismic datasets could be extracted.

The availability of super computers and Graphical Processing Units in recent years has enabled seismic processing to implement previously prohibited imaging technology. One such technology is \ac{FWI}, which follows the physics of the wave equation for both phase and amplitude \citep{Tarantola1987}. The technique does not only invert for conventional depth imaging of boundaries but also rock properties such as velocity ($v_p$ - compressional and $v_s$ - shear), lithology and pore-fill thus providing a more comprehensive geology of the subsurface \citep{Plessix2014}. The technique has also gained popularity after it was demonstrated to produce spectacular improvements in imaging subsurface geology beneath a heterogeneous overburden - See Figure~\ref{fig:conventional_vs_fwi}. This is a landmark in seismic exploration and has changed the way seismic data is used and interpreted.

\begin{figure}[!ht]
	\centering
    \subbottom[Velocity model from conventional methods.]{\includegraphics[width=0.45\textwidth]{samson_1.png}}
    \subbottom[<10Hz FWI velocity model result.]{\includegraphics[width=0.45\textwidth]{samson_2.png}}
    % \subbottom[<10Hz FWI velocity model with seismic overlay.]{\includegraphics[width=0.32\textwidth]{samson_3.png}}
	\caption[Horizontal slices though the Samson Dome.]{Horizontal slices though the Samson Dome in the Barent Sea at 1350m showing the uplift in imaging obtained through FWI. Axis indicated extend of the horizontal slice were not present in the original image from \cite{Morgan2013}.} 
	\label{fig:conventional_vs_fwi}
\end{figure}

FWI seeks to achieve a high-resolution model of the subsurface through the application of multivariate optimization to the seismic inverse problem \citep{Virieux2009}. The inversion process begins with a best-guess initial model which is iteratively improved using a sequence of linearized local inversions to solve a fully non-linear problem. Figure~\ref{fig:conventional_vs_fwi} illustrates the image uplift which is achievable with FWI. In situations of more complex structures at depth with convoluted ray-paths in the overburden, the inversion becomes more difficult and more computationally expensive. Figure~\ref{fig:limitations_fwi} illustrates an example of FWI on the 2004 BP synthetic data. The zoomed section (d) illustrates a lack of resolution of FWI.

\begin{figure}[!ht]
	\centering
    \subbottom[2004 BP synthetic for FWI.]{\includegraphics[width=0.6\textwidth]{BP_1.png}}
    \subbottom[Zoom of complexity at depth.]{\includegraphics[width=0.25\textwidth]{BP_1_zoom.png}}

    \subbottom[2D FWI result.]{\includegraphics[width=0.6\textwidth]{BP_2.png}}
    \subbottom[Zoomed section highlighting lack of resolution.]{\includegraphics[width=0.25\textwidth]{BP_2_zoom.png}}
	\caption[Limitations of FWI due to poor illumination.]{Limitations of FWI due to poor illumination. From \cite{Shin2010}.} 
	\label{fig:limitations_fwi}
\end{figure}

\section{Aims \& Objectives}
Optimization theory is fundamental to FWI since the parameters of the system under investigation are reconstructed from indirect observations that are subject to a forward modelling process \citep{Tarantola2005}. The accuracy of this forward problem depends on the validity of physical theory that links ground-truth to the measured data \citep{Innanen2014}. Moreover, solving for this inverse problem involves learning the inverse mapping from the measurements to the ground-truth which is based on a subset of degraded or best-estimate data \citep{Tarantola2005, Tikhonov1977}. Thus, two limitations within inverse theory can be identified: (i) the forward problem and (ii) the training data. 

As evidenced throughout the historic development (reviewed in ยง\ref{sec:lit_rev_fwi}), choice of the forward problem will impact the accuracy of the FWI result. Challenging environments require more complex assumptions to try and better explain the physical link between data and observations, with not necessarily improved levels of accuracies \citep{Morgan2013}. Secondly, the data being used to reconstruct the mapping of measurements for the ground-truth are not optimal. Very wide angle and multi-azimuth data is required to enable full reconstruction of the inverse problem \citep{Morgan2016}; which is not always available. Furthermore, pre-conditioning of data is a necessity prior to FWI to make the inversion better posed \citep{Kumar2012a,Mothi2013,Peng2018,Warner2013}, however if done incorrectly this can degrade the inverse process \citep{Lines2014}.

Recently, deep learning techniques have emerged as excellent models and gained great popularity for their widespread success in pattern recognition tasks \citep{Ciresan2011, Ciresan2012}, speech recognition \citep{Hinton2012} and  computer vision \citep{Krizhevsky2015,Deng2013}. The use of deep neural networks to help solve inverse problems has been explored by \cite{Elshafiey1991}, \cite{Adler2017a}, \cite{Chang2017}, \cite{Wei2017} and has achieved state-of-the-art performance in image reconstruction \citep{Kelly2017, Petersen2017, Adler2017b}, super-resolution \citep{Bruna2015, Galliani2017} and automatic-colourisation \citep{Larsson2016}. These deep learning based waveform inversion processes exist between data and theory guided methods \citep{Sun2019}. Data-driven methods do not impose a wave propagation model. \ac{NN} weights are all trainable and require relatively exhaustive training datasets to invert properly \citep{Sun2019a}. Yet, due to the large number of degrees of freedom, they are not exposed to modelling errors as any conventional FWI algorithm \citep{Wu2018,Li2019}. On the contrary, there are deterministic models, with bases in classical physics. In between, there are theory-guided or physics-informed methods which have some parameters fixed as non-trainable. If non-trainable parameters are built to mimic a physical process, the training model space now consists of only the parameters for that process and the number shrinks drastically. This provides robust training and enables more intelligibility as compared to purely data driven approach \citep{Biswas2019}.

As with most techniques, after decades of development, FWI algorithms now only being improved incrementally, with slight modification to the underlying algorithms. The technique hence requires a fresh injection of ideas and academic pursuits to elevate it to the next phase of development. Application of seismic FWI has recently started to be investigated within the deep learning field and has so far been focused only on the time-domain approach. However, classical FWI experienced pivotal breakthroughs via pseudo-spectral approaches which enabled the technique to go beyond academic experiments and be employed on real datasets (See ยง~\ref{sec:lit_rev_beyond_academic_exp}). The main aim of the research work presented in this thesis was to investigate whether the same advantages apply when pseudo-spectral FWI is developed within DNN. To current knowledge, there is no prior work investigating the pseudo-spectral inversion within \ac{DNN} frameworks. Specifically, my study was motivated by the following research questions: Are pseudo-spectral approaches possible within a \ac{DNN} framework? Is the shift to a data-driven inversion detrimental? How good can theory-guided inversion be? How do pseudo-spectral DNN compare to deterministic conventional FWI? Are there any particular benefits of data-driven or physics-guided pseudo-spectral DNN approaches? How do pseudo-spectral DNN compare to time-based DNN approaches? Are there any cross-over techniques between Deep Learning and geophysics which would benefit either field? Could this cause the new wave of evolution of the FWI framework?

Hence, the main aim of this work was to develop these two novel approaches in the form of data-driven and theory-guided pseudo-spectral FWI, compare them to traditional approaches and investigate their limitations. To this end, the following steps were followed:
\begin{enumerate}
    \item Building a comprehensive literature review of \ac{DNN} applications within geophysics. This will be focussed particularly on pseudo-spectral FWI approaches and highlights key examples for data-driven and theory-guided approaches.
    \item Re-casting FWI within a \ac{DNN} framework for both a data-driven direct learned inversion and a theory-guided temporal based \ac{DNN} formulation. Both approaches were derived theoretically and assessed on synthetic data. The assessment built up from simple 1D experiments, extended to 2D and evaluated on the standard Marmousi model. The results were validated against classical FWI.
    \item Analysing the limitations of both approaches and discussing future potential developments.
\end{enumerate}

\section{Document Structure}
This dissertation is composed of five chapters, each of them dealing with different aspects of a pseudo-spectral FWI within a Deep Learning framework.
\begin{itemize}
    \item Chapter 1 is introductory and deals with introducing the topic and sets the aims and objectives for this work. 
    \item Chapter 2 gives a literature review of work which highlights trends in FWI, Deep Learning and their combined application respectively. 
    \item Chapter 3 is sub-divided into 3 parts and provides all relevant theory for FWI via DNNs. Part 1 illustrates the key elements within classical FWI. Part 2 presents FWI as a data-driven \ac{DNN} and Part 3 derives RNN as a physics informed framework for FWI. Each of these is compared to classical FWI, with commonalities and differences highlighted.
    \item Chapter 4 builds on the derived theory and evaluates each framework on synthetic data.
    \item Chapter 5 critically analyses the numerical results obtained in Chapter 4 and outlines their limitations. Future work is presented and conclusions addressed.
\end{itemize}