\section{Related works}
\paragraph{Diffusion models}

The idea of diffusion models was first presented in ____. These models leverage Stochastic Differential Equations (SDEs) to progressively transform a simple initial distribution (e.g., a normal distribution) into a more complex target distribution through a series of manageable diffusion steps. The evolving advances, including the decrease in the trajectory steps____, have created more efficient diffusion models.

\begin{figure*}[!ht]
    \centering
    % \renewcommand{\arraystretch}{0} % Usunięcie odstępów między wierszami
    \setlength{\tabcolsep}{0.8pt}    % Usunięcie odstępów między kolumnami
    \centering
    \begin{tabular}{@{}c@{}c@{}c@{}c@{}c@{}c@{}}
        \rotatebox{90}{ \qquad CFG} &
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000050/000050_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000052/000052_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000070/000070_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000084/000084_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000091/000091_ddim_9.0.jpg} 
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_3.0_9.0/100/000020/000020_ddim_9.0.jpg} 
        \\
        \rotatebox{90}{ \qquad \our{}} &
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000050/2.0_3.0_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000052/2.0_3.0_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000070/2.0_3.0_ddim_beta_9.0.jpg} &  
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000084/2.0_3.0_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000091/2.0_3.0_ddim_beta_9.0.jpg}  
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_3.0_9.0/100/000020/2.0_3.0_ddim_beta_9.0.jpg} 
        \\[0.08cm]
        &
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small  A traffic light sitting next to a building with its red blurred.
        }& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small 
        There are bananas, pineapples, oranges, sandwiches, and drinks at the stand.
        }& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small 
        a green train is coming down the tracks
        }& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small 
        Small birds are walking along the waters edge
        }& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small 
        A boy is jumping a hurdle while on a skateboard.
        }
        
        % \multicolumn{1}{p{0.16\linewidth}}{\centering \small A snowboarder hitting a trick off a giant ramp. 
        % }
        \\[1.2cm]
        \rotatebox{90}{ \qquad CFG} &
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000001/000001_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000002/000002_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000006/000006_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000008/000008_ddim_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000020/000020_ddim_9.0.jpg} 
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_2.5_9.0/custom/000010/000010_ddim_9.0.jpg} &
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_2.5_9.0/custom/000012/000012_ddim_9.0.jpg} 
        \\
        \rotatebox{90}{ \qquad \our{}} &
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000001/2.0_2.5_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000002/2.0_2.5_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000006/2.0_2.5_ddim_beta_9.0.jpg} &  
        \includegraphics[width=0.19\linewidth]{img/images/2.0_2.5_9.0/custom/000008/2.0_2.5_ddim_beta_9.0.jpg} & 
        \includegraphics[width=0.19\linewidth]{img/images/2.0_3.0_9.0/100/000020/2.0_3.0_ddim_beta_9.0.jpg}
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_2.5_9.0/custom/000010/2.0_2.5_ddim_beta_9.0.jpg} &  
        % \includegraphics[width=0.15\linewidth]{img/images/2.0_2.5_9.0/custom/000012/2.0_2.5_ddim_beta_9.0.jpg} 
        \\[0.08cm]
                &
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small kayak in the water, optical color, aerial view, rainbow} & 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small A small cactus with a happy face in the sahara desert}& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small woman sniper, wearing soviet army uniform, in snow ground}& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small A man wearing a suit is taking a self portrait with a camera}& 
        \multicolumn{1}{p{0.16\linewidth}}{\centering \small A snowboarder hitting a trick off a giant ramp.}
        % \multicolumn{1}{p{0.16\linewidth}}{\centering \small Spectacular Tiny World in the Transparent Jar..}
        % & 
        % \multicolumn{1}{p{0.16\linewidth}}{\centering \small A blue jay standing on a large basket of rainbow macarons}
       
        
    \end{tabular}
    \vspace{-0.4cm}
    \caption{Comparison of CFG and \our{}. As we can see, our model produces more realistic images, which is consistent with the numerical results from Tab.~\ref{tab:all}.} 
    \vspace{-0.4cm}
    \label{fig:sampling}
\end{figure*}

Significant progress was made in developing diffusion probabilistic denoising models (DDPM)____. DDPMs utilize a weighted variational bound objective by integrating probabilistic diffusion models with denoising score matching____. Despite demonstrating excellent generative capabilities and producing high-quality samples, the substantial computational expense of these models presented a significant drawback. Denoising Diffusion Implicit Models (DDIMs)____ improve scalability, particularly sample efficiency.


Ultimately, Latent Diffusion Models____ reduced the significant computational demands associated with applying diffusion models to high-dimensional scenarios by suggesting the implementation of diffusion within the low-dimensional latent space of an autoencoder. The practical application of this method is shown in Stable Diffusion____. Scalability was enhanced further in models such as SDXL____, which expanded the potential of latent diffusion models to tackle larger and more intricate tasks.

\paragraph{Guidance of diffusion models}
The Stochastic Differential Equation (SDE) framework is vital in diffusion models. While it facilitates exceptional generative capabilities, better scalability, and expedited training compared to models utilizing Ordinary Differential Equations (ODEs)____, the process of stochastic inference still needs \textit{guidance} to generate satisfactory samples.

Various techniques have been designed to guide the generation process in a specific direction. These can largely be classified into different strategies: guidance through classifiers, Langevin dynamics, Markov Chain Monte Carlo (MCMC), external guiding signals, architecture-specific features, etc. Despite their variations, these techniques generally steer the diffusion process toward areas of minimal energy, as inferred by different proxies.



A widely recognized approach is Classifier Guidance____, which incorporates an external classifier to infer the class from intermediate noisy diffusion steps. On the other hand, Classifier-Free Guidance____ removes the requirement for an external classifier by using a unified model trained in both conditioned and unconditioned modes. Langevin dynamics is frequently used for off-policy guidance, where during each step along a trajectory, the model aligns with the scaled gradient norm toward areas of minimal energy (the maximum \textit{log probability}) ____ and ____. Alternatively, MCMC sampling strategies are directly used in diffusion processes ____.

Specific techniques integrate external guiding functions to refine the generation path towards the targeted results ____. Alternatively, some exploit the inherent features of diffusion models, such as leveraging intermediate self-attention maps ____ or employing an externally trained discriminator network ____. AutoGuidance ____ enhances classifier-free guidance by substituting the unconditional model with a more compact, less sophisticated version to direct the conditional model.

% \begin{figure}[ht]
%     \centering
%     \renewcommand{\arraystretch}{0} % Usunięcie odstępów między wierszami
%     \setlength{\tabcolsep}{0.8pt}    % Usunięcie odstępów między kolumnami
%     \begin{tabular}{cccc}
%         \rotatebox{90}{ \qquad CFG}&
%         \includegraphics[width=0.30\linewidth]{img/images/fig5/cfg/img1/000043_ddim_7.5.png} & 
%         \includegraphics[width=0.30\linewidth]{example-image-a.png} & 
%         \includegraphics[width=0.30\linewidth]{img/images/fig5/cfg/img3/000040_ddim_7.5.png}  
%         \\
%         \rotatebox{90}{ \qquad \our{}}&
%         \includegraphics[width=0.30\linewidth]{img/images/fig5/cfg/img1/2.0_2.0_ddim_beta_7.5.png} & 
%         \includegraphics[width=0.30\linewidth]{example-image-a.png} & 
%         \includegraphics[width=0.30\linewidth]{img/images/fig5/cfg/img3/2.0_2.0_ddim_beta_7.5.png}  
%         \\[10pt]
%         & \multicolumn{1}{p{0.30\linewidth}}{\centering Prompt: A bed and a mirror in a small room.} & 
%         \multicolumn{1}{p{0.30\linewidth}}{\centering Prompt: a shoe rack with some shoes and a dog sleeping on them} & 
%         \multicolumn{1}{p{0.30\linewidth}}{\centering Prompt: A cat is sitting on a leather couch next to two remotes.}
%     \end{tabular}
%     \caption{T2I using SDXL, 50 NFE, CFG vs \our{}. }
%     \label{fig:grid_search_beta}
% \end{figure}