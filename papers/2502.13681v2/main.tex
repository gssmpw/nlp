\documentclass{article}
\usepackage[preprint,nonatbib]{neurips_2024}


\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs}

\usepackage{hyperref}
\usepackage{caption}


\newcommand{\theHalgorithm}{\arabic{algorithm}}



% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{enumitem}
\usepackage{multicol}
\usepackage{longtable}
\usepackage{booktabs} % For better table lines

\usepackage[capitalize,noabbrev]{cleveref}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage[textsize=tiny]{todonotes}


% \setlength{\abovecaptionskip}{-100cm}
% \setlength{\belowcaptionskip}{-100cm} 
% \setlength{\parskip}{0em}

\setlength{\abovedisplayskip}{0.3em}
\setlength{\belowdisplayskip}{0.3em}
\newcommand{\tool}{Repo2Run}
\title{An LLM-based Agent for Reliable Docker Environment Configuration}

\author{
  Ruida Hu\thanks{Work done during an internship at ByteDance.} \\
  Harbin Institute of Technology, Shenzhen\\ 
  Shenzhen, China \\
  \texttt{200111107@stu.hit.edu.cn}\\
  \And
  Chao Peng\thanks{Corresponding Authors.} \\
  ByteDance \\
  Beijing, China \\
  \texttt{pengchao.x@bytedance.com} \\
  \And
  Xinchen Wang\footnotemark[1] \\
  Harbin Institute of Technology, Shenzhen\\ 
  Shenzhen, China \\
  \texttt{200111115@stu.hit.edu.cn} \\
  \And
  Cuiyun Gao\footnotemark[2] \\
  Harbin Institute of Technology, Shenzhen\\ 
  Shenzhen, China \\
  \texttt{gaocuiyun@hit.edu.cn} \\
}
  

\vskip 0.3in

\newcommand{\wxc}[1]{\textcolor{brown}{{#1}}}
\newcommand{\pc}[1]{\textcolor{cyan}{{#1}}}
\newcommand{\rdhu}[1]{\textcolor{blue}{{#1}}}

\begin{document}

\maketitle
\begin{abstract}

Environment configuration is a critical yet time-consuming step in software development, especially when dealing with unfamiliar code repositories. While Large Language Models (LLMs) demonstrate the potential to accomplish software engineering tasks, existing methods for environment configuration often rely on manual efforts or fragile scripts, leading to inefficiencies and unreliable outcomes. We introduce \tool, the first LLM-based agent designed to fully automate environment configuration and generate executable Dockerfiles for arbitrary Python repositories. We address two major challenges: (1) enabling the LLM agent to configure environments within isolated Docker containers,
% while resolving dependency conflicts and selecting appropriate base images, 
and (2) ensuring the successful configuration process is recorded and accurately transferred to a Dockerfile without error. To achieve this, we propose atomic configuration synthesis, featuring a \textbf{dual-environment architecture} (internal and external environment) with a rollback mechanism to prevent environment ``pollution" from failed commands, guaranteeing atomic execution (execute fully or not at all) and a \textbf{Dockerfile generator} to transfer successful configuration steps into runnable Dockerfiles. We evaluate \tool~on our proposed benchmark of 420 recent Python repositories with unit tests, where it achieves an 86.0\% success rate, outperforming the best baseline by 63.9\%. Repo2Run is available at \url{https://github.com/bytedance/Repo2Run}.
% Our contributions include: (1) a novel framework for automated, pollution-free environment configuration via LLM agents, (2) the first method to synthesize reliable Dockerfiles from runtime execution traces, and (3) empirical validation demonstrating significant practical efficacy. This work bridges the gap between dynamic environment interactions and reproducible configuration artifacts, advancing LLM-driven automation in software engineering.
% As the first step to execute code, configuring runtime environments is time-consuming and system-dependent. Manual configuration often requires numerous trial-and-error adjustments and fails across platforms (e.g., Windows vs. Linux)~\wxc{[Our experiments are across different platforms?]}. These inconsistencies delay development cycles and compromise reproducibility~\wxc{[little confusing about SE reproducibility]}\pc{ portability?} in software workflows. Recent advances in Large Language Model (LLM) based agents have enabled the automation of complex software engineering tasks. ~\wxc{[maybe need a transitional sentence? like `Considering ...']} We propose Repo2Run, the first LLM agent designed to automatically configure runtime environments for arbitrary Python repositories and generate runnable~\wxc{[runnable does not equal to configure the environment successfully? maybe change a word or phrase?]} Dockerfiles.
% Our approach combines a dual-environment architecture to isolate configuration attempts and a Dockerfile generator to record successful configuration steps, addressing both system dependency issues and unrecoverable~\wxc{[little confusing but ok]} failures during manual configuration.

% \tool~employs a dual-environment architecture: an internal container sandbox allows the LLM agent to iteratively install dependencies and run tests, while an external orchestrator monitors the state and triggers automatic rollback to a stable state (e.g., restarting the container) upon detecting failures. This prevents the environment from entering uncertain states caused by failed command executions.
% Recent advancements in automated code programming tasks increasingly necessitate validation within actual runtime environments. However, the initial step of building a fully operational coding environment remains challenging due to various complexities. To address this, we explore the application of Large Language Model (LLM) agents for configuring coding environments. We propose \tool, the first agent tool designed for the automated construction of Python code environments by automatically generating Dockerfiles for given code repositories. We evaluate \tool~on 420 popular Python repositories released on GitHub in 2024 and our preliminary results indicate that \tool~successfully configures environments for 86.4\% of the repositories, largely reducing the manual effort required. These findings suggest that \tool~is a promising step toward more efficient and effective automated environment configuration.
\end{abstract}

\section{Introduction}
\input{introduction}

\section{Environment configuration}
\input{configuration_definition}


\section{\tool}
\input{approach}


\section{Experiment}
\input{experiment}


\section{Discussion}
\input{discussion}


\section{Related Work}
\input{relatedworks}


\section{Conclusion}
\input{conclusion}


\section*{Impact Statement}
\input{impact}

\bibliography{Citation}
\bibliographystyle{plain}

\appendix
\onecolumn
\input{appendix}

\end{document}
