Autonomous vehicles (AVs) are nearing widespread deployment, but ensuring their safety remains a critical challenge. 
Public AV testing has revealed critical failures, sometimes leading to tragic outcomes~\cite{mccarthy2022autonomous, shepardson_2024, brown2023halting, bote_2023, song_2021, templeton_2023, o2016we, rodriguez_2023}. 
A methodical approach for measuring and improving safety for AVs is necessary to reduce these outcomes.
A central question in AV development and testing is: How do we know which autonomous vehicle (AV) is safer?
This fundamental question underlines much of the debate surrounding AV deployment and safety. 
% A central question underlying much of the debate surrounding AV deployment and testing is: How do we know which autonomous vehicle (AV) is safer?
Conventional metrics such as miles driven or disengagement counts provide a limited and often inadequate view of AV performance. 
Lower disengagements, for instance, do not necessarily equate to safer or more reliable driving behavior, as it fails to capture the full range of complex interactions AVs encounter in real-world traffic situations.
To objectively compare the safety of two AVs, we need a framework that goes beyond these basic metrics.

Comparing the safety of two AVs is challenging because they often operate under different conditions, different cities etc. 
Direct safety comparisons are unreliable without a common basis.
Rather, a more viable approach is to analyze AV behavior when exposed to similar traffic scenarios.
By evaluating AV performance in high-stakes situations, we gain deeper insight into their safety and robustness. However, implementing and scaling this approach requires automatically describing, interpreting, and comparing traffic scenarios across large datasets. 
This challenge motivates our work: How can we generate standardized, interpretable descriptions of traffic scenarios to identify both similar and rare situations for AV comparison?

Scenario Description Languages (SDLs) provide structured, interpretable descriptions of traffic scenarios by capturing both static (road geometry, traffic signals, etc.) and dynamic (vehicle maneuvers) elements.
% SDLs can facilitate critical AV testing and safety tasks such as large-scale scenario discovery, real-to-sim transfers, post-deployment monitoring, and programmatic scenario generation.
SDLs can facilitate critical AV testing and safety tasks such as large-scale scenario discovery, real-to-sim transfers, and programmatic scenario generation.
Additionally, by encoding traffic scenarios into SDL embeddings, we can identify similar scenarios allowing us to observe AVs in a similar traffic situation and, hence, reasoning about their relative safety.
Frameworks such as Scenic~\cite{Scenic} and OpenScenario~\cite{OpenScenario} offer SDLs for these purposes. 

However, despite their utility, significant limitations of constructing SDLs remain: Due to the lack of ground-truth annotations, the extraction of semantic SDL labels from AV data is currently manual, requiring intensive oversight. 
Manual labeling of such data is impractical due to the vast scale of AV trajectory datasets. 
Since AV data sets do not provide labeled actions, using supervised learning techniques to extract SDLs is infeasible.
This bottleneck limits the scalability of SDLs for comprehensive scenario-based testing across diverse AV datasets.
% While advances in computer vision have made static element extraction (such as road geometry) more feasible~\cite{segment_anything,SemSeg_Transformer}, extracting dynamic elements - particularly vehicle behaviors - is far more complex.
While advances in computer vision have made static element extraction more feasible~\cite{segment_anything,SemSeg_Transformer}, extracting dynamic vehicle behaviors is far more complex.
Accurately capturing spatio-temporal actions requires more than video-based similarity, as it involves understanding nuanced trajectory patterns. 

To overcome these limitations, we introduce the Trajectory-to-Action Pipeline (TAP), a method that automates the extraction of interpretable vehicle behavior SDL descriptions from unlabeled AV trajectory data. 
TAP uses cross-entropy optimization to automatically derive SDL labels based on the datasetâ€™s distribution. 
This automated approach addresses the pressing need for scalable, interpretable scenario descriptions, enabling TAP to compare vehicle behaviors and identify unique vehicle behaviors without the need for manual input. The contributions of this paper are as follows:
\begin{enumerate}
    \item We present the Trajectory-to-Action Pipeline (TAP), an automated method for extracting interpretable vehicle behavior SDL embeddings from trajectory data, reducing reliance on manual labeling and enabling scalable scenario analysis.
    % \item We introduce a flexible SDL schema tailored for describing vehicle behaviors, spanning a spectrum from high-level abstract traces to fine-grained, detailed actions. 
    \item We validate TAP on the Waymo Open Motion Dataset, demonstrating its precision in identifying behaviorally similar trajectories and automatic detection of unique scenarios.
\end{enumerate}

By automating SDL extraction, TAP provides a robust, and adaptable foundation for large-scale AV scenario and trajectory data analysis, that could ultimately help support effective AV safety evaluations in real-world environments.