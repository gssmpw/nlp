\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  
% Comment this line out if you need a4paper

%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4 paper

\IEEEoverridecommandlockouts      

\setlength{\topmargin}{-10pt}     % Moves content down (increase value to push it down)
\setlength{\textheight}{9.5in}    % Adjust text height (reduce if bottom has extra space)
\setlength{\oddsidemargin}{-10pt} % Left margin for odd pages
\setlength{\evensidemargin}{-10pt} % Left margin for even pages
\setlength{\textwidth}{7in}        % Adjust width (default is 7in for IEEE)
% This command is only needed if 
% you want to use the \thanks command

%\overrideIEEEmargins                                      
% Needed to meet printer requirements.

%In case you encounter the following error:
%Error 1010 The PDF file may be corrupt (unable to open PDF file) OR
%Error 1000 An error occurred while parsing a contents stream. Unable to analyze the PDF file.
%This is a known problem with pdfLaTeX conversion filter. The file cannot be opened with acrobat reader
%Please use one of the alternatives below to circumvent this error by uncommenting one or the other
%\pdfobjcompresslevel=0
%\pdfminorversion=4

% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document

% The following packages can be found on http:\\www.ctan.org
%\usepackage{graphics} % for pdf, bitmapped graphics files
%\usepackage{epsfig} % for postscript graphics files
%\usepackage{mathptmx} % assumes new font selection scheme installed
%\usepackage{times} % assumes new font selection scheme installed
\usepackage{amsmath} % assumes amsmath package installed
%\usepackage{amssymb}  % assumes amsmath package installed
\usepackage{mathtools}
\usepackage{hyperref}
\usepackage{color}
\usepackage[dvipsnames]{xcolor}

\usepackage{graphicx} % For adding images and graphics
\usepackage{array} % For advanced table formatting
\usepackage{tabularx} % For tables that adjust to column width
\usepackage{caption} % For better control of table captions

%\usepackage{showframe}


\input{./macros}
\newcommand{\note}{\textcolor{blue}}
\newcommand\ucnote[1]{\textcolor{orange}{[UC: #1]}}

\usepackage{mdframed}
\mdfdefinestyle{MyFrame}{%
    linecolor=black,
    outerlinewidth=2pt,
    %roundcorner=20pt,
    innertopmargin=4pt,
    innerbottommargin=4pt,
    innerrightmargin=4pt,
    innerleftmargin=4pt,
    leftmargin = 4pt,
    rightmargin = 4pt,
    skipabove=10pt,  % Space above the box
    skipbelow=10pt  % Space below the box
    %backgroundcolor=gray!50!white}
        }


        
\usepackage[font=footnotesize,labelfont=bf]{caption}

\title{\LARGE \bf DualGuard MPPI: Safe and Performant Optimal Control by Combining Sampling-Based MPC and Hamilton-Jacobi Reachability }

\author{Javier Borquez$^{1}$, Luke Raus$^{2}$, Yusuf Umut Ciftci$^{1}$, and Somil Bansal$^{3}$ % <-this % stops a space
\thanks{This work is supported by the University of Santiago de Chile, the NSF CAREER Program under award 2240163 and the DARPA ANSR program.}%
\thanks{$^{1}$University of Southern California. \{javierbo, yciftci\}@usc.edu.}%
\thanks{$^{2}$Olin College of Engineering. lraus@olin.edu.}\thanks{$^{3}$Stanford University. somil@stanford.edu.}
}

\begin{document}

\colorlet{usercolorname}{red!20} %make nonzero to highlight
\sethlcolor{usercolorname}

\makeatletter
\let\@oldmaketitle\@maketitle
    \renewcommand{\@maketitle}{\@oldmaketitle
    \centering
    \vspace{1em}
    \includegraphics[width=0.99\textwidth]{fig/hw_banner_safe_mppi_v5.png}
    % \vspace{-0.5cm}
    \captionof{figure}{We propose DualGuard MPPI - a framework to solve optimal control problems for robots subjected to hard safety constraints. Our method integrates safety filtering during the sampling process in MPPI to generate safe hallucinations, ensuring safe executions while improving the exploration and sample efficiency in MPPI algorithms. An output least restrictive filter is used to ensure safe executions on the system, despite potential multimodality in the sampling process. (A) We apply the proposed framework to an RC car experiment where the vehicle completes laps without leaving the track (breaching safety), while trying to stay centered in the lane and going as fast as possible. (B) Hallucinated trajectories in classical MPPI generate only high-cost unsafe executions near a tight corner, which results in breaching the boundary of the track. (C) DualGuard MPPI safe hallucinations generate only collision-free executions with mild costs depending only on performance criteria, resulting in safe and performant behavior. Details on this experiment are provided in Section \ref{case_rc_car}.}
    \vspace{-0.2cm} % this command is important for spacing!!! dont comment or delete it -- zc after long tuning.
    \label{fig:exp_main_result}
    \setcounter{figure}{1}
  % \bigskip
  }
\makeatother

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
Designing controllers that are both safe and performant is inherently challenging.
This co-optimization can be formulated as a constrained optimal control problem, where the cost function represents the performance criterion and safety is specified as a constraint.
While sampling-based methods, such as Model Predictive Path Integral (MPPI) control, have shown great promise in tackling complex optimal control problems, they often struggle to enforce safety constraints. 
To address this limitation, we propose DualGuard-MPPI, a novel framework for solving safety-constrained optimal control problems.
Our approach integrates Hamilton-Jacobi reachability analysis within the MPPI sampling process to ensure that all generated samples are provably safe for the system. 
On the one hand, this integration allows DualGuard-MPPI to enforce strict safety constraints; at the same time, it facilitates a more effective exploration of the environment with the same number of samples, reducing the effective sampling variance and leading to better performance optimization.
Through several simulations and hardware experiments, we demonstrate that the proposed approach achieves much higher performance compared to existing MPPI methods, without compromising safety.
\end{abstract}

% 
\input{01_introduction.tex}
 % 
\input{02_problem.tex}
% 
\input{03_background.tex}
% 
\input{04_approach.tex}
% 
\input{05_results.tex}
%
\input{06_hardware}
%
\input{07_conclusion.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addtolength{\textheight}{-1cm}   % This command serves to balance the column lengths
% on the last page of the document manually. It shortens         % the textheight of the last page by a suitable amount.
% This command does not take effect until the next page
% so it should come on the page before the last. Make
% sure that you do not shorten the textheight too much.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \section*{APPENDIX}

% Appendixes should appear before the acknowledgment.

% \section*{ACKNOWLEDGMENT}

% Thanks to ...
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{IEEEtran}
\bibliography{  ./Bib/bib_reach,
                ./Bib/bib_SIAL,
                ./Bib/bib_MPC,
                ./Bib/bib_cbf,
                ./Bib/bib_local,
                ./Bib/bib_fltr
}

\end{document}
