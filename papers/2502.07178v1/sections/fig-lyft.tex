%!TEX root = ../root.tex

\begin{figure}[t]
    \begin{minipage}{\columnwidth}
        \begin{tabular}{cc}
            \hspace{-8mm}
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-Prob-loss-NLL-PM-comparison_lyft.pdf}
            \end{minipage}
            &
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-minFrDE-loss-NLL-PM-comparison_lyft.pdf}
            \end{minipage}
            \\
            \hspace{-8mm}
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-Prob-loss-minADE-PM-comparison_lyft.pdf}
            \end{minipage}
            &
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-minFrDE-loss-minADE-PM-comparison_lyft.pdf}
            \end{minipage}
            \\
            \hspace{-8mm}
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-Prob-weights_lyft.pdf} \\
            {(a) Convex probability loss~\eqref{eq:probability-loss}}
            \end{minipage}
            &
            \begin{minipage}{0.5\textwidth}
            \centering
            \includegraphics[width=\columnwidth]{figures/stationary-minFRDE-weights-RB_lyft.pdf} \\
            {(b) Nonconvex minFRDE$_k$ loss~\eqref{eq:minFRDEk}}
            \end{minipage} 
        \end{tabular}
    \end{minipage}
    \caption{Performance of MoE in a stationary distribution shift (from the \lyft dataset) using (a) convex loss and (b) nonconvex loss. From top to bottom: NLL performance of the MoE compared with the singular models; minADE performance of the MoE compared with the singular models; evolution of the probability vector.}
    \label{fig:lyft}
    \vspace{2mm}
\end{figure}