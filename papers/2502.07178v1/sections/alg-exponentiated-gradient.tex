%!TEX root = ../root.tex
\setlength{\textfloatsep}{0pt}% Remove \textfloatsep
\begin{algorithm}[hbt!]
\SetKwInput{KwInput}{Input}
\SetKwInput{KwInit}{Initialize}
\caption{Exponentiated Gradient}\label{alg:EG}
\KwInput{A prior distribution of the weights $\alpha_1$}
\For{$t=1,2,\dots, T$}{
    Compute $\ell_t$ as in \eqref{eq:probability-loss} and define the gradient $\tilde{g}_t = \nabla_{\alpha_t}(\ell_t) \in \Real{N}$ 
    
    Set $G_t = \max (\max_{i \in [N]}(|\tilde{g}_{t,i}|), G_{t-1})$ ($\tilde{g}_{t,i}$ denotes the $i$-th element of $\tilde{g}_t$) \label{line:Gt-EG}
    
    Define the clipped gradient $g_t = \frac{(\tilde{g}_t / G_t) + 1}{2} \in \Real{N}$ (element-wise division) \label{line:clip-gradient-EG}
    
    Update 
    \bea\label{eq:eg-update-alpha}
    w_{t+1,i} = \exp \parentheses{-\frac{\sum_{\tau=1}^{t-1}g_\tau(i) \sqrt{\ln N}}{\sqrt{t}}}
    \eea
    
    Update $\alpha_{t+1} = \frac{w}{\sum_{i=1}^N w_i}$ \label{line:normweights}
}
\end{algorithm}