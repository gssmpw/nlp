\begin{figure*}[ht]
\centering
\tiny
\begin{lstlisting}[language=python, basicstyle=\ttfamily\tiny]
import requests

# Define the required headers for API access.
headers = {"Authorization": "YOUR API KEY"}

def search_person(query: str, include_adult=False, language="en-US", page=1):
    '''
    Omitted for simplicity due to space limitations
    '''
    url = "https://api.themoviedb.org/3/search/person"
    
    # Prepare the parameters for the request
    params = {
        "query": query,
        "include_adult": include_adult,
        "language": language,
        "page": page
    }
    
    # Make the API request
    response = requests.get(url, headers=headers, params=params)
    response.raise_for_status()
    return response.json()

def get_person_movie_credits(person_id: int, language="en-US"):
    '''
    Omitted for simplicity due to space limitations
    '''
    url = f"https://api.themoviedb.org/3/person/{person_id}/movie_credits"
    
    # Prepare query parameters
    params = {"language": language}
    
    # Make the API request
    response = requests.get(url, headers=headers, params=params)
    response.raise_for_status()
    return response.json()

def get_directed_movie_count(director_name: str) -> int:
    '''
    Get the number of movies directed by a specific director.

    Parameters:
        director_name (str): The full name of the director whose movies to count.

    Returns:
        int: The number of movies directed by the specified director.
    '''
    # Step 1. Search for the director "Sofia Coppola" using the /3/search/person API to find her person_id.
    person_search_response = search_person(query=director_name)

    # Get person_id from response
    person_id = (
        person_search_response.get("results")[0]["id"]
        if person_search_response and person_search_response.get("results")
        else None
    )

    # Step 2. Retrieve the movie credits for Sofia Coppola using her person_id with the /3/person/{person_id}/movie_credits API.
    if person_id:
        movie_credits_response = get_person_movie_credits(person_id)

        # Step 3. Count the number of movies in the credits retrieved.
        # Filter for movies that Sofia Coppola directed
        directed_movies = [
            movie
            for movie in movie_credits_response["crew"]
            if movie["job"] == "Director"
        ]

        number_of_movies_directed = len(directed_movies)
        return number_of_movies_directed

    return 0

if __name__ == "__main__":
    number_of_movies_directed = get_directed_movie_count(director_name="Sofia Coppola")
    print("Number of movies directed by Sofia Coppola:", number_of_movies_directed)
\end{lstlisting}
\caption{An code example of the main function $F$ generated by \texttt{ToolCoder} for the query: \textit{give me the number of movies directed by Sofia Coppola}. This step implements the actual functionality of all API calls in the \texttt{call\_api} placeholders in Figure~\ref{app:planner_example} according to their API documentations. Due to space limitations, the docstrings of some functions have been omitted.}
\label{app:main_function_example}
\end{figure*}