\section{Introduction}

\label{Introduction}

Air pollution is one of the greatest current global health challenges faced by society. According to the World Health Organization, 99\% of the worldâ€™s population breathes unhealthy air, which is responsible for as many as 7 million premature deaths annually~\cite{Lelieveld2020}. In China alone, an estimated 2.5 million people die per year due to poor air quality~\cite{Kulmala2015}. Therefore, air quality prediction is a crucial field of study aimed at safeguarding both human and environmental health, especially in the context of megacities such as those in China. 

\begin{figure}[t]
    \centering
    \includegraphics[width=\textwidth]{figures/PM2.5_Predicted_Upscaled_Map.pdf}
    \caption{Daily mean PM\textsubscript{2.5} prediction over northern China using AQ-Net. $\bigcirc$ indicates ``visible'' stations, which provided historical data for training, whereas $\triangle$ represents ``hidden'' stations for which only geographic coordinates were available (handled by our neural kNN module). The color scale ranges from blue (low PM\(_{2.5}\)) to red (high PM\(_{2.5}\)), highlighting pollution hotspots in specific provinces.}
    \label{fig:map_china}
\end{figure}

Accurately predicting urban air quality is challenging due to the complex interplay of spatiotemporal factors, particularly in dense megacities such as Beijing. However, due to the limited monitoring stations or instrument errors, it is important to reanalyze the historical data to reconstruct a complete picture of air pollution across time and space, and gain knowledge for atmospheric chemistry study. Traditional deep learning methods (e.g., LSTMs with attention) can handle temporal sequences but often struggle in unmonitored areas lacking direct measurements. To address this limitation, we propose AQ-Net, a hybrid approach that combines an LSTM, multi-head attention, and a neural k-Nearest Neighbors (kNN) module for spatiotemporal analysis. Our model specifically focuses on PM\(_{2.5}\) since it has significant health and environmental impacts for its longer atmospheric lifetime and widespread sources. As illustrated in Figure~\ref{fig:map_china}, given visible stations ($\triangle$), not only AQ-Net reconstructs the PM\(_{2.5}\) at hidden stations (nearby stations $\bigcirc$), it can also estimate the global PM\(_{2.5}\) map across northern China and accurately localize pollution, like Beijing, Hebei, and Shandong. Even in regions lacking direct monitoring, the model demonstrates robust performance, underscoring its capacity to handle both temporal dependencies and spatial variability for enhanced air quality reanalysis. To summarize, our contributions are:

\begin{itemize}
\item We propose the first neural network for air quality reanalysis in both spatial and temporal domains, designed to take past data to reconstruct historical pollution levels, ensuring spatiotemporal consistency and accuracy. 
\item To model the intra-correlations across the temporal domain, we propose to combine LSTM and multi-head attention to explore critical time steps for sequential analysis.
\item We come up with a novel Cyclic Encoding (CE) technique to project the time steps to 2D sinusoid vectors for continue representation. It gains significant improvements in our experiments.
\item To provide spatial resolutions for air quality analysis, we propose a learnable neural kNN model to explore feature domain interpolation, which can capture the spatial correlations from neighborhoods for arbitrary grid upsampling.
\item We conduct extensive experiments on northern China air quality reanalysis and show the efficiency of our AQ-Net on short- and long-term spatiotemporalral prediction.
\end{itemize}



% !!!***I'm not sure how to make the bib file for the website (WHO, 2025)***!!!
% WHO, 2025: https://www.who.int/health-topics/air-pollution
% Lelieveld et al., 2020: https://doi.org/10.1093/cvr/cvaa073
% Kulmala, 2015: https://doi.org/10.1038/526497a 