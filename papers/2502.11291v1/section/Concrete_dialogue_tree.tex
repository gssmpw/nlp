\subsection{Dialogue Trees, Dialogues and Focused Sub-dialogues}
\label{sec:con-DT}

In essence, a dialogue is a sequence of utterances $u_1, \ldots, u_n$, each of which transforms the dialogue from one state to another.
To keep track of information disclosed in dialogues for P-SAFs, we define \emph{dialogue trees} constructed as the dialogue progresses.  These are subsequently used to determine \emph{successful dialogues} w.r.t argumentation semantics. 

A dialogue tree represents a dispute progress between a proponent and an opponent who take turns exchanging arguments in the form of formulas of a KB.
%The proponent and opponent share the same beliefs represented as facts underlying the construction of the tree.
The proponent starts the dispute with their arguments and must defend against all of the opponent's attacks to win.
%
%
Informally, in a dialogue tree, the formula of each node represents an argument's conclusion or elements of the argument's support. 
%
A node is annotated \emph{unmarked} if its formula is only mentioned in the claim, but without any further examination, \emph{marked-non-fact} if its formula is the logical consequence of previous uttered formulas, and \emph{marked-fact} if its formula has been explicitly uttered as a fact in $\mK$.
%
A node is labelled $\po$ $(\op)$ if it is (directly or indirectly) for (against, respectively) the claim of the dialogue. The $\ID$ is used to identify the nodeâ€™s corresponding utterance in the dialogue.
%
The nodes are connected in two cases: (1) they belong to the same argument, and (2) they form collective attacks between arguments. 
 We formally define dialogue trees and dialogues.


\begin{definition}
\label{def:dia-tree-DLAF}
Given a sequence of utterances $\delta = u_1, \ldots, u_n$, the \textbf{dialogue tree} $\mT (\delta)$ drawn from $\delta$ is a tree whose \emph{nodes} are tuples $(\tS,\ [\tT,\ \tL,\ \ID])$, where:
    \begin{itemize}
        \item $\tS$ is a formula in $\mL$,
        \item $\tT$ is either $\um$ (unmarked), $\nf$ (marked-non-fact), $\f$ (marked-fact),
        \item $\tL$ is either $\po$ or $\op$,
        \item $\ID$ is the identifier of the utterance $u_i$;
    \end{itemize}

and $\mT(\delta)$ is $\mT^{n}$ in the sequence $\mT^{1}, \ldots, \mT^{n}$ constructed inductively from $\delta$, as follows:
 \begin{enumerate}
     \item $\mT^{1}$ contains a single node: $(\phi, [\um ,\ \po,\ \id_1])$ where $\id_1$ is the identifier of the utterance $u_1 = (\_, \_, \cla(\phi), \id_1)$;

     \item  Let $u_{i+1} = (\_,\ \tg,\ \CO ,\ \id)$ be the utterance in $\delta$; $\mT^i$ be the $i$-th tree with the utterance $(\_,\ \_,\ \CO_{\tg},\ \tg)$ as the target utterance of $u_{i+1}$.
     Then $\mT^{i+1}$ is obtained from $\mT^i$ by $u_{i+1}$, if one of the following conditions holds: $(\tL, \tL_{\tg} \in \{\po, \op\}, \tL \neq \tL_{\tg})$:
    
     \begin{enumerate} [a)]%[label=(\alph*)]
          \item If $\CO = \off(\Delta,\ \alpha)$ with $\Delta = \{\beta_1, \ldots, \beta_m \}$ and $\alpha \in \cn(\Delta)$,  then $\mT^{i+1}$ is obtained: 
       
        \begin{itemize}
            \item For all $\beta_j \in \Delta$, new nodes $(\beta_j, [\tT,\ \tL,\ \id])$ are added to the node $(\alpha, [\_,\ \tL ,\ \tg])$ of $\mT^i$. Here $\tT = \f$ if $\beta_j \in \mK$, otherwise $\tT = \nf$;

            \item  The node $(\alpha, [\_,\ \tL ,\ \tg])$ is replaced by $(\alpha, [\nf,\ \tL ,\ \tg])$;
        \end{itemize}      
        
   
         \item If $\CO = \fa(\alpha)$ then $\mT^{i+1}$  is $\mT^i$ with the node $(\alpha,\ [\_,\ \tL,\ \tg])$ replaced by $(\alpha,\ [\f,\ \tL,\ \id])$;

         \item        
         If $\CO = \cont(\Delta, \eta)$ where $\Delta = \{\beta_1, \ldots, \beta_m \}$ and $\Delta \cup \{\eta \}$ is inconsistent, then $\mT^{i+1}$ is obtained by adding
         new nodes $(\beta_j, [\tT ,\ \tL ,\ \id])$, $(\tT = \f$ if $\beta_j \in \mK$, otherwise $\tT = \nf )$, as children of the node $(\eta, [\tT_{\tg} ,\ \tL_{\tg},\ \tg])$ of $\mT^i$, where $\tT_{\tg} \in \{ \f,\ \nf \}$.
         
     \end{enumerate}
 \end{enumerate}


 For such dialogue tree $\mT(\delta)$, the nodes labelled by $\po$ (resp., $\op$) are called the \emph{proponent nodes} (resp., \emph{opponent nodes}).
%
 We call the sequence $u_1, \ldots, u_n$ a \textbf{dialogue} $D(\phi)$ for $\phi$ where $\phi$ is the formula of the root in $\mT(\delta)$.
 %
 \end{definition}

 %
 %$\delta^{\prime}$ is called a \emph{sub-dialogue} of $\delta$  iff it is a dialogue for $\phi$ and, for all utterances $u \in \delta^{\prime}$, $u \in \delta$. We say that $\delta$ is the \emph{full-dialogue} of $\delta^{\prime}$ and $\mT(\delta^{\prime})$ drawn from $\delta^{\prime}$  is the sub-tree of $\mT(\delta)$.
 %We say that the dialogue tree $\mT(\delta)$ drawn from $D(\phi)$.


 This dialogue tree can be seen as a concrete representation of an \emph{abstract dialogue tree} defined in~\cite{loanho_2024}. 
 Here, the nodes represent formulas and the edges display either the monotonic inference steps used to construct arguments or the attack relations between arguments. A group of nodes in a dialogue tree with the same label $\po$ (or $\op$) corresponds to the proponent (or opponent) argument in the abstract dialogue tree.
 
 
 % which displays the formulas and the monotonic inference steps used by the adversaries to construct their arguments.

\begin{definition} [Focused sub-dialogues]
\label{def:focused-sub-dia}
$\delta^{\prime}$ is called a \emph{focused sub-dialogue} of a dialogue $\delta$  iff it is a dialogue for $\phi$ and, for all utterances $u \in \delta^{\prime}$, $u \in \delta$. We say that $\delta$ is the \emph{full-dialogue} of $\delta^{\prime}$ and $\mT(\delta^{\prime})$ drawn from $\delta^{\prime}$  is the sub-tree of $\mT(\delta)$.
 
\end{definition}

If there are no utterances for both proponents and opponents in a dialogue tree from a dialogue $\delta$, then $\delta$ is called \emph {terminated}.
%
Note that a dialogue can be "incomplete", which means that it ends before the utterances related to determining success are claimed. To prevent this from happening we assume that dialogues are \emph{complete}, i.e. that there are no "unsaid" utterances (with the content $\fa$, $\off$ or $\cont$) in such dialogue that would bring important arguments to determine success. This assumption will ease the proof of soundness result later. 

 \begin{example} [Continue Example~\ref{ex:KB-arg}]
\label{ex:tab-dia}
When users received the answer "$(\vi)$ \emph{is possible researcher}", they would like to know "\emph{Why is this the case?}". The system will explain to the users through the natural language dispute agreement that the agent $a_1$ is persuading $a_2$ to agree that $\vi$ is a researcher. This dispute agreement is formally modelled by an explanatory dialogue $D(\rese(\vi)) = \delta$ as in Figure~\ref{tab:dia}.

\begin{figure} \vspace{-8mm}
\centering
    \includegraphics [scale = 0.85]{Picture/table.pdf}\vspace{-3mm}
    \caption{\scriptsize Given $\mL_t$ is $\mK_1$, a dialogue $D(\rese(\vi))$ $= u_1, \ldots, u_9 $~for $q_1 = \rese(\vi)$}
        \label{tab:dia}
\end{figure}

Figure~\ref{fig:construct-tree} illustrates how to fully construct a dialogue tree $\mT(\delta)$  from $D(\rese(\vi)) = \delta$. 
%Figure~\ref{fig:comple-tree} shows $\mT(\delta)$ after the construction processing. The line indicates that children conflict with their parents. The dotted line indicates that children are implied from their parents by inference rules.
To avoid confusing users, after the construction processing, we display the final dialogue tree $\mT(\delta)$ with necessary labels, such as formulas, $\po$ and $\op$, in  Figure~\ref{fig:tree-user}.
The line indicates that children conflict with their parents. The dotted line indicates that children are implied from their parents by inference rules.
From this tree, the system provides a dialogical explanation in natural language as shown in Example~\ref{ex:motivation-ex}.
\end{example}

\begin{figure}  \vspace{-8mm}
\centering   
\includegraphics[scale = 0.6]{Picture/construction-tree.pdf}
\caption{Construction of the dialogue tree $\mT(\delta) = \mT_{7}(\delta)$ drawn from $D(\rese(\vi))$.}
\label{fig:construct-tree}
\end{figure}

\begin{figure}  \vspace{-8mm}
\centering   
\includegraphics[scale = 0.55]{Picture/dia-tree.pdf}
\caption{A final version of the dialogue tree $\mT(\delta)$ is displayed for users}
\label{fig:tree-user}
\end{figure}


\subsection{Focused Dialogue Trees}

To determine and explain the arguments of acceptability (wrt argumentation semantics) by using dialogues/ dialogue trees, we present a notion of \emph{focused dialogue trees} that will be needed for the following sections. 
This concept is useful because it allows us to show a \emph{correspondence principle} between dialogue trees and \emph{abstract dialogue trees} defined in~\cite{loanho_2024}~\footnote{
%
We reproduce the notion of abstract dialogue trees and introduce the correspondence principle in Appendix~\ref{app:pre}.
Here we briefly describe the concept of abstract dialogue trees: an abstract dialogue tree is a tree where nodes are labeled with arguments, and edges represent attacks between arguments. }.
By the correspondence principle, we can utilize the results from~\cite{loanho_2024} to obtain the important results in Section~\ref{sec:soundness} and~\ref{sec:completeness}.


Observe that a dialogue $\delta$ can be seen as a collection of several (independent) focused sub-dialogues $\delta_1, \ldots, \delta_n$. The dialogue tree $\mT(\delta_i)$ drawn from the focused sub-dialogue $\delta_i$ is a subtree of $\mT(\delta)$ and corresponds to the abstract dialogue tree (defined in~\cite{loanho_2024}) (for an argument for $\phi$). Each such subtree of $\mT(\delta)$ has the following properties: (1) $\phi$ is supported by a single proponent argument; (2) An opponent argument is attacked by either a single proponent argument or a set of collective proponent arguments; (3) A proponent argument can be attacked by either multiple single opponent arguments or sets of collective opponent arguments. We call a tree with these properties the \emph{focused dialogue tree}.


\begin{definition} [Focused dialogue trees]
\label{def:t-focused}
A dialogue tree $\mT(\delta)$ is \emph{focused} iff
\begin{enumerate}
    \item all the immediate children of the root node have the same identifier (that is, are part of a single utterance);
    
    \item all the children labelled~$\po$ of each potential argument labelled~$\op$
        have the same identifier (that is, are part of a single utterance)
\end{enumerate}
\end{definition}


In the above definition, we call child of a potential argument a node that
is child of any of the nodes of the potential argument.

\begin{remark}
Focused dialogue trees and their relation to abstract dialogue trees are crucial for proving the important results in Section~\ref{sec:soundness} and~\ref{sec:completeness}. We refer to Appendix~\ref{app:proof-soundness} for details.    
\end{remark}

\begin{example} Consider a query $q_3 = A(a) $ to a KB $\mK_3 = (\mR_3, \mC_3, \mF_3)$ where 
\begin{align*}
    \mR_3 = & \{r_1: C(x) \land B(x) \rightarrow A(x),\ r_2: D(x) \rightarrow A(x) \} \\
    \mC_3 = & \{ D(x) \land C(x) \rightarrow \bot ,\ E(x) \land C(x) \rightarrow \bot \} \\
    \mF_3 = & \{B(a) , C(a), D(a), E(a) \}
\end{align*}
  Figure~\ref{fig:non-foc-tree} (Left) shows a non-focused dialogue tree drawn for a dialogue $D(A(a)) = \delta$.  Figure~\ref{fig:non-foc-tree}(Right) shows a focused dialogue tree $\mT(\delta_1)$ drawn for a sub-dialogue $\delta_1$ of $\delta$. This tree is the sub-tree of $\mT(\delta)$.
\end{example}

\begin{figure}
\centering
\begin{tikzpicture}
    \node (dt) at (0,0) {\includegraphics[scale=0.5]{Picture/non-foc-tree.pdf}};
    \node (d1) at (6, 0) {\includegraphics[scale=0.55]{Picture/focused-dia-tree.pdf}};
\end{tikzpicture}
\caption{
Left: A non-focused dialogue tree.
Right: A focused dialogue tree $\mT(\delta_1)$.
}
\label{fig:non-foc-tree}
\end{figure}





















