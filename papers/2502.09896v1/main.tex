\documentclass[compsoc,conference,a4paper,10pt]{IEEEtran}
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\pdfoutput=1
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{graphicx}
\usepackage{doi}
\usepackage{color}
\usepackage{xcolor}
\usepackage{cite}
\usepackage{colortbl}
\usepackage[font=footnotesize]{caption}
\usepackage{multicol}
\usepackage{amsmath,amsfonts,stmaryrd,xspace,enumitem}
\usepackage{tablefootnote}
\usepackage{multirow}
\usepackage{algorithmic,algorithm}
\usepackage{subfigure}
\usepackage{verbatim}
\usepackage{wrapfig}
\usepackage{tikz}
\usepackage{circledsteps}
\usepackage{makecell}
\usepackage{pifont}
\usepackage{svg}
\usepackage{setspace}
\usetikzlibrary{shapes.geometric, positioning}

% Optional math commands from https://github.com/goodfeli/dlbook_notation.



\renewcommand{\algorithmicrequire}{ \textbf{Input:}} %Use Input in the format of Algorithm
\renewcommand{\algorithmicensure}{ \textbf{Output:}}



\newcommand{\todo}[1]{%
    \mbox{}% prevent marginpar from being on previous paragraph
    \marginpar{%
        \colorbox{yellow!100}{\textcolor{white}{TODO}}%
        \vspace*{-22pt}% hack!
    }%
    \textcolor{red}{\;\;\;\;#1}%
}


\def\ie{\textit{i.e.}} 
\def\etc{\textit{etc.}}
\def\eg{\textit{e.g.}}
\def\etal{\textit{et~al.}}
\def\aka{\textit{a.k.a.}}

\def\chatiot{\textsc{ChatIoT}} 
\def\iotrgen{\textbf{{IoT-RG}}}
\def\datakit{\textbf{{DataKit}}} 

\newcommand{\centered}[1]{\begin{tabular}{c} #1 \end{tabular}}
\definecolor{verylightgray}{gray}{0.95}

% Define custom colors for code
\definecolor{keywordcolor}{rgb}{0.5,0.1,0.6} % Purple keywords
\definecolor{stringcolor}{rgb}{0.2,0.6,0.2}  % Green strings
\definecolor{commentcolor}{rgb}{0.5,0.5,0.5} % Gray comments
\definecolor{bgcolor}{rgb}{0.95,0.95,0.95}   % Light gray background for the code


\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{\chatiot: Large Language Model-based Security Assistant for Internet of Things with Retrieval-Augmented Generation
}

%\author{\IEEEauthorblockN{Anonymous Authors}}

\author{
    \IEEEauthorblockN{Ye Dong}
    \IEEEauthorblockA{Singapore University of Technology and Design\\
    ye\_dong@sutd.edu.sg}\\
    \IEEEauthorblockN{Sudipta Chattopadhyay}
    \IEEEauthorblockA{Singapore University of Technology and Design\\
    sudipta\_chattopadhyay@sutd.edu.sg}
    \and 
   \IEEEauthorblockN{Yan Lin Aung}
    \IEEEauthorblockA{Singapore University of Technology and Design\\
    linaung\_yan@sutd.edu.sg}\\
    \IEEEauthorblockN{Jianying Zhou}
    \IEEEauthorblockA{Singapore University of Technology and Design\\
    jianying\_zhou@sutd.edu.sg}
}


\maketitle

\begin{abstract}
Internet of Things (IoT) has gained widespread popularity, revolutionizing industries and daily life. However, it has also emerged as a prime target for attacks.
Numerous efforts have been made to improve IoT security, and substantial IoT security and threat information, such as datasets and reports, have been developed.
However, existing research often falls short in leveraging these insights to assist or guide users in harnessing IoT security practices in a clear and actionable way.
In this paper, we propose \chatiot, a large language model (LLM)-based IoT security assistant designed to disseminate IoT security and threat intelligence.
By leveraging the versatile property of retrieval-augmented generation (RAG), \chatiot\ successfully integrates the advanced language understanding and reasoning capabilities of LLM with fast-evolving IoT security information.
Moreover, we develop an end-to-end data processing toolkit to handle heterogeneous datasets.
This toolkit converts datasets of various formats into retrievable documents and optimizes chunking strategies for efficient retrieval.
Additionally, we define a set of common use case specifications to guide the LLM in generating answers aligned with users' specific needs and expertise levels.
Finally, we implement a prototype of \chatiot\ and conduct extensive experiments with different LLMs, such as LLaMA3, LLaMA3.1, and GPT-4o. Experimental evaluations demonstrate that \chatiot\ can generate more reliable, relevant, and technical in-depth answers for most use cases.
When evaluating the answers with LLaMA3:70B, \chatiot\ improves the above metrics by over $10\%$ on average, particularly in relevance and technicality, compared to using LLMs alone.
\end{abstract}

\begin{IEEEkeywords}
Internet of Things, Security, Large Language Model, Retrieval-Augmented Generation
\end{IEEEkeywords}

\input{Sections/intro}

\input{Sections/background}

\input{Sections/Overview}

\input{Sections/Design}

\input{Sections/experiment}

\input{Sections/rw}

\input{Sections/conclusion}

\section*{Acknowledgements} This research is supported by the National Research Foundation, Singapore, under its National Satellite of Excellence Programme “Design Science and Technology for Secure Critical Infrastructure: Phase II” (Award No: NRF-NCR25-NSOE05-0001). Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not reflect the views of National Research Foundation, Singapore.



\begin{thebibliography}{00}

\bibitem{kouicem2018internet}
D.~E. Kouicem, A.~Bouabdallah, and H.~Lakhlef, ``Internet of things security: A top-down survey,'' \emph{Computer Networks}, vol. 141, pp. 199--221, 2018.

\bibitem{ahmad2021machine}
R.~Ahmad and I.~Alsmadi, ``Machine learning approaches to iot security: A systematic literature review,'' \emph{Internet of Things}, vol.~14, p. 100365, 2021.

\bibitem{williams2017identifying}
R.~Williams, E.~McMahon, S.~Samtani, M.~Patton, and H.~Chen, ``Identifying vulnerabilities of consumer internet of things (iot) devices: A scalable approach,'' in \emph{2017 IEEE International Conference on Intelligence and Security Informatics (ISI)}.\hskip 1em plus 0.5em minus 0.4em\relax IEEE, 2017, pp. 179--181.

\bibitem{deogirikar2017security}
J.~Deogirikar and A.~Vidhate, ``Security attacks in iot: A survey,'' in \emph{2017 International Conference on I-SMAC (IoT in Social, Mobile, Analytics and Cloud)(I-SMAC)}.\hskip 1em plus 0.5em minus 0.4em\relax IEEE, 2017, pp. 32--37.

\bibitem{gormucs2018security}
S.~G{\"o}rm{\"u}{\c{s}}, H.~Ayd{\i}n, and G.~Uluta{\c{s}}, ``Security for the internet of things: a survey of existing mechanisms, protocols and open research issues,'' \emph{Journal of the Faculty of Engineering and Architecture of Gazi University}, vol.~33, no.~4, pp. 1247--1272, 2018.

\bibitem{sokiotllm}
M.~A. Ferrag, M.~Ndhlovu, N.~Tihanyi, L.~C. Cordeiro, M.~Debbah, T.~Lestable, and N.~S. Thandi, ``Revolutionizing cyber threat detection with large language models: A privacy-preserving bert-based lightweight model for iot/iiot devices,'' \emph{IEEE Access}, vol.~12, pp. 23\,733--23\,750, 2024.

\bibitem{ma}
X.~Ma, L.~Luo, and Q.~Zeng, ``From one thousand pages of specification to unveiling hidden bugs: Large language model assisted fuzzing of matter {IoT} devices,'' in \emph{33rd USENIX Security Symposium (USENIX Security 24)}.\hskip 1em plus 0.5em minus 0.4em\relax Philadelphia, PA: USENIX Association, Aug. 2024, pp. 4783--4800. [Online]. Available: \url{https://www.usenix.org/conference/usenixsecurity24/presentation/ma-xiaoyue}

\bibitem{llmiotfuz}
J.~Wang, L.~Yu, and X.~Luo, ``Llmif: Augmented large language model for fuzzing iot devices,'' in \emph{2024 IEEE Symposium on Security and Privacy (SP)}.\hskip 1em plus 0.5em minus 0.4em\relax Los Alamitos, CA, USA: IEEE Computer Society, may 2024, pp. 881--896. [Online]. Available: \url{https://doi.ieeecomputersociety.org/10.1109/SP54263.2024.00211}

\bibitem{yang2023iot}
Y.~Yang, ``Iot software vulnerability detection techniques through large language model,'' in \emph{International Conference on Formal Engineering Methods}.\hskip 1em plus 0.5em minus 0.4em\relax Springer, 2023, pp. 285--290.

\bibitem{mo2024iot}
S.~Mo, R.~Salakhutdinov, L.-P. Morency, and P.~P. Liang, ``Iot-lm: Large multisensory language models for the internet of things,'' \emph{arXiv preprint arXiv:2407.09801}, 2024.

\bibitem{meyuhas2024iotlabel}
B.~Meyuhas, A.~Bremler-Barr, and T.~Shapira, ``Iot device labeling using large language models,'' \emph{arXiv preprint arXiv:2403.01586}, 2024.

\bibitem{llmiotcontrol}
B.~Rong and H.~Rutagemwa, ``Leveraging large language models for intelligent control of 6g integrated tn-ntn with iot service,'' \emph{IEEE Network}, vol.~38, no.~4, pp. 136--142, 2024.

\bibitem{ferraris2024ici}
D.~Ferraris, K.~Kotis, and C.~Kalloniatis, ``Enhancing trustapis methodology in the web of things with llm-generated iot trust semantics,'' in \emph{26th International Conference on Information and Communications Security (ICICS 2024)}.\hskip 1em plus 0.5em minus 0.4em\relax Mytilene, Lesvos, Greece: Springer, 2024. [Online]. Available: \url{/wp-content/papers/ferraris2024ici.pdf}

\bibitem{CVE_Mission}
{CVE Program}, ``{CVE\textsuperscript{\textregistered} Program Mission},'' \url{https://www.cve.org/}, n.d.

\bibitem{VARIoT_db}
M.~Janiszewski, A.~Felkner, P.~Lewandowski, M.~Rytel, and H.~Romanowski, ``Automatic actionable information processing and trust management towards safer internet of things,'' \emph{Sensors}, vol.~21, no.~13, 2021. [Online]. Available: \url{https://www.mdpi.com/1424-8220/21/13/4359}

\bibitem{strom2018mitre}
B.~E. Strom, A.~Applebaum, D.~P. Miller, K.~C. Nickels, A.~G. Pennington, and C.~B. Thomas, ``Mitre att\&ck: Design and philosophy,'' in \emph{Technical report}.\hskip 1em plus 0.5em minus 0.4em\relax The MITRE Corporation, 2018.

\bibitem{abdul2019comprehensive}
H.~A. Abdul-Ghani and D.~Konstantas, ``A comprehensive study of security and privacy guidelines, threats, and countermeasures: An iot perspective,'' \emph{Journal of Sensor and Actuator Networks}, vol.~8, no.~2, p.~22, 2019.

\bibitem{wright2022regulating}
E.~Wright, D.~Lindsay, and G.~Wilkinson, ``Regulating to protect security and privacy in the internet of things (iot): Draft report,'' 2022.

\bibitem{es2023ragas}
S.~Es, J.~James, L.~Espinosa-Anke, and S.~Schockaert, ``Ragas: Automated evaluation of retrieval augmented generation,'' \emph{arXiv preprint arXiv:2309.15217}, 2023.

\bibitem{dragomir2016survey}
D.~Dragomir, L.~Gheorghe, S.~Costea, and A.~Radovici, ``A survey on secure communication protocols for iot systems,'' in \emph{2016 international workshop on Secure Internet of Things (SIoT)}.\hskip 1em plus 0.5em minus 0.4em\relax IEEE, 2016, pp. 47--62.

\bibitem{alrawi2021circle}
O.~Alrawi, C.~Lever, K.~Valakuzhy, K.~Snow, F.~Monrose, M.~Antonakakis \emph{et~al.}, ``The circle of life: A $\{$large-scale$\}$ study of the $\{$IoT$\}$ malware lifecycle,'' in \emph{30th USENIX Security Symposium (USENIX Security 21)}, 2021, pp. 3505--3522.

\bibitem{iacovazzi2023towards}
A.~Iacovazzi, H.~Wang, I.~Butun, and S.~Raza, ``Towards cyber threat intelligence for the iot,'' in \emph{2023 19th International Conference on Distributed Computing in Smart Systems and the Internet of Things (DCOSS-IoT)}.\hskip 1em plus 0.5em minus 0.4em\relax IEEE, 2023, pp. 483--490.

\bibitem{bou2020cyber}
E.~Bou-Harb and N.~Neshenko, \emph{Cyber threat intelligence for the internet of things}.\hskip 1em plus 0.5em minus 0.4em\relax Springer, 2020.

\bibitem{wagner2019cyber}
T.~D. Wagner, K.~Mahbub, E.~Palomar, and A.~E. Abdallah, ``Cyber threat intelligence sharing: Survey and research directions,'' \emph{Computers \& Security}, vol.~87, p. 101589, 2019.

\bibitem{saurabh2024hms}
K.~Saurabh, V.~Sharma, U.~Singh, R.~Khondoker, R.~Vyas, and O.~Vyas, ``Hms-ids: Threat intelligence integration for zero-day exploits and advanced persistent threats in iiot,'' \emph{Arabian Journal for Science and Engineering}, pp. 1--21, 2024.

\bibitem{ahmed2023securing}
S.~Ahmed and M.~Khan, ``Securing the internet of things (iot): A comprehensive study on the intersection of cybersecurity, privacy, and connectivity in the iot ecosystem,'' \emph{AI, IoT and the Fourth Industrial Revolution Review}, vol.~13, no.~9, pp. 1--17, 2023.

\bibitem{gpt}
A.~Radford and K.~Narasimhan, ``Improving language understanding by generative pre-training,'' 2018.

\bibitem{zhuge2021kaleido}
M.~Zhuge, D.~Gao, D.-P. Fan, L.~Jin, B.~Chen, H.~Zhou, M.~Qiu, and L.~Shao, ``Kaleido-bert: Vision-language pre-training on fashion domain,'' in \emph{Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition}, 2021, pp. 12\,647--12\,657.

\bibitem{docformer}
S.~Appalaraju, B.~Jasani, B.~U. Kota, Y.~Xie, and R.~Manmatha, ``Docformer: End-to-end transformer for document understanding,'' in \emph{Proceedings of the IEEE/CVF international conference on computer vision}, 2021, pp. 993--1003.

\bibitem{kim2022ocr}
G.~Kim, T.~Hong, M.~Yim, J.~Nam, J.~Park, J.~Yim, W.~Hwang, S.~Yun, D.~Han, and S.~Park, ``Ocr-free document understanding transformer,'' in \emph{European Conference on Computer Vision}.\hskip 1em plus 0.5em minus 0.4em\relax Springer, 2022, pp. 498--517.

\bibitem{fan2024survey}
W.~Fan, Y.~Ding, L.~Ning, S.~Wang, H.~Li, D.~Yin, T.-S. Chua, and Q.~Li, ``A survey on rag meeting llms: Towards retrieval-augmented large language models,'' in \emph{Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining}, 2024, pp. 6491--6501.

\bibitem{lewis2020retrieval}
P.~Lewis, E.~Perez, A.~Piktus, F.~Petroni, V.~Karpukhin, N.~Goyal, H.~K{\"u}ttler, M.~Lewis, W.-t. Yih, T.~Rockt{\"a}schel \emph{et~al.}, ``Retrieval-augmented generation for knowledge-intensive nlp tasks,'' \emph{Advances in Neural Information Processing Systems}, vol.~33, pp. 9459--9474, 2020.

\bibitem{liu2023llava}
H.~Liu, C.~Li, Q.~Wu, and Y.~J. Lee, ``Visual instruction tuning,'' 2023.

\bibitem{liu2023improvedllava}
H.~Liu, C.~Li, Y.~Li, and Y.~J. Lee, ``Improved baselines with visual instruction tuning,'' 2023.

\bibitem{liu2024llavanext}
H.~Liu, C.~Li, Y.~Li, B.~Li, Y.~Zhang, S.~Shen, and Y.~J. Lee, ``Llava-next: Improved reasoning, ocr, and world knowledge,'' January 2024. [Online]. Available: \url{https://llava-vl.github.io/blog/2024-01-30-llava-next/}

\bibitem{roziere2023code}
B.~Roziere, J.~Gehring, F.~Gloeckle, S.~Sootla, I.~Gat, X.~E. Tan, Y.~Adi, J.~Liu, R.~Sauvestre, T.~Remez \emph{et~al.}, ``Code llama: Open foundation models for code,'' \emph{arXiv preprint arXiv:2308.12950}, 2023.

\bibitem{elasticsearch2018elasticsearch}
``Elasticsearch,'' \emph{software, version}, vol.~6, no.~1, 2018.

\bibitem{docker-desktop}
``Docker desktop, version 4.29.0,'' \url{https://www.docker.com/products/docker-desktop}, 2024.

\bibitem{langchain2024}
``Langchain,'' \url{https://github.com/langchain-ai/langchain}, 2024, version 0.2.5.

\bibitem{streamlit}
``Streamlit, version 1.33.0,'' \url{https://streamlit.io}, 2024, accessed: 2024-09-02.

\bibitem{luo2022transformer}
Y.~Luo, X.~Chen, N.~Ge, W.~Feng, and J.~Lu, ``Transformer-based malicious traffic detection for internet of things,'' in \emph{ICC 2022-IEEE International Conference on Communications}.\hskip 1em plus 0.5em minus 0.4em\relax IEEE, 2022, pp. 4187--4192.

\bibitem{shafiq2020corrauc}
M.~Shafiq, Z.~Tian, A.~K. Bashir, X.~Du, and M.~Guizani, ``Corrauc: a malicious bot-iot traffic detection method in iot network using machine-learning techniques,'' \emph{IEEE Internet of Things Journal}, vol.~8, no.~5, pp. 3242--3254, 2020.

\bibitem{vasan2020mthael}
D.~Vasan, M.~Alazab, S.~Venkatraman, J.~Akram, and Z.~Qin, ``Mthael: Cross-architecture iot malware detection based on neural network advanced ensemble learning,'' \emph{IEEE Transactions on Computers}, vol.~69, no.~11, pp. 1654--1667, 2020.

\bibitem{chaganti2022deep}
R.~Chaganti, V.~Ravi, and T.~D. Pham, ``Deep learning based cross architecture internet of things malware detection and classification,'' \emph{Computers \& Security}, vol. 120, p. 102779, 2022.

\bibitem{aung2022atlas}
Y.~L. Aung, M.~Ochoa, and J.~Zhou, ``Atlas: A practical attack detection and live malware analysis system for iot threat intelligence,'' in \emph{International Conference on Information Security}.\hskip 1em plus 0.5em minus 0.4em\relax Springer, 2022, pp. 319--338.

\bibitem{neshenko2019demystifying}
N.~Neshenko, E.~Bou-Harb, J.~Crichigno, G.~Kaddoum, and N.~Ghani, ``Demystifying iot security: An exhaustive survey on iot vulnerabilities and a first empirical look on internet-scale iot exploitations,'' \emph{IEEE Communications Surveys \& Tutorials}, vol.~21, no.~3, pp. 2702--2733, 2019.

\bibitem{al2020survey}
M.~A. Al-Garadi, A.~Mohamed, A.~K. Al-Ali, X.~Du, I.~Ali, and M.~Guizani, ``A survey of machine and deep learning methods for internet of things (iot) security,'' \emph{IEEE communications surveys \& tutorials}, vol.~22, no.~3, pp. 1646--1685, 2020.

\bibitem{otoum2022dl}
Y.~Otoum, D.~Liu, and A.~Nayak, ``Dl-ids: a deep learning--based intrusion detection framework for securing iot,'' \emph{Transactions on Emerging Telecommunications Technologies}, vol.~33, no.~3, p. e3803, 2022.

\bibitem{tambe2019detection}
A.~Tambe, Y.~L. Aung, R.~Sridharan, M.~Ochoa, N.~O. Tippenhauer, A.~Shabtai, and Y.~Elovici, ``Detection of threats to iot devices using scalable vpn-forwarded honeypots,'' in \emph{Proceedings of the Ninth ACM Conference on Data and Application Security and Privacy}, 2019, pp. 85--96.

\bibitem{ji2024sevenllm}
H.~Ji, J.~Yang, L.~Chai, C.~Wei, L.~Yang, Y.~Duan, Y.~Wang, T.~Sun, H.~Guo, T.~Li \emph{et~al.}, ``Sevenllm: Benchmarking, eliciting, and enhancing abilities of large language models in cyber threat intelligence,'' \emph{arXiv preprint arXiv:2405.03446}, 2024.

\bibitem{llmtikg}
Y.~Hu, F.~Zou, J.~Han, X.~Sun, and Y.~Wang, ``Llm-tikg: Threat intelligence knowledge graph construction utilizing large language model,'' \emph{Computers \& Security}, vol. 145, p. 103999, 2024.

\bibitem{ferraris2020trustapis}
D.~Ferraris and C.~Fernandez-Gago, ``Trustapis: a trust requirements elicitation method for iot,'' \emph{International Journal of Information Security}, vol.~19, no.~1, pp. 111--127, 2020.

\bibitem{cui2024llmind}
H.~Cui, Y.~Du, Q.~Yang, Y.~Shao, and S.~C. Liew, ``Llmind: Orchestrating ai and iot with llm for complex task execution,'' \emph{IEEE Communications Magazine}, 2024.

\bibitem{xu2024penetrative}
H.~Xu, L.~Han, Q.~Yang, M.~Li, and M.~Srivastava, ``Penetrative ai: Making llms comprehend the physical world,'' in \emph{Proceedings of the 25th International Workshop on Mobile Computing Systems and Applications}, 2024, pp. 1--7.

\bibitem{deldari2024auditnet}
S.~Deldari, M.~Goudarzi, A.~Joshi, A.~Shaghaghi, S.~Finn, F.~D. Salim, and S.~Jha, ``Auditnet: A conversational ai-based security assistant,'' \emph{arXiv preprint arXiv:2407.14116}, 2024.

\end{thebibliography}





\input{Sections/appendix}

\end{document}
