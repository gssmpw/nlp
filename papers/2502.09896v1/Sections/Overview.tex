


\section{Overview}\label{sec:overgoal}
This section begins with our design goals (c.f., \S~\ref{sec:goal}) and then presents the system architecture about how to achieve the goals at a high level (c.f., \S~\ref{sec:overview}).


\subsection{Design Goals}\label{sec:goal}
Our goal in developing \chatiot\ is to equip it with the following essential features:

\begin{itemize}
\item\textbf{G-\textcircled{1}: Coping with the rapid evolution of IoT threat intelligence.}
\chatiot\ is designed to stay up-to-date with the rapidly evolving IoT threat intelligence.
By combining the advanced capabilities of LLM with external information retrieval, it is enhanced by the latest IoT threat information, such as new vulnerabilities, to deliver timely and technical insights.

\item \textbf{G-\textcircled{2}: Filtering relevant information.}
To prevent information overload, \chatiot\ uses advanced retrieval and filtering techniques to prioritize important, highly relevant information while discarding irrelevant data. This ensures that \chatiot\ generates actionable intelligence while avoiding overlooking critical information and filtering out unnecessary data.

\item \textbf{G-\textcircled{3}: Tailored for different user types.}
\chatiot\ guides its generated answers based on the users' roles (Consumer, Security Analyst, \etc) and their corresponding backgrounds.
This allows each kind of user to get insights or solutions that are relevant, understandable, and actionable based on their specific requirements and expertise level.
\end{itemize}





\subsection{System Architecture}\label{sec:overview}

As illustrated in Figure.~\ref{fig:system}, we designed \chatiot\ with two modules: the data processing toolkit, named \datakit, and the retrieval and generation system, abbreviated as \iotrgen, to achieve our goals:

\begin{itemize}
\item \textbf{Data Processing.} First, we integrate a variety of technologies to build our end-to-end data processing toolkit \datakit.
It can convert the collected IoT threat datasets, which are provided in various formats, into \textit{documents}, which are suitable for retrieval and LLM processing.
For each dataset, it extracts specific content for page\_content and metadata for documents, and a corresponding retriever is subsequently constructed.
\datakit\ ensures \chatiot\ can keep up with the rapid evolution of IoT threat intelligence (G-\textcircled{1}).

\item \textbf{Adaptive Retrieval.} Second, we achieve adaptive retrieval through \textit{Selector} and \textit{Self-Querying} mechanisms.
When a user submits a query $Q$, the Selector will invoke the equipped LLM to generate a configuration that determines which retrievers to activate. 
Once the configuration and query are passed to the retrievers, \iotrgen\ executes the activated self-querying retrievers to get highly relevant documents while filtering out irrelevant ones. 
This approach prevents overload, ensuring that only relevant and important documents will be utilized (G-\textcircled{2}).

\item \textbf{Guided Generation.} Finally, \iotrgen\ synthesizes the userâ€™s background, $Q$, and retrieved documents to instruct the LLM to generate answers.
In this way, the answers are generated not only based on the advanced language understanding capabilities of LLM and the retrieved IoT security-related information, but also aligned with the user's background (G-\textcircled{3}).

\end{itemize}

In this way, \chatiot\ effectively provides reliable, relevant, and technical insights on IoT security tailored to different users.


