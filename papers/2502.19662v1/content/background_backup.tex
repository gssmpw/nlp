\section{Motivation}
\label{section:motivation}
\begin{figure}[b!]
	\scriptsize
	\centering
	\input{graphs/frequency_trend}
	\caption{Achievable frequency (in GHz) for 8-bit quantized weight values from -128 to 127. Peaks indicate weight values with lower critical delays, allowing for higher operating frequencies.} 
	\label{fig:frequency_trend}
	%\vspace{-.5cm}
\end{figure}

\begin{figure}[b!]
	\scriptsize
	\centering
	\input{graphs/power_trend}
	\caption{Power consumption (in Watts) for 8-bit quantized weight values ranging from -128 to 127, where lower values reflect decreased power usage due to reduced switching activity.} 
	\label{fig:power_trend}
	%\vspace{-.5cm}
\end{figure}

The Multiply-Accumulate (MAC) unit is a fundamental component of modern AI accelerators. As depicted in Fig.~\ref{fig}, each MAC unit consists of three input ports and two output ports. The unit operates by multiplying the weight $w$ with the activation $a$ to produce the product $wa$. This product is then added to the third input $y_{n-1}$, resulting in the updated partial sum $y_n$. The outputs are the activation $a$ and the new partial sum $y_n$.

The timing characteristics of the MAC unit vary depending on the specific weight values used, as different values lead to different worst-case critical delays, thereby impacting the operating frequency. To illustrate this, we conducted a static timing analysis on an 8-bit Booth-Wallace Tree MAC unit from the Synopsys DesignWare library using Synopsys PrimeTime. Fig.~\ref{fig} presents the timing characteristics for three quantized weights: -127, 4, and 64, where the x-axis represents activation values and the y-axis shows the critical timing in nanoseconds. Due to Booth encoding, which inspects bits of the multiplier in pairs (or triplets in modified Booth encoding), certain bit patterns lead to shorter critical paths by reducing the number of active signals, resulting in variable critical delays for different weight values.

Fig.\ref{fig:frequency_trend} further details the achievable frequency, while Fig.\ref{fig:power_trend} illustrates the corresponding power consumption for each weight value in an 8-bit integer MAC unit. The active power consumption of the MAC unit is influenced by the switching activity during operations, which varies with different weight values. As observed, weight values with lower worst-case critical delays also tend to consume less power, leading to overall energy savings in executing the model. This correlation between timing and power characteristics suggests opportunities for optimizing both frequency and power efficiency by strategically selecting weight values during model inference.

%Since this MAC unit uses Booth encoding to convert multiplication into complement, shift, and add operations, certain weight values result in less critical timing by activating fewer signal propagations in the circuit.

\section{Motivation}
\label{section:motivation}
\begin{figure}[b!]
	\scriptsize
	\centering
	\input{graphs/frequency_trend}
	\caption{Achievable frequency (in GHz) for 8-bit quantized weight values from -128 to 127. Peaks indicate weight values with lower critical delays, allowing for higher operating frequencies.} 
	\label{fig:frequency_trend}
	%\vspace{-.5cm}
\end{figure}

\begin{figure}[b!]
	\scriptsize
	\centering
	\input{graphs/power_trend}
	\caption{Power consumption (in Watts) for 8-bit quantized weight values ranging from -128 to 127, where lower values reflect decreased power usage due to reduced switching activity.} 
	\label{fig:power_trend}
	%\vspace{-.5cm}
\end{figure}

The Multiply-Accumulate (MAC) unit serves as a critical component in modern AI accelerators. As depicted in Fig.~\ref{fig}, each MAC unit comprises three input ports and two output ports. It performs an operation by multiplying the weight $w$ with the activation $a$ to yield the product $wa$, which is then added to the third input $y_{n-1}$, producing the updated partial sum $y_n$. The outputs of the MAC unit include the activation $a$ and the newly computed partial sum $y_n$.

The timing characteristics of a MAC unit are heavily influenced by the specific weight values, as these values affect the worst-case critical delays, ultimately constraining the operating frequency. To investigate this, we conducted a static timing analysis on an 8-bit Booth-Wallace Tree MAC unit from the Synopsys DesignWare library using Synopsys PrimeTime. Fig.~\ref{fig} illustrates the timing profile for three quantized weights: -127, 4, and 64, with the x-axis representing activation values and the y-axis depicting critical timing in nanoseconds. The variable delays stem from Booth encoding, which processes bits of the multiplier in pairs (or triplets in modified Booth encoding). Certain bit patterns reduce the number of active signal paths, shortening critical paths and resulting in faster processing for specific weight values.

Fig.\ref{fig:frequency_trend} showcases the achievable operating frequency, while Fig.\ref{fig:power_trend} depicts the corresponding power consumption for various weight values in an 8-bit integer MAC unit. The active power consumption is determined by switching activity, which fluctuates with different weight values. Notably, weights associated with shorter critical delays tend to exhibit lower power consumption, offering potential energy savings. This observed correlation between timing and power characteristics reveals opportunities for optimizing both frequency and energy efficiency by strategically selecting weight values during model inference.

{\bf Peh: U also need to motivate the significance of MAC units in overall power/energy consumption of TPU/GPU. Either here, from your own results, with breakdown of various components, or in intro, pulling numbers from literature}

A systolic array operates as a synchronized circuit driven by a global clock frequency. Each Multiply-Accumulate (MAC) unit must operate in lockstep to ensure seamless data flow across the array at every clock cycle. The performance is thus constrained by the slowest MAC unit, dictated by the critical-path delay, which defines the maximum clock frequency the array can achieve. 
%Because the systolic array relies on uniform timing, running MAC units at different frequencies based on individual computational needs is not feasible. 
This global synchronization requirement, enforced to maintain data alignment, makes the slowest unit a performance bottleneck.