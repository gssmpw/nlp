\section{Motivation}
\label{section:motivation}
\begin{figure}[t!]
	\scriptsize
	\centering
	\includegraphics[width=1.05\columnwidth]{images/motivation.pdf}
	\caption{Impact of MAC unit on systolic array efficiency.} 
	\label{fig:motivation}
	%\vspace{-.5cm}
\end{figure}

\begin{figure}[b!]
	\scriptsize
	\centering
	\input{graphs/delays}
	\vspace{-.4cm}
    \caption{Delay profiles for two weight values. Arrows indicate the maximum delay for each weight across all activations.} 
	\label{fig:delay_profile}
	%\vspace{-.5cm}
\end{figure}


\begin{figure}[t!]
	\scriptsize
	\centering
	\input{graphs/frequency_trend}
	\caption{Achievable frequency (GHz) for 8-bit quantized weight values from -128 to 127. Peaks indicate weights with lower critical-path delays, allowing for higher operating frequencies.} 
	\label{fig:frequency_trend}
	%\vspace{-.5cm}
\end{figure}

\begin{figure}[t!]
    \hspace{-2pt}
	\scriptsize
	\centering
	\input{graphs/power_trend}
	\caption{Power consumption (in Watts) for 8-bit quantized weight values ranging from -128 to 127, where lower values reflect decreased power usage due to reduced switching activity.} 
	\label{fig:power_trend}
	%\vspace{-.5cm}
\end{figure}

The Multiply-Accumulate (MAC) unit is a fundamental component in AI accelerators, playing a significant role in both power consumption and area utilization. As illustrated in Fig.\ref{fig:motivation}(a), each MAC unit features three input ports and two output ports. 
The unit operates by multiplying the weight $w$ with the activation $a$ to produce the product $wa$. This product is then added to the third input $y_{n-1}$, resulting in the updated partial sum $y_n$. %The outputs are the activation $a$ and the new partial sum $y_n$.
%In TPUs, the systolic array (or MXUs), composed of these MAC units, occupies 77 to 80 percent of the total chip area and consumes between 50 and 89 percent of the architectureâ€™s overall power\cite{flex_tpu}. 
%This underscores the need for optimizing MAC unit efficiency, as even modest improvements can yield substantial energy savings and significantly enhance system performance.

The timing characteristics of a MAC unit are heavily influenced by the specific weight values, as they affect the worst-case critical-path delays, ultimately constraining the operating frequency. To investigate this, we conduct static timing analysis on 8-bit Booth-Wallace Tree MAC (\texttt{DW02\_MAC}) unit from the Synopsys DesignWare library using Synopsys PrimeTime~\cite{synopsys_primetime}. Fig.~\ref{fig:delay_profile} illustrates the timing profile for two quantized weights, 64 and -127, with the x-axis representing delay and the y-axis showing the frequency of this delay across all activation transitions. The weight value 64 achieves an operating clock frequency of 3.7 GHz, while -127 is limited to 1.9 GHz. This variable delays stem from Booth encoding, which processes bits of the multiplier in pairs (or triplets in modified Booth encoding). Certain bit patterns reduce the number of active signal paths, shortening critical-paths and resulting in faster processing for specific weight values.

Fig.\ref{fig:frequency_trend} shows the achievable operating frequency, based on the maximum delay for each weight value across activation transitions, while Fig.\ref{fig:power_trend} depicts the corresponding power consumption for an 8-bit integer MAC unit. The active power consumption is determined by switching activity, which fluctuates with different weight values. Notably, weights associated with shorter critical-path delays tend to exhibit lower power consumption, offering potential energy savings. This observed correlation between timing and power characteristics reveals opportunities for optimizing both frequency and energy by strategically selecting weight values for model inference.

%{\bf Peh: U also need to motivate the significance of MAC units in overall power/energy consumption of TPU/GPU. Either here, from your own results, with breakdown of various components, or in intro, pulling numbers from literature} 

The behavior of individual MAC units is crucial in systolic arrays, where performance relies on synchronized operation driven by a global clock, ensuring seamless dataflow across all units. Each MAC unit operates in lockstep to ensure seamless data flow at every clock cycle. 
%The overall performance of the array is constrained by the slowest MAC unit, with its critical-path delay dictating the maximum clock frequency of the array. 
This global synchronization, necessary for maintaining data alignment, makes the slowest unit a performance bottleneck. 
Fig.~\ref{fig:motivation}(b) illustrates the MAC units arranged in a systolic array, emphasizing how the critical-path of the slowest unit restricts the clock frequency. To address this limitation, HALO quantizes weights while accounting for the frequency and energy trends of MAC units and subsequently detects the optimal DVFS configuration. This integrated approach enhances both performance and energy, providing substantial advancement over traditional methods.