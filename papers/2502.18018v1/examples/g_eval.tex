
\lstset{language=Python, 
        basicstyle=\ttfamily\small, 
        breaklines=true, 
        numbers=left, 
        numberstyle=\tiny, 
        stepnumber=1}

\begin{lstlisting}
pipeline = Pipeline("GEval", max_workers=256) \
    >> Layer([
        CoTUnit().prompt(f"""
            Generate evaluation steps for the following task:

            {TASK}

            Evaluation Criteria:
            {criteria_name} ({scale}) - {criteria_description}

            Evaluation Steps:
        """).via("gpt-4o", temperature=0.6, n_repeats=3).stream().pin() \

        >> JudgeUnit(scale).prompt(f"""
            {TASK}

            Evaluation Criteria:

            {criteria_name} ({scale}) - {criteria_description}

            Evaluation Steps:

            {{previous.thought}}


            Source Text:

            {{source.source}}

            Summary:

            {{source.summary}}


            Evaluation Form (scores ONLY):

            - {criteria_name}:
        """).extract(WeightedSummedScoreExtractor) \
            .via(MODEL, temperature=0.0, n_repeats=3)
    ], repeat=5) \
    >> MeanVariancePoolUnit()
\end{lstlisting}