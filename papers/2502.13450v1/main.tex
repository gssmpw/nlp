\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{booktabs} % for professional tables

\usepackage{hyperref}

\usepackage{algorithmic}
\usepackage{enumitem}
% \usepackage{algpseudocode}

\newcommand{\theHalgorithm}{\arabic{algorithm}}

% If accepted, instead use the following line for the camera-ready submission:
\usepackage[accepted]{icml2025}

% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{physics}

% if you use cleveref..
\usepackage[capitalize,noabbrev]{cleveref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}


\newcommand{\rev}{\mathsf{rev}}
\usepackage[textsize=tiny]{todonotes}

\usepackage{booktabs}
\usepackage{multirow}

\usepackage[np, autolanguage]{numprint}  % for controlling significant digits
\newcommand{\bftab}{\fontseries{b}\selectfont}
%% for evaluation metrics
\newcommand{\abbfid}{FID$\downarrow$}
\newcommand{\abbmiou}{mIoU$\uparrow$}
\newcommand{\abbalignment}{Ali$\rightarrow$}
\newcommand{\abboverlap}{Ove$\rightarrow$}
%% for task names (currently following layoutdiffusion)
\newcommand{\taskugen}{Unconditioned}
\newcommand{\tasktype}{Cond-C}
\newcommand{\tasktypesize}{Cond-CS}
\newcommand{\taskcompletion}{Completion}
\newcommand{\taskrefinement}{Refinement}
\newcommand{\redenoise}{ReDeNoise}

\icmltitlerunning{Interleaved Gibbs Diffusion for Constrained Generation}

\begin{document}

\twocolumn[
\icmltitle{Interleaved Gibbs Diffusion for Constrained Generation}
\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Gautham Govind Anil}{comp}
\icmlauthor{Sachin Yadav}{comp}
\icmlauthor{Dheeraj Nagaraj}{comp}
\icmlauthor{Karthikeyan Shanmugam}{comp}
\icmlauthor{Prateek Jain}{comp}
\end{icmlauthorlist}

\icmlaffiliation{comp}{Google DeepMind}

\icmlcorrespondingauthor{Gautham Govind Anil}{gauthamga@google.com}
\icmlcorrespondingauthor{Dheeraj Nagaraj}{dheerajnagaraj@google.com}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
\printAffiliationsAndNotice{} % otherwise use the standard text.

\input{sections/1_abstract}

\input{sections/2_introduction}

\section{Preliminaries}
\label{sec:prelim}

\paragraph{Notation}

Let $\mathcal{X}$ be a finite set, let $L$ be the sequence length such that $L = L_1 + L_2$, $L_1, L_2 \in \mathbb{N}\cup\{0\}$. Let $d_{L_1+1},\dots,d_{L} \in \mathbb{N}$ be the continuous dimensions. We let our state space to be $\mathcal{S}_L = \mathcal{X}^{L_1}\times_{i=L_1+1}^{L}\mathbb{R}^{d_i}$. The elements of this set can be represented as a tuple/sequence of length $L$. For any $s \in \mathcal{S}_L$, let $s_i$ denote the element in $s$ at position $i$ in the tuple. Note that, $s_i$ is a discrete token from the set $\mathcal{X}$ if $i \leq L_1$ and it is a continuous vector sampled from $\mathbb{R}^{d_{i}}$ if $L_1 < i \leq L$. Let $s_{-i}$ denote the tuple of length $L-1$ obtained by removing the element at the $i^\text{th}$ position of $s$.

\paragraph{Problem Setup} Given samples $s_1,\dots,s_N$ from the target distribution $\pi$ over $\mathcal{S}_L$, the task is to learn a model which can generate more samples approximately from $\pi$. We will call $\mathcal{D} = \{s_1,\dots,s_N\}$ to be the dataset. 

\input{sections/3_interleaved_gibbs_diffusion}
\input{sections/4_training_denoisers}
\input{sections/5_model_architecture}
\section{Experiments}
\label{sec:experiments}

We evaluate the IGD framework on three different tasks: Layout Generation, Molecule Generation and the Boolean Satisfiability problem. While the first two tasks involve generating both discrete tokens and continuous vectors, 3SAT involves only discrete tokens. Nevertheless, all three problems are constrained generation problems and can hence benefit from the exact reversal of IGD framework. 

\input{sections/6.1_experiments_layout_generation}
\input{sections/6.2_experiments_molecule_gen}
\input{sections/6.3_experiments_3_SAT}
\input{sections/7_conclusion}

\newpage
\clearpage
\section*{Impact Statement}
This paper contributes to the advancement of machine learning by introducing a novel constrained sampling algorithm.  While generative machine learning models, particularly in text and image generation, have raised societal concerns, our work focuses on molecule generation, layout generation, and 3-SAT, using publicly available datasets.  At this stage, we foresee no direct societal impact.  However, we acknowledge that future applications of our method in sensitive domains may necessitate a more thorough evaluation of potential societal implications.
\bibliography{main}
\bibliographystyle{icml2025}


\newpage
\appendix
\onecolumn
\include{appendix/a_proofs}
\include{appendix/b_connection_alpha_beta}
\include{appendix/c_forward_process_direct}
\include{appendix/d_model_training_inference}
\include{appendix/e_model_architecture}
\include{appendix/f_layout_generation}
\include{appendix/g_molecule_generation}
\include{appendix/h_3_SAT}
\include{appendix/i_licenses}



\end{document}
