
\begin{algorithm}[tb]
\caption{Exact empirical market prices}
\label{algo:exact_market_prices}
\begin{algorithmic}[1]
    \STATE \textbf{input:} classifier $h_{w,a}$, sample set $S=\{(x_i,\budget_i,y_i)\}_{i=1}^m$
    \STATE {\textbf{initialize:} $\rev = 0$ (revenue), $U = 0$ (total units sold)}
    \FOR{$i=1,\dots,m$}
        \STATE $u_i \gets \distance^+(x_i;h)$
        \STATE $\ubar_i \gets u_i / \budget_i$
    \ENDFOR
    \STATE $(\ubar_{(1)},\dots,\ubar_{(m)}) \gets \sort(\ubar_1,\dots,\ubar_m)$
       \FOR{$i=1,\dots,m$}
        \STATE $p_i \gets 1 / \ubar_{(i)}$
        \STATE $U \gets U + \ubar_{(i)}$
        \IF{$p_i U > \rev$}
            \STATE $\rev \gets p_i U$
            \STATE $\phat \gets p_i$
        \ENDIF
    \ENDFOR
    \STATE \textbf{return:} $\phatvec = \phat \cdot w /\|w\|$
\end{algorithmic}
\end{algorithm}

