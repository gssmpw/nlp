

%\kenneth{Note that Figure 1 is a bit simplified, e.g., label verification, keep items for next iteration, is dismissed to make sure clear communication.}
%The \system is a Google Spreadsheet add-on with a user interface for guiding LLMs by providing rules or exemplary data to improve LLM performance. The system could be adapted to various single-class data annotation tasks. 
%Users can easily operate the system with minimal learning time and without the need for complex environment setup, unlike other applications.~\steven{find some other annotation systems}
In this paper, we present \system, a Google Sheets add-on that allows users to load a dataset into a Dataset spreadsheet, manually compose each part of a prompt within Task Context, Labeling Rules, and Shots sheets, and use the composed prompt to instruct an LLM to annotate data---all within the same Google Sheets document.
Motivated by the need to enable general users to prompt LLMs without installing and configuring professional tools like integrated development environments (IDEs) or Jupyter Notebooks, we decided to build a tool based on spreadsheets, which most computer users are already familiar with.
This section overviews \system's design and workflows.
%\kenneth{TODO: Maybe cite other tools and name what setup or configs they require}

\subsection{Design Goals}\label{sec:3-system-design}
\input{Sections/3-1-design-goal}

\begin{figure*}[t]
    \centering
    \includegraphics[width=0.9\linewidth]{Figures/ui-overview.jpg}\Description{This is the user interface layout and pre-defined spreadsheet tab explanation. Each predefined sheet has a set of predefined columns. PromptSheet allows users to load a dataset into the Dataset tab, which is the starting tab of the system. By clicking each tab at the bottom of the Google Sheet, users can navigate to Task Context tab, Rule Book tab, Shots tab, Working Data Sample tab, task dashboard tab and task results tabs. The task result tabs will be generated after each new annotation round and store all new annotated results.}
    \caption{The user interface and all the predefined sheets of \system, where each sheet has a set of pre-defined columns. 
    \system allows users to load a dataset into a Dataset (A) sheet, manually compose each part of a prompt within Task Context (B), Labeling Rules (C), and Shots (D) sheets, and use the composed prompt to instruct an LLM to annotate data and store the labeling results in a separate task sheet (G). All functions are presented as manuals and buttons within the sidebar on the right.}
    \label{fig:system-interface-ui-kenneth}
\end{figure*}

\subsection{User Interface and Pre-Defined Sheets}
\input{Sections/3-2-interface}



\subsection{User Workflow}
\input{Sections/3-3-workflow}

\subsection{Implementation Details\label{sec:implementation}}
\input{Sections/3-4-implementation}




%\subsection{System Design}


%\subsection{System Workflow (\hyperref[fig:system-workflow-fig]{Figure~\ref{fig:system-workflow-fig-v2}})}




% \begin{figure}
%     \centering
%     \includegraphics[width=0.85\linewidth]{Figures/Workflow/workflow-v2.jpeg}
%     \caption{System Workflow}
%     \label{fig:system-workflow-fig}
% \end{figure}












% \subsubsection{Main Procedure}
% The procedure consists of the following steps:
% \begin{itemize}
%     \item \textbf{Step 1 (Import Data): }Users can import their data instances with group ID into the `Dataset' tab and click ``Index Data ID'' to index all data instances.
%     \item \textbf{Step 2 (Answer Task Questions): }Users need to navigate to the `Context' tab to answer questions about the data annotation task they are working on.
%     \item \textbf{Step 3 (Define Labels and Rules): }Navigating to the `Rule Book' tab, users \textbf{have to} add annotation labels with corresponding definitions. 
%     \item \textbf{Step 4 (Add Gold Shots): }Users can add instances with their gold labels if applicable. 
%     \item \textbf{Step 5 (Sample Data): }Users can randomly or sequentially sample data into the `Working Data Sample' tab.
%     \item \textbf{Step 6 (Data Annotation): }After the ``Context'', ``Rule Book'', and ``Shot'' (if applicable) tabs are all settled, users can click on ``Start Annotation'' to annotate all instances sampled in the ``Working Data Sample'' tab. 
%     \item \textbf{Step 7 (Verification): }The annotation results will be saved to a new task tab. Users can start verifying LLM labels. Users who disagree with an LLM label can assign a new human-generated label to the data instance. If users find good examples that can be used for later LLM learning, they can check the ``Gold Shot'' checkboxes. They can also check the ``Keep it in the next data sample'' checkboxes if they want to re-annotate data instances.
%     \item \textbf{Iteration Procedure: }If users are not satisfied with the annotated results, they can modify the answer in the `Context' Tab \textbf{(Step 2)}; modify rules (add/adjust/delete labels or definitions) in the `Rule book' Tab \textbf{(Step 3)}; click ``Add Shots'' to add the selected ``Gold Shots'' to the `Shots' Tab \textbf{(Step 4)}; click ``Add Back'' to add instances back to the `Working Data Sample' Tab for re-annotating in the next iteration. Then, they can re-sample or re-use instances in the `Working Data Sample' tab for the next iteration \textbf{(Step 5)}. In the end, they repeat \textbf{Step 6}.
%     \item \textbf{Completion:} If users are satisfied with the annotation results, they may choose to conclude the task.
% \end{itemize}





% \paragraph{Two Data Instance Formats Handling}
% \system is designed to accommodate single and grouped data instances within a Group ID. For tasks like single-class sentiment analysis, each data instance is treated separately under its unique Group ID. However, for tasks that require contextual information, such as annotating text segments in an academic abstract (e.g., CODA-19~\cite{huang-etal-2020-coda}), \system can combine all data instances under the same Group ID into a single request to the LLM model. This flexibility allows the system to support different data instance formats based on user requirements.
