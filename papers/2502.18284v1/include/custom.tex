%%%%%%% USEPACKAGES

\usepackage[utf8]{inputenc}
% \usepackage{microtype}
% \usepackage{graphicx}
\usepackage{booktabs} % for professional tables
\usepackage{hyperref}

% \usepackage{amsmath}
% \usepackage{amsthm}
% \usepackage{amssymb}
\usepackage{amsthm}
\usepackage{bbm} 
\usepackage{bm}
\usepackage{verbatim}
\usepackage{float}
\usepackage{color,soul}
% \usepackage[dvipsnames]{xcolor}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{hhline}
% MUST be added last to work properly
%\usepackage{cite}
%\usepackage{autonum}
%\usepackage[super,negative]{nth}
\usepackage[title]{appendix}
% \usepackage{natbib}
\usepackage[nameinlink]{cleveref} 
\usepackage[font=small,labelfont=bf,
   justification=justified,
   format=plain]{caption}
% \usepackage{subcaption}
% \usepackage{tabularx}
\usepackage{tikz}
\usepackage{wrapfig,booktabs}
\usepackage{xspace}
\usepackage{cancel}
\usepackage{sidecap}
% \usepackage{authblk}

\graphicspath{ {../figures/} }

%%%%%%% LAYOUT

% \newenvironment{keywords}
% {\bgroup\leftskip 20pt\rightskip 20pt \small\noindent{\bf Keywords:} }%
% {\par\egroup\vskip 0.25ex}



%%%%%%% CUSTOM FUNCTIONS

\def\UrlBreaks{\do\/\do-}  % breaks URLs at hyphens
% \usepackage[hyphenbreaks]{breakurl}
% \hypersetup{breaklinks=true}
% \urlstyle{same}

% For operators/commands with two arguments
\DeclarePairedDelimiterX{\infdivx}[2]{(}{)}{%
  #1\;\delimsize\|\;#2%
}



%%%%%%% COMMENTS
\newcommand{\cmt}[1]{{\footnotesize\textcolor{red}{#1}}}
% \newcommand{\note}[1]{\cmt{Note: #1}}
\newcommand{\question}[1]{\cmt{\textbf{Question}: #1}}
\newcommand{\todo}[1]{\cmt{TO-DO: #1}}


%%%%%%% EDITING
\newcommand{\TR}[1]{\textcolor{red}{\small (TR: #1)}}
% \newcommand{\TRp}[1]{\textcolor{red}{(TR: #1)}}
% \newcommand{\YG}[1]{\textcolor{orange}{(YG: #1)}}
% \newcommand{\YWT}[1]{\textcolor{green}{(YWT: #1)}}
% \newcommand{\SL}[1]{\textcolor{blue}{SL: #1}}
% \newcommand{\RM}[1]{\textcolor{orange}{RM: #1}}
% \newcommand{\VP}[1]{\textcolor{green}{VP: #1}}
% \newcommand{\TWGR}[1]{\textcolor{orange}{(TWGR: #1)}}
% \newcommand{\OK}[1]{\textcolor{green}{(OK: #1)}}


%%%%%%% TEXT ACRONYMS

\newcommand{\dgps}{\textsc{dgp}s\xspace}
\newcommand{\dgp}{\textsc{dgp}\xspace}
\newcommand{\gps}{\textsc{gp}s\xspace}
\newcommand{\gp}{\textsc{gp}\xspace}
\newcommand{\bnn}{\textsc{bnn}\xspace}
\newcommand{\bnns}{\textsc{bnn}s\xspace}
\newcommand{\np}{\textsc{np}\xspace}
\newcommand{\nps}{\textsc{np}s\xspace}
\newcommand{\vae}{\textsc{vae}\xspace}
\newcommand{\vaes}{\textsc{vae}s\xspace}
\newcommand{\iwvae}{\textsc{iwvae}\xspace}
\newcommand{\iwvaes}{\textsc{iwvae}s\xspace}
\newcommand{\vi}{\textsc{vi}\xspace}
\newcommand{\svi}{\textsc{svi}\xspace}
\newcommand{\dsvi}{\textsc{dsvi}\xspace}
\newcommand{\fsvi}{\textsc{fsvi}\xspace}
\newcommand{\mfvi}{\textsc{mfvi}\xspace}
\newcommand{\iwvi}{\textsc{iwvi}\xspace}
\newcommand{\snr}{\textsc{snr}\xspace}
\newcommand{\snrs}{\textsc{snr}s\xspace}
\newcommand{\dreg}{\textsc{dreg}\xspace}
\newcommand{\clt}{\textsc{clt}\xspace}
\newcommand{\elbo}{\textsc{elbo}\xspace}
\newcommand{\elbos}{\textsc{elbo}s\xspace}
\newcommand{\kld}{KL divergence\xspace}
\newcommand{\jsd}{JS divergence}
\newcommand{\range}{\text{Ran}}

%%%%%%% ABBREVIATIONS
\newcommand{\etal}{{et~al.}\ }
\newcommand{\eg}{e.g.\ }
\newcommand{\ie}{i.e.\ }
\newcommand{\nth}{\text{th}}
\newcommand{\pr}{^\prime}
\newcommand{\inv}{^{-1}}
\newcommand{\pinv}{^{\dagger}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\gauss}{\mathcal{N}}
% \newcommand{\norm}[1]{\left|#1\right|}
\newcommand{\trace}{\text{tr}}


%%%%%%% REFERENCING
% \crefname{appsec}{appendix}{appendices}
% \Crefname{appsec}{Appendix}{Appendices}


%%% ICML SETUP

% \definecolor{mydarkblue}{rgb}{0,0.08,0.45}
% \hypersetup{ %
%     pdftitle={},
%     pdfauthor={},
%     pdfsubject={Proceedings of the International Conference on Machine Learning 2020},
%     pdfkeywords={},
%     pdfborder=0 0 0,
%     pdfpagemode=UseNone,
%     colorlinks=true,
%     linkcolor=mydarkblue,
%     citecolor=mydarkblue,
%     filecolor=mydarkblue,
%     urlcolor=mydarkblue,
%     pdfview=FitH
% }

% \hypersetup{
%     colorlinks=true,
%     linktoc=all,     %set to all if you want both sections and subsections linked
%     citecolor=blue,
%     filecolor=blue,
%     linkcolor=blue,
%     anchorcolor = blue,
%     urlcolor=blue  %choose some color if you want links to stand out
% }

% \newcommand\reffig[1]{Figure \ref{fig:#1}}
% \newcommand\refsec[1]{Section \ref{sec:#1}}
% \newcommand\refapp[1]{Appendix \ref{#1}}

% \mathtoolsset{showonlyrefs=true}


%%%%%%% PROOFS

% \newtheorem{definition}{Definition}
\newtheorem{thm}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{lem}{Lemma}
\newtheorem{cor}{Corollary}
\newtheorem{rem}{Remark}[section]

\newtheorem{innercustomdefinition}{Definition}
\newenvironment{customdefinition}[1]
  {\renewcommand\theinnercustomdefinition{#1}\innercustomdefinition}
  {\endinnercustomdefinition}

\newtheorem{innercustomtheorem}{Theorem}
\newenvironment{customtheorem}[1]
  {\renewcommand\theinnercustomtheorem{#1}\innercustomtheorem}
  {\endinnercustomtheorem}

\newtheorem{innercustomproposition}{Proposition}
\newenvironment{customproposition}[1]
  {\renewcommand\theinnercustomproposition{#1}\innercustomproposition}
  {\endinnercustomproposition}

\newtheorem{innercustomlemma}{Lemma}
\newenvironment{customlemma}[1]
  {\renewcommand\theinnercustomlemma{#1}\innercustomlemma}
  {\endinnercustomlemma}

\newtheorem{innercustomcorollary}{Corollary}
\newenvironment{customcorollary}[1]
  {\renewcommand\theinnercustomcorollary{#1}\innercustomcorollary}
  {\endinnercustomcorollary}

\newtheorem{innercustomremark}{Remark}
\newenvironment{customremark}[1]
  {\renewcommand\theinnercustomremark{#1}\innercustomremark}
  {\endinnercustomremark}

\newtheorem{innercustomcondition}{Condition}
\newenvironment{customcondition}[1]
  {\renewcommand\theinnercustomcondition{#1}\innercustomcondition}
  {\endinnercustomcondition}


%%%%%%% ALGORITHMS

% \newcommand{\algorithmautorefname}{Algorithm}%
% \newcommand{\theHalgorithm}{\arabic{algorithm}}


%%%%%%% TIKZ

\usetikzlibrary{shapes.geometric, arrows, bayesnet, calc, positioning}

\def\Id{\boldsymbol{I}}

%%%%%%% specifics for the paper
\newcommand{\reward}{r}
\newcommand{\policy}{\pi}
\newcommand{\mdp}{\mathcal{M}}
\newcommand{\states}{\mathcal{S}}
\newcommand{\actions}{\mathcal{A}}
\newcommand{\observations}{\mathcal{O}}
\newcommand{\transitions}{\mathcal{T}}
\newcommand{\initial}{\mathcal{I}}
\newcommand{\horizon}{H}
\newcommand{\rewardevent}{R}
\newcommand{\probr}{p_\rewardevent}
\newcommand{\metareward}{\bar{\reward}}


%%%%%%% MATH



%%%%%%% GPs

\DeclareMathOperator{\xbf}{\mathbf{x}}
\DeclareMathOperator{\Xbf}{\mathbf{X}}
\DeclareMathOperator{\ybf}{\mathbf{y}}
\DeclareMathOperator{\Ybf}{\mathbf{Y}}
\DeclareMathOperator{\fbf}{\mathbf{f}}
\DeclareMathOperator{\Fbf}{\mathbf{F}}
\DeclareMathOperator{\hbf}{\mathbf{h}}
\DeclareMathOperator{\Hbf}{\mathbf{H}}
\DeclareMathOperator{\ubf}{\mathbf{u}}
\DeclareMathOperator{\Ubf}{\mathbf{U}}
\DeclareMathOperator{\mbf}{\mathbf{m}}
\DeclareMathOperator{\Sbf}{\mathbf{S}}
\DeclareMathOperator{\zbf}{\mathbf{z}}
\DeclareMathOperator{\Zbf}{\mathbf{Z}}
\DeclareMathOperator{\wbf}{\mathbf{w}}
\DeclareMathOperator{\Wbf}{\mathbf{W}}
\DeclareMathOperator{\bbf}{\mathbf{b}}

\DeclareMathOperator{\kbf}{\mathbf{k}}
\DeclareMathOperator{\Kbf}{\mathbf{K}}
\DeclareMathOperator{\kx}{\mathbf{k_{x}}}
\DeclareMathOperator{\kf}{\mathbf{k_{f}}}
\DeclareMathOperator{\ku}{\mathbf{k_{u}}}
\DeclareMathOperator{\kast}{\mathbf{k_{\ast}}}
\DeclareMathOperator{\Kff}{\mathbf{K_{ff}}}
\DeclareMathOperator{\Kuu}{\mathbf{K_{uu}}}
\DeclareMathOperator{\Kuf}{\mathbf{K_{uf}}}
\DeclareMathOperator{\Kfu}{\mathbf{K_{fu}}}
\DeclareMathOperator{\Kvw}{\mathbf{K_{vw}}}
\DeclareMathOperator{\Kastast}{\mathbf{K_{\ast\ast}}}
\DeclareMathOperator{\Kfast}{\mathbf{K_{f\ast}}}
\DeclareMathOperator{\Kastf}{\mathbf{K_{\ast f}}}
\DeclareMathOperator{\Qff}{\mathbf{Q_{ff}}}
\DeclareMathOperator{\Quu}{\mathbf{Q_{uu}}}
\DeclareMathOperator{\KffT}{\mathbf{K}^\top_{\mathbf{ff}}}
\DeclareMathOperator{\KuuT}{\mathbf{K}^\top_{\mathbf{uu}}}
\DeclareMathOperator{\KufT}{\mathbf{K}^\top_{\mathbf{uf}}}
\DeclareMathOperator{\KfuT}{\mathbf{K}^\top_{\mathbf{fu}}}
\DeclareMathOperator{\KastastT}{\mathbf{K}^\top_{\mathbf{\ast\ast}}}
\DeclareMathOperator{\KfastT}{\mathbf{K}^\top_{\mathbf{f\ast}}}
\DeclareMathOperator{\KastfT}{\mathbf{K}^\top_{\mathbf{\ast f}}}
\DeclareMathOperator{\QffT}{\mathbf{Q}^\top_{\mathbf{ff}}}
\DeclareMathOperator{\QuuT}{\mathbf{Q}^\top_{\mathbf{uu}}}
\DeclareMathOperator{\Kffinv}{\mathbf{K}^{-1}_{\mathbf{ff}}}
\DeclareMathOperator{\Kuuinv}{\mathbf{K}^{-1}_{\mathbf{uu}}}
\DeclareMathOperator{\Kufinv}{\mathbf{K}^{-1}_{\mathbf{uf}}}
\DeclareMathOperator{\Kfuinv}{\mathbf{K}^{-1}_{\mathbf{fu}}}
\DeclareMathOperator{\Kastastinv}{\mathbf{K}^{-1}_{\mathbf{\ast\ast}}}
\DeclareMathOperator{\Kfastinv}{\mathbf{K}^{-1}_{\mathbf{f\ast}}}
\DeclareMathOperator{\Kastfinv}{\mathbf{K}^{-1}_{\mathbf{\ast f}}}
\DeclareMathOperator{\Qffinv}{\mathbf{Q}^{-1}_{\mathbf{ff}}}
\DeclareMathOperator{\Quuinv}{\mathbf{Q}^{-1}_{\mathbf{uu}}}
\DeclareMathOperator{\thetabf}{\bm{\theta}}
\DeclareMathOperator{\omegabf}{\bm{\omega}}
\DeclareMathOperator{\dxbf}{\text{d}\mathbf{x}}
\DeclareMathOperator{\dfbf}{\text{d}\mathbf{f}}
\DeclareMathOperator{\dFbf}{\text{d}\mathbf{F}}
\DeclareMathOperator{\dubf}{\text{d}\mathbf{u}}
\DeclareMathOperator{\dzbf}{\text{d}\mathbf{z}}
\DeclareMathOperator{\dZbf}{\text{d}\mathbf{Z}}
\DeclareMathOperator{\dwbf}{\text{d}\mathbf{w}}
\DeclareMathOperator{\dWbf}{\text{d}\mathbf{W}}
\DeclareMathOperator{\db}{\text{d}b}
\DeclareMathOperator{\dbbf}{\text{d}\mathbf{b}}

\newcommand{\bJ}{\mathbf{J}}
\newcommand{\Kpp}{\mathbf{K}_{\mathbf {\phi \phi}}}
\newcommand{\ba}{\mathbf{a}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bW}{\mathbf{W}}
\newcommand{\bK}{\mathbf{K}}
\newcommand{\bL}{\mathbf{L}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bff}{\mathbf{f}}
\newcommand{\bg}{\mathbf{g}}
\newcommand{\bk}{\mathbf k}
\newcommand{\bfm}{\mathbf m}
\newcommand{\bX}{\mathbf X}
\newcommand{\bY}{\mathbf Y}
\newcommand{\by}{\mathbf y}
\newcommand{\bx}{\mathbf x}
\newcommand{\bz}{\mathbf z}
\newcommand{\bu}{\mathbf u}
\newcommand{\bv}{\mathbf v}
\newcommand{\bR}{\mathbf R}
\newcommand{\bone}{\mathbf 1}
\newcommand{\bXi}{\boldsymbol{\Xi}}
% \newcommand{\bs}{\mathbf s}
\newcommand{\bS}{\mathbf S}
\newcommand{\bZ}{\mathbf Z}
\newcommand{\bzero}{\mathbf 0}
\newcommand{\dee}{\,\textrm{d}}
\newcommand{\given}{\,|\,}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calT}{\mathcal{T}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\calS}{\mathcal{S}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calU}{\mathcal{U}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\GP}{\mathcal{GP}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calI}{\mathcal{I}}
\newcommand{\calV}{\mathcal{V}}
\newcommand{\calX}{\mathcal{X}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\calZ}{\mathcal{Z}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calQ}{\mathcal{Q}}
\newcommand{\calW}{\mathcal{W}}

\newcommand{\Zhat}{\hat{Z}}
\newcommand{\ztilde}{\tilde{z}}
\newcommand{\ftilde}{\smash{\tilde{f}}}

\newcommand{\x}{\mathbf{x}}
\newcommand{\z}{\mathbf{z}}
\renewcommand{\L}{\mathbf{L}}
\renewcommand{\l}{{\ell}}
\newcommand{\bl}{{\boldsymbol\ell}}
\renewcommand{\u}{\mathbf{u}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\h}{\mathbf{h}}
\renewcommand{\v}{\mathbf{v}}
\newcommand{\e}{\mathbf{e}}
\renewcommand{\a}{\mathbf{a}}
\renewcommand{\t}{\mathbf{t}}
\newcommand{\f}{\mathbf{f}}
\newcommand{\g}{ {\mathbf{g} }}
\newcommand{\m}{{\mathbf{m}}}
\newcommand{\mw}{{\mathbf{m}_w}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\A}{\mathbf{A}}
\newcommand{\K}{\mathbf{K}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\Q}{\mathbf{Q}}
\newcommand{\Qf}{\mathbf{Q}_{\mathbf{f}}}
\newcommand{\C}{\mathbf{C}}
\newcommand{\U}{\mathbf{U}}
\newcommand{\Mf}{\mathbf{M}_{\mathbf{f}}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Ub}{\mathbb{U}}
\newcommand{\Pb}{\mathbb{P}}
\newcommand{\Qb}{\mathbb{Q}}
\newcommand{\Sb}{\mathbb{S}}
\newcommand{\tL}{{\tilde{\mathcal{L}}}}
\newcommand{\0}{\mathbf{0}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\dX}{\dot{\mathcal{X}}}
\newcommand{\w}{{\boldsymbol{\sigma}}}
\newcommand{\s}{{\sigma}}
% \renewcommand{\S}{{\mathbf{S}}}
\newcommand{\bo}{\boldsymbol{\omega}}
\newcommand{\bO}{\boldsymbol{\Omega}}
\renewcommand{\o}{{\omega}}
\renewcommand{\O}{{\Omega}}
\newcommand{\bmu}{{\boldsymbol{\mu}}}
\newcommand{\btheta}{{\boldsymbol{\theta}}}
\newcommand{\btau}{\bm{\tau}}
\newcommand{\tV}{\widetilde{V}}
\newcommand{\tU}{\widetilde{U}}
\newcommand{\tu}{\widetilde{\mathbf{u}}}
\newcommand{\tv}{\widetilde{\mathbf{v}}}
\newcommand{\tS}{\tilde{\Sigma}}
\newcommand{\tm}{\tilde{\mathbf{m}}}
\newcommand{\tmu}{\tilde{\boldsymbol{\mu}}}
\newcommand{\tf}{\tilde{f}}
\def\w{\mathbf{w}}

\newcommand{\Lb}{\mathcal{L}}
\newcommand{\Z}{\mathbf{Z}}
\newcommand{\W}{\mathbf{W}}

\newcommand{\tKf}{\tilde{K}_{f mm}}
\newcommand{\tKw}{\tilde{K}_{w mm}}
\newcommand{\tKg}{\tilde{K}_{\gamma mm}}
\newcommand{\tKo}{\tilde{K}_{\omega mm}}
\newcommand{\tKb}{\tilde{K}_{\beta mm}}

\newcommand{\Xt}{{\mathbf{X}_t}}
\newcommand{\XT}{{\mathbf{X}_T}}
\newcommand{\XTs}{{\mathbf{X}_T^{(s)}}}

\newcommand{\Zg}{{\mathbf{Z}_g}}
\newcommand{\Zf}{{\mathbf{Z}_\mathbf{f}}}
\newcommand{\Zft}{{\mathbf{Z}_\mathbf{f}^t}}
\newcommand{\Zfs}{{\mathbf{Z}_\mathbf{f}^s}}
\newcommand{\Ug}{{\mathbf{U}_g}}
\newcommand{\Uf}{{\mathbf{U}_\mathbf{f}}}

\newcommand{\ufj}{{\mathbf{u}_{\mathbf{f}j}}}

\newcommand{\ug}{{\mathbf{u}_g}}
\newcommand{\uw}{{\mathbf{u}_w}}
\newcommand{\us}{{\mathbf{u}_\sigma}}
\newcommand{\uo}{{\mathbf{u}_\omega}}
\newcommand{\ub}{{\mathbf{u}_\beta}}
\newcommand{\uf}{{\mathbf{u}_\mathbf{f}}}
\newcommand{\mf}{{\mathbf{m}_\mathbf{f}}}
\newcommand{\Sf}{{\mathbf{S}_\mathbf{f}}}
\newcommand{\mo}{{\mathbf{m}_\omega}}
\newcommand{\So}{{\mathbf{S}_\omega}}
\newcommand{\mb}{{\mathbf{m}_\beta}}
\newcommand{\mg}{{\mathbf{m}_g}}
\newcommand{\Sg}{{\mathbf{S}_g}}
\newcommand{\Sw}{{\mathbf{S}_w}}
\newcommand{\pg}{\phi(\g)}
\newcommand{\Sn}{\sigma_n^2}
\newcommand{\fl}{\mathcal{L}_1}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\newcommand{\Qp}{ Q^{p_\omega}}
\newcommand{\piq}{\pi^q}

\newcommand{\bphi}{\boldsymbol\phi}
\newcommand{\balpha}{\boldsymbol\alpha}
\newcommand{\bbeta}{\boldsymbol\beta}
\newcommand{\bSigma}{\boldsymbol\Sigma}
\newcommand{\infint}{\int_{-\infty}^\infty}
\newcommand{\kron}{\raisebox{1pt}{\ensuremath{\:\otimes\:}}}

\newcommand{\matern}{{Mat\'ern}\xspace}
\newcommand{\maternonetwo}{{Mat\'ern-\ensuremath{\tfrac{1}{2}}}\xspace}
\newcommand{\maternthreetwo}{{Mat\'ern-\ensuremath{\tfrac{3}{2}}}\xspace}
\newcommand{\maternfivetwo}{{Mat\'ern-\ensuremath{\tfrac{5}{2}}}\xspace}

\newcommand{\closer}[3]{{\kern-#1ex{#2}\kern-#3ex}}

\newcommand\PS[1]{{\left \langle #1 \right \rangle}_{\! \cH}}
\newcommand\PSi[2]{{ \left \langle #1 \right \rangle}_{\! #2}}


\def\changemargin#1#2{\list{}{\rightmargin#2\leftmargin#1}\item[]}
\let\endchangemargin=\endlist 


%%%%%%% MATH OPERATORS & SYMBOLS

\newcommand{\DKL}{\DD_{\textrm{KL}}\infdivx}
\newcommand{\DJS}{D_{\text{JS}}\infdivx}

\newcommand{\ELBO}[1]{\text{ELBO}(#1)}

\DeclareMathOperator{\gradphi}{\nabla_{\phi}}
\DeclareMathOperator{\gradtheta}{\nabla_{\theta}}
\DeclareMathOperator{\gradpsi}{\nabla_{\psi}}

\newcommand{\xbest}{\mathbf{\vx}^{+}}
\newcommand{\xstar}{\mathbf{\vx}^{*}}
\newcommand{\ystar}{\mathbf{\vy}^{*}}
\DeclareMathOperator*{\T}{^\intercal}
\newcommand{\norm}[2]{{\left\lVert#1\right\rVert}_{#2}}
\newcommand{\pluseq}{\mathrel{+}=}

\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\mean}{mean}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\vect}{vec}


%%%%%%% SETS
\DeclareMathOperator*{\setunion}{ \cup }
\DeclareMathOperator*{\Setunion}{ \bigcup }
\DeclareMathOperator*{\setintersect}{ \cap }
\DeclareMathOperator*{\Setintersect}{ \bigcap }
\DeclareMathOperator*{\setand}{ \wedge }
\DeclareMathOperator*{\Setand}{ \bigwedge }
\mathchardef\mhyphen="2D


%%%%%%% EXPECTATIONS & VARIANCES
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\Var}{\mathbb{V}}
\newcommand{\ex}[1]{{\mathbb E}\left[ #1 \right]}
\newcommand{\exc}[2]{{\mathbb E}\left[ #1 \,\middle \vert\, #2 \right]}
\newcommand{\exs}[2]{{\mathbb E_{#1}}\left[ #2 \right]}
\newcommand{\vars}[2]{{\mathbb V_{#1}}\left[ #2 \right]}
\newcommand{\excs}[3]{{\mathbb E_{#1}}\left[ #2 \,\middle \vert\, #3 \right]}

\newcommand\reallywidehat[1]{\arraycolsep=0pt\relax%
\begin{array}{c}
\stretchto{
  \scaleto{
    \scalerel*[\widthof{\ensuremath{#1}}]{\kern-.5pt\bigwedge\kern-.5pt}
    {\rule[-\textheight/2]{1ex}{\textheight}} %WIDTH-LIMITED BIG WEDGE
  }{\textheight} % 
}{0.5ex}\\           % THIS SQUEEZES THE WEDGE TO 0.5ex HEIGHT
#1\\                 % THIS STACKS THE WEDGE ATOP THE ARGUMENT
\rule{-1ex}{0ex}
\end{array}
}