\begin{algorithm}
\small
\caption{\small DWF Initialization with Variance-Matching and Absolute Value Truncation}
\begin{algorithmic}[1]
\label{alg:init}
\STATE \textbf{Input:} 
\STATE \quad Number $L$ and parameter size $n_l$ of layers, factorization depth $D$, minimum absolute value $\varepsilon$
\STATE \quad Standard initializations $\{\mathcal{P}(\wrm_j^{(l)}) \sim \mathcal{N}(0,\sigma_{\mathrm{w},l}^2)\}_{l=1}^L$
\FOR{$l = 1$ to $L$}
    \STATE $\sigma_l \leftarrow (\sigma_{\mathrm{w},l})^{1/D}$
    \STATE $\omega_{\text{min}}^{(l)} \leftarrow \varepsilon^{1/D}$
    \STATE $\omega_{\text{max}}^{(l)} \leftarrow \min\big\{1,(2\sigma_{\mathrm{w},l})^{1/D}\big\}$
    \FOR{each weight $\mathrm{w}_j^{(l)}$ in $n_l$}
        \FOR{$d = 1$ to $D$}
            \REPEAT
                \STATE $\omega_{j,d}^{(l)} \sim \mathcal{N}(0, \sigma_l^2)$
            \UNTIL{$\omega_{\text{min}}^{(l)} < |\omega_{j,d}^{(l)}| < \omega_{\text{max}}^{(l)}$}
        \ENDFOR
    \ENDFOR
\ENDFOR
\STATE \textbf{Output:} 
\STATE \quad Initialized factors $\{\omega_{j,d}^{(l)}\}_{d=1}^{D}$ for all weights $j \in [n_l]$ per layer and all layers $l\in [L]$.
\end{algorithmic}
\end{algorithm}