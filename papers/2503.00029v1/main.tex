\documentclass{article}
\usepackage{tencent_ailab_tech_report}


% Language setting
% Replace `english' with e.g. `spanish' to change the document language
% \usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with `a4paper' for UK/EU standard size
% \usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage{algorithmic}

\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}
\usepackage{subcaption}  % 支持子图
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{soul}
\usepackage{multirow}
\usepackage{graphicx}       % graphs
\usepackage{makecell}
\usepackage{hyperref}
\usepackage{wrapfig}
\usepackage{marvosym}
\usepackage[shortlabels]{enumitem}
\definecolor{myblue}{RGB}{215,238,247}
\definecolor{mygreen}{RGB}{230,241,221}
\definecolor{mygrey}{RGB}{242,242,242}
\definecolor{myorange}{RGB}{235,142,71}
\definecolor{textgreen}{RGB}{135,201,195}
\definecolor{mypurple}{RGB}{222,213,255}
\definecolor{darkblue}{RGB}{66,141,191}
\definecolor{greyblue}{RGB}{208,220,232}

\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\green}[1]{\textcolor{green}{#1}}



\def\AM{{\mathcal A}}
\def\BM{{\mathcal B}}
\def\CM{{\mathcal C}}
\def\DM{{\mathcal D}}
\def\EM{{\mathcal E}}
\def\FM{{\mathcal F}}
\def\GM{{\mathcal G}}
\def\HM{{\mathcal H}}
\def\IM{{\mathcal I}}
\def\JM{{\mathcal J}}
\def\KM{{\mathcal K}}
\def\LM{{\mathcal L}}
\def\MM{{\mathcal M}}
\def\NM{{\mathcal N}}
\def\OM{{\mathcal O}}
\def\PM{{\mathcal P}}
\def\SM{{\mathcal S}}
\def\RM{{\mathcal R}}
\def\TM{{\mathcal T}}
\def\UM{{\mathcal U}}
\def\VM{{\mathcal V}}
\def\WM{{\mathcal W}}
\def\XM{{\mathcal X}}
\def\YM{{\mathcal Y}}
\def\ZM{{\mathcal Z}}
\def\ZB{{\mathbb Z}}
\def\RB{{\mathbb R}}

\def\Name{Cognitive Kernel}
\newcommand{\hmc}[1]{\textcolor{blue}{[HM:#1]}}
\newcommand{\hm}[1]{\textcolor{blue}{#1}}
\newcommand{\xmc}[1]{\textcolor{orange}{[XM:#1]}}
\newcommand{\km}[1]{\textcolor{green}{KX:#1]}}
\newcommand{\wh}[1]{\textcolor{red}{WH:#1]}}

% \title{Cognitive \ Kernel: \ A \ Dockerized \ ``Autopilot'' \ System \ that \\ Everyone \ Can \ Deploy \ Privately}

\title{Streaming Looking Ahead with Token-level Self-reward}


% Your Open-source AI Employee for Completing Real-World Tasks -- Everyone can Benefit!

\author{Hongming Zhang$^1$, Ruixin Hong$^{1,2}$, Dong Yu$^1$\\
$^1$Tencent AI Lab, Seattle, $^2$Tsinghua University \\
\textit{hongmzhang@global.tencent.com, hrx20@mails.tsinghua.edu.cn, dyu@global.tencent.com}}

\begin{document}
\maketitle

\begin{abstract}

Autoregressive decoding algorithms that use only past information often cannot guarantee the best performance. 
Recently, people discovered that looking-ahead algorithms such as Monte Carlo Tree Search (MCTS) with external reward models (RMs) can significantly improve models' output by allowing them to think ahead and leverage future outputs and associated rewards to guide the current generation.
Such techniques can help the reinforcement fine-tuning phase by sampling better trajectories and the inference phase by selecting the better output.
However, their high computational cost limits their applications, especially in streaming scenarios.
To address this issue, we propose equipping the policy model with token-level self-reward modeling (TRM) capability to eliminate the need for external models and extra communication.
We name the new architecture as \textit{Reward Transformer}.
In addition, we propose a streaming-looking-ahead (\textit{SLA}) algorithm to further boost search efficiency with better parallelization.
Experiments show that \textit{SLA} achieves an overall win rate of 79.7\% against the baseline greedy decoding algorithm on three general-domain datasets with a frozen policy model while maintaining streaming efficiency.
If we combine \textit{SLA} with reinforcement fine-tuning techniques such as \textit{DPO}, \textit{SLA} achieves an overall win rate of 89.4\%. We release the experiment code at: \url{https://github.com/CognitiveKernel/SLA}.
% We propose a novel architecture reward transformer and an associated token-level Bradley-Terry loss to achieve TRM from sequence-level distant reward annotation to achieve this goal.
% In addition, we propose a streaming-looking-ahead (SLA) algorithm to help the model ``look ahead,'' evaluate future rewards, and aggregate future rewards, enabling better decision-making during output generation in a streaming paradigm.
% Experiments show that SLA achieves an overall 62.5\% win rate against the baseline greedy decoding algorithm on three representative datasets with a freezer policy model while maintaining streaming efficiency.
% If we combine SLA with DPO, SLA could achieve an overall 82.9\% win rate.
% We release the experiment code at \red{xxx}.


\end{abstract}

\input{Sections/01_introduction}
\input{Sections/02_preliminaries}
\input{Sections/03_Looking_Ahead}
\input{Sections/04_method}
\input{Sections/05_experiment}
\input{Sections/07_conclusion}

\newpage
\bibliographystyle{tencent_ailab_tech_report}
\bibliography{tencent_ailab_tech_report}

\newpage
% \input{Sections/10_Appendix}

\end{document}