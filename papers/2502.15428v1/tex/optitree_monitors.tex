\subsection{\optitree Monitors}
\label{sec:sm-trees}

This section describes how we adjust the existing sensors and monitors to work with tree topologies.

First, we do not record latencies while the RSM is in a tree configuration.
This is because the tree structure prevents direct communication between replicas, making it difficult to measure individual latencies.
Instead we measure latencies only in a star topology.
Thus, we do not need to adjust the latency monitoring for trees.
At first glance, this lack of recorded tree latencies may seem like a weakness that an adversary could exploit.
A Byzantine replica may initially behave correctly in order to be selected as an internal node.
However, if it later misbehaves, e.g., by delaying messages, it will be suspected by the suspicion monitor, resulting in a failed tree.
When a tree fails, the replicas revert to the star topology to record new measurements.
In \cref{sec:tree-formation}, we adapt the configuration sensor to search for efficient trees.
In \cref{sec:tree-suspicion}, we modify the suspicion sensor to detect slow behavior in the tree overlay.
We also optimize the suspicion monitor to compute a candidate set more efficiently, limiting the number of reconfigurations caused by faulty replicas.

\input{tex/optitree_reconfig}
\input{tex/optitree_ranking}
\input{tex/optitree_misbehavior}
\input{tex/optitree_suspicion}
