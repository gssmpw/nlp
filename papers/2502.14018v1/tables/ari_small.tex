\renewcommand{\arraystretch}{1.05}


\resizebox{0.96\linewidth}{!}{
\begin{NiceTabular}{|rl|cccccc|ccccc|}
\toprule
& & \multicolumn{3}{c}{DC tree} & \multicolumn{3}{c}{Cover tree} & \multicolumn{5}{c}{\textbf{competitors}} \\ 
& & $k$-center & $k$-median & $k$-means & $k$-center & $k$-median & $k$-means & Eucl. & \multirow{2}{*}{SCAR} & \multirow{2}{*}{Ward} & AMD- & \multirow{2}{*}{DPC} \\ 
& \textbf{Dataset} & Stability & MoE & Elbow & Stability & MoE & Elbow & $k$-means &  &  & DBSCAN & \\
\midrule
\parbox[t]{2mm}{\multirow{7}{*}{\rotatebox[origin=c]{90}{Tabular Data}}}
& Boxes & \cellcolor{Green!63}$90.1$ & \cellcolor{Green!70}$\bm{99.3}$ & \cellcolor{Green!69}$\underline{97.9}$ & \cellcolor{Green!6}$2.6$ & \cellcolor{Green!32}$42.1 \pm 4.7$ & \cellcolor{Green!20}$24.2 \pm 1.6$ & \cellcolor{Green!66}$93.5 \pm 4.3$ & \cellcolor{Green!5}$0.1 \pm 0.1$ & \cellcolor{Green!67}$95.8$ & \cellcolor{Green!46}$63.9$ & \cellcolor{Green!21}$25.9$  \\
& \cellcolor{Gray!18}{D31} & \cellcolor{Green!57}$79.7$ & \cellcolor{Green!32}$42.7$ & \cellcolor{Green!59}$82.9$ & \cellcolor{Green!35}$46.5 \pm 1.8$ & \cellcolor{Green!45}$62.0 \pm 5.4$ & \cellcolor{Green!49}$67.7 \pm 3.2$ & \cellcolor{Green!65}$\bm{92.0 \pm 2.7}$ & \cellcolor{Green!32}$41.7 \pm 5.4$ & \cellcolor{Green!65}$\bm{92.0}$ & \cellcolor{Green!61}$\underline{86.4 \pm 0.1}$ & \cellcolor{Green!17}$18.5$  \\
& airway & \cellcolor{Green!29}$38.0$ & \cellcolor{Green!48}$\bm{65.9}$ & \cellcolor{Green!43}$58.8$ & \cellcolor{Green!5}$0.8$ & \cellcolor{Green!16}$18.2 \pm 2.4$ & \cellcolor{Green!12}$12.0 \pm 1.4$ & \cellcolor{Green!31}$39.9 \pm 2.0$ & \cellcolor{Red!5}$-0.9 \pm 0.5$ & \cellcolor{Green!33}$43.7$ & \cellcolor{Green!25}$31.7$ & \cellcolor{Green!47}$\underline{65.1}$  \\
& \cellcolor{Gray!18}{lactate} & \cellcolor{Green!31}$41.0$ & \cellcolor{Green!31}$41.0$ & \cellcolor{Green!49}$\underline{67.5}$ & \cellcolor{Green!5}$0.1$ & \cellcolor{Green!7}$4.1 \pm 0.6$ & \cellcolor{Green!6}$1.7 \pm 0.2$ & \cellcolor{Green!23}$28.6 \pm 1.1$ & \cellcolor{Green!5}$1.5 \pm 1.0$ & \cellcolor{Green!23}$27.7$ & \cellcolor{Green!51}$\bm{71.5}$ & \cellcolor{Green!5}$0.0$  \\
& HAR & \cellcolor{Green!24}$30.0$ & \cellcolor{Green!35}$46.9$ & \cellcolor{Green!39}$\bm{52.8}$ & \cellcolor{Green!14}$14.7 \pm 8.8$ & \cellcolor{Green!14}$14.2 \pm 4.7$ & \cellcolor{Green!11}$9.6 \pm 2.2$ & \cellcolor{Green!35}$46.0 \pm 4.5$ & \cellcolor{Green!8}$5.5 \pm 3.2$ & \cellcolor{Green!37}$\underline{49.1}$ & \cellcolor{Green!5}$0.0$ & \cellcolor{Green!26}$33.2$  \\
& \cellcolor{Gray!18}{letterrec.} & \cellcolor{Green!12}$12.1$ & \cellcolor{Green!15}$\underline{16.6}$ & \cellcolor{Green!16}$\bm{17.9}$ & \cellcolor{Green!8}$5.8 \pm 0.2$ & \cellcolor{Green!9}$7.2 \pm 0.6$ & \cellcolor{Green!9}$6.2 \pm 0.3$ & \cellcolor{Green!13}$12.9 \pm 0.6$ & \cellcolor{Green!5}$0.4 \pm 0.1$ & \cellcolor{Green!14}$14.7 \pm 0.9$ & \cellcolor{Green!10}$7.9$ & \cellcolor{Green!5}$0.0$  \\
& PenDigits & \cellcolor{Green!48}$66.4$ & \cellcolor{Green!52}$\underline{73.1}$ & \cellcolor{Green!54}$\bm{75.4}$ & \cellcolor{Green!10}$8.0 \pm 0.8$ & \cellcolor{Green!12}$12.0 \pm 0.6$ & \cellcolor{Green!10}$8.9 \pm 0.5$ & \cellcolor{Green!41}$55.3 \pm 3.2$ & \cellcolor{Green!5}$0.9 \pm 0.3$ & \cellcolor{Green!41}$55.2$ & \cellcolor{Green!41}$55.6$ & \cellcolor{Green!23}$28.8 \pm 1.1$  \\
\midrule
\parbox[t]{2mm}{\multirow{6}{*}{\rotatebox[origin=c]{90}{Image Data}}}
& \cellcolor{Gray!18}{COIL20} & \cellcolor{Green!58}$\bm{81.2}$ & \cellcolor{Green!52}$\underline{72.8}$ & \cellcolor{Green!52}$72.6$ & \cellcolor{Green!35}$46.4 \pm 4.4$ & \cellcolor{Green!35}$46.6 \pm 2.1$ & \cellcolor{Green!36}$47.7 \pm 2.0$ & \cellcolor{Green!43}$58.2 \pm 2.8$ & \cellcolor{Green!26}$33.5 \pm 2.0$ & \cellcolor{Green!49}$68.6$ & \cellcolor{Green!30}$39.2$ & \cellcolor{Green!28}$35.9 \pm 0.1$  \\
& COIL100 & \cellcolor{Green!57}$\bm{80.1}$ & \cellcolor{Green!48}$66.8$ & \cellcolor{Green!50}$\underline{70.0}$ & \cellcolor{Green!34}$44.6 \pm 4.2$ & \cellcolor{Green!35}$46.6 \pm 1.5$ & \cellcolor{Green!37}$50.1 \pm 1.2$ & \cellcolor{Green!41}$56.1 \pm 1.4$ & \cellcolor{Green!15}$16.7 \pm 0.8$ & \cellcolor{Green!45}$61.4$ & \cellcolor{Green!14}$14.2$ & \cellcolor{Green!5}$0.2$  \\
& \cellcolor{Gray!18}{cmu}\_faces & \cellcolor{Green!44}$60.2$ & \cellcolor{Green!42}$56.6$ & \cellcolor{Green!48}$\bm{66.5}$ & \cellcolor{Green!10}$8.6 \pm 3.1$ & \cellcolor{Green!29}$37.1 \pm 4.1$ & \cellcolor{Green!27}$34.2 \pm 2.1$ & \cellcolor{Green!39}$53.2 \pm 4.7$ & \cellcolor{Green!30}$38.5 \pm 2.9$ & \cellcolor{Green!45}$\underline{61.6}$ & \cellcolor{Green!5}$0.7$ & \cellcolor{Green!5}$0.6$  \\
& OptDigits & \cellcolor{Green!41}$55.3$ & \cellcolor{Green!55}$\bm{77.0}$ & \cellcolor{Green!55}$\bm{77.0}$ & \cellcolor{Green!31}$40.9 \pm 3.5$ & \cellcolor{Green!18}$20.9 \pm 2.3$ & \cellcolor{Green!16}$18.1 \pm 2.4$ & \cellcolor{Green!45}$61.3 \pm 6.6$ & \cellcolor{Green!14}$14.4 \pm 4.1$ & \cellcolor{Green!53}$\underline{74.6 \pm 2.4}$ & \cellcolor{Green!46}$63.2$ & \cellcolor{Green!5}$0.0$  \\
& \cellcolor{Gray!18}{USPS} & \cellcolor{Green!27}$33.7$ & \cellcolor{Green!24}$29.3$ & \cellcolor{Green!24}$29.3$ & \cellcolor{Green!12}$12.0 \pm 1.7$ & \cellcolor{Green!10}$8.7 \pm 1.0$ & \cellcolor{Green!12}$11.2 \pm 1.5$ & \cellcolor{Green!39}$\underline{52.3 \pm 1.7}$ & \cellcolor{Green!6}$2.9 \pm 0.9$ & \cellcolor{Green!46}$\bm{63.9}$ & \cellcolor{Green!5}$0.0$ & \cellcolor{Green!18}$21.0$  \\
& MNIST & \cellcolor{Green!17}$19.7$ & \cellcolor{Green!32}$41.7$ & \cellcolor{Green!35}$\underline{46.0}$ & \cellcolor{Green!12}$11.1 \pm 1.7$ & \cellcolor{Green!8}$5.4 \pm 0.6$ & \cellcolor{Green!8}$5.4 \pm 0.6$ & \cellcolor{Green!29}$36.9 \pm 1.0$ & \cellcolor{Green!5}$1.3 \pm 0.4$ & \cellcolor{Green!39}$\bm{52.7}$ & \cellcolor{Green!5}$0.0$ & \cellcolor{Red!0}-  \\
\bottomrule
\CodeAfter
  \tikz \draw [dotted, thick] 
  (1-|6) -- (last-|6)
  (2-|12) -- (last-|12);
  \tikz \draw [dotted]
  (2-|4) -- (4-|4)
  (2-|5) -- (4-|5)
  (2-|7) -- (4-|7)
  (2-|8) -- (4-|8);
\end{NiceTabular}}


\renewcommand{\arraystretch}{1}
