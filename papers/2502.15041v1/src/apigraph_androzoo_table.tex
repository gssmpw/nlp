
\begin{table*}[htbp]
  \centering
    \begin{tabular}{c|c|c|ccc|ccc}
      \toprule[0.5pt]
      \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}\textbf{Monthly}\\ \textbf{Sample}\\ \textbf{Budget}\end{tabular}} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}\textbf{Model}\\ \textbf{Architecture}\end{tabular}} & \multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}\textbf{Sample}\\ \textbf{Selector}\end{tabular}} & \multicolumn{3}{c|}{\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}\textbf{APIGraph Dataset}\\ Average Performance (\%)\end{tabular}}} & \multicolumn{3}{c}{\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}\textbf{AndroZoo Dataset}\\ Average Performance (\%)\end{tabular}}}\\                   & & & \multicolumn{3}{c|}{} & \multicolumn{3}{c}{} \\
      & & & FNR & FPR & F1 & FNR & FPR & F1 \\
   
        \hline\hline

        \multirow{10}{*}{50}                                                                               & Binary MLP & Uncertainty & 23.77 & 0.52 & 83.84 & 53.12 & 0.46 & 59.50 \\
        \cline{2-9}                                                                                       & Multiclass MLP & Uncertainty & 16.10 & 4.64 & 73.77 & 49.86 & 28.52 & 28.65 \\
        \cline{2-9}                                                                                       & \begin{tabular}[c]{@{}c@{}}Multiclass MLP\\ + Binary SVM\end{tabular} & Uncertainty & 38.40 & 1.01 & 71.38 & 73.13 & 2.87 & 34.04 \\
        \cline{2-9}
        & \multirow{2}{*}{Binary SVM} & Uncertainty & \textbf{16.92} & \textbf{0.61} & \textbf{87.72} & \textbf{48.77} & \textbf{0.29} & \textbf{63.42}  \\
        &  & CADE OOD & 36.11 & 12.9 & 71.70 & 62.01 & 0.55 & 50.26 \\
        \cline{2-9}                                                                                       & multiclass SVM & Uncertainty & 35.79 & 0.17 & 87.43 & 65.77 & 0.09 & 46.91 \\
        \cline{2-9}
        & multiclass GBDT & Uncertainty & 31.75 & 0.54 & 77.92 & 50.35 & 0.47 & 61.06 \\
        \cline{2-9}
        & Enc + MLP & Pseudo Loss & \textbf{15.15} & \textbf{0.64} & \textbf{89.39} & \textbf{27.65} & \textbf{0.53} & \textbf{79.92}  \\
        % & \multirow{2}{*}{Enc + MLP} & \multirow{2}{*}{Pseudo Loss} & \textbf{15.15} & \textbf{0.64} & \textbf{89.39} & \textbf{27.65} & \textbf{0.53} & \textbf{79.92}  \\
        % &  &  & \textcolor{green}{($\downarrow$ 1.77)} & \textcolor{green}{($\downarrow$ 0.09)} & \textcolor{green}{($\uparrow$ 1.51)} & \textcolor{green}{($\downarrow$ 21.12)} & \textcolor{red}{($\uparrow$ 0.24)} & \textcolor{green}{($\uparrow$ 16.50)} \\
        \cline{2-9}                                                                                       & \cellcolor{gray!20} RF & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} 17.99 & \cellcolor{gray!20} 0.20 & \cellcolor{gray!20} 88.95 & \cellcolor{gray!20} 50.28 & \cellcolor{gray!20} 0.10 & \cellcolor{gray!20} 61.87 \\
        \cline{2-9}                                                                                       &  \cellcolor{gray!20} CatBoost & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} \textbf{14.70} & \cellcolor{gray!20} \textbf{0.33} & \cellcolor{gray!20} \textbf{90.38} & \cellcolor{gray!20} \textbf{25.72} & \cellcolor{gray!20} \textbf{0.14} & \cellcolor{gray!20} \textbf{83.81} \\
        \hline\hline

        \multirow{10}{*}{100}                                                                              & Binary MLP & Uncertainty & 20.64 & 0.49 & 86.03 & 46.39 & 0.30 & 65.26 \\
        \cline{2-9}                                                                                       & Multiclass MLP & Uncertainty & 14.77 & 6.44 & 69.91 & 35.34 & 32.64 & 33.72 \\
        \cline{2-9}                                                                                       & \begin{tabular}[c]{@{}c@{}}Multiclass MLP\\ + Binary SVM\end{tabular} & Uncertainty & 30.45 & 1.76 & 74.11 & 73.47 & 3.88 & 31.69 \\
        \cline{2-9}
        & \multirow{2}{*}{Binary SVM} & Uncertainty & \textbf{15.41} & \textbf{0.68} & \textbf{88.38} & \textbf{43.07} & \textbf{0.32} & \textbf{68.33}  \\
        &  & CADE OOD & 23.48 & 0.96 & 82.22 & 58.78 & 0.70 & 52.47 \\
        \cline{2-9}                                                                                       & multiclass SVM & Uncertainty & 23.86 & 0.17 & 82.18 & 54.29 & 0.12 & 58.26 \\
        \cline{2-9}
        & multiclass GBDT & Uncertainty & 27.76 & 0.67 & 80.15 & 48.59 & 0.76 & 62.58 \\
        \cline{2-9}
        & Enc + MLP & Pseudo Loss & \textbf{13.69} & \textbf{0.44} & \textbf{90.42} & \textbf{27.35} & \textbf{0.41} & \textbf{80.07}  \\     
        % & \multirow{2}{*}{Enc + MLP} & \multirow{2}{*}{Pseudo Loss} & \textbf{13.69} & \textbf{0.44} & \textbf{90.42} & \textbf{27.35} & \textbf{0.41} & \textbf{80.07}  \\
        % &  &  & \textcolor{green}{($\downarrow$ 1.72)} & \textcolor{green}{($\downarrow$ 0.24)} & \textcolor{green}{($\uparrow$ 2.04)} & \textcolor{green}{($\downarrow$ 15.72)} & \textcolor{red}{($\uparrow$ 0.09)} & \textcolor{green}{($\uparrow$ 11.74)} \\
        \cline{2-9}                                                                                       & \cellcolor{gray!20} RF & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} 15.38 & \cellcolor{gray!20} 0.20 & \cellcolor{gray!20} 90.53 & \cellcolor{gray!20} 48.59 & \cellcolor{gray!20} 0.09 & \cellcolor{gray!20} 63.64 \\
        \cline{2-9}                                                                                       &  \cellcolor{gray!20} CatBoost & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} \textbf{11.77} & \cellcolor{gray!20} \textbf{0.26} & \cellcolor{gray!20} \textbf{92.39} & \cellcolor{gray!20} \textbf{26.63} & \cellcolor{gray!20} \textbf{0.13} & \cellcolor{gray!20} \textbf{82.12} \\
        \hline\hline

        \multirow{10}{*}{200}                                                                              & Binary MLP & Uncertainty & 19.71 & 0.39 & 86.97 & 42.57 & 0.34 & 68.47 \\
        \cline{2-9}                                                                                       & Multiclass MLP & Uncertainty & 14.56 & 4.26 & 75.65 & 39.78 & 34.76 & 28.59 \\
        \cline{2-9}                                                                                       & \begin{tabular}[c]{@{}c@{}}Multiclass MLP\\ + Binary SVM\end{tabular} & Uncertainty & 29.46 & 1.98 & 74.09 & 70.32 & 0.93 & 39.51 \\
        \cline{2-9}
        & \multirow{2}{*}{Binary SVM} & Uncertainty & \textbf{14.07} & \textbf{0.86} & \textbf{88.47} & \textbf{40.31} & \textbf{0.37} & \textbf{70.24}  \\
        &  & CADE OOD & 21.68 & 0.67 & 84.50 & 51.32 & 0.78 & 59.11 \\
        \cline{2-9}                                                                                       & multiclass SVM & Uncertainty & 21.19 & 0.21 & 86.90 & 44.77 & 0.13 & 66.55 \\
        \cline{2-9}
        & multiclass GBDT & Uncertainty & 24.71 & 0.56 & 82.71 & 42.97 & 0.80 & 67.28 \\
        \cline{2-9}
        & Enc + MLP & Pseudo Loss & \textbf{9.42} & \textbf{0.48} & \textbf{92.72} & \textbf{27.67} & \textbf{0.39} & \textbf{80.51}  \\
        % & \multirow{2}{*}{Enc + MLP} & \multirow{2}{*}{Pseudo Loss} & \textbf{9.42} & \textbf{0.48} & \textbf{92.72} & \textbf{27.67} & \textbf{0.39} & \textbf{80.51}  \\
        % &  &  & \textcolor{green}{($\downarrow$ 4.65)} & \textcolor{green}{($\downarrow$ 0.38)} & \textcolor{green}{($\uparrow$ 4.25)} & \textcolor{green}{($\downarrow$ 12.64)} & \textcolor{red}{($\uparrow$ 0.02)} & \textcolor{green}{($\uparrow$ 10.27)} \\
        \cline{2-9}                                                                                       & \cellcolor{gray!20} RF & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} 13.44 & \cellcolor{gray!20} 0.19 & \cellcolor{gray!20} 91.76 & \cellcolor{gray!20} 49.45 & \cellcolor{gray!20} 0.90 & \cellcolor{gray!20} 62.74 \\
        \cline{2-9}                                                                                       &  \cellcolor{gray!20} CatBoost & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} \textbf{10.40} & \cellcolor{gray!20} \textbf{0.24} & \cellcolor{gray!20} \textbf{93.27} & \cellcolor{gray!20} \textbf{22.19} & \cellcolor{gray!20} \textbf{0.13} & \cellcolor{gray!20} \textbf{86.06} \\
        \hline\hline

        \multirow{10}{*}{400}                                                                              & Binary MLP & Uncertainty & \textbf{16.04} & \textbf{0.40} & \textbf{89.25} & 36.25 & 0.34 & 73.70 \\
        \cline{2-9}                                                                                       & Multiclass MLP & Uncertainty & 15.07 & 4.15 & 75.94 & 34.48 & 24.44 & 38.34 \\
        \cline{2-9}                                                                                       & \begin{tabular}[c]{@{}c@{}}Multiclass MLP\\ + Binary SVM\end{tabular} & Uncertainty & 28.85 & 1.68 & 75.69 & 73.94 & 1.92 & 33.74 \\
        \cline{2-9}
        & \multirow{2}{*}{Binary SVM} & Uncertainty & 12.86 & 0.90 & 89.02 & 34.73 & 0.43 & 74.12  \\
        &  & CADE OOD & 20.61 & 0.59 & 85.52 & 49.98 & 0.94 & 59.53 \\
        \cline{2-9}                                                                                       & multiclass SVM & Uncertainty & 17.87 & 0.24 & 88.88 & 40.99 & 0.14 & 69.61 \\
        \cline{2-9}
        & multiclass GBDT & Uncertainty & 20.16 & 0.46 & 86.24 & \textbf{33.62} & \textbf{0.38} & \textbf{76.82} \\
        \cline{2-9}
        & Enc + MLP & Pseudo Loss & \textbf{7.84} & \textbf{0.50} & \textbf{93.50} & \textbf{21.49} & \textbf{0.31} & \textbf{85.81}  \\
        % & \multirow{2}{*}{Enc + MLP} & \multirow{2}{*}{Pseudo Loss} & \textbf{7.84} & \textbf{0.50} & \textbf{93.50} & \textbf{21.49} & \textbf{0.31} & \textbf{85.81}  \\
        % &  &  & \textcolor{green}{($\downarrow$ 8.20)} & \textcolor{red}{($\uparrow$ 0.10)} & \textcolor{green}{($\uparrow$ 4.25)} & \textcolor{green}{($\downarrow$ 12.13)} & \textcolor{green}{($\downarrow$ 0.07)} & \textcolor{green}{($\uparrow$ 8.99)} \\
        \cline{2-9}                                                                                       & \cellcolor{gray!20} RF & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} 11.06 & \cellcolor{gray!20} 0.20 & \cellcolor{gray!20} 93.13 & \cellcolor{gray!20} 47.79 & \cellcolor{gray!20} 0.90 & \cellcolor{gray!20} 64.29 \\
        \cline{2-9}                                                                                       &  \cellcolor{gray!20} CatBoost & \cellcolor{gray!20} Uncertainty & \cellcolor{gray!20} \textbf{9.41} & \cellcolor{gray!20} \textbf{0.23} & \cellcolor{gray!20} \textbf{93.87} & \cellcolor{gray!20} 26.60 & \cellcolor{gray!20} 0.10 & \cellcolor{gray!20} 82.16 \\
        \hline
    \end{tabular}
    \vspace{10pt}
    \caption{Performance comparison of different models on APIGraph and AndroZoo datasets.  The unshaded results are from the original paper, while the  shaded results are obtained as part of our benchmarking.}
    \label{tab:chen_dataset_comparison}
\end{table*}
