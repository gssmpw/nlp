\section{Numerical Experiments}
\label{sec:Experiment}

\subsection{Methods for Comparison}
In our experiments, we compared the proposed method (\texttt{Proposed}) using $p_k^{\text{selective}}$ in~(\ref{psel_z}) with the following methods 
% over-conditioning (\texttt{OC}) method, 
% SI for optimal partitioning with over-conditioning~\citep{duy2020computing} (\texttt{OptSeg-SI-oc}), %OC DP
% SI that removed over-conditionning from OptSeg-SI-oc~\citep{duy2020computing} (\texttt{OptSeg-SI}), %Parametric DP
% naive test (\texttt{Naive}) 
% and Bonferroni correction (\texttt{Bonferroni}), 
% The details of these methods for comparison are provided in the Appendix~\ref{app:methods}.
in terms of type I error rate control and power.
\begin{itemize}
  \item \texttt{OC}: In this method, that is, a simple extension of SI literature to our setting, 
  we consider $p$-values with additional conditioning (over-conditioning) described in Appendix~\ref{subsec:over-conditioning}.
  \item \texttt{OptSeg-SI-oc}, \texttt{OptSeg-SI}~\citep{duy2020computing}: 
  These methods use $p$-values conditioned only on the dynamic programming algorithm, disregarding the conditioning on simulated annealing.
  \item \texttt{Naive}: This method is a conventional statistical inference.
  \item \texttt{Bonferroni}: This method applies Bonferroni correction for multiple testing correction.
\end{itemize}
The details of these comparison methods are provided in Appendix~\ref{Detailed_descriptions_of_comparison_methods}.

\subsection{Synthetic Data Experiments}
\label{subsec:Synthetic_Data_Experiments}
\textbf{Experimental setup.}
In all synthetic experiments, we set window size $M \in \{512, 1024\}$, 
the number of frequencies $D = \left\lfloor\frac{M}{2} \right\rfloor + 1$, 
the length of sequence $N = M \cdot T$, where $T$ was specified for each experiment, 
the sampling rate $f_s = 20480$, 
and each element of mean vector $\bm{s}$ as 
\begin{equation}
  s_n = \sum_{d \in \{d_1, d_2, d_3\}} A_n^{(d)} \sin\left(\omega^{(d)}(n-1)\right) ~~~ (1 \leq n \leq N), \notag
\end{equation}
where frequencies $d_1, d_2, d_3 \in \{0, ..., D-1\}$ were randomly selected without replacement for each simulation, %such that $|\{d_1, d_2, d_3\}| = 3$
$A_n^{(d)}$ was defined for each experiment, 
and $\omega^{(d)} \in \left\{2 \pi (\frac{f_s}{M}) d \, \big{|} \, d = 0, \dots, \left\lfloor\frac{M}{2} \right\rfloor\right\}$.
We used BIC for the choice of penalty parameters $\bm{\beta}$ and $\gamma$ as indicated in Appendix~\ref{app:penalty}, 
and set the parameters of simulated annealing as $c_0^+=1000, \lambda^+=1.5, \chi(c_0)=0.5$ and $\lambda=0.8$ in Section~\ref{subsec:SA}. 
After detecting CP candidates, a CP location $\tau_k^{\text{det}}$ randomly selected from $\bm{\tau}^{\text{det}}$ was tested at the significance level $\alpha = 0.05$.

In the experiments conducted to evaluate the control of type I error rate, 
we generated $1000$ null sequences, which did not contain true CPs in the frequency domain, $\bm{x}=(x_1, \dots, x_N)^\top \sim \mathcal{N}\left(\bm{s}, \sigma^2 I_N\right)$, where $A_n^{(d)} = A^{(d)}$ 
was randomly sampled from $\halfopen{0}{1}$ for $d$ in each simulation, 
and $\sigma=1$, for each $T \in \{40, 60, 80, 100\}$.

Regarding the experiments to compare the power, 
we generated sequences $\bm{x}=(x_1, \dots, x_N)^\top \sim \mathcal{N}\left(\bm{s}, \sigma^2 I_N\right)$, 
where
\begin{equation}
  A_n^{(d)} = 
  \begin{cases}
    A^{(d)} & \left(1 \leq t \leq M \cdot t_1^{(d)}\right) \\
    \vspace{-3mm}\\
    A^{(d)} + \Delta & \left(M \cdot t_1^{(d)} + 1 \leq t \leq M \cdot t_2^{(d)}\right) \\
    \vspace{-3mm}\\
    A^{(d)} + 2\Delta & \left(M \cdot t_2^{(d)}+1 \leq t \leq T\right)
  \end{cases}, \notag
\end{equation}
with $A^{(d_1)}, A^{(d_2)}, A^{(d_3)} \in \halfopen{0}{1}$ which were randomly sampled in each simulation, $\left(t_1^{(d_1)}, t_1^{(d_2)}, t_1^{(d_3)}\right) = (18, 20, 22), \left(t_2^{(d_1)}, t_2^{(d_2)}, t_2^{(d_3)}\right) = (38, 40, 42)$, an intensity of the change $\Delta \in \{0.04, 0.08, 0.12, 0.16\}$ and $\sigma=1$, for $T=60$.
In each case, we ran $1000$ trials. 
Since we tested only when a CP candidate location was correctly detected, the power was defined as follows
\begin{equation}
  \text{Power (or Conditional Power)} = \frac{\# \text{ correctly detected \& rejected}}{\# \text{ correctly detected}}. \notag
\end{equation}
We considered the CP candidate location $\tau_k^{\text{det}}$ to be correctly detected if it satisfied the following two conditions:
\vspace{-3mm}
\begin{itemize}
\item The set $\mathcal{D}^{\text{det}}$ of frequencies containing at least one CP candidate was a subset of $\{d_1, d_2, d_3\}$.
\vspace{-2mm}
\item For $\mathcal{D}^{\text{det}}$ satisfying the above condition, either $\underset{d \in \mathcal{D}^{\text{det}}}{\min}{t_1^{(d)}} \leq \tau_k^{\text{det}} \leq \underset{d \in \mathcal{D}^{\text{det}}}{\max} {t_1^{(d)}}$ or $\underset{d \in \mathcal{D}^{\text{det}}}{\min}{t_2^{(d)}} \leq \tau_k^{\text{det}} \leq \underset{d \in \mathcal{D}^{\text{det}}}{\max} {t_2^{(d)}}$ held, 
      that is, $\tau_k^{\text{det}}$ was detected within the true CP locations for the frequencies in $\mathcal{D}^{\text{det}}$.
\end{itemize}
\vspace{-3mm}

\textbf{Experimental results.}
The results of experiments regarding the control of the type I error rate are shown in Figure~\ref{fig_fpr}.
The \texttt{Proposed}, \texttt{OC}, and \texttt{Bonferroni} successfully controlled the type I error rate below the significance level, 
whereas the \texttt{OptSeg-SI}, \texttt{OptSeg-SI-oc}, and \texttt{Naive} could not. 
That was because the \texttt{OptSeg-SI} and \texttt{OptSeg-SI-oc} 
used $p$-values conditioned only on the dynamic programming algorithm, 
excluding the conditioning on simulated annealing,
and the \texttt{Naive} employed conventional $p$-values without conditioning. 
Since the \texttt{OptSeg-SI}, \texttt{OptSeg-SI-oc}, and \texttt{Naive} failed to control the type I error rate, 
we omitted the analysis of their power.
The results of power experiments are shown in Figure~\ref{fig_tpr}. 
Based on these results, the \texttt{Proposed} was the most powerful of all methods that controlled the type I error rate.
The power of the \texttt{OC} was lower than that of the \texttt{Proposed} due to redundant conditions (see Appendix~\ref{app:truncation} for details). %, which caused the loss of power.
Furthermore, the \texttt{Bonferroni} method had the lowest power because it was a highly conservative approach that accounted for the huge number of all possible hypotheses.
Additionally, we provide the computational time of the \texttt{Proposed} in both experiments and the information on the computer resources in Appendix~\ref{Computational_Time}.
% used in the experiments

\begin{figure}[H]
  \centering
  \begin{minipage}[t]{0.45\hsize}
      \centering
      \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_fpr512_skip.pdf}
      \caption*{(a) $M=512$}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.45\hsize}
      \centering
      \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_fpr1024_skip.pdf}
      \caption*{(b) $M=1024$}
  \end{minipage}
  \caption{Type I Error Rate}
  \label{fig_fpr}
\end{figure}
% \vspace{-5mm}
\begin{figure}[H]
  \centering
  \begin{minipage}[t]{0.45\hsize}
      \centering
      \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_tpr512.pdf}
      \caption*{(a) $M=512$}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.45\hsize}
      \centering
      \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_tpr1024.pdf}
      \caption*{(b) $M=1024$}
  \end{minipage}
  \caption{Power}
  \label{fig_tpr}
\end{figure}

\textbf{Robustness of type I error rate control.}
We also conducted the following experiments to investigate the robustness of the \texttt{Proposed} in terms of type I error rate control.
\begin{itemize}
  \item Unknown noise variance: We considered the case where the variance $\sigma^2$ was estimated from the same data. 
  \item Non-Gaussian noise: We also considered the case where the noise followed the five types of standardized non-Gaussian distributions.
  \item Correlated noise: Furthermore, we considered the sequence whose noise was correlated, i.e., the covariance matrix $\Sigma \neq \sigma^2 I_N$. 
        In this case, although the test statistic did not theoretically follow a $\chi$-distribution, 
        we conducted the hypothesis testing using our proposed framework.
\end{itemize}
These details and results are shown in Appendix~\ref{Robustness_of_Type_I_Error_Rate_Control}.

\subsection{Real Data Experiments}
To demonstrate the practical applicability of the \texttt{Proposed}, we applied the \texttt{Proposed}, \texttt{OC}, and \texttt{Naive} to a real-world dataset.
We used the set No.2 of the IMS bearing dataset, 
which is provided by the Center for Intelligent Maintenance Systems (IMS), University of Cincinnati~\citep{qiu2006wavelet} 
and is available from the Prognostic data repository of NASA~\citep{Lee2007bearing}. 
The experimental apparatus consisted of four identical bearings installed on a common shaft, driven at a constant rotation speed by an AC motor under applied radial loading.
In this dataset, the vibration signals were measured using accelerometers until the outer race of bearing~1 failed at the end of the experiment, 
as shown in Figure~\ref{fig_bearing_signals}. 
The analysis for the time signal of bearing~1 in the frequency domain had revealed that anomalies were detected in the harmonics of the characteristic frequency ($236$ Hz) associated with the outer race failure (Ball Pass Frequency Outer race, BPFO) on 3--4~days~\citep{gousseau2016analysis}. 
Based on this previous study, we conducted CP candidate selection for the sensor data of bearing~1 in the frequency domain (1400--4000 Hz) for two periods: 
0.25--2.25~days when no anomalies existed 
and 2.25--4.25~days when the BPFO harmonics exhibited anomalous patterns. 
Subsequently, we tested the detected CP candidate locations to evaluate whether each of them was a genuine anomaly.
Since the signal with 20480 samples per second had been recorded every 10 minutes, 
we computed the DFT of $M = 1024$ consecutive points in the 20480 samples and repeated the procedure $T = 288$ times. %$N = MT$ 
Additionally, the variance $\sigma^2$ was estimated from the data on 0--0.25~days that was not used in all experiments.
The results for the signal of bearing~1 on 0.25--2.25~days and 2.25--4.25~days are shown in Figure~\ref{fig_bearing1}.
In panel~(a), the time variation of a frequency spectrum (1920 Hz) where a CP candidate location was falsely detected is shown for the period of 0.25--2.25~days when the frequency anomaly did not actually exist. 
It shows that $p$-values of the \texttt{Proposed} and \texttt{OC} are above the significance level $0.05$, 
and therefore the result provides the validity of the inference, 
while $p$-value of the \texttt{Naive} is too small. 
In panel~(b), the time variations of the 8th and 15th harmonics of the BPFO where CP candidate locations were correctly detected are presented for the period of 2.25--4.25~days when the frequency anomaly truly existed.
In this case, $p$-values of the \texttt{Proposed} are below the significance level $\frac{0.05}{2} = 0.025$ decided by Bonferroni correction,
thus it indicates that the inference is valid. 
In contrast, $p$-values of the \texttt{OC} are too large, 
due to the loss of power caused by the redundant conditions. 
In addition, since even the time sequences of the healthy bearings~2, 3, and 4 had been reported to indicate frequency characteristics associated with the outer race fault in bearing~1~\citep{gousseau2016analysis}, 
we performed the same analysis for the three signals.
The results are shown in Appendix~\ref{More_Results_on_Real_Data_Experiment}.
% Ë®òËºâ„Åó„Åü ùëù ÂÄ§„ÅØ, „Åù„ÅÆÂë®Ëæ∫„ÅÆÂë®Ê≥¢Êï∞ÊàêÂàÜ„ÇÑ, 15, 16 Ê¨°‰ª•Â§ñ„ÅÆÈ´òË™øÊ≥¢„ÅÆÂ§âÂåñÁÇπ„ÇÇËÄÉÊÖÆ„Åó„ÅüÂÄ§„Å®„Å™„Å£„Å¶„ÅÑ„Çã„Åì„Å®„Å´Ê≥®ÊÑè„Åï„Çå„Åü„ÅÑ.

\begin{figure}[t]
  \centering
  \begin{minipage}[t]{0.24\hsize}
      \centering
      \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing1.pdf}
      \captionsetup{justification=centering}
      \caption*{(a) Bearing 1}
  \end{minipage}
  \begin{minipage}[t]{0.24\hsize}
    \centering
    \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing2.pdf}
    \captionsetup{justification=centering}
    \caption*{(b) Bearing 2}
  \end{minipage}
  \begin{minipage}[t]{0.24\hsize}
    \centering
    \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing3.pdf}
    \captionsetup{justification=centering}
    \caption*{(c) Bearing 3}
  \end{minipage}
  \begin{minipage}[t]{0.24\hsize}
    \centering
    \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing4.pdf}
    \captionsetup{justification=centering}
    \caption*{(d) Bearing 4}
  \end{minipage}
  \caption{Vibration signals of the four bearings.}
  \label{fig_bearing_signals}
\end{figure}

\begin{figure}[t]
  \centering
  \begin{minipage}[t]{0.4\hsize}
    \centering
    \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing1_fpr.pdf}
    \caption*{(a) Inference on a falsely detected CP candidate location for 1920 Hz (around the 8th harmonic) on 0.25--2.25 days}
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.4\hsize}
    \centering
    \includegraphics[width=0.95\textwidth]{figure/exp/tmlr2025_bearing1_tpr.pdf}
    \caption*{(b) Inferences on truely detected CP candidate locations for 1880 Hz (the 8th harmonic, above) and 3540 Hz (the 15th harmonic, below) on 2.25--4.25~days}
  \end{minipage}
  \caption{Results of the CP candidate selection for the signal of bearing~1 in the frequency domain and the subsequent inference for the detected CP candidate locations.
  In panel (b), note that $p$-values for the first CP candidate location were actually computed by considering not only a CP candidate of the 15th harmonic but also a CP candidate of 1900 Hz (around the 8th harmonic).}
  \label{fig_bearing1}
\end{figure}
