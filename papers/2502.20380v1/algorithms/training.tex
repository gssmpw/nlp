% \begin{algorithm}[tb]
%    \caption{\method: Training}
%    \label{algo:pseudo_training_mucode}
% \begin{algorithmic}[1]
% \INPUT Initial generator $\pi_0$, multi-turn code environment $\mathcal{E}$\\
% \FOR{iteration i = 1, \dots, N}
%     \STATE Rollout generator $\pi_\theta$ in multi-turn environment $\mathcal{E}$  \\ 
%     to collect datapoints $\mathcal{D}_i\leftarrow\{(x,s_t,y_t, o_t))\}$
%     \STATE Aggregate data $\mathcal{D} \gets \mathcal{D} \cup \mathcal{D}_i$
%     \STATE Train a verifier $\phi \gets R_{\phi}(x,y)$ trained on $\mathcal{D}$
%     \STATE Construct a local search expert using verifier \\ $\pi^\star(x) = \arg\max_{y \in \mathcal{D}(x)} R_\phi(x,y)$
%     \STATE Relabel data $\mathcal{D}$ with $\pi^\star(x)$
%     \STATE Train $\theta \gets \pi_\theta$ with fine-tuning~(FT) on $\mathcal{D}$
% \ENDFOR
% \OUTPUT Best generator $\pi_\theta $ and verifier $R_{\phi}$
% \end{algorithmic}
% \end{algorithm}

\begin{algorithm}[tb]
   \caption{\method: Training}
   \label{algo:pseudo_training_mucode}
\begin{algorithmic}[1]
\INPUT Initial generator $\pi_0$, multi-turn code environment $\mathcal{E}$, and max iterations M\\
\FOR{iteration i = 1 \dots M}
    \STATE Rollout generator $\pi_\theta$ in multi-turn environment $\mathcal{E}$  \\ 
    to collect datapoints $\mathcal{D}_i\leftarrow\{(x,s_t,y_t, o_t))\}$
    \STATE Aggregate data $\mathcal{D} \gets \mathcal{D} \cup \mathcal{D}_i$
    \STATE Train a verifier $R_{\phi}^i(x,y)$ on $\mathcal{D}$
    \STATE Construct a local search expert using verifier \\ $\pi_\star^i(x) = \arg\max_{y \in \mathcal{D}(x)} R_\phi^i(x,y)$
    \STATE Relabel data $\mathcal{D}$ with $\pi_\star^i(x)$ to get $\mathcal{D}_\star^i$
    \STATE Train $\pi_\theta^i$ with fine-tuning~(FT) on $\mathcal{D}_\star^i$
\ENDFOR
\OUTPUT Best generator $\pi_\theta $ and verifier $R_{\phi}$
\end{algorithmic}
\end{algorithm}