\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	\node[] (real) at (0,0)  {
		\textbf{Challenger}
	};
	\node[] (code-r) [below = 0.1cm of real] {
		\begin{minipage}{0.32\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble]{coq}
@$ $@
(@$sk$@,@$pk$@) @$\leftarrow$@
@$\Sigma.$@KeyGen()

@$\sig_1$@ @$\leftarrow$@
@$\Sigma.$@Sign(@$sk$@,@$\msg_1$@)



@$\sig_n$@ @$\leftarrow$@
@$\Sigma.$@Sign(@$sk$@,@$\msg_n$@)



@$b$@ @$\leftarrow$@
@$\Sigma.$@VerSig(@$pk$@,@$\sig_{\mathcal{A}}$@,@$\msg_{\mathcal{A}}$@)
			\end{minted}
		\end{minipage}
	};

	% Package frame and stuff
	%\draw[] (code-r.north west) |- (real.north) -| (code-r.north east);
	%\draw[] (code-r.north west) |- (real.south) -| (code-r.north east);
	%\draw[] (code-r.north east) |- (code-r.south) -| (code-r.north west);


	%%%%%%%% Ideal %%%%%%%%%%%%
	%%%%%%%%%%%%%%%%%%%%%%%%%%%

	\node[] (ideal) [right = 1.8 cm of real]  {
		\textbf{Adversary} $\mathcal{A}$
	};
	\node[] (code-i) [below = 0cm of ideal] {
		\begin{minipage}{0.32\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble,stripnl=false]{coq}
@$S$@ @$\leftarrow$@ @$\emptyset$@

@$\msg_1$@ @$\leftarrow$@ gen

analyze @$\sig_1$@
@$S$@ @$\leftarrow$@ @$S$@ @$\cup$@ @$\{(\msg_1,\sig_1)\}$@


@$\msg_n$@ @$\leftarrow$@ gen

analyze @$s_n$@
@$S$@ @$\leftarrow$@ @$S$@ @$\cup$@ @$\{(\msg_n,\sig_n)\}$@

(@$\msg_{\mathcal{A}},\sig_{\mathcal{A}}$@) @$\leftarrow$@ forge
assert @$(\msg_{\mathcal{A}},\sig_{\mathcal{A}}) \notin S$@




@$b$@ = true @$\Rightarrow$@ @ðŸ†@
			\end{minted}
		\end{minipage}
	};

	% Package frame and stuff
	%\draw[] (code-i.north west) |- (ideal.north) -| (code-i.north east);
	%\draw[] (code-i.north west) |- (ideal.south) -| (code-i.north east);
	%\draw[] (code-i.north east) |- (code-i.south) -| (code-i.north west);
	
	% Dots
	\node[] (dots1) [below left = 1.9cm and -0.4cm of ideal]  {\vdots};
	
	% Arrows 
	\draw[draw=lBlue, thick,->] ([xshift=0.1cm,yshift=-0.85cm]real.east) -- node[above]{$pk$}     ([xshift=1.2cm,yshift=-0.85cm]real.east);

	\draw[draw=lBlue, thick,<-] ([xshift=0.1cm,yshift=-1.4cm]real.east)  -- node[above]{$\msg_1$} ([xshift=1.2cm,yshift=-1.4cm]real.east);
    \draw[draw=lBlue, thick,->] ([xshift=0.1cm,yshift=-1.6cm]real.east)  -- node[below]{$\sig_1$} ([xshift=1.2cm,yshift=-1.6cm]real.east);
	
    \draw[draw=lBlue, thick,<-] ([xshift=0.1cm,yshift=-3.3cm]real.east)  -- node[above]{$\msg_n$} ([xshift=1.2cm,yshift=-3.3cm]real.east);
    \draw[draw=lBlue, thick,->] ([xshift=0.1cm,yshift=-3.5cm]real.east)  -- node[below]{$\sig_n$} ([xshift=1.2cm,yshift=-3.5cm]real.east);

	\draw[draw=lBlue, thick,<-] ([xshift=0.1cm,yshift=-4.85cm]real.east)  -- node[above]{$\msg_{\mathcal{A}},\sig_{\mathcal{A}}$} ([xshift=1.2cm,yshift=-4.85cm]real.east);
	\draw[draw=lBlue, thick,->] ([xshift=0.1cm,yshift=-6cm]real.east)  -- node[below]{$b$} ([xshift=1.2cm,yshift=-6cm]real.east);

	\node[] (adv) [below right = 6cm and 1cm of real]  {
		\textcolor{white}{empty-line}
	};

\end{tikzpicture}






