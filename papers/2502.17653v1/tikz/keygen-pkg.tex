\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	\node[] (P) at (0,0)  {
		\pkeygen
	};
	\node[] (c) [below = 0.5cm of P] {
		\begin{minipage}{0.5\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble]{coq}
def key_gen ():
				  
  (sk,pk) <- &$\Sigma$&.KeyGen tt ;;
  #put @&$\mathcal{SK}$& sk ;;
  #put @&$\mathcal{PK}$& pk ;;

  #ret (sk,pk)
			\end{minted}
		\end{minipage}
	};
	\node[] (s) [above right = 0cm and 0cm of c.north west] {
    \begin{minipage}{0.65\columnwidth}
		\begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble]{coq}
      &$\mathcal{SK}$& : SecKey, &$\mathcal{PK}$& : PubKey
    \end{minted}
    \end{minipage}
	};

%%%%%%%% exports %%%%%%%
    \draw[->] 
    ([xshift=0.2cm,yshift=-0cm]c.east) -- 
    ([xshift=1.8cm,yshift=-0cm]c.east)
        node[midway,above]{ \mintinline{Coq}{key_gen} };


	% Package frame and stuff
	\draw[] (c.north west) -- (c.north east);
	\draw[] (c.north west) |- (s.north) -| (c.north east);
	\draw[] (s.north west) |- (P.north) -| (c.north east);
	\draw[] (c.north east) |- (c.south) -| (c.north west);

\end{tikzpicture}
