\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	\node[] (real) at (0,0)  {
		$\mathcal{G}_{\text{\real}}^{\Sigma}$
	};
	\node[] (code-r) [below = 0cm of real] {
		\begin{minipage}{0.425\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble]{coq}
@\textcolor{white}{empty line}@
(@$sk$@,@$pk$@) @$\leftarrow$@ @$\Sigma.$@KeyGen()

get_pk()
  return @$pk$@

sign(@$m$@)
  @$\sig\;:=\;$@ @$\Sigma.$@Sign(@$sk,\msg$@)
  
  return @$\sig$@

ver_sig(@$\msg,\sig$@)
@$b:=$@ @$\Sigma.$@VerSig(@$pk,\msg,\sig$@)
  return @$b$@
			\end{minted}
		\end{minipage}
	};

	
	% Package frame and stuff
	\draw[] (code-r.north west) |- (real.north)   -| (code-r.north east);
	\draw[] (code-r.north west) |- (real.south)   -| (code-r.north east);
	\draw[] (code-r.north east) |- (code-r.south) -| (code-r.north west);
	
	
	%%%%%%%% Ideal %%%%%%%%%%%%
	%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
	\node[] (ideal) [right = 2.4cm of real]  {
		$\mathcal{G}_{\text{\ideal}}^{\Sigma}$
	};
	\node[] (code-i) [below = 0cm of ideal] {
		\begin{minipage}{0.425\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble,stripnl=false,highlightlines={1,9,13},highlightcolor=lYellow!20]{coq}
@$S\;=\emptyset$@
(@$sk$@,@$pk$@) @$\leftarrow$@ @$\Sigma.$@KeyGen()

get_pk()
  return @$pk$@

sign(@$m$@)
  @$\sig\;:=\;$@ @$\Sigma.$@Sign(@$sk,\msg$@)
  @$S\;:=\;S\;\cup\;(\msg,\sig)$@
  return @$\sig$@

ver_sig(@$\msg,\sig$@)
  @$b:=$@ (@$\msg,\sig$@) @$\in$@ @$S$@
  return @$b$@
			\end{minted}
		\end{minipage}
	};

	
	% Package frame and stuff
	\draw[] (code-i.north west) |- (ideal.north)  -| (code-i.north east);
	\draw[] (code-i.north west) |- (ideal.south)  -| (code-i.north east);
	\draw[] (code-i.north east) |- (code-i.south) -| (code-i.north west);


	% Adversary 
	\node[] (adv) [below right = 6cm and 1cm of real]  {
		$\mathcal{A}$ 
	};

	\draw[->] (adv.north) -- ([yshift=0.2cm]adv.north) -| ([xshift=-1.4cm,yshift=0.2cm]adv.north) -| ([yshift=-0.1cm]code-r.south);
	\draw[->] (adv.north) -- ([yshift=0.2cm]adv.north) -| ([xshift=1.4cm,yshift=0.2cm]adv.north) -| ([yshift=-0.1cm]code-i.south);


	\node[] (win) [above = 0.4cm of adv]  {
		 real\hspace{0.7cm}ğŸ†\hspace{0.6cm}ideal
	};



\end{tikzpicture}







