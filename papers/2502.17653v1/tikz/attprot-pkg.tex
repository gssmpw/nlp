\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	\node[] (P) at (0,0)  {
        Att\pprot$^\prime$
	};
	\node[] (c) [below = 0.5cm of P] {
		\begin{minipage}{0.4\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble]{coq}
def prot (c):
  #import key_gen ;;
  #import attest ;;
  #import verify&$^a$& ;;

  pk <- get_pk tt ;;
  s <- attest c ;;
  b <- verify&$^a$& s c ;;

  #ret (pk,s,b)
			\end{minted}
		\end{minipage}
	};
	\node[] (s) [above right = 0cm and 0cm of c.north west] {
        \begin{minipage}{0.45\columnwidth}
            \begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble]{coq}
				  &$\{ \}$&
			\end{minted}
		\end{minipage}
	};

%%%%%%%% imports %%%%%%%
	\draw[->] 
    ([xshift=-1.8cm,yshift=-0.7cm]c.north west) -- 
    ([xshift=-0.2cm,yshift=-0.7cm]c.north west)
	    node[midway,above] { \mintinline{Coq}{get_pk} };
	
	\draw[->] 
    ([xshift=-1.8cm,yshift=-0.2cm]c.west) -- 
    ([xshift=-0.2cm,yshift=-0.2cm]c.west)
        node[midway,above] { \mintinline{Coq}{attest} };

	\draw[->] 
    ([xshift=-1.8cm,yshift=0.2cm]c.south west) -- 
    ([xshift=-0.2cm,yshift=0.2cm]c.south west)
        node[midway,above]{ \mintinline{Coq}{verify}$^a$ };
	
%%%%%%%% exports %%%%%%%
    \draw[->] 
    ([xshift=0.2cm,yshift=-0.2cm]c.east) -- 
    ([xshift=1.8cm,yshift=-0.2cm]c.east)
        node[midway,above]{ \mintinline{Coq}{prot} };

	% Package frame and stuff
	\draw[] (c.north west) -- (c.north east);
	\draw[] (c.north west) |- (s.north) -| (c.north east);
	\draw[] (s.north west) |- (P.north) -| (c.north east);
	\draw[] (c.north east) |- (c.south) -| (c.north west);

\end{tikzpicture}
