\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	%%%%% Key Gen %%%%%
	\node[] (KG) at (0,0)  {
		$\mathcal{KG}$
	};
	\node[] (c) [below = 0cm of KG] {
		\begin{minipage}{0.25\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble]{coq}
key_gen()
  ...
  #ret (sk,pk)
			\end{minted}
		\end{minipage}
	};

	\draw[->] ([xshift=0.2cm,yshift=0.1cm]c.east) -- ([xshift=1.4cm,yshift=0.1cm]c.east);
	\node[] (Y) [above right = 0.1cm and 0.05cm of c.east] {
		\mintinline{Coq}{key_gen}
	};
	
	% Package frame and stuff
	\draw[] (c.north west) |- (KG.north) -| (c.north east);
	\draw[] (c.north west) |- (KG.south) -| (c.north east);
	\draw[] (c.north east) |- (c.south) -| (c.north west);
	
	%%%%% Sig Package %%%%%
	\node[] (Sig) [above right = 1cm and 3.1cm of KG]  {
		$\mathcal{S}ignature$
	};
	\node[] (code) [below = 0cm of Sig] {
		\begin{minipage}{0.3\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble]{coq}
key_pk()
  import key_gen
  ...
  #ret (sk,pk)
  
sign()
  ...
  #ret s

verify()
  ...
  #ret bool
			\end{minted}
		\end{minipage}
	};
	
	\draw[->] ([xshift=0.2cm,yshift=1.5cm]code.east) -- ([xshift=1.4cm,yshift=1.5cm]code.east);
	\node[] (Y) [above right = 1.5cm and 0.15cm of code.east] {
		\mintinline{Coq}{get_pk}
	};
	\draw[->] ([xshift=0.2cm]code.east) -- ([xshift=1.4cm]code.east);
	\node[] (Y) [above right = 0cm and 0.15cm of code.east] {
		\mintinline{Coq}{sign}
	};
	\draw[->] ([xshift=0.2cm,yshift=-1.5cm]code.east) -- ([xshift=1.4cm,yshift=-1.5cm]code.east);
	\node[] (Y) [above right = -1.5cm and 0.15cm of code.east] {
		\mintinline{Coq}{verify}
	};
	
	% Package frame and stuff
	\draw[] (code.north west) |- (Sig.north) -| (code.north east);
	\draw[] (code.north west) |- (Sig.south) -| (code.north east);
	\draw[] (code.north east) |- (code.south) -| (code.north west);
	
\end{tikzpicture}
