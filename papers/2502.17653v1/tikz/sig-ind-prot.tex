\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	\node[] (real) at (0,0)  {
        $\mathcal{P}_{\phantom{\text{\ideal}}}^{\phantom{\Sigma}}$
%		$\mathcal{G}_{\text{sig-prot}}^{\Sigma}$
	};
	\node[] (code-r) [below = 0cm of real] {
		\begin{minipage}{0.85\columnwidth}
			\begin{minted}[fontsize=\footnotesize,escapeinside=@@,autogobble]{coq}
@$\phantom{X}$@
@$\phantom{X}$@
prot(@$\msg$@)
  @$pk$@ @$\leftarrow$@ get_pk()
  @$\sig$@ @$\leftarrow$@ sign(@$\msg$@)
  @$b$@ @$\leftarrow$@
  ver_sig(@$pk,\sig,\msg$@)
  return (@$pk,\sig,b$@)
@$\phantom{X}$@
@$\phantom{X}$@
@$\phantom{X}$@
           \end{minted}
		\end{minipage}
	};

	% Package frame and stuff
	\draw[] 
    (code-r.north west) |- 
    (real.north) -| 
    (code-r.north east);
	\draw[] 
    (code-r.north west) |- 
    (real.south) -| 
    (code-r.north east);
	\draw[] 
    (code-r.north east) |- 
    (code-r.south) -| 
    (code-r.north west);

	% Arrows
    \draw[draw=lBlue, thick,<-] 
    ([xshift=0.05cm,yshift=-0.7cm]real.east) -- 
    node[above]{$m$} 
    ([xshift=1.05cm,yshift=-0.7cm]real.east);

    \draw[draw=lBlue, thick, ->] 
    ([xshift=0.05cm,yshift=-3.6cm]real.east) -- 
    node[above]{($pk$, $\sig$, $b$)}   
    ([xshift=1.05cm,yshift=-3.6cm]real.east);

    \node[draw] (comp1) [below left = 4cm and -0.3cm  of real] {
        $\mathcal{P} \circ \mathcal{G}_{\text{\real}}^{\Sigma}$
    };

    \node[draw] (comp2) [below right = 4cm and -0.3cm of real] {
       $\mathcal{P} \circ \mathcal{G}_{\text{\ideal}}^{\Sigma}$
    };

	% Adversary 
	\node[] (adv) [below = 6cm of real]  {
		$\mathcal{A}$ 
	};

	\draw[->] 
    (adv.north) -- 
    ([yshift=0.2cm]adv.north) -| 
    ([xshift=0.3cm,yshift=-0.1cm]comp1.south);
	
    \draw[->] 
    (adv.north) -- 
    ([yshift=0.2cm]adv.north) -| 
    ([xshift=-0.3cm,yshift=-0.1cm]comp2.south);

	\node[] (win) [above = 0.4cm of adv]  {
		 real\hspace{0.8cm}üèÜ\hspace{0.7cm}ideal
	};


\end{tikzpicture}







