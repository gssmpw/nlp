\begin{tikzpicture}[
	font=\footnotesize,
	node distance=0.3cm
	]
	%		\draw[rounded corners,thick] (0, 0) rectangle (1,3) { bla };
	\node[] (P) at (0,0)  {
		 AttPrim
	};
	\node[] (c) [below = 0.5cm of P] {
		\begin{minipage}{0.52\columnwidth}
            \begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble,highlightlines={8,9,15,16},highlightcolor=lYellow!20]{coq}
get_pk&$^a$&()
  #import get_pk ;;
  pk <- get_pk ;;
  #ret pk
  
attest(c)
  #import sign;;
  s <- #get @&$\mathcal{ST}$&
  #let m := &$\mathcal{H}$& s c ;;
  a <- sign m ;;
  #ret (a,m)

verify&$^a$&(c,a)
  #import verify ;;
  s <- #get @&$\mathcal{ST}$& ;;
  #let m := &$\mathcal{H}$& s c ;;
  #ret verify a m
			\end{minted}
		\end{minipage}
	};
	\node[] (s) [above right = 0cm and 0cm of c.north west] {
		\begin{minipage}{0.45\columnwidth}
            \begin{minted}[fontsize=\footnotesize,escapeinside=&&,autogobble]{coq}
	&$\mathcal{ST}$&: State
			\end{minted}
		\end{minipage}
	};

%%%%%%%% imports %%%%%%%
	\draw[->] ([xshift=-1.8cm,yshift=-1cm]c.north west) -- ([xshift=-0.2cm,yshift=-1cm]c.north west)
	    node[midway,above] { \mintinline{Coq}{get_pk} };
	
	\draw[->] ([xshift=-1.8cm,yshift=3cm]c.south west) -- ([xshift=-0.2cm,yshift=3cm]c.south west)
        node[midway,above] { \mintinline{Coq}{sign} };

	\draw[->] ([xshift=-1.8cm,yshift=1cm]c.south west) -- ([xshift=-0.2cm,yshift=1cm]c.south west)
        node[midway,above]{ \mintinline{Coq}{verify} };
	
%%%%%%%% exports %%%%%%%
    \draw[->] ([xshift=0.2cm,yshift=-1cm]c.north east) -- ([xshift=1.8cm,yshift=-1cm]c.north east)
        node[midway,above]{ \mintinline{Coq}{get_pk}$^a$ };

    \draw[->] ([xshift=0.2cm,yshift=3cm]c.south east) -- ([xshift=1.8cm,yshift=3cm]c.south east)
        node[midway,above]{ \mintinline{Coq}{attest} };

    \draw[->] ([xshift=0.2cm,yshift=1cm]c.south east) -- ([xshift=1.8cm,yshift=1cm]c.south east)
        node[midway,above]{ \mintinline{Coq}{verify}$^a$ };
	
	% Package frame and stuff
	\draw[] (c.north west) -- (c.north east);
	\draw[] (c.north west) |- (s.north) -| (c.north east);
	\draw[] (s.north west) |- (P.north) -| (c.north east);
	\draw[] (c.north east) |- (c.south) -| (c.north west);
	
\end{tikzpicture}
