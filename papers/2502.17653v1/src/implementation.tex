\section{Implementation}
\label{sec:implement}

%
Our formalization was implemented by a novice user outside the \ssprove community, 
demonstrating the accessibility and usability of the \coq
with \ssprove and the mathematical componenents library MathComp~\cite{mahboubi2021mathematical} for cryptographic formalization.
%
The formal development consists of several components of reasonings, 
each contributing to different parts of our formalization. 
%
%
\begin{table}[b]
    \centering  
    %\begin{minipage}  
    \begin{tabular}{ ||c|c||}
        \hline 
        %\rowcolor{lightgray} Files & Lines of Code \\[0.5ex] 
        \textbf{Reasonings} & \textbf{Lines of Code} \\[0.5ex] 
        \hline
        Signature & 296 \\
        SigProt & 327 \\
        RA & 263 \\
        AttProt & 1470 \\ 
        \hline
        \rowcolor{lightgray} Total & 2356 \\ [1ex] 
        \hline
    \end{tabular}
    \caption{Lines of code for each component}\label{fig:LOC}
    %\end{minipage}
    \end{table}
%
%
Table~\ref{fig:LOC} overviews these components, including 
their respective line counts to show our effort estimate.
%
Our formal development shows that we invested some time in understanding 
the \coq environment and the \ssprove framework for a generalized proof structure.
%
Our efforts highlight \ssprove's modularity and clarity, allowing new users to define, 
verify effectively, and reason about security protocols. 
%

While working with the \ssprove library in the \coq, we explored the 
\emph{swap} tactic, which enables 
reordering operations in probabilistic programsâ€”a key component 
of reasoning in game-based cryptographic proofs.
%
\ssprove only supports \emph{swap}ing pure commands in procedure.
%
We added a more general lemma that allows to swap stateful 
commands for as long as they do not reference the same 
location, i.e., state, contributing it back to the library 
to strengthen its capabilities.
%
We also made several smaller contributions, enhancing the 
library's functionality and clarity.
%
Amongst others, we updated it to the latest version of MathComp.
%
We hope these additions will support and ease the work 
of researchers engaging with \ssprove in the future. 
%

%
The only gap in our development is due to a composition
gap in \ssprove.
%
Our Hypothesis for the functional correctness of the
digitial signature schema $\Sigma$ (Figure~\ref{fig:sigprim:hypo})
has a monadic precondition, i.e., the call to $\Sigma$.\icoq{KeyGen}.
%
This call needs to be monadic because it needs to sample.
%
See our RSA implementation in Section~\ref{sec:rsa} for 
the details.
%
Instantiating this precondition in the indistinguishability 
proof for Theorem~\ref{theo:indist-signature} was not
possible.
%
This is due to the monadic construction that underpins
the relational Hoare Logic in \ssprove.
%
Adding support for such instantiations of facts
is an interesting topic for future research.
%
