\section{Appendix}
\label{sec:appendix}
\subsection{Hyperparameters}
The RSSM is configured as in DreamerV3~\cite{hafner2023mastering}, whereas the parameters related to the world model have been adjusted for the S5WM.
\label{sec:hyperparams}
\input{figures/state_params}
\input{figures/model_params_state}
\input{figures/vision_params}
\input{figures/model_params_vision}
\newpage

\subsection{Imagination Prediction}
\label{sec:imag_state}
\input{figures/imag_state}

\subsection{Reward components}
\label{sec:rewards}
\begin{enumerate}\renewcommand{\labelenumi}{\roman{enumi}.} 
    \item \textit{Progress Reward}: Encourages the drone to progress along the track as fast as possible,
    \begin{equation}
    r_{\text{prog}} = \lambda_1 (d_{t-1} - d_t),
    \end{equation}
    where $d_t$ is the distance from the position at time $t$ to the next gate, and $\lambda_1=1$.

    \item \textit{Omega Penalty}: Penalizes large angular velocities,
    \begin{equation}
    r_{\text{omega}} = \lambda_2 \left(\frac{\| \omega \|}{\| \omega_{\text{max}} \|}\right)^2,
    \end{equation}
    where $\omega$ is the angular velocity, $\omega_{\text{max}}$ is the maximum angular velocity, and $\lambda_2=-0.05$.

    \item \textit{Command Omega Penalty}: Penalizes large desired angular velocity values (actions),
    \begin{equation}
    r_{\text{cmd}} = \lambda_3 \left(\frac{\| \omega_{\text{des}} \|}{\| \omega_{\text{max}} \|}\right)^2,
    \end{equation}
    where $\omega_{des}$ is the desired angular velocity command, $\omega_{\text{max}}$ is the maximum angular velocity, and $\lambda_3=-0.025$.

    \item \textit{Command Difference Penalty}: Penalizes abrupt changes between consecutive actions to encourage smooth signals,
    \begin{equation}
    r_{\Delta\text{cmd}} = \lambda_4 \left(\frac{\| \Delta a_t \|}{\|a_{\text{max}}\|} \right)^2,
    \end{equation}
    where $\Delta a_t = a_t - a_{t-1}$, $a_t \in \mathbb{R}^4$ is the control action at time $t$, $a_{\text{max}}$ is the maximum control action, and $\lambda_4=-0.05$.

    \item \textit{Crash Penalty}: Terminal reward that penalizes collisions with the gates,
    \begin{equation}
    r_{\text{crash}} = -4.
    \end{equation}

    \item \textit{Passing Reward}: Encourages the drone to pass through the gate successfully,
    \begin{equation}
    r_{\text{pass}} = 10.
    \end{equation}

\end{enumerate}

\subsection{S5 Sequence Layer}
\label{sec:s5block}
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\columnwidth, trim=0 0 0 0, clip]{figures/s5_block.drawio.pdf}
    \caption{Schematic representation of the S5 sequence layer, composed of the resettable S5 SSM described in~\ref{sec:s5wm}, nonlinearities, and gating operations.}
    \label{fig:reconstruction}
\end{figure}
For the Gated Linear Unit~(GLU), we use a specific gating function, defined as \textit{half GLU}, which maps its input $u$ to the output $y$ as follows,
\begin{align}
x_1 = GELU(u) \\
y = u \cdot \sigma(W^T x_1)
\end{align}
where $W$ represents the weights of a linear layer, $GELU$ is a standard Gaussian Error Linear Unit, and $\sigma$ is the sigmoid function.


\newpage

\subsection{Trajectories}
\label{sec:appendix_trajectories}
\begin{figure}[htp]
    \centering
    \begin{minipage}{0.3\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=30 10 60 0, clip]{figures/sim_baselines/sim_8460000_20250127-132928.pdf}
    \end{minipage}%
    \begin{minipage}{0.3\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=30 10 60 0, clip]{figures/sim_baselines/sim_9660000_20250129-234143.pdf}
    \end{minipage}%
    \begin{minipage}{0.35\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=30 10 0 0, clip]{figures/sim_baselines/sim_8000_20250129-235103.pdf}
    \end{minipage}%
    \label{fig:real_splits}
\end{figure}
\begin{figure}[h]
    \begin{minipage}{0.95\textwidth}
    \caption{\textit{State-based Split-S task:} Comparison for S5WM, with baselines: DreamerV3 and PPO.}
    \end{minipage}
\end{figure}
\begin{figure}[htp]
    \centering
    \begin{minipage}{0.3\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=20 10 60 0, clip]{figures/sim_baselines/sim_8460000_20250129-162934.pdf}
    \end{minipage}%
    \begin{minipage}{0.3\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=20 10 60 0, clip]{figures/sim_baselines/sim_5260000_20250130-010027.pdf}
    \end{minipage}%
    \begin{minipage}{0.35\textwidth}
        \centering
        \includegraphics[width=\linewidth, trim=20 10 0 0, clip]{figures/sim_baselines/traj_02500.pdf}
    \end{minipage}%
\end{figure}
\vspace{-3em}
\begin{figure}[h]
    \label{fig:real_fig8}
    \begin{minipage}{0.95\textwidth}
    \caption{\textit{Vision-based Figure-8 task:} Comparison for S5WM (privileged), with baselines: DreamerV3 (privileged) and PPO (asymmetric). The asymmetric PPO crashes after the first lap and does not learn to consistently fly through the track.}
    \end{minipage}
\end{figure}
\newpage
