\tikzstyle{my-box}=[
	rectangle,
	draw=black, % hidden-draw,
	rounded corners,
	text opacity=1,
	minimum height=1.5em,
	minimum width=5em,
	inner sep=2pt,
	align=center,
	fill opacity=.5,
	line width=0.8pt,
]
\tikzstyle{leaf}=[my-box, minimum height=1.5em,
	text=black, align=left,font=\normalsize,
	inner xsep=2pt,
	inner ysep=4pt,
	line width=0.8pt,
]


\begin{figure*}[t]
	\centering
	\resizebox{\textwidth}{!}{
		\begin{forest}
			forked edges,
			for tree={
				grow=east,
				reversed=true,
				anchor=base west,
				parent anchor=east,
				child anchor=west,
				base=center,
				font=\large,
				rectangle,
				draw=black, % hidden-draw,
				rounded corners,
				align=left,
				text centered,
				minimum width=4em,
				edge+={darkgray, line width=1pt},
				s sep=3pt,
				inner xsep=2pt,
				inner ysep=3pt,
				line width=0.8pt,
				ver/.style={rotate=90, child anchor=north, parent anchor=south, anchor=center, minimum width=19em, fill=gray!10},
			},
			where level=1{text width=14em,font=\normalsize,fill=green!10}{},
			where level=2{text width=10.5em, align=left, font=\normalsize, fill=orange!10}{},
			where level=3{text width=38.5em}{},
			where level=4{text width=18em,font=\normalsize,}{},
			where level=5{text width=18em,font=\normalsize,}{},
			[
				\textbf{KV Cache Optimization}, ver
				[
                        \textbf{Token Dropping~(\S\ref{sec3_1})}
                        [
                            \textbf{Static Methods}
                            [
                                \quad LM-Infinite~\citep{han2024lm}{,}StreamingLLM~\citep{xiaoefficient},leaf
                            ]
                        ]
                        [
                            \textbf{Dynamic Methods}
                            [
                                \quad H2O~\citep{zhang2023h2o}{,} Scissorhands~\citep{liu2024scissorhands}{,} \\ \quad FastGen~\citep{ge2023model}{,} TOVA~\citep{oren2024transformers}{,} SnapKV~\citep{li2024snapkv}{,} \\ \quad RazorAttention~\citep{tang2024razorattention}{,} DuoAttention~\citep{xiao2024duoattention}{,} \\ \quad PyramidKV~\citep{cai2024pyramidkv}{,} PyramidInfer~\citep{yang2024pyramidinfer}{,} \\ \quad DCP~\citep{anagnostidis2024dynamic}{,} Locret~\citep{huang2024locret}{,} \\ \quad SirLLM~\citep{yao2024sirllm}{,} VPM~\citep{guo2024attention}{,} InfiniPot~\citep{guo2024attention}, leaf
                            ]
                        ]
                    ]
                    [
                        \textbf{Token Merging~(\S\ref{sec3_2})}
                        [
                            \quad Sentinel Tokens~\citep{ren2023context}{,} Activation Beacon~\citep{zhang2024long}{,} AnchorLLM~\citep{pang2024anchor}{,} \\ \quad DMC~\citep{nawrot2024dynamic}{,} CaM~\citep{zhangcam}{,} KVMerger~\cite{wang2024model}{,} ~\citet{dong2024get}, leaf, fill=white, text width=50.5em
                        ]
                    ]
                    [
                        \textbf{Layer-wise Sharing~(\S\ref{sec3_3})}
                        [
                            \textbf{Pre-training-based}
                            [
                                \quad YOCO~\citep{sun2024you}{,} GoldFinch~\citep{goldstein2024goldfinch}, leaf
                            ]
                        ]
                        [
                            \textbf{Fine-tuning-based}
                            [
                                \quad CLA~\citep{brandon2024reducing}{,} MiniCache~\citep{liu2024minicache}{,}  \\ \quad LCKV~\citep{wu2024layer}{,} SwiftKV~\citep{qiao2024swiftkv}{,} KVSharer~\citep{yang2024kvsharer}{,}  \\ \quad MLKV~\citep{zuhri2024mlkv}{,} CLLA~\citep{yang2024lossless}{,} \\ \quad CEPE~\citep{yen2024long}{,} Shared Attention~\citep{liao2024beyond},leaf
                            ]
                        ]
                    ]
                    [
                        \textbf{Head-wise Sharing~(\S\ref{sec3_4})}
                        [
                            \textbf{Direst Sharing}
                            [
                               \quad MQA~\citep{shazeer2019fast}{,} GQA~\citep{ainslie2023gqa} {,}DHA~\citep{chen2024dha}, leaf
                            ]
                        ]
                        [
                            \textbf{Compression-based}
                            [
                                \quad MLA~\citep{liu2024deepseek}{,} Neurocache~\citep{safaya2024neurocache}, leaf
                            ]
                        ]
                    ]
                    [
                        \textbf{Feature Compression~(\S\ref{sec3_5})}
                        [
                            \quad Palu~\citep{chang2024palu}{,} Eigen~\citep{saxena2024eigen}{,} MatryoshkaKV~\citep{lin2024matryoshkakv}{,} \\ \quad LoRC~\citep{zhang2024lorc}{,} LPA~\citep{lv2024scalable}{,} ThinK~\citep{xu2024think}{,} , leaf, text width=50.5em, fill=white
                        ]
                    ]
                    [
                        \textbf{Cache Quantization~(\S\ref{sec3_6})}
                        [
                            \quad KVQuant~\citep{hooper2024kvquant}{,} MiKV~\citep{yang2024no}{,} KIVI~\citep{liu2024kivi}{,} \\
                            \quad SKVQ~\citep{duanmu2024skvq}{,} ZipCache~\citep{he2024zipcache}{,} PQCache~\citep{zhang2024pqcache}{,} \\
                            \quad GEAR~\citep{kang2024gear}{,} QJL~\citep{zandieh2024qjl}{,} AsymKV~\citep{tao2024asymkv} ,leaf, text width=50.5em, fill=white
                        ]
                        % [
                        %     \textbf{Traditional Methods}
                        %     [
                        %         \quad KVQuant{,}KIVI,leaf
                        %     ]
                        % ]
                        % [
                        %     \textbf{Novel Methods}
                        %     [
                        %         \quad QJL{,}AsymKV,leaf
                        %     ]
                        % ]
                    ]
			]
		\end{forest}
	}
	\caption{An overview of KV cache optimization of long-context LLMs.}
	\label{fig:kv_opt}
\end{figure*}
