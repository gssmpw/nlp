\tikzstyle{my-box}=[
	rectangle,
	draw=black, % hidden-draw,
	rounded corners,
	text opacity=1,
	minimum height=1.5em,
	minimum width=5em,
	inner sep=2pt,
	align=center,
	fill opacity=.5,
	line width=0.8pt,
]
\tikzstyle{leaf}=[my-box, minimum height=1.5em,
	text=black, align=left,font=\normalsize,
	inner xsep=10pt,
	inner ysep=4pt,
	line width=0.8pt,
]


\begin{figure*}[t]
	\centering
	\resizebox{\textwidth}{!}{
		\begin{forest}
			forked edges,
			for tree={
				grow=east,
				reversed=true,
				anchor=base west,
				parent anchor=east,
				child anchor=west,
				base=center,
				font=\large,
				rectangle,
				draw=black, % hidden-draw,
				rounded corners,
				align=left,
				text centered,
				minimum width=4em,
				edge+={darkgray, line width=1pt},
				s sep=3pt,
				inner xsep=2pt,
				inner ysep=3pt,
				line width=0.8pt,
				ver/.style={rotate=90, child anchor=north, parent anchor=south, anchor=center, minimum width=19em, fill=gray!10},
			},
			where level=1{text width=14em,font=\normalsize,fill=green!10}{},
			where level=2{text width=14em, align=left, font=\normalsize, fill=orange!10}{},
			where level=3{text width=28em, align=left}{},
			where level=4{text width=18em,font=\normalsize,}{},
			where level=5{text width=18em,font=\normalsize,}{},
			[
				\textbf{Training Infrastructure}, ver
				[
                        \textbf{Parallelism Strategies~(\S\ref{sec6_1})}
                        [
                            \textbf{DP, TP and PP}
                        ]
                        [
                            \textbf{Distributed Attention}
                            [
                                \textbf{Sequence Parallelism and Its Variants}, leaf
                            ]
                            [
                                \textbf{Combination of Multiple Parallelism Approaches}, leaf
                            ]
                        ]
                    ]
                    [
                        \textbf{Memory Pressure~(\S\ref{sec6_2})}
                        [
                            \textbf{Activation Recomputation}
                            [
                                \textbf{Static Strategies}, leaf
                            ]
                            [
                                \textbf{Dynamic Strategies}, leaf
                            ]
                        ]
                        [
                            \textbf{Redundancy Reduction}
                            [
                                \textbf{The Zero Redundancy Optimizer}, leaf
                            ]
                            [
                                \textbf{Improvement Strategies}, leaf
                            ]
                        ]
                        [
                            \textbf{Defragmentation}\\\newline\textbf{and Offloading}
                            [
                                \textbf{GPU Memory Defragmentation}, leaf
                            ]
                            [
                                \textbf{Offloading}, leaf
                            ]
                        ]
                    ]
                    [
                        \textbf{FLOPs Utilization~(\S\ref{sec6_3})}
                        [
                            \textbf{Training Data Pipeline}
                            [
                                \textbf{Packing of Variable-length Sequences}, leaf
                            ]
                            [
                                \textbf{Parallel Tokenization}, leaf
                            ]
                        ]
                        [
                            \textbf{Operator Optimization}
                            [
                                \textbf{Manual Optimization}, leaf
                            ]
                            [
                                \textbf{Compiler-level Optimization}, leaf
                            ]
                        ]
                        [
                            \textbf{Scheduling Optimization}
                            [
                                \textbf{Load Balance}, leaf
                            ]
                            [
                                \textbf{Resource Scheduling}, leaf
                            ]
                        ]
                    ]
			]
		\end{forest}
	}
	\caption{An overview of training infrastructure of long-context LLMs.}
	\label{fig:train_infra}
\end{figure*}
