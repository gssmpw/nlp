Recall the approach introduced in Section~\ref{sec:abstraction}, where each best response policy with learned DQN weights $\vartheta$ is represented with an abstract symbol, and new actions are added to only $M$ of each player's information sets in $\hat{G}$. We use the symbols $\pi_x$ for $x \in \{0, 1, 2, \ldots \}$ in a slight abuse of notation to distinguish between policy labels for different learned weights instead $\pi_{\vartheta_x}$. We now articulate an example of how the empirical game tree might now grow through the new paths generated for $M = 1$ using the sequential bargaining game introduced earlier as a running example. The initial strategy profile of the empirical game tree is set for the information sets that comprise both players' first turns in the negotiations. An example is depicted in Figure~\ref{fig:empirical_game_iter0} for an initial strategy profile where $\bsigma_1$ at both of player 1's information sets $(H,)$ and $(L,)$ returns the sole action $(\pi_0, \F)$ and $\bsigma_2$ at player 2's information sets $(H, (\pi_0, \F))$ and $(L, (\pi_0, \F))$ returns the sole action $(\pi_0, \T)$. The choice to reveal the outside offer signal is selected randomly for both players. The policy $\pi_0$ for player $j$ corresponds to an initial random weight setting $\vartheta_0^j$ of that player's DQN (i.e. $\pi_0$ for player 1 is not identical to $\pi_0$ for player 2). We abuse notation slightly in Figure~\ref{fig:empirical_game_iter0} by including the revelation $R$ that is part of the action outputted by $\vartheta_0^j$ for each player $j$ in the edges of $\hat{G}$ in addition to $\pi_0$ so that the effect of player 1's choice of $R$ on player 2's information sets is captured visually.

The best response policy for each player $\pi_1$ with weights $\vartheta_1$ is then added to the action space of $M$ information sets in $\hat{\cI_j}$ per player, where $M$ is defined as in Section~\ref{sec:abstraction} and is set to 1 for this example. As an additional check on $\hat{G}$'s growth, the number of negotiation turns explicitly included so far in the empirical game tree is increased by at most one during the expansion of the tree, depending on where the best responses are added. It is important to note that we require the revelation $R$ of the action outputted by the weights $\vartheta_x$ of policy $\pi_x$ to be identical for all infostates represented by a given $I$ in $\hat{G}$.

\begin{figure}[ht!]
\centering
\begin{subfigure}[c]{0.45\textwidth}
\begin{flushleft}
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 8mm, sibling distance = 25mm},
    level 2/.style = {level distance = 8mm, sibling distance = 15mm},
    level 3/.style = {level distance = 10mm, sibling distance = 15mm},
    level 4/.style = {level distance = 10mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above}]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2_2}, diamond] (3) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (4) {}
          edge from parent node[engine, left] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, left] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={player1}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={player2_1}, diamond] (3) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (4) {}
          edge from parent node[engine, left] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, left] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$H$}}
    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $L_1$
      child {node [draw, black, fill={player1_1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2_2}, diamond] (3) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (4) {}
          edge from parent node[engine, right] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, right] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={player1_1}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={player2_1}, diamond] (3) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (4) {}
          edge from parent node[engine, right] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, right] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$L$}
    };

\end{tikzpicture}
\end{flushleft}
\end{subfigure}
\begin{subfigure}[c]{0.4\textwidth}
% \vspace{-7em}
\begin{flushright}
% \vspace{-20em}
    \fbox{\begin{tabular}{rr}
\scriptsize{\textcolor{chance}{\TriangleDown}} & \scriptsize Chance Nodes \\
\scriptsize{\textcolor{player1}{\CircleSolid} \textcolor{player1_1}{\CircleSolid}} & \scriptsize Player 1 Infosets \\
\scriptsize{\textcolor{player2_2}{\DiamondSolid} \textcolor{player2_1}{\DiamondSolid}} & \scriptsize Player 2 Infosets \\
\scriptsize{\textcolor{terminal}{\TriangleUp}} & \scriptsize Terminal Nodes
\end{tabular}}
\end{flushright}
\end{subfigure}

    \caption{Sample empirical game tree with initial policy set at start of TE-PSRO}
    \label{fig:empirical_game_iter0}
\end{figure}

\begin{figure}[ht!]
\centering
\begin{subfigure}[t]{\textwidth}
\centering
\resizebox{0.55\textwidth}{!}{%
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 8mm, sibling distance = 40mm},
    level 2/.style = {level distance = 8mm, sibling distance = 22mm},
    level 3/.style = {level distance = 18mm, sibling distance = 10mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above}]
    \node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]


    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={player1_5}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (6) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={player1_6}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (6) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={player1_4}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (6) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$H$}}
    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $L_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={player1_3}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (6) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={player2_3}, diamond] (7) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (8) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (4) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={player1_2}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (6) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={player2_4}, diamond] (8) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm] (9) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$L$}
    };

\end{tikzpicture}%
}
\end{subfigure}
\bigskip

\begin{subfigure}[t]{.35\textwidth}
\centering
    \fbox{\begin{tabular}{ll}
\scriptsize{\textcolor{oldplayer}{\TriangleDown} \textcolor{oldplayer}{\CircleSolid}} \\ \scriptsize{\textcolor{oldplayer}{\DiamondSolid} \textcolor{oldplayer}{\TriangleUp}} & \scriptsize Old Nodes \\
\scriptsize{\textcolor{player1_5}{\CircleSolid} \textcolor{player1_6}{\CircleSolid} \textcolor{player1_4}{\CircleSolid}} \\ \scriptsize{\textcolor{player1_3}{\CircleSolid} \textcolor{player1_2}{\CircleSolid}} & \scriptsize New Player 1 Infosets \\
\scriptsize{\textcolor{player2_3}{\DiamondSolid} \textcolor{player2_4}{\DiamondSolid}} & \scriptsize New Player 2 Infosets \\
\scriptsize{\textcolor{terminal}{\TriangleUp}} & \scriptsize New Terminal Nodes
\end{tabular}}
\end{subfigure}
    \caption{Empirical game tree after iteration 1 of TE-PSRO for $M = 1$.}
    \label{fig:empirical_game_iter1}
\end{figure}

Let player 1's new best response be $(\pi_1, \F)$ and player 2's new best response be $(\pi_1, \F)$. Since $M = 1$, suppose player 1's randomly chosen information set is $(L,)$ and player 2's chosen information set is $(L, (\pi_0, \F))$. All possible strategy profiles for the empirical game tree given the new $\hat{\cI_1} \cup \hat{\cI_2}$ are then passed into the simulator one at a time and sampled with a fixed budget. The simulator then returns a corresponding history of actions \textit{through the empirical game tree} representing a new path and sampled reward vector. All possible new paths are then added to the empirical game tree, with each (possibly new) terminal node containing a weighted average of all payoff samples associated with the leaf's history known as the \term{leaf utility}. Figure~\ref{fig:empirical_game_iter1} illustrates the resulting new empirical game tree, where new information sets are brightly colored and all old nodes included in the initial empirical game tree are gray. Additional figures that visualize the addition of new best responses to $\hat{G}$ for $M = 1$ during iterations 2 and 3 of TE-PSRO are included in the appendices.



In iteration 2 of TE-PSRO, suppose that player 1's best response $(\pi_2, \F)$ is added to the randomly chosen information set $(H, L,(\pi_0, \F),(\pi_0, \T))$
highlighted in bright pink in Figure~\ref{fig:empirical_game_iter1} and that player 2's best response $(\pi_2, \T)$ is added to the randomly chosen information set $(H, (\pi_0, \F))$ highlighted in both gray and dark pink in Figure~\ref{fig:empirical_game_iter1}. The resulting expanded game tree with all possible new paths is depicted in Figure~\ref{fig:empirical_game_iter2}. Notice that in this figure, the terminal nodes from the previous iteration's empirical game tree are replaced with new information sets yet again, mostly belonging to player 2. Finally, in iteration 3 of TE-PSRO, suppose that player 1's best response policy $(\pi_3, \T)$ gets added to the information set $(H,)$ early on in the tree and player 2's best response policy $(\pi_3, \F)$ gets added to the information set $(H, (\pi_1, \F))$. The resulting expanded empirical game tree is depicted in Figure~\ref{fig:empirical_game_iter3}.

\begin{figure}[H]
\centering
\begin{subfigure}[b]{\textwidth}
\centering
\resizebox{0.9\textwidth}{!}{%
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 8mm, sibling distance = 68mm},
    level 2/.style = {level distance = 8mm, sibling distance = 32mm},
    level 3/.style = {level distance = 20mm, sibling distance = 16mm},
    level 4/.style = {level distance = 20mm, sibling distance = 12mm},
    level 5/.style = {level distance = 20mm, sibling distance = 10mm},
    engine/.style = {inner sep = 1pt, above}]
    \node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] {}
    [black, ->]


    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] (1) {} % $H_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={player2_8}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (20) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={player1_7}, circle] (10) {}
            child {node [draw, black, fill={player2_7}, diamond] (11) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (19) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
        edge from parent node[engine, left] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={player2_10}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
            child {node [draw, black, fill={player2_6}, diamond] (8) {}
              child {node [draw, black, fill={player1_8}, circle] (12) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (13) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={player2_9}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, left] {{\scriptsize $(\pi_0, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$H$}}
    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] (1) {} % $L_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={player2_8}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (20) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={player1_9}, circle] (12) {}
            child {node [draw, black, fill={player2_7}, diamond] (13) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (19) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={oldplayer}, diamond] (7) {}
          child {node [draw, black, fill={player1_10}, circle] (8) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (14) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={player1_11}, circle] (4) {}
            child {node [draw, black, fill={player2_10}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={player2_9}, diamond] (6) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={oldplayer}, diamond] (8) {}
          child {node [draw, black, fill={player1_12}, circle] (9) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (16) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$L$}
    };

\end{tikzpicture}%
}
\vspace{1.5em}
\end{subfigure}
% \hspace{8em}
% Reorient this legend's position and rows/columns depending on the format of the paper/thesis
\begin{subfigure}[b]{0.33\textwidth}
\centering
    \fbox{\begin{tabular}{ll}
\footnotesize{\textcolor{oldplayer}{\TriangleDown} \textcolor{oldplayer}{\CircleSolid} \textcolor{oldplayer}{\DiamondSolid} \textcolor{oldplayer}{\TriangleUp}} & \scriptsize Old Nodes \\
\footnotesize{\textcolor{player1_7}{\CircleSolid} \textcolor{player1_8}{\CircleSolid} \textcolor{player1_9}{\CircleSolid} \textcolor{player1_10}{\CircleSolid}} & \scriptsize New Player 1 Infosets \\
\footnotesize{\textcolor{player1_11}{\CircleSolid} \textcolor{player1_12}{\CircleSolid}} & \scriptsize \\
\footnotesize{\textcolor{player2_8}{\DiamondSolid} \textcolor{player2_7}{\DiamondSolid} \textcolor{player2_10}{\DiamondSolid} \textcolor{player2_6}{\DiamondSolid}} & \scriptsize New Player 2 Infosets \\
\footnotesize{\textcolor{player2_9}{\DiamondSolid}} & \scriptsize \\
\footnotesize{\textcolor{terminal}{\TriangleUp}} & \scriptsize New Terminal Nodes
\end{tabular}}
\end{subfigure}
    \caption{Empirical game tree after iteration 2 of TE-PSRO where a new BR policy has been added to a single information state in $\hat{G}$ for each player; here, the player 1 best response $(\pi_2, \F)$ has been added to the player 1 infoset $(H, L, (\pi_0, \F), (\pi_0, \T))$ while the player 2 best response $(\pi_2, \T)$ has been added to the player 2 infoset $(H, (\pi_0, \F))$.}
    \label{fig:empirical_game_iter2}
\end{figure}

\newpage

Iteration 3

\begin{figure}[H]
\centering
\begin{subfigure}[b]{\textwidth}
\centering
\resizebox{\textwidth}{!}{%
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 8mm, sibling distance = 80mm},
    level 2/.style = {level distance = 8mm, sibling distance = 40mm},
    level 3/.style = {level distance = 18mm, sibling distance = 22mm},
    level 4/.style = {level distance = 18mm, sibling distance = 12mm},
    level 5/.style = {level distance = 18mm, sibling distance = 10mm},
    level 6/.style = {level distance = 18mm, sibling distance = 10mm},
    engine/.style = {inner sep = 1pt, above}]
    \node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] {}
    [black, ->]

    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] (1) {} % $H_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (20) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
              child {node [draw, black, fill={player1_17}, circle] (26) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (27) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (10) {}
            child {node [draw, black, fill={oldplayer}, diamond] (11) {}
              child {node [draw, black, fill={player1_15}, circle] (23) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (19) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={player2_4}, diamond] (8) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (31) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_3, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={player1_2}, circle] (24) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
            child {node [draw, black, fill={oldplayer}, diamond] (8) {}
              child {node [draw, black, fill={oldplayer}, circle] (12) {}
                child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (13) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={player1_14}, circle] (22) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={player2_1}, diamond] (10) {}
          child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (32) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_3, \T)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$H$}}
    child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.1cm] (1) {} % $L_1$
      child {node [draw, black, fill={oldplayer}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (20) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
              child {node [draw, black, fill={player1_18}, circle] (27) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (28) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (12) {}
            child {node [draw, black, fill={oldplayer}, diamond] (13) {}
              child {node [draw, black, fill={oldplayer}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (19) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={oldplayer}, diamond] (7) {}
          child {node [draw, black, fill={oldplayer}, circle] (8) {}
            child {node [draw, black, fill={player2_12}, diamond] (33) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (14) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={player1_19}, circle] (29) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (30) {}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_3, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
      child {node [draw, black, fill={oldplayer}, circle] (5) {} % $L_2$
        child {node [draw, black, fill={oldplayer}, diamond] (3) {}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={player1_20}, circle] (30) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
          child {node [draw, black, fill={oldplayer}, circle] (4) {}
            child {node [draw, black, fill={oldplayer}, diamond] (6) {}
              child {node [draw, black, fill={player1_1}, circle] (27) {}
                child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (21) {}
                edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \F)$}}}
        child {node [draw, black, fill={oldplayer}, diamond] (8) {}
          child {node [draw, black, fill={oldplayer}, circle] (9) {}
            child {node [draw, black, fill={player2_11}, diamond] (31) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.1cm] (16) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\pi_0, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\pi_1, \F)$}}}
      edge from parent node[engine, sloped] {$L$}}
    edge from parent node[engine, sloped] {$L$}
    };

\end{tikzpicture}%
}
\vspace{1.5em}
\end{subfigure}
% \hspace{8em}
% Reorient this legend's position and rows/columns depending on the format of the paper/thesis
\begin{subfigure}[b]{0.4\textwidth}
\centering
    \fbox{\begin{tabular}{ll}
\footnotesize{\textcolor{oldplayer}{\TriangleDown} \textcolor{oldplayer}{\CircleSolid} \textcolor{oldplayer}{\DiamondSolid} \textcolor{oldplayer}{\TriangleUp}} & \scriptsize Old Nodes \\
\footnotesize{\textcolor{player1_17}{\CircleSolid} \textcolor{player1_15}{\CircleSolid} \textcolor{player1_2}{\CircleSolid} \textcolor{player1_14}{\CircleSolid}} & \scriptsize New Player 1 Infosets \\
\footnotesize{\textcolor{player1_18}{\CircleSolid} \textcolor{player1_19}{\CircleSolid} \textcolor{player1_20}{\CircleSolid} \textcolor{player1_1}{\CircleSolid}} &  \\
\footnotesize{\textcolor{player2_4}{\DiamondSolid} \textcolor{player2_1}{\DiamondSolid} \textcolor{player2_12}{\DiamondSolid} \textcolor{player2_11}{\DiamondSolid}} & \scriptsize New Player 2 Infosets \\
\footnotesize{\textcolor{terminal}{\TriangleUp}} & \scriptsize New Terminal Nodes
\end{tabular}}
\end{subfigure}
    \caption{Empirical game tree after iteration 3 of TE-PSRO where a new BR policy has been added to a single information state in $\hat{G}$ for each player; here, the player 1 best response $(\pi_3, \T)$ has been added to the player 1 infoset $(H,)$ while the player 2 best response $(\pi_3, \F)$ has been added to the player 2 infoset $(H, (\pi_1, \F))$.}
    \label{fig:empirical_game_iter3}
\end{figure}

\newpage
\subsection{Game Tree Expansion}\label{sec:expand_game_tree}
% TODO: TRIM A LOT OF FAT FROM THIS SECTION

It is important to note that several of what were originally terminal nodes in $\hat{G}$ (regardless of how many rounds of negotiation have passed) have been replaced with new information sets belonging to player 1, along with a ``default policy" edge leading to a brand new terminal node (represented with yellow triangles). The default policy edge is labeled on the assumption that the player has continued with the same policy he committed to in his previous information set in the sequence, since a policy $\pi_x$ specifies what that player should do in every possible game state of the true game. When adding new simulation data to the empirical game tree, we are adding a new history of policy-and-signal-reveal pairs to the tree along with its corresponding sampled reward vector. Although simple in principle, the fact that gameplay can end after anywhere from 2 to $2T$ player turns have been completed at different points in the game tree complicates the process of expanding the tree with new simulation data in a manner that \citet{konicki22} did not address since their considerations were restricted to games whose terminal nodes all had the same history length. We demonstrate how a new observation sequence and sampled reward outputted by the simulator might be added to $\hat{G}$ for the bargaining game via three scenarios.

In Scenario 1, the tree in Figure~\ref{fig:scenario1_a} is expanded to include a completely new terminal node whose history does not overlap with any other present terminal nodes. The lack of overlap between the two terminal nodes' respective histories after the first decision node make depicted in Figure~\ref{fig:scenario1_b} meant the second terminal node could be added without overwriting the first terminal node's history, position in the tree, or leaf utility. 
\begin{figure}[ht!]
\centering
\begin{subfigure}[b]{\textwidth}
\centering
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 12mm, sibling distance = 80mm},
    level 2/.style = {level distance = 12mm, sibling distance = 38mm},
    level 3/.style = {level distance = 25mm, sibling distance = 13mm},
    level 4/.style = {level distance = 25mm, sibling distance = 8mm},
    level 5/.style = {level distance = 25mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
          child {node [draw, black, fill={player1}, circle] (4) {}
            child {node [draw, black, fill={terminal},  regular polygon, regular polygon sides=3, inner sep=0.08cm, label=right:{{\scriptsize[1, 3]}}] (5) {}
            edge from parent node[engine, sloped] {{\scriptsize $\mathbf{\pi}_3, \T)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{$\hat{G}$ before }\label{fig:scenario1_a}
\vspace{2em}
\end{subfigure} \\
\begin{subfigure}[b]{\textwidth}
\centering

\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 12mm, sibling distance = 80mm},
    level 2/.style = {level distance = 12mm, sibling distance = 38mm},
    level 3/.style = {level distance = 27mm, sibling distance = 8mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    level 5/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
          child {node [draw, black, fill={player1}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[1, 3]}}] (5) {}
            edge from parent node[engine, sloped,below] {{\scriptsize $(\mathbf{\pi}_3, \T)$}}}
          edge from parent node[engine, sloped,below] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped,below] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
        child {node [draw, black, fill={player2}, diamond] (6) {}
          child {node [draw, black, fill={player1}, circle] (7) {}
            child {node [draw, black, fill={player2}, diamond] (8) {}
              child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[2, 0.5]}}] (9) {}
              edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
            edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \F)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_5, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_4, \F)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{ $\hat{G}$ after } \label{fig:scenario1_b}
\end{subfigure}
    \caption{Scenario 1% A new path is added to the tree via action $(\pi_1, \F)$.
    }
    \label{fig:expand_scenario1}
\end{figure}

\begin{figure}[ht!]
\centering
    \begin{subfigure}[b]{\textwidth}
    \centering
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 12mm, sibling distance = 80mm},
    level 2/.style = {level distance = 12mm, sibling distance = 38mm},
    level 3/.style = {level distance = 20mm, sibling distance = 15mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    level 5/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
          child {node [draw, black, fill={player1}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[1, 3]}}] (5) {}
            edge from parent node[engine, sloped] {{\scriptsize $\mathbf{\pi}_3, \T)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{ Before} \label{fig:scenario2_a}
\end{subfigure} \\
\begin{subfigure}[b]{\textwidth}
\centering

\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 13mm, sibling distance = 80mm},
    level 2/.style = {level distance = 13mm, sibling distance = 38mm},
    level 3/.style = {level distance = 20mm, sibling distance = 18mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
          child {node [draw, black, fill={player1}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[1.5, 1.75]}}] (5) {}
            edge from parent node[engine, sloped] {{\scriptsize $\mathbf{\pi}_3, \T)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{ After} \label{fig:scenario2_b}
\end{subfigure}
    \caption{Scenario 2}
    \label{fig:expand_scenario2}
\end{figure}

\begin{figure}[ht!]
\centering
    \begin{subfigure}[b]{\textwidth}
    \centering
\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 12mm, sibling distance = 80mm},
    level 2/.style = {level distance = 12mm, sibling distance = 38mm},
    level 3/.style = {level distance = 20mm, sibling distance = 18mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[1, 3]}}] (5) {}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{ Before} \label{fig:scenario3_a}
\end{subfigure} \\
\begin{subfigure}[b]{\textwidth}
\centering

\begin{tikzpicture}[thick,
    level 1/.style = {level distance = 12mm, sibling distance = 80mm},
    level 2/.style = {level distance = 12mm, sibling distance = 38mm},
    level 3/.style = {level distance = 20mm, sibling distance = 18mm},
    level 4/.style = {level distance = 20mm, sibling distance = 8mm},
    level 5/.style = {level distance = 20mm, sibling distance = 8mm},
    engine/.style = {inner sep = 1pt, above},
    grow=right]
    \node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] {}
    [black, ->]

    child {node [draw, black, fill={chance}, regular polygon, regular polygon sides=3, rotate=180, inner sep=0.08cm] (1) {} % $H_1$
      child {node [draw, black, fill={player1}, circle] (2) {} % $H_2$
        child {node [draw, black, fill={player2}, diamond] (3) {}
          child {node [draw, black, fill={player1}, circle] (4) {}
            child {node [draw, black, fill={terminal}, regular polygon, regular polygon sides=3, inner sep=0.08cm, label=below:{{\scriptsize[1.5, 1.75]}}] (5) {}
            edge from parent node[engine, sloped] {{\scriptsize $\mathbf{\pi}_3, \T)$}}}
          edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_2, \T)$}}}
        edge from parent node[engine, sloped] {{\scriptsize $(\mathbf{\pi}_1, \T)$}}}
      edge from parent node[engine, sloped] {$H$}}
    edge from parent node[engine, sloped] {$H$}
    };

\end{tikzpicture}
\caption{After } \label{fig:scenario3_b}
\end{subfigure}
    \caption{Scenario 3}
    \label{fig:expand_scenario3}
\end{figure}

In the second scenario, the new history to be added to the tree in Figure~\ref{fig:scenario2_a} happens to be completely contained by an existing terminal node. Figure~\ref{fig:scenario2_b} reflects the resulting update where the set of terminal nodes in the tree remains unchanged, but the leaf utility at the existing node has been recalculated to be the average of the old sampled utility $[1, 3]$ and the new one $[2, 0.5]$. If the original happened to be an average of multiple samples with the same corresponding terminal history, the new utility would be just another sample. For instance, if the original terminal node's leaf utility $[1, 3]$ in Figure~\ref{fig:scenario2_a} was the result of two observations with sampled utilities $u^1 = [0, 2]$ and $u^2 = [2, 4]$, the node's utility in Figure~\ref{fig:scenario2_b} would be updated to the new average $[1.\overline{3}, 2.1\overline{6}]$.

In the third scenario depicted in Figure~\ref{fig:expand_scenario3}, the new history to be added to the tree in Figure~\ref{fig:scenario3_a} is identical to the one currently included in the tree, but with the addition of a second action from player 1. We see that in Figure~\ref{fig:scenario3_b}, the terminal node representing the conclusion of gameplay following player 2's action is now a decision node belonging to player 1, and the resulting leaf utility at the terminal node following player 1's action is a recalculated average of the original node's leaf utility $[1, 3]$ and the new terminal node's sampled reward $[2, 0.5]$, as described in the previous case.