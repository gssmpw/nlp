% \input{algos/NP_skill_def}

% \input{algos/P_skill_def}

% As outlined Definition~\ref{Def:Skill} in the Section~\ref{sec:Experiments}, the skill consist of two components: (1) a goal-conditioned policy $\pi$, and (2) an applicability checker $\phi$.

% The goal-conditioned policy $\pi$ consists of two different policies: (1) pre-contact policy $\pi_\text{pre}$, and (2) post-contact policy $\pi_\text{post}$. % , and (3) connector policy $\pi_C$.
% \begin{itemize}
% \item The pre-contact policy $\pi_\text{pre}$ computes the pre-contact robot joint positions $q'_r$ from $q_\text{obj}$ and target object poses $q'_\text{obj}$.
% \item The post-contact policy $\pi_\text{post}$ computes a low-level action $a$, which includes changes of end-effector pose, proportional gain of joints, and damping of joints, to manipulate the object from current state $s$ and desired object pose $q'_\text{obj}$.
% % \item The connector policy $\pi_C$ computes a low-level action $a$, which includes changes in the end-effector pose, proportional gain of joints, damping of joints, and absolute gripper width, to relocate the robot configuration from the current state $s$ to the pre-contact robot joint positions $q'_r$.

% \end{itemize}
% The pre-contact policy $\pi_\text{pre}$ computes the pre-contact robot joint positions $q'_r$ from $q_\text{obj}$ and target object poses $q'_\text{obj}$. The post-contact policy $\pi_\text{post}$ computes a low-level action $a$, which includes changes of end-effector pose, proportional gain of joints, and damping of joints, to manipulate the object from current state $s$ and desired object pose $q'_\text{obj}$. The connector policy $\pi_C$ computes a low-level action $a$, which includes changes in the end-effector pose, proportional gain of joints, damping of joints, and absolute gripper width, to relocate the robot configuration from the current state $s$ to the pre-contact robot joint positions $q'_r$.

% The region $R$ determines the object pose sampling space for the skill $K$. Each NP skill has a corresponding region \( R \), a subset of the space of object poses $\Qobj$. The NP skill is trained to manipulate an object from an object pose \( q_{\text{obj}} \) within the region \( R \) to another object pose \( q_{\text{obj}} \) within the same region \( R \). For each P skill, the region is the same as the space of object poses $\Qobj$.


An applicability checker function \( \phi (q_{\text{obj}}, q'_{\text{obj}}) \) tests whether it is possible to execute the skill post-contact policy, transitioning the object pose from \( q_{\text{obj}} \) to \( q'_{\text{obj}} \) as its goal.
\begin{itemize}
    \item card flip domain
    \begin{itemize}
        \item slide skill: \( \phi_{\text{slide}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object can slide from \( q_{\text{obj}} \) to \( q'_{\text{obj}} \). It returns 1 if both poses belong to \( Q_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
    \end{itemize}
    \item bookshelf domain
    \begin{itemize}
        \item topple skill: \( \phi_{\text{topple}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the upper shelf can transition between poses while toppling. It returns 1 if both poses belong to \( Q^\text{upper-shelf}_{\text{obj}} \) and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( z \)-axes.
        \item push skill: \( \phi_{\text{push}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the lower shelf can be pushed. It returns 1 if both poses belong to \( Q^\text{lower-shelf}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
    \end{itemize}
    \item kitchen domain
    \begin{itemize}
        \item sink skill: \( \phi_{\text{sink}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the sink can be manipulated. It returns 1 if both poses belong to \( Q_{\text{obj}}^{\text{sink}} \).
        \item left cupboard skill: \( \phi_{\text{l-cupboard}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the left cupboard can be pushed. It returns 1 if both poses belong to \( Q^\text{l-cupboard}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
        \item right cupboard skill: \( \phi_{\text{r-cupboard}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the right cupboard can be pushed. It returns 1 if both poses belong to \( Q^\text{r-cupboard}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
    \end{itemize}
    \item[] Prehensile skill: Across all domains, $\phi_\text{P}(\qobj, \qobj')$ returns 1 if both the initial and desired object poses \( q_\text{obj}, q'_\text{obj} \) belong to the valid object pose space \( \Qobj \), and the computed pre-contact robot joint position \( q'_r = \pi_{\text{pre}}(s, q_{\text{obj}}, q'_{\text{obj}}) \) is collision-free and not null. Otherwise, it returns 0.
\end{itemize}
% In the card domain, the applicability checker function of the slide skill \( \phi_{\text{slide}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object can slide from \( q_{\text{obj}} \) to \( q'_{\text{obj}} \). It returns 1 if both poses belong to \( Q_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
% In the bookshelf domain, the applicability checker function of the topple skill \( \phi_{\text{topple}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the upper shelf can transition between poses while toppling. It returns 1 if both poses belong to \( Q^\text{upper-shelf}_{\text{obj}} \) and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( z \)-axes.
% The applicability checker function of the push skill \( \phi_{\text{push}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the lower shelf can be pushed. It returns 1 if both poses belong to \( Q^\text{lower-shelf}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
% In the kitchen domain, the applicability checker function of the sink skill \( \phi_{\text{sink}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the sink can be manipulated. It returns 1 if both poses belong to \( Q_{\text{obj}}^{\text{sink}} \). The applicability checker function of the left cupboard skill \( \phi_{\text{l-cupboard}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the left cupboard can be pushed. It returns 1 if both poses belong to \( Q^\text{l-cupboard}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes. The applicability checker function of the right cupboard skill \( \phi_{\text{r-cupboard}}(q_{\text{obj}}, q'_{\text{obj}}) \) determines whether an object on the right cupboard can be pushed. It returns 1 if both poses belong to \( Q^\text{r-cupboard}_{\text{obj}} \), and if both $\qobj$ and $q'_\text{obj}$ have identical orientations with respect to the global \( x \)- and \( y \)-axes.
% Across all domains, the applicability checker function for the place skill $\phi_\text{Place}(\qobj, \qobj')$ returns 1 if both the initial and desired object poses \( q_\text{obj}, q'_\text{obj} \) belong to the valid object configuration space \( \Qobj \), and the computed pre-contact robot joint positions \( q'_r = \pi_{\text{pre}}(s, q_{\text{obj}}, q'_{\text{obj}}) \) are collision-free. Otherwise, it returns 0.

% success condition of the skills
The success of the skill is evaluated based on the robot's ability to manipulate the object and position it near the desired object pose \( q'_{\text{obj}} \). Achieving an exact match between the current and desired object poses is not feasible, as object poses lie within a continuous space. Instead, the success condition allows for an error threshold, denoted as \( \delta_\text{obj} \), to account for practical precision limitations.

