\begin{algorithm}[H]
\caption{Training Connector Policy $\pi^c_{\text{NP}_i}$ for Non-Prehensile Skill $\kappa_{\text{NP}_i}$}\label{algo:train_connector_NP}
\begin{algorithmic}[1]
\State Initialize dataset $\mathcal{D} \leftarrow \emptyset$
\While{$|\mathcal{D}| < 1000$}
    \State Sample $q^O$ from $\mathcal{M}$ and $q^O_{\text{sg}}$ from $\mu_i$
    \If{$\text{precondition}^0_{\text{Place}}(q^O, q^O_{\text{sg}})$}
        \State $q^R_{\text{pre}} = f^{\text{pre}}(q^O, q^O_{\text{sg}})$
        \State $q^O_{\text{final}}, q^R_{\text{final}} \leftarrow \mathcal{T}_{simul}(\pi_{\text{Place}}, q^O, q^R_{\text{pre}}, q^O_{\text{sg}})$
        \If{CheckSuccess($q^O_{\text{final}}, q^O_{sg}$)}
            \State $(q^O_{\text{sg}})_i \leftarrow \text{UniformSamplePose}(\mu_i)$
            \If{ $\text{precondition}^0_{\text{NP}_i}( q^O_{\text{final}}, (q^O_{\text{sg}})_i)$}
                \State $(q^R_{\text{pre}})_i = f^{\text{pre}}_{\text{NP}_i}(q^O_{\text{final}}, ({q^O_{\text{sg}})_i})$
                \State Add $((q^O_{\text{final}}, q^R_{\text{final}}), (q^R_{\text{pre}})^i)$ to $\mathcal{D}$
            \EndIf
        \EndIf
    \EndIf
\EndWhile
\State Train $\pi^c_{\text{NP}_i}$ with $\mathcal{D}$ using PPO
\end{algorithmic}
\end{algorithm}
