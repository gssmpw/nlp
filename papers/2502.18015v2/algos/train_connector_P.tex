\begin{algorithm}[H]
\caption{Training Connector Policy $\pi^c_{\text{Place}}$ for Place Skill $\kappa_{\text{Place}}$}\label{algo:train_connector_P}
\begin{algorithmic}[1]
\State Initialize dataset $\mathcal{D_{\text{final}}} \leftarrow \emptyset$
\State Initialize dataset $\mathcal{D} \leftarrow \emptyset$
\While{$|\mathcal{D}| < 1000$}
    \For{each Non-Prehensile skill $\kappa_{\text{NP}_i}$}
        \State $q^O \leftarrow \text{UniformSamplePose}(\mu_i)$
        \State $q^O_{\text{sg}} \leftarrow \text{UniformSamplePose}(\mu_i)$
        \If{$\text{precondition}^0_{\text{NP}_i}(q^O, q^O_{\text{sg}})$}
            \State $q^R_{\text{pre}} = f^{\text{pre}}_{\text{NP}_i}(q^O, q^O_{\text{sg}})$
            \State $q^O_{\text{final}}, q^R_{\text{final}} \leftarrow \mathcal{T}_{simul}(\pi_{\text{NP}_i}, q^O, q^R_{\text{pre}}, q^O_{\text{sg}})$
            \If{CheckSuccess($q^O_{\text{final}}, q^O_{\text{sg}}$)}
                \State Add $(q^O_{\text{final}}, q^R_{\text{final}})$ to $\mathcal{D_{\text{final}}}$
            \EndIf
        \EndIf
    \EndFor
    \State Sample $(q^O_{\text{final}}, q^R_{\text{final}})$ from $\mathcal{D_{\text{final}}}$
    \State Sample $(q^O_{sg})_{\text{place}}$ from $\mathcal{M}$
    \If{$\text{precondition}^0_{\text{Place}}(q^O_{\text{final}}, (q^O_{sg})_{\text{place}})$}
        \State $(q^R_{\text{pre}})_{\text{place}} = f^{\text{pre}}_{\text{place}}(q^O_{\text{final}}, (q^O_{sg})_{\text{place}})$
        \State Add $((q^O_{\text{final}}, q^R_{\text{final}}), (q^R_{\text{pre}})_{\text{place}})$ to $\mathcal{D}$
    \EndIf
\EndWhile
\State Train $\pi^c_{\text{Place}}$ with $\mathcal{D}$ using PPO
\end{algorithmic}
\end{algorithm}