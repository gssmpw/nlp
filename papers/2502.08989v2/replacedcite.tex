\section{Related Work}
\label{sec:related-work}
Secure aggregation in FL protects individual users' local model parameters from being disclosed to the central aggregator server. This mechanism is also referred to as privacy-preserving aggregation ____. Differential privacy (DP), homomorphic encryption (HE), secure multi-party computation (SMC), and masking methods are being used for privacy-preserving secure aggregation in FL ____, ____. Our proposed scheme falls within the masking-based method. Therefore, we briefly introduce the other secure aggregation methods while providing a detailed discussion of the masking-based approach.  
\subsection{DP, HE, and SMC Based Schemes}
In DP-based secure aggregation schemes, random noise is added to users' gradients before they are sent to the aggregator server ____. This process protects the sensitive information within the gradients by making it difficult to reverse-engineer the original values, as DP introduces controlled noise to the data. Despite this added layer of privacy, the server can still aggregate these perturbed gradients to approximate the true model updates, owing to the mathematical properties of DP. However, a key challenge with DP is the inevitable trade-off between the level of privacy and the utility of the data. The more noise that is introduced to protect privacy, the less accurate the aggregated model becomes, which can potentially lead to significant degradation in model performance ____. 
Striking a delicate balance between safeguarding individual privacy and maintaining data utility is a central concern in the application of DP in FL, and finding the optimal point on this spectrum remains an area of active research. Some notable works in this domain include ____.
\par 
In Homomorphic Encryption (HE)-based aggregation schemes, such as those proposed in ____ users first apply computation-intensive algorithms to encrypt their local model parameters before sending them to the central server.
HE allows for arithmetic operations to be performed directly on encrypted data without needing to decrypt it first. This means that the server can aggregate the encrypted local model parameters by performing operations like addition or multiplication directly on the ciphertext. After the aggregation process, the server either sends the aggregated encrypted result back to the users for decryption or continues the training process directly on the ciphertext. This approach ensures that sensitive gradient information remains protected throughout the entire process, as the data remains encrypted during both transmission and computation. However, the use of HE introduces significant computational overhead, both in terms of the initial encryption performed by the participants and the subsequent operations carried out by the server on the encrypted data ____, ____. 

\par 
SMC is another cryptographic technique that has been applied in secure aggregation within FL ____. SMC allows multiple participants, each with their own private data, to collaboratively compute a desired objective function without revealing their data to others. This method ensures that each participantâ€™s data remains confidential while still enabling the computation of an accurate result ____. However, SMC-based schemes tend to be inefficient, as they often involve significant communication overhead and face challenges in managing user dropouts ____, ____.

\subsection{Masking-Based Schemes}
The core idea of masking-based schemes is to secure users' local model parameters by adding random values (often referred to as one-time pads) to them before they are sent to the aggregator server ____. These random values are designed so that they cancel out during the aggregation process, allowing the aggregator server to recover the aggregated plaintext gradient values for all participants in that round. The primary goal of the masking-based approach is to protect individual users' local model parameters from being exposed to unauthorized parties while still enabling the aggregator server to access the aggregated gradient in its plaintext form ____.  Our work aligns with this approach, and we provide a detailed literature review on it below. 
\par 
In ____, Bonawitz \emph{et al.} proposed a practical secure aggregation scheme using masking to conceal individual users' local model parameters from the aggregator server. The scheme also employs secret sharing techniques to accommodate user dropouts, ensuring that the learning process is not affected by these dropouts. However, while it works well for one round of training, it becomes highly inefficient when multiple training rounds are required (which is essential for most real-world FL applications) due to the need for an expensive setup phase that involves four communication rounds to establish shared randomness and pairwise keys in every FL training round. 
Subsequently, several works have been conducted to improve the security and efficiency of ____ such as ____. In ____ and ____, the authors proposed two schemes to add verifiability on top of the protocol ____. 
In ____, Fereidooni \emph{et al.} used secret sharing and homomorphic encryption to achieve secure aggregation without relying on a trusted third party to generate any public/private key pair for the clients. In ____, Liu \emph{et al.} applied the concepts of homomorphic pseudo-random generator and Shamir Secret Sharing technique in achieving user dropouts and reducing the communication costs among the users, which is secure against both semi-honest and malicious adversaries. In ____, the authors reduced the communication overhead of ____ by utilizing a logarithmic degree k-regular graph. In ____, Liu \emph{et al.} proposed a Dynamic User Clustering scheme that builds on existing masking-based secure aggregation schemes, such as ____, and incorporates a sparsification technique to address the interoperability issues with sparsification. In ____, Fu \emph{et al.} proposed a blockchain-based decentralized secure aggregation scheme to replace the central aggregator server. The scheme uses masking and Shamir's Secret Sharing to ensure privacy. However, schemes such as ____ can only accommodate limited user dropouts due to their reliability in the secret sharing method. Further, the users cannot join in real-time, thereby limiting their flexibility in real-world applications. 
Moreover, each client must undergo pairwise random seed negotiation, share computation, and data transmission in each round of training, causing the system's complexity to escalate significantly as the number of clients grows. In ____, Eltaras \emph{et al.} proposed a pairwise masking-based secure aggregation scheme that uses auxiliary nodes to achieve verifiability and handle user dropouts. However, this scheme requires key agreement among users and auxiliary nodes, which increases communication overhead. Additionally, it does not address the malicious security model, where the server itself may behave maliciously. 
In ____, Ma \emph{et al.} proposed ``Flamingo", a multi-round single server secure aggregation scheme that does not require an initialization setup phase for each training round (a single setup phase is sufficient). 
However, Flamingo cannot handle a dynamic environment where the users should be able to join the training session dynamically. Flamingo requires to know the participating users before the training starts. Moreover, Flamingo can tolerate up to one-third of corrupted users, which includes both regular and \emph{decryptor} users, among the total users. In ____, Wang \emph{et al.} proposed a single mask scheme based on the Decisional Composite Residuosity (DCR) assumption and used non-interactive zero-knowledge (NIZK) proofs to achieve result verification. However, it uses computationally expensive bilinear pairing operations. 
In ____, Yang \emph{et al.} proposed a single mask secure aggregation scheme for FL by combining the concepts of homomorphic Pseudorandom Generator, homomorphic Shamir secret sharing, and Paillier encryption. However, it can only tolerate $50\%$ of the user dropouts. In ____, Khojir \emph{et al.} introduced a secure aggregation scheme based on additive secret sharing. The scheme utilizes a three-layered architecture (i.e., clients, middle servers, and lead server), which reduces communication costs for users compared to other schemes that rely on masking processes using secret sharing, which requires distributing secret shares among users, such as those in ____. However, it is unable to handle user dropouts, which is essential for real-world applications.
\par 

Table \ref{table:fun-com-commu-comparison} compares the computation and communication overhead, security, and functionality of our scheme against notable works in masking-based secure aggregation, including SecAgg ____, SecAgg+ ____, FastSecAgg ____, EDRAgg ____, and Flamingo ____. Our scheme offers better performance in both communication and computation costs at the user and aggregator sides. While our approach introduces intermediate servers to achieve enhanced security and functionality, this addition does not negatively impact the system's overall performance or accuracy. In fact, these intermediate servers reduce the computational and communication burden on users, which will be further elaborated in the upcoming sections. 
Regarding security, our scheme supports a malicious threat model, just like SecAgg ____, SecAgg+ ____, EDRAgg ____, and Flamingo ____, which is a stronger security assumption compared to the semi-honest model. Additionally, our scheme demonstrates strong resilience to user dropouts, tolerating up to $m-2$ user dropouts, which is higher than many existing schemes. Like Flamingo ____, our scheme only requires one setup phase for the entire training session, significantly reducing communication overhead for users.
Furthermore, both our scheme and Flamingo are capable of detecting model inconsistency attacks through model parameter verification techniques. Another benefit is that our scheme involves only two communication rounds between the user and the aggregator per training round, further minimizing communication costs compared to other methods.


%shows a computation overhead, communication overhead, security, and functionality comparison between our scheme and some of the notable closely related works in the masking-based secure aggregation area such as SecAgg ____, SecAgg+ ____, TurboAgg ____, FastSecAgg ____, EDRAgg ____, and Flamingo$^*$ ____. We can see that our scheme provides better performance in terms of communication and computation costs at the user and aggregator sides. Although, unlike other schemes, ours requires the intermediate servers to achieve our desired security and functionality, it does not impact the overall performance and accuracy of the system. On the contrary, this new set of servers helps our scheme to reduce both communication and computation overhead on the user side which we will see in the  upcoming sections. In terms of the supporting threat model, our scheme as well as SecAgg ____, SecAgg+ ____, EDRAgg ____, and Flamingo$^*$ ____ support malicious environment which is a stronger security assumption than semi-honest model. Our scheme is highly resilient to user dropouts compared to the other schemes and can tolerate up to $m-2$ user dropouts. Unlike others, our scheme and Flamingo ____ require only one setup phase in the whole training session which drastically reduces communication overhead at the user side. Further, our scheme and Flamingo can also detect model inconsistency attack using model parameter verification technique. Moreover, our scheme only takes two rounds of communication between the user and the aggregator unlike others in each training round. This also reduces communication overhead in our scheme as compared to the others.