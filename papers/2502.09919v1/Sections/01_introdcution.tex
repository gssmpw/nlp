\section{Introduction}
According to the World Health Organization~\cite{abdul2020epidemiology}, the prevalence of type 2 diabetes has increased significantly over the last decades. In 2022, 14\% of adults aged 18 years and older were living with diabetes, double the 7\% reported in 1990~\cite{WHO2024Diabetes}. This increase is attributed to various factors such as sedentary lifestyles, stress, poor diet, and an aging population~\cite{raffin2023sedentary}. As a result, type 2 diabetes poses a significant public health challenge that requires urgent attention and intervention. Poor management of type 2 diabetes can lead to the progression of chronic health complications and an increased risk of both hyperglycemic and hypoglycemic events. Effectively managing blood glucose levels through consistent monitoring and accurate forecasting is crucial as early intervention measures to prevent hyperglycemic and hypoglycemic events. Accurate glucose prediction is essential for optimizing insulin dosages, meal planning, and exercise habits to maintain blood glucose levels within a safe range.\looseness=-1

% According to the World Health Organization Type 2 diabetes is becoming more common around the world, with more and more people being affected. This rise is attributed to various factors such as sedentary lifestyles, poor diets, and an aging population. As a result, type 2 diabetes poses a significant public health challenge that requires urgent attention and intervention. Poor management of type 2 diabetes leads to the progression of chronic health complications and increases the risk of both hyperglycemic and hypoglycemic events. Proper control, including the monitoring and prediction of blood glucose levels, is crucial to reducing these risks and improving patient outcomes.

% Continuous glucose monitoring (CGM) devices have been developed as an advanced technology to support diabetes management. These devices provide real-time glucose readings, allowing patients to monitor fluctuations and trends in their blood glucose levels more effectively. The use of CGM devices has grown significantly in recent years, making them a widely adopted tool for diabetes management. By collecting continuous glucose signals, CGM devices provide valuable insights into blood glucose fluctuations. When combined with other physiological and behavioral variables, such as physical activity levels (e.g., walking or running) and stress level, these signals can be used to forecast and regulate blood glucose levels. This integration of data enables a more comprehensive and personalized approach to managing type 2 diabetes.


CGM devices have been developed as an advanced technology to support diabetes management. CGM devices provide valuable insights into blood glucose fluctuations by collecting continuous glucose signals. The CGM data allows patients to monitor fluctuations and trends in their blood glucose levels more effectively by providing real-time blood glucose level measurements. Thus, CGM devices have grown significantly in recent years, making them a widely adopted tool for diabetes prevention. Furthermore, physiological and behavioral variables, such as physical activity levels (e.g., walking or running) and stress levels, affect blood glucose fluctuation~\cite{shuvo2023deep}. Therefore, the accurate forecasting of blood glucose levels can be evaluated by combining BGL signals with other physiological and behavioral variables. This data integration enables a more comprehensive and personalized approach to managing diabetes, especially for individuals with type 2 diabetes.

Recently, artificial intelligence (AI) and machine learning algorithms have played a critical role in the control and prediction of blood glucose levels. These advanced technologies leverage data from CGM devices and integrate with physiological signals, such as stress levels, heart rate, and physical activity signals. By analyzing these complex datasets, the algorithms can identify trends and patterns in blood glucose fluctuations with high accuracy.\looseness=-1

% This predictive capability allows for early detection of potential hyperglycemic or hypoglycemic events.

Sequential machine learning models, notably Long Short-Term Memory (LSTM) networks and Gated Recurrent Units (GRUs)~\cite{chung2014empirical}, are extensively employed in forecasting time-series signals due to their ability to capture temporal dependencies. GRU-based models outperform traditional methods in univariate time-series classification tasks\cite{Elsayed_2019}. Moreover, these models are highly effective for time-series forecasting when optimized with suitable algorithms~\cite{makinde2024optimizingtimeseriesforecasting}. These models have also been extensively applied in predicting Type 1 diabetes outcomes~\cite{patil2024modeling}. However, they often struggle to capture long-term dependencies inherent in time-series data, which in turn limits their effectiveness in long-term forecasting~\cite{kim2024comprehensive}. Research indicates that while LSTMs are designed to manage longer sequential correlations compared to traditional RNNs, they still encounter challenges in memorizing extended sequences~\cite{kong2024unlocking}.\looseness=-1

Recently, transformers have emerged as a powerful model for capturing long-term dependencies in time-series data, primarily through the use of attention mechanisms. Unlike traditional models, which have limited memory and struggle with long-term dependencies, transformers leverage attention mechanisms to effectively capture these dependencies~\cite{kong2024unlocking}.  The attention mechanism within transformers allows the model to weigh the importance of different time steps, which enables them to focus on relevant parts of the sequence when making predictions~\cite{vaswani2017attention}. This capability is particularly beneficial in applications such as forecasting BGL in type 2 diabetes, where understanding long-range temporal relationships is crucial. Moreover, transformers are well-suited for handling time-series data collected at varying sampling rates. Traditional models often face challenges when dealing with such data due to inconsistencies in temporal resolution. Transformers, however, can manage these variations effectively~\cite{chen2024pathformer, zhang2024multi}.\looseness=-1

\textbf{Key Limitations and Associated Challenges:} We highlight the key limitations of state-of-the-art work and present the associated challenges of blood glucose prediction here.
\begin{itemize}
    \item Difficulty in achieving accurate long-term blood glucose forecasting.\looseness=-1
    \item Mismatched temporal resolutions in data sources (e.g., CGM readings, physiological, and behavioral variables).\looseness=-1
    \item Limited clinical datasets, especially for populations with type 2 diabetes.

\end{itemize}

To address these challenges, \textit{a novel accurate forecasting algorithm for long-term prediction is required for individuals with type 2 diabetes.} In this paper, an accurate forecasting model using a Transformer architecture is proposed. The Transformer model is made up of a combination of two attention mechanisms (e.g., cross-attention and multi-scale attention). Cross-attention captures long-term dependencies in temporal data and handles the various temporal resolutions in data sources.  The multi-scale attention captures the influence of external time series variables (e.g., physiological signals, behavioral data) on blood glucose levels. Furthermore, to the best of our knowledge, our work is the first to investigate the problem of blood glucose forecasting on AI-READI dataset~\cite{AIREADI2024,AIREADI20242}. The following list summarizes the novel contributions of our work.

\begin{itemize}
    \item \textbf{We propose a Transformer-based architecture with the new attention layers} to forecast blood glucose levels accurately, especially for long-term forecasting.
    \item \textbf{We developed a hybrid attention mechanism of cross-attention and multi-scale attention} to forecast blood glucose levels.
    \item \textbf{We used various body variables}, such as activity along with BGL to enhance BGL prediction precision.
    \item \textbf{We applied our proposed forecasting blood glucose model on the Flagship AI-READI dataset} for patients with type 2 diabetes.
    \item \textbf{We performed multiple experiments} to evaluate the modelâ€™s accuracy across different subject cohorts and analyze both its performance gains and forgetting behavior as new cohorts were introduced.

\end{itemize}



% \color{red}
% \begin{itemize}

    % \item Patients with type 2 diabetes are increased all over the world
    % \item Poor control of patients with type 2 diabetes causes chronic disease and hyperglycemia or hypoglycemia events.
    % \item Patients with type 2 diabetes need to control and forecast their blood glucose levels to prevent these events.
    
    % \item The technology is developed, and CGM devices are produced. 
    % \item Using CGM devices is increased. It is available over the counter in the pharmacies. The signals collected by these devices can be used with relevant body variables such as activity (walking, running) and stress, ... to forecast and control the subjects' BGL. 
    
    % \item AI and Machine learning algorithms are the key roles in controlling and forecasting blood glucose levels.
    % \item By incorporating the body variable signals such as stress, heart rate, and ... and collected blood glucose level signals, the algorithms can effectively predict fluctuations in BGL.
    % \item Sequential models, such as GRUs and LSTMs, are the most-widely used networks in forecasting blood glucose levels in patients with type-I diabetes. 
    % \item However, they are not able to extract the long-term dependencies features that are used for predicting long-term forecasting.
    % \item Transformer is a model that can extract the long-time dependence feature from time series data by using attention mechanisms.
    % \item Moreover, transformers are the most appropriate models to use while working with signals collected at different sample rates.  
% \end{itemize}
% \color{black}



