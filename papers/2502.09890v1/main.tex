 \documentclass{article} % For LaTeX2e


\usepackage{iclr2025_delta,times}



% Optional math commands from https://github.com/goodfeli/dlbook_notation.
% \input{math_commands.tex}



\usepackage{colortbl}
\usepackage{pifont}

% \usepackage{caption}
\usepackage{caption}
\usepackage{subcaption}
% \usepackage{subfigure}

\usepackage{booktabs, multirow} 
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage[hidelinks]{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors
\usepackage{soul}% for underlines
\usepackage{xcolor,colortbl} % for cell colors
\usepackage{changepage,threeparttable} % for wide tables
\usepackage{tabularx}
% \definecolor{rank1}{HTML}{3288BD}
\definecolor{rank1}{HTML}{e07a5f}
% \definecolor{rank2}{HTML}{66C2A5}
\definecolor{rank2}{HTML}{eab69f}
% \definecolor{rank3}{HTML}{ABDDA4}
\definecolor{rank3}{HTML}{f4f1de}
\definecolor{rank4}{HTML}{FFD43B}
\definecolor{rank5}{HTML}{FF7F00}
\definecolor{rank6}{HTML}{E41A1C}

% \usepackage{algorithm}
% \usepackage{algorithmic}


\newcommand{\Authornote}[3]{{\sffamily\small\color{#1}{[#2: #3]}}}
\newcommand{\mathias}{\Authornote{teal}{Mathias}}
\newcommand{\anji}{\Authornote{orange}{Anji}}
\newcommand{\guy}{\Authornote{blue}{Guy}}
\newcommand{\vinh}{\Authornote{red}{Vinh}}
\newcommand{\dung}{\Authornote{blue}{Dung}}

\usepackage{algorithm}
\usepackage{algorithmic} % Required for algorithmic environment
% \usepackage{algpseudocode} % Required for algorithmic environment

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{multirow}
\usepackage{wrapfig}


\usepackage{listings}

\lstset{
  basicstyle=\ttfamily\small,
  keywordstyle=\color{blue}\bfseries,
  commentstyle=\color{gray},
  stringstyle=\color{red},
  language=Python,
  showstringspaces=false,
  frame=single,
  numbers=left,
  numberstyle=\tiny\color{gray},
  breaklines=true,  % Automatically break long lines
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space}  % Indicate line break
}



\usepackage{pgfplots}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage[capitalize,noabbrev]{cleveref}

\usepackage{bm}
\usepackage{bbm}

\usepackage{tabu}

\newcommand{\bxi}{\bm{\xi}}

\newcommand{\ba}{\bm{a}}
\newcommand{\bbb}{\bm{b}}

\usepackage{xcolor}

\newcolumntype{H}{>{\setbox0=\hbox\bgroup}c<{\egroup}@{}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{fact}{Fact}
\newtheorem{lemma}{Lemma}
\newtheorem{example}{Example}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
\newtheorem{assumption}{Assumption}

\usepackage{tcolorbox}
\tcbuselibrary{theorems}

\newcolumntype{R}{>{}r<{}}
\newcolumntype{L}{>{}l<{}}
\newcolumntype{M}{R@{}L}

%\newtcbtheorem[number within=section]{mytheo}{My Theorem}%
%{colback=grey!5,colframe=black!35!black}{th}

\definecolor{ourspecialtextcolor}{rgb}{0.528, 0.471, 0.701} % also used for comments in code


\newcommand{\vardbtilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{$\tilde{#1}$}}}

\newcommand{\mcrot}[4]{\multicolumn{#1}{#2}{\rlap{\rotatebox{#3}{#4}}}}

\newcommand{\cmark}{{\ding{51}}} % Blue Checkmark
\newcommand{\xmark}{{\ding{55}}} % Orange Cross
\newcommand{\slow}{{Slow}} % Gray for Slow
\newcommand{\fast}{{Fast}} % Light Blue for Fast




\usepackage{mystyles}

\title{Symmetry-Preserving Diffusion Models via Target Symmetrization}

% Authors must not appear in the submitted version. They should be hidden
% as long as the \iclrfinalcopy macro remains commented out below.
% Non-anonymous submissions will be rejected without review.


\author{Vinh Tong$^{1,2}$
~{Yun Ye}$^{1}$, ~{Trung-Dung Hoang}$^{4}$, ~Anji Liu$^{1,3}$, ~{Guy Van den Broeck}$^{3}$, ~{Mathias Niepert}$^{1,2}$
\\\\
$^{1}$University of Stuttgart, $^{2}$IMPRS-IS,
$^{3}$UCLA,
$^{4}$University of Bern \\
\texttt{vinh.tong@ki.uni-stuttgart.de}
}


% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to \LaTeX{} to determine where to break
% the lines. Using \AND forces a linebreak at that point. So, if \LaTeX{}
% puts 3 of 4 authors names on the first line, and the last on the second
% line, try using \AND instead of \And before the third author name.
\usepackage[hypcap=true]{caption}
\newcommand{\fix}{\marginpar{FIX}}
\newcommand{\new}{\marginpar{NEW}}

% Define a new command for colored citations
\newcommand{\citepcolor}[1]{\textcolor{blue}{\citep{#1}}}
\newcommand{\citecolor}[1]{\textcolor{blue}{\cite{#1}}}


\iclrfinalcopy % Uncomment for camera-ready version, but NOT for submission.

\pgfplotsset{compat=1.18}

\begin{document}


\maketitle




\begin{abstract}
Diffusion models are powerful tools for capturing complex distributions, but modeling data with inherent symmetries, such as molecular structures, remains challenging. Equivariant denoisers are commonly used to address this, but they introduce architectural complexity and optimization challenges, including noisy gradients and convergence issues. We propose a novel approach that enforces equivariance through a symmetrized loss function, which applies a time-dependent weighted averaging operation over group actions to the model's prediction target. This ensures equivariance without explicit architectural constraints and reduces gradient variance, leading to more stable and efficient optimization. Our method uses Monte Carlo sampling to estimate the average, incurring minimal computational overhead. We provide theoretical guarantees of equivariance for the minimizer of our loss function and demonstrate its effectiveness on synthetic datasets and the molecular conformation generation task using the GEOM-QM9 dataset. Experiments show improved sample quality compared to existing methods, highlighting the potential of our approach to enhance the scalability and practicality of equivariant diffusion models in generative tasks.

\end{abstract}

\input{DELTA_sections/introduction}
% \input{GEM_sections/related_work}
\input{DELTA_sections/background}
\input{DELTA_sections/methodology}
\input{DELTA_sections/experiment}
% \input{GEM_sections/discussion}
\input{DELTA_sections/conclusion}

\clearpage

% \bibliographystyle{plain}
% \bibliography{main_arxiv}

\bibliography{iclr2025_conference}
\bibliographystyle{iclr2025_conference}

\appendix


\include{DELTA_sections/appendix}




\end{document}
