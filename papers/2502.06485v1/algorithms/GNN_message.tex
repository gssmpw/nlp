\begin{algorithm}[tb]
   \caption{GNN message, $M_l(\rvw_i, \rvw_j)$ in \Cref{eq:mpnn}}
   \label{algo:gnn_message}
   \hspace*{\algorithmicindent} \textbf{Input:} Node features $\rvw_i, \rvw_j$ \\
   \hspace*{\algorithmicindent} \textbf{Output:} Message $\mathbf{m}_{i,j} = M(\rvw_i, \rvw_j)$
\begin{algorithmic}
\STATE $\rvv_{i,j}\gets \text{cat}(\rvw_i, \rvw_j)$
\STATE $a_{i,j} \gets \MLP_{\theta}(\rvv_{i,j})$ \COMMENT{Scalar}
\STATE $a_{i,j} \gets \text{softmax}_{j}(a_{i,j})$ \COMMENT{Will depend on other features, so cannot do this before computing $a_{i, j}$ for all $j$}
\STATE $\rvm_{i,j} \gets a_{i,j} \MLP_\phi(\rvw_j)$
\RETURN $\mathbf{m}_{i,j}$
\end{algorithmic}
\end{algorithm}
