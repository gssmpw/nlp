\begin{figure*}
\begin{center}
\vspace{-0.1in}
\begin{tikzpicture}

    \begin{scope}[scale=0.55, local bounding box=xtgraph]
    \tikzset{every node/.style={circle, draw, inner sep=2pt, minimum size=1cm, scale=0.55
    }}
    \node[fill=MidnightBlue] (A) at (0, 1.5) {\textcolor{white}{62-4a}};
    \node[fill=MidnightBlue] (B) at (2.5, 1.5) {\textcolor{white}{62-4b}};
    \node[fill=MidnightBlue!20] (C) at (0, -1.5) {62-4c};
    \node[fill=MidnightBlue!20] (D) at (2.5, -1.5) {62-8d};
    \draw (A) -- (B);
    \draw (A) -- (C);
    \draw (A) -- (D);
    \draw (B) -- (C);
    \draw (B) -- (D);
    \draw (C) -- (D);
    
    \node[anchor=south east, opacity=0.0, text opacity=1] at (A.west) {$
    \kbordermatrix{
       &  \varnothing & \text{H} & \hdots & \text{Fm} \\
       &  1            & 0        & \hdots & 0
  }
  $};
    \node[anchor=south west, opacity=0.0, text opacity=1] at (B.east) {$
    \kbordermatrix{
       &  \varnothing & \text{H} & \hdots & \text{Fm} \\
       &  1            & 0        & \hdots & 0
  }
  $};
    \node[anchor=east, opacity=0.0, text opacity=1] at (C.west) {$
    \kbordermatrix{
              & 0 & 1 & 2 & \hdots & \\
    \vdots & \vdots & \vdots & \vdots & \vdots & \hdots \\
    \text{Cs} & 1 & 0 & 0 &  \hdots & 0 \\
    \text{Nd} & 0 & 1 & 0 & \hdots & 0\\
    \text{Mo} & 0 & 0 & 1 & \hdots &  0\\
    \text{O}  & 0 & 0 & 0 &  \hdots & 0 \\
    \vdots & \vdots & \vdots & \vdots & \vdots & \hdots
  }
    $};
    \node[anchor=west, opacity=0.0, text opacity=1] at (D.east) {$
    \kbordermatrix{
              & 0 & 1 & 2 & \hdots & P \\
    \vdots & \vdots & \vdots & \vdots & \vdots &  \hdots \\
    \text{Cs} & 1 & 0 & 0 & 0 \hdots & 0 \\
    \text{Nd} & 0 & 1 & 0 & 0 \hdots & 0 \\
    \text{Mo} & 1 & 0 & 0 & 0 \hdots & 0 \\
    \text{O}  & 0 & 0 & 0 & 1 \hdots  & 0\\
    \vdots & \vdots & \vdots & \vdots & \vdots &\ \hdots \\
  }
    $};

    \end{scope}

    \begin{scope}[local bounding box=xttext, shift={($(xtgraph.north) + (0,-0.5)$)}, anchor=south, scope anchor]
            \node[] () at (0,0) {$\xt$};
    \end{scope}


    \begin{scope}[scale=0.55, local bounding box=x0predgraph, shift={($(xtgraph.east) + (0,0.05)$)}, anchor=west, scope anchor]
    \tikzset{every node/.style={circle, draw, inner sep=2pt, minimum size=1cm, scale=0.55
    }}
    \node[fill=MidnightBlue] (A) at (0, 1.5) {\textcolor{white}{62-4a}};
    \node[fill=MidnightBlue] (B) at (2.5, 1.5) {\textcolor{white}{62-4b}};
    \node[fill=MidnightBlue!20] (C) at (0, -1.5) {62-4c};
    \node[fill=MidnightBlue!20] (D) at (2.5, -1.5) {62-8d};
    \draw (A) -- (B);
    \draw (A) -- (C);
    \draw (A) -- (D);
    \draw (B) -- (C);
    \draw (B) -- (D);
    \draw (C) -- (D);
    
    \node[anchor=south east, opacity=0.0, text opacity=1] at (A.west) {$
    \kbordermatrix{
       &  \varnothing & \text{H} & \hdots & \text{Fm} \\
       &  0.4            & 0.1        & \hdots & 0.0
  }
  $};
    \node[anchor=south west, opacity=0.0, text opacity=1] at (B.east) {$
    \kbordermatrix{
       &  \varnothing & \text{H} & \hdots & \text{Fm} \\
       &  0.2            & 0.05        & \hdots & 0.0
  }
  $};
    \node[anchor=east, opacity=0.0, text opacity=1] at (C.west) {$
    \kbordermatrix{
              & 0 & 1 & 2 & \hdots & P \\
    \vdots & \vdots & \vdots & \vdots & \vdots & \hdots \\
    \text{Cs} & 0.01 & 0.3 & 0. & \hdots & 0.0 \\
    \text{Nd} & 0.05 & 0.2 & 0.02 & \hdots & 0.0 \\
    \text{Mo} & 0.12 & 0.1 & 0.1 & \hdots & 0 \\
    \text{O}  & 0.07 & 0 & 0.2 & \hdots & 0.1 \\
    \vdots & \vdots & \vdots & \vdots & \vdots & \hdots \\
  }
    $};
    \node[anchor=west, opacity=0.0, text opacity=1] at (D.east) {$
    \kbordermatrix{
              & 0 & 1 & 2 & \hdots & P \\
    \vdots & \vdots & \vdots & \vdots & \vdots &  \hdots \\
    \text{Cs} & 0.33 & 0 & 0.2 & \hdots & 0 \\
    \text{Nd} & 0.1 & 0.4 & 0  &  \hdots & 0\\
    \text{Mo} & 0.5 & 0.2 & 0.05 & \hdots& 0.01 \\
    \text{O}  & 0.1 & 0.1 & 0.15 & \hdots& 0 \\
    \vdots & \vdots & \vdots & \vdots & \vdots &\ \hdots \\
  }
    $};
    
    \end{scope}

    \begin{scope}[local bounding box=x0predtext, shift={($(x0predgraph.center|-xttext.center) + (0.0,0.0)$)}, anchor=center, scope anchor]
            \node[] () at (0,0) {$\ptheta(\x_0|\xt)$};
    \end{scope}
\end{tikzpicture}
\end{center}
\vspace{-0.5in}
\caption{Illustration of the (graph) representation of a material used in our generative model. A material of space group 62 has four Wyckoff Positions (a, b, c, d). Two of them (a and b, dark blue) has the constraint that at most one atom can occupy the position, and we hence model that as a single variable indicating which atom type that occupies the corresponding position ($\varnothing$ denoting no atom). For the other two positions (c and d, light blue), any number of atoms can occupy the position, and we hence model this as a set of variables, one for each atom type, which indicates how many of the respective atom types that are occupying the position. To the left is the state of the material at some sampling time $t$, and to the right is the prediction of the ``clean'' material $\x_0$ made by the neural network. For all variables, there is a corresponding row in the figure, corresponding to probability vectors, and all rows hence sum to 1.}
\label{fig:graph_repr}
\end{figure*}
