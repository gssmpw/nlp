%Version 3 October 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove “Numbered” in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst%  
 
% \documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
\documentclass[sn-mathphys-num]{sn-jnl}% Math and Physical Sciences Numbered Reference Style 
%%\documentclass[sn-mathphys-ay]{sn-jnl}% Math and Physical Sciences Author Year Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style

%%%% Standard Packages
%%<additional latex packages if required can be included here>

\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage[title]{appendix}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{algorithm}%
\usepackage{algorithmicx}%
\usepackage{algpseudocode}%
\usepackage{listings}%
%\usepackage{lineno} % Include the lineno package

\usepackage{siunitx} % for SI
%%%%

%%%%%=============================================================================%%%%
%%%%  Remarks: This template is provided to aid authors with the preparation
%%%%  of original research articles intended for submission to journals published 
%%%%  by Springer Nature. The guidance has been prepared in partnership with 
%%%%  production teams to conform to Springer Nature technical requirements. 
%%%%  Editorial and presentation requirements differ among journal portfolios and 
%%%%  research disciplines. You may find sections in this template are irrelevant 
%%%%  to your work and are empowered to omit any such section if allowed by the 
%%%%  journal you intend to submit to. The submission guidelines and policies 
%%%%  of the journal take precedence. A detailed User Manual is available in the 
%%%%  template package for technical guidance.
%%%%%=============================================================================%%%%

%% as per the requirement new theorem styles can be included as shown below
\theoremstyle{thmstyleone}%
\newtheorem{theorem}{Theorem}%  meant for continuous numbers
%%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
%% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
\newtheorem{proposition}[theorem]{Proposition}% 
%%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

\theoremstyle{thmstyletwo}%
\newtheorem{example}{Example}%
\newtheorem{remark}{Remark}%

\theoremstyle{thmstylethree}%
\newtheorem{definition}{Definition}%

\raggedbottom
%%\unnumbered% uncomment this for unnumbered level heads

\begin{document}

\title[Article Title]{SparseFocus: Learning-based One-shot Autofocus for Microscopy with Sparse Content}

%%=============================================================%%
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% \author*[1,2]{\fnm{Joergen W.} \spfx{van der} \sur{Ploeg} 
%%  \sfx{IV}}\email{iauthor@gmail.com}
%%=============================================================%%


% 匿名投稿
% ------------------------------
\author*[1]{\fnm{Yongping} \sur{Zhai}}\email{zhaiyongping08@nudt.edu.cn}
\equalcont{These authors contributed equally to this work.}

\author[1]{\fnm{Xiaoxi} \sur{Fu}}
\equalcont{These authors contributed equally to this work.}

\author[1]{\fnm{Qiang} \sur{Su}}
\equalcont{These authors contributed equally to this work.}

\author[1]{\fnm{Jia} \sur{Hu}}

\author[1]{\fnm{Yake} \sur{Zhang}}

\author[1]{\fnm{Yunfeng} \sur{Zhou}}

\author[1]{\fnm{Chaofan} \sur{Zhang}}

\author[1]{\fnm{Xiao} \sur{Li}}

\author[1]{\fnm{Wenxin} \sur{Wang}}

% Department of Information, Daping Hospital, Army Medical University, Chongqing 400042, China, wudd01@tmmu.edu.cn
\author*[2]{\fnm{Dongdong} \sur{Wu}}\email{wudd01@tmmu.edu.cn}

\author*[3]{\fnm{Shen} \sur{Yan}}\email{yanshen12@nudt.edu.cn}

\affil[1]{\orgdiv{College of Advanced Interdisciplinary Studies}, \orgname{National University of Defense Technology}, \orgaddress{\city{Changsha}, \postcode{410073}, \state{Hunan}, \country{China}}}

\affil[2]{\orgdiv{Department of Information}, \orgname{Army Medical University}, \orgaddress{\city{Chongqing}, \postcode{400042}, \state{Chongqing}, \country{China}}}

\affil[3]{\orgdiv{College of System Engineering}, \orgname{National University of Defense Technology}, \orgaddress{\city{Changsha}, \postcode{410073}, \state{Hunan}, \country{China}}}
% ----------------------------
% \author{Anonymous Author(s)}

\abstract{Autofocus is necessary for high-throughput and real-time scanning in microscopic imaging. Traditional methods rely on complex hardware or iterative hill-climbing algorithms. Recent learning-based approaches have demonstrated remarkable efficacy in a one-shot setting, avoiding hardware modifications or iterative mechanical lens adjustments. 
However, in this paper, we highlight a significant challenge that the richness of image content can significantly affect autofocus performance. When the image content is sparse, previous autofocus methods, whether traditional climbing-hill or learning-based, tend to fail. 
To tackle this, we propose a content-importance-based solution, named SparseFocus, featuring a novel two-stage pipeline. The first stage measures the importance of regions within the image, while the second stage calculates the defocus distance from selected important regions. To validate our approach and benefit the research community, we collect a large-scale dataset comprising millions of labelled defocused images, encompassing both dense, sparse and extremely sparse scenarios. Experimental results show that SparseFocus surpasses existing methods, effectively handling all levels of content sparsity. Moreover, we integrate SparseFocus into our Whole Slide Imaging (WSI) system that performs well in real-world applications. The code and dataset will be made available upon the publication of this paper.}


\keywords{Autofocus, Whole Slide Imaging, One-shot Autofocus, Learning-based Autofocus, Autofocus with sparse content, Autofocus for Microscopy}

\maketitle

\input{secs/introduction}
\input{secs/results}
\input{secs/discussions}
\input{secs/methods}
\input{secs/conclusion}

\bmhead{Data availability}
The datasets captured and analyzed during the current study are available from the corresponding author on request.

\bmhead{Code availability}
The code supporting the findings of this study is available from the corresponding author upon request.

% \bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
\input{sn-article.bbl}

% 匿名投稿
% -------------------------------------
\bmhead{Acknowledgements}
This study is supported by the Independent Innovation Science Fund of National University of Defense Technology (NO.22-ZZCX-064) and the National Natural Science Foundation of China (No. 62406331).

\bmhead{Author contributions}
Y.-P.Z. conceived the idea, contributed to writing the manuscript, conducted experiments, and developed the WSI system. Q.S. performed experiments, wrote code, analyzed data, and prepared figures. X.-X.F. contributed to code writing, data analysis, and figure drawing. J.H., Y.-K.Z., and Y.-F.Z. were involved in data analysis. C.-F.Z., X.L., and W.-X.W. participated in discussions. D.-D.W. prepared and provided the microscope slide samples. S.Y. contributed to writing, discussions, and data analysis.

\bmhead{Materials \& Correspondence}
Correspondence and requests for materials should be addressed to Yongping Zhai.
% ---------------------------


\bmhead{Competing interests}
The authors declare no competing interests.

\end{document}
