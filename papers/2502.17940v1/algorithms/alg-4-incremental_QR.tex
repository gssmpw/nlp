
\begin{algorithm}[t]
    \caption{IncDec: Incremental Decomposition}
    \label{alg:ID}
    \DontPrintSemicolon
    \KwInput{\(\boldsymbol{Q}\in \mathbb{R}^{d\times l}\), \(\boldsymbol{R}\in \mathbb{R}^{l\times l}\), and \(\boldsymbol{x}\in \mathbb{R}^d\)}
    \KwOutput{\(\boldsymbol{Q}'\in \mathbb{R}^{d\times (l+1)}\), \(\boldsymbol{R}'\in \mathbb{R}^{(l+1)\times (l+1)}\)}
    
    \(
    \boldsymbol{x}' \leftarrow \boldsymbol{x} - \sum_{i=1}^l \langle \boldsymbol{q}_i,\boldsymbol{x} \rangle\, \boldsymbol{q}_i.
    \)
    
    \tcp{\small It is easy to verify that vector $\boldsymbol{x}'/\left\| \boldsymbol{x}'\right\|$ is a unit vector orthogonal to every column vector of $\boldsymbol{Q}$}
    % The vector \(\boldsymbol{x}'/\|\boldsymbol{x}'\|_2\) is unit norm and orthogonal to every column of \(\boldsymbol{Q}\).
    
    
    \(
    \boldsymbol{v} \leftarrow \Bigl(\langle \boldsymbol{q}_1,\boldsymbol{x} \rangle,\, \langle \boldsymbol{q}_2,\boldsymbol{x} \rangle,\, \cdots,\, \langle \boldsymbol{q}_l,\boldsymbol{x} \rangle\Bigr)^T.
    \)
    
    
    \(
    \boldsymbol{Q}' \leftarrow \begin{bmatrix}
        \boldsymbol{Q} & \boldsymbol{x}'/\|\boldsymbol{x}'\|_2
    \end{bmatrix}.
    \)
    

    \(
    \boldsymbol{R}' \leftarrow \begin{bmatrix}
        \boldsymbol{R} & \boldsymbol{v} \\
        \boldsymbol{0} & \|\boldsymbol{x}'\|_2
    \end{bmatrix}.
    \)
    
    \Return \(\boldsymbol{Q}', \boldsymbol{R}'\).
\end{algorithm}