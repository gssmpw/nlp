\begin{algorithm}[t]
    \caption{Co-Occurring Directions (COD)}
    \label{alg:cod}
    \DontPrintSemicolon
    \KwInput{$\boldsymbol{X}\in \mathbb{R}^{d_x\times n}$, $\boldsymbol{Y}\in \mathbb{R}^{d_y\times n}$ and sketch size $l$}
    \KwOutput{$\boldsymbol{A}\in \mathbb{R}^{d_x\times l}$ and $\boldsymbol{B}\in \mathbb{R}^{d_y\times l}$}

    Initialize $\boldsymbol{A} \leftarrow 0^{d_x\times l},\ \boldsymbol{B} \leftarrow 0^{d_y\times l}$\;
    
    \For{$i = 1 \sim n$}{
        Insert $\boldsymbol{x}_i$ into a zero valued column of $\boldsymbol{A}$
        
        Insert $\boldsymbol{y}_i$ into a zero valued column of $\boldsymbol{B}$
        
        \If{$\boldsymbol{A}$ or $\boldsymbol{B}$ has no zero valued columns}
        {
            $(\boldsymbol{Q}_x, \boldsymbol{R}_x) \leftarrow QR(\boldsymbol{A})$

            $(\boldsymbol{Q}_y, \boldsymbol{R}_y) \leftarrow QR(\boldsymbol{B})$

            $[\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}] \leftarrow SVD(\boldsymbol{R}_x\boldsymbol{R}_y^T)$

            $\delta \leftarrow \sigma_{l/2}(\boldsymbol{\Sigma})$

            $\hat{\boldsymbol{\Sigma}} = max(\boldsymbol{\Sigma} - \delta \boldsymbol{I}_l, 0)$

            $\boldsymbol{A} \leftarrow \boldsymbol{Q}_x\boldsymbol{U}\sqrt{\hat{\boldsymbol{\Sigma}}}$
            
            $\boldsymbol{B} \leftarrow \boldsymbol{Q}_y\boldsymbol{V}\sqrt{\hat{\boldsymbol{\Sigma}}}$
        }
    }

    \Return $\boldsymbol{A},\boldsymbol{B}$
    
\end{algorithm}