

In this section, we shall provide theoretical guarantees for the following general stochastic FW template with
momentum:
\begin{itemize}
    \item [Step 1] Compute the weighted average:
    \begin{equation*}
        \bar{x}_{t}=\frac{\sum_{j=1}^{t}b_{j}x_{j}}{\sum_{j=1}^{t}b_{j}}
    \end{equation*}
    where $b_{t}$ is some positive numerical sequence.
    \item [Step 2]
    Compute the following convex combination:
    \begin{equation*}
        y_{t}= \beta_{t}\bar{x}_{t}+(1-\beta_{t})x_{t}
    \end{equation*}
    with $\beta_{t}\in [0,1]$.
    \item [Step 3] Compute:
    \begin{equation*}
        d_{t}=(1-\rho_{t})d_{t-1}+\rho_{t}\nabla f(y_{t};\zeta_{t})
    \end{equation*}
    \item [Step 4] Update the algorithm by computing:
    \begin{equation*}
        x_{t+1}=(1-\gamma_{t})x_{t}+\gamma_{t}\lmo(d_{t}) 
    \end{equation*}
    with $\gamma_{t}\in [0,1]$ and $a_{t}$ a positive numerical sequence.
\end{itemize}
We start by providing a three point version of the so-called \emph{descent inequality}. More precisely, we have:

\begin{lemma}
\label{lem:descent}
Assume that $f$ is convex and $\|\cdot\|$- Lipschitz smooth. Then, the following inequality holds:
\begin{equation}
    f(x)\leq f(y)+\langle \nabla f(z),x-y\rangle+\frac{L}{2}\|x-z\|^{2}
\end{equation}
for all $x,y,z$
\end{lemma}

\begin{proof}
By the smoothness of $f$ we have that:
\begin{equation}
    f(x)\leq f(z)+\langle \nabla f(z),x-y\rangle+\frac{L}{2}\|x-z\|^{2}
\end{equation}
Moreover, by invoking convexity we have:
\begin{equation}
 0\leq f(y)-f(z)-\langle \nabla f(z),y-z\rangle   
\end{equation}
The desired inequality is directly obtained by adding the above.
\end{proof}

Based on the above inequality we shall the main template inequality of our method.

\begin{prop}
Assume that f is convex and smooth. Then, the following inequality holds:
\end{prop}

\begin{proof}
  By applying \cref{lem:descent} we have:
  \begin{align}
      f(x_{t+1})\leq f(x_{t})
  \end{align}
\end{proof}