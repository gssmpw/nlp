\section{Related Work}
\label{sec:relatedwork}

The implementation of realistic traffic simulation models has been addressed from different perspectives and has employed various strategies to enhance model accuracy, scalability, and applicability in diverse urban settings. Sha et al.~\cite{sha2020applying} propose a Bayesian optimization framework for the calibrating problem of traffic simulation models. Bayesian optimization is an approach to optimize expensive objective functions. Hence, the benefits of the suggested calibration method because traffic simulations are generally expensive in terms of simulation time and resource consumption. The key idea of Bayesian optimization is to choose more promising values for future evaluation based on previous results. This is achieved by constructing a surrogate model which is a probability model of the original objective function and is easier to optimize (i.e. it is computationally efficient). The proposed method calibrates simulation parameters such as the vehicles' maximum speed, acceleration, deceleration, and minimum gap after the leading vehicle for four types of vehicles, resulting in 16 parameters to be calibrated (one per vehicle type). The objective function to minimize is the sum of the root mean square percentage error (RMSPE) of traffic count and speed. The authors validate their proposal using a model of a section of the New Jersey Turnpike and compare their results to those obtained by the Simultaneous Perturbation Stochastic Approximation (SPSA), a stochastic approximation algorithm well suited for optimizing functions involving a high number of parameters. The minimum value of the objective function achieved using Bayesian optimization and SPSA is 6.87\% and 7.41\%, respectively. While Bayesian optimization guarantees good results when considering several variables in a large-scale scenario, the SPSA technique showed convergence issues ~\cite{kostic_techniques_2017}. In addition to the inherent limitations of Bayesian optimization-based methods (e.g., computational complexity is proportional to the number of observed points), the primary drawback of this study is in the actual problem design. Since the authors optimize several parameters for four different vehicle types, they do not consider the traffic dynamics observed throughout the day. Therefore, the calibrated model uses the same parameter values for each vehicle without considering that these may be different at different times. Furthermore, the authors do not consider the number of vehicles entering/leaving the simulation in the area of study. This can have an impact on the traffic counts seen throughout the simulation, ultimately lowering the performance indicator used as the optimization objective.

A more realistic approach to calibrate traffic simulation scenarios is to tune the traffic demand as the set of vehicle trips (or routes) from origin to destination that are produced on a road during a specific period. Gonzalez-Delicado et al.~\cite{9606704} propose a method to create simulated traffic from traffic measurements using Cadyts, a tool that iteratively adjusts the probability of selecting the routes to match the input traffic counts data~\cite{behrisch_comparison_2022}. The accuracy of the traffic calibrated using Cadyts depends on the input routes. The authors start from a set of random routes, then they clone some of the routes that are subsequently provided as input to Cadyts. This process of cloning routes is repeated until the difference between the real and simulated traffic is minimized. The authors validate their proposal on an Alicante-Murcia freeway (Spain) section. The difference in vehicles per hour between the input traffic counts and the simulated ones is about 132 using the proposed iterative method and 225 using Cadyts. The key benefit of the proposed calibration method is that it does not require pre-calibration to generate realistic traffic demands and can generate calibrated mixed traffic (light and heavy vehicles) using as input only the traffic flows measured by the road detectors or sensors. However, the process of cloning routes does not consider the effect that cloned routes may have on other traffic measurement points. This can lead to inaccurate results in complex, large-scale scenarios.

The method proposed by Gonzalez-Delicado et al.~\cite{9606704} is closely related to optimizing Origin-Destination (OD) matrices. However, rather than directly optimizing the traffic moving between two sites, the authors focus on cloning previous trips, with the notion that considering historical knowledge about these trips can better adapt the simulated traffic patterns. Some of the most recent methods for creating realistic traffic simulation models directly modify OD matrices~\cite{zhang_efficient_2017}. Each entry in the OD matrix defines the volume of traffic flowing between two points in a road network connected by at least one path. We refer the interested reader to Abrahamsson, T. \cite{abrahamsson1998estimation} and Rong, C., Ding, J., and Li, Y.\cite{rong2023interdisciplinary} for a detailed review of OD matrices estimation using traffic counts.

Zhu et al.~\cite{zhu_demand_2020} propose an Adaptive Fine-Tuning (AFT) algorithm for estimating OD matrices for an area of the city of Nanjing (China). The authors use the SUMO simulator to simulate traffic and obtain feedback from simulated traffic to infer OD pairs that minimize the error between the simulated traffic by SUMO and real-world Radio Frequency Identification (RFID) data. The input RFID data is aggregated at a 5-minute interval from 6:00 AM to 10:00 AM on a working day. When resampling the data with a frequency of 15 minutes, approximately 80\% of links demonstrate a mean absolute percentage error (MAPE) smaller than 20\%. The results demonstrated that the method is a feasible and efficient pathway for investigating urban road networks' spatiotemporal characteristics and how they are reflected during OD matrices estimation.
The main drawback of this method is that one OD matrix is defined for each modeled time interval, thus not considering the effect of traffic congestion between consecutive time intervals.

Pourmoradnasseri et al.~\cite{pourmoradnasseri_leveraging_2023} present an approach for dynamic trip-based route flow and OD matrix estimation. The authors start with a prior demand estimation from a normalized trip distribution. This input trip distribution is obtained from various sources such as travel surveys, population census, and mobile data. Then, they select the shortest paths between all OD pairs. After assigning the routes for all the OD pairs, they measure the discrepancy between real and simulated traffic counts obtained through simulation. A least square minimization procedure is used to calibrate the OD matrix using this difference. The authors validate this method on a model of the road network of the city of Tartu, Estonia, using traffic data collected by 33 IoT traffic sensors. The authors obtain a relative error of about 10\%, calculated as ${(\hat{y}-y)}/{|y|}$, where $\hat{y}$ and $y$ are the simulated and real traffic counts, respectively. Although the method is not vulnerable to the availability and accuracy of a prior OD demand, the main drawback is that it requires a prior probability distribution of trips between OD pairs based on data that are not always available. Moreover, the initial probability distribution of trips can affect the subsequent calibration step. A further drawback of the method concerns using the least square technique, which is highly sensitive to outliers and may not be suitable in contexts where the number of sensors providing traffic counts scales up significantly (hundreds).

Mehrabani et al.~\cite{mehrabani2023development} use a similar approach to calibrate a traffic model for the Belgian highway network. The authors define a probabilistic travel demand model using various data sources, including city populations, spatial distances between cities, yearly vehicle per kilometers traveled, and yearly truck trips. The accuracy of the traffic demand model is validated by comparing real travel times of heavy trucks between cities, achieving an accuracy level of $R^2 = 0.93$. The advantage of this approach is that it requires a limited amount of data to estimate intercity traffic demand. However, the validation is limited to the comparison of travel times of heavy trucks, which represent only a small part of the overall vehicular traffic.

Pamula et al.~\cite{PAMULA2023105550} propose an iterative method based on deep learning for estimating and predicting OD matrices. The authors start from a prior OD matrix and find a configuration of values that minimizes the deviation of the real traffic volumes in the road sections from the estimated values determined based on the assignment of the estimated OD matrix to the transport network. Then, the authors use LSTM layers and autoencoders to predict the values of the OD-pairs in a 15-minute time horizon. The LSTM layer learns the relationships between link volumes and the estimated OD pairs. The authors evaluate the proposed method using a road network model of Gliwice, Poland. The authors obtain OD matrices with an average error ranging from 6.97–7.31\% for a time horizon of 15 minutes. By using autoencoders instead, the average error ranges from 6.54\% to 7.18\%. As in previous methods, one of the main benefits of this approach is the estimation of OD matrices directly from the traffic flow data without a prior OD matrix. However, the proposed method does not consider the behavior of vehicles in a congested road network, and the distribution of the trips in the road network follows a proportional strategy, which can lead to unrealistic results.

Pamula et al.~\cite{PAMULA2023105550} propose an iterative method based on deep learning for estimating and predicting OD matrices. The authors start from a prior OD matrix and find a configuration of values that minimizes the deviation of the real traffic volumes in the road sections from the estimated values determined based on the assignment of the estimated OD matrix to the transport network. Then, the authors use LSTM layers and autoencoders to predict the values of the OD-pairs in a 15-minute time horizon. The LSTM layer learns the relationships between link volumes and the estimated OD pairs. The authors evaluate the proposed method using a road network model of Gliwice, Poland. The authors obtain OD matrices with an average error ranging from 6.97–7.31\% for a time horizon of 15 minutes. By using autoencoders instead, the average error ranges from 6.54\% to 7.18\%. This method exhibits the same limitations already discussed for Pamula et al.~\cite{PAMULA2023105550}'s approach.

This paper proposes an optimization method to estimate realistic simulated traffic models from traffic count data. The advantages of the proposed method, compared to the state-of-art methods, are as follows:

\begin{itemize}
    \item does not require pre-calibrated OD matrices. It calibrates traffic using only raw traffic count data;
    \item large-scale calibration of traffic simulation models in large temporal interval (24 hours);
    \item local traffic calibration: we regulate the amount of traffic locally in space and time, ensuring temporal coherence of traffic conditions.
\end{itemize}

What distinguishes the proposed method from state-of-the-art approaches is that the computation is partitioned locally both in space and time. Hence, reducing the computation complexity of the calibration. The computational load to calibrate traffic is specific to the size of the local part of the environment and the time interval. The possibility of calibrating traffic locally in space and time, ensuring temporal coherence of traffic conditions across consecutive time intervals, makes the proposed solution pertinent for calibrating traffic in nearly real-time. Furthermore, we make available the traffic model obtained using the calibration technique with real traffic counts.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem statement
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%